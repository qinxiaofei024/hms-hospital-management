/*! time: 2025/9/2 15:53:22; branch: master describe: a5a458eaa commit: a5a458eaa9bf68029f66b1a68081ce87c8783674 */
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/index-hash-rjZQGsq7.js","./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/zh_TW-hash-BDXb_v1k.js","./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/index-hash-DS2Z-Cll.js","./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/utils-hash-BZGqdNop.js","./resource?resource=/com/fr/plugin/wysiwyg/web/static/css/utils-hash-DUu0BauC.css","./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/useMeasure-hash-DHM38URo.js","./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/shared-hash-QGZb_1OY.js","./resource?resource=/com/fr/plugin/wysiwyg/web/static/css/shared-hash-BJ1ATTf3.css","./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/polyfill-hash-Cs1uKvqB.js","./resource?resource=/com/fr/plugin/wysiwyg/web/static/css/index-hash-CDOPvw6X.css","./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/jszip.min-hash-Sbtucb23.js","./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/pptxgen.es-hash-uNjpWiE5.js","./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/jspdf.es.min-hash-BTRMtdGT.js","./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/BaseVideo-hash-C8B8pX0X.js","./resource?resource=/com/fr/plugin/wysiwyg/web/static/css/BaseVideo-hash-iC1XV5yD.css","./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/LiveVideoPlayer-hash-D66hhqyi.js","./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/useAsyncRetry-hash-BW2VId6e.js","./resource?resource=/com/fr/plugin/wysiwyg/web/static/css/LiveVideoPlayer-hash-AjL9_SOa.css","./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/Content-hash-B21SKEl2.js","./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/moveable.esm-hash-vCWwU00e.js"])))=>i.map(i=>d[i]);
var __defProp2=Object.defineProperty,__defNormalProp2=(e,t,r)=>t in e?__defProp2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,__publicField=(e,t,r)=>__defNormalProp2(e,"symbol"!=typeof t?t+"":t,r),_a,_b;import{ea as _isIterateeCall$1,eb as toFinite_1,cV as getDefaultExportFromCjs$1,r as reactExports,b as _slicedToArray$b,dA as useMergedState,cG as useSize$3,u as useGlobalComponentConfig$1,d as usePrefixCls$1,ec as reduce,a as isString$3,cQ as _isNumber,t as isFunction$8,c as classNames,R as React,ed as Spin,ee as Input$1,_ as _extends$3,P as Popover$2,i as isNil$3,ef as KEYBOARD_KEY,bG as assign$3,eg as Tooltip,cH as _defineProperty$C,e6 as some$1,e as _toConsumableArray$3,eh as clamp$5,dB as isObject$e,ei as isArray$c,aR as isEqual$4,ej as useEvent$1,f as forEach$3,ek as RefResizeObserver,el as writeText,dt as useCustomCompareEffect,aU as useUpdateEffect$2,em as useEffectOnce,en as chroma$2,k as jsx,h as classNames$1,j as jsxs,N as NumberInput$1,cs as isUndefined$3,s as Icon$2,eo as _createRound,at as useMount$1,aV as getTargetElement$2,m as Fragment,ep as getPositionByNumbers,ac as ReactDOM,ab as Typography,eq as DialogWithCustomMask,er as getImageSourceNameFromResource,bT as Empty,a3 as ReactSVG,J as FvsImage,es as CustomResource,et as SketchPicker,aD as Popover$3,c8 as Input$2,bH as createUniqueName,I as IconTextButton,bh as reactDomExports,eu as CloseIcon,F as FVS_THEME_SCOPE,b_ as Dialog$1,ev as ReactSVG$1,ew as getImageResource$1,dN as isBaseResourceType,ex as FILL_TYPE,c9 as Form,n as RadioGroup$1,ey as FILL_TYPE_ITEMS,ez as BACKGROUND_FILL_TYPE_ITEMS,eA as BORDER_SCALE_ITEMS,eB as NumberUnitInput,eC as DIALOG_TYPE,C as Checkbox$4,eD as TEXT_LAYOUT,eE as TITLE_DEFAULT_CONFIG,eF as db$1,K as Spin$1,O as isEmpty$3,aw as Select$1,g as debounce$4,dD as TreeSelect$1,eG as DEFAULT_DYNAMIC_DATASET_SOURCE,eH as DEFAULT_FORMULA_DATASET_SOURCE,eI as isDynamicDatasetSource,eJ as FormulaInput$1,ae as Button$4,ar as IconPopover,ax as ValidationInput,eK as FormatterSelector,eL as getFormatterMeta,eM as getExampleValue,eN as FvsDrawer,eO as convertDynamicValueInputValueToRichTextDeltaOp,eP as shiftRichTextValue,eQ as DYNAMIC_VALUE_EMBED_KEY$1,eR as RICH_TEXT_TOOLBAR_POSITION,eS as createDefaultDynamicValue,eT as renderDynamicValue,eU as RichTextCore,eV as checkDynamicValueName,eW as replaceDynamicValue,eX as convertOpToDynamicValue,eY as unShiftRichTextValue,eZ as PATH_TYPE,e_ as TextArea,cU as isElementInvisible,e$ as isArray$d,dW as timeUnitToMillisecond,f0 as I18nContext,f1 as EnvContext,f2 as addSearchParamToUrl,f3 as FetchContext,f4 as WEEKDAY_FORMAT_TYPE,f5 as ACTION_TYPE,f6 as isString$4,aZ as Message,f7 as i18n,f8 as checkUseDocumentInJsCode,aC as isNil$4,f9 as consoleWarningMessage,d1 as getParamInURL,fa as updateURLParam,fb as notNil,fc as tsOption,fd as _baseSlice,e8 as toInteger_1,cr as merge$1,fe as isStaticFieldConfig,ff as isDate$2,aj as union,fg as head,fh as EventEmitter,fi as toString$6,fj as localeValues,dL as jsxRuntimeExports,cD as SvgIcon,fk as zh_CN$1,D as Divider,fl as Collapse$1,fm as Input$3,cJ as InputNumber,dH as Radio$4,ag as Col,ah as Row$1,fn as MARQUEE_CONTENT$1,fo as MARQUEE_MODE$1,fp as MARQUEE_DIRECTION$1,v as TimeUnitInput,bq as calculateBoundingSize,fq as getEffectBoundingSize,br as calculateSizeWithThreshold,aQ as throttle$1,bi as Metrics,dZ as calculateAdaptiveScaleStyle,e0 as convertAdaptiveScaleToTransformScale,fr as convertBorderStyle,bo as Transform$2,fs as convertToRecord,dQ as getResourceInfoByID,ft as arrify,fu as isRemoteURL,aP as useLatest$3,fv as isEqual$5,fw as getImageResourceById,fx as convertBorderImageStyle,fy as convertBackgroundStyle,fz as getFilterStyle,fA as BACKGROUND_FILL_TYPE,fB as configKit$1,fC as isNumber$5,fD as list,fE as _arrayMap$1,fF as _baseIteratee,fG as _basePickBy,fH as _getAllKeysIn,aB as cloneDeep$2,o as observer,b2 as fvsService,bA as sendFocusPoint,c5 as useForm,fI as getCurrentStoryCalderWidgetOptions,fJ as ActionConfigWrapper,fK as getCurrentStoryCalderWidgetOptionsForEnvSettings,fL as baseJavascriptAction,fM as baseJumpStoryAction,fN as getWidgetsAnimations,fO as baseModelAnimationAction,w as oldTime2TimeMillisecond,fP as PLAY_MODE_TYPE,fQ as getRoamAnimation,fR as basePlayRoamAnimationAction,cA as DUCHAMP_EVENTS,fS as PLAY_COMMAND_TYPE,a$ as widgetIsGroup,fT as widgetIsSupportVisibleControl,fU as _baseClone,a4 as Tree,aO as first,fV as MOBILE_MODE,fW as SIZE_REGULAR_TYPE,fX as TARGET_TYPE,fY as POPUP_STYLE,fZ as RICH_TEXT_VERTICAL_ALIGN,f_ as convertBorderBackgroundStyle,f$ as _createAggregator,g0 as _baseAssignValue$1,g1 as _baseForOwn$1,g2 as _createAssigner$1,g3 as _copyObject$1,g4 as keys_1$1,g5 as __rest$p,g6 as __awaiter,g7 as __read$1,g8 as __spreadArray$1,g9 as __values,ga as __assign,gb as index$1,gc as ReactDOM$1,aX as commonjsGlobal$1,gd as dayjs,ge as shimExports,gf as _objectWithoutPropertiesLoose$e,gg as _baseRest$1,gh as toNumber_1$1,bE as get$5,gi as PropTypes,gj as keys$7,E as omit$1,gk as unset,cR as difference,q as uniq,bt as isBoolean,gl as _WeakMap,gm as identity_1$1,gn as _baseCreate,go as isObject_1$1,gp as _root$1,gq as noop_1,gr as _copyArray,gs as isArray_1$1,gt as isObjectLike_1$1,gu as _shortOut$1,gv as _arrayEach$1,gw as _arrayIncludes,gx as _setToString$1,gy as _isIndex$1,gz as _apply$1,gA as isNull$1,L as includes,bI as pull,gB as noop$6,G as find$2,gC as identity$a,gD as _createClass$2D,gE as _classCallCheck$2D,gF as _defineProperty$D,gG as _inherits$27,gH as _possibleConstructorReturn$27,gI as _getPrototypeOf$27,gJ as _assertThisInitialized$27,gK as _extends$4,gL as clsx$1,gM as polyfill,V as map$3,gN as getSearchParamFromUrl,gO as isPlainObject$1,gP as TARGET_TYPE_MAP,a9 as uuid$1,cp as createRoot$1,cm as locale$1,cn as DuchampProvider,ca as ConfigProvider,b5 as v4$1,gQ as getLanguage,dS as uuid$2,af as useUpdateValue$1,bm as ELEMENT_SYMBOL,gR as getEventOffset,gS as removeSummaryConfig,y as toJS,cS as concat,gT as PARAMETER_TYPE,gU as collectionEventsComputes,gV as widgetIsController,gW as collectionComputesFromActionParameters,gX as replaceActionData,gY as isDynamicValue,gZ as replaceDynamicValueDataset,g_ as isFormulaOp,g$ as isDynamicValueOp,h0 as handleFormulaValueToDynamicValue,h1 as isStringArray,h2 as getFormatResult,h3 as groupDynamicComputeValuesWithOriginalKey,h4 as calculateFormatterResult,U as FUNCTION_POINTS,h5 as withoutUndo,h6 as registerRootStore,h7 as RICH_TEXT_FORMAT_TYPE,h8 as DYNAMIC_VALUE_ICON_POSITION,h9 as DYNAMIC_VALUE_ICON_TYPE,ha as DEFAULT_RICH_TEXT_FORMAT,hb as TEXT,hc as getTreeDataByCondition,hd as LogicTree,he as getConditionByTreeData,hf as CONDITION_OPERAND_TYPE,hg as BINARY_CONDITION_OPERATOR_OPTIONS,hh as isBinaryCondition,hi as operandManager,hj as isUnaryCondition,hk as compact,hl as RESOURCE_TYPE,hm as InternalResource,aa as useDrop,Z as DRAG,Y as useDrag$2,a_ as REUSE_TYPE,hn as DYNAMIC_VALUE_ICON_RESOURCE_CENTER,ho as OperatorPanel,hp as OperandPanel,hq as DescribePanel,hr as DEFAULT_DYNAMIC_VALUE_ICON,hs as getAugmentedNamespace,ht as ResizeObserver_es,hu as BUTTON_GROUP_TYPE,hv as BUTTON_GROUP_TEXT_ALIGN,hw as BUTTON_GROUP_LAYOUT,hx as hexToRgba,p as Tooltip$1,hy as isDynamicFormulaSource,hz as updateRichTextToolbarItems,hA as TagNode,hB as isInsertDynamicValueState,hC as has$2,hD as ParameterConfig$1,hE as getPositionByNumbers$1,hF as DISPLAY_MODE_OPTIONS,hG as baseWebPagePopoverAction,hH as computeActionParameters,hI as WEB_PAGE_TAB_KEYS,hJ as collectBorderResources,hK as baseWidgetLinkAction,hL as ActionRegistry,hM as createContext,cZ as computed,hN as getRootStore,cY as observable,c_ as action$1,c$ as makeObservable,c3 as otherService,c1 as LAYOUT_TYPE$2,e2 as WEB_MESSAGE_TYPES$1,hO as safeDecodeURIComponent,b3 as Alert$2,dR as pick,hP as STORY_LOADED_EVENT,z as oldTime2TimeSecond,bO as ADAPTIVE_MODE,hQ as rgbToRgba,hR as isResourceInfo,ct as getPayload$2,bg as WIDGET_TYPE,e1 as reaction,hS as comparer,hT as calculateIntersectionRect,a0 as getCanvasContainerRect,hU as replaceEventsData,bX as isDatasetFieldConfig,hV as getStoryWorkbookNamedIdentifierWithIndex,hW as convertErrorResultToError,hX as CLICK_ACTION_TYPE,hY as isObject$f,co as getFetchInfo,bU as flatten$1,hZ as loadjs,h_ as isFunction$9,h$ as Transform3dEffect,i0 as ERROR_JAVASCRIPT_PANIC,i1 as loadFont,i2 as getWebglContext,i3 as get$6,i4 as millisecondToSecond,i5 as useFVS,i6 as useTempStorage,i7 as TempStorageContext,i8 as FVSContext,an as WIDGET_EVENT,i9 as WIDGET_EVENT_MAP,ia as getSnapshot,ib as override,bn as isStructureWidget,dV as useMergedRefs,bV as isFormulaFieldConfig,ic as isMap$2,id as widgetIsCalderComponent,aY as flatWidgets,bY as widgetIsWorkbook,bZ as widgetIsChart,ie as widgetIsHeavyComponent,ig as AnimationTypeValues,ih as useFirstMountState$1,cT as useHotkeys,bF as DATE_FORMAT_LISTS,ii as DATE_FORMAT_TYPE,cd as Parameter$1,ij as replaceParameterValueData,ik as parseQueryString,il as isCustomUrlInputValue,aq as widgetIsInExpand,im as isHasDynamicValue,io as InternalVideo,ip as CustomVideoResource,bD as set$3,iq as each$3,X as CollapseGroup,al as CheckboxGroup,ir as DEFAULT_SINGLE_COLOR$1,dO as DEFAULT_START_GRADIENT_COLOR$1,dP as DEFAULT_END_GRADIENT_COLOR$1,is as COLOR$1,ai as isEmptyTableRelationOptions,a2 as DESIGNER,T as Tab$1,bj as calculateAreaBound,it as runInAction,iu as getTargetChildrenStates,bz as OverlayScrollbar,ay as isUniqueOrOwnName,aN as isDraggableTargetStructureWidget,iv as ANIMATION_NAME,iw as timeUnitToString,b$ as timeUnitToSecond,H as COLORS_REPLACE_TOKEN,ix as hexToJson$1,iy as getWidgetLimitRect,iz as PopConfirm,as as WIDGET_TABS,iA as LOADING_SPIN_TYPE,iB as _baseMerge,iC as _baseFlatten,iD as map_1,iE as _baseUniq,iF as toNumber$7,iG as _arrayFilter,iH as _baseProperty,iI as _baseTimes$1,iJ as isArrayLikeObject_1,iK as isGhostStructureWidget,iL as CompositeFrame,iM as isInIframe,iN as FluidLayout,iO as MagneticLayout,iP as BUTTON_GROUP_POSITION,iQ as isSymbol_1$1,c2 as Toolbox,bs as flatAvailableWidgets,iR as isNaturalInteger,iS as when,iT as DEFAULT_MARQUEE_CONFIG,iU as IMAGE_EMBED_KEY,iV as FLEX_ALIGN_MAP,iW as responseIsError$1,iX as ALIGN$1,iY as DEFAULT_WEEKDAY_FORMAT,iZ as FORMATTER_TYPE,c0 as TIME_UNIT$1,i_ as EXPORT_FORMAT,i$ as getStoryWorkbookNamedIdentifier,j0 as _inheritsLoose,j1 as convertInnerBorderRadiusStyle,j2 as first$1,j3 as pick$1,j4 as omit$2,j5 as isRegExp,cf as groupBy,j6 as getPropsFromConfig,j7 as widgetIsQueryButton,A as DEFAULT_REFRESH_INTERVAL,j8 as isVersionCompatible,j9 as isSameVersion,ja as isFormulaString,jb as compareVersions,dI as transformTemplateVersion,jc as DEFAULT_ROAM_ANIMATION_CONFIG,jd as DEFAULT_MODAL_ANIMATION_CONFIG,$ as getMainCanvasRect,a1 as round$3,je as checkWidgetCountLimit,jf as customParseFormat,jg as _baseSet$1,a5 as CaretDownFilled,a6 as CaretRightFilled,jh as WIDGET_CONTAINER_TYPE,ak as Search,W as findIndex$3,bK as HTML5Backend,bJ as DndProvider,bu as isCtrlOrCmdKeyDown,ji as DateTime$2,jj as useValidation,jk as transformDateFormat2DayjsFormat$1,ad as PORTAL_CLASS,jl as quarterOfYear,jm as advancedFormat,jn as isDate$3,jo as dateModeMatcher,jp as isEmpty$4,jq as getDateValueWithFormat$1,c6 as filter$1,bC as last$2,jr as times,js as shake,jt as ERROR_NO_LICENSE,by as getDeepestWidgetInPoint,ju as convertBorderVariable,jv as covertBorderRadiusStyle,jw as widgetIsTreeViewController,jx as widgetIsRadioGroup,jy as autorun,e5 as sortBy,jz as FINE_TOOLBAR_TYPE,jA as DEFAULT_MOBILE_LAYOUT_CONFIG,bB as CONTROLLER_PANEL_MOBILE_STYLE_TYPE,Q as EllipsisText,jB as TreePanel,bf as Menu,jC as ResourceCenter,jD as isUniqueOrOwnName$1,jE as getWidgetOffsetRect,jF as getFilterTitle,dK as ReuseFilterManager,jG as Model$1,jH as idProp,jI as prop,jJ as getRoot,jK as widgetAdapter,jL as detach,bv as widgetCanSelect,jM as fp,jN as widgetIsReserveCanvas,jO as generateWidgetSnapshotWithForkId,jP as modelAction,jQ as ExtendedModel,jR as model$1,jS as replaceDataIds,jT as applySnapshot,jU as BACKGROUND_STORY_SYMBOL,jV as MOBILE_BACKGROUND_STORY_SYMBOL,bp as transaction,b4 as MOVE_DIRECTION,jW as eventCenter,jX as memoize$5,au as CHART_CONFIG_PANE_ID_SELECTOR,jY as DEFAULT_LOAD_CONFIG,jZ as Linear_GRADIENT_COLOR,j_ as getTotalStories,j$ as addPayload,k0 as LOADING_ANIMATION_TYPE,av as Instruction,d0 as localeCompare,aE as LAYER_POSITION,c7 as PREVIEW_MODE,k1 as REUSE_DEFAULT_SERVICE,k2 as widgetIsTabs,bL as STORY_TYPE,bN as ADAPTIVE_MODES,k3 as contextMenu,aJ as MENU,k4 as setGlobalConfig,k5 as FUNCTION_POINT_MARKER,d2 as ReuseManager,k6 as REUSE_LOCAL_SORT,k7 as ReuseManagerGroup,k8 as intersection,k9 as clone$4,ka as isOverlap,kb as getRectOffset,kc as isContainRect,kd as undoMiddleware,ke as fork,kf as getAllWidgetTypes,kg as checkFunctionPointsCode,kh as onPatches}from"./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/utils-hash-BZGqdNop.js";import{a as useMountedState,u as useAsync,d as createResourceURL,c as createAbsoluteUrl,p as parseUrl,R as REGEX_URL_START_WITH_HTTP_S,e as completionTag,E as Empty$1,b as useAsyncFn,n as normalizePiParam}from"./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/shared-hash-QGZb_1OY.js";import{S as Space,R as Result,E as EVENT_CONFIG_TYPE,C as CONNECTION_STATE}from"./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/polyfill-hash-Cs1uKvqB.js";const scriptRel="modulepreload",assetsURL=function(e,t){return new URL(e,t).href},seen={},__vitePreload=function(e,t,r){let n=Promise.resolve();if(t&&t.length>0){const e=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),i=(null==o?void 0:o.nonce)||(null==o?void 0:o.getAttribute("nonce"));n=Promise.allSettled(t.map((t=>{if((t=assetsURL(t,r))in seen)return;seen[t]=!0;const n=t.endsWith(".css"),o=n?'[rel="stylesheet"]':"";if(!!r)for(let r=e.length-1;r>=0;r--){const o=e[r];if(o.href===t&&(!n||"stylesheet"===o.rel))return}else if(document.querySelector('link[href="'.concat(t,'"]').concat(o)))return;const a=document.createElement("link");return a.rel=n?"stylesheet":scriptRel,n||(a.as="script"),a.crossOrigin="",a.href=t,i&&a.setAttribute("nonce",i),document.head.appendChild(a),n?new Promise(((e,r)=>{a.addEventListener("load",e),a.addEventListener("error",(()=>r(new Error("Unable to preload CSS for ".concat(t)))))})):void 0})))}function o(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return n.then((t=>{for(const e of t||[])"rejected"===e.status&&o(e.reason);return e().catch(o)}))};var nativeCeil$1=Math.ceil,nativeMax$c=Math.max;function baseRange$1(e,t,r,n){for(var o=-1,i=nativeMax$c(nativeCeil$1((t-e)/(r||1)),0),a=Array(i);i--;)a[n?i:++o]=e,e+=r;return a}var _baseRange=baseRange$1,baseRange=_baseRange,isIterateeCall$4=_isIterateeCall$1,toFinite$1=toFinite_1;function createRange$1(e){return function(t,r,n){return n&&"number"!=typeof n&&isIterateeCall$4(t,r,n)&&(r=n=void 0),t=toFinite$1(t),void 0===r?(r=t,t=0):r=toFinite$1(r),n=void 0===n?t<r?1:-1:toFinite$1(n),baseRange(t,r,n,e)}}var _createRange=createRange$1,createRange=_createRange,range=createRange(),range_1=range;const range$1=getDefaultExportFromCjs$1(range_1);var __rest$o=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},AutoComplete$1=function(e){var t=e.allowClear,r=e.className,n=e.id,o=e.disabled,i=e.value,a=e.placeholder,s=e.onChange,l=e.onClick,c=e.onClear,u=e.defaultOpen,d=e.open,h=e.inputStyle,p=e.style,f=e.loading,g=e.popupStyle,m=e.options,y=void 0===m?[]:m,v=e.defaultValue,_=e.mouseEnterDelay,b=e.mouseLeaveDelay,C=e.placement,E=void 0===C?"bottom-left":C,T=e.popupClassName,S=e.notFoundContent,P=e.onFocus,w=e.onBlur,x=e.onSearch,O=e.onSelect,$=e.status,I=e.autoFocus,R=e.size,A=e.defaultActiveFirstOption,D=e.filterOption,L=e.onDropdownVisibleChange,N=e.bordered,M=e.children,k=e.prefixCls,F=__rest$o(e,["allowClear","className","id","disabled","value","placeholder","onChange","onClick","onClear","defaultOpen","open","inputStyle","style","loading","popupStyle","options","defaultValue","mouseEnterDelay","mouseLeaveDelay","placement","popupClassName","notFoundContent","onFocus","onBlur","onSearch","onSelect","status","autoFocus","size","defaultActiveFirstOption","filterOption","onDropdownVisibleChange","bordered","children","prefixCls"]),j=reactExports.useState((function(){return A?0:-1})),B=_slicedToArray$b(j,2),W=B[0],V=B[1],H=reactExports.useRef(null),G=useMergedState(void 0,{value:i,defaultValue:v}),U=_slicedToArray$b(G,2),Y=U[0],z=U[1],K=useMergedState(!1,{value:d,defaultValue:u}),Z=_slicedToArray$b(K,2),X=Z[0],J=Z[1],Q=useSize$3(R),q=useGlobalComponentConfig$1("autoComplete"),ee=usePrefixCls$1("autocomplete",k),te=reactExports.useCallback((function(e,t,r){null==O||O(e,t),null==s||s(e),J(!1),z(e),V(r),null==L||L(!1)}),[s,L,O,J,z]),re=reactExports.useMemo((function(){return reduce(y,(function(e,t){var r;return r=isString$3(t)||_isNumber(t)?{value:t,key:t,label:t}:Object.assign({key:t.value},t),isFunction$8(D)&&!D(null!=Y?Y:"",r)||e.push(r),e}),[])}),[D,Y,y]),ne=reactExports.useMemo((function(){var e,t=classNames("".concat(ee,"-list"),T);return e=0===re.length?S:re.filter((function(e){return!isFunction$8(D)||D(null!=Y?Y:"",e)})).map((function(e,t){var r=e.value,n=e.label,i=void 0===n?r:n;return React.createElement("div",{key:r,onMouseDown:function(){te(r,e,t)},onMouseEnter:function(){V(t)},className:classNames("".concat(ee,"-item"),{active:W===t,disabled:o})},i)})),React.createElement("div",{className:t,style:g},f?React.createElement("div",{className:"".concat(ee,"-loading")},React.createElement(Spin,null)):e)}),[T,re,g,f,S,D,Y,W,o,te]),oe=reactExports.useCallback((function(e){var t=re.findIndex((function(t){return isString$3(t.label)?t.label===e:t.value===e}));V(-1===t&&A?0:t)}),[A,re]),ie={disabled:o,placeholder:a,autoSelect:I,onChange:function(e){z(e),null==x||x(e),null==s||s(e),oe(e),J(!0)},onClearBtnClick:function(e){e.stopPropagation(),null==c||c(),z(""),J(!1)},allowClear:t,status:$,size:Q,onBlur:function(){null==w||w(),J(!1)},onFocus:P,value:Y},ae=React.Children.toArray(M),se=React.createElement(Input$1,_extends$3({className:"".concat(ee,"-input")},ie,{style:Object.assign({width:null==p?void 0:p.width},h),inputState:$}));ae&&1===ae.length&&(se=React.cloneElement(ae[0],ie));return reactExports.useEffect((function(){Y&&oe(Y)}),[Y,oe]),React.createElement(Popover$2,{mouseEnterDelay:_,mouseLeaveDelay:b,arrow:!1,trigger:"click",overlayClassName:"".concat(ee,"-popover"),visible:X&&(re.length>0||f||!isNil$3(S)),content:ne,placement:E,popupMatchTriggerWidth:!1,onVisibleChange:function(e){null==L||L(e),J(e)}},React.createElement("div",_extends$3({style:Object.assign(Object.assign({},null==q?void 0:q.style),p),className:classNames(ee,r,null==q?void 0:q.className,{disabled:o,borderless:!1===N}),id:n,onClick:function(e){o||(null==l||l(e),X||J(!0))},onKeyDown:function(e){switch(e.code){case KEYBOARD_KEY.DOWN:V((function(e){var t=e+1;return t>=re.length&&(t=0),t}));break;case KEYBOARD_KEY.UP:V((function(e){var t=e-1;return t<0&&(t=re.length-1),t}));break;case KEYBOARD_KEY.ENTER:W>-1&&re[W]?te(re[W].value,re,W):J(!1);break;case KEYBOARD_KEY.ESC:J(!1)}},ref:H},F),se))};function getOffset(e,t,r){return(e-t)/(r-t)}function getClosestValue(e,t){var r,n,o;return t.length>0&&(n=0,r=t[0]),t.forEach((function(t,i){var a=Math.abs(e-t);(isNil$3(o)||a<=o)&&(r=t,n=i,o=a)})),{value:r,index:n}}function getDirectionStyle(e,t,r,n){var o=getOffset(t,r,n),i={};if("vertical"===e)i.top="".concat(100*o,"%"),i.transform="translateY(-50%)";else i.left="".concat(100*o,"%"),i.transform="translateX(-50%)";return i}var __rest$n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},defaultFormatter=function(e){return e.toString()},Handle=reactExports.forwardRef((function(e,t){var r,n=e.className,o=e.value,i=void 0===o?0:o,a=e.onStartMove,s=e.style,l=e.dragging,c=e.onKeyboardOffsetChange,u=e.disabled,d=e.keyboard,h=e.direction,p=void 0===h?"horizontal":h,f=e.min,g=void 0===f?0:f,m=e.max,y=void 0===m?0:m,v=e.step,_=void 0===v?1:v,b=e.tooltip,C=void 0===b?{}:b,E=e.tabIndex,T=e.containerSize,S=e.handleBg,P=e.prefixCls,w=__rest$n(e,["className","value","onStartMove","style","dragging","onKeyboardOffsetChange","disabled","keyboard","direction","min","max","step","tooltip","tabIndex","containerSize","handleBg","prefixCls"]),x=React.useState(!1),O=_slicedToArray$b(x,2),$=O[0],I=O[1],R=reactExports.useRef(null),A=C.open,D=C.placement,L=C.formatter,N=void 0===L?defaultFormatter:L,M=null!=A?A:void 0===A&&($||l);reactExports.useEffect((function(){var e;M&&(null===(e=R.current)||void 0===e||e.forceAlign())}),[T,i,M]);var k,F=assign$3({"--fd-slider-handle-bg":null==S?void 0:S.backColor,"--fd-slider-handle-fg":null==S?void 0:S.foreColor},s);return React.createElement(Tooltip,{content:N(i),visible:M,placement:(k=D,k||("horizontal"===p?"top":"left")),overlayClassName:"".concat(P,"-tooltip"),arrow:!1,offset:[0,-10],ref:R},React.createElement("div",_extends$3({onMouseEnter:function(){return I(!0)},onMouseLeave:function(){return I(!1)},ref:t,className:classNames("".concat(P,"-handle"),(r={},_defineProperty$C(r,"".concat(P,"-handle-dragging"),l),_defineProperty$C(r,"handle-bg",S),r),n),"aria-valuenow":i,style:Object.assign(Object.assign({},getDirectionStyle(p,i,g,y)),F),tabIndex:u?void 0:E,onMouseDown:function(e){u||a(e)},onKeyDown:function(e){if(!u&&d){var t;switch(e.code){case KEYBOARD_KEY.LEFT:t=-1;break;case KEYBOARD_KEY.RIGHT:t=1;break;case KEYBOARD_KEY.UP:t=-1;break;case KEYBOARD_KEY.DOWN:t=1;break;case KEYBOARD_KEY.HOME:t="min";break;case KEYBOARD_KEY.END:t="max";break;case KEYBOARD_KEY.PAGE_UP:t=2;break;case KEYBOARD_KEY.PAGE_DOWN:t=-2;break;default:t=0}t&&(e.preventDefault(),c(_isNumber(t)?t*_:t))}}},w)))})),Track=function(e){var t,r=e.style,n=e.className,o=e.start,i=void 0===o?0:o,a=e.end,s=void 0===a?0:a,l=e.onStartMove,c=e.direction,u=e.min,d=void 0===u?0:u,h=e.max,p=void 0===h?100:h,f=e.disabled,g=e.prefixCls,m=e.range,y=getOffset(i,d,p),v=getOffset(s,d,p),_={};return"vertical"===c?(_.top="".concat(100*y,"%"),_.height="".concat(100*v-100*y,"%")):(_.left="".concat(100*y,"%"),_.width="".concat(100*v-100*y,"%")),reactExports.createElement("div",{className:classNames("".concat(g,"-track"),(t={},_defineProperty$C(t,"".concat(g,"-track"),m),_defineProperty$C(t,"".concat(g,"-track-track-draggable"),!!l),t),n),style:Object.assign(Object.assign({},_),r),onMouseDown:function(e){f||null==l||l(e)}})};function useDrag$1(e,t,r,n,o,i,a,s){var l=reactExports.useState(),c=_slicedToArray$b(l,2),u=c[0],d=c[1],h=reactExports.useState(-1),p=_slicedToArray$b(h,2),f=p[0],g=p[1],m=reactExports.useState(r),y=_slicedToArray$b(m,2),v=y[0],_=y[1],b=reactExports.useState(r),C=_slicedToArray$b(b,2),E=C[0],T=C[1],S=reactExports.useRef(),P=reactExports.useRef(),w=function(e,t){v.some((function(t,r){return t!==e[r]}))&&(void 0!==t&&d(t),_(e),i(e))},x=function(e,t){var r=s.getClosetOffsetValue,i=s.offsetValues;if(isNil$3(e)){var a=E[0],l=E[E.length-1],c=clamp$5(t*(o-n),n-a,o-l),u=r(a+c);c=u-a,w(E.map((function(e){return e+c})))}else{var d=(o-n)*t,h=_toConsumableArray$3(v);h[e]=E[e];var p=i(h,d,e),f=p.values,g=p.value;w(f,g)}},O=reactExports.useRef(x);O.current=x;reactExports.useEffect((function(){-1===f&&some$1(r,(function(e,t){return e!==v[t]}))&&_(r)}),[r,f]),reactExports.useEffect((function(){return function(){document.removeEventListener("mousemove",S.current),document.removeEventListener("mouseup",P.current)}}),[]);var $=reactExports.useMemo((function(){var e=_toConsumableArray$3(r).sort((function(e,t){return e-t})),t=_toConsumableArray$3(v).sort((function(e,t){return e-t}));return e.every((function(e,r){return e===t[r]}))?v:r}),[r,v]);return[f,u,$,function(n,o,i){n.stopPropagation();var s=null!=i?i:r,l=s[o];g(o),d(l),T(s);var c=n.pageX,u=n.pageY,h=function(r){var n;r.preventDefault();var i,a=r.pageX,s=r.pageY,l=a-c,d=s-u,h=null===(n=e.current)||void 0===n?void 0:n.getBoundingClientRect(),p=h.width,f=h.height;if("vertical"===t)i=d/f;else i=l/p;O.current(o,i)},p=function e(t){t.preventDefault(),document.removeEventListener("mouseup",e),document.removeEventListener("mousemove",h),S.current=null,P.current=null,g(-1),a(v)};document.addEventListener("mouseup",p),document.addEventListener("mousemove",h),S.current=h,P.current=p}]}function useOffset(e,t,r,n){var o=reactExports.useCallback((function(r){return clamp$5(r,e,t)}),[e,t]),i=reactExports.useCallback((function(n){if(null!==r){var i=e+Math.round((o(n)-e)/r)*r,a=function(e){return(String(e).split(".")[1]||"").length},s=Math.max(a(r),a(t),a(e)),l=Number(i.toFixed(s));return e<=l&&l<=t?l:null}return null}),[r,e,t,o]),a=reactExports.useCallback((function(a){var s=o(a),l=n.map((function(e){return e.value}));return null!==r&&l.push(i(a)),l.push(e,t),getClosestValue(s,l).value}),[o,n,r,e,t,i]);return[a,function(r,a,s){var l=r.map(o),c=function(r,o){if(_isNumber(o)){var a=r,s=a+o,l=[e,t];n.forEach((function(e){l.push(e.value)})),l.push(i(a),i(s));var c=getClosestValue(s,l=l.filter((function(e){return null!==e&&(o<0?e<=a:e>=a)}))).value;return void 0===c?o<0?e:t:c}return"min"===o?e:t}(l[s],a);return l[s]=c,{value:c,values:l}}]}var __rest$m=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},Slider$2=reactExports.forwardRef((function(e,t){var r,n=e.value,o=e.defaultValue,i=e.disabled,a=e.direction,s=void 0===a?"horizontal":a,l=e.marks,c=e.style,u=e.className,d=e.id,h=e.railStyle,p=e.trackStyle,f=e.min,g=void 0===f?0:f,m=e.max,y=void 0===m?100:m,v=e.handleStyle,_=e.step,b=void 0===_?1:_,C=e.range,E=e.autoFocus,T=void 0!==E&&E,S=e.keyboard,P=void 0===S||S,w=e.onChange,x=e.dots,O=e.included,$=void 0===O||O,I=e.tooltip,R=e.handleBg,A=e.onAfterChange,D=e.styles,L=e.classNames,N=e.prefixCls,M=__rest$m(e,["value","defaultValue","disabled","direction","marks","style","className","id","railStyle","trackStyle","min","max","handleStyle","step","range","autoFocus","keyboard","onChange","dots","included","tooltip","handleBg","onAfterChange","styles","classNames","prefixCls"]),k=reactExports.useState(0),F=_slicedToArray$b(k,2),j=F[0],B=F[1],W=reactExports.useRef(null),V=reactExports.useRef({}),H=useGlobalComponentConfig$1("slider"),G=usePrefixCls$1("slider",N),U=reactExports.useMemo((function(){return Object.keys(l||{}).map((function(e){var t=null==l?void 0:l[e],r={value:Number(e)};return isObject$e(t)&&!reactExports.isValidElement(t)?(r.style=t.style,r.label=t.label,r.className=t.className):(r.label=t,r.style=null==D?void 0:D.mark,r.className=null==L?void 0:L.mark),r})).sort((function(e,t){return e.value-t.value}))}),[l]),Y=useOffset(g,y,b,U),z=_slicedToArray$b(Y,2),K=z[0],Z=z[1],X=useMergedState(C?[0,0]:0,{value:n,defaultValue:o,postState:function(e){return(isArray$c(e)?e:[e]).map((function(e){return K(e)}))}}),J=_slicedToArray$b(X,2),Q=J[0],q=J[1],ee=reactExports.useCallback((function(e){var t=isArray$c(e)?_toConsumableArray$3(e).sort((function(e,t){return e-t})):[e];w&&!isEqual$4(t,Q)&&w(C?t:t[0]),q(t)}),[Q,w,C,q]),te=useEvent$1((function(){C?null==A||A(Q):null==A||A(Q[0])})),re=reactExports.useCallback((function(e,t){var r,n=null!==(r=getClosestValue(e,Q).index)&&void 0!==r?r:0,o=_toConsumableArray$3(Q);o[n]=e,ee(o),t&&ce(t,n,o)}),[ee,Q]),ne=reactExports.useMemo((function(){if(!C)return!1;if(isObject$e(C)){var e=C.draggableTrack;return(!e||null!==b)&&e}return!1}),[C,b]),oe=useDrag$1(W,s,Q,g,y,ee,te,{getClosetOffsetValue:K,offsetValues:Z}),ie=_slicedToArray$b(oe,4),ae=ie[0],se=ie[1],le=ie[2],ce=ie[3],ue=reactExports.useMemo((function(){return _toConsumableArray$3(le).sort((function(e,t){return e-t}))}),[le]);React.useImperativeHandle(t,(function(){return{focus:function(){var e;null===(e=V.current[0])||void 0===e||e.focus()},blur:function(){var e,t=document.activeElement;(null===(e=W.current)||void 0===e?void 0:e.contains(t))&&(null==t||t.blur())},getContainerRef:function(){return W.current}}}));var de=-1!==ae;React.useEffect((function(){if(!de&&se){var e=le.lastIndexOf(se);e>-1&&V.current[e].focus()}}),[de]),reactExports.useEffect((function(){var e;T&&(null===(e=V.current[0])||void 0===e||e.focus())}),[T]);var he=reactExports.useMemo((function(){return C?ue:[g,ue[0]]}),[ue,g,C]),pe=_slicedToArray$b(he,2),fe=pe[0],ge=pe[1],me=reactExports.useMemo((function(){var e=new Set;if(forEach$3(U,(function(t){e.add(t.value)})),x&&null!==b)for(var t=g;t<=y;)e.add(t),t+=b;return Array.from(e)}),[U,x,b,g,y]),ye=reactExports.useCallback((function(e){return $&&fe<=e&&e<=ge}),[$,fe,ge]),ve=Object.assign(Object.assign({},null==H?void 0:H.style),c);return React.createElement(RefResizeObserver,{onResize:function(e){var t=e.width,r=e.height;B("horizontal"===s?t:r)}},React.createElement("div",_extends$3({ref:W,className:classNames(G,"".concat(G,"-css-var"),u,null==H?void 0:H.className,(r={},_defineProperty$C(r,"".concat(G,"-disabled"),i),_defineProperty$C(r,"".concat(G,"-vertical"),"vertical"===s),_defineProperty$C(r,"".concat(G,"-horizontal"),"vertical"!==s),_defineProperty$C(r,"".concat(G,"-with-marks"),U.length),r)),id:d,style:ve,onMouseDown:function(e){var t;if(e.preventDefault(),!i){var r,n=null===(t=W.current)||void 0===t?void 0:t.getBoundingClientRect(),o=n.width,a=n.height,l=n.left,c=n.top,u=e.clientX,d=e.clientY;if("vertical"===s)r=(d-c)/a;else r=(u-l)/o;re(K(g+r*(y-g)),e)}}},M),React.createElement("div",{className:classNames("".concat(G,"-rail"),null==L?void 0:L.rail),style:Object.assign(Object.assign({},h),null==D?void 0:D.rail)}),$?React.createElement(Track,{prefixCls:G,className:null==L?void 0:L.track,style:Object.assign(Object.assign({},p),null==D?void 0:D.track),start:fe,end:ge,min:g,max:y,disabled:i,direction:s,onStartMove:ne?ce:void 0}):null,React.createElement("div",{className:"".concat(G,"-step")},me.map((function(e){return React.createElement("span",{key:e,className:classNames("".concat(G,"-dot"),_defineProperty$C({},"".concat(G,"-dot-active"),ye(e))),style:getDirectionStyle(s,e,g,y)})}))),le.map((function(e,t){return React.createElement(Handle,{prefixCls:G,ref:function(e){e?V.current[t]=e:delete V.current[t]},key:t,dragging:ae===t,direction:s,disabled:i,className:null==L?void 0:L.handle,style:Object.assign(Object.assign({},v),null==D?void 0:D.handle),handleBg:R,onStartMove:function(e){ce(e,t)},onKeyboardOffsetChange:function(e){!function(e,t){if(!i){var r=Z(Q,e,t).values;ee(r)}}(e,t)},keyboard:P,value:e,tabIndex:t,min:g,max:y,tooltip:I,containerSize:j})})),React.createElement("div",{className:"".concat(G,"-mark")},U.map((function(e){var t=e.value,r=e.style,n=e.label,o=e.className;return React.createElement("span",{key:t,className:classNames("".concat(G,"-mark-text"),_defineProperty$C({},"".concat(G,"-mark-text-active"),ye(t)),o),style:Object.assign(Object.assign({},getDirectionStyle(s,t,g,y)),r),onMouseDown:function(e){e.stopPropagation()},onClick:function(){re(t)}},n)})))))})),useSetState=function(e){void 0===e&&(e={});var t=reactExports.useState(e),r=t[0],n=t[1];return[r,reactExports.useCallback((function(e){n((function(t){return Object.assign({},t,e instanceof Function?e(t):e)}))}),[])]},noop$5=function(){};function on(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];e&&e.addEventListener&&e.addEventListener.apply(e,t)}function off(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];e&&e.removeEventListener&&e.removeEventListener.apply(e,t)}var isBrowser$4="undefined"!=typeof window,react=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,o,i;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(o=n;0!=o--;)if(!e(t[o],r[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(i=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(o=n;0!=o--;)if(!Object.prototype.hasOwnProperty.call(r,i[o]))return!1;for(o=n;0!=o--;){var a=i[o];if(("_owner"!==a||!t.$$typeof)&&!e(t[a],r[a]))return!1}return!0}return t!=t&&r!=r};const isDeepEqualReact=getDefaultExportFromCjs$1(react);var useCopyToClipboard=function(){var e=useMountedState(),t=useSetState({value:void 0,error:void 0,noUserInteraction:!0}),r=t[0],n=t[1];return[r,reactExports.useCallback((function(t){var r,o;if(e())try{if("string"!=typeof t&&"number"!=typeof t){var i=new Error("Cannot copy typeof "+typeof t+" to clipboard, must be a string");return void n({value:t,error:i,noUserInteraction:!0})}if(""===t){i=new Error("Cannot copy empty string to clipboard.");return void n({value:t,error:i,noUserInteraction:!0})}o=t.toString(),r=writeText(o),n({value:o,error:void 0,noUserInteraction:r})}catch(a){n({value:o,error:a,noUserInteraction:r})}}),[])]},updateReducer=function(e){return(e+1)%1e6};function useUpdate$1(){return reactExports.useReducer(updateReducer,0)[1]}var useDeepCompareEffect$1=function(e,t){useCustomCompareEffect(e,t,isDeepEqualReact)},defaultTarget=isBrowser$4?window:null,isListenerType1=function(e){return!!e.addEventListener},isListenerType2=function(e){return!!e.on},useEvent=function(e,t,r,n){void 0===r&&(r=defaultTarget),reactExports.useEffect((function(){if(t&&r)return isListenerType1(r)?on(r,e,t,n):isListenerType2(r)&&r.on(e,t,n),function(){isListenerType1(r)?off(r,e,t,n):isListenerType2(r)&&r.off(e,t,n)}}),[e,t,r,JSON.stringify(n)])},useInterval$1=function(e,t){var r=reactExports.useRef((function(){}));reactExports.useEffect((function(){r.current=e})),reactExports.useEffect((function(){if(null!==t){var e=setInterval((function(){return r.current()}),t||0);return function(){return clearInterval(e)}}}),[t])},createKeyPredicate=function(e){return"function"==typeof e?e:"string"==typeof e?function(t){return t.key===e}:e?function(){return!0}:function(){return!1}},useKey=function(e,t,r,n){void 0===t&&(t=noop$5),void 0===r&&(r={}),void 0===n&&(n=[e]);var o=r.event,i=void 0===o?"keydown":o,a=r.target,s=r.options,l=reactExports.useMemo((function(){var r=createKeyPredicate(e);return function(e){if(r(e))return t(e)}}),n);useEvent(i,l,a,s)},useKeyPress=function(e){var t=reactExports.useState([!1,null]),r=t[0],n=t[1];return useKey(e,(function(e){return n([!0,e])}),{event:"keydown"},[r]),useKey(e,(function(e){return n([!1,e])}),{event:"keyup"},[r]),r},useKeyPressEvent=function(e,t,r,n){void 0===n&&(n=useKeyPress);var o=n(e),i=o[0],a=o[1];useUpdateEffect$2((function(){!i&&r?r(a):i&&t&&t(a)}),[i])},useUnmount$2=function(e){var t=reactExports.useRef(e);t.current=e,useEffectOnce((function(){return function(){return t.current()}}))},useRafState$1=function(e){var t=reactExports.useRef(0),r=reactExports.useState(e),n=r[0],o=r[1],i=reactExports.useCallback((function(e){cancelAnimationFrame(t.current),t.current=requestAnimationFrame((function(){o(e)}))}),[]);return useUnmount$2((function(){cancelAnimationFrame(t.current)})),[n,i]};function usePrevious(e){var t=reactExports.useRef();return reactExports.useEffect((function(){t.current=e})),t.current}var useScroll=function(e){var t=useRafState$1({x:0,y:0}),r=t[0],n=t[1];return reactExports.useEffect((function(){var t=function(){e.current&&n({x:e.current.scrollLeft,y:e.current.scrollTop})};return e.current&&on(e.current,"scroll",t,{capture:!1,passive:!0}),function(){e.current&&off(e.current,"scroll",t)}}),[e]),r};function _slicedToArray$a(e,t){return _arrayWithHoles$a(e)||_iterableToArrayLimit$a(e,t)||_unsupportedIterableToArray$b(e,t)||_nonIterableRest$a()}function _nonIterableRest$a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$b(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$b(e,t):void 0}}function _arrayLikeToArray$b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$a(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==r.return||r.return()}finally{if(s)throw o}}return i}}function _arrayWithHoles$a(e){if(Array.isArray(e))return e}var SliderType$1={Default:"default",Colour:"colour",Bright:"bright",Balance:"balance"},Slider$1=function(e){var t=e.className,r=e.value,n=e.onChange,o=e.onAfterChange,i=e.min,a=void 0===i?0:i,s=e.max,l=void 0===s?100:s,c=e.disabled,u=void 0!==c&&c,d=e.step,h=e.marks,p=e.type,f=void 0===p?SliderType$1.Default:p,g=_slicedToArray$a(reactExports.useState(null),2),m=g[0],y=g[1],v=_slicedToArray$a(reactExports.useState(),2),_=v[0],b=v[1],C=_slicedToArray$a(reactExports.useState(),2),E=C[0],T=C[1],S=_slicedToArray$a(reactExports.useState(),2),P=S[0],w=S[1];return reactExports.useEffect((function(){f===SliderType$1.Colour?y(["#FF3200","#FFE500","#3EFE00","#00FFF0","#0045FF","#AA00FF","#FF0564","#FF0027"]):f===SliderType$1.Bright?y(["#FFFFFF","#FF0000"]):f===SliderType$1.Balance?y(["#FFFFFF","#000000"]):y(null)}),[f]),reactExports.useEffect((function(){isNil$3(m)||b({background:"linear-gradient(90deg,".concat(m.join(","),")")})}),[m]),reactExports.useEffect((function(){if(!isNil$3(r)&&!isNil$3(m)){var e=(r-a)/(l-a),t=chroma$2.scale(m)(e).hex();T({foreColor:t,backColor:"white"})}}),[m,l,a,r]),reactExports.useEffect((function(){isNil$3(r)||isNil$3(m)||w({background:"transparent"})}),[m,l,a,r]),jsx(Slider$2,{className:classNames$1(t,{"fvs-custom-slider":f!==SliderType$1.Default}),styles:{track:P,rail:_},handleBg:E,value:r,onChange:n,onAfterChange:o,min:a,max:l,disabled:u,step:d,marks:h})},_excluded$f=["value","onChange","min","max","disabled","style","className","step","sliderType","sliderTestId"];function ownKeys$H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$H(Object(r),!0).forEach((function(t){_defineProperty$B(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$B(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties$c(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$d(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$d(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}var SliderInput$1=function(e){var t=e.value,r=e.onChange,n=e.min,o=void 0===n?0:n,i=e.max,a=void 0===i?100:i,s=e.disabled,l=void 0!==s&&s,c=e.style,u=e.className,d=void 0===u?"":u,h=e.step,p=e.sliderType;e.sliderTestId;var f=_objectWithoutProperties$c(e,_excluded$f);return jsxs("div",{className:classNames$1("slider-input",d),style:c,children:[jsxs("div",{className:"slider-wrapper",children:[jsx(Slider$1,{className:"slider-bar",value:t,onChange:r,min:o,max:a,disabled:l,step:h,type:p}),jsxs("div",{className:"slider-label",children:[jsx("span",{children:o}),jsx("span",{className:classNames$1({"not-full-label":t!==a}),children:a})]})]}),jsx(NumberInput$1,_objectSpread$G({wrapperClassName:"slider-number-input",width:56},_objectSpread$G({value:t,onChange:r,min:o,max:a,disabled:l,step:h},f)))]})},GAP_SIZE={MIDDLE:12,SMALL:8,NONE:0};function ownKeys$G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$G(Object(r),!0).forEach((function(t){_defineProperty$A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GridItem(e){var t=e.children,r=e.gapSize,n=void 0===r?GAP_SIZE.MIDDLE:r,o=e.hide,i=void 0!==o&&o,a=e.style,s=e.className;return i?null:jsx("div",{className:classNames$1("grid-item",s),style:_objectSpread$F({gap:n},a),children:t})}var _excluded$e=["label","children","hide","prefix","icon","style","className","align"];function ownKeys$F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$F(Object(r),!0).forEach((function(t){_defineProperty$z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties$b(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$c(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$c(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}function LineItem(e){var t=e.label,r=e.children,n=e.hide,o=e.prefix,i=e.icon,a=e.style,s=e.className,l=e.align,c=_objectWithoutProperties$b(e,_excluded$e);return n?null:isUndefined$3(t)?jsx("div",{className:classNames$1("line-item",s),style:_objectSpread$E({alignItems:l},a),children:r}):jsxs("div",_objectSpread$E(_objectSpread$E({className:classNames$1("line-item",s)},c),{},{style:_objectSpread$E({alignItems:l},a),children:[jsxs("div",{className:"line-label",children:[!isUndefined$3(o)&&jsx("span",{className:"line-icon prefix-icon",children:isString$3(o)?jsx(Icon$2,{type:o}):o}),t,!isUndefined$3(i)&&jsx("span",{className:"line-icon suffix-icon",children:isString$3(i)?jsx(Icon$2,{type:i}):i})]}),jsx("div",{className:"line-children",children:r})]}))}var observerMap=new Map,RootIds=new WeakMap,rootId=0,unsupportedValue=void 0;function getRootId(e){return e?(RootIds.has(e)||(rootId+=1,RootIds.set(e,rootId.toString())),RootIds.get(e)):"0"}function optionsToId(e){return Object.keys(e).sort().filter((t=>void 0!==e[t])).map((t=>"".concat(t,"_").concat("root"===t?getRootId(e.root):e[t]))).toString()}function createObserver(e){const t=optionsToId(e);let r=observerMap.get(t);if(!r){const n=new Map;let o;const i=new IntersectionObserver((t=>{t.forEach((t=>{var r;const i=t.isIntersecting&&o.some((e=>t.intersectionRatio>=e));e.trackVisibility&&void 0===t.isVisible&&(t.isVisible=i),null==(r=n.get(t.target))||r.forEach((e=>{e(i,t)}))}))}),e);o=i.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),r={id:t,observer:i,elements:n},observerMap.set(t,r)}return r}function observe$1(e,t,r={},n=unsupportedValue){if(void 0===window.IntersectionObserver&&void 0!==n){const o=e.getBoundingClientRect();return t(n,{isIntersecting:n,target:e,intersectionRatio:"number"==typeof r.threshold?r.threshold:0,time:0,boundingClientRect:o,intersectionRect:o,rootBounds:o}),()=>{}}const{id:o,observer:i,elements:a}=createObserver(r),s=a.get(e)||[];return a.has(e)||a.set(e,s),s.push(t),i.observe(e),function(){s.splice(s.indexOf(t),1),0===s.length&&(a.delete(e),i.unobserve(e)),0===a.size&&(i.disconnect(),observerMap.delete(o))}}function useInView({threshold:e,delay:t,trackVisibility:r,rootMargin:n,root:o,triggerOnce:i,skip:a,initialInView:s,fallbackInView:l,onChange:c}={}){var u;const[d,h]=reactExports.useState(null),p=reactExports.useRef(c),[f,g]=reactExports.useState({inView:!!s,entry:void 0});p.current=c,reactExports.useEffect((()=>{if(a||!d)return;let s;return s=observe$1(d,((e,t)=>{g({inView:e,entry:t}),p.current&&p.current(e,t),t.isIntersecting&&i&&s&&(s(),s=void 0)}),{root:o,rootMargin:n,threshold:e,trackVisibility:r,delay:t},l),()=>{s&&s()}}),[Array.isArray(e)?e.toString():e,d,o,n,i,a,r,l,t]);const m=null==(u=f.entry)?void 0:u.target,y=reactExports.useRef(void 0);d||!m||i||a||y.current===m||(y.current=m,g({inView:!!s,entry:void 0}));const v=[h,f.inView,f.entry];return v.ref=v[0],v.inView=v[1],v.entry=v[2],v}var createRound=_createRound,floor$1=createRound("floor"),floor_1=floor$1;const floor$2=getDefaultExportFromCjs$1(floor_1);function ownKeys$E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$E(Object(r),!0).forEach((function(t){_defineProperty$y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _slicedToArray$9(e,t){return _arrayWithHoles$9(e)||_iterableToArrayLimit$9(e,t)||_unsupportedIterableToArray$a(e,t)||_nonIterableRest$9()}function _nonIterableRest$9(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$a(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$a(e,t):void 0}}function _arrayLikeToArray$a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$9(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==r.return||r.return()}finally{if(s)throw o}}return i}}function _arrayWithHoles$9(e){if(Array.isArray(e))return e}var SLICER_LINE_WIDTH=2;function getImageSliceValue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0!==e.length){var n=getPositionByNumbers(e);return{top:n.top*r,right:n.right*t,bottom:n.bottom*r,left:n.left*t}}}function BorderImageSlicer(e){var t=e.imgURL,r=e.imgSlice,n=e.onChange,o=_slicedToArray$9(reactExports.useState(void 0),2),i=o[0],a=o[1],s=_slicedToArray$9(reactExports.useState({width:0,height:0}),2),l=s[0],c=s[1],u=_slicedToArray$9(reactExports.useState({width:0,height:0}),2),d=u[0],h=u[1],p=reactExports.useRef(null);useMount$1((function(){if(t){var e=new Image;e.src=t,e.onload=function(){c({width:e.width,height:e.height});var t=getTargetElement$2(p);if(t){var n=t.clientWidth,o=t.clientHeight;h({width:n,height:o}),r&&r.length>0?a(getImageSliceValue(r,n/e.width,o/e.height)):a({top:o/3,right:n/3,bottom:o/3,left:n/3})}}}})),useUpdateEffect$2((function(){i?null==n||n([i.top/(d.height/l.height),i.right/(d.width/l.width),i.bottom/(d.height/l.height),i.left/(d.width/l.width)].map((function(e){return floor$2(e)}))):null==n||n([])}),[i]);var f=function(e,t){var r=t.baseX,n=t.baseY;document.onmousemove=function(t){var o=t.clientX,s=t.clientY;!function(e,t,r){"top"===e&&i&&i.top+r<d.height-i.bottom-8&&i.top+r>0?a(_objectSpread$D(_objectSpread$D({},i),{},{top:i.top+r})):"right"===e&&i&&i.right-t<d.width-i.left-8&&i.right-t>0?a(_objectSpread$D(_objectSpread$D({},i),{},{right:i.right-t})):"bottom"===e&&i&&i.bottom-r<d.height-i.top-8&&i.bottom-r>0?a(_objectSpread$D(_objectSpread$D({},i),{},{bottom:i.bottom-r})):"left"===e&&i&&i.left+t<d.width-i.right-8&&i.left+t>0&&a(_objectSpread$D(_objectSpread$D({},i),{},{left:i.left+t}))}(e,o-r,s-n)},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null}};return jsx("div",{className:"border-image-slicer",children:jsxs("div",{className:"image-slicer-container",children:[jsxs("div",{className:"image-slicer",style:{display:i?"block":"none"},children:[["top","right","bottom","left"].map((function(e){return jsx("div",{className:"image-slicer-line image-slicer-".concat(e),style:_defineProperty$y({},e,i?i[e]:0),onMouseDown:function(t){var r=t.clientX,n=t.clientY;f(e,{baseX:r,baseY:n})}},e)})),i?jsxs(Fragment,{children:[jsx("div",{className:"image-slicer-label",style:{top:0,left:i.left+SLICER_LINE_WIDTH,right:i.right+SLICER_LINE_WIDTH,height:i.top-SLICER_LINE_WIDTH},children:jsx("span",{children:getPositionByNumbers(r).top})}),jsx("div",{className:"image-slicer-label",style:{right:0,top:i.top+SLICER_LINE_WIDTH,bottom:i.bottom+SLICER_LINE_WIDTH,width:i.right-SLICER_LINE_WIDTH},children:jsx("span",{children:getPositionByNumbers(r).right})}),jsx("div",{className:"image-slicer-label",style:{bottom:0,left:i.left+SLICER_LINE_WIDTH,right:i.right+SLICER_LINE_WIDTH,height:i.bottom-SLICER_LINE_WIDTH},children:jsx("span",{children:getPositionByNumbers(r).bottom})}),jsx("div",{className:"image-slicer-label",style:{left:0,top:i.top+SLICER_LINE_WIDTH,bottom:i.bottom+SLICER_LINE_WIDTH,width:i.left-SLICER_LINE_WIDTH},children:jsx("span",{children:getPositionByNumbers(r).left})})]}):void 0]}),jsx("img",{ref:p,className:"border-image",alt:"",src:t})]})})}function _slicedToArray$8(e,t){return _arrayWithHoles$8(e)||_iterableToArrayLimit$8(e,t)||_unsupportedIterableToArray$9(e,t)||_nonIterableRest$8()}function _nonIterableRest$8(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$9(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$9(e,t):void 0}}function _arrayLikeToArray$9(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$8(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==r.return||r.return()}finally{if(s)throw o}}return i}}function _arrayWithHoles$8(e){if(Array.isArray(e))return e}function BorderImageSlicerModal(e){var t=e.visible,r=e.imgURL,n=e.imgSlice,o=e.onCancel,i=e.onOk,a=e.onVisibleChange,s=_slicedToArray$8(reactExports.useState(n),2),l=s[0],c=s[1];return jsx(DialogWithCustomMask,{title:duchampIntl.get("Duchamp-Set_Point_Nine_Map"),visible:t,onCancel:o,onOk:function(){l?null==i||i(l):null==i||i([])},onVisibleChange:a,footer:jsx(Typography.Link,{href:duchampIntl.get("Duchamp-Border_Image_Help_Link"),target:"_blank",children:duchampIntl.get("Duchamp-How_To_Set_Point_Nine_Pictures")}),children:jsx(BorderImageSlicer,{imgURL:r,imgSlice:l,onChange:function(e){c(e)}})})}function createImageSliceDialog(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=document.createElement("div");function o(){ReactDOM.unmountComponentAtNode(n)&&n.parentNode&&n.parentNode.removeChild(n)}return document.body.appendChild(n),new Promise((function(i){var a;a=function(e){o(),i(e)},setTimeout((function(){ReactDOM.render(jsx(BorderImageSlicerModal,{onVisibleChange:r,visible:!0,imgURL:e,imgSlice:t,onOk:a,onCancel:function(){o()}}),n)}))}))}function _typeof$7(e){return(_typeof$7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _regeneratorRuntime$5(){_regeneratorRuntime$5=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(w){s=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),a=new T(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=b(a,r);if(s){if(s===u)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=c(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}(e,r,a),i}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(w){return{type:"throw",arg:w}}}e.wrap=l;var u={};function d(){}function h(){}function p(){}var f={};s(f,o,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(S([])));m&&m!==t&&r.call(m,o)&&(f=m);var y=p.prototype=d.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(o,i,a,s){var l=c(e[o],e,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==_typeof$7(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var o;this._invoke=function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}}function b(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var n=c(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=p,s(y,"constructor",p),s(p,"constructor",h),h.displayName=s(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},v(_.prototype),s(_.prototype,i,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new _(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=S,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:S(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}function ownKeys$D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$D(Object(r),!0).forEach((function(t){_defineProperty$x(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$x(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function asyncGeneratorStep$5(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void r(c)}s.done?t(l):Promise.resolve(l).then(n,o)}function _asyncToGenerator$5(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){asyncGeneratorStep$5(i,n,o,a,s,"next",e)}function s(e){asyncGeneratorStep$5(i,n,o,a,s,"throw",e)}a(void 0)}))}}var maxSize=20971520;function CustomImageResource(e){var t,r=e.defaultResource,n=e.value,o=void 0===n?"":n,i=e.onChange,a=e.tag,s=e.canEdit,l=void 0===s||s,c=e.resourceCenter,u=e.getResourceUrl,d=e.placeholderIcon,h=e.emptyIcon,p=e.accept,f=void 0===p?".jpg, .jpeg, .png, .gif, .apng, .webp":p,g=e.onVisibleChange,m=e.drawerContainer,y=e.mask,v=e.imgStyle;return jsx(CustomResource,{value:o,defaultResource:r,onChange:i,tag:a,mask:y,imgStyle:v,type:"image",canEdit:l,maxSize:maxSize,drawerContainer:m,beforeEditResource:(t=_asyncToGenerator$5(_regeneratorRuntime$5().mark((function e(t){var r,n,o;return _regeneratorRuntime$5().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,createImageSliceDialog(u(getImageSourceNameFromResource(t,c)),(null==t||null===(r=t.payload)||void 0===r?void 0:r.imgSlice)||[],g);case 2:return n=e.sent,(o=_objectSpread$C({},t)).payload||(o.payload={}),o.payload.imgSlice=n,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)}),accept:f,editText:duchampIntl.get("Duchamp-Set_Point_Nine_Map"),uploadText:duchampIntl.get("Duchamp-Upload_Image"),emptyNode:jsx(Empty,{image:h,description:duchampIntl.get("Duchamp-There_Are_Currently_No_Custom_Materials"),style:{padding:"32px 8px 0",justifyContent:"flex-start"}}),placeholderNode:jsx(ReactSVG,{src:d,width:"100%",height:75}),imageNode:function(e){return jsx(FvsImage,{src:u(getImageSourceNameFromResource(e,c)),height:75,hoverPreview:{contentStyle:{width:232,height:150}}})},resourceCenter:c,getResourceUrl:u})}function ownKeys$C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$C(Object(r),!0).forEach((function(t){_defineProperty$w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$w(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var SKETCH_PICKER_WIDTH=235;function ColorSelectTrigger(e){var t=e.value,r=e.disabled,n=void 0!==r&&r,o=e.disableAlpha,i=void 0!==o&&o;e.colorViewId;var a=e.popStyle,s=e.contentWidth,l=void 0===s?SKETCH_PICKER_WIDTH:s,c=e.placement,u=void 0===c?"bottom":c,d=e.children,h=e.onChange,p=e.onChangeComplete,f=e.onPopupVisibleChange,g=reactExports.useRef(null);return jsx(Popover$3,{trigger:"click",placement:u,content:n?null:jsx("div",{tabIndex:-1,ref:g,children:jsx(SketchPicker,{color:t,disableAlpha:i,width:"".concat(l,"px"),onChange:function(e){null==h||h(getHexColorFromSketchPickerColorResult(e,i))},onChangeComplete:function(e){null==p||p(getHexColorFromSketchPickerColorResult(e,i))}})}),style:_objectSpread$B(_objectSpread$B({},{width:l+20}),a),autoAdjustOverflow:!0,hasPadding:!1,arrow:!1,onVisibleChange:function(e){var t;(null==f||f(e),e)&&(null===(t=g.current)||void 0===t||t.focus())},children:d||jsx("div",{className:"color-view",children:jsx("div",{className:classNames$1({disabled:n}),style:{backgroundColor:t}})})})}function getHexColorFromSketchPickerColorResult(e,t){return getHexColorFromSketchPickerColorResultInternal(e.hex,e.rgb,t)}function getHexColorFromSketchPickerColorResultInternal(e,t,r){var n,o=e;if(!r){var i=t.a;if(null!=i){var a=Math.round(255*i).toString(16);1===a.length&&(a="0".concat(a)),o+=a}}return"".concat(null===(n=o)||void 0===n?void 0:n.toLocaleUpperCase())}var _excluded$d=["value","disabled","disableAlpha","contentWidth","onChange","onChangeComplete","className","onPopupVisibleChange","colorViewId","colorInputId","popStyle","placement"];function ownKeys$B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$B(Object(r),!0).forEach((function(t){_defineProperty$v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties$a(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$b(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$b(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}function ColorSelector(e){var t=e.value,r=e.disabled,n=void 0!==r&&r,o=e.disableAlpha,i=void 0!==o&&o,a=e.contentWidth,s=e.onChange,l=e.onChangeComplete,c=e.className,u=e.onPopupVisibleChange,d=e.colorViewId;e.colorInputId;var h=e.popStyle,p=e.placement,f=_objectWithoutProperties$a(e,_excluded$d);return jsxs("div",{className:classNames$1(c,"color-select"),children:[jsx(ColorSelectTrigger,{value:t,disabled:n,disableAlpha:i,colorViewId:d,popStyle:h,contentWidth:a,onChange:s,onChangeComplete:l,onPopupVisibleChange:u,placement:p}),jsx(Input$2,_objectSpread$A(_objectSpread$A({value:t,disabled:n,className:"color-value"},f),{},{onChange:function(e){s(null==e?void 0:e.toLocaleUpperCase())},onBlur:function(e){null==l||l(null==e?void 0:e.toLocaleUpperCase())}}))]})}var _excluded$c=["label","children","className","prefix","icon","style","contentClassName"];function ownKeys$A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$A(Object(r),!0).forEach((function(t){_defineProperty$u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties$9(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$a(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$a(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}var VerticalItem$1=function(e){var t=e.label,r=e.children,n=e.className,o=e.prefix,i=e.icon,a=e.style,s=e.contentClassName,l=_objectWithoutProperties$9(e,_excluded$c);return jsxs("div",_objectSpread$z(_objectSpread$z({style:a,className:classNames$1(n,"vertical-item")},l),{},{children:[jsxs("div",{className:"vertical-item-label",children:[o,jsxs("div",{className:"vertical-item-content",children:[t,i]})]}),jsx("div",{className:s,children:r})]}))},ATTRIBUTE_NAMES={TYPE:"data-type",NAME:"data-name",VALUE:"data-value"};function createNode(e,t){if("text"===e.type)return document.createTextNode(e.value);var r=document.createElement("span");return r.className="formula-node",r.setAttribute(ATTRIBUTE_NAMES.TYPE,"formula"),r.setAttribute(ATTRIBUTE_NAMES.NAME,e.name),r.setAttribute(ATTRIBUTE_NAMES.VALUE,e.value),t&&(r.onclick=t),r.contentEditable="false",r.innerHTML=" ".concat(e.name," "),r}function isFormulaNode(e){return e instanceof HTMLSpanElement&&"formula"===e.getAttribute(ATTRIBUTE_NAMES.TYPE)}function isTextNode(e){return e instanceof Text}function getRangeBySelection(e,t){var r=e.focusNode,n=e.focusOffset;if(r){var o=document.createRange(),i=isTextNode(r)&&n>=(r.textContent||"").length?r.nextSibling:r===t?t.childNodes[n]:void 0;return isFormulaNode(i)?(o.setStartAfter(i),o.setEndAfter(i),o):void 0}}function findFormulaNodeByName(e,t){return Array.from(e.childNodes).find((function(e){return isFormulaNode(e)&&e.getAttribute(ATTRIBUTE_NAMES.NAME)===t}))}function _slicedToArray$7(e,t){return _arrayWithHoles$7(e)||_iterableToArrayLimit$7(e,t)||_unsupportedIterableToArray$8(e,t)||_nonIterableRest$7()}function _nonIterableRest$7(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$8(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$8(e,t):void 0}}function _arrayLikeToArray$8(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$7(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==r.return||r.return()}finally{if(s)throw o}}return i}}function _arrayWithHoles$7(e){if(Array.isArray(e))return e}var FormulaInsertInput$1=function(e){var t=e.value,r=e.onChange,n=e.toolbarRef,o=e.placeholder,i=e.showFormulaDialog,a=e.className,s=e.style,l=reactExports.useRef(null),c=_slicedToArray$7(reactExports.useState(null),2),u=c[0],d=c[1],h=_slicedToArray$7(reactExports.useState(""),2),p=h[0],f=h[1],g=reactExports.useCallback((function(){return l.current?Array.from(l.current.childNodes).reduce((function(e,t){if(isFormulaNode(t))e.push({type:"formula",name:t.getAttribute(ATTRIBUTE_NAMES.NAME)||"",value:t.getAttribute(ATTRIBUTE_NAMES.VALUE)||""});else{var r=t.textContent||"";e.length>0&&"text"===e[e.length-1].type?e[e.length-1].value+=r:e.push({type:"text",name:"",value:r})}return e}),[]):[]}),[]),m=reactExports.useCallback((function(e){if(l.current){l.current.focus(),f(l.current.innerHTML);var t=findFormulaNodeByName(l.current,e);if(t){var r=document.createRange();r.setStartAfter(t),r.setEndAfter(t);var n=window.getSelection();null==n||n.removeAllRanges(),null==n||n.addRange(r)}}}),[]),y=reactExports.useCallback((function(e,t){var r=e.target;i(r.getAttribute(ATTRIBUTE_NAMES.VALUE)||"").then((function(e){if(l.current){var r=findFormulaNodeByName(l.current,t);null==r||r.setAttribute(ATTRIBUTE_NAMES.VALUE,e),m(t)}}))}),[m,i]),v=reactExports.useMemo((function(){var e=document.createElement("div");return e.className="formula-toolbar",e}),[]),_=jsx(IconTextButton,{icon:"icon-add",text:duchampIntl.get("Duchamp-Insert_Formula"),onMouseDown:function(){var e=window.getSelection();d(l.current&&document.activeElement===l.current&&null!=e&&e.focusNode?{focusNode:e.focusNode,focusOffset:e.focusOffset,offset:isTextNode(e.focusNode)?Array.from(l.current.childNodes).indexOf(e.focusNode):e.focusOffset}:null)},onClick:function(){var e=createUniqueName(Array.isArray(t)?t.map((function(e){return e.name})):[],duchampIntl.get("Duchamp-Formula"));i("").then((function(t){if(l.current){var r=createNode({type:"formula",name:e,value:t},(function(t){y(t,e)}));if(u&&isTextNode(u.focusNode)){var n=u.offset,o=u.focusOffset,i=l.current.childNodes[n],a=i.textContent||"",s=createNode({type:"text",name:"",value:null==a?void 0:a.slice(0,o)}),c=createNode({type:"text",name:"",value:null==a?void 0:a.slice(o)});l.current.replaceChild(c,i),l.current.insertBefore(r,c),l.current.insertBefore(s,r)}else l.current.insertBefore(r,null!=u&&u.offset?l.current.childNodes[u.offset]:null);m(e),d(null)}}))}});return reactExports.useEffect((function(){if(l.current){var e=Array.isArray(t)?t:[{type:"text",value:t,name:""}];l.current.innerHTML="",e.forEach((function(e){var t;e.value&&(null===(t=l.current)||void 0===t||t.appendChild(createNode(e,(function(t){y(t,e.name)}))))})),f(l.current.innerHTML)}}),[y,t]),reactExports.useEffect((function(){var e=null==n?void 0:n.current;return null==e||e.appendChild(v),function(){null==e||e.removeChild(v)}}),[v,n]),jsxs(Fragment,{children:[jsx("div",{style:s,className:classNames$1("formula-insert-input .x-input-css-var",{empty:!p},a),contentEditable:!0,onKeyDown:function(e){var t=window.getSelection();if(t&&l.current)switch(e.key){case"Enter":e.preventDefault();break;case"Backspace":case"Delete":var r,n=t.getRangeAt(0),o=n.startContainer;if(o===n.endContainer&&o.nodeType===Node.ELEMENT_NODE&&null===o.nextSibling&&o!==l.current)e.preventDefault(),null===(r=o.parentNode)||void 0===r||r.removeChild(o);break;case"ArrowRight":var i=getRangeBySelection(t,l.current);i&&(t.removeAllRanges(),t.addRange(i),e.preventDefault())}},onBlur:function(){r(g())},onInput:function(e){f(e.currentTarget.innerHTML)},placeholder:o,ref:l}),n?reactDomExports.createPortal(_,v):jsx("div",{className:"formula-toolbar wrapper",children:_})]})};function ownKeys$z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$z(Object(r),!0).forEach((function(t){_defineProperty$t(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var PopoverContent$1=function(e){var t=e.title,r=e.styleConfig,n=e.content,o=e.spin;return jsxs("div",{className:"duchamp-custom-wrapper",style:{borderRadius:null==r?void 0:r.borderRadius},children:[jsx("div",{className:"duchamp-custom-background",style:_objectSpread$y(_objectSpread$y({},null==r?void 0:r.backgroundStyle),{},{borderRadius:null==r?void 0:r.borderRadius})}),jsxs("div",{style:{padding:null==r?void 0:r.padding},className:"duchamp-custom-content",children:[o,jsxs("div",{className:"duchamp-custom-inner-content",style:_objectSpread$y({gap:"16px"},null==r?void 0:r.innerContentStyle),children:[(null==r?void 0:r.titleDisplay)&&jsx("div",{className:"duchamp-custom-title",style:null==r?void 0:r.titleStyle,children:t}),n]})]})]})},PopoverWrapper=function(e){var t=e.title,r=e.styleConfig,n=void 0===r?{backgroundStyle:{opacity:.85,backgroundColor:"#024F67"}}:r,o=e.content,i=e.top,a=e.left,s=e.width,l=void 0===s?0:s,c=e.height,u=void 0===c?0:c,d=e.spin,h=_isNumber(u)&&u>window.innerHeight?clamp$5(u,0,window.innerHeight)-(null!=i?i:0):u;return jsx("div",{style:{top:i,left:a,width:l,height:h},className:"duchamp-popover-wrapper",onClick:function(e){return e.stopPropagation()},children:jsx(PopoverContent$1,{title:t,styleConfig:n,content:o,spin:d})})},_excluded$b=["onCancel","onOk","onClose","classNames","className","children","component","closable","styles","style"],_excluded2=["children","height","center","top","left","styles","borderRadius"];function ownKeys$y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$y(Object(r),!0).forEach((function(t){_defineProperty$s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties$8(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$9(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$9(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}var DialogWrapper=function(e){var t=e.onCancel,r=e.onOk,n=e.onClose,o=e.classNames,i=e.className,a=e.children,s=e.component,l=void 0===s?Dialog$1:s,c=e.closable,u=e.styles,d=e.style,h=_objectWithoutProperties$8(e,_excluded$b);return jsxs(l,_objectSpread$x(_objectSpread$x({className:classNames$1(FVS_THEME_SCOPE,"fvs-dialog",i)},h),{},{visible:!0,closable:!1,maskClosable:!0,text4Cancel:null,text4Ok:null,style:_objectSpread$x({padding:"0 16px",display:"flex"},d),styles:_objectSpread$x(_objectSpread$x({},u),{},{body:_objectSpread$x({padding:0},null==u?void 0:u.body)}),classNames:_objectSpread$x({header:"duchamp-preview-dialog-header"},o),onCancel:function(e,r){null==t||t(e,r),null==n||n()},onOk:function(e){null==r||r(e),null==n||n()},children:[a,c&&jsx("div",{className:"preview-dialog-close","aria-label":"close",onClick:function(){null==n||n()},children:jsx(CloseIcon,{})})]}))},PreviewDialogWrapper=function(e){var t=e.children,r=e.height,n=void 0===r?0:r,o=e.center,i=e.top,a=void 0===i?0:i,s=e.left,l=e.styles,c=e.borderRadius,u=_objectWithoutProperties$8(e,_excluded2),d=_isNumber(n)?clamp$5(n,0,window.innerHeight):n;return jsx(DialogWrapper,_objectSpread$x(_objectSpread$x({},u),{},{height:_isNumber(d)&&!o?d-a:d,styles:_objectSpread$x(_objectSpread$x({},l),{},{wrapper:_objectSpread$x(_objectSpread$x({borderRadius:c},!o&&{top:a,left:s}),null==l?void 0:l.wrapper),body:_objectSpread$x({overflow:"visible"},null==l?void 0:l.body)}),closable:!0,children:t}))};function getPaddingStyle(e){if(e){var t=e.top,r=void 0===t?0:t,n=e.right,o=void 0===n?0:n,i=e.bottom,a=void 0===i?0:i,s=e.left,l=void 0===s?0:s;return"".concat(r,"px ").concat(o,"px ").concat(a,"px ").concat(l,"px")}}function ownKeys$x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$x(Object(r),!0).forEach((function(t){_defineProperty$r(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var PaddingConfig=function(e){var t=e.value,r=void 0===t?{top:0,right:0,bottom:0,left:0}:t,n=e.onChange,o=e.onPaddingTopChange,i=e.onPaddingBottomChange,a=e.onPaddingLeftChange,s=e.onPaddingRightChange,l=e.className,c=e.style,u=e.paddingInputProps;return jsxs("div",{className:classNames$1("duchamp-padding-config",l),style:c,children:[jsxs("div",{className:"flex-space-between",children:[jsxs("div",{className:"icon-space-between",children:[jsx(Icon$2,{type:"icon-top-margin"}),jsx(NumberInput$1,_objectSpread$w(_objectSpread$w({},u),{},{value:r.top,onChange:function(e){null==n||n(_objectSpread$w(_objectSpread$w({},r),{},{top:e})),null==o||o(e)}}))]}),jsxs("div",{className:"icon-space-between",children:[jsx(Icon$2,{type:"icon-bottom-margin"}),jsx(NumberInput$1,_objectSpread$w(_objectSpread$w({},u),{},{value:r.bottom,onChange:function(e){null==n||n(_objectSpread$w(_objectSpread$w({},r),{},{bottom:e})),null==i||i(e)}}))]})]}),jsxs("div",{className:"flex-space-between",children:[jsxs("div",{className:"icon-space-between",children:[jsx(Icon$2,{type:"icon-left-margin"}),jsx(NumberInput$1,_objectSpread$w(_objectSpread$w({},u),{},{value:r.left,onChange:function(e){null==n||n(_objectSpread$w(_objectSpread$w({},r),{},{left:e})),null==a||a(e)}}))]}),jsxs("div",{className:"icon-space-between",children:[jsx(Icon$2,{type:"icon-right-margin"}),jsx(NumberInput$1,_objectSpread$w(_objectSpread$w({},u),{},{value:r.right,onChange:function(e){null==n||n(_objectSpread$w(_objectSpread$w({},r),{},{right:e})),null==s||s(e)}}))]})]})]})};function ownKeys$w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$w(Object(r),!0).forEach((function(t){_defineProperty$q(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var getPopoverContentBorderRadiusStyle=function(e){if(!e)return"";var t=e.topLeft,r=e.topRight,n=e.bottomLeft,o=e.bottomRight;return"".concat(t.value).concat(t.type," ").concat(r.value).concat(r.type," ").concat(o.value).concat(o.type," ").concat(n.value).concat(n.type)};function getTitleStyle(e){if(!e)return{};var t=e.fontFamily,r=e.color,n=e.isBold,o=e.fontSize,i=e.textDecoration,a=e.fontStyle;return{fontFamily:t,color:r,textAlign:e.textAlign,fontSize:o,fontWeight:n?"bold":void 0,textDecoration:i,fontStyle:a}}function getPopoverContentStyleConfig(e){var t,r,n=getTitleStyle(e.titleConfig),o=getPaddingStyle(e.padding);return{borderRadius:getPopoverContentBorderRadiusStyle(e.borderRadius),titleStyle:n,padding:o,titleDisplay:null!==(t=null===(r=e.titleConfig)||void 0===r?void 0:r.displayTitle)&&void 0!==t&&t}}var countDistance=function(e,t){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)},pointInRectangle=function(e,t){return e.x>t[0].x&&e.x<t[1].x&&e.y>t[0].y&&e.y<t[1].y},inCanvas=function(e,t){var r=t||document.body;if(r){var n=r.getClientRects()[0];return e.every((function(e){return pointInRectangle(e,[{x:n.left,y:n.top},{x:n.right,y:n.bottom}])}))}return!1},getCanvasEdgePoint=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rt",r=arguments.length>2?arguments[2]:void 0,n=e.width,o=e.x,i=r||document.body;if(i){var a=i.getClientRects()[0];if("rt"===t){var s=a.right-n-10;return{left:s=Math.min(o+.4*n,s),top:a.top+10}}return{left:0,top:0}}return{left:0,top:0}},getPositions=function(e){var t=e.x,r=e.y,n=e.width,o=e.height;return[{x:t,y:r},{x:t+n,y:r},{x:t+n,y:r+o},{x:t,y:r+o}]},getPopoverPositionInfo=function(e,t){var r=e.x,n=e.y,o=e.width,i=e.height,a=r,s=n,l=.25*o,c=l*Math.tan(50*Math.PI/180),u=.4*o,d=a+u,h=s-(c+.25*i),p={x:d,y:h,width:o,height:i},f=getPositions(p),g={width:u,height:c,style:{top:s-c,left:a},points:[{x:0,y:c},{x:l,y:0},{x:u,y:0}]};if(!(inCanvas(f,t)||(d=a+u,h=s+(c-.25*i),p.x=d,p.y=h,f=getPositions(p),g=_objectSpread$v(_objectSpread$v({},g),{},{style:{top:s,left:a},points:[{x:0,y:0},{x:l,y:c},{x:u,y:c}]}),inCanvas(f,t)||(d=a-u-o,h=s-(c+.25*i),p.x=d,p.y=h,f=getPositions(p),g=_objectSpread$v(_objectSpread$v({},g),{},{style:{top:s-c,left:a-u},points:[{x:0,y:0},{x:.15*o,y:0},{x:u,y:c}]}),inCanvas(f,t)||(d=a-u-o,h=s+(c-.25*i),p.x=d,p.y=h,f=getPositions(p),g=_objectSpread$v(_objectSpread$v({},g),{},{style:{top:s,left:a-u},points:[{x:0,y:c},{x:.15*o,y:c},{x:u,y:0}]}),inCanvas(f,t)))))){var m=getCanvasEdgePoint({width:o,height:i,x:a,y:s},"rt",t);if(d=m.left,h=m.top,p.x=d,p.y=h,f=getPositions(p),pointInRectangle({x:a,y:s},[f[0],f[2]]))g=_objectSpread$v(_objectSpread$v({},g),{},{style:{top:s,left:a},points:[{x:0,y:0}]});else{var y=countDistance({x:a,y:s},f[0]),v=f[0].x,_=f[0].y;f.forEach((function(e){var t=countDistance({x:a,y:s},e);y>t&&(y=t,v=e.x,_=e.y)}));var b=Math.abs(v-a),C=Math.abs(_-s);g={width:b,height:C,style:{left:Math.min(v,a),top:Math.min(_,s)},points:(v-a)*(_-s)>0?[{x:0,y:0},{x:b,y:C}]:[{x:b,y:0},{x:0,y:C}]}}}return{top:h,left:d,polyline:g}};function ownKeys$v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$v(Object(r),!0).forEach((function(t){_defineProperty$p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _slicedToArray$6(e,t){return _arrayWithHoles$6(e)||_iterableToArrayLimit$6(e,t)||_unsupportedIterableToArray$7(e,t)||_nonIterableRest$6()}function _nonIterableRest$6(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$7(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$7(e,t):void 0}}function _arrayLikeToArray$7(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$6(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==r.return||r.return()}finally{if(s)throw o}}return i}}function _arrayWithHoles$6(e){if(Array.isArray(e))return e}var PopoverPreview$1=function(e){var t=e.pointStyle,r=e.width,n=void 0===r?0:r,o=e.height,i=void 0===o?0:o,a=e.line,s=void 0===a?{type:"color",value:{color:"#00FFFF"}}:a,l=e.container,c=_slicedToArray$6(e.coordinate,2),u=c[0],d=c[1],h=e.zIndex,p=e.children,f=e.options,g=reactExports.useMemo((function(){return getPopoverPositionInfo({x:u,y:d,width:n,height:i},l)}),[u,d,l,i,n]),m=g.polyline,y=g.top,v=g.left,_=reactExports.useMemo((function(){var e=[];return m.points.reduce((function(t,r,n){return e.push(jsx("polyline",{points:[t,r].map((function(e){return"".concat(e.x,",").concat(e.y)})).join(" "),fill:"none",stroke:s.value.color,strokeWidth:t.x===r.x||t.y===r.y?2:1},n)),r})),e}),[s.value.color,m.points]);return jsx(Popover$3,_objectSpread$u(_objectSpread$u({trigger:"click",visible:!0,hasPadding:!1,arrow:!1,content:reactDomExports.createPortal(jsxs("div",{style:{position:"absolute",left:0,top:0,width:0,height:0,zIndex:h},children:[jsx(ReactSVG$1,_objectSpread$u(_objectSpread$u({},t),{},{src:(null==t?void 0:t.src)||"",style:_objectSpread$u({position:"absolute",height:34,transform:"translate(-50%, -50%)",top:d,left:u},null==t?void 0:t.style),beforeInjection:function(e){e.style.color=s.value.color}})),jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:m.width,height:m.height,viewBox:"0 0 ".concat(m.width," ").concat(m.height),style:_objectSpread$u({position:"absolute",pointerEvents:"none"},m.style),children:_}),"function"==typeof p?p({top:y,left:v}):p]}),document.body)},f),{},{children:jsx(Fragment,{})}))},_excluded$a=["label","layout","type","value","onChange","max","min","prefix","suffix"];function _slicedToArray$5(e,t){return _arrayWithHoles$5(e)||_iterableToArrayLimit$5(e,t)||_unsupportedIterableToArray$6(e,t)||_nonIterableRest$5()}function _nonIterableRest$5(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$6(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$6(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$6(e,t):void 0}}function _arrayLikeToArray$6(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$5(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==r.return||r.return()}finally{if(s)throw o}}return i}}function _arrayWithHoles$5(e){if(Array.isArray(e))return e}function ownKeys$u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$t(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$u(Object(r),!0).forEach((function(t){_defineProperty$o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties$7(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$8(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$8(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}var DEFAULT_COMPONENTS=["hue",["saturation","brightness","contrast"]],INTERVAL=12,Layout$1=function(e){var t=e.label,r=e.layout,n=void 0===r?"horizontal":r,o=e.type,i=e.value,a=e.onChange,s=e.max,l=void 0===s?100:s,c=e.min,u=void 0===c?-100:c,d=e.prefix,h=e.suffix,p=_objectWithoutProperties$7(e,_excluded$a),f=jsx(SliderInput$1,_objectSpread$t({value:i,onChange:a,sliderType:o,min:u,max:l,suffix:h},p));return jsx("horizontal"===n?LineItem:VerticalItem$1,{label:t,prefix:d,style:{alignItems:"flex-end"},children:f})};function FilterProcessPanel(e){var t=e.layout,r=void 0===t?"horizontal":t,n=e.hue,o=void 0===n?0:n,i=e.opacity,a=void 0===i?100:i,s=e.saturation,l=void 0===s?0:s,c=e.brightness,u=void 0===c?0:c,d=e.contrast,h=void 0===d?0:d,p=e.components,f=e.showPlatformIcon,g=void 0!==f&&f,m=e.prefix,y=e.value,v=e.onChange,_=e.gapSize,b=void 0===_?INTERVAL:_,C=_slicedToArray$5(reactExports.useState(!0),2),E=C[0],T=C[1],S=y||{hue:o,opacity:a,saturation:l,brightness:u,contrast:h},P=g?m:void 0,w=p||DEFAULT_COMPONENTS,x=new Map([["hue",{label:duchampIntl.get("Duchamp-Hue"),value:S.hue,onChange:function(e){return null==v?void 0:v(_objectSpread$t(_objectSpread$t({},y||{}),{},{hue:e}),"hue",e)},type:SliderType$1.Colour,max:360,min:0}],["opacity",{label:duchampIntl.get("Duchamp-Opacity"),value:S.opacity,onChange:function(e){return null==v?void 0:v(_objectSpread$t(_objectSpread$t({},y||{}),{},{opacity:e}),"opacity",e)},min:0,suffix:"%"}],["saturation",{label:duchampIntl.get("Duchamp-Saturation"),value:S.saturation,onChange:function(e){return null==v?void 0:v(_objectSpread$t(_objectSpread$t({},y||{}),{},{saturation:e}),"saturation",e)},type:SliderType$1.Bright,suffix:"%"}],["brightness",{label:duchampIntl.get("Duchamp-Brightness"),key:"brightness",value:S.brightness,onChange:function(e){return null==v?void 0:v(_objectSpread$t(_objectSpread$t({},y||{}),{},{brightness:e}),"brightness",e)},type:SliderType$1.Balance,suffix:"%"}],["contrast",{label:duchampIntl.get("Duchamp-Contrast"),key:"contrast",value:S.contrast,onChange:function(e){return null==v?void 0:v(_objectSpread$t(_objectSpread$t({},y||{}),{},{contrast:e}),"contrast",e)},suffix:"%"}]]);return jsx(Space,{direction:"vertical",size:b,className:"filter-process-panel",children:w.map((function(e){return Array.isArray(e)?jsxs("div",{children:[jsxs("div",{className:classNames$1("more-process",{"show-more-process":!E}),onClick:function(){T(!E)},children:[jsx(Icon$2,{type:E?"icon-fold":"icon-unfold"}),jsx("span",{children:duchampIntl.get("Duchamp-More_Setting")})]}),jsx(Space,{direction:"vertical",size:b,className:classNames$1("inner-space",{fold:E}),children:e.map((function(e){return reactExports.createElement(Layout$1,_objectSpread$t(_objectSpread$t({layout:r,prefix:P},x.get(e)),{},{key:e}))}))})]},"more"):reactExports.createElement(Layout$1,_objectSpread$t(_objectSpread$t({layout:r,prefix:P},x.get(e)),{},{key:e}))}))})}var _excluded$9=["border","fillType","resourceSelector","onBorderTypeChange","resourceCenter"];function ownKeys$t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$t(Object(r),!0).forEach((function(t){_defineProperty$n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toConsumableArray$2(e){return _arrayWithoutHoles$2(e)||_iterableToArray$2(e)||_unsupportedIterableToArray$5(e)||_nonIterableSpread$2()}function _nonIterableSpread$2(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$5(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$5(e,t):void 0}}function _iterableToArray$2(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles$2(e){if(Array.isArray(e))return _arrayLikeToArray$5(e)}function _arrayLikeToArray$5(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _objectWithoutProperties$6(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$7(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}var BorderBackgroundResourceConfig=function(e){var t=e.border,r=e.fillType,n=e.resourceSelector,o=e.onBorderTypeChange,i=e.resourceCenter,a=_objectWithoutProperties$6(e,_excluded$9),s=getImageResource$1(i,t),l=s.imageSource,c=s.imageSlice,u=l,d="color"===(null==t?void 0:t.type),h=c.length>0,p=isBaseResourceType(t)&&r===FILL_TYPE.BORDER&&c.length>0,f=u&&!p,g=u||d,m=[].concat(_toConsumableArray$2(u?["hue"]:[]),_toConsumableArray$2(g?["opacity"]:[]),_toConsumableArray$2(u?[["saturation","brightness","contrast"]]:[]));return jsx(Form.Item,_objectSpread$s(_objectSpread$s({label:duchampIntl.get("Duchamp-Border_Background")},a),{},{children:jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,children:[jsx(Form.Item,{name:"border",noStyle:!0,children:jsx(n,{onChange:o})}),u&&h&&jsx(Form.Item,{name:"fillType",noStyle:!0,children:jsx(RadioGroup$1,{options:FILL_TYPE_ITEMS})}),f&&jsx(Form.Item,{name:"backgroundFillType",noStyle:!0,children:jsx(RadioGroup$1,{options:BACKGROUND_FILL_TYPE_ITEMS})}),p&&jsx(Form.Item,{name:"borderScale",noStyle:!0,children:jsx(RadioGroup$1,{options:BORDER_SCALE_ITEMS})}),jsx(Form.Item,{name:"borderStyle",noStyle:!0,children:jsx(FilterProcessPanel,{layout:"vertical",components:m})})]})}))},UNITS=[{value:"px",min:0,max:1e3,label:"px"},{value:"%",min:0,max:200,label:"%"}],BorderRadius=function(e){var t=e.value,r=e.onChange,n=e.icon;return jsxs("div",{className:"border-radius-row",children:[n&&jsx(Icon$2,{type:n}),jsx(NumberUnitInput,{style:{flex:1},value:t,units:UNITS,onChange:r})]})},DEFAULT_BORDER_RADIUS$1={type:"px",value:0},DEFAULT_BORDER$1={format:"whole",topLeft:DEFAULT_BORDER_RADIUS$1,topRight:DEFAULT_BORDER_RADIUS$1,bottomLeft:DEFAULT_BORDER_RADIUS$1,bottomRight:DEFAULT_BORDER_RADIUS$1};function ownKeys$s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$s(Object(r),!0).forEach((function(t){_defineProperty$m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var BorderRadiusConfig$1=function(e){var t=e.value,r=void 0===t?DEFAULT_BORDER$1:t,n=e.onChange;return jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,children:[jsx(RadioGroup$1,{value:r.format,options:[{label:duchampIntl.get("Duchamp-Overall"),value:"whole"},{label:duchampIntl.get("Duchamp-Single"),value:"single"}],onChange:function(e){return null==n?void 0:n(_objectSpread$r(_objectSpread$r({},DEFAULT_BORDER$1),{},{format:e}))}}),"whole"===r.format?jsx(BorderRadius,{value:r.topLeft,onChange:function(e){return null==n?void 0:n(_objectSpread$r(_objectSpread$r({},r),{},{topLeft:e,topRight:e,bottomLeft:e,bottomRight:e}))}}):jsxs(Fragment,{children:[jsx(BorderRadius,{value:r.topLeft,icon:"icon-upper-left",onChange:function(e){return null==n?void 0:n(_objectSpread$r(_objectSpread$r({},r),{},{topLeft:e}))}}),jsx(BorderRadius,{value:r.topRight,icon:"icon-upper-right",onChange:function(e){return null==n?void 0:n(_objectSpread$r(_objectSpread$r({},r),{},{topRight:e}))}}),jsx(BorderRadius,{value:r.bottomLeft,icon:"icon-lower-left",onChange:function(e){return null==n?void 0:n(_objectSpread$r(_objectSpread$r({},r),{},{bottomLeft:e}))}}),jsx(BorderRadius,{value:r.bottomRight,icon:"icon-lower-right",onChange:function(e){return null==n?void 0:n(_objectSpread$r(_objectSpread$r({},r),{},{bottomRight:e}))}})]})]})};function ownKeys$r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$r(Object(r),!0).forEach((function(t){_defineProperty$l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$r(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var BorderRadiusConfig=function(e){return jsx(Form.Item,_objectSpread$q(_objectSpread$q({name:"borderRadius",label:duchampIntl.get("Duchamp-Border_Radius")},e),{},{children:jsx(BorderRadiusConfig$1,{})}))},_excluded$8=["onChange"];function ownKeys$q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$q(Object(r),!0).forEach((function(t){_defineProperty$k(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties$5(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$6(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$6(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}var DialogTypeConfig=function(e){var t=e.onChange,r=_objectWithoutProperties$5(e,_excluded$8);return jsx(Form.Item,_objectSpread$p(_objectSpread$p({name:"dialogType",label:duchampIntl.get("Duchamp-Display_Position")},r),{},{children:jsx(RadioGroup$1,{options:[{label:duchampIntl.get("Duchamp-Centered_Display"),value:DIALOG_TYPE.CENTER},{label:duchampIntl.get("Duchamp-Dynamic_Display"),value:DIALOG_TYPE.DYNAMIC}],onChange:t})}))};function ownKeys$p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$p(Object(r),!0).forEach((function(t){_defineProperty$j(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$j(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var PaddingSizeConfig=function(e){return jsx(Form.Item,_objectSpread$o(_objectSpread$o({name:"padding",label:duchampIntl.get("Duchamp-Inner_Margin")},e),{},{children:jsx(PaddingConfig,{paddingInputProps:{min:0}})}))};function ownKeys$o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$o(Object(r),!0).forEach((function(t){_defineProperty$i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var SizeConfig$1=function(e){return jsx(Form.Item,_objectSpread$n(_objectSpread$n({label:duchampIntl.get("Duchamp-Size")},e),{},{children:jsxs("div",{className:"size-wrapper",children:[jsxs("div",{className:"size-space-between",children:[jsx("span",{className:"size-title",children:"W"}),jsx(Form.Item,{name:"width",noStyle:!0,children:jsx(NumberInput$1,{min:10})})]}),jsxs("div",{className:"size-space-between",children:[jsx("span",{className:"size-title",children:"H"}),jsx(Form.Item,{name:"height",noStyle:!0,children:jsx(NumberInput$1,{min:10})})]})]})}))};function ownKeys$n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$n(Object(r),!0).forEach((function(t){_defineProperty$h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var SHOW_TYPE_DEFAULT={bold:!0,italic:!0,underline:!0},FontStyleConfig=function(e){var t=e.value,r=void 0===t?{fontSize:14}:t,n=e.onChange,o=e.showTypes,i=void 0===o?SHOW_TYPE_DEFAULT:o,a=e.className,s=e.prefixIcon;return jsxs("div",{className:classNames$1("font-style-wrapper",a),children:[i.bold&&jsx(Icon$2,{className:classNames$1("font-style-icon",{active:!!r.fontWeight}),type:"icon-bold",onClick:function(){null==n||n(_objectSpread$m(_objectSpread$m({},r),{},{fontWeight:r.fontWeight?void 0:"bold"}))}}),i.italic&&jsx(Icon$2,{className:classNames$1("font-style-icon",{active:!!r.fontStyle}),type:"icon-italic",onClick:function(){null==n||n(_objectSpread$m(_objectSpread$m({},r),{},{fontStyle:r.fontStyle?void 0:"italic"}))}}),i.underline&&jsx(Icon$2,{className:classNames$1("font-style-icon",{active:!!r.textDecoration}),type:"icon-underline",onClick:function(){null==n||n(_objectSpread$m(_objectSpread$m({},r),{},{textDecoration:r.textDecoration?void 0:"underline"}))}}),jsx(NumberInput$1,{value:r.fontSize,min:1,precision:0,onChange:function(e){null==n||n(_objectSpread$m(_objectSpread$m({},r),{},{fontSize:e}))},prefix:s})]})};function ownKeys$m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$m(Object(r),!0).forEach((function(t){_defineProperty$g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var TitleConfigPanel=function(e){var t=e.value,r=void 0===t?TITLE_DEFAULT_CONFIG:t,n=e.onChange,o=e.fontSelectRender,i=e.fontStyleIcon,a=e.colorPicker,s=void 0===a?ColorSelector:a,l=null==r?void 0:r.displayTitle,c={fontWeight:r.isBold?"bold":void 0,fontStyle:r.fontStyle,textDecoration:r.textDecoration,fontSize:r.fontSize};return jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,style:{gridTemplateColumns:"100%"},children:[jsx(Form.Item,{label:duchampIntl.get("Duchamp-Title"),children:jsx(Checkbox$4,{value:l,onChange:function(e){null==n||n(_objectSpread$l(_objectSpread$l({},r),{},{displayTitle:e}))},children:duchampIntl.get("Duchamp-Display_Title")})}),jsx(Form.Item,{hidden:!l,children:jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,children:[jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Font_Style"),style:{marginBottom:0},children:jsx(o,{value:r.fontFamily,onChange:function(e){null==n||n(_objectSpread$l(_objectSpread$l({},r),{},{fontFamily:e}))}})}),jsx("div",{className:"flex-center-space-between",children:jsx(FontStyleConfig,{value:c,onChange:function(e){null==n||n(_objectSpread$l(_objectSpread$l({},r),{},{isBold:"bold"===e.fontWeight,fontStyle:e.fontStyle,textDecoration:e.textDecoration,fontSize:e.fontSize}))},showTypes:{bold:!0,italic:!0,underline:!0},prefixIcon:i})}),jsx(s,{value:r.color,onChange:function(e){null==n||n(_objectSpread$l(_objectSpread$l({},r),{},{color:e}))}}),jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Basic_Align_Type"),children:jsx(RadioGroup$1,{value:r.textAlign,onChange:function(e){null==n||n(_objectSpread$l(_objectSpread$l({},r),{},{textAlign:e}))},options:[{label:duchampIntl.get("Duchamp-On_The_Left"),value:TEXT_LAYOUT.LEFT},{label:duchampIntl.get("Duchamp-Centered"),value:TEXT_LAYOUT.CENTER},{label:duchampIntl.get("Duchamp-On_The_Right"),value:TEXT_LAYOUT.RIGHT}]})})]})})]})},TitleConfig=function(e){var t=e.fontSelectRender,r=e.fontStyleIcon,n=e.colorPicker;return jsx(Form.Item,{name:"titleConfig",noStyle:!0,children:jsx(TitleConfigPanel,{fontSelectRender:t,fontStyleIcon:r,colorPicker:n})})};function ownKeys$l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$l(Object(r),!0).forEach((function(t){_defineProperty$f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var AssetTypeConfig=function(e){var t=e.value,r=void 0===t?{type:"color",value:{color:"#100B2B"}}:t,n=e.onChange,o=e.colorPicker,i=void 0===o?ColorSelector:o;return jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Color"),children:jsx(i,{value:r.value.color,onChange:function(e){return null==n?void 0:n(_objectSpread$k(_objectSpread$k({},r),{},{value:{color:e}}))}})})},WebPagePopoverAttribute={DialogType:DialogTypeConfig,Size:SizeConfig$1,Padding:PaddingSizeConfig,BorderRadius:BorderRadiusConfig,Title:TitleConfig,BorderBackgroundResource:BorderBackgroundResourceConfig};function _typeof$6(e){return(_typeof$6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _regeneratorRuntime$4(){_regeneratorRuntime$4=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(w){s=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),a=new T(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=b(a,r);if(s){if(s===u)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=c(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}(e,r,a),i}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(w){return{type:"throw",arg:w}}}e.wrap=l;var u={};function d(){}function h(){}function p(){}var f={};s(f,o,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(S([])));m&&m!==t&&r.call(m,o)&&(f=m);var y=p.prototype=d.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(o,i,a,s){var l=c(e[o],e,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==_typeof$6(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var o;this._invoke=function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}}function b(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var n=c(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=p,s(y,"constructor",p),s(p,"constructor",h),h.displayName=s(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},v(_.prototype),s(_.prototype,i,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new _(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=S,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:S(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}function ownKeys$k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$k(Object(r),!0).forEach((function(t){_defineProperty$e(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function asyncGeneratorStep$4(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void r(c)}s.done?t(l):Promise.resolve(l).then(n,o)}function _asyncToGenerator$4(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){asyncGeneratorStep$4(i,n,o,a,s,"next",e)}function s(e){asyncGeneratorStep$4(i,n,o,a,s,"throw",e)}a(void 0)}))}}function getFvsDataCacheById(e){return _getFvsDataCacheById.apply(this,arguments)}function _getFvsDataCacheById(){return(_getFvsDataCacheById=_asyncToGenerator$4(_regeneratorRuntime$4().mark((function e(t){return _regeneratorRuntime$4().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,db$1.dataCache.get(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function clearExpiredCache(){return _clearExpiredCache.apply(this,arguments)}function _clearExpiredCache(){return _clearExpiredCache=_asyncToGenerator$4(_regeneratorRuntime$4().mark((function e(){var t,r,n,o,i,a,s=arguments;return _regeneratorRuntime$4().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:30,r=(new Date).getTime(),e.next=4,db$1.dataCache.toArray();case 4:return n=e.sent,e.next=7,db$1.fileCache.toArray();case 7:return o=e.sent,i=n.filter((function(e){return r-e.updateTime>1e3*t*60*60*24})),a=o.filter((function(e){return r-e.updateTime>1e3*t*60*60*24})),e.next=12,db$1.dataCache.bulkDelete(i.map((function(e){return e.id})));case 12:return e.next=14,db$1.fileCache.bulkDelete(a.map((function(e){return e.url})));case 14:case"end":return e.stop()}}),e)}))),_clearExpiredCache.apply(this,arguments)}function updateDataCache(e){return _updateDataCache.apply(this,arguments)}function _updateDataCache(){return(_updateDataCache=_asyncToGenerator$4(_regeneratorRuntime$4().mark((function e(t){var r,n,o;return _regeneratorRuntime$4().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,e.next=3,db$1.dataCache.get(r);case 3:return n=e.sent,o=_objectSpread$j(_objectSpread$j({},t),{},{fields:_objectSpread$j(_objectSpread$j({},null==n?void 0:n.fields),t.fields),updateTime:(new Date).getTime()}),e.next=7,db$1.dataCache.put(o);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ownKeys$j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$j(Object(r),!0).forEach((function(t){_defineProperty$d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LazyRenderWrapper(e){var t,r=e.visible,n=e.style,o=e.forceRender,i=void 0!==o&&o,a=e.children,s=reactExports.useRef(r);return r&&(s.current=!0),t=r?a(!0,n):s.current||i?a(!1,_objectSpread$i(_objectSpread$i({},n),{},{display:"none"})):null,jsx(Fragment,{children:t})}function NotFoundPanel(e){return e.loading?jsx(Spin$1,{size:"small"}):jsx("div",{className:"empty-text",children:duchampIntl.get("Duchamp-No_Data")})}function ownKeys$i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$i(Object(r),!0).forEach((function(t){_defineProperty$c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function shiftTreeNodesData(e){return null==e?void 0:e.map((function(e){var t=isNil$3(e.children)&&!0!==e.lazy;return{key:e.id,title:e.name,isLeaf:t,selectable:t,children:shiftTreeNodesData(e.children),disabled:e.disable}}))}function getFieldType(e,t){var r;return null==e||null===(r=e.fields.find((function(e){return e.id===t})))||void 0===r?void 0:r.type}function mergeTreeChildrenNodes(e,t,r){return 0===e.length?e:e.map((function(e){return e.id===t?_objectSpread$h(_objectSpread$h({},e),{},{children:r}):e.children?_objectSpread$h(_objectSpread$h({},e),{},{children:mergeTreeChildrenNodes(e.children,t,r)}):e}))}function existNodeKey(e,t){var r;return null!==(r=e.some((function(e){var r;return e.id===t||existNodeKey(null!==(r=e.children)&&void 0!==r?r:[],t)})))&&void 0!==r&&r}function getRootNodeKey(e,t){var r;return null==e||null===(r=e.find((function(e){return existNodeKey([e],t)})))||void 0===r?void 0:r.id}function getTypeIcon$1(e){switch(e){case"number":return"icon-integer";case"date":return"icon-date-type";default:return"icon-character-string"}}function ownKeys$h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$h(Object(r),!0).forEach((function(t){_defineProperty$b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FieldSelector(e){var t=e.value,r=e.onChange,n=e.fields,o=e.loading,i=e.deleted;return jsx(Select$1,{className:classNames$1({"table-field-selector-error":i}),placeholder:duchampIntl.get("Duchamp-Please_Choose_Field"),style:{width:"100%"},value:i?duchampIntl.get("Duchamp-Deleted"):isNil$3(n)||isEmpty$3(t)?void 0:t,showSearch:!0,onChange:r,status:i?"error":void 0,popupClassName:"select-with-async-load-popup",notFoundContent:jsx(NotFoundPanel,{loading:o}),options:null==n?void 0:n.map((function(e){var t;return _objectSpread$g(_objectSpread$g({},e),{},{value:e.id,label:e.name,icon:jsx(Icon$2,{type:getTypeIcon$1(null!==(t=e.type)&&void 0!==t?t:"")})})}))})}function SummarySelector(e){var t=e.value,r=e.onChange,n=e.options,o=n&&t&&!n.map((function(e){return e.value})).includes(t);return jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Summary_Type"),className:"summary-selector-wrapper",children:jsx(Select$1,{className:classNames$1("summary-selector",{"table-field-selector-error":o}),value:o?duchampIntl.get("Duchamp-Summary_Mismatched"):t,options:n,status:o?"error":void 0,onChange:r,notFoundContent:jsx(NotFoundPanel,{loading:isNil$3(n)})})})}function _typeof$5(e){return(_typeof$5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _regeneratorRuntime$3(){_regeneratorRuntime$3=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(w){s=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),a=new T(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=b(a,r);if(s){if(s===u)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=c(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}(e,r,a),i}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(w){return{type:"throw",arg:w}}}e.wrap=l;var u={};function d(){}function h(){}function p(){}var f={};s(f,o,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(S([])));m&&m!==t&&r.call(m,o)&&(f=m);var y=p.prototype=d.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(o,i,a,s){var l=c(e[o],e,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==_typeof$5(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var o;this._invoke=function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}}function b(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var n=c(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=p,s(y,"constructor",p),s(p,"constructor",h),h.displayName=s(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},v(_.prototype),s(_.prototype,i,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new _(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=S,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:S(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}function asyncGeneratorStep$3(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void r(c)}s.done?t(l):Promise.resolve(l).then(n,o)}function _asyncToGenerator$3(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){asyncGeneratorStep$3(i,n,o,a,s,"next",e)}function s(e){asyncGeneratorStep$3(i,n,o,a,s,"throw",e)}a(void 0)}))}}function _slicedToArray$4(e,t){return _arrayWithHoles$4(e)||_iterableToArrayLimit$4(e,t)||_unsupportedIterableToArray$4(e,t)||_nonIterableRest$4()}function _nonIterableRest$4(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$4(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$4(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$4(e,t):void 0}}function _arrayLikeToArray$4(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$4(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==r.return||r.return()}finally{if(s)throw o}}return i}}function _arrayWithHoles$4(e){if(Array.isArray(e))return e}function TableSelector(e){var t,r,n=e.value,o=e.onChange,i=e.name,a=e.deleted,s=e.getTableNodeList,l=e.searchTable,c=_slicedToArray$4(reactExports.useState([]),2),u=c[0],d=c[1],h=_slicedToArray$4(reactExports.useState(),2),p=h[0],f=h[1],g=_slicedToArray$4(reactExports.useState([]),2),m=g[0],y=g[1],v=reactExports.useCallback(_asyncToGenerator$3(_regeneratorRuntime$3().mark((function e(){var t,r;return _regeneratorRuntime$3().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==s?void 0:s({currentTable:n});case 2:(t=e.sent)&&(d(t),r=getRootNodeKey(t,n),y(r?[r]:t.filter((function(e){return!e.lazy})).map((function(e){return e.id}))));case 4:case"end":return e.stop()}}),e)}))),[n]),_=reactExports.useMemo((function(){return debounce$4((e=_asyncToGenerator$3(_regeneratorRuntime$3().mark((function e(t){var r;return _regeneratorRuntime$3().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l){e.next=10;break}if(!t){e.next=9;break}return e.next=4,l(t);case 4:r=e.sent,d(r),y(r.map((function(e){return e.id}))),e.next=10;break;case 9:v();case 10:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)}),500);var e}),[v]),b=reactExports.useMemo((function(){return a?duchampIntl.get("Duchamp-Deleted"):existNodeKey(u,n)?n:isEmpty$3(i)?void 0:i}),[a,i,u,n]);return jsx(TreeSelect$1,{className:classNames$1({"table-field-selector-error":a}),placeholder:duchampIntl.get("Duchamp-Please_Choose_Table"),style:{width:"100%"},value:b,onDropdownVisibleChange:(r=_asyncToGenerator$3(_regeneratorRuntime$3().mark((function e(t){return _regeneratorRuntime$3().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&isEmpty$3(u)&&v();case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)}),status:a?"error":void 0,onLoadData:(t=_asyncToGenerator$3(_regeneratorRuntime$3().mark((function e(t){var r,n,o;return _regeneratorRuntime$3().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.key.toString(),!((null!==(r=t.children)&&void 0!==r?r:[]).length>0)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,null==s?void 0:s({key:n});case 5:(o=e.sent)&&d(mergeTreeChildrenNodes(u,n,o));case 7:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)}),showSearch:!0,onChange:function(e){null==o||o(e.toString())},popupClassName:"select-with-async-load-popup",notFoundContent:jsx(NotFoundPanel,{loading:isEmpty$3(u)}),treeData:shiftTreeNodesData(u),onSearch:function(e){f(e),l&&(d([]),_(e))},searchValue:p,treeExpandedKeys:m,onTreeExpand:function(e){return y(e)}})}function _typeof$4(e){return(_typeof$4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys$g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$g(Object(r),!0).forEach((function(t){_defineProperty$a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _regeneratorRuntime$2(){_regeneratorRuntime$2=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(w){s=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),a=new T(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=b(a,r);if(s){if(s===u)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=c(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}(e,r,a),i}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(w){return{type:"throw",arg:w}}}e.wrap=l;var u={};function d(){}function h(){}function p(){}var f={};s(f,o,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(S([])));m&&m!==t&&r.call(m,o)&&(f=m);var y=p.prototype=d.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(o,i,a,s){var l=c(e[o],e,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==_typeof$4(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var o;this._invoke=function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}}function b(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var n=c(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=p,s(y,"constructor",p),s(p,"constructor",h),h.displayName=s(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},v(_.prototype),s(_.prototype,i,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new _(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=S,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:S(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}function asyncGeneratorStep$2(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void r(c)}s.done?t(l):Promise.resolve(l).then(n,o)}function _asyncToGenerator$2(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){asyncGeneratorStep$2(i,n,o,a,s,"next",e)}function s(e){asyncGeneratorStep$2(i,n,o,a,s,"throw",e)}a(void 0)}))}}var DatasetConfig$1=function(e){var t=e.value,r=e.onChange,n=e.fetcher,o=n.getTableInfo,i=n.getSummaryInfo,a=n.getTableNodeList,s=n.searchTable,l=useAsync(_asyncToGenerator$2(_regeneratorRuntime$2().mark((function e(){var r;return _regeneratorRuntime$2().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==o?void 0:o(t.dataSet);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)}))),[t.dataSet]),c=l.value,u=l.loading,d=reactExports.useCallback((function(e,n){if("field"===n&&i){var o=getFieldType(c,e);if(o){var a=(null==i?void 0:i())[o].defaultValue;r(_objectSpread$f(_objectSpread$f({},t),{},{field:e,summary:a}))}}else if("dataSet"===n){var s;r(_objectSpread$f(_objectSpread$f({},t),{},(_defineProperty$a(s={},n,e),_defineProperty$a(s,"field",""),s)))}else r(_objectSpread$f(_objectSpread$f({},t),{},_defineProperty$a({},n,e)))}),[r,t,c,i]),h=reactExports.useMemo((function(){return!(!t.dataSet||u)&&(isNil$3(c)||!0===c.deleted)}),[u,t.dataSet,c]),p=reactExports.useMemo((function(){return!(!t.field||u)&&(!!h||!(null!=c&&c.fields.map((function(e){return e.id})).includes(t.field)))}),[h,u,t.field,null==c?void 0:c.fields]),f=reactExports.useMemo((function(){if(!t.field||!i||p)return[];var e=getFieldType(c,t.field),r=i();return e?r[e].options:[]}),[t.field,i,c,p]);return jsxs(GridItem,{gapSize:8,className:"dataset-config",children:[jsx(TableSelector,{value:t.dataSet,onChange:function(e){return d(e,"dataSet")},name:null==c?void 0:c.name,deleted:h,getTableNodeList:a,searchTable:s}),t.dataSet&&jsx(FieldSelector,{value:t.field,onChange:function(e){return d(e,"field")},loading:u,fields:null==c?void 0:c.fields,deleted:p}),f.length>0&&jsx(SummarySelector,{value:t.summary,onChange:function(e){return d(e,"summary")},options:f})]})};function ownKeys$f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$e(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$f(Object(r),!0).forEach((function(t){_defineProperty$9(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$9(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var DynamicValueSourceConfig=function(e){var t=e.value,r=e.onChange,n=e.fetcher,o=e.showFormulaDialog;return jsxs(GridItem,{gapSize:8,children:[o&&jsx(RadioGroup$1,{value:t.type,options:[{label:duchampIntl.get("Duchamp-Field"),value:"dataset"},{label:duchampIntl.get("Duchamp-Formula"),value:"formula"}],onChange:function(e){r("dataset"===e?DEFAULT_DYNAMIC_DATASET_SOURCE:DEFAULT_FORMULA_DATASET_SOURCE)}}),isDynamicDatasetSource(t)?jsx(DatasetConfig$1,{value:{dataSet:t.dataSet,field:t.field,summary:t.summary},onChange:function(e){return r(_objectSpread$e(_objectSpread$e({},t),e))},fetcher:n}):jsx(FormulaInput$1,{value:t.formula,onChange:function(e){return r(_objectSpread$e(_objectSpread$e({},t),{},{formula:e}))},showFormulaDialog:o})]})};function _toConsumableArray$1(e){return _arrayWithoutHoles$1(e)||_iterableToArray$1(e)||_unsupportedIterableToArray$3(e)||_nonIterableSpread$1()}function _nonIterableSpread$1(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$3(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$3(e,t):void 0}}function _iterableToArray$1(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles$1(e){if(Array.isArray(e))return _arrayLikeToArray$3(e)}function _arrayLikeToArray$3(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ownKeys$e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$e(Object(r),!0).forEach((function(t){_defineProperty$8(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$8(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DynamicValueConfigPanel(e){var t,r=e.value,n=e.onValueChange,o=e.onConfirm,i=e.onCancel,a=e.checkName,s=e.className,l=e.visible,c=void 0===l||l,u=e.container,d=e.fetcher,h=e.showFormulaDialog,p=e.conditionConfigPanel,f=e.footer;return jsx(FvsDrawer,{visible:c,container:u,onClose:i,style:{padding:0},header:jsxs("div",{className:classNames$1("dynamic-value-config-panel-header",s),children:[jsx("span",{className:"header-title",children:duchampIntl.get("Duchamp-Edit_Dynamic_Value")}),jsx(Icon$2,{type:"icon-close",className:"header-icon",onClick:i})]}),mask:!0,maskStyle:{background:"none"},footer:f||jsxs("div",{className:"dynamic-value-config-panel-footer",children:[jsx(Button$4,{className:"footer-button",onClick:i,children:duchampIntl.get("Duchamp-Cancel")}),jsx(Button$4,{className:"footer-button",type:"primary",onClick:function(){o(isNil$3(p)?_objectSpread$d(_objectSpread$d({},r),{},{conditionStyles:[]}):r)},children:duchampIntl.get("Duchamp-Sure")})]}),children:jsx("div",{className:"dynamic-value-config-panel-content",children:jsxs(GridItem,{children:[jsx(LineItem,{label:duchampIntl.get("Duchamp-Dynamic_Value_Source"),children:jsx(DynamicValueSourceConfig,{value:r.source,onChange:function(e){return n({source:e})},fetcher:d,showFormulaDialog:h})}),r.name&&jsx(LineItem,{label:duchampIntl.get("Duchamp-Name"),icon:jsx(IconPopover,{arrow:{pointAtCenter:!0},icon:"icon-help",placement:"top-left",text:duchampIntl.get("Duchamp-Dynamic_Value_Name_Tip")}),children:jsx(ValidationInput,{value:r.name,rules:[{required:!0,message:duchampIntl.get("Duchamp-Content_Cannot_Be_Empty")}].concat(_toConsumableArray$1(a?[{validate:a,message:duchampIntl.get("Duchamp-Duplicate_Name_Exists_Tip")}]:[])),onChange:function(e){n({name:e})},placeholder:duchampIntl.get("Duchamp-Please_Enter")})}),jsxs(LineItem,{label:duchampIntl.get("Duchamp-Format"),children:[jsx(FormatterSelector,{value:r.formatter,onChange:function(e){return n({formatter:e})}}),(null===(t=getFormatterMeta(r.formatter.type))||void 0===t?void 0:t.options)&&jsxs("div",{className:"formatter-example",children:[jsx("span",{className:"formatter-example-label",children:duchampIntl.get("Duchamp-Example_Width_Colon")}),getExampleValue(r.formatter)]})]}),p]})})})}function ownKeys$d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$d(Object(r),!0).forEach((function(t){_defineProperty$7(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$7(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _slicedToArray$3(e,t){return _arrayWithHoles$3(e)||_iterableToArrayLimit$3(e,t)||_unsupportedIterableToArray$2(e,t)||_nonIterableRest$3()}function _nonIterableRest$3(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$2(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$2(e,t):void 0}}function _arrayLikeToArray$2(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$3(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==r.return||r.return()}finally{if(s)throw o}}return i}}function _arrayWithHoles$3(e){if(Array.isArray(e))return e}function DynamicValueInput(e){var t=e.value,r=e.type,n=e.placeholder,o=e.onChange,i=e.fetcher,a=e.showFormulaDialog,s=_slicedToArray$3(reactExports.useState(null),2),l=s[0],c=s[1],u=reactExports.useRef(!1),d={ops:t?t.map(convertDynamicValueInputValueToRichTextDeltaOp):[]},h=function(e){null==o||o(convertOpToDynamicValue(e.ops))},p=reactExports.useRef(null);return jsxs("div",{className:"default"===r?"url-input-rich-editor":"url-input-rich-editor-textarea",children:[jsx(RichTextCore,{value:shiftRichTextValue(d),supportFormats:[DYNAMIC_VALUE_EMBED_KEY$1],placeholder:n,onChange:function(e){var t=unShiftRichTextValue(e);h(t)},toolbar:{position:RICH_TEXT_TOOLBAR_POSITION.BOTTOM,value:[[{key:DYNAMIC_VALUE_EMBED_KEY$1,View:function(){return jsx(IconTextButton,{icon:"icon-dynamic-value",text:duchampIntl.get("Duchamp-Insert_Dynamic_Value"),onClick:function(){var e,t=createDefaultDynamicValue(d.ops);c(t),u.current=!0,null===(e=p.current)||void 0===e||e.insertEmbed({id:t.id,key:DYNAMIC_VALUE_EMBED_KEY$1,value:t})},className:"add-dynamic-value"})}}]]},embeds:[{key:DYNAMIC_VALUE_EMBED_KEY$1,render:function(e,t){renderDynamicValue(e,t.value,(function(){c(t.value),u.current=!1})),e.onmousedown=function(t){t.stopPropagation(),e.classList.add("active")},e.onclick=function(t){var r;t.stopPropagation(),e.classList.add("active"),null===(r=p.current)||void 0===r||r.addSelectionChangeListenOnce((function(){e.classList.remove("active")}))}}}],ref:p}),l&&jsx(DynamicValueConfigPanel,{value:l,checkName:function(e){return checkDynamicValueName(e,l.id,d.ops)},showFormulaDialog:a,fetcher:i,onValueChange:function(e){var t,r=_objectSpread$c(_objectSpread$c({},l),e);null===(t=p.current)||void 0===t||t.modifyEmbed({id:l.id,key:DYNAMIC_VALUE_EMBED_KEY$1,value:r}),c(r)},onCancel:function(){var e,t;u.current&&(null===(e=p.current)||void 0===e||e.deleteEmbed({id:l.id,key:DYNAMIC_VALUE_EMBED_KEY$1,value:l})),c(null),null===(t=p.current)||void 0===t||t.focus()},onConfirm:function(e){var t;h(_objectSpread$c(_objectSpread$c({},d),{},{ops:replaceDynamicValue(e,d.ops)})),c(null),null===(t=p.current)||void 0===t||t.focus()}})]})}function ownKeys$c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$c(Object(r),!0).forEach((function(t){_defineProperty$6(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$6(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PathInputButton$1(e){var t=e.value,r=void 0===t?{value:[],pathType:PATH_TYPE.URL}:t,n=e.type,o=void 0===n?"default":n,i=e.fetcher,a=e.showFormulaDialog,s=e.onChange,l=e.openFileSelector,c=r.pathType,u=r.value;return jsx(Fragment,{children:c===PATH_TYPE.URL?jsx(DynamicValueInput,{placeholder:duchampIntl.get("Duchamp-Please_Enter_The_Web_Link_Address"),onChange:function(e){null==s||s(_objectSpread$b(_objectSpread$b({},r),{},{value:e}))},value:u,type:o,fetcher:i,showFormulaDialog:a}):jsxs(Fragment,{children:["default"===o?jsx(Input$2,{onChange:function(e){null==s||s(_objectSpread$b(_objectSpread$b({},r),{},{value:e}))},value:u,placeholder:duchampIntl.get("Duchamp-Please_Enter_The_Template_Link_Address")}):jsx(TextArea,{className:"path-input-button-textarea",inputClassName:"path-input-button-inner-textarea",onChange:function(e){null==s||s(_objectSpread$b(_objectSpread$b({},r),{},{value:e}))},value:u,placeholder:duchampIntl.get("Duchamp-Please_Enter_The_Template_Link_Address")}),jsx("div",{className:"path-input-button",children:jsx(IconTextButton,{icon:"icon-add",text:duchampIntl.get("Duchamp-Choose_A_Template"),onClick:function(){return null==l?void 0:l((function(e){null==s||s(_objectSpread$b(_objectSpread$b({},r),{},{value:e}))}))}})})]})})}var PathInput$1=function(e){var t,r=e.value,n=void 0===r?{value:[],pathType:PATH_TYPE.URL}:r,o=e.type,i=void 0===o?"default":o,a=e.onChange,s=e.openFileSelector,l=e.componentType,c=void 0===l?"radioGroup":l,u=e.style,d=e.fetcher,h=e.showFormulaDialog,p=n.pathType,f="select"===c?Select$1:RadioGroup$1,g=[{label:duchampIntl.get("Duchamp-Web_Links"),value:PATH_TYPE.URL}];return!1!==(null===(t=e.config)||void 0===t?void 0:t.hasTemplate)&&g.push({label:duchampIntl.get("Duchamp-Template_Link"),value:PATH_TYPE.TEMPLATE}),jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[jsx(f,{style:u,value:p,onChange:function(e){"url"===e?null==a||a({value:[],pathType:e}):null==a||a({value:"",pathType:e})},options:g}),jsx(PathInputButton$1,{onChange:a,value:n,type:i,openFileSelector:s,fetcher:d,showFormulaDialog:h})]})},_excluded$7=["inputStyle","popupClassName"];function ownKeys$b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$b(Object(r),!0).forEach((function(t){_defineProperty$5(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$5(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties$4(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$5(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}var AutoComplete=function(e){var t=e.inputStyle,r=e.popupClassName,n=_objectWithoutProperties$4(e,_excluded$7);return jsx(AutoComplete$1,_objectSpread$a({inputStyle:_objectSpread$a({width:"100%"},t),popupClassName:classNames$1(r,FVS_THEME_SCOPE)},n))};function _typeof$3(e){return(_typeof$3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var _excluded$5=["optionsFn","options","style"];function ownKeys$a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$9(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$a(Object(r),!0).forEach((function(t){_defineProperty$4(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$4(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _regeneratorRuntime$1(){_regeneratorRuntime$1=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(w){s=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),a=new T(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=b(a,r);if(s){if(s===u)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=c(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}(e,r,a),i}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(w){return{type:"throw",arg:w}}}e.wrap=l;var u={};function d(){}function h(){}function p(){}var f={};s(f,o,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(S([])));m&&m!==t&&r.call(m,o)&&(f=m);var y=p.prototype=d.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(o,i,a,s){var l=c(e[o],e,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==_typeof$3(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var o;this._invoke=function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}}function b(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var n=c(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=p,s(y,"constructor",p),s(p,"constructor",h),h.displayName=s(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},v(_.prototype),s(_.prototype,i,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new _(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=S,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:S(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}function asyncGeneratorStep$1(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void r(c)}s.done?t(l):Promise.resolve(l).then(n,o)}function _asyncToGenerator$1(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){asyncGeneratorStep$1(i,n,o,a,s,"next",e)}function s(e){asyncGeneratorStep$1(i,n,o,a,s,"throw",e)}a(void 0)}))}}function _objectWithoutProperties$3(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$4(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}function AsyncSelect(e){var t=e.optionsFn,r=e.options,n=e.style,o=_objectWithoutProperties$3(e,_excluded$5),i=useAsync(_asyncToGenerator$1(_regeneratorRuntime$1().mark((function e(){return _regeneratorRuntime$1().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return e.next=3,t();case 3:return e.abrupt("return",e.sent);case 4:return e.abrupt("return",[]);case 5:case"end":return e.stop()}}),e)}))),[]);return jsx(Select$1,_objectSpread$9({style:_objectSpread$9({width:"100%"},n),loading:i.loading,notFoundContent:i.loading?jsx("div",{style:{textAlign:"center"},children:jsx(Spin$1,{center:!0})}):void 0,options:r||i.value},o))}function _typeof$2(e){return(_typeof$2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var _excluded$4=["value","onChange","queryFontFamily"];function ownKeys$9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$8(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$9(Object(r),!0).forEach((function(t){_defineProperty$3(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$9(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$3(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(w){s=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),a=new T(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=b(a,r);if(s){if(s===u)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=c(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}(e,r,a),i}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(w){return{type:"throw",arg:w}}}e.wrap=l;var u={};function d(){}function h(){}function p(){}var f={};s(f,o,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(S([])));m&&m!==t&&r.call(m,o)&&(f=m);var y=p.prototype=d.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(o,i,a,s){var l=c(e[o],e,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==_typeof$2(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var o;this._invoke=function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}}function b(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var n=c(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=p,s(y,"constructor",p),s(p,"constructor",h),h.displayName=s(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},v(_.prototype),s(_.prototype,i,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new _(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=S,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:S(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}function asyncGeneratorStep(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void r(c)}s.done?t(l):Promise.resolve(l).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){asyncGeneratorStep(i,n,o,a,s,"next",e)}function s(e){asyncGeneratorStep(i,n,o,a,s,"throw",e)}a(void 0)}))}}function _objectWithoutProperties$2(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$3(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}var FONT_FAMILY_MAP={"黑体":"STHeiti, Hei, SimHei, 黑体","宋体":"STSong, Song, SimSun, 宋体","仿宋":"STFangSong, Fang Song, FangSong, 仿宋","楷体":"STKaiti, Kai, KaiTi, 楷体"},FontSelect$1=function(e){var t,r=e.value,n=e.onChange,o=e.queryFontFamily,i=_objectWithoutProperties$2(e,_excluded$4);return jsx(AsyncSelect,_objectSpread$8({className:"font-select",optionsFn:_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:return t=e.sent,e.abrupt("return",t.map((function(e){var t;return{value:null!==(t=FONT_FAMILY_MAP[e.value])&&void 0!==t?t:e.value,label:e.label}})));case 4:case"end":return e.stop()}}),e)}))),value:null!==(t=FONT_FAMILY_MAP[r])&&void 0!==t?t:r.replace(new RegExp(/"|'/,"g"),""),onSelect:function(e){n(formatFontFamily(e))},showSearch:!0},i))};function formatFontFamily(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.includes("'")?'"':"'";return Object.values(FONT_FAMILY_MAP).includes(e)?e:"".concat(t).concat(e).concat(t)}const debounce$3=({delay:e},t)=>{let r,n=!0;const o=(...o)=>{n?(clearTimeout(r),r=setTimeout((()=>{n&&t(...o),r=void 0}),e)):t(...o)};return o.isPending=()=>void 0!==r,o.cancel=()=>{n=!1},o.flush=(...e)=>t(...e),o},throttle=({interval:e},t)=>{let r,n=!0;const o=(...o)=>{n&&(t(...o),n=!1,r=setTimeout((()=>{n=!0,r=void 0}),e))};return o.isThrottled=()=>void 0!==r,o},toFloat=(e,t)=>{const r=void 0===t?0:t;if(null==e)return r;const n=parseFloat(e);return isNaN(n)?r:n};function getTargetElement$1(e){if(!e)return;let t;return t="function"==typeof e?e():"current"in e?e.current:e,t}function createVisibilityMonitor(e,t){let r=null;const n=()=>{const n=!isElementInvisible(e);null!==r&&r!==n&&t(n),r=n},o=new ResizeObserver(n);return o.observe(e),n(),()=>{o.disconnect(),r=null}}function ok(e){return{success:!0,value:e}}function err(e){return{success:!1,error:e}}function arrayMove(e,t,r,n=1){return e.splice(r,0,...e.splice(t,n)),e}const MARQUEE_CONTENT={ITEM:"item",FULL:"full"},MARQUEE_DIRECTION={TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right"},MARQUEE_MODE={END_TO_END:"endToEnd",START_NEW:"startNew"};let BaseScrollAction$1=class{constructor(e){__publicField(this,"config"),this.config=e}setConfig(e){this.config={...this.config,...e}}start(){var e;(null==(e=this.config)?void 0:e.enable)&&this.startInternal(this.createOption())}stop(){this.stopInternal()}createOption(){return this.config}},DomScrollAction$1=class extends BaseScrollAction$1{constructor(e,t,r){super(e),__publicField(this,"timer",null),__publicField(this,"marqueeRef"),__publicField(this,"marqueeContentRef"),__publicField(this,"onMouseEnter"),__publicField(this,"onMouseLeave"),this.config=e,this.marqueeRef=t,this.marqueeContentRef=r}startInternal(){(void 0===this.config.stopOnHover||this.config.stopOnHover)&&this.addEventListener(),this.run()}stopInternal(){this.pause(),this.reset(),this.removeEventListener()}addEventListener(){const e=getTargetElement$1(this.marqueeRef);this.onMouseEnter=()=>{this.pause()},this.onMouseLeave=()=>{this.run()},null==e||e.addEventListener("mouseenter",this.onMouseEnter),null==e||e.addEventListener("mouseleave",this.onMouseLeave)}removeEventListener(){const e=getTargetElement$1(this.marqueeRef);this.onMouseEnter&&(null==e||e.removeEventListener("mouseenter",this.onMouseEnter)),this.onMouseLeave&&(null==e||e.removeEventListener("mouseleave",this.onMouseLeave))}reset(){this.getContentDoms(this.marqueeContentRef).forEach((e=>{e.style.transform="",e.style.backfaceVisibility="",e.style.willChange=""}))}pause(){this.timer&&window.cancelAnimationFrame(this.timer)}run(){const e=this.getContentDoms(this.marqueeContentRef),t=getTargetElement$1(this.marqueeRef);if(t&&e.length>0){const r=this.config.direction===MARQUEE_DIRECTION.LEFT||this.config.direction===MARQUEE_DIRECTION.RIGHT,n=()=>r?{boxLength:t.offsetWidth,contentLength:this.getContentRect(e).width}:{boxLength:t.offsetHeight,contentLength:this.getContentRect(e).height},o=()=>r?this.getContentRect(e).x:this.getContentRect(e).y,i=()=>r?this.getCurrentPosition(e[0].style.transform,"translateX"):this.getCurrentPosition(e[0].style.transform,"translateY"),a=t=>{e.forEach((e=>{e.style.transform=r?"translateX(".concat(t,"px) translateZ(0)"):"translateY(".concat(t,"px) translateZ(0)"),e.style.backfaceVisibility="hidden",e.style.willChange="transform"}))},s=this.config.direction===(r?MARQUEE_DIRECTION.RIGHT:MARQUEE_DIRECTION.BOTTOM);this.runInternal(n,o,i,a,s)}}runInternal(e,t,r,n,o){let i=null,a=0,s=0,l=0;const c=u=>{const d=i?u-i:0,{contentLength:h,boxLength:p}=e();let f=null;if(h>0&&p>0&&d>=a){const e=r();let c=p-t(),g=-h-t(),m=-this.config.speed*(d-a)/1e3;o&&([c,g]=[g,c],m=-m),f=this.getPosition(m,c,e,g,o);const y=Math.round(f+s);s+=f-y,n(y),i=u,a=0!==d&&0===y&&0!==l?timeUnitToMillisecond(this.config.stay):0,l=y}this.timer=window.requestAnimationFrame(c)};this.timer=window.requestAnimationFrame(c)}getPosition(e,t,r,n,o){let i=r+e;return(!o&&i<n||o&&i>n)&&(i=t),Math.abs(i)<Math.abs(e)&&(i=0),i}getCurrentPosition(e,t){var r;const n=RegExp("".concat(t,"\\((.+)\\)")),o=null==(r=e.match(n))?void 0:r[1];return o?parseFloat(o):0}getContentDoms(e){const t=[];return(isArray$d(e)?e:[e]).forEach((e=>{const r=getTargetElement$1(e);r&&t.push(r)})),t}getContentRect(e){let t=Number.MAX_VALUE,r=Number.MAX_VALUE,n=Number.MIN_VALUE,o=Number.MIN_VALUE;for(const i of e)t=Math.min(t,i.offsetLeft),r=Math.min(r,i.offsetTop),n=Math.max(n,i.offsetLeft+i.offsetWidth),o=Math.max(o,i.offsetTop+i.offsetHeight);return{x:t,y:r,width:n-t,height:o-r}}};function useMarquee$2(e){const t=reactExports.useRef(null),r=reactExports.useRef(null),[n,o]=reactExports.useState(null);return reactExports.useEffect((()=>(null==n||n.start(),()=>{null==n||n.stop()})),[n]),reactExports.useEffect((()=>{e&&o(new DomScrollAction$1(e,t,r))}),[e]),{containerRef:t,contentRef:r}}const BUTTON_GROUP_FIT_MODE={AUTO:"auto",FIXED_COLUMN:"column",FIXED_ROW:"row"},getColumn$1=(e,t)=>{switch(e.type){case BUTTON_GROUP_FIT_MODE.FIXED_COLUMN:return e.payload.count;case BUTTON_GROUP_FIT_MODE.FIXED_ROW:return Math.ceil(t/e.payload.count);case BUTTON_GROUP_FIT_MODE.AUTO:default:return 0}},useFitConfig=(e,t)=>reactExports.useMemo((()=>({isAdaptive:e.type===BUTTON_GROUP_FIT_MODE.AUTO,cols:getColumn$1(e,t)})),[e,t]);function useI18n(){const{t:e,locale:t}=reactExports.useContext(I18nContext);return{t:e,locale:t}}function useEnv(){return reactExports.useContext(EnvContext)}function useAssetUrl(e){const{assetBaseUrl:t,buildInfo:r}=reactExports.useContext(EnvContext);return reactExports.useMemo((()=>{const n=e.startsWith("/")?e.slice(1):e;return addSearchParamToUrl("".concat(t,"/assets/").concat(n),{tag:r.timeStamp})}),[t,e,r.timeStamp])}const useFrameParentDuchamp$1=(e,t,r=window)=>{const n=reactExports.useRef(null);return reactExports.useEffect((()=>{var t;if(n.current){const{contentWindow:i}=n.current;try{if(null==(t=null==i?void 0:i.parent)?void 0:t.duchamp)Object.defineProperty(i,"parent",{get:()=>r});else{const t={};Object.defineProperty(i,"parent",{value:new Proxy(t,{get:(t,n)=>{if("duchamp"===n)return e;if(Object.hasOwn(t,n))return t[n];const o=r[n];return"function"==typeof o?o.bind(r):o}})})}}catch(o){console.error(o)}}}),t),n};function getTextSizeHeight(e,t=12){const r=document.createElement("span"),n="".concat(t,"px");r.style.fontSize=n,r.innerText=e,document.body.appendChild(r);const{height:o}=r.getBoundingClientRect();return r.remove(),o}const paintWaterMark=(e,t,r)=>{const{text:n,fontSize:o,color:i,verticalGap:a,horizontalGap:s}=r,l="Microsoft YaHei",c=.15,u="normal",d=20*Math.PI/180,{width:h,height:p}=e,f=n.split("<br/>"),g=h*Math.cos(d)+p*Math.sin(d),m=h*Math.sin(d)+p/Math.cos(d),y=t.getContext("2d");if(null==y||y.clearRect(0,0,t.width,t.height),0===g||0===m)return;t.width=g,t.height=m;const v=t.getContext("2d");if(!v)return;v.rotate(-d),v.font="".concat(u," ").concat(o,"px ").concat(l),v.fillStyle=i||"",v.globalAlpha=c,v.textAlign="center";const _=f.reduce(((e,t)=>Math.max(e,v.measureText(t).width)),0)+(s||100),b=getTextSizeHeight(n,o),C=b*f.length+(a||50),E=Math.floor(g/_),T=Math.floor(m/C),S=e.height*Math.tan(d);for(let x=0;x<=T;x++){const e=x*C,t=x%2==0?-_/2:0;for(let r=0;r<E+3;r++){const n=r*_-S+t;for(let t=0;t<f.length;t++){const r=e+b*t;v.fillText(f[t],n,r)}}}const P=e.getContext("2d");if(!P)return;const w=P.createPattern(t,"no-repeat");w&&(P.fillStyle=w,P.fillRect(0,0,t.width,t.height))};function useFetcher(e){const t=reactExports.useContext(FetchContext);if(!t)throw new Error("FetchInfo is not found");return t[e]}const EXPORT_EXCEL_TYPE={SIMPLE:"simple",PAGE:"page",SIMPLE_IS_EXCEL_2003:"simple_isExcel2003",PAGE_IS_EXCEL_2003:"page_isExcel2003"};function WeekDayFormatView({value:e,onChange:t}){const{enabled:r,weekFormat:n}=e,{t:o}=useI18n(),i=[{label:"EEE",value:WEEKDAY_FORMAT_TYPE.EEE},{label:"EEEE",value:WEEKDAY_FORMAT_TYPE.EEEE},{label:o("Duchamp-Week_Format_CN_ABBR"),value:WEEKDAY_FORMAT_TYPE.ABBR_CN},{label:o("Duchamp-Week_Format_CN"),value:WEEKDAY_FORMAT_TYPE.CN},{label:o("Duchamp-Week_Format_EN"),value:WEEKDAY_FORMAT_TYPE.EN},{label:o("Duchamp-Week_Format_EN_ABBR"),value:WEEKDAY_FORMAT_TYPE.ABBR_EN}];return jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,children:[jsx(Checkbox$4,{value:r,onChange:r=>t({...e,enabled:r}),text:o("Duchamp-Week_Display")}),r&&jsx(Select$1,{style:{width:"100%"},options:i,value:n,onChange:r=>t({...e,weekFormat:r})})]})}const TOOLBAR_BUTTON_TYPE$2={PAGE:"page",PAGE_EXPORT:"pageExport",SIMPLE_EXPORT:"simpleExport",ZOOM:"zoom"},TOOLBAR_BUTTON_STYLE={LIGHT:"light",DARK:"dark"},TOOL_BAR_POSITION={TOP:"top",BOTTOM:"bottom"},TABS_SHOW_TYPE={FIX:"fix",FLOAT:"float"};class RenderProgress{constructor(e=!0){__publicField(this,"progress",0),__publicField(this,"callbacks",[]),this.autoFinished=e}finish(){this.callbacks.forEach((e=>e("finished"))),this.callbacks=[]}update(e){this.progress=e,this.callbacks.forEach((t=>{t(e)})),e>=1&&this.autoFinished&&this.finish()}subscribe(e){return this.progress>=1?(e("finished"),{dispose:()=>{}}):(this.callbacks.push(e),{dispose:()=>{this.unsubscribe(e)}})}unsubscribe(e){this.callbacks=this.callbacks.filter((t=>t!==e))}}function isParameterLinkageEvent(e,t){return"parameterLinkage"===e}function isHyperlinkEvent(e,t){return"hyperlink"===e}function isJavascriptEvent(e,t){return"javascript"===e}const SvgIconAdaptiveCanvas=e=>reactExports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em",...e},reactExports.createElement("path",{d:"M875.648 121.216c16.896 0 30.592 13.696 30.592 30.592l-0.256 274.048v0.512l0.192 21.696a16.128 16.128 0 0 1-9.728 14.848 16 16 0 0 1-6.144 1.28h-0.448l-29.12-0.512a16 16 0 0 1-15.68-15.872l-0.256-20.608v-1.28l0.128-199.552-2.432 2.368 2.112-0.64L585.536 485.76l-51.008 51.072-0.128-0.192-162.944 161.984-145.92 145.984 190.464-0.256h32.512a16 16 0 0 1 16 15.808l0.32 29.312a16 16 0 0 1-15.872 16.128l-25.6 0.064H422.4l-274.048 0.256a30.4 30.4 0 0 1-30.592-30.592l0.256-274.048v-0.448l-0.192-21.76a16 16 0 0 1 15.872-16.128h0.448l29.12 0.64a16 16 0 0 1 15.68 15.808l0.256 20.608v1.28l-0.128 199.552 531.712-531.712 1.536-0.512 86.144-86.016-190.464 0.32h-32.512a16 16 0 0 1-16-15.808l-0.32-29.312a16 16 0 0 1 15.872-16.192H601.6l274.048-0.32v-0.064z"})),SvgIconCloseCircleFill=e=>reactExports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em",...e},reactExports.createElement("path",{d:"M512 64a448 448 0 1 0 0 896A448 448 0 0 0 512 64z m165.376 618.24l-65.92-0.32L512 563.392l-99.328 118.4-66.048 0.32a7.936 7.936 0 0 1-8-8c0-1.92 0.64-3.712 1.92-5.184L470.528 513.92 340.48 359.04a8 8 0 0 1 6.08-13.184l66.112 0.256L512 464.576l99.328-118.4 65.92-0.256c4.48 0 8.064 3.456 8.064 8a8.32 8.32 0 0 1-1.92 5.12l-129.92 154.944 130.048 155.008a8 8 0 0 1-6.08 13.184z"})),SvgIconCloseLarge=e=>reactExports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em",...e},reactExports.createElement("path",{d:"M745.4976 237.4912a25.6 25.6 0 0 0-36.1984 0l-199.936 199.936L312.064 240.128a25.6 25.6 0 0 0-36.224 0l-36.1984 36.1984a25.6 25.6 0 0 0 0 36.224l197.2992 197.2992-198.2976 198.2976a25.6 25.6 0 0 0 0 36.1984l36.224 36.1984a25.6 25.6 0 0 0 36.1984 0l198.2976-198.2976 200.96 200.96a25.6 25.6 0 0 0 36.1728 0l36.224-36.224a25.6 25.6 0 0 0 0-36.1984l-200.96-200.96 199.936-199.936a25.6 25.6 0 0 0 0-36.1984l-36.1984-36.1984z"})),SvgIconCopy=e=>reactExports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em",...e},reactExports.createElement("path",{d:"M848 720a32 32 0 0 1-39.04 31.232c-1.92 0.32-4.032 0.576-6.144 0.64l-2.816 0.128H704v96a32 32 0 0 1-39.04 31.232c-1.92 0.32-4.032 0.576-6.144 0.64l-2.816 0.128h-448a48.256 48.256 0 0 1-8.96-0.832 32 32 0 0 1-39.04-31.168v-544a32 32 0 0 1 39.04-31.232c1.92-0.32 4.032-0.576 6.144-0.64l2.816-0.128h96v-96a32 32 0 0 1 39.04-31.232c1.92-0.32 4.032-0.576 6.144-0.64L352 144H576c6.912 0 13.824 2.24 19.584 6.72l2.112 1.792 240 221.696c6.848 6.272 10.24 14.848 10.304 23.488v322.304z m-544-384H224v480H640v-64H352a48.256 48.256 0 0 1-8.96-0.832 32 32 0 0 1-39.04-31.168v-384z m256-128h-192v480h416V448h-192a32 32 0 0 1-30.976-40 31.168 31.168 0 0 1-1.024-8v-192z m64 55.936V384h129.984L624 263.936z"})),SvgIconExport=e=>reactExports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em",...e},reactExports.createElement("path",{d:"M140.8 608a12.8 12.8 0 0 0-12.8 12.8v230.4c0 7.04 5.76 12.8 12.8 12.8h742.4a12.8 12.8 0 0 0 12.8-12.8V620.8a12.8 12.8 0 0 0-12.8-12.8h-38.4a12.8 12.8 0 0 0-12.8 12.8v179.2H192V620.8a12.8 12.8 0 0 0-12.8-12.8h-38.4z"}),reactExports.createElement("path",{d:"M465.92 648.32c3.008 3.008 7.04 4.48 11.328 4.48h32.32a16 16 0 0 0 16-16v-47.936l-0.064-1.088V256.064l140.992 141.312 0.448 0.448 0.512 0.448 14.72 14.4a16 16 0 0 0 18.944 2.624l3.328-2.56 20.992-20.16a16.192 16.192 0 0 0 2.752-19.584l-2.624-3.392-15.424-15.232L516.16 160a30.592 30.592 0 0 0-38.464-3.904l-4.8 3.968-193.92 194.24-18.368 18.496a16 16 0 0 0-2.432 19.264l2.56 3.456 20.992 20.48a16 16 0 0 0 19.072 2.432l3.392-2.56 22.784-22.784 0.448-0.512 134.208-134.592-0.064 327.68a16 16 0 0 0-0.32 3.2v48c0 4.16 1.664 8.448 4.672 11.52z"})),SvgIconFillTime=e=>reactExports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em",...e},reactExports.createElement("path",{className:"icon-path",d:"M512 0C228.5568 0 0 228.6592 0 512.3072S231.424 1024 512 1024c283.4432 0 512-228.6592 512-512.3072A512.3072 512.3072 0 0 0 512 0z m333.6192 667.136a39.3216 39.3216 0 0 1-36.5568 23.552c-5.3248 0-10.6496 0-15.9744-2.3552L491.3152 551.3216a41.7792 41.7792 0 0 1-23.552-36.6592v-283.648c0-21.2992 18.2272-39.5264 39.5264-39.5264 21.1968 0 39.5264 18.2272 39.5264 39.5264v260.096l278.2208 125.7472c20.5824 7.68 28.2624 28.9792 20.5824 50.176z"})),SvgIconFold=e=>reactExports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em",...e},reactExports.createElement("path",{d:"M715.776 493.44l-380.8-328.32c-14.144-12.16-34.944-1.28-34.944 18.496V840.32c0 19.712 20.8 30.72 34.944 18.56l380.8-328.448a24.96 24.96 0 0 0 0-36.992z"})),SvgIconFrontPage=e=>reactExports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em",...e},reactExports.createElement("path",{d:"M911.872 215.552a8 8 0 0 1-3.328 5.12L512.192 502.144a8 8 0 0 0 0 13.12l394.368 305.6a8.064 8.064 0 0 1 3.2 8.32 8 8 0 0 1-1.216 2.816l-36.48 52.608a8 8 0 0 1-11.072 1.984l-479.744-364.8a16 16 0 0 1 0-26.24l481.728-340.608a8 8 0 0 1 11.136 1.984l36.48 52.608c1.216 1.728 1.664 3.904 1.28 6.016zM289.664 194.368a8 8 0 0 1 2.368 5.632v624a8 8 0 0 1-8 8h-64a8 8 0 0 1-8-8v-624A8 8 0 0 1 220.032 192h64c2.112 0 4.16 0.832 5.632 2.368z"})),SvgIconLastPage1=e=>reactExports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em",...e},reactExports.createElement("path",{d:"M212.16 215.552a8 8 0 0 0 3.264 5.12L611.84 502.144a8 8 0 0 1 0 13.12l-394.368 305.6a8.064 8.064 0 0 0-3.264 8.32c0.192 0.96 0.64 1.92 1.28 2.816l36.48 52.608a8 8 0 0 0 11.072 1.984l479.68-364.8a16 16 0 0 0 0-26.24L261.12 154.88a8 8 0 0 0-11.136 1.984l-36.48 52.608a8 8 0 0 0-1.28 6.016zM834.368 194.368a8 8 0 0 0-2.368 5.632v624a8 8 0 0 0 8 8h64a8 8 0 0 0 8-8v-624A8 8 0 0 0 904 192h-64a8 8 0 0 0-5.632 2.368z"})),SvgIconNextPage1=e=>reactExports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em",...e},reactExports.createElement("path",{d:"M256.128 190.016a8 8 0 0 0 3.328 5.12l396.352 281.472a7.936 7.936 0 0 1 2.56 10.24 7.936 7.936 0 0 1-2.56 2.88l-394.368 305.6a8.064 8.064 0 0 0-1.984 11.136l36.48 52.608a8 8 0 0 0 11.072 1.984l479.744-364.736a16 16 0 0 0 0-26.24L305.024 129.344a8 8 0 0 0-11.136 2.048l-36.48 52.544a8 8 0 0 0-1.28 6.016z"})),SvgIconNextpageS=e=>reactExports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em",...e},reactExports.createElement("path",{d:"M340.4544 223.5648a25.9584 25.9584 0 0 0 0 36.7616L580.096 499.2 340.48 738.0736a25.9584 25.9584 0 0 0 0 36.7616l36.864 36.7616a26.112 26.112 0 0 0 36.864 0l294.9888-294.016a25.9328 25.9328 0 0 0 0-36.7616L414.208 186.8032a26.112 26.112 0 0 0-36.864 0l-36.8896 36.7616z"})),SvgIconPaginatedExport=e=>reactExports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em",...e},reactExports.createElement("path",{d:"M607.36 105.408l215.232 215.168a32.192 32.192 0 0 1 9.408 22.72V480h-72v-54.016H544A41.984 41.984 0 0 1 502.016 384V168H200v688H512V928H160A32 32 0 0 1 128 896V128a32 32 0 0 1 32-32h424.768a32 32 0 0 1 22.656 9.408z m-37.376 252.608h188.16l-188.16-188.16v188.16z"}),reactExports.createElement("path",{d:"M755.328 546.368a8.064 8.064 0 0 0-11.264 0l-33.92 33.92a8 8 0 0 0 0 11.328l104.576 104.64H456a8 8 0 0 0-8 8v48a8 8 0 0 0 8 8h356.16l-102.208 102.208a8 8 0 0 0 0 11.264l33.92 33.92a8 8 0 0 0 11.328 0l140.096-140.032a8.448 8.448 0 0 0 1.152-0.96l33.92-33.92a8.064 8.064 0 0 0 1.792-8.704 8.064 8.064 0 0 0-1.728-2.624l-175.104-175.04z"})),SvgIconPlay=e=>reactExports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em",...e},reactExports.createElement("path",{d:"M775.387396 473.725924L338.670066 210.210789A37.630391 37.630391 0 0 0 281.610105 242.49101v526.927873a37.553595 37.553595 0 0 0 57.08556 32.254621l436.71733-263.489535a37.630391 37.630391 0 0 0 0-64.458045h-0.025599z"})),SvgIconPreviousPage=e=>reactExports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em",...e},reactExports.createElement("path",{d:"M793.472 190.016a8 8 0 0 1-3.328 5.12L393.792 476.608a8 8 0 0 0 0 13.12l394.368 305.6a8.064 8.064 0 0 1 3.2 8.32 8 8 0 0 1-1.216 2.816l-36.48 52.608a8 8 0 0 1-11.072 1.984L262.912 496.32a16 16 0 0 1 0-26.24l481.664-340.672a8 8 0 0 1 11.136 2.048l36.48 52.544c1.216 1.792 1.664 3.904 1.28 6.016z"})),SvgIconShrink=e=>reactExports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em",...e},reactExports.createElement("path",{d:"M800 448H621.248l297.408-297.344a32 32 0 0 0-45.312-45.312L576 402.752V224a32 32 0 0 0-64 0v240c0 26.496 21.504 48 48 48h240a32 32 0 0 0 0-64zM448 800a32 32 0 0 0 64 0V560A48 48 0 0 0 464 512H224a32 32 0 1 0 0 64h178.752l-297.408 297.344a32 32 0 0 0 45.312 45.312L448 621.248V800z"})),SvgIconUnfold=e=>reactExports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em",...e},reactExports.createElement("path",{d:"M530.432 715.776L859.0336 334.9504c12.1856-14.1312 1.1264-34.9184-18.5344-34.9184l-656.7936 0c-19.6608 0-30.72 20.7872-18.432 34.9184l328.2944 380.928a24.9856 24.9856 0 0 0 37.0688 0z"})),ZoomIcon=({isZoomed:e,onClick:t,disabled:r,toolTipOverlayBackgroundColor:n,toolTipOverlayColor:o,overlayClassName:i})=>{const[a,s]=reactExports.useState(!0),{t:l}=useI18n();return reactExports.useEffect((()=>{s(!0)}),[e]),jsx(Icon$2,{svgContent:e?SvgIconShrink:SvgIconAdaptiveCanvas,type:e?"icon-Shrink":"icon-adaptive-canvas",toolTipOverlayBackgroundColor:n,toolTipOverlayStyle:{color:o},overlayClassName:i,title:a?l(e?"Duchamp-Zoom_In":"Duchamp-Zoom_Out"):void 0,disabled:r,onClick:()=>{null==t||t(),s(!1)},style:{display:"flex",alignItems:"center",justifyContent:"center"}})},THEME_SCHEME={LIGHT:"light",DARK:"dark"},DUCHAMP_ACTION_TYPE={...ACTION_TYPE,VISIBLE_CONTROL:"visibleControl",CUSTOM_PERSPECTIVE:"customPerspective",ENV_SETTING_SWITCH:"envSettingSwitch"};function getTransitionStyle(e){if(!e)return{};const t={transitionDuration:"".concat(e.duration,"ms"),transitionProperty:"all",transitionTimingFunction:"ease"};return e.delay&&(t.transitionDelay="".concat(e.delay,"ms")),t}function jsApi$1(e){return function(t,r){var n,o;const{alias:i=r,travel:a=!1,flatten:s=!1}=null!=(n=isString$4(e)?{alias:e}:e)?n:{},l={name:i,key:r,travel:a,flatten:s};t.apiList=[...null!=(o=t.apiList)?o:[],l]}}const MOBILE_TOOLBAR_TYPE={DEFAULT:"default",FLOAT:"float"},TRANSPORT_EVENT_NAME={CONNECT:"connect",DISCONNECT:"disconnect",ERROR:"error",RECONNECT:"reconnect",CONNECT_ERROR:"connect_error",CONNECT_TIMEOUT:"connect_timeout"},BACKGROUND_TYPE$1={INTERNAL:"internal",CUSTOM:"custom",COLOR:"color",EMPTY:"empty",STORY_BACKGROUND:"backgroundStory"},WARNING_MESSAGE_TYPE={USE_DOCUMENT:"use-document"};function catchCustomJsCode(e,t){return(...r)=>{try{e.call(t,...r)}catch(n){handleJsErrorMessage(n)}}}function handleJsErrorMessage(e){e instanceof Error&&Message.error(i18n.t("Duchamp-Js_Script_Runs_Abnormally",e.message)),console.error(e)}function createJsFunction(...e){try{return new Function(...e)}catch(t){handleJsErrorMessage(t)}return null}const isReservedProperty=e=>{if("string"==typeof e){return["document","$","jQuery"].includes(e)}return!1},runJavascriptCode=({code:e,args:t=[],values:r=[],context:n,skipDocumentVerify:o,duchampApi:i})=>{if(e){const a="undefined"==typeof Proxy?window:new Proxy({},{get:(e,t)=>{var r,n;if(isReservedProperty(t))return;if("duchamp"===t)return i;const o=null!=(n=null==(r=null==i?void 0:i.__window__)?void 0:r[t])?n:window[t];return"function"==typeof o?o.bind(window):o},set:(e,t,r)=>Object.hasOwn(window,t)?(window[t]=r,!0):(i.__window__||(i.__window__={}),i.__window__[t]=r,!0)}),s=checkUseDocumentInJsCode(e),l=o||s,c=createJsFunction("window","document","duchamp","$","jQuery",...t,e);isNil$4(c)||(s&&consoleWarningMessage(i18n.t("Duchamp-Use_Document_In_Js_Warning"),WARNING_MESSAGE_TYPE.USE_DOCUMENT),catchCustomJsCode(c,n)(l?window:a,l?document:void 0,i,l?window.$:void 0,l?window.jQuery:void 0,...r))}},URL_PAGE_NUMBER_KEY="page_number",DEPRECATED_URL_PAGE_NUMBER_KEY="page";function handleCurrentStoryByURL(e,t=!0){const r=getParamInURL(DEPRECATED_URL_PAGE_NUMBER_KEY),n=getParamInURL(URL_PAGE_NUMBER_KEY);let o=0;isNil$4(n)?isNil$4(r)||(o=parseInt(r)):o=parseInt(n)-1,isNaN(o)&&(o=0);const i=o>=e||o<0?0:o;return t&&updateURLParam({key:URL_PAGE_NUMBER_KEY,value:(i+1).toString()},DEPRECATED_URL_PAGE_NUMBER_KEY),i}class TimerEngine{constructor(e){__publicField(this,"intervalId",null),__publicField(this,"interval"),__publicField(this,"timers",[]),this.interval=e}start(){this.isRunning||(this.intervalId=setInterval((()=>{this.timers.forEach((e=>{e.run()}))}),this.interval))}stop(){this.isRunning&&(this.intervalId&&clearInterval(this.intervalId),this.intervalId=null)}addTimer(e){this.timers.push(e),this.start()}removeTimer(e){this.timers=this.timers.filter((t=>t!==e)),0===this.timers.length&&this.stop()}get isRunning(){return null!==this.intervalId}reset(){this.timers=[]}}const TIMER_ENGINE_INTERVAL=500,timerEngine=new TimerEngine(TIMER_ENGINE_INTERVAL);class Parameter{constructor(e,t="parameter",r){__publicField(this,"id"),__publicField(this,"name"),__publicField(this,"isGlobalParameter",!1),__publicField(this,"fields"),__publicField(this,"fieldConfigs"),__publicField(this,"parameterFieldName"),__publicField(this,"getFieldPayload"),this.id=t,this.name=e.name,this.fields=[this.name],this.parameterFieldName=this.name,this.fieldConfigs=getParameterFieldConfig(e),this.getFieldPayload=r}get fieldPayload(){var e;return null==(e=this.getFieldPayload)?void 0:e.call(this)}toggleGlobalParameter(){return this.isGlobalParameter=!this.isGlobalParameter,this}renderField(){}}function getParameterFieldConfig(e){const{name:t}=e;return"formula"===e.type?new Map([[t,{type:"formula",columns:[{formula:e.value}]}]]):"date"===e.type?new Map([[t,{type:"static",value:new Date(e.value)}]]):new Map([[t,{type:"static",value:e.value}]])}function eachParameterConfigs(e,t,r=[]){const n=new Set;e.forEach((e=>{e.forEach((e=>{!notNil(e.value)||n.has(e.name)||r.includes(e.name)||(n.add(e.name),t(e))}))}))}function getParameterComponents(e,t,r){const n=new Set;return eachParameterConfigs(e,(e=>{n.add(new Parameter(e,void 0,r))}),t),n}function preprocessStaticParameter(e){return e.map((e=>"date"===e.type?{...e,value:new Date(e.value)}:e))}function isSameNameByCompareCalculate(e,t){return!(!e||!t)&&e.toLocaleUpperCase()===t.toLocaleUpperCase()}class Filter{constructor(e){__publicField(this,"filters",[]),this.logical=e}getFilters(){return this.filters}size(){return this.filters.length}getFieldRelationFilter(e,t,r){return this.filters.filter((n=>"table"===n.targetType&&n.trigger===r&&n.name===t&&n.targetWidget===e))}updateFilter(e){return this.updateFilterValues(e.filters)}updateFieldFilter(e,t){return this.updateFilterValue({...e,name:e.field,targetWidget:t,targetType:"table",operation:"eq",temporary:!1}),this}updateParameterFilter(e,t,r=!1,n){return this.updateFilterValue({name:e,value:t,targetType:"parameter",operation:"eq",temporary:r,format:n}),this}updateParameterFilters(e,t=!1){return Object.entries(e).forEach((([e,r])=>{this.updateFilterValue({name:e,value:r,targetType:"parameter",operation:"eq",temporary:t})})),this}hasParameterFilter(e){return this.filters.some((t=>isSameNameByCompareCalculate(t.name,e)&&"parameter"===t.targetType&&!t.temporary))}updateFilterValue(e){const t=this.filters.findIndex((t=>this.isSameFilter(t,e)));return t>=0?this.filters[t]=e:this.filters.push(e),this}isSameFilter(e,t){return"parameter"===e.targetType?isSameNameByCompareCalculate(e.name,t.name)&&e.targetType===t.targetType&&e.targetWidget===t.targetWidget:e.trigger===t.trigger&&e.targetType===t.targetType&&e.targetWidget===t.targetWidget}updateFilterValues(e){e.forEach((e=>{this.updateFilterValue(e)}))}getParameterFilter(e){return this.filters.find((t=>isSameNameByCompareCalculate(t.name,e)&&"parameter"===t.targetType))}getFieldFilters(){return this.filters.filter((e=>"table"===e.targetType))}getParameterFilters(){return this.filters.filter((e=>"parameter"===e.targetType))}getParameterFiltersObject(){const e=new Map;return this.getParameterFilters().forEach((t=>{e.set(t.name,t.value)})),Object.fromEntries(e)}removeParameterFilter(e){this.filters=this.filters.filter((t=>!isSameNameByCompareCalculate(t.name,e)||"parameter"!==t.targetType))}removeByTrigger(e){return this.filters=this.filters.filter((t=>t.trigger!==e)),this}cleanWhenEmpty(){this.filters=this.filters.filter((e=>!(e.searchAllWhenEmpty&&null===e.value)))}}class ParameterCenter{constructor(e,t){__publicField(this,"parameters",new Map),__publicField(this,"config"),e&&(this.parameters=e),this.config={ignoreCase:!0,...t}}get map(){return this.parameters}getParameters(){const e={};return this.parameters.forEach(((t,r)=>{e[r]=t})),e}get(e){return this.getValue(e)}getParameterValue(e){return e&&this.has(e)?tsOption.some(this.get(e)):tsOption.none}getValue(e){const{ignoreCase:t}=this.config;if(!t)return this.parameters.get(e);for(const[r,n]of this.parameters.entries())if(isSameNameByCompareCalculate(r,e))return n}set(e,t){this.setValue(e,t)}setAll(e){Object.keys(e).forEach((t=>{const r=e[t];if("__parameters__"===t){const e=isObject$e(r)?r:JSON.parse(decodeURIComponent("".concat(r)));Object.entries(e).forEach((([e,t])=>{this.setValue(e,t)}))}else this.setValue(t,e[t])}))}setValue(e,t){if(""===e)return;const{ignoreCase:r}=this.config;if(r)for(const[n]of this.parameters.entries())isSameNameByCompareCalculate(n,e)&&n!==e&&this.parameters.set(n,t);this.parameters.set(e,t)}delete(e){const{ignoreCase:t}=this.config;t||this.parameters.delete(e),Array.from(this.parameters.keys()).forEach((t=>{isSameNameByCompareCalculate(t,e)&&this.parameters.delete(t)}))}deleteAll(e){this.delete(e)}has(e){return this.hasInGlobalParameters(e)}hasInGlobalParameters(e){const{ignoreCase:t}=this.config;return t?Array.from(this.parameters.keys()).some((t=>isSameNameByCompareCalculate(t,e))):this.parameters.has(e)}isInParameterRelation(e,t){var r;if(t.has(e))return tsOption.some(null!=(r=t.get(e))?r:"");const{ignoreCase:n}=this.config;if(n)for(const[o,i]of t.entries())if(isSameNameByCompareCalculate(o,e))return tsOption.some(i);return tsOption.none}sameName(e,t){const{ignoreCase:r}=this.config;return r?isSameNameByCompareCalculate(e,t):e===t}}var baseSlice$2=_baseSlice,isIterateeCall$3=_isIterateeCall$1,toInteger$3=toInteger_1,nativeCeil=Math.ceil,nativeMax$b=Math.max;function chunk(e,t,r){t=(r?isIterateeCall$3(e,t,r):void 0===t)?1:nativeMax$b(toInteger$3(t),0);var n=null==e?0:e.length;if(!n||t<1)return[];for(var o=0,i=0,a=Array(nativeCeil(n/t));o<n;)a[i++]=baseSlice$2(e,o,o+=t);return a}var chunk_1=chunk;const chunk$1=getDefaultExportFromCjs$1(chunk_1);function getKeyByValue(e,t){for(const[r,n]of e.entries())if(n===t)return r}function isUnsetFieldConfig(e){if(isStaticFieldConfig(e)){const{value:t}=e;return isArray$c(t)?t.every(valueIsEmpty):valueIsEmpty(e.value)}return["dataset","database","formula"].includes(e.type)&&isEmpty$3(e.columns)}function valueIsEmpty(e){return"number"!=typeof e&&"boolean"!=typeof e&&(isDate$2(e)?isNaN(e.getTime()):isEmpty$3(e))}function isFilterable(e){return"relation"in e}function isStoryComputable(e){return"storyIndex"in e}function canFilterLinkOtherFilter(e,t){if(0===t.filterLinkageFieldNames.length)return!1;if(!filterComponentDataIsLinkable(e)||!filterComponentDataIsLinkable(t))return!1;const r=union(e.relation.field.map((e=>e.table))),n=union(t.relation.field.map((e=>e.table)));return 1===new Set([...r,...n]).size}function filterComponentDataIsLinkable(e){const{filterLinkageFieldNames:t}=e;return 0===t.length||e.filterLinkageFieldNames.every((t=>{const r=e.fieldConfigs.get(t);return!r||"canLinkByFilter"in r&&r.canLinkByFilter}))}function promiseWithTimeout(e,t){return Promise.race([e,new Promise(((e,r)=>setTimeout((()=>r(new Error("Promise timeout ".concat(t)))),t)))])}function extractOutsidePayloadAndConfigs(e){const t={},r=new Map;return e.forEach(((e,n)=>{var o;const i={...e};if(null==(o=e.payload)?void 0:o.outsidePayload){merge$1(t,e.payload.outsidePayload);const{outsidePayload:r,...n}=e.payload;i.payload=n}r.set(n,i)})),{outsidePayloads:t,configs:r}}function getComputePayload(e,t){return merge$1({},e,t)}class ComputableElement{constructor(e,t){__publicField(this,"computable"),__publicField(this,"items",new Set),__publicField(this,"isFilter",!1),__publicField(this,"isParameter",!1),__publicField(this,"isForbidden",!1),__publicField(this,"id"),__publicField(this,"calculateResult",new Map),this.computable=e,this.id=e.id,t.forEach((e=>{this.createItem(e)}))}get fieldPayload(){return this.computable.fieldPayload}get storyIndex(){return isStoryComputable(this.computable)?this.computable.storyIndex:null}createItem(e){const t=Array.from(this.items).find((t=>t.fieldKey===e));t&&this.items.delete(t);const r=this.computable.fieldConfigs.get(e),n=getCalculateKey(this,e);if(r){const t=new ComputableItem(this,n,e,r);return this.items.add(t),t}return null}async onCalculated(e,t,r,n){var o;if(this.calculateResult.set(e,{result:t,filter:r}),isFilterableElement(this)){const t=this.getItem(e);if((null!=(o=null==t?void 0:t.filterFieldDeps)?o:[]).every((e=>!this.getItem(e)||this.calculateResult.has(e)))){this.calculateResult.forEach((e=>{e.filter.cleanWhenEmpty()})),await this.computable.renderField(this.calculateResult,n);const e=this.getFilter();this.items.forEach((t=>{const r=this.getParameterKey(t.fieldKey),n=new Filter("and");if(r){const t=e.getParameterFilter(r);t&&n.updateFilterValue(t)}e.getFieldFilters().forEach((e=>{n.updateFilterValue(e)})),t.calculatedEvent.forEach((e=>e({value:this.calculateResult.get(t.key),key:t.key,filter:n})))}))}}else this.calculateResult.size===this.items.size&&(this.calculateResult.forEach((e=>{e.filter.cleanWhenEmpty()})),await this.computable.renderField(this.calculateResult,n))}beforeCalculate(){var e,t;null==(t=(e=this.computable).beforeCalculate)||t.call(e)}afterCalculate(){var e,t;null==(t=(e=this.computable).afterCalculate)||t.call(e)}}class FilterableElement extends ComputableElement{constructor(){super(...arguments),__publicField(this,"isFilter",!0)}get relation(){return this.computable.relation}get parameterRelation(){return this.computable.relation.parameter}getParameterKey(e){return getKeyByValue(this.parameterRelation,e)}getParameterValue(e){var t;return null==(t=this.getParameterFilter(e))?void 0:t.value}getParameterFilter(e){return this.computable.getFilter().getParameterFilter(e)}getFilter(){return this.computable.getFilter()}updateItemToStatic(e){this.items.forEach((t=>{e.has(t.fieldKey)&&t.changeToStatic(e.get(t.fieldKey))}))}setForbidden(){this.isForbidden=!0}getItem(e){return Array.from(this.items).find((t=>t.fieldKey===e))}}class ParameterableElement extends ComputableElement{constructor(){super(...arguments),__publicField(this,"isParameter",!0),__publicField(this,"value")}get name(){return this.computable.name}get firstConfig(){var e;return null!=(e=head(Array.from(this.computable.fieldConfigs.values())))?e:{type:"static",value:""}}get isStatic(){return isStaticFieldConfig(this.firstConfig)}getValue(){const e=this.firstConfig;return isStaticFieldConfig(e)?e.value:this.value}async onCalculated(e,t,r){this.value=t,this.items.forEach((r=>{const n=new Filter("and");n.updateParameterFilter(e,t),r.calculatedEvent.forEach((r=>r({value:t,key:e,filter:n})))}))}}function isFilterableElement(e){return e.isFilter}function isParameterableElement(e){return e.isParameter}class ComputableItem{constructor(e,t,r,n){__publicField(this,"element"),__publicField(this,"fieldKey"),__publicField(this,"key"),__publicField(this,"field"),__publicField(this,"calculatedEvent",[]),__publicField(this,"prev",new Set),__publicField(this,"next",new Set),this.element=e,this.key=t,this.fieldKey=r,this.field=n}changeToStatic(e){const{payload:t}=this.field;this.field={type:"static",value:isFunction$8(e)?e:[e],payload:t}}get filterFieldDeps(){var e;const{element:t}=this;if(isFilterableElement(t)){return(null!=(e=t.computable.filterFieldGroup)?e:[]).filter((e=>e!==this.fieldKey))}return[]}addCalculatedEvent(e){this.calculatedEvent.push(e)}addPrev(e){this.prev.add(e)}addNext(e){this.next.add(e)}hasPrev(){return this.prev.size>0}hasNext(){return this.next.size>0}getNext(){return this.next}getPrev(){return this.prev}deleteNext(e){this.next.delete(e)}deletePrev(e){this.prev.delete(e)}isUnset(){return isUnsetFieldConfig(this.field)}async onCalculated(e,t,r){await this.element.onCalculated(this.fieldKey,e,t,r)}beforeCalculate(){this.element.beforeCalculate()}afterCalculate(){this.element.afterCalculate()}}function getCalculateKey(e,t){return e.isParameter?"parameter.".concat(t):""===e.id?t:"".concat(e.id,".").concat(t)}function divideConfigGroupByRules(e,t,r){var n,o;const i=[],a=Math.min(Math.ceil(e.length/5),100);if(e.length<=5)return e.map((e=>[e]));if(isEmpty$3(t))return chunk$1(e,a);let s=[e[0]];for(let l=1;l<e.length;l++){const r=e[l];isElapsedInRange(null!=(n=t[r.key])?n:0,null!=(o=t[s[0].key])?o:0,a,s.length)?s.push(r):tryAddToElapsedCloseGroup(r,i,t,a)||(i.push(s),s=[r])}return i.push(s),i}function isElapsedInRange(e,t,r,n){const o=getComputeElapsedMaxRange(t);return Math.abs(e-t)<=o&&n<r}function tryAddToElapsedCloseGroup(e,t,r,n){var o,i;const a=null!=(o=r[e.key])?o:0;for(const s of t){if(isElapsedInRange(a,null!=(i=r[s[0].key])?i:0,n,s.length))return s.push(e),!0}return!1}function getComputeElapsedMaxRange(e){const t={20:30,50:50,100:100};for(const r in t)if(e<parseInt(r))return t[r];return 200}function stringfyCompare(e,t){return JSON.stringify(e)===JSON.stringify(t)}class CacheCenter{constructor(){__publicField(this,"id",""),__publicField(this,"useCache",!1),__publicField(this,"cacheResult"),__publicField(this,"cacheableElementList",[]),__publicField(this,"version","0"),__publicField(this,"validTime",0)}init(e,t,r,n,o){this.id=e,this.useCache=t,this.version=r,this.validTime=n,this.cacheableElementList=o.filter((e=>e.cacheable)).map((e=>{const t=Array.from(e.fieldConfigs.keys());return new ComputableElement(e,t)}))}async getCacheResult(){if(!this.cacheResult)try{this.cacheResult=await promiseWithTimeout(getFvsDataCacheById(this.id),2e3)}catch(e){this.cacheResult={id:this.id,fields:{},version:this.version,updateTime:(new Date).getTime()},console.error(e)}return this.cacheResult}async loadCache(e,t=new Set){if(!this.useCache)return;const r=await this.getCacheResult();if((null==r?void 0:r.version)!==this.version)return;const n=e.filter((e=>e.cacheable));for(const o of n){const e=Array.from(o.fieldConfigs.keys()).filter((e=>!t.has("".concat(o.id,".").concat(e))));if(0===e.length)continue;const n=new ComputableElement(o,e),i=new Map;e.forEach((e=>{const t=getCalculateKey(n,e),o=r.fields[t];o&&i.set(e,{result:o.data,filter:new Filter("and")})})),i.size>0&&await n.computable.renderField(i,{type:"init"})}}async compareCacheWithComputeResult(e,t,r,n){var o;if(!this.useCache||"init"!==n)return!0;const i=await this.getCacheResult();if((null==i?void 0:i.version)!==this.version||i.validTime!==this.validTime)return!0;const a=!i||!(null==i?void 0:i.fields[e]),s=this.cacheableElementList.some((t=>Array.from(t.items.values()).map((e=>e.key)).includes(e)));if(a||!s)return!0;return!stringfyCompare(t,null==i?void 0:i.fields[e].data)||!stringfyCompare(r,null==(o=null==i?void 0:i.fields[e])?void 0:o.parameters)}updateCache(e){return updateDataCache({id:this.id,fields:Object.fromEntries(e),version:this.version,updateTime:(new Date).getTime(),validTime:this.validTime})}shouldCacheResult(e,t){return!!this.useCache&&(isInstanceofTable(e)?!matchTableIncludeCharts(t):e.cacheable)}}function matchTableIncludeCharts(e){return JSON.stringify(e).match(/Cells__[^_]+__[^_]+__[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}__index__\d+/)}function isInstanceofTable(e){return"d-workbook"===(null==e?void 0:e.type)||"d-workbook-x"===(null==e?void 0:e.type)}class computeSequenceCreator{constructor(e,t,r,n,o,i={throwErrorWhenCircularDependency:!1}){__publicField(this,"queue",[]),__publicField(this,"result",new Set),this.computableDictionary=e,this.parameterCenter=t,this.relationship=r,this.filters=n,this.initdList=o,this.options=i}createCalculateListByInit(e,t){if(0===e.size)return this.result;const r=null==t?void 0:t.getParameterFilters();r&&r.forEach((e=>{this.parameterCenter.set(e.name,e.value)}));const n=this.createElementItems(e,this.initdList);for(n.forEach((e=>{this.filedCanCalculate(e)||e.changeToStatic([])})),this.queue=Array.from(n);this.queue.length>0;){const e=this.queue.shift();if(!e)return this.result;this.result.add(e),this.judgmentFlow(e).pipe([this.doWhenHasSameNameGlobalParameter,this.doWhenHasSameNameDoneFilter,this.doWhenHasFieldRelation,this.doWhenHasFieldConfig([this.doWhenHadDepExitedFilter,this.doWhenHasDepGlobalParameter,this.doWhenHasDepFilterComponent,this.doWhenHadDepParameterComponent],[],!1),this.doWhenHasSameNameParameter])}if(t&&t.size()>0){this.result.forEach((e=>{t.getFieldFilters().forEach((t=>{const{targetWidget:r}=t;r===e.element.id&&(this.updateComputableItemFilter(e,t),this.doWhenHasFieldRelation(e))}))}));const e=new Filter("and");e.updateFilterValues(t.getParameterFilters()),e&&e.size()>0&&this.createCalculateListByLinkageGlobal(e,[],[],!1)}return this.result}createCalculateList(e){const t=this.createElementItems(e);this.queue=Array.from(t);const r=e.size>0;for(;this.queue.length>0;){const e=this.queue.shift();if(!e)return this.result;this.result.add(e),this.judgmentFlow(e).pipe([this.doWhenHasFieldConfig([this.doWhenHadDepExitedFilter,this.doWhenHasDepGlobalParameter,this.doWhenHasDepFilterComponent,this.doWhenHadDepParameterComponent],[],!r),this.doWhenHasSameNameParameter]),t.has(e)&&this.doWhenToLinkageComponent(e)}return this.result}createCalculateListByLinkage(e,t,r){const n=e.getParameterFilters(),o=n.map((e=>e.name));return Array.from(t).forEach((e=>{for(const[t]of e.fieldConfigs)n.forEach((n=>{const[i]=this.createLinkageSequence(e,t,n,r,o,e.storyIndex);i&&this.createCalculateListByLinkageGlobal(new Filter("and").updateFilterValue(n),[e.id],r)}))})),this.dealItemsInQueue(),this.createLinkageForwardComponent(),this.doWhenNeedLinkage(r,o),Array.from(t).forEach((t=>{if(!Array.from(this.result).some((e=>e.element.id===t.id))){this.getFilter(t.id).updateFilterValues(e.getFilters())}})),this.result}createCalculateListByLinkageGlobal(e,t,r,n=!0){const o=e.getParameterFilters(),i=new Set,a=o.map((e=>e.name)),s=this.computableDictionary.currentStoryIndex;this.forEachStoryFieldConfigs(((o,l)=>{t.includes(o.id)||(e.getParameterFilters().forEach((e=>{const[,t]=this.createLinkageSequence(o,l,e,r,a,s,n);t&&i.add(t)})),e.getFieldFilters().forEach((e=>{const{targetWidget:i,trigger:a}=e,s=t.some((e=>r.includes(e)))&&i&&!r.includes(i),c=!a||!isFilterable(o)||this.canFilterLinkByOtherFilter(a,o)&&o.filterLinkageFieldNames.includes(l);if(i===o.id&&!s&&c){const t=this.getOrCreateElementItem(o,l);t&&(this.queue.push(t),this.updateComputableItemFilter(t,e),!n&&this.doWhenHasFieldRelation(t))}})))}));for(const l of o){const{name:e,value:t}=l;!i.has(e)&&this.parameterCenter.set(e,t)}return this.dealItemsInQueue(),this.createLinkageForwardComponent(),this.doWhenNeedLinkage(r,a),this.result}canFilterLinkByOtherFilter(e,t){const{filterComponents:r}=this.computableDictionary,n=Array.from(r).find((t=>t.id===e));return!n||canFilterLinkOtherFilter(n,t)}doWhenNeedLinkage(e,t){this.result.forEach((r=>{var n,o;if(isFilterableElement(r.element)){const{element:i}=r,a=null==(o=(n=i.computable).getNeedLinkageItem)?void 0:o.call(n,r.fieldKey);if(a){const n=this.createFilterableElement(i.computable,a.field);n.hasIn||(n.item.changeToStatic(a.value),r.addNext(n.item),n.item.addPrev(r),this.result.add(n.item),this.doWhenToLinkageComponent(n.item,t,e))}}}))}createCalculateListByRemoveFilter(e){return this.forEachStoryFieldConfigs(((t,r)=>{e.forEach((({trigger:e,relation:n})=>{Array.from(n.parameter.keys()).forEach((e=>{this.parameterCenter.delete(e);const n=this.getLinkageItemBySameParameter(t,r,e);if(n){const{item:e,targetKey:t}=n;this.doWhenHasFieldConfig([this.doWhenHasDepGlobalParameter,this.doWhenHadDepParameterComponent])(e),this.getFilter(e.key).removeParameterFilter(t),this.result.add(e)}const o=this.getLinkageItemByDepParameter(t,r,e);if(o){const t=o;this.doWhenHasFieldConfig([this.doWhenHasDepGlobalParameter,this.doWhenHadDepParameterComponent])(t),this.result.add(t),this.getFilter(t.key).removeParameterFilter(e),isFilterableElement(t.element)&&this.doWhenToLinkageComponent(t)}})),n.field.forEach((n=>{if(t.id===n.targetId){const n=this.getOrCreateElementItem(t,r);n&&(this.result.add(n),this.getFilter(n.key).removeByTrigger(e))}}))}))})),this.dealItemsInQueue(),this.createLinkageForwardComponent(),this.result}createLinkageForwardComponent(){this.result.forEach((e=>{this.relationship.getDepForwardComputedNames(e.key).forEach((t=>{t.forEach((t=>{this.doWhenNeedToLinkageByDepForwardComponent(e,t)}))}))}))}dealItemsInQueue(){for(;this.queue.length>0;){const e=this.queue.shift();if(!e)return;this.result.add(e),this.judgmentFlow(e).pipe([this.doWhenHasFieldConfig([this.doWhenHadDepExitedFilter,this.doWhenHasDepGlobalParameter,this.doWhenHasDepFilterComponent,this.doWhenHadDepParameterComponent]),this.doWhenHasFieldRelation,this.doWhenHasSameNameParameter])}}createLinkageSequence(e,t,r,n,o,i,a=!0){const s=this.getLinkageItemBySameParameterToMakeStatic(e,t,r.name,(e=>r.value),a);if(s&&this.linkageIsForbidden(n,r.name,s.element.id,i))return[!1,r.name];if(s)return this.result.add(s),[0===n.length||!n.includes(s.element.id),null];const l=this.getLinkageItemByDepParameter(e,t,r.name,a);if(l&&!FilterIsInParams(l,o,this.parameterCenter)){if(this.linkageIsForbidden(n,r.name,l.element.id,i))return[!1,r.name];const e=l;this.result.add(e),this.doWhenHasFieldConfig([this.doWhenHadDepExitedFilter,this.doWhenHasDepGlobalParameter,this.doWhenHasDepFilterComponent,this.doWhenHadDepParameterComponent],o)(e);return this.getFilter(e.key).updateParameterFilter(r.name,r.value,!1,r.format),isFilterableElement(e.element)&&(n.includes(e.element.id)&&e.element.setForbidden(),this.doWhenToLinkageComponent(e,o,n)),[!1,null]}return[!1,null]}judgmentFlow(e){return{pipe:t=>{for(const r of t){const t=r.call(this,e);if(t)return t}return e}}}judgmentDepFlow(e,t){return{pipe:r=>{for(const n of r){const r=n.call(this,e,t);if(r)return r}return e}}}doWhenHasSameNameGlobalParameter(e){const{element:t}=e;if(!isFilterableElement(t))return null;const r=t.getParameterKey(e.fieldKey);if(!r)return null;if(!this.parameterCenter.has(r))return null;const n=this.parameterCenter.get(r);return e.changeToStatic(n),e}doWhenHasSameNameDoneFilter(e){const{element:t}=e;if(!isFilterableElement(t))return null;for(const r of this.result){const n=r.element;if(r.key!==e.key&&isFilterableElement(n)){const o=getParameterKey(t.relation.parameter,e.fieldKey),i=getParameterKey(n.parameterRelation,r.fieldKey);if(o&&i&&this.parameterCenter.sameName(o,i))return e.addPrev(r),r.addNext(e),e.changeToStatic((()=>[n.getParameterValue(i)])),e}}return null}doWhenHasFieldRelation(e){if(e.isUnset())return null;for(const t of this.computableDictionary.filterComponents){const r=t.relation.field.find((t=>t.targetId===e.element.id));if(r){this.createFilterableElements(t).forEach(((t,n)=>{const{element:o}=n;if(isFilterableElement(o)){const i=this.getFilter(e.key);if(this.initdList.has(n.key))i.updateFilterValues(o.getFilter().getFieldRelationFilter(e.element.id,r.field,n.element.id)),this.filters.set(e.key,i);else{const o=i.getFieldRelationFilter(r.targetId,r.field,n.element.id);o&&o.length>0?this.updateComputableItemFilters(e,o):(t||this.queue.push(n),n.addNext(e),e.addPrev(n),n.addCalculatedEvent((({filter:t})=>{t&&this.updateComputableItemFilters(e,t.getFieldRelationFilter(e.element.id,r.field,n.element.id))})))}}}))}const{element:n}=e;if(isFilterableElement(n)&&t.relation.filterComponent.includes(n.id)&&canFilterLinkOtherFilter(t,n.computable)){this.createFilterableElements(t).forEach(((r,n)=>{var o;hasCirculate(e,n)||(null==(o=this.filters.get(e.key))?void 0:o.getFieldFilters().some((e=>e.trigger===t.id)))||(!r&&this.queue.push(n),n.addNext(e),e.addPrev(n),n.addCalculatedEvent((({filter:t})=>{if(t){const r=t.getFilters().find((t=>t.targetWidget===e.element.id));this.updateComputableItemFilter(e,r)}})))}))}}return null}doWhenHasFieldConfig(e,t,r=!0){return n=>{if(n.isUnset())return null;const o=this.relationship.getDepParameters(n.key);if(o.isDefined&&o.get.forEach((r=>{t&&t.some((e=>this.parameterCenter.sameName(e,r)))||this.judgmentDepFlow(n,r).pipe(e)})),!r){const e=this.relationship.getDepForwardComputedNames(n.key);e.isDefined&&e.get.forEach((e=>{this.doWhenHasDepForwardComponent(n,e)}))}return n}}doWhenHasSameNameParameter(e){const{element:t}=e;if(!isFilterableElement(t))return null;const r=t.getParameterKey(e.fieldKey);return r?this.doWhenHadDepParameterComponent(e,r,!0):null}doWhenHasDepGlobalParameter(e,t){const r=this.parameterCenter.getParameterValue(t);return r.isEmpty?null:(this.updateParameterFilter(e.key,t,r.get),e)}doWhenHasDepFilterComponent(e,t){for(const r of this.computableDictionary.filterComponents){const n=this.parameterCenter.isInParameterRelation(t,r.relation.parameter);if(n.isDefined){const o=r.fieldConfigs.get(n.get);if(!o||isUnsetFieldConfig(o))return null;const{item:i,hasIn:a}=this.createFilterableElement(r,n.get),{element:s}=e;return isFilterableElement(s)&&this.parameterCenter.sameName(s.getParameterKey(e.fieldKey),t)||hasCirculate(e,i)||(a||this.queue.push(i),i.addNext(e),e.addPrev(i),this.updateSequence(e,i)),e}}return null}doWhenHadDepExitedFilter(e,t){const r=this.getFilter(e.key);return r&&r.hasParameterFilter(t)?e:null}doWhenHadDepParameterComponent(e,t,r=!1){const n=(t,n,o)=>{const i=isArray$c(o)?o[0]:o;r?e.changeToStatic(i):this.updateParameterFilter(t,n,i,!0)},o=new Set([...this.result,...this.queue]);for(const i of o){const{element:r}=i;if(isParameterableElement(r)&&this.parameterCenter.sameName(t,r.name))return e.addPrev(i),i.addNext(e),i.addCalculatedEvent((r=>{n(e.key,t,r.value)})),e}for(const i of this.computableDictionary.parameterComponents)if(this.parameterCenter.sameName(t,i.name)){const r=new ParameterableElement(i,Array.from(i.fieldConfigs.keys()));return r.isStatic?n(e.key,t,r.getValue()):r.items.forEach((r=>{e.addPrev(r),r.addNext(e),this.filters.delete(r.key),r.addCalculatedEvent((r=>{n(e.key,t,r.value)})),this.queue.push(r)})),e}if(!r)for(const i of this.computableDictionary.filterComponents){if(this.parameterCenter.isInParameterRelation(t,i.relation.parameter).isDefined)return n(e.key,t,""),e}return null}doWhenNeedToLinkageByDepForwardComponent(e,t){var r;const n=null!=(r=e.element.storyIndex)?r:this.computableDictionary.currentStoryIndex,o=this.computableDictionary.storyComponents[n];for(const i of o)if("forwardComputedName"in i&&this.parameterCenter.sameName(t,i.forwardComputedName))for(const t of this.result)if(t.element.id===i.id&&hasSamePrev(e,t))return e.addPrev(t),t.addNext(e),e;return null}doWhenHasDepForwardComponent(e,t){var r,n;const o=null!=(r=e.element.storyIndex)?r:this.computableDictionary.currentStoryIndex,i=null!=(n=this.computableDictionary.storyComponents.at(o))?n:[];for(const a of i)if("forwardComputedName"in a&&this.parameterCenter.sameName(t,a.forwardComputedName)){const t=new Set([...this.result,...this.queue]);for(const r of t)if(r.element.id===a.id)return e.addPrev(r),r.addNext(e),e;return new ComputableElement(a,Array.from(a.fieldConfigs.keys())).items.forEach((t=>{this.queue.push(t),t.addNext(e),e.addPrev(t)})),e}return null}createFilterableElementFromWillDo(e,t){const r=new Set([...this.result,...this.queue]);for(const n of r){const{element:r}=n;if(isFilterableElement(r)&&n.element.id===e.id&&t===n.fieldKey)return{item:n,element:r,hasIn:!0}}for(const n of r){const{element:r}=n;if(isFilterableElement(r)&&n.element.id===e.id){const e=n.element.createItem(t);if(e)return{item:e,element:r,hasIn:!1}}}return null}createFilterableElement(e,t){const r=this.createFilterableElementFromWillDo(e,t);if(r)return r;const n=new FilterableElement(e,[t]);return{item:Array.from(n.items)[0],element:n,hasIn:!1}}createFilterableElements(e){const t=new Set(e.fieldConfigs.keys()),r=new Set,n=new Map;for(const i of t){const t=this.createFilterableElementFromWillDo(e,i);t&&(n.set(t.item,t.hasIn),r.add(i))}const o=[...t].filter((e=>!r.has(e)));if(o.length>0){new FilterableElement(e,o).items.forEach((e=>{n.set(e,!1)}))}return n}getLinkageItemBySameParameter(e,t,r){if(!isFilterable(e))return null;const n=getParameterKey(e.relation.parameter,t);if(!(n&&this.parameterCenter.sameName(r,n)))return null;const o=this.createFilterableElement(e,t);return{element:o.element,item:o.item,targetKey:n}}getLinkageItemBySameParameterToMakeStatic(e,t,r,n,o=!0){if(o&&Array.from(this.result).some((r=>r.element.id===e.id&&r.fieldKey===t)))return null;const i=this.getLinkageItemBySameParameter(e,t,r);return isNil$3(i)?null:(i.item.changeToStatic((()=>[n(r)])),i.item)}getLinkageItemByDepParameter(e,t,r,n=!0){const o="".concat(e.id,".").concat(t),i=this.relationship.getDepParameters(o);if(i.isEmpty)return null;for(const a of i.get)if(this.parameterCenter.sameName(a,r)){if(!n&&isFilterable(e)){const e=Array.from(this.result).find((e=>e.key===o));e&&"static"===e.field.type&&this.result.delete(e)}const r=this.getOrCreateElementItem(e,t);if(r)return r}return null}canContinueLinkage(e,t){if(!isFilterableElement(t.element))return!1;const r=getParameterKey(t.element.relation.parameter,t.fieldKey);return null!==r&&(e.element.storyIndex===t.element.storyIndex||!Array.from(e.getNext()).some((e=>{if(e===t)return!1;if(isFilterableElement(e.element)){if(getParameterKey(e.element.relation.parameter,e.fieldKey)===r)return!0}return!1})))}doWhenToLinkageComponent(e,t=[],r=[]){const{element:n}=e,{storyIndex:o}=n;return!isFilterableElement(n)||isNil$3(o)||this.forEachStoryFieldConfigs(((i,a)=>{if(i.id!==n.id){const s=getParameterKey(n.relation.parameter,e.fieldKey);if(s){const l=this.getLinkageItemBySameParameterToMakeStatic(i,a,s,(e=>n.getParameterValue(e)));if(l&&!this.linkageIsForbidden(r,s,l.element.id,o))e.addNext(l),l.addPrev(e),this.result.add(l);else{const n=this.getLinkageItemByDepParameter(i,a,s);if(n&&!this.linkageIsForbidden(r,s,n.element.id,o)){const o=n;if(isFilterableElement(o.element)&&hasCirculate(o,e)){if(this.options.throwErrorWhenCircularDependency)throw new CircularDependencyError("Circular dependency: ".concat(e.key," -> ").concat(o.key))}else e.addNext(o),o.addPrev(e),this.result.add(o),this.updateSequence(o,e),this.doWhenHasFieldConfig([this.doWhenHadDepExitedFilter,this.doWhenHasDepGlobalParameter,this.doWhenHadDepParameterComponent],t)(o),isFilterableElement(o.element)&&(r.includes(o.element.id)&&o.element.setForbidden(),this.canContinueLinkage(e,o)&&this.doWhenToLinkageComponent(o,t,r))}}}!r.includes(n.id)&&n.relation.field.forEach((t=>{t.targetId===i.id&&this.linkageNextElement(e,i,a)}));!(!r.includes(i.id)&&r.includes(n.id))&&isFilterable(i)&&canFilterLinkOtherFilter(i,n.computable)&&isFilterableElement(n)&&n.relation.filterComponent.includes(i.id)&&n.computable.filterLinkageFieldNames.forEach((t=>{this.linkageNextElement(e,i,t)}))}})),null}linkageNextElement(e,t,r){const n=this.getOrCreateElementItem(t,r);n&&!hasCirculate(n,e)&&(e.addNext(n),n.addPrev(e),this.result.add(n),e.addCalculatedEvent((({filter:e})=>{e&&this.updateComputableItemFilters(n,e.getFilters())})))}linkageIsForbidden(e,t,r,n){return 0!==e.length&&(!(e.includes(r)&&!this.filterableIsOtherStory(r,n))&&this.parameterIsForbidden(t,e,n))}filterableIsOtherStory(e,t){const r=Array.from(this.computableDictionary.filterComponents).find((t=>t.id===e));return!r||"storyIndex"in r&&r.storyIndex!==t}parameterIsForbidden(e,t,r){if(0===t.length||r<0)return!1;for(const n of this.computableDictionary.filterComponents){if(!("storyIndex"in n))return!1;if(n.storyIndex===r&&t.includes(n.id)&&this.parameterCenter.isInParameterRelation(e,n.relation.parameter).isDefined)return!0}return!1}getOrCreateElementItem(e,t){const r="".concat(e.id,".").concat(t),n=new Set([...this.result,...this.queue]);for(const i of n)if(i.key===r)return i;for(const i of n)if(i.element.id===e.id)return i.element.createItem(t);const o=isFilterable(e)?new FilterableElement(e,[t]):new ComputableElement(e,[t]);return Array.from(o.items)[0]}updateSequence(e,t){const{element:r}=t;isFilterableElement(r)&&t.addCalculatedEvent((({filter:t})=>{t&&this.updateComputableItemFilters(e,t.getFilters())}))}getFilter(e){const t=this.filters.get(e);if(!t){const t=new Filter("and");return this.filters.set(e,t),t}return t}updateParameterFilter(e,t,r,n=!1){const o=this.filters.get(e);if(o)o.updateParameterFilter(t,r,n);else{const o=new Filter("and");o.updateParameterFilter(t,r,n),this.filters.set(e,o)}}createElementItems(e,t=new Set){const{filterComponents:r}=this.computableDictionary,n=new Set;return e.forEach((e=>{const o=Array.from(e.fieldConfigs.keys()).filter((r=>!t.has("".concat(e.id,".").concat(r))));(isFilterable(e)&&r.has(e)?new FilterableElement(e,o):new ComputableElement(e,o)).items.forEach((e=>{n.add(e)}))})),n}forEachStoryFieldConfigs(e){const{storyComponents:t,currentStoryIndex:r}=this.computableDictionary;(r>=0?[t[r],...t.filter(((e,t)=>t!==r))]:t).forEach((t=>{t.forEach((t=>{for(const[r]of t.fieldConfigs)e(t,r)}))}))}updateComputableItemFilter(e,t){if(!t)return;const r=this.getFilter(e.key);"parameter"!==t.targetType&&t.targetWidget!==e.element.id||(r.updateFilterValue(t),this.filters.set(e.key,r))}updateComputableItemFilters(e,t){t.forEach((t=>{this.updateComputableItemFilter(e,t)}))}filedCanCalculate(e){var t;const{element:r}=e,{disable:n}=null!=(t=e.field.computeConfig)?t:{disable:!1},o=isFunction$8(n)?n:()=>n;if(!isFilterableElement(r))return!o({bindParams:!1});const{filterFieldGroup:i}=r.computable;return!o({bindParams:i.every((t=>{if(t===e.fieldKey)return!0;const n=r.getParameterKey(t);return!!n&&(this.parameterCenter.has(n)||Array.from(this.computableDictionary.parameterComponents).some((e=>this.parameterCenter.sameName(e.name,n))))}))})}}class CircularDependencyError extends Error{constructor(e){super(e),this.name="CircularDependencyError"}}function getParameterKey(e,t){for(const[r,n]of e.entries())if(n===t)return r;return null}function getAllPreviousItems(e){const t=new Set,r=[e];for(;r.length>0;){const e=r.pop();if(e){const n=e.getPrev();for(const e of n)t.add(e),r.push(e)}}return t}function hasSamePrev(e,t){if(e===t)return!1;const r=getAllPreviousItems(e),n=getAllPreviousItems(t),o=new Set([...r,...n]);return 0===r.size&&0===n.size||o.size!==r.size+n.size}function hasCirculate(e,t){return e===t||Array.from(e.getNext()).some((e=>hasCirculate(e,t)))}function FilterIsInParams(e,t,r){const{element:n}=e;if(!isFilterableElement(n))return!1;const o=getParameterKey(n.relation.parameter,e.fieldKey);return o&&t.some((e=>r.sameName(e,o)))}class ComputableRelationshipManager{constructor(){__publicField(this,"deps",new Map)}updateDeps(e){for(const[t,r]of Object.entries(e))this.deps.set(t,r)}has(e){return this.deps.has(e)}delete(e){this.deps.delete(e)}getDepParameters(e){var t,r;const n=null!=(r=null==(t=this.deps.get(e))?void 0:t.parameter)?r:[];return n.length>0?tsOption.some(n):tsOption.none}getDepForwardComputedNames(e){var t,r;const n=null!=(r=null==(t=this.deps.get(e))?void 0:t.field)?r:[];return n.length>0?tsOption.some(n):tsOption.none}}class CalculateCenter{constructor(e,t,r){__publicField(this,"parameterCenter"),__publicField(this,"cacheCenter"),__publicField(this,"fieldCacheResult",new Map),__publicField(this,"_service"),__publicField(this,"relationship"),__publicField(this,"filters",new Map),__publicField(this,"initdList",new Set),__publicField(this,"eventsEmitter",new EventEmitter),__publicField(this,"linkageForbiddenList",[]),__publicField(this,"relationCalculate"),__publicField(this,"computableGetter",(()=>({parameterComponents:new Set,filterComponents:new Set,storyComponents:[],currentStoryIndex:0}))),__publicField(this,"storyIndexGetter",(()=>0)),__publicField(this,"allowMergeCompute"),__publicField(this,"fieldFilter",new Filter("and")),this.cacheCenter=new CacheCenter,this.parameterCenter=null!=e?e:new ParameterCenter,this.relationship=new ComputableRelationshipManager,this.relationCalculate=r,this.allowMergeCompute=null==t||t}get service(){if(!this._service)throw new Error("service is not set");return this._service}setService(e){return this._service=e,this}appendLinkageForbiddenList(e){this.linkageForbiddenList=[...this.linkageForbiddenList,...e]}onCalculateError(e){this.eventsEmitter.addListener("error",e)}mergeFilter(e){const t=null==e?void 0:e.getFieldFilters();return t&&this.fieldFilter.updateFilterValues(t),null==e||e.updateFilterValues(this.fieldFilter.getFieldFilters()),e}async calculateByInit(e,t){const r=this.computableGetter();await this.updateRelationship(r,e);const n=new computeSequenceCreator(r,this.parameterCenter,this.relationship,this.filters,this.initdList).createCalculateListByInit(e,this.mergeFilter(t));return e.forEach((e=>{var t;(e=>Array.from(n).some((t=>t.element.id===e.id)))(e)||null==(t=e.afterCalculate)||t.call(e)})),this.doCalculate(Array.from(n),{type:"init"},!0)}async calculate(e,t="init",r={},n={},o=!1){const i=this.computableGetter();await this.updateRelationship(i,e,o);const a=new computeSequenceCreator(i,this.parameterCenter,this.relationship,this.filters,this.initdList,{throwErrorWhenCircularDependency:!0}).createCalculateList(e);for(const s of a){this.getFilter(s.key).updateParameterFilters(n)}return this.doCalculate(Array.from(a),{type:t,extPayload:r})}async calculateFieldConfigs(e,t=!1,r=!0,n={}){if(t){const{configs:t,outsidePayloads:r}=extractOutsidePayloadAndConfigs(e),n=await this.service.getDeps({configs:Object.fromEntries(t),...r});"result"in n&&this.relationship.updateDeps(n.result)}const o=new Map;r&&e.forEach(((e,t)=>{this.filters.delete(t)}));const i={id:"",fieldConfigs:e,fieldPayload:{},renderField:e=>{e.forEach(((e,t)=>{o.set(t,e.result)}))},cacheable:!0};return await this.calculate(new Set([i]),"init",{},n),o}async calculateStoryComputableList(e){const{storyComponents:t}=this.computableGetter(),r=this.storyIndexGetter(),n=new Map;return t.forEach((t=>{t.forEach((t=>{t.fieldConfigs.forEach(((o,i)=>{const a="".concat(t.id,".").concat(i);e.includes(a)&&(t.storyIndex===r?(o.payload={...o.payload,...t.fieldPayload},n.set(a,o)):(t.setNeedRecalculate(!0),this.initdList.delete(a)))}))}))})),this.calculateFieldConfigs(n,!1,!1)}async linkage(e,t){const r=this.computableGetter(),n=new computeSequenceCreator(r,this.parameterCenter,this.relationship,this.filters,this.initdList).createCalculateListByLinkage(e,t,[]);return this.doCalculate(Array.from(n),{type:"linkage"})}async linkageGlobal(e,t=[],r=!0){const n=this.computableGetter(),o=new computeSequenceCreator(n,this.parameterCenter,this.relationship,this.filters,this.initdList).createCalculateListByLinkageGlobal(e,t,r?[]:this.linkageForbiddenList);return this.doCalculate(Array.from(o),{type:"linkage"})}async linkageByFilterDelete(e,t="init"){if(0===e.length)return Promise.resolve();const r=this.computableGetter(),n=new computeSequenceCreator(r,this.parameterCenter,this.relationship,this.filters,this.initdList).createCalculateListByRemoveFilter(e);return this.doCalculate(Array.from(n),{type:t})}setComputableGetter(e){this.computableGetter=e}setStoryIndexGetter(e){this.storyIndexGetter=e}async doCalculate(e,t,r=!1){if(0===e.length)return!0;for(const s of e){const e=s.filterFieldDeps;s.hasNext()&&e.length>0&&s.element.items.forEach((t=>{t!==s&&e.includes(t.fieldKey)&&!hasCirculate(s,t)&&s.getNext().forEach((e=>{e.key!==t.key&&(e.addPrev(t),t.addNext(e))}))}))}const n=new Set,o=e.filter((e=>!e.hasPrev())),i=e=>{e.forEach((e=>{const{computable:t}=e.element;isStoryComputable(t)&&t.setNeedRecalculate(!1),n.add(e),r&&this.initdList.add(e.key),e.getNext().forEach((e=>{Array.from(e.getPrev()).every((e=>n.has(e)))&&o.push(e)}))}))},a=e=>{const r=o.splice(0,this.allowMergeCompute?o.length:1),a=[],s=this.storyIndexGetter();r.forEach((e=>{const{computable:t}=e.element,r=!!(isStoryComputable(t)&&t.storyIndex>=0)&&s!==t.storyIndex;e.hasNext()&&!Array.from(e.getNext()).every((e=>e.element.computable.id===t.id))||!r?a.push(e):(r&&(isStoryComputable(t)&&t.setNeedRecalculate(!0),this.initdList.delete(e.key),isFilterable(t)&&"static"!==e.field.type&&t.relation.parameter.forEach(((t,r)=>{e.fieldKey===t&&this.parameterCenter.delete(r)}))),n.add(e))})),this.doCalculateGroup(a,t,i,e)};return new Promise(((t,r)=>{const o=setInterval((()=>{n.size===e.length&&(clearInterval(o),this.fieldCacheResult.clear(),t(!0)),a((e=>{r(e)}))}),0)}))}getComputableDictionary(){return this.computableGetter()}async doCalculateGroup(e,t,r,n){if(0===e.length)return;e.forEach((e=>{e.element.isFilter&&!e.element.isForbidden&&e.addCalculatedEvent((({filter:e})=>{e.getParameterFilters().forEach((e=>{this.parameterCenter.set(e.name,e.value)}))}))}));const{staticGroup:o,configGroup:i}=separateCalculateGroup(e);if(o.length>0&&this.calculateStaticGroup(o,t).then((()=>{r(o)})),0===i.length)return;const a=this.allowMergeCompute?await this.cacheCenter.getCacheResult():void 0,s=new Map;(null==a?void 0:a.fields)&&!isEmpty$3(a.fields)&&Object.keys(a.fields).forEach((e=>{s.set(e,a.fields[e].elapsedTime)}));const l=divideConfigGroupByRules(i,Object.fromEntries(s));for(const c of l)this.calculateConfigGroup(c,t).then((()=>{r(c)})).catch((e=>{null==n||n("calculate error: ".concat(e))}))}async calculateStaticGroup(e,t){e.forEach((e=>{e.beforeCalculate()}));const r=e.map((async e=>{const{value:r}=e.field,n="function"==typeof r?r():r;if("static"===e.field.type){const r=new Filter("and");r.updateParameterFilter(e.fieldKey,n);const o={result:n,filter:r,payload:t},i=new Map;o.filter.getParameterFilters().forEach((e=>{i.set(e.name,e.value)})),await e.onCalculated(o.result,o.filter,t),this.fieldCacheResult.set(e.key,{data:this.cacheCenter.shouldCacheResult(e.element.computable,o.result)?o.result:void 0,parameters:o.filter,elapsedTime:0})}else await e.onCalculated(null,this.getFilter(e.key),t)}));try{await Promise.all(r)}catch(n){console.error(n)}e.forEach((e=>{e.afterCalculate()}))}async calculateConfigGroup(e,t){const r=new Map,n=new Map,o={};for(const l of e){const e=this.filters.get(l.key);null==e||e.getFilters().forEach((e=>{"parameter"===e.targetType&&"value"in e&&n.set(e.name,e.value)}));const i=getComputePayload(merge$1({},l.element.fieldPayload,l.field.payload),t.extPayload),{outsidePayload:a,...s}=i;a&&merge$1(o,a),null==e||e.cleanWhenEmpty();const{computeConfig:c,...u}=l.field;r.set(l.key,{...u,payload:s,filter:e})}e.forEach((e=>{e.beforeCalculate()}));const i=await this.service.compute({configs:Object.fromEntries(r),...o});"errorCode"in i&&i.errorCode&&this.eventsEmitter.emit("error",i);const a=e.map((async e=>{const r=this.filters.get(e.key),o={result:i.result[e.key],filter:null!=r?r:new Filter("and"),payload:t};await this.cacheCenter.compareCacheWithComputeResult(e.key,o.result,n,t.type)&&await e.onCalculated(o.result,o.filter,t),this.fieldCacheResult.set(e.key,{data:!!this.cacheCenter.shouldCacheResult(e.element.computable,o.result)&&o.result,parameters:o.filter,elapsedTime:i.computeTime?i.computeTime[e.key]:void 0}),"init"===t.type&&this.cacheCenter.updateCache(this.fieldCacheResult)}));try{await Promise.all(a)}catch(s){console.error(s)}e.forEach((e=>{e.afterCalculate()}))}getFilter(e){const t=this.filters.get(e);if(!t){const t=new Filter("and");return this.filters.set(e,t),t}return t}getParameterFromComputable(e){const t=new Map;return[...Array.from(e.fieldConfigs.keys()).map((t=>"".concat(e.id,".").concat(t))),e.id].forEach((e=>{this.getFilter(e).getParameterFilters().forEach((e=>{t.set(e.name,e.value)}))})),t}async updateRelationship(e,t,r=!1){var n,o;const i=new Map,a=(e,t)=>{if("static"!==t.type&&(r||!this.relationship.has(e))){const{computeConfig:r,...n}=t;i.set(e,n)}},{filterComponents:s,parameterComponents:l,storyComponents:c,currentStoryIndex:u}=e;if(s.forEach((e=>{for(const[t,r]of e.fieldConfigs)a("".concat(e.id,".").concat(t),r)})),l.forEach((e=>{const t=this.parameterCenter.getParameterValue(e.name);for(const[r,n]of e.fieldConfigs)t.isEmpty&&a("".concat(e.id,".").concat(r),n)})),t.forEach((e=>{if(!(isFilterable(e)&&s.has(e)))for(const[t,r]of e.fieldConfigs){const n=""===e.id?t:"".concat(e.id,".").concat(t);a(n,{...r,payload:{...r.payload,...e.fieldPayload}})}})),0===i.size)return;!r&&(null==(n=c.at(u))||n.forEach((e=>{e.fieldConfigs.forEach(((t,r)=>{const n="".concat(e.id,".").concat(r);!i.has(n)&&a(n,t)}))})));const{outsidePayloads:d,configs:h}=extractOutsidePayloadAndConfigs(i),p=await this.service.getDeps({configs:Object.fromEntries(h),...d});if("result"in p){this.relationship.updateDeps(p.result);const e=new Map;i.forEach(((t,r)=>{var n;"widgetId"in t&&e.set(toString$6(t.widgetId),null!=(n=p.result[r].widget)?n:[])})),null==(o=this.relationCalculate)||o.setRelations(e)}}getDepParametersByKey(e){return this.relationship.getDepParameters(e).getOrElse((()=>[]))}getDepForwardComputedNames(e){return this.relationship.getDepForwardComputedNames(e).getOrElse((()=>[]))}}function separateCalculateGroup(e){return e.reduce(((e,t)=>(e["static"===t.field.type||"relationWidget"===t.field.type?"staticGroup":"configGroup"].push(t),e)),{staticGroup:[],configGroup:[]})}function isInstanceofRelationLinkable(e){return"object"==typeof e&&null!==e&&"id"in e&&"relationMeta"in e&&"storyIndex"in e&&"setLinked"in e&&"setFilter"in e}class RelationCalculate{constructor(){__publicField(this,"relationComponents",[]),__publicField(this,"relations",new Map),__publicField(this,"linkageMap",new Map),__publicField(this,"linkageEvent")}getLinkage(e){const t=this.linkageMap.get(e);if(!t){const t=new Set;return this.linkageMap.set(e,t),t}return t}setRelationComponents(e){this.relationComponents=e}setRelations(e){e.forEach(((e,t)=>{const r=this.relations.get(t);r?e.forEach((e=>{r.push(e)})):this.relations.set(t,e)}))}onLinkage(e){this.linkageEvent=e}linkage(e,t,r){var n;const o=this.getLinkage(e.id),{storyIndex:i}=e;let a=!1;null==(n=this.relationComponents[i])||n.forEach((n=>{!r.includes(n.id)&&this.canLinkage(e,n)&&(o.add(n.id),this.linkageMap.forEach(((t,r)=>{r!==e.id&&t.has(n.id)&&t.delete(n.id)})),n.triggerLink(t),a=!0)})),a&&e.setLinked(!0),this.clearNoLinkage(i,[e.id])}clear(e,t){var r;e.setLinked(!1);const{storyIndex:n}=e,o=this.getLinkage(e.id);null==(r=this.relationComponents[n])||r.forEach((r=>{!t.includes(r.id)&&this.canLinkage(e,r)&&(o.delete(r.id),r.clearLink())})),this.clearNoLinkage(n)}clearAll(e){var t;this.linkageMap.forEach(((t,r)=>{var n;let o=!1;null==(n=this.relationComponents[e])||n.forEach((e=>{r===e.id&&(o=!0,e.setLinked(!1)),t.has(e.id)&&e.clearLink()})),o&&t.clear()})),null==(t=this.linkageEvent)||t.call(this,!1)}hasLinkage(e){return e.some((e=>{const t=this.linkageMap.get(e);return t&&t.size>0}))}onReCalculate(e,t){this.linkageMap.forEach((t=>{t.delete(e)})),this.clearNoLinkage(t)}canLinkage(e,t){if(e.relationMeta.wId===t.relationMeta.wId)return!0;const r=this.relations.get(e.relationMeta.wId);return r&&r.includes(t.relationMeta.wId)}clearNoLinkage(e,t=[]){var r;let n=!1;this.linkageMap.forEach(((r,o)=>{var i;null==(i=this.relationComponents[e])||i.forEach((e=>{e.id===o&&(0===r.size?!t.includes(e.id)&&e.setLinked(!1):n=!0)}))})),null==(r=this.linkageEvent)||r.call(this,n)}}const TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY={BACKGROUND:"backgroundColor",TEXT:"textColor",ONE:"one"},PREFIX_THEME_KEY="--fvs-theme-color",TEMPLATE_THEME_DEFAULT_COLOR_ROW=1,TEMPLATE_THEME_DEFAULT_COLOR_BACKGROUND_COL=1,TEMPLATE_THEME_DEFAULT_COLOR_TEXT_COL=2,TEMPLATE_THEME_DEFAULT_COLOR_ONE_COL=3;var freeGlobal$3="object"==typeof global&&global&&global.Object===Object&&global,freeSelf$2="object"==typeof self&&self&&self.Object===Object&&self,root$b=freeGlobal$3||freeSelf$2||Function("return this")(),Symbol$1$5=root$b.Symbol,objectProto$K=Object.prototype,hasOwnProperty$D=objectProto$K.hasOwnProperty,nativeObjectToString$5=objectProto$K.toString,symToStringTag$5=Symbol$1$5?Symbol$1$5.toStringTag:void 0;function getRawTag$3(e){var t=hasOwnProperty$D.call(e,symToStringTag$5),r=e[symToStringTag$5];try{e[symToStringTag$5]=void 0;var n=!0}catch(e3){}var o=nativeObjectToString$5.call(e);return n&&(t?e[symToStringTag$5]=r:delete e[symToStringTag$5]),o}var objectProto$J=Object.prototype,nativeObjectToString$4=objectProto$J.toString;function objectToString$3(e){return nativeObjectToString$4.call(e)}var nullTag$2="[object Null]",undefinedTag$2="[object Undefined]",symToStringTag$4=Symbol$1$5?Symbol$1$5.toStringTag:void 0;function baseGetTag$6(e){return null==e?void 0===e?undefinedTag$2:nullTag$2:symToStringTag$4&&symToStringTag$4 in Object(e)?getRawTag$3(e):objectToString$3(e)}function isObject$d(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var asyncTag$2="[object AsyncFunction]",funcTag$7="[object Function]",genTag$4="[object GeneratorFunction]",proxyTag$2="[object Proxy]";function isFunction$7(e){if(!isObject$d(e))return!1;var t=baseGetTag$6(e);return t==funcTag$7||t==genTag$4||t==asyncTag$2||t==proxyTag$2}var coreJsData$3=root$b["__core-js_shared__"],maskSrcKey$2=(uid=/[^.]+$/.exec(coreJsData$3&&coreJsData$3.keys&&coreJsData$3.keys.IE_PROTO||""),uid?"Symbol(src)_1."+uid:""),uid;function isMasked$3(e){return!!maskSrcKey$2&&maskSrcKey$2 in e}var funcProto$6=Function.prototype,funcToString$6=funcProto$6.toString;function toSource$3(e){if(null!=e){try{return funcToString$6.call(e)}catch(e3){}try{return e+""}catch(e3){}}return""}var reRegExpChar$2=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor$2=/^\[object .+?Constructor\]$/,funcProto$5=Function.prototype,objectProto$I=Object.prototype,funcToString$5=funcProto$5.toString,hasOwnProperty$C=objectProto$I.hasOwnProperty,reIsNative$2=RegExp("^"+funcToString$5.call(hasOwnProperty$C).replace(reRegExpChar$2,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative$3(e){return!(!isObject$d(e)||isMasked$3(e))&&(isFunction$7(e)?reIsNative$2:reIsHostCtor$2).test(toSource$3(e))}function getValue$5(e,t){return null==e?void 0:e[t]}function getNative$5(e,t){var r=getValue$5(e,t);return baseIsNative$3(r)?r:void 0}var defineProperty$4=function(){try{var e=getNative$5(Object,"defineProperty");return e({},"",{}),e}catch(e3){}}();function baseAssignValue$7(e,t,r){"__proto__"==t&&defineProperty$4?defineProperty$4(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function eq$5(e,t){return e===t||e!=e&&t!=t}var objectProto$H=Object.prototype,hasOwnProperty$B=objectProto$H.hasOwnProperty;function assignValue$5(e,t,r){var n=e[t];hasOwnProperty$B.call(e,t)&&eq$5(n,r)&&(void 0!==r||t in e)||baseAssignValue$7(e,t,r)}function copyObject$4(e,t,r,n){var o=!r;r||(r={});for(var i=-1,a=t.length;++i<a;){var s=t[i],l=void 0;void 0===l&&(l=e[s]),o?baseAssignValue$7(r,s,l):assignValue$5(r,s,l)}return r}function identity$9(e){return e}function apply$6(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var nativeMax$a=Math.max;function overRest$2(e,t,r){return t=nativeMax$a(void 0===t?e.length-1:t,0),function(){for(var n=arguments,o=-1,i=nativeMax$a(n.length-t,0),a=Array(i);++o<i;)a[o]=n[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=n[o];return s[t]=r(a),apply$6(e,this,s)}}function constant$2(e){return function(){return e}}var baseSetToString$2=defineProperty$4?function(e,t){return defineProperty$4(e,"toString",{configurable:!0,enumerable:!1,value:constant$2(t),writable:!0})}:identity$9,HOT_COUNT$1=800,HOT_SPAN$1=16,nativeNow$1=Date.now;function shortOut$3(e){var t=0,r=0;return function(){var n=nativeNow$1(),o=HOT_SPAN$1-(n-r);if(r=n,o>0){if(++t>=HOT_COUNT$1)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var setToString$3=shortOut$3(baseSetToString$2);function baseRest$6(e,t){return setToString$3(overRest$2(e,t,identity$9),e+"")}var MAX_SAFE_INTEGER$5=9007199254740991;function isLength$6(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER$5}function isArrayLike$6(e){return null!=e&&isLength$6(e.length)&&!isFunction$7(e)}var MAX_SAFE_INTEGER$4=9007199254740991,reIsUint$2=/^(?:0|[1-9]\d*)$/;function isIndex$7(e,t){var r=typeof e;return!!(t=null==t?MAX_SAFE_INTEGER$4:t)&&("number"==r||"symbol"!=r&&reIsUint$2.test(e))&&e>-1&&e%1==0&&e<t}function isIterateeCall$2(e,t,r){if(!isObject$d(r))return!1;var n=typeof t;return!!("number"==n?isArrayLike$6(r)&&isIndex$7(t,r.length):"string"==n&&t in r)&&eq$5(r[t],e)}function createAssigner$4(e){return baseRest$6((function(t,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,a=o>2?r[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&isIterateeCall$2(r[0],r[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++n<o;){var s=r[n];s&&e(t,s,n,i)}return t}))}var objectProto$G=Object.prototype;function isPrototype$4(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$G)}function baseTimes$4(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function isObjectLike$7(e){return null!=e&&"object"==typeof e}var argsTag$9="[object Arguments]";function baseIsArguments$3(e){return isObjectLike$7(e)&&baseGetTag$6(e)==argsTag$9}var objectProto$F=Object.prototype,hasOwnProperty$A=objectProto$F.hasOwnProperty,propertyIsEnumerable$4=objectProto$F.propertyIsEnumerable,isArguments$4=baseIsArguments$3(function(){return arguments}())?baseIsArguments$3:function(e){return isObjectLike$7(e)&&hasOwnProperty$A.call(e,"callee")&&!propertyIsEnumerable$4.call(e,"callee")},isArray$b=Array.isArray;function stubFalse$2(){return!1}var freeExports$5="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$5=freeExports$5&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$5=freeModule$5&&freeModule$5.exports===freeExports$5,Buffer$3=moduleExports$5?root$b.Buffer:void 0,nativeIsBuffer$1=Buffer$3?Buffer$3.isBuffer:void 0,isBuffer$5=nativeIsBuffer$1||stubFalse$2,argsTag$8="[object Arguments]",arrayTag$6="[object Array]",boolTag$8="[object Boolean]",dateTag$8="[object Date]",errorTag$6="[object Error]",funcTag$6="[object Function]",mapTag$d="[object Map]",numberTag$a="[object Number]",objectTag$9="[object Object]",regexpTag$8="[object RegExp]",setTag$d="[object Set]",stringTag$9="[object String]",weakMapTag$6="[object WeakMap]",arrayBufferTag$8="[object ArrayBuffer]",dataViewTag$a="[object DataView]",float32Tag$6="[object Float32Array]",float64Tag$6="[object Float64Array]",int8Tag$6="[object Int8Array]",int16Tag$6="[object Int16Array]",int32Tag$6="[object Int32Array]",uint8Tag$6="[object Uint8Array]",uint8ClampedTag$6="[object Uint8ClampedArray]",uint16Tag$6="[object Uint16Array]",uint32Tag$6="[object Uint32Array]",typedArrayTags$2={};function baseIsTypedArray$3(e){return isObjectLike$7(e)&&isLength$6(e.length)&&!!typedArrayTags$2[baseGetTag$6(e)]}function baseUnary$3(e){return function(t){return e(t)}}typedArrayTags$2[float32Tag$6]=typedArrayTags$2[float64Tag$6]=typedArrayTags$2[int8Tag$6]=typedArrayTags$2[int16Tag$6]=typedArrayTags$2[int32Tag$6]=typedArrayTags$2[uint8Tag$6]=typedArrayTags$2[uint8ClampedTag$6]=typedArrayTags$2[uint16Tag$6]=typedArrayTags$2[uint32Tag$6]=!0,typedArrayTags$2[argsTag$8]=typedArrayTags$2[arrayTag$6]=typedArrayTags$2[arrayBufferTag$8]=typedArrayTags$2[boolTag$8]=typedArrayTags$2[dataViewTag$a]=typedArrayTags$2[dateTag$8]=typedArrayTags$2[errorTag$6]=typedArrayTags$2[funcTag$6]=typedArrayTags$2[mapTag$d]=typedArrayTags$2[numberTag$a]=typedArrayTags$2[objectTag$9]=typedArrayTags$2[regexpTag$8]=typedArrayTags$2[setTag$d]=typedArrayTags$2[stringTag$9]=typedArrayTags$2[weakMapTag$6]=!1;var freeExports$4="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$4=freeExports$4&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$4=freeModule$4&&freeModule$4.exports===freeExports$4,freeProcess$1=moduleExports$4&&freeGlobal$3.process,nodeUtil$2=function(){try{var e=freeModule$4&&freeModule$4.require&&freeModule$4.require("util").types;return e||freeProcess$1&&freeProcess$1.binding&&freeProcess$1.binding("util")}catch(e3){}}(),nodeIsTypedArray$2=nodeUtil$2&&nodeUtil$2.isTypedArray,isTypedArray$3=nodeIsTypedArray$2?baseUnary$3(nodeIsTypedArray$2):baseIsTypedArray$3,objectProto$E=Object.prototype,hasOwnProperty$z=objectProto$E.hasOwnProperty;function arrayLikeKeys$3(e,t){var r=isArray$b(e),n=!r&&isArguments$4(e),o=!r&&!n&&isBuffer$5(e),i=!r&&!n&&!o&&isTypedArray$3(e),a=r||n||o||i,s=a?baseTimes$4(e.length,String):[],l=s.length;for(var c in e)!t&&!hasOwnProperty$z.call(e,c)||a&&("length"==c||o&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||isIndex$7(c,l))||s.push(c);return s}function overArg$3(e,t){return function(r){return e(t(r))}}var nativeKeys$3=overArg$3(Object.keys,Object),objectProto$D=Object.prototype,hasOwnProperty$y=objectProto$D.hasOwnProperty;function baseKeys$3(e){if(!isPrototype$4(e))return nativeKeys$3(e);var t=[];for(var r in Object(e))hasOwnProperty$y.call(e,r)&&"constructor"!=r&&t.push(r);return t}function keys$6(e){return isArrayLike$6(e)?arrayLikeKeys$3(e):baseKeys$3(e)}function arrayMap$6(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}function listCacheClear$3(){this.__data__=[],this.size=0}function assocIndexOf$6(e,t){for(var r=e.length;r--;)if(eq$5(e[r][0],t))return r;return-1}var arrayProto$3=Array.prototype,splice$3=arrayProto$3.splice;function listCacheDelete$3(e){var t=this.__data__,r=assocIndexOf$6(t,e);return!(r<0)&&(r==t.length-1?t.pop():splice$3.call(t,r,1),--this.size,!0)}function listCacheGet$3(e){var t=this.__data__,r=assocIndexOf$6(t,e);return r<0?void 0:t[r][1]}function listCacheHas$3(e){return assocIndexOf$6(this.__data__,e)>-1}function listCacheSet$3(e,t){var r=this.__data__,n=assocIndexOf$6(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}function ListCache$3(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function stackClear$1(){this.__data__=new ListCache$3,this.size=0}function stackDelete$1(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function stackGet$1(e){return this.__data__.get(e)}function stackHas$1(e){return this.__data__.has(e)}ListCache$3.prototype.clear=listCacheClear$3,ListCache$3.prototype.delete=listCacheDelete$3,ListCache$3.prototype.get=listCacheGet$3,ListCache$3.prototype.has=listCacheHas$3,ListCache$3.prototype.set=listCacheSet$3;var Map$4=getNative$5(root$b,"Map"),nativeCreate$6=getNative$5(Object,"create");function hashClear$3(){this.__data__=nativeCreate$6?nativeCreate$6(null):{},this.size=0}function hashDelete$3(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var HASH_UNDEFINED$7="__lodash_hash_undefined__",objectProto$C=Object.prototype,hasOwnProperty$x=objectProto$C.hasOwnProperty;function hashGet$3(e){var t=this.__data__;if(nativeCreate$6){var r=t[e];return r===HASH_UNDEFINED$7?void 0:r}return hasOwnProperty$x.call(t,e)?t[e]:void 0}var objectProto$B=Object.prototype,hasOwnProperty$w=objectProto$B.hasOwnProperty;function hashHas$3(e){var t=this.__data__;return nativeCreate$6?void 0!==t[e]:hasOwnProperty$w.call(t,e)}var HASH_UNDEFINED$6="__lodash_hash_undefined__";function hashSet$3(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=nativeCreate$6&&void 0===t?HASH_UNDEFINED$6:t,this}function Hash$3(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function mapCacheClear$3(){this.size=0,this.__data__={hash:new Hash$3,map:new(Map$4||ListCache$3),string:new Hash$3}}function isKeyable$3(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function getMapData$6(e,t){var r=e.__data__;return isKeyable$3(t)?r["string"==typeof t?"string":"hash"]:r.map}function mapCacheDelete$3(e){var t=getMapData$6(this,e).delete(e);return this.size-=t?1:0,t}function mapCacheGet$3(e){return getMapData$6(this,e).get(e)}function mapCacheHas$3(e){return getMapData$6(this,e).has(e)}function mapCacheSet$3(e,t){var r=getMapData$6(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}function MapCache$3(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Hash$3.prototype.clear=hashClear$3,Hash$3.prototype.delete=hashDelete$3,Hash$3.prototype.get=hashGet$3,Hash$3.prototype.has=hashHas$3,Hash$3.prototype.set=hashSet$3,MapCache$3.prototype.clear=mapCacheClear$3,MapCache$3.prototype.delete=mapCacheDelete$3,MapCache$3.prototype.get=mapCacheGet$3,MapCache$3.prototype.has=mapCacheHas$3,MapCache$3.prototype.set=mapCacheSet$3;var LARGE_ARRAY_SIZE$1=200;function stackSet$1(e,t){var r=this.__data__;if(r instanceof ListCache$3){var n=r.__data__;if(!Map$4||n.length<LARGE_ARRAY_SIZE$1-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new MapCache$3(n)}return r.set(e,t),this.size=r.size,this}function Stack$1(e){var t=this.__data__=new ListCache$3(e);this.size=t.size}Stack$1.prototype.clear=stackClear$1,Stack$1.prototype.delete=stackDelete$1,Stack$1.prototype.get=stackGet$1,Stack$1.prototype.has=stackHas$1,Stack$1.prototype.set=stackSet$1;var HASH_UNDEFINED$5="__lodash_hash_undefined__";function setCacheAdd$1(e){return this.__data__.set(e,HASH_UNDEFINED$5),this}function setCacheHas$1(e){return this.__data__.has(e)}function SetCache$1(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new MapCache$3;++t<r;)this.add(e[t])}function arraySome$1(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function cacheHas$1(e,t){return e.has(t)}SetCache$1.prototype.add=SetCache$1.prototype.push=setCacheAdd$1,SetCache$1.prototype.has=setCacheHas$1;var COMPARE_PARTIAL_FLAG$b=1,COMPARE_UNORDERED_FLAG$7=2;function equalArrays$1(e,t,r,n,o,i){var a=r&COMPARE_PARTIAL_FLAG$b,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=i.get(e),u=i.get(t);if(c&&u)return c==t&&u==e;var d=-1,h=!0,p=r&COMPARE_UNORDERED_FLAG$7?new SetCache$1:void 0;for(i.set(e,t),i.set(t,e);++d<s;){var f=e[d],g=t[d];if(n)var m=a?n(g,f,d,t,e,i):n(f,g,d,e,t,i);if(void 0!==m){if(m)continue;h=!1;break}if(p){if(!arraySome$1(t,(function(e,t){if(!cacheHas$1(p,t)&&(f===e||o(f,e,r,n,i)))return p.push(t)}))){h=!1;break}}else if(f!==g&&!o(f,g,r,n,i)){h=!1;break}}return i.delete(e),i.delete(t),h}var Uint8Array$2=root$b.Uint8Array;function mapToArray$1(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function setToArray$1(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var COMPARE_PARTIAL_FLAG$a=1,COMPARE_UNORDERED_FLAG$6=2,boolTag$7="[object Boolean]",dateTag$7="[object Date]",errorTag$5="[object Error]",mapTag$c="[object Map]",numberTag$9="[object Number]",regexpTag$7="[object RegExp]",setTag$c="[object Set]",stringTag$8="[object String]",symbolTag$8="[object Symbol]",arrayBufferTag$7="[object ArrayBuffer]",dataViewTag$9="[object DataView]",symbolProto$6=Symbol$1$5?Symbol$1$5.prototype:void 0,symbolValueOf$3=symbolProto$6?symbolProto$6.valueOf:void 0;function equalByTag$1(e,t,r,n,o,i,a){switch(r){case dataViewTag$9:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case arrayBufferTag$7:return!(e.byteLength!=t.byteLength||!i(new Uint8Array$2(e),new Uint8Array$2(t)));case boolTag$7:case dateTag$7:case numberTag$9:return eq$5(+e,+t);case errorTag$5:return e.name==t.name&&e.message==t.message;case regexpTag$7:case stringTag$8:return e==t+"";case mapTag$c:var s=mapToArray$1;case setTag$c:var l=n&COMPARE_PARTIAL_FLAG$a;if(s||(s=setToArray$1),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;n|=COMPARE_UNORDERED_FLAG$6,a.set(e,t);var u=equalArrays$1(s(e),s(t),n,o,i,a);return a.delete(e),u;case symbolTag$8:if(symbolValueOf$3)return symbolValueOf$3.call(e)==symbolValueOf$3.call(t)}return!1}function arrayPush$1(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}function baseGetAllKeys$1(e,t,r){var n=t(e);return isArray$b(e)?n:arrayPush$1(n,r(e))}function arrayFilter$2(e,t){for(var r=-1,n=null==e?0:e.length,o=0,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[o++]=a)}return i}function stubArray$1(){return[]}var objectProto$A=Object.prototype,propertyIsEnumerable$3=objectProto$A.propertyIsEnumerable,nativeGetSymbols$3=Object.getOwnPropertySymbols,getSymbols$1=nativeGetSymbols$3?function(e){return null==e?[]:(e=Object(e),arrayFilter$2(nativeGetSymbols$3(e),(function(t){return propertyIsEnumerable$3.call(e,t)})))}:stubArray$1;function getAllKeys$1(e){return baseGetAllKeys$1(e,keys$6,getSymbols$1)}var COMPARE_PARTIAL_FLAG$9=1,objectProto$z=Object.prototype,hasOwnProperty$v=objectProto$z.hasOwnProperty;function equalObjects$1(e,t,r,n,o,i){var a=r&COMPARE_PARTIAL_FLAG$9,s=getAllKeys$1(e),l=s.length;if(l!=getAllKeys$1(t).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in t:hasOwnProperty$v.call(t,u)))return!1}var d=i.get(e),h=i.get(t);if(d&&h)return d==t&&h==e;var p=!0;i.set(e,t),i.set(t,e);for(var f=a;++c<l;){var g=e[u=s[c]],m=t[u];if(n)var y=a?n(m,g,u,t,e,i):n(g,m,u,e,t,i);if(!(void 0===y?g===m||o(g,m,r,n,i):y)){p=!1;break}f||(f="constructor"==u)}if(p&&!f){var v=e.constructor,_=t.constructor;v==_||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof _&&_ instanceof _||(p=!1)}return i.delete(e),i.delete(t),p}var DataView$2=getNative$5(root$b,"DataView"),Promise$1$1=getNative$5(root$b,"Promise"),Set$2=getNative$5(root$b,"Set"),WeakMap$3=getNative$5(root$b,"WeakMap"),mapTag$b="[object Map]",objectTag$8="[object Object]",promiseTag$1="[object Promise]",setTag$b="[object Set]",weakMapTag$5="[object WeakMap]",dataViewTag$8="[object DataView]",dataViewCtorString$1=toSource$3(DataView$2),mapCtorString$1=toSource$3(Map$4),promiseCtorString$1=toSource$3(Promise$1$1),setCtorString$1=toSource$3(Set$2),weakMapCtorString$1=toSource$3(WeakMap$3),getTag$1=baseGetTag$6;(DataView$2&&getTag$1(new DataView$2(new ArrayBuffer(1)))!=dataViewTag$8||Map$4&&getTag$1(new Map$4)!=mapTag$b||Promise$1$1&&getTag$1(Promise$1$1.resolve())!=promiseTag$1||Set$2&&getTag$1(new Set$2)!=setTag$b||WeakMap$3&&getTag$1(new WeakMap$3)!=weakMapTag$5)&&(getTag$1=function(e){var t=baseGetTag$6(e),r=t==objectTag$8?e.constructor:void 0,n=r?toSource$3(r):"";if(n)switch(n){case dataViewCtorString$1:return dataViewTag$8;case mapCtorString$1:return mapTag$b;case promiseCtorString$1:return promiseTag$1;case setCtorString$1:return setTag$b;case weakMapCtorString$1:return weakMapTag$5}return t});var COMPARE_PARTIAL_FLAG$8=1,argsTag$7="[object Arguments]",arrayTag$5="[object Array]",objectTag$7="[object Object]",objectProto$y=Object.prototype,hasOwnProperty$u=objectProto$y.hasOwnProperty;function baseIsEqualDeep$1(e,t,r,n,o,i){var a=isArray$b(e),s=isArray$b(t),l=a?arrayTag$5:getTag$1(e),c=s?arrayTag$5:getTag$1(t),u=(l=l==argsTag$7?objectTag$7:l)==objectTag$7,d=(c=c==argsTag$7?objectTag$7:c)==objectTag$7,h=l==c;if(h&&isBuffer$5(e)){if(!isBuffer$5(t))return!1;a=!0,u=!1}if(h&&!u)return i||(i=new Stack$1),a||isTypedArray$3(e)?equalArrays$1(e,t,r,n,o,i):equalByTag$1(e,t,l,r,n,o,i);if(!(r&COMPARE_PARTIAL_FLAG$8)){var p=u&&hasOwnProperty$u.call(e,"__wrapped__"),f=d&&hasOwnProperty$u.call(t,"__wrapped__");if(p||f){var g=p?e.value():e,m=f?t.value():t;return i||(i=new Stack$1),o(g,m,r,n,i)}}return!!h&&(i||(i=new Stack$1),equalObjects$1(e,t,r,n,o,i))}function baseIsEqual$1(e,t,r,n,o){return e===t||(null==e||null==t||!isObjectLike$7(e)&&!isObjectLike$7(t)?e!=e&&t!=t:baseIsEqualDeep$1(e,t,r,n,baseIsEqual$1,o))}var COMPARE_PARTIAL_FLAG$7=1,COMPARE_UNORDERED_FLAG$5=2;function baseIsMatch$1(e,t,r,n){var o=r.length,i=o;if(null==e)return!i;for(e=Object(e);o--;){var a=r[o];if(a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++o<i;){var s=(a=r[o])[0],l=e[s],c=a[1];if(a[2]){if(void 0===l&&!(s in e))return!1}else{var u=new Stack$1;if(!baseIsEqual$1(c,l,COMPARE_PARTIAL_FLAG$7|COMPARE_UNORDERED_FLAG$5,n,u))return!1}}return!0}function isStrictComparable$1(e){return e==e&&!isObject$d(e)}function getMatchData$1(e){for(var t=keys$6(e),r=t.length;r--;){var n=t[r],o=e[n];t[r]=[n,o,isStrictComparable$1(o)]}return t}function matchesStrictComparable$1(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}function baseMatches$1(e){var t=getMatchData$1(e);return 1==t.length&&t[0][2]?matchesStrictComparable$1(t[0][0],t[0][1]):function(r){return r===e||baseIsMatch$1(r,e,t)}}var symbolTag$7="[object Symbol]";function isSymbol$7(e){return"symbol"==typeof e||isObjectLike$7(e)&&baseGetTag$6(e)==symbolTag$7}var reIsDeepProp$2=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp$2=/^\w*$/;function isKey$5(e,t){if(isArray$b(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!isSymbol$7(e))||(reIsPlainProp$2.test(e)||!reIsDeepProp$2.test(e)||null!=t&&e in Object(t))}var FUNC_ERROR_TEXT$9="Expected a function";function memoize$4(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT$9);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(memoize$4.Cache||MapCache$3),r}memoize$4.Cache=MapCache$3;var MAX_MEMOIZE_SIZE$2=500;function memoizeCapped$3(e){var t=memoize$4(e,(function(e){return r.size===MAX_MEMOIZE_SIZE$2&&r.clear(),e})),r=t.cache;return t}var rePropName$2=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar$2=/\\(\\)?/g,stringToPath$3=memoizeCapped$3((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(rePropName$2,(function(e,r,n,o){t.push(n?o.replace(reEscapeChar$2,"$1"):r||e)})),t})),INFINITY$6=1/0,symbolProto$5=Symbol$1$5?Symbol$1$5.prototype:void 0,symbolToString$2=symbolProto$5?symbolProto$5.toString:void 0;function baseToString$3(e){if("string"==typeof e)return e;if(isArray$b(e))return arrayMap$6(e,baseToString$3)+"";if(isSymbol$7(e))return symbolToString$2?symbolToString$2.call(e):"";var t=e+"";return"0"==t&&1/e==-INFINITY$6?"-0":t}function toString$5(e){return null==e?"":baseToString$3(e)}function castPath$5(e,t){return isArray$b(e)?e:isKey$5(e,t)?[e]:stringToPath$3(toString$5(e))}var INFINITY$5=1/0;function toKey$5(e){if("string"==typeof e||isSymbol$7(e))return e;var t=e+"";return"0"==t&&1/e==-INFINITY$5?"-0":t}function baseGet$3(e,t){for(var r=0,n=(t=castPath$5(t,e)).length;null!=e&&r<n;)e=e[toKey$5(t[r++])];return r&&r==n?e:void 0}function get$4(e,t,r){var n=null==e?void 0:baseGet$3(e,t);return void 0===n?r:n}function baseHasIn$1(e,t){return null!=e&&t in Object(e)}function hasPath$3(e,t,r){for(var n=-1,o=(t=castPath$5(t,e)).length,i=!1;++n<o;){var a=toKey$5(t[n]);if(!(i=null!=e&&r(e,a)))break;e=e[a]}return i||++n!=o?i:!!(o=null==e?0:e.length)&&isLength$6(o)&&isIndex$7(a,o)&&(isArray$b(e)||isArguments$4(e))}function hasIn$1(e,t){return null!=e&&hasPath$3(e,t,baseHasIn$1)}var COMPARE_PARTIAL_FLAG$6=1,COMPARE_UNORDERED_FLAG$4=2;function baseMatchesProperty$1(e,t){return isKey$5(e)&&isStrictComparable$1(t)?matchesStrictComparable$1(toKey$5(e),t):function(r){var n=get$4(r,e);return void 0===n&&n===t?hasIn$1(r,e):baseIsEqual$1(t,n,COMPARE_PARTIAL_FLAG$6|COMPARE_UNORDERED_FLAG$4)}}function baseProperty$2(e){return function(t){return null==t?void 0:t[e]}}function basePropertyDeep$1(e){return function(t){return baseGet$3(t,e)}}function property$1(e){return isKey$5(e)?baseProperty$2(toKey$5(e)):basePropertyDeep$1(e)}function baseIteratee$6(e){return"function"==typeof e?e:null==e?identity$9:"object"==typeof e?isArray$b(e)?baseMatchesProperty$1(e[0],e[1]):baseMatches$1(e):property$1(e)}var getPrototype$1=overArg$3(Object.getPrototypeOf,Object),nativeGetSymbols$2=Object.getOwnPropertySymbols,getSymbolsIn$1=nativeGetSymbols$2?function(e){for(var t=[];e;)arrayPush$1(t,getSymbols$1(e)),e=getPrototype$1(e);return t}:stubArray$1;function nativeKeysIn$1(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}var objectProto$x=Object.prototype,hasOwnProperty$t=objectProto$x.hasOwnProperty;function baseKeysIn$1(e){if(!isObject$d(e))return nativeKeysIn$1(e);var t=isPrototype$4(e),r=[];for(var n in e)("constructor"!=n||!t&&hasOwnProperty$t.call(e,n))&&r.push(n);return r}function keysIn$2(e){return isArrayLike$6(e)?arrayLikeKeys$3(e,!0):baseKeysIn$1(e)}function getAllKeysIn$2(e){return baseGetAllKeys$1(e,keysIn$2,getSymbolsIn$1)}function createBaseFor$2(e){return function(e,t,r){for(var n=-1,o=Object(e),i=r(e),a=i.length;a--;){var s=i[++n];if(!1===t(o[s],s,o))break}return e}}var baseFor$2=createBaseFor$2();function baseForOwn$3(e,t){return e&&baseFor$2(e,t,keys$6)}function createBaseEach$2(e,t){return function(t,r){if(null==t)return t;if(!isArrayLike$6(t))return e(t,r);for(var n=t.length,o=-1,i=Object(t);++o<n&&!1!==r(i[o],o,i););return t}}var baseEach$2=createBaseEach$2(baseForOwn$3);function baseMap(e,t){var r=-1,n=isArrayLike$6(e)?Array(e.length):[];return baseEach$2(e,(function(e,o,i){n[++r]=t(e,o,i)})),n}function map$2(e,t){return(isArray$b(e)?arrayMap$6:baseMap)(e,baseIteratee$6(t))}var stringTag$7="[object String]";function isString$2(e){return"string"==typeof e||!isArray$b(e)&&isObjectLike$7(e)&&baseGetTag$6(e)==stringTag$7}function arrayEach$4(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}function castFunction$2(e){return"function"==typeof e?e:identity$9}function forEach$2(e,t){return(isArray$b(e)?arrayEach$4:baseEach$2)(e,castFunction$2(t))}function baseSlice$1(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(o);++n<o;)i[n]=e[n+t];return i}var reWhitespace$1=/\s/;function trimmedEndIndex$2(e){for(var t=e.length;t--&&reWhitespace$1.test(e.charAt(t)););return t}var reTrimStart$1=/^\s+/;function baseTrim$2(e){return e?e.slice(0,trimmedEndIndex$2(e)+1).replace(reTrimStart$1,""):e}var NAN$2=NaN,reIsBadHex$2=/^[-+]0x[0-9a-f]+$/i,reIsBinary$2=/^0b[01]+$/i,reIsOctal$2=/^0o[0-7]+$/i,freeParseInt$2=parseInt;function toNumber$6(e){if("number"==typeof e)return e;if(isSymbol$7(e))return NAN$2;if(isObject$d(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=isObject$d(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=baseTrim$2(e);var r=reIsBinary$2.test(e);return r||reIsOctal$2.test(e)?freeParseInt$2(e.slice(2),r?2:8):reIsBadHex$2.test(e)?NAN$2:+e}var spreadableSymbol=Symbol$1$5?Symbol$1$5.isConcatSpreadable:void 0;function isFlattenable(e){return isArray$b(e)||isArguments$4(e)||!!(spreadableSymbol&&e&&e[spreadableSymbol])}function baseFlatten$1(e,t,r,n,o){var i=-1,a=e.length;for(r||(r=isFlattenable),o||(o=[]);++i<a;){var s=e[i];r(s)?arrayPush$1(o,s):o[o.length]=s}return o}function flatten(e){return(null==e?0:e.length)?baseFlatten$1(e):[]}function isUndefined$2(e){return void 0===e}function isArrayLikeObject$1(e){return isObjectLike$7(e)&&isArrayLike$6(e)}function baseAssign$1(e,t){return e&&copyObject$4(t,keys$6(t),e)}function baseAssignIn$1(e,t){return e&&copyObject$4(t,keysIn$2(t),e)}var freeExports$3="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$3=freeExports$3&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$3=freeModule$3&&freeModule$3.exports===freeExports$3,Buffer$2=moduleExports$3?root$b.Buffer:void 0,allocUnsafe$1=Buffer$2?Buffer$2.allocUnsafe:void 0;function cloneBuffer$1(e,t){if(t)return e.slice();var r=e.length,n=allocUnsafe$1?allocUnsafe$1(r):new e.constructor(r);return e.copy(n),n}function copyArray$3(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}function copySymbols$1(e,t){return copyObject$4(e,getSymbols$1(e),t)}function copySymbolsIn$1(e,t){return copyObject$4(e,getSymbolsIn$1(e),t)}var objectProto$w=Object.prototype,hasOwnProperty$s=objectProto$w.hasOwnProperty;function initCloneArray$1(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&hasOwnProperty$s.call(e,"index")&&(r.index=e.index,r.input=e.input),r}function cloneArrayBuffer$1(e){var t=new e.constructor(e.byteLength);return new Uint8Array$2(t).set(new Uint8Array$2(e)),t}function cloneDataView$1(e,t){var r=t?cloneArrayBuffer$1(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var reFlags$1=/\w*$/;function cloneRegExp$1(e){var t=new e.constructor(e.source,reFlags$1.exec(e));return t.lastIndex=e.lastIndex,t}var symbolProto$4=Symbol$1$5?Symbol$1$5.prototype:void 0,symbolValueOf$2=symbolProto$4?symbolProto$4.valueOf:void 0;function cloneSymbol$1(e){return symbolValueOf$2?Object(symbolValueOf$2.call(e)):{}}function cloneTypedArray$1(e,t){var r=t?cloneArrayBuffer$1(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var boolTag$6="[object Boolean]",dateTag$6="[object Date]",mapTag$a="[object Map]",numberTag$8="[object Number]",regexpTag$6="[object RegExp]",setTag$a="[object Set]",stringTag$6="[object String]",symbolTag$6="[object Symbol]",arrayBufferTag$6="[object ArrayBuffer]",dataViewTag$7="[object DataView]",float32Tag$5="[object Float32Array]",float64Tag$5="[object Float64Array]",int8Tag$5="[object Int8Array]",int16Tag$5="[object Int16Array]",int32Tag$5="[object Int32Array]",uint8Tag$5="[object Uint8Array]",uint8ClampedTag$5="[object Uint8ClampedArray]",uint16Tag$5="[object Uint16Array]",uint32Tag$5="[object Uint32Array]";function initCloneByTag$1(e,t,r){var n=e.constructor;switch(t){case arrayBufferTag$6:return cloneArrayBuffer$1(e);case boolTag$6:case dateTag$6:return new n(+e);case dataViewTag$7:return cloneDataView$1(e,r);case float32Tag$5:case float64Tag$5:case int8Tag$5:case int16Tag$5:case int32Tag$5:case uint8Tag$5:case uint8ClampedTag$5:case uint16Tag$5:case uint32Tag$5:return cloneTypedArray$1(e,r);case mapTag$a:return new n;case numberTag$8:case stringTag$6:return new n(e);case regexpTag$6:return cloneRegExp$1(e);case setTag$a:return new n;case symbolTag$6:return cloneSymbol$1(e)}}var objectCreate$1=Object.create,baseCreate$4=function(){function e(){}return function(t){if(!isObject$d(t))return{};if(objectCreate$1)return objectCreate$1(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function initCloneObject$1(e){return"function"!=typeof e.constructor||isPrototype$4(e)?{}:baseCreate$4(getPrototype$1(e))}var mapTag$9="[object Map]";function baseIsMap$1(e){return isObjectLike$7(e)&&getTag$1(e)==mapTag$9}var nodeIsMap$1=nodeUtil$2&&nodeUtil$2.isMap,isMap$1=nodeIsMap$1?baseUnary$3(nodeIsMap$1):baseIsMap$1,setTag$9="[object Set]";function baseIsSet$1(e){return isObjectLike$7(e)&&getTag$1(e)==setTag$9}var nodeIsSet$1=nodeUtil$2&&nodeUtil$2.isSet,isSet$1=nodeIsSet$1?baseUnary$3(nodeIsSet$1):baseIsSet$1,CLONE_DEEP_FLAG$4=1,CLONE_FLAT_FLAG$2=2,CLONE_SYMBOLS_FLAG$5=4,argsTag$6="[object Arguments]",arrayTag$4="[object Array]",boolTag$5="[object Boolean]",dateTag$5="[object Date]",errorTag$4="[object Error]",funcTag$5="[object Function]",genTag$3="[object GeneratorFunction]",mapTag$8="[object Map]",numberTag$7="[object Number]",objectTag$6="[object Object]",regexpTag$5="[object RegExp]",setTag$8="[object Set]",stringTag$5="[object String]",symbolTag$5="[object Symbol]",weakMapTag$4="[object WeakMap]",arrayBufferTag$5="[object ArrayBuffer]",dataViewTag$6="[object DataView]",float32Tag$4="[object Float32Array]",float64Tag$4="[object Float64Array]",int8Tag$4="[object Int8Array]",int16Tag$4="[object Int16Array]",int32Tag$4="[object Int32Array]",uint8Tag$4="[object Uint8Array]",uint8ClampedTag$4="[object Uint8ClampedArray]",uint16Tag$4="[object Uint16Array]",uint32Tag$4="[object Uint32Array]",cloneableTags$1={};function baseClone$2(e,t,r,n,o,i){var a,s=t&CLONE_DEEP_FLAG$4,l=t&CLONE_FLAT_FLAG$2,c=t&CLONE_SYMBOLS_FLAG$5;if(r&&(a=o?r(e,n,o,i):r(e)),void 0!==a)return a;if(!isObject$d(e))return e;var u=isArray$b(e);if(u){if(a=initCloneArray$1(e),!s)return copyArray$3(e,a)}else{var d=getTag$1(e),h=d==funcTag$5||d==genTag$3;if(isBuffer$5(e))return cloneBuffer$1(e,s);if(d==objectTag$6||d==argsTag$6||h&&!o){if(a=l||h?{}:initCloneObject$1(e),!s)return l?copySymbolsIn$1(e,baseAssignIn$1(a,e)):copySymbols$1(e,baseAssign$1(a,e))}else{if(!cloneableTags$1[d])return o?e:{};a=initCloneByTag$1(e,d,s)}}i||(i=new Stack$1);var p=i.get(e);if(p)return p;i.set(e,a),isSet$1(e)?e.forEach((function(n){a.add(baseClone$2(n,t,r,n,e,i))})):isMap$1(e)&&e.forEach((function(n,o){a.set(o,baseClone$2(n,t,r,o,e,i))}));var f=u?void 0:(c?l?getAllKeysIn$2:getAllKeys$1:l?keysIn$2:keys$6)(e);return arrayEach$4(f||e,(function(n,o){f&&(n=e[o=n]),assignValue$5(a,o,baseClone$2(n,t,r,o,e,i))})),a}function last$1(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}cloneableTags$1[argsTag$6]=cloneableTags$1[arrayTag$4]=cloneableTags$1[arrayBufferTag$5]=cloneableTags$1[dataViewTag$6]=cloneableTags$1[boolTag$5]=cloneableTags$1[dateTag$5]=cloneableTags$1[float32Tag$4]=cloneableTags$1[float64Tag$4]=cloneableTags$1[int8Tag$4]=cloneableTags$1[int16Tag$4]=cloneableTags$1[int32Tag$4]=cloneableTags$1[mapTag$8]=cloneableTags$1[numberTag$7]=cloneableTags$1[objectTag$6]=cloneableTags$1[regexpTag$5]=cloneableTags$1[setTag$8]=cloneableTags$1[stringTag$5]=cloneableTags$1[symbolTag$5]=cloneableTags$1[uint8Tag$4]=cloneableTags$1[uint8ClampedTag$4]=cloneableTags$1[uint16Tag$4]=cloneableTags$1[uint32Tag$4]=!0,cloneableTags$1[errorTag$4]=cloneableTags$1[funcTag$5]=cloneableTags$1[weakMapTag$4]=!1;var numberTag$6="[object Number]";function isNumber$4(e){return"number"==typeof e||isObjectLike$7(e)&&baseGetTag$6(e)==numberTag$6}var now$4=function(){return root$b.Date.now()},FUNC_ERROR_TEXT$8="Expected a function",nativeMax$9=Math.max,nativeMin$5=Math.min;function debounce$2(e,t,r){var n,o,i,a,s,l,c=0,u=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$8);function p(t){var r=n,i=o;return n=o=void 0,c=t,a=e.apply(i,r)}function f(e){var r=e-l;return void 0===l||r>=t||r<0||d&&e-c>=i}function g(){var e=now$4();if(f(e))return m(e);s=setTimeout(g,function(e){var r=t-(e-l);return d?nativeMin$5(r,i-(e-c)):r}(e))}function m(e){return s=void 0,h&&n?p(e):(n=o=void 0,a)}function y(){var e=now$4(),r=f(e);if(n=arguments,o=this,l=e,r){if(void 0===s)return function(e){return c=e,s=setTimeout(g,t),u?p(e):a}(l);if(d)return clearTimeout(s),s=setTimeout(g,t),p(l)}return void 0===s&&(s=setTimeout(g,t)),a}return t=toNumber$6(t)||0,isObject$d(r)&&(u=!!r.leading,i=(d="maxWait"in r)?nativeMax$9(toNumber$6(r.maxWait)||0,t):i,h="trailing"in r?!!r.trailing:h),y.cancel=function(){void 0!==s&&clearTimeout(s),c=0,n=l=o=s=void 0},y.flush=function(){return void 0===s?a:m(now$4())},y}function isNil$2(e){return null==e}function isNotNull(e){return!isNil$2(e)}function stripEL(e){return e.type&&e||e.el||e}function toUpperCase(e){return"".concat(e).toLocaleUpperCase()}function isKey$4(e){return isNumber$4(e)||isString$2(e)&&e.length>0}const _ChineseFirstPY="YDYQSXMWZSSXJBYMGCCZQPSSQBYCDSCDQLDYLYBSSJGYZZJJFKCCLZDHWDWZJLJPFYYNWJJTMYHZWZHFLZPPQHGSCYYYNJQYXXGJHHSDSJNKKTMOMLCRXYPSNQSECCQZGGLLYJLMYZZSECYKYYHQWJSSGGYXYZYJWWKDJHYCHMYXJTLXJYQBYXZLDWRDJRWYSRLDZJPCBZJJBRCFTLECZSTZFXXZHTRQHYBDLYCZSSYMMRFMYQZPWWJJYFCRWFDFZQPYDDWYXKYJAWJFFXYPSFTZYHHYZYSWCJYXSCLCXXWZZXNBGNNXBXLZSZSBSGPYSYZDHMDZBQBZCWDZZYYTZHBTSYYBZGNTNXQYWQSKBPHHLXGYBFMJEBJHHGQTJCYSXSTKZHLYCKGLYSMZXYALMELDCCXGZYRJXSDLTYZCQKCNNJWHJTZZCQLJSTSTBNXBTYXCEQXGKWJYFLZQLYHYXSPSFXLMPBYSXXXYDJCZYLLLSJXFHJXPJBTFFYABYXBHZZBJYZLWLCZGGBTSSMDTJZXPTHYQTGLJSCQFZKJZJQNLZWLSLHDZBWJNCJZYZSQQYCQYRZCJJWYBRTWPYFTWEXCSKDZCTBZHYZZYYJXZCFFZZMJYXXSDZZOTTBZLQWFCKSZSXFYRLNYJMBDTHJXSQQCCSBXYYTSYFBXDZTGBCNSLCYZZPSAZYZZSCJCSHZQYDXLBPJLLMQXTYDZXSQJTZPXLCGLQTZWJBHCTSYJSFXYEJJTLBGXSXJMYJQQPFZASYJNTYDJXKJCDJSZCBARTDCLYJQMWNQNCLLLKBYBZZSYHQQLTWLCCXTXLLZNTYLNEWYZYXCZXXGRKRMTCNDNJTSYYSSDQDGHSDBJGHRWRQLYBGLXHLGTGXBQJDZPYJSJYJCTMRNYMGRZJCZGJMZMGXMPRYXKJNYMSGMZJYMKMFXMLDTGFBHCJHKYLPFMDXLQJJSMTQGZSJLQDLDGJYCALCMZCSDJLLNXDJFFFFJCZFMZFFPFKHKGDPSXKTACJDHHZDDCRRCFQYJKQCCWJDXHWJLYLLZGCFCQDSMLZPBJJPLSBCJGGDCKKDEZSQCCKJGCGKDJTJDLZYCXKLQSCGJCLTFPCQCZGWPJDQYZJJBYJHSJDZWGFSJGZKQCCZLLPSPKJGQJHZZLJPLGJGJJTHJJYJZCZMLZLYQBGJWMLJKXZDZNJQSYZMLJLLJKYWXMKJLHSKJGBMCLYYMKXJQLBMLLKMDXXKWYXYSLMLPSJQQJQXYXFJTJDXMXXLLCXQBSYJBGWYMBGGBCYXPJYGPEPFGDJGBHBNSQJYZJKJKHXQFGQZKFHYGKHDKLLSDJQXPQYKYBNQSXQNSZSWHBSXWHXWBZZXDMNSJBSBKBBZKLYLXGWXDRWYQZMYWSJQLCJXXJXKJEQXSCYETLZHLYYYSDZPAQYZCMTLSHTZCFYZYXYLJSDCJQAGYSLCQLYYYSHMRQQKLDXZSCSSSYDYCJYSFSJBFRSSZQSBXXPXJYSDRCKGJLGDKZJZBDKTCSYQPYHSTCLDJDHMXMCGXYZHJDDTMHLTXZXYLYMOHYJCLTYFBQQXPFBDFHHTKSQHZYYWCNXXCRWHOWGYJLEGWDQCWGFJYCSNTMYTOLBYGWQWESJPWNMLRYDZSZTXYQPZGCWXHNGPYXSHMYQJXZTDPPBFYHZHTJYFDZWKGKZBLDNTSXHQEEGZZYLZMMZYJZGXZXKHKSTXNXXWYLYAPSTHXDWHZYMPXAGKYDXBHNHXKDPJNMYHYLPMGOCSLNZHKXXLPZZLBMLSFBHHGYGYYGGBHSCYAQTYWLXTZQCEZYDQDQMMHTKLLSZHLSJZWFYHQSWSCWLQAZYNYTLSXTHAZNKZZSZZLAXXZWWCTGQQTDDYZTCCHYQZFLXPSLZYGPZSZNGLNDQTBDLXGTCTAJDKYWNSYZLJHHZZCWNYYZYWMHYCHHYXHJKZWSXHZYXLYSKQYSPSLYZWMYPPKBYGLKZHTYXAXQSYSHXASMCHKDSCRSWJPWXSGZJLWWSCHSJHSQNHCSEGNDAQTBAALZZMSSTDQJCJKTSCJAXPLGGXHHGXXZCXPDMMHLDGTYBYSJMXHMRCPXXJZCKZXSHMLQXXTTHXWZFKHCCZDYTCJYXQHLXDHYPJQXYLSYYDZOZJNYXQEZYSQYAYXWYPDGXDDXSPPYZNDLTWRHXYDXZZJHTCXMCZLHPYYYYMHZLLHNXMYLLLMDCPPXHMXDKYCYRDLTXJCHHZZXZLCCLYLNZSHZJZZLNNRLWHYQSNJHXYNTTTKYJPYCHHYEGKCTTWLGQRLGGTGTYGYHPYHYLQYQGCWYQKPYYYTTTTLHYHLLTYTTSPLKYZXGZWGPYDSSZZDQXSKCQNMJJZZBXYQMJRTFFBTKHZKBXLJJKDXJTLBWFZPPTKQTZTGPDGNTPJYFALQMKGXBDCLZFHZCLLLLADPMXDJHLCCLGYHDZFGYDDGCYYFGYDXKSSEBDHYKDKDKHNAXXYBPBYYHXZQGAFFQYJXDMLJCSQZLLPCHBSXGJYNDYBYQSPZWJLZKSDDTACTBXZDYZYPJZQSJNKKTKNJDJGYYPGTLFYQKASDNTCYHBLWDZHBBYDWJRYGKZYHEYYFJMSDTYFZJJHGCXPLXHLDWXXJKYTCYKSSSMTWCTTQZLPBSZDZWZXGZAGYKTYWXLHLSPBCLLOQMMZSSLCMBJCSZZKYDCZJGQQDSMCYTZQQLWZQZXSSFPTTFQMDDZDSHDTDWFHTDYZJYQJQKYPBDJYYXTLJHDRQXXXHAYDHRJLKLYTWHLLRLLRCXYLBWSRSZZSYMKZZHHKYHXKSMDSYDYCJPBZBSQLFCXXXNXKXWYWSDZYQOGGQMMYHCDZTTFJYYBGSTTTYBYKJDHKYXBELHTYPJQNFXFDYKZHQKZBYJTZBXHFDXKDASWTAWAJLDYJSFHBLDNNTNQJTJNCHXFJSRFWHZFMDRYJYJWZPDJKZYJYMPCYZNYNXFBYTFYFWYGDBNZZZDNYTXZEMMQBSQEHXFZMBMFLZZSRXYMJGSXWZJSPRYDJSJGXHJJGLJJYNZZJXHGXKYMLPYYYCXYTWQZSWHWLYRJLPXSLSXMFSWWKLCTNXNYNPSJSZHDZEPTXMYYWXYYSYWLXJQZQXZDCLEEELMCPJPCLWBXSQHFWWTFFJTNQJHJQDXHWLBYZNFJLALKYYJLDXHHYCSTYYWNRJYXYWTRMDRQHWQCMFJDYZMHMYYXJWMYZQZXTLMRSPWWCHAQBXYGZYPXYYRRCLMPYMGKSJSZYSRMYJSNXTPLNBAPPYPYLXYYZKYNLDZYJZCZNNLMZHHARQMPGWQTZMXXMLLHGDZXYHXKYXYCJMFFYYHJFSBSSQLXXNDYCANNMTCJCYPRRNYTYQNYYMBMSXNDLYLYSLJRLXYSXQMLLYZLZJJJKYZZCSFBZXXMSTBJGNXYZHLXNMCWSCYZYFZLXBRNNNYLBNRTGZQYSATSWRYHYJZMZDHZGZDWYBSSCSKXSYHYTXXGCQGXZZSHYXJSCRHMKKBXCZJYJYMKQHZJFNBHMQHYSNJNZYBKNQMCLGQHWLZNZSWXKHLJHYYBQLBFCDSXDLDSPFZPSKJYZWZXZDDXJSMMEGJSCSSMGCLXXKYYYLNYPWWWGYDKZJGGGZGGSYCKNJWNJPCXBJJTQTJWDSSPJXZXNZXUMELPXFSXTLLXCLJXJJLJZXCTPSWXLYDHLYQRWHSYCSQYYBYAYWJJJQFWQCQQCJQGXALDBZZYJGKGXPLTZYFXJLTPADKYQHPMATLCPDCKBMTXYBHKLENXDLEEGQDYMSAWHZMLJTWYGXLYQZLJEEYYBQQFFNLYXRDSCTGJGXYYNKLLYQKCCTLHJLQMKKZGCYYGLLLJDZGYDHZWXPYSJBZKDZGYZZHYWYFQYTYZSZYEZZLYMHJJHTSMQWYZLKYYWZCSRKQYTLTDXWCTYJKLWSQZWBDCQYNCJSRSZJLKCDCDTLZZZACQQZZDDXYPLXZBQJYLZLLLQDDZQJYJYJZYXNYYYNYJXKXDAZWYRDLJYYYRJLXLLDYXJCYWYWNQCCLDDNYYYNYCKCZHXXCCLGZQJGKWPPCQQJYSBZZXYJSQPXJPZBSBDSFNSFPZXHDWZTDWPPTFLZZBZDMYYPQJRSDZSQZSQXBDGCPZSWDWCSQZGMDHZXMWWFYBPDGPHTMJTHZSMMBGZMBZJCFZWFZBBZMQCFMBDMCJXLGPNJBBXGYHYYJGPTZGZMQBQTCGYXJXLWZKYDPDYMGCFTPFXYZTZXDZXTGKMTYBBCLBJASKYTSSQYYMSZXFJEWLXLLSZBQJJJAKLYLXLYCCTSXMCWFKKKBSXLLLLJYXTYLTJYYTDPJHNHNNKBYQNFQYYZBYYESSESSGDYHFHWTCJBSDZZTFDMXHCNJZYMQWSRYJDZJQPDQBBSTJGGFBKJBXTGQHNGWJXJGDLLTHZHHYYYYYYSXWTYYYCCBDBPYPZYCCZYJPZYWCBDLFWZCWJDXXHYHLHWZZXJTCZLCDPXUJCZZZLYXJJTXPHFXWPYWXZPTDZZBDZCYHJHMLXBQXSBYLRDTGJRRCTTTHYTCZWMXFYTWWZCWJWXJYWCSKYBZSCCTZQNHXNWXXKHKFHTSWOCCJYBCMPZZYKBNNZPBZHHZDLSYDDYTYFJPXYNGFXBYQXCBHXCPSXTYZDMKYSNXSXLHKMZXLYHDHKWHXXSSKQYHHCJYXGLHZXCSNHEKDTGZXQYPKDHEXTYKCNYMYYYPKQYYYKXZLTHJQTBYQHXBMYHSQCKWWYLLHCYYLNNEQXQWMCFBDCCMLJGGXDQKTLXKGNQCDGZJWYJJLYHHQTTTNWCHMXCXWHWSZJYDJCCDBQCDGDNYXZTHCQRXCBHZTQCBXWGQWYYBXHMBYMYQTYEXMQKYAQYRGYZSLFYKKQHYSSQYSHJGJCNXKZYCXSBXYXHYYLSTYCXQTHYSMGSCPMMGCCCCCMTZTASMGQZJHKLOSQYLSWTMXSYQKDZLJQQYPLSYCZTCQQPBBQJZCLPKHQZYYXXDTDDTSJCXFFLLCHQXMJLWCJCXTSPYCXNDTJSHJWXDQQJSKXYAMYLSJHMLALYKXCYYDMNMDQMXMCZNNCYBZKKYFLMCHCMLHXRCJJHSYLNMTJZGZGYWJXSRXCWJGJQHQZDQJDCJJZKJKGDZQGJJYJYLXZXXCDQHHHEYTMHLFSBDJSYYSHFYSTCZQLPBDRFRZTZYKYWHSZYQKWDQZRKMSYNBCRXQBJYFAZPZZEDZCJYWBCJWHYJBQSZYWRYSZPTDKZPFPBNZTKLQYHBBZPNPPTYZZYBQNYDCPJMMCYCQMCYFZZDCMNLFPBPLNGQJTBTTNJZPZBBZNJKLJQYLNBZQHKSJZNGGQSZZKYXSHPZSNBCGZKDDZQANZHJKDRTLZLSWJLJZLYWTJNDJZJHXYAYNCBGTZCSSQMNJPJYTYSWXZFKWJQTKHTZPLBHSNJZSYZBWZZZZLSYLSBJHDWWQPSLMMFBJDWAQYZTCJTBNNWZXQXCDSLQGDSDPDZHJTQQPSWLYYJZLGYXYZLCTCBJTKTYCZJTQKBSJLGMGZDMCSGPYNJZYQYYKNXRPWSZXMTNCSZZYXYBYHYZAXYWQCJTLLCKJJTJHGDXDXYQYZZBYWDLWQCGLZGJGQRQZCZSSBCRPCSKYDZNXJSQGXSSJMYDNSTZTPBDLTKZWXQWQTZEXNQCZGWEZKSSBYBRTSSSLCCGBPSZQSZLCCGLLLZXHZQTHCZMQGYZQZNMCOCSZJMMZSQPJYGQLJYJPPLDXRGZYXCCSXHSHGTZNLZWZKJCXTCFCJXLBMQBCZZWPQDNHXLJCTHYZLGYLNLSZZPCXDSCQQHJQKSXZPBAJYEMSMJTZDXLCJYRYYNWJBNGZZTMJXLTBSLYRZPYLSSCNXPHLLHYLLQQZQLXYMRSYCXZLMMCZLTZSDWTJJLLNZGGQXPFSKYGYGHBFZPDKMWGHCXMSGDXJMCJZDYCABXJDLNBCDQYGSKYDQTXDJJYXMSZQAZDZFSLQXYJSJZYLBTXXWXQQZBJZUFBBLYLWDSLJHXJYZJWTDJCZFQZQZZDZSXZZQLZCDZFJHYSPYMPQZMLPPLFFXJJNZZYLSJEYQZFPFZKSYWJJJHRDJZZXTXXGLGHYDXCSKYSWMMZCWYBAZBJKSHFHJCXMHFQHYXXYZFTSJYZFXYXPZLCHMZMBXHZZSXYFYMNCWDABAZLXKTCSHHXKXJJZJSTHYGXSXYYHHHJWXKZXSSBZZWHHHCWTZZZPJXSNXQQJGZYZYWLLCWXZFXXYXYHXMKYYSWSQMNLNAYCYSPMJKHWCQHYLAJJMZXHMMCNZHBHXCLXTJPLTXYJHDYYLTTXFSZHYXXSJBJYAYRSMXYPLCKDUYHLXRLNLLSTYZYYQYGYHHSCCSMZCTZQXKYQFPYYRPFFLKQUNTSZLLZMWWTCQQYZWTLLMLMPWMBZSSTZRBPDDTLQJJBXZCSRZQQYGWCSXFWZLXCCRSZDZMCYGGDZQSGTJSWLJMYMMZYHFBJDGYXCCPSHXNZCSBSJYJGJMPPWAFFYFNXHYZXZYLREMZGZCYZSSZDLLJCSQFNXZKPTXZGXJJGFMYYYSNBTYLBNLHPFZDCYFBMGQRRSSSZXYSGTZRNYDZZCDGPJAFJFZKNZBLCZSZPSGCYCJSZLMLRSZBZZLDLSLLYSXSQZQLYXZLSKKBRXBRBZCYCXZZZEEYFGKLZLYYHGZSGZLFJHGTGWKRAAJYZKZQTSSHJJXDCYZUYJLZYRZDQQHGJZXSSZBYKJPBFRTJXLLFQWJHYLQTYMBLPZDXTZYGBDHZZRBGXHWNJTJXLKSCFSMWLSDQYSJTXKZSCFWJLBXFTZLLJZLLQBLSQMQQCGCZFPBPHZCZJLPYYGGDTGWDCFCZQYYYQYSSCLXZSKLZZZGFFCQNWGLHQYZJJCZLQZZYJPJZZBPDCCMHJGXDQDGDLZQMFGPSYTSDYFWWDJZJYSXYYCZCYHZWPBYKXRYLYBHKJKSFXTZJMMCKHLLTNYYMSYXYZPYJQYCSYCWMTJJKQYRHLLQXPSGTLYYCLJSCPXJYZFNMLRGJJTYZBXYZMSJYJHHFZQMSYXRSZCWTLRTQZSSTKXGQKGSPTGCZNJSJCQCXHMXGGZTQYDJKZDLBZSXJLHYQGGGTHQSZPYHJHHGYYGKGGCWJZZYLCZLXQSFTGZSLLLMLJSKCTBLLZZSZMMNYTPZSXQHJCJYQXYZXZQZCPSHKZZYSXCDFGMWQRLLQXRFZTLYSTCTMJCXJJXHJNXTNRZTZFQYHQGLLGCXSZSJDJLJCYDSJTLNYXHSZXCGJZYQPYLFHDJSBPCCZHJJJQZJQDYBSSLLCMYTTMQTBHJQNNYGKYRQYQMZGCJKPDCGMYZHQLLSLLCLMHOLZGDYYFZSLJCQZLYLZQJESHNYLLJXGJXLYSYYYXNBZLJSSZCQQCJYLLZLTJYLLZLLBNYLGQCHXYYXOXCXQKYJXXXYKLXSXXYQXCYKQXQCSGYXXYQXYGYTQOHXHXPYXXXULCYEYCHZZCBWQBBWJQZSCSZSSLZYLKDESJZWMYMCYTSDSXXSCJPQQSQYLYYZYCMDJDZYWCBTJSYDJKCYDDJLBDJJSODZYSYXQQYXDHHGQQYQHDYXWGMMMAJDYBBBPPBCMUUPLJZSMTXERXJMHQNUTPJDCBSSMSSSTKJTSSMMTRCPLZSZMLQDSDMJMQPNQDXCFYNBFSDQXYXHYAYKQYDDLQYYYSSZBYDSLNTFQTZQPZMCHDHCZCWFDXTMYQSPHQYYXSRGJCWTJTZZQMGWJJTJHTQJBBHWZPXXHYQFXXQYWYYHYSCDYDHHQMNMTMWCPBSZPPZZGLMZFOLLCFWHMMSJZTTDHZZYFFYTZZGZYSKYJXQYJZQBHMBZZLYGHGFMSHPZFZSNCLPBQSNJXZSLXXFPMTYJYGBXLLDLXPZJYZJYHHZCYWHJYLSJEXFSZZYWXKZJLUYDTMLYMQJPWXYHXSKTQJEZRPXXZHHMHWQPWQLYJJQJJZSZCPHJLCHHNXJLQWZJHBMZYXBDHHYPZLHLHLGFWLCHYYTLHJXCJMSCPXSTKPNHQXSRTYXXTESYJCTLSSLSTDLLLWWYHDHRJZSFGXTSYCZYNYHTDHWJSLHTZDQDJZXXQHGYLTZPHCSQFCLNJTCLZPFSTPDYNYLGMJLLYCQHYSSHCHYLHQYQTMZYPBYWRFQYKQSYSLZDQJMPXYYSSRHZJNYWTQDFZBWWTWWRXCWHGYHXMKMYYYQMSMZHNGCEPMLQQMTCWCTMMPXJPJJHFXYYZSXZHTYBMSTSYJTTQQQYYLHYNPYQZLCYZHZWSMYLKFJXLWGXYPJYTYSYXYMZCKTTWLKSMZSYLMPWLZWXWQZSSAQSYXYRHSSNTSRAPXCPWCMGDXHXZDZYFJHGZTTSBJHGYZSZYSMYCLLLXBTYXHBBZJKSSDMALXHYCFYGMQYPJYCQXJLLLJGSLZGQLYCJCCZOTYXMTMTTLLWTGPXYMZMKLPSZZZXHKQYSXCTYJZYHXSHYXZKXLZWPSQPYHJWPJPWXQQYLXSDHMRSLZZYZWTTCYXYSZZSHBSCCSTPLWSSCJCHNLCGCHSSPHYLHFHHXJSXYLLNYLSZDHZXYLSXLWZYKCLDYAXZCMDDYSPJTQJZLNWQPSSSWCTSTSZLBLNXSMNYYMJQBQHRZWTYYDCHQLXKPZWBGQYBKFCMZWPZLLYYLSZYDWHXPSBCMLJBSCGBHXLQHYRLJXYSWXWXZSLDFHLSLYNJLZYFLYJYCDRJLFSYZFSLLCQYQFGJYHYXZLYLMSTDJCYHBZLLNWLXXYGYYHSMGDHXXHHLZZJZXCZZZCYQZFNGWPYLCPKPYYPMCLQKDGXZGGWQBDXZZKZFBXXLZXJTPJPTTBYTSZZDWSLCHZHSLTYXHQLHYXXXYYZYSWTXZKHLXZXZPYHGCHKCFSYHUTJRLXFJXPTZTWHPLYXFCRHXSHXKYXXYHZQDXQWULHYHMJTBFLKHTXCWHJFWJCFPQRYQXCYYYQYGRPYWSGSUNGWCHKZDXYFLXXHJJBYZWTSXXNCYJJYMSWZJQRMHXZWFQSYLZJZGBHYNSLBGTTCSYBYXXWXYHXYYXNSQYXMQYWRGYQLXBBZLJSYLPSYTJZYHYZAWLRORJMKSCZJXXXYXCHDYXRYXXJDTSQFXLYLTSFFYXLMTYJMJUYYYXLTZCSXQZQHZXLYYXZHDNBRXXXJCTYHLBRLMBRLLAXKYLLLJLYXXLYCRYLCJTGJCMTLZLLCYZZPZPCYAWHJJFYBDYYZSMPCKZDQYQPBPCJPDCYZMDPBCYYDYCNNPLMTMLRMFMMGWYZBSJGYGSMZQQQZTXMKQWGXLLPJGZBQCDJJJFPKJKCXBLJMSWMDTQJXLDLPPBXCWRCQFBFQJCZAHZGMYKPHYYHZYKNDKZMBPJYXPXYHLFPNYYGXJDBKXNXHJMZJXSTRSTLDXSKZYSYBZXJLXYSLBZYSLHXJPFXPQNBYLLJQKYGZMCYZZYMCCSLCLHZFWFWYXZMWSXTYNXJHPYYMCYSPMHYSMYDYSHQYZCHMJJMZCAAGCFJBBHPLYZYLXXSDJGXDHKXXTXXNBHRMLYJSLTXMRHNLXQJXYZLLYSWQGDLBJHDCGJYQYCMHWFMJYBMBYJYJWYMDPWHXQLDYGPDFXXBCGJSPCKRSSYZJMSLBZZJFLJJJLGXZGYXYXLSZQYXBEXYXHGCXBPLDYHWETTWWCJMBTXCHXYQXLLXFLYXLLJLSSFWDPZSMYJCLMWYTCZPCHQEKCQBWLCQYDPLQPPQZQFJQDJHYMMCXTXDRMJWRHXCJZYLQXDYYNHYYHRSLSRSYWWZJYMTLTLLGTQCJZYABTCKZCJYCCQLJZQXALMZYHYWLWDXZXQDLLQSHGPJFJLJHJABCQZDJGTKHSSTCYJLPSWZLXZXRWGLDLZRLZXTGSLLLLZLYXXWGDZYGBDPHZPBRLWSXQBPFDWOFMWHLYPCBJCCLDMBZPBZZLCYQXLDOMZBLZWPDWYYGDSTTHCSQSCCRSSSYSLFYBFNTYJSZDFNDPDHDZZMBBLSLCMYFFGTJJQWFTMTPJWFNLBZCMMJTGBDZLQLPYFHYYMJYLSDCHDZJWJCCTLJCLDTLJJCPDDSQDSSZYBNDBJLGGJZXSXNLYCYBJXQYCBYLZCFZPPGKCXZDZFZTJJFJSJXZBNZYJQTTYJYHTYCZHYMDJXTTMPXSPLZCDWSLSHXYPZGTFMLCJTYCBPMGDKWYCYZCDSZZYHFLYCTYGWHKJYYLSJCXGYWJCBLLCSNDDBTZBSCLYZCZZSSQDLLMQYYHFSLQLLXFTYHABXGWNYWYYPLLSDLDLLBJCYXJZMLHLJDXYYQYTDLLLBUGBFDFBBQJZZMDPJHGCLGMJJPGAEHHBWCQXAXHHHZCHXYPHJAXHLPHJPGPZJQCQZGJJZZUZDMQYYBZZPHYHYBWHAZYJHYKFGDPFQSDLZMLJXKXGALXZDAGLMDGXMWZQYXXDXXPFDMMSSYMPFMDMMKXKSYZYSHDZKXSYSMMZZZMSYDNZZCZXFPLSTMZDNMXCKJMZTYYMZMZZMSXHHDCZJEMXXKLJSTLWLSQLYJZLLZJSSDPPMHNLZJCZYHMXXHGZCJMDHXTKGRMXFWMCGMWKDTKSXQMMMFZZYDKMSCLCMPCGMHSPXQPZDSSLCXKYXTWLWJYAHZJGZQMCSNXYYMMPMLKJXMHLMLQMXCTKZMJQYSZJSYSZHSYJZJCDAJZYBSDQJZGWZQQXFKDMSDJLFWEHKZQKJPEYPZYSZCDWYJFFMZZYLTTDZZEFMZLBNPPLPLPEPSZALLTYLKCKQZKGENQLWAGYXYDPXLHSXQQWQCQXQCLHYXXMLYCCWLYMQYSKGCHLCJNSZKPYZKCQZQLJPDMDZHLASXLBYDWQLWDNBQCRYDDZTJYBKBWSZDXDTNPJDTCTQDFXQQMGNXECLTTBKPWSLCTYQLPWYZZKLPYGZCQQPLLKCCYLPQMZCZQCLJSLQZDJXLDDHPZQDLJJXZQDXYZQKZLJCYQDYJPPYPQYKJYRMPCBYMCXKLLZLLFQPYLLLMBSGLCYSSLRSYSQTMXYXZQZFDZUYSYZTFFMZZSMZQHZSSCCMLYXWTPZGXZJGZGSJSGKDDHTQGGZLLBJDZLCBCHYXYZHZFYWXYZYMSDBZZYJGTSMTFXQYXQSTDGSLNXDLRYZZLRYYLXQHTXSRTZNGZXBNQQZFMYKMZJBZYMKBPNLYZPBLMCNQYZZZSJZHJCTZKHYZZJRDYZHNPXGLFZTLKGJTCTSSYLLGZRZBBQZZKLPKLCZYSSUYXBJFPNJZZXCDWXZYJXZZDJJKGGRSRJKMSMZJLSJYWQSKYHQJSXPJZZZLSNSHRNYPZTWCHKLPSRZLZXYJQXQKYSJYCZTLQZYBBYBWZPQDWWYZCYTJCJXCKCWDKKZXSGKDZXWWYYJQYYTCYTDLLXWKCZKKLCCLZCQQDZLQLCSFQCHQHSFSMQZZLNBJJZBSJHTSZDYSJQJPDLZCDCWJKJZZLPYCGMZWDJJBSJQZSYZYHHXJPBJYDSSXDZNCGLQMBTSFSBPDZDLZNFGFJGFSMPXJQLMBLGQCYYXBQKDJJQYRFKZTJDHCZKLBSDZCFJTPLLJGXHYXZCSSZZXSTJYGKGCKGYOQXJPLZPBPGTGYJZGHZQZZLBJLSQFZGKQQJZGYCZBZQTLDXRJXBSXXPZXHYZYCLWDXJJHXMFDZPFZHQHQMQGKSLYHTYCGFRZGNQXCLPDLBZCSCZQLLJBLHBZCYPZZPPDYMZZSGYHCKCPZJGSLJLNSCDSLDLXBMSTLDDFJMKDJDHZLZXLSZQPQPGJLLYBDSZGQLBZLSLKYYHZTTNTJYQTZZPSZQZTLLJTYYLLQLLQYZQLBDZLSLYYZYMDFSZSNHLXZNCZQZPBWSKRFBSYZMTHBLGJPMCZZLSTLXSHTCSYZLZBLFEQHLXFLCJLYLJQCBZLZJHHSSTBRMHXZHJZCLXFNBGXGTQJCZTMSFZKJMSSNXLJKBHSJXNTNLZDNTLMSJXGZJYJCZXYJYJWRWWQNZTNFJSZPZSHZJFYRDJSFSZJZBJFZQZZHZLXFYSBZQLZSGYFTZDCSZXZJBQMSZKJRHYJZCKMJKHCHGTXKXQGLXPXFXTRTYLXJXHDTSJXHJZJXZWZLCQSBTXWXGXTXXHXFTSDKFJHZYJFJXRZSDLLLTQSQQZQWZXSYQTWGWBZCGZLLYZBCLMQQTZHZXZXLJFRMYZFLXYSQXXJKXRMQDZDMMYYBSQBHGZMWFWXGMXLZPYYTGZYCCDXYZXYWGSYJYZNBHPZJSQSYXSXRTFYZGRHZTXSZZTHCBFCLSYXZLZQMZLMPLMXZJXSFLBYZMYQHXJSXRXSQZZZSSLYFRCZJRCRXHHZXQYDYHXSJJHZCXZBTYNSYSXJBQLPXZQPYMLXZKYXLXCJLCYSXXZZLXDLLLJJYHZXGYJWKJRWYHCPSGNRZLFZWFZZNSXGXFLZSXZZZBFCSYJDBRJKRDHHGXJLJJTGXJXXSTJTJXLYXQFCSGSWMSBCTLQZZWLZZKXJMLTMJYHSDDBXGZHDLBMYJFRZFSGCLYJBPMLYSMSXLSZJQQHJZFXGFQFQBPXZGYYQXGZTCQWYLTLGWSGWHRLFSFGZJMGMGBGTJFSYZZGZYZAFLSSPMLPFLCWBJZCLJJMZLPJJLYMQDMYYYFBGYGYZMLYZDXQYXRQQQHSYYYQXYLJTYXFSFSLLGNQCYHYCWFHCCCFXPYLYPLLZYXXXXXKQHHXSHJZCFZSCZJXCPZWHHHHHAPYLQALPQAFYHXDYLUKMZQGGGDDESRNNZLTZGCHYPPYSQJJHCLLJTOLNJPZLJLHYMHEYDYDSQYCDDHGZUNDZCLZYZLLZNTNYZGSLHSLPJJBDGWXPCDUTJCKLKCLWKLLCASSTKZZDNQNTTLYYZSSYSSZZRYLJQKCQDHHCRXRZYDGRGCWCGZQFFFPPJFZYNAKRGYWYQPQXXFKJTSZZXSWZDDFBBXTBGTZKZNPZZPZXZPJSZBMQHKCYXYLDKLJNYPKYGHGDZJXXEAHPNZKZTZCMXCXMMJXNKSZQNMNLWBWWXJKYHCPSTMCSQTZJYXTPCTPDTNNPGLLLZSJLSPBLPLQHDTNJNLYYRSZFFJFQWDPHZDWMRZCCLODAXNSSNYZRESTYJWJYJDBCFXNMWTTBYLWSTSZGYBLJPXGLBOCLHPCBJLTMXZLJYLZXCLTPNCLCKXTPZJSWCYXSFYSZDKNTLBYJCYJLLSTGQCBXRYZXBXKLYLHZLQZLNZCXWJZLJZJNCJHXMNZZGJZZXTZJXYCYYCXXJYYXJJXSSSJSTSSTTPPGQTCSXWZDCSYFPTFBFHFBBLZJCLZZDBXGCXLQPXKFZFLSYLTUWBMQJHSZBMDDBCYSCCLDXYCDDQLYJJWMQLLCSGLJJSYFPYYCCYLTJANTJJPWYCMMGQYYSXDXQMZHSZXPFTWWZQSWQRFKJLZJQQYFBRXJHHFWJJZYQAZMYFRHCYYBYQWLPEXCCZSTYRLTTDMQLYKMBBGMYYJPRKZNPBSXYXBHYZDJDNGHPMFSGMWFZMFQMMBCMZZCJJLCNUXYQLMLRYGQZCYXZLWJGCJCGGMCJNFYZZJHYCPRRCMTZQZXHFQGTJXCCJEAQCRJYHPLQLSZDJRBCQHQDYRHYLYXJSYMHZYDWLDFRYHBPYDTSSCNWBXGLPZMLZZTQSSCPJMXXYCSJYTYCGHYCJWYRXXLFEMWJNMKLLSWTXHYYYNCMMCWJDQDJZGLLJWJRKHPZGGFLCCSCZMCBLTBHBQJXQDSPDJZZGHGLFQYWBZYZJLTSTDHQHCTCBCHFLQMPWDSHYYTQWCNZZJTLBYMBPDYYYXSQKXWYYFLXXNCWCXYPMAELYKKJMZZZBRXYYQJFLJPFHHHYTZZXSGQQMHSPGDZQWBWPJHZJDYSCQWZKTXXSQLZYYMYSDZGRXCKKUJLWPYSYSCSYZLRMLQSYLJXBCXTLWDQZPCYCYKPPPNSXFYZJJRCEMHSZMSXLXGLRWGCSTLRSXBZGBZGZTCPLUJLSLYLYMTXMTZPALZXPXJTJWTCYYZLBLXBZLQMYLXPGHDSLSSDMXMBDZZSXWHAMLCZCPJMCNHJYSNSYGCHSKQMZZQDLLKABLWJXSFMOCDXJRRLYQZKJMYBYQLYHETFJZFRFKSRYXFJTWDSXXSYSQJYSLYXWJHSNLXYYXHBHAWHHJZXWMYLJCSSLKYDZTXBZSYFDXGXZJKHSXXYBSSXDPYNZWRPTQZCZENYGCXQFJYKJBZMLJCMQQXUOXSLYXXLYLLJDZBTYMHPFSTTQQWLHOKYBLZZALZXQLHZWRRQHLSTMYPYXJJXMQSJFNBXYXYJXXYQYLTHYLQYFMLKLJTMLLHSZWKZHLJMLHLJKLJSTLQXYLMBHHLNLZXQJHXCFXXLHYHJJGBYZZKBXSCQDJQDSUJZYYHZHHMGSXCSYMXFEBCQWWRBPYYJQTYZCYQYQQZYHMWFFHGZFRJFCDPXNTQYZPDYKHJLFRZXPPXZDBBGZQSTLGDGYLCQMLCHHMFYWLZYXKJLYPQHSYWMQQGQZMLZJNSQXJQSYJYCBEHSXFSZPXZWFLLBCYYJDYTDTHWZSFJMQQYJLMQXXLLDTTKHHYBFPWTYYSQQWNQWLGWDEBZWCMYGCULKJXTMXMYJSXHYBRWFYMWFRXYQMXYSZTZZTFYKMLDHQDXWYYNLCRYJBLPSXCXYWLSPRRJWXHQYPHTYDNXHHMMYWYTZCSQMTSSCCDALWZTCPQPYJLLQZYJSWXMZZMMYLMXCLMXCZMXMZSQTZPPQQBLPGXQZHFLJJHYTJSRXWZXSCCDLXTYJDCQJXSLQYCLZXLZZXMXQRJMHRHZJBHMFLJLMLCLQNLDXZLLLPYPSYJYSXCQQDCMQJZZXHNPNXZMEKMXHYKYQLXSXTXJYYHWDCWDZHQYYBGYBCYSCFGPSJNZDYZZJZXRZRQJJYMCANYRJTLDPPYZBSTJKXXZYPFDWFGZZRPYMTNGXZQBYXNBUFNQKRJQZMJEGRZGYCLKXZDSKKNSXKCLJSPJYYZLQQJYBZSSQLLLKJXTBKTYLCCDDBLSPPFYLGYDTZJYQGGKQTTFZXBDKTYYHYBBFYTYYBCLPDYTGDHRYRNJSPTCSNYJQHKLLLZSLYDXXWBCJQSPXBPJZJCJDZFFXXBRMLAZHCSNDLBJDSZBLPRZTSWSBXBCLLXXLZDJZSJPYLYXXYFTFFFBHJJXGBYXJPMMMPSSJZJMTLYZJXSWXTYLEDQPJMYGQZJGDJLQJWJQLLSJGJGYGMSCLJJXDTYGJQJQJCJZCJGDZZSXQGSJGGCXHQXSNQLZZBXHSGZXCXYLJXYXYYDFQQJHJFXDHCTXJYRXYSQTJXYEFYYSSYYJXNCYZXFXMSYSZXYYSCHSHXZZZGZZZGFJDLTYLNPZGYJYZYYQZPBXQBDZTZCZYXXYHHSQXSHDHGQHJHGYWSZTMZMLHYXGEBTYLZKQWYTJZRCLEKYSTDBCYKQQSAYXCJXWWGSBHJYZYDHCSJKQCXSWXFLTYNYZPZCCZJQTZWJQDZZZQZLJJXLSBHPYXXPSXSHHEZTXFPTLQYZZXHYTXNCFZYYHXGNXMYWXTZSJPTHHGYMXMXQZXTSBCZYJYXXTYYZYPCQLMMSZMJZZLLZXGXZAAJZYXJMZXWDXZSXZDZXLEYJJZQBHZWZZZQTZPSXZTDSXJJJZNYAZPHXYYSRNQDTHZHYYKYJHDZXZLSWCLYBZYECWCYCRYLCXNHZYDZYDYJDFRJJHTRSQTXYXJRJHOJYNXELXSFSFJZGHPZSXZSZDZCQZBYYKLSGSJHCZSHDGQGXYZGXCHXZJWYQWGYHKSSEQZZNDZFKWYSSTCLZSTSYMCDHJXXYWEYXCZAYDMPXMDSXYBSQMJMZJMTZQLPJYQZCGQHXJHHLXXHLHDLDJQCLDWBSXFZZYYSCHTYTYYBHECXHYKGJPXHHYZJFXHWHBDZFYZBCAPNPGNYDMSXHMMMMAMYNBYJTMPXYYMCTHJBZYFCGTYHWPHFTWZZEZSBZEGPFMTSKFTYCMHFLLHGPZJXZJGZJYXZSBBQSCZZLZCCSTPGXMJSFTCCZJZDJXCYBZLFCJSYZFGSZLYBCWZZBYZDZYPSWYJZXZBDSYUXLZZBZFYGCZXBZHZFTPBGZGEJBSTGKDMFHYZZJHZLLZZGJQZLSFDJSSCBZGPDLFZFZSZYZYZSYGCXSNXXCHCZXTZZLJFZGQSQYXZJQDCCZTQCDXZJYQJQCHXZTDLGSCXZSYQJQTZWLQDQZTQCHQQJZYEZZZPBWKDJFCJPZTYPQYQTTYNLMBDKTJZPQZQZZFPZSBNJLGYJDXJDZZKZGQKXDLPZJTCJDQBXDJQJSTCKNXBXZMSLYJCQMTJQWWCJQNJNLLLHJCWQTBZQYDZCZPZZDZYDDCYZZZCCJTTJFZDPRRTZTJDCQTQZDTJNPLZBCLLCTZSXKJZQZPZLBZRBTJDCXFCZDBCCJJLTQQPLDCGZDBBZJCQDCJWYNLLZYZCCDWLLXWZLXRXNTQQCZXKQLSGDFQTDDGLRLAJJTKUYMKQLLTZYTDYYCZGJWYXDXFRSKSTQTENQMRKQZHHQKDLDAZFKYPBGGPZREBZZYKZZSPEGJXGYKQZZZSLYSYYYZWFQZYLZZLZHWCHKYPQGNPGBLPLRRJYXCCSYYHSFZFYBZYYTGZXYLXCZWXXZJZBLFFLGSKHYJZEYJHLPLLLLCZGXDRZELRHGKLZZYHZLYQSZZJZQLJZFLNBHGWLCZCFJYSPYXZLZLXGCCPZBLLCYBBBBUBBCBPCRNNZCZYRBFSRLDCGQYYQXYGMQZWTZYTYJXYFWTEHZZJYWLCCNTZYJJZDEDPZDZTSYQJHDYMBJNYJZLXTSSTPHNDJXXBYXQTZQDDTJTDYYTGWSCSZQFLSHLGLBCZPHDLYZJYCKWTYTYLBNYTSDSYCCTYSZYYEBHEXHQDTWNYGYCLXTSZYSTQMYGZAZCCSZZDSLZCLZRQXYYELJSBYMXSXZTEMBBLLYYLLYTDQYSHYMRQWKFKBFXNXSBYCHXBWJYHTQBPBSBWDZYLKGZSKYHXQZJXHXJXGNLJKZLYYCDXLFYFGHLJGJYBXQLYBXQPQGZTZPLNCYPXDJYQYDYMRBESJYYHKXXSTMXRCZZYWXYQYBMCLLYZHQYZWQXDBXBZWZMSLPDMYSKFMZKLZCYQYCZLQXFZZYDQZPZYGYJYZMZXDZFYFYTTQTZHGSPCZMLCCYTZXJCYTJMKSLPZHYSNZLLYTPZCTZZCKTXDHXXTQCYFKSMQCCYYAZHTJPCYLZLYJBJXTPNYLJYYNRXSYLMMNXJSMYBCSYSYLZYLXJJQYLDZLPQBFZZBLFNDXQKCZFYWHGQMRDSXYCYTXNQQJZYYPFZXDYZFPRXEJDGYQBXRCNFYYQPGHYJDYZXGRHTKYLNWDZNTSMPKLBTHBPYSZBZTJZSZZJTYYXZPHSSZZBZCZPTQFZMYFLYPYBBJQXZMXXDJMTSYSKKBJZXHJCKLPSMKYJZCXTMLJYXRZZQSLXXQPYZXMKYXXXJCLJPRMYYGADYSKQLSNDHYZKQXZYZTCGHZTLMLWZYBWSYCTBHJHJFCWZTXWYTKZLXQSHLYJZJXTMPLPYCGLTBZZTLZJCYJGDTCLKLPLLQPJMZPAPXYZLKKTKDZCZZBNZDYDYQZJYJGMCTXLTGXSZLMLHBGLKFWNWZHDXUHLFMKYSLGXDTWWFRJEJZTZHYDXYKSHWFZCQSHKTMQQHTZHYMJDJSKHXZJZBZZXYMPAGQMSTPXLSKLZYNWRTSQLSZBPSPSGZWYHTLKSSSWHZZLYYTNXJGMJSZSUFWNLSOZTXGXLSAMMLBWLDSZYLAKQCQCTMYCFJBSLXCLZZCLXXKSBZQCLHJPSQPLSXXCKSLNHPSFQQYTXYJZLQLDXZQJZDYYDJNZPTUZDSKJFSLJHYLZSQZLBTXYDGTQFDBYAZXDZHZJNHHQBYKNXJJQCZMLLJZKSPLDYCLBBLXKLELXJLBQYCXJXGCNLCQPLZLZYJTZLJGYZDZPLTQCSXFDMNYCXGBTJDCZNBGBQYQJWGKFHTNPYQZQGBKPBBYZMTJDYTBLSQMPSXTBNPDXKLEMYYCJYNZCTLDYKZZXDDXHQSHDGMZSJYCCTAYRZLPYLTLKXSLZCGGEXCLFXLKJRTLQJAQZNCMBYDKKCXGLCZJZXJHPTDJJMZQYKQSECQZDSHHADMLZFMMZBGNTJNNLGBYJBRBTMLBYJDZXLCJLPLDLPCQDHLXZLYCBLCXZZJADJLNZMMSSSMYBHBSQKBHRSXXJMXSDZNZPXLGBRHWGGFCXGMSKLLTSJYYCQLTSKYWYYHYWXBXQYWPYWYKQLSQPTNTKHQCWDQKTWPXXHCPTHTWUMSSYHBWCRWXHJMKMZNGWTMLKFGHKJYLSYYCXWHYECLQHKQHTTQKHFZLDXQWYZYYDESBPKYRZPJFYYZJCEQDZZDLATZBBFJLLCXDLMJSSXEGYGSJQXCWBXSSZPDYZCXDNYXPPZYDLYJCZPLTXLSXYZYRXCYYYDYLWWNZSAHJSYQYHGYWWAXTJZDAXYSRLTDPSSYYFNEJDXYZHLXLLLZQZSJNYQYQQXYJGHZGZCYJCHZLYCDSHWSHJZYJXCLLNXZJJYYXNFXMWFPYLCYLLABWDDHWDXJMCXZTZPMLQZHSFHZYNZTLLDYWLSLXHYMMYLMBWWKYXYADTXYLLDJPYBPWUXJMWMLLSAFDLLYFLBHHHBQQLTZJCQJLDJTFFKMMMBYTHYGDCQRDDWRQJXNBYSNWZDBYYTBJHPYBYTTJXAAHGQDQTMYSTQXKBTZPKJLZRBEQQSSMJJBDJOTGTBXPGBKTLHQXJJJCTHXQDWJLWRFWQGWSHCKRYSWGFTGYGBXSDWDWRFHWYTJJXXXJYZYSLPYYYPAYXHYDQKXSHXYXGSKQHYWFDDDPPLCJLQQEEWXKSYYKDYPLTJTHKJLTCYYHHJTTPLTZZCDLTHQKZXQYSTEEYWYYZYXXYYSTTJKLLPZMCYHQGXYHSRMBXPLLNQYDQHXSXXWGDQBSHYLLPJJJTHYJKYPPTHYYKTYEZYENMDSHLCRPQFDGFXZPSFTLJXXJBSWYYSKSFLXLPPLBBBLBSFXFYZBSJSSYLPBBFFFFSSCJDSTZSXZRYYSYFFSYZYZBJTBCTSBSDHRTJJBYTCXYJEYLXCBNEBJDSYXYKGSJZBXBYTFZWGENYHHTHZHHXFWGCSTBGXKLSXYWMTMBYXJSTZSCDYQRCYTWXZFHMYMCXLZNSDJTTTXRYCFYJSBSDYERXJLJXBBDEYNJGHXGCKGSCYMBLXJMSZNSKGXFBNBPTHFJAAFXYXFPXMYPQDTZCXZZPXRSYWZDLYBBKTYQPQJPZYPZJZNJPZJLZZFYSBTTSLMPTZRTDXQSJEHBZYLZDHLJSQMLHTXTJECXSLZZSPKTLZKQQYFSYGYWPCPQFHQHYTQXZKRSGTTSQCZLPTXCDYYZXSQZSLXLZMYCPCQBZYXHBSXLZDLTCDXTYLZJYYZPZYZLTXJSJXHLPMYTXCQRBLZSSFJZZTNJYTXMYJHLHPPLCYXQJQQKZZSCPZKSWALQSBLCCZJSXGWWWYGYKTJBBZTDKHXHKGTGPBKQYSLPXPJCKBMLLXDZSTBKLGGQKQLSBKKTFXRMDKBFTPZFRTBBRFERQGXYJPZSSTLBZTPSZQZSJDHLJQLZBPMSMMSXLQQNHKNBLRDDNXXDHDDJCYYGYLXGZLXSYGMQQGKHBPMXYXLYTQWLWGCPBMQXCYZYDRJBHTDJYHQSHTMJSBYPLWHLZFFNYPMHXXHPLTBQPFBJWQDBYGPNZTPFZJGSDDTQSHZEAWZZYLLTYYBWJKXXGHLFKXDJTMSZSQYNZGGSWQSPHTLSSKMCLZXYSZQZXNCJDQGZDLFNYKLJCJLLZLMZZNHYDSSHTHZZLZZBBHQZWWYCRZHLYQQJBEYFXXXWHSRXWQHWPSLMSSKZTTYGYQQWRSLALHMJTQJSMXQBJJZJXZYZKXBYQXBJXSHZTSFJLXMXZXFGHKZSZGGYLCLSARJYHSLLLMZXELGLXYDJYTLFBHBPNLYZFBBHPTGJKWETZHKJJXZXXGLLJLSTGSHJJYQLQZFKCGNNDJSSZFDBCTWWSEQFHQJBSAQTGYPQLBXBMMYWXGSLZHGLZGQYFLZBYFZJFRYSFMBYZHQGFWZSYFYJJPHZBYYZFFWODGRLMFTWLBZGYCQXCDJYGZYYYYTYTYDWEGAZYHXJLZYYHLRMGRXXZCLHNELJJTJTPWJYBJJBXJJTJTEEKHWSLJPLPSFYZPQQBDLQJJTYYQLYZKDKSQJYYQZLDQTGJQYZJSUCMRYQTHTEJMFCTYHYPKMHYZWJDQFHYYXWSHCTXRLJHQXHCCYYYJLTKTTYTMXGTCJTZAYYOCZLYLBSZYWJYTSJYHBYSHFJLYGJXXTMZYYLTXXYPZLXYJZYZYYPNHMYMDYYLBLHLSYYQQLLNJJYMSOYQBZGDLYXYLCQYXTSZEGXHZGLHWBLJHEYXTWQMAKBPQCGYSHHEGQCMWYYWLJYJHYYZLLJJYLHZYHMGSLJLJXCJJYCLYCJPCPZJZJMMYLCQLNQLJQJSXYJMLSZLJQLYCMMHCFMMFPQQMFYLQMCFFQMMMMHMZNFHHJGTTHHKHSLNCHHYQDXTMMQDCYZYXYQMYQYLTDCYYYZAZZCYMZYDLZFFFMMYCQZWZZMABTBYZTDMNZZGGDFTYPCGQYTTSSFFWFDTZQSSYSTWXJHXYTSXXYLBYQHWWKXHZXWZNNZZJZJJQJCCCHYYXBZXZCYZTLLCQXYNJYCYYCYNZZQYYYEWYCZDCJYCCHYJLBTZYYCQWMPWPYMLGKDLDLGKQQBGYCHJXY",oMultiDiff={19969:"DZ",19975:"WM",19988:"QJ",20048:"YL",20056:"SC",20060:"NM",20094:"QG",20127:"QJ",20167:"QC",20193:"YG",20250:"KH",20256:"ZC",20282:"SC",20285:"QJG",20291:"TD",20314:"YD",20315:"BF",20340:"NE",20375:"TD",20389:"YJ",20391:"CZ",20415:"PB",20446:"YS",20447:"SQ",20504:"TC",20608:"KG",20854:"QJ",20857:"ZC",20911:"PF",20985:"AW",21032:"PB",21048:"XQ",21049:"SC",21089:"YS",21119:"JC",21242:"SB",21273:"SC",21305:"YP",21306:"QO",21330:"ZC",21333:"SDC",21345:"QK",21378:"CA",21397:"SC",21414:"XS",21442:"SC",21477:"JG",21480:"TD",21484:"ZS",21494:"YX",21505:"YX",21512:"HG",21523:"XH",21537:"PB",21542:"PF",21549:"KH",21571:"E",21574:"DA",21588:"TD",21589:"O",21618:"ZC",21621:"KHA",21632:"ZJ",21654:"KG",21679:"LKG",21683:"KH",21710:"A",21719:"YH",21734:"WOE",21769:"A",21780:"WN",21804:"XH",21834:"A",21899:"ZD",21903:"RN",21908:"WO",21939:"ZC",21956:"SA",21964:"YA",21970:"TD",22003:"A",22031:"JG",22040:"XS",22060:"ZC",22066:"ZC",22079:"MH",22129:"XJ",22179:"XA",22237:"NJ",22244:"TD",22280:"JQ",22300:"YH",22313:"XW",22331:"YQ",22343:"YJ",22351:"PH",22395:"DC",22412:"TD",22484:"PB",22500:"PB",22534:"ZD",22549:"DH",22561:"PB",22612:"TD",22771:"KQ",22831:"HB",22841:"JG",22855:"QJ",22865:"XQ",23013:"ML",23081:"WM",23487:"SX",23558:"QJ",23561:"YW",23586:"YW",23614:"YW",23615:"SN",23631:"PB",23646:"ZS",23663:"ZT",23673:"YG",23762:"TD",23769:"ZS",23780:"QJ",23884:"QK",24055:"XH",24113:"DC",24162:"ZC",24191:"GA",24273:"QJ",24324:"NL",24377:"TD",24378:"QJ",24439:"PF",24554:"ZS",24683:"TD",24694:"WE",24733:"LK",24925:"TN",25094:"ZG",25100:"XQ",25103:"XH",25153:"PB",25170:"PB",25179:"KG",25203:"PB",25240:"ZS",25282:"FB",25303:"NA",25324:"KG",25341:"ZY",25373:"WZ",25375:"XJ",25384:"A",25457:"A",25528:"SD",25530:"SC",25552:"TD",25774:"ZC",25874:"ZC",26044:"YW",26080:"WM",26292:"PB",26333:"PB",26355:"ZY",26366:"CZ",26397:"ZC",26399:"QJ",26415:"ZS",26451:"SB",26526:"ZC",26552:"JG",26561:"TD",26588:"JG",26597:"CZ",26629:"ZS",26638:"YL",26646:"XQ",26653:"KG",26657:"XJ",26727:"HG",26894:"ZC",26937:"ZS",26946:"ZC",26999:"KJ",27099:"KJ",27449:"YQ",27481:"XS",27542:"ZS",27663:"ZS",27748:"TS",27784:"SC",27788:"ZD",27795:"TD",27812:"O",27850:"PB",27852:"MB",27895:"SL",27898:"PL",27973:"QJ",27981:"KH",27986:"HX",27994:"XJ",28044:"YC",28065:"WG",28177:"SM",28267:"QJ",28291:"KH",28337:"ZQ",28463:"TL",28548:"DC",28601:"TD",28689:"PB",28805:"JG",28820:"QG",28846:"PB",28952:"TD",28975:"ZC",29100:"A",29325:"QJ",29575:"SL",29602:"FB",30010:"TD",30044:"CX",30058:"PF",30091:"YSP",30111:"YN",30229:"XJ",30427:"SC",30465:"SX",30631:"YQ",30655:"QJ",30684:"QJG",30707:"SD",30729:"XH",30796:"LG",30917:"PB",31074:"NM",31085:"JZ",31109:"SC",31181:"ZC",31192:"MLB",31293:"JQ",31400:"YX",31584:"YJ",31896:"ZN",31909:"ZY",31995:"XJ",32321:"PF",32327:"ZY",32418:"HG",32420:"XQ",32421:"HG",32438:"LG",32473:"GJ",32488:"TD",32521:"QJ",32527:"PB",32562:"ZSQ",32564:"JZ",32735:"ZD",32793:"PB",33071:"PF",33098:"XL",33100:"YA",33152:"PB",33261:"CX",33324:"BP",33333:"TD",33406:"YA",33426:"WM",33432:"PB",33445:"JG",33486:"ZN",33493:"TS",33507:"QJ",33540:"QJ",33544:"ZC",33564:"XQ",33617:"YT",33632:"QJ",33636:"XH",33637:"YX",33694:"WG",33705:"PF",33728:"YW",33882:"SR",34067:"WM",34074:"YW",34121:"QJ",34255:"ZC",34259:"XL",34425:"JH",34430:"XH",34485:"KH",34503:"YS",34532:"HG",34552:"XS",34558:"YE",34593:"ZL",34660:"YQ",34892:"XH",34928:"SC",34999:"QJ",35048:"PB",35059:"SC",35098:"ZC",35203:"TQ",35265:"JX",35299:"JX",35782:"SZ",35828:"YS",35830:"E",35843:"TD",35895:"YG",35977:"MH",36158:"JG",36228:"QJ",36426:"XQ",36466:"DC",36710:"CJ",36711:"ZYG",36767:"PB",36866:"SK",36951:"YW",37034:"YX",37063:"XH",37218:"ZC",37325:"ZC",38063:"PB",38079:"TD",38085:"QY",38107:"DC",38116:"TD",38123:"YD",38224:"HG",38241:"XTC",38271:"ZC",38415:"YE",38426:"KH",38461:"YD",38463:"AE",38466:"PB",38477:"XJ",38518:"YT",38551:"WK",38585:"ZC",38704:"XS",38739:"LJ",38761:"GJ",38808:"SQ",39048:"JG",39049:"XJ",39052:"HG",39076:"CZ",39271:"XT",39534:"TD",39552:"TD",39584:"PB",39647:"SB",39730:"LG",39748:"TPB",40109:"ZQ",40479:"ND",40516:"HG",40536:"HG",40583:"QJ",40765:"YQ",40784:"QJ",40840:"YK",40863:"QJG"};function _checkPYCh(e){const t=e.charCodeAt(0);return t>40869||t<19968?e:oMultiDiff[t]?oMultiDiff[t]:_ChineseFirstPY.charAt(t-19968)}function _mkPYRslt(e,t){const r=t.ignoreMulti,n=t.splitChar;let o,i=[""],a=0;for(let s=0,l=e.length;s<l;s++){const t=e[s],n=t.length;if(1===n||a>14||r){const e=t.substring(0,1);for(o=0;o<i.length;o++)i[o]+=e}else{const e=i.slice(0);for(i=[],a++,o=0;o<n;o++){const r=e.slice(0);for(let e=0;e<r.length;e++)r[e]+=t.charAt(o);i=i.concat(r)}}}return i.join(n||"").toLowerCase()}function makeFirstPY(e,t){const r=t||{};if(e.length>100&&isNil$2(null==r?void 0:r.ignoreMulti)&&(r.ignoreMulti=!0),"string"!=typeof e)return"".concat(e);const n=[];for(let o=0,i=e.length;o<i;o++){const t=e.charAt(o);n.push(_checkPYCh(t))}return _mkPYRslt(n,r)}const LocaleContext$1=reactExports.createContext(void 0),useLocale$1=e=>{var t;const r=null!=(t=reactExports.useContext(LocaleContext$1))?t:localeValues;return[reactExports.useMemo((()=>({...(null==r?void 0:r[e])||{}})),[e,r])]},RED_WEIGHT=.299,GREEN_WEIGHT=.587,BLUE_WEIGHT=.114,BRIGHTNESS_VALUE=.15,PURITY_VALUE=.15,H_VALUE=3/360;function splitString(e,t){const r=Math.ceil(e.length/t),n=[];for(let o=0;o<t;o++)n[o]=e.slice(o*r,(o+1)*r);return n}function hexToJson(e,t){if(!/^#([A-Fa-f0-9]{3,4}){1,2}$/.test(e))return{r:0,g:0,b:0,a:0};const r=e.slice(1),n=r.length>5?2:1,o=splitString(r,Math.ceil(r.length/n)),[i,a,s,l]=o.map((e=>parseInt(e.repeat(2/e.length),16)));return{r:i,g:a,b:s,a:Math.min(1,Math.max(0,(null!=l?l:255)/255))}}function derivedColor(e,t,r=!1,n,o){const{r:i,g:a,b:s}=hexToJson(e),l=n||i*RED_WEIGHT+a*GREEN_WEIGHT+s*BLUE_WEIGHT;return l>200?deriveDown(e,t,r):l>30&&l<200?deriveUpAndDown(e,t,r,o):deriveUp(e,t,r)}function deriveDown(e,t,r){const n=[];n[0]=e;for(let o=1;o<t;o++)n[o]=e=rgb2hex$1(saturationDown(e,r,!1));return n}function deriveUp(e,t,r){const n=[];n[0]=e;for(let o=t-1;o>0;o--)n[o]=e=rgb2hex$1(saturationDown(e,r,!0));return n}function deriveUpAndDown(e,t,r,n){const o=[],i=Math.floor(t/2);o[0]=e;for(let a=i;a>0;a--)o[a]=e=rgb2hex$1(saturationDown(e,r,!0,n));e=o[0];for(let a=i+1;a<t;a++)o[a]=e=rgb2hex$1(saturationDown(e,r,!1,n));return o}function saturationDown(e,t,r,n){const{r:o,g:i,b:a}=hexToJson(e),s=rgb2hsb(o,i,a);return t||(s[1]=r?Math.max(0,s[1]-PURITY_VALUE):Math.min(1,s[1]+PURITY_VALUE),s[0]=r?Math.max(0,s[0]+H_VALUE):Math.min(1,s[0]-H_VALUE)),s[2]=r?Math.min(1,s[2]+(n||BRIGHTNESS_VALUE)):Math.max(0,s[2]-(n||BRIGHTNESS_VALUE)),hsb2rgb(s[0],s[1],s[2])}function rgb2hsb(e,t,r){let n=0,o=0,i=0;const a=new Array(3),s=Math.max(e,t,r),l=Math.min(e,t,r);if(i=s/255,o=0!=s?(s-l)/s:0,0==o)n=0;else{const o=(s-e)/(s-l),i=(s-t)/(s-l),a=(s-r)/(s-l);n=e==s?a-i:t==s?2+o-a:4+i-o,n/=6,n<0&&(n+=1)}return a[0]=n,a[1]=o,a[2]=i,a}function hsb2rgb(e,t,r){let n=0,o=0,i=0;if(0===t)n=o=i=Math.floor(255*r+.5);else{const a=6*(e-Math.floor(e)),s=a-Math.floor(a),l=r*(1-t),c=r*(1-t*s),u=r*(1-t*(1-s));switch(Math.floor(a)){case 0:n=Math.floor(255*r+.5),o=Math.floor(255*u+.5),i=Math.floor(255*l+.5);break;case 1:n=Math.floor(255*c+.5),o=Math.floor(255*r+.5),i=Math.floor(255*l+.5);break;case 2:n=Math.floor(255*l+.5),o=Math.floor(255*r+.5),i=Math.floor(255*u+.5);break;case 3:n=Math.floor(255*l+.5),o=Math.floor(255*c+.5),i=Math.floor(255*r+.5);break;case 4:n=Math.floor(255*u+.5),o=Math.floor(255*l+.5),i=Math.floor(255*r+.5);break;case 5:n=Math.floor(255*r+.5),o=Math.floor(255*l+.5),i=Math.floor(255*c+.5)}}return[n,o,i]}function rgb2hex$1(e){return"#".concat(e[0].toString(16).padStart(2,"0")).concat(e[1].toString(16).padStart(2,"0")).concat(e[2].toString(16).padStart(2,"0"))}var objectTag$5="[object Object]",funcProto$4=Function.prototype,objectProto$v=Object.prototype,funcToString$4=funcProto$4.toString,hasOwnProperty$r=objectProto$v.hasOwnProperty,objectCtorString=funcToString$4.call(Object);function isPlainObject(e){if(!isObjectLike$7(e)||baseGetTag$6(e)!=objectTag$5)return!1;var t=getPrototype$1(e);if(null===t)return!0;var r=hasOwnProperty$r.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&funcToString$4.call(r)==objectCtorString}function assignMergeValue(e,t,r){(void 0!==r&&!eq$5(e[t],r)||void 0===r&&!(t in e))&&baseAssignValue$7(e,t,r)}function safeGet(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function toPlainObject(e){return copyObject$4(e,keysIn$2(e))}function baseMergeDeep(e,t,r,n,o,i,a){var s=safeGet(e,r),l=safeGet(t,r),c=a.get(l);if(c)assignMergeValue(e,r,c);else{var u=i?i(s,l,r+"",e,t,a):void 0,d=void 0===u;if(d){var h=isArray$b(l),p=!h&&isBuffer$5(l),f=!h&&!p&&isTypedArray$3(l);u=l,h||p||f?isArray$b(s)?u=s:isArrayLikeObject$1(s)?u=copyArray$3(s):p?(d=!1,u=cloneBuffer$1(l,!0)):f?(d=!1,u=cloneTypedArray$1(l,!0)):u=[]:isPlainObject(l)||isArguments$4(l)?(u=s,isArguments$4(s)?u=toPlainObject(s):isObject$d(s)&&!isFunction$7(s)||(u=initCloneObject$1(l))):d=!1}d&&(a.set(l,u),o(u,l,n,i,a),a.delete(l)),assignMergeValue(e,r,u)}}function baseMerge$2(e,t,r,n,o){e!==t&&baseFor$2(t,(function(i,a){if(o||(o=new Stack$1),isObject$d(i))baseMergeDeep(e,t,a,r,baseMerge$2,n,o);else{var s=n?n(safeGet(e,a),i,a+"",e,t,o):void 0;void 0===s&&(s=i),assignMergeValue(e,a,s)}}),keysIn$2)}var mergeWith$3=createAssigner$4((function(e,t,r,n){baseMerge$2(e,t,r,n)}));const MAX_BRIGHTNESS_COL=2,getThemeVariableColor=(e="",t,r=1)=>"var(".concat(e,"-").concat(t,"-").concat(r,")"),formatThemeColor=e=>{if(!e)return{row:0,col:0};const t=e.replace("var(","").replace(")","").split("-");return t.length<2?{row:0,col:0}:{row:t[t.length-2],col:t[t.length-1]}},isThemeColor=(e,t)=>!!e&&t.includes(e),getThemeColorResult=(e,t,r)=>{if("string"!=typeof r)return r;if(!isThemeColor(t,r))return r;const n=formatTokenValue(e),o=formatThemeColor(r);return n[Number(o.col)-1][Number(o.row)-1]},formatTokenValue=e=>map$2(e,((e,t)=>derivedColor(e,5,t<MAX_BRIGHTNESS_COL,0===t?150:void 0,0===t?.08:void 0))),formatThemeObjectColor2ResultColor=(e,t,r)=>isPlainObject(r)?mergeWith$3({},r,((r,n)=>{if("string"==typeof n)return getThemeColorResult(e,t,n)})):r;function useFirstMountState(){var e=reactExports.useRef(!0);return e.current?(e.current=!1,!0):e.current}var useUpdateEffect$1=function(e,t){var r=useFirstMountState();reactExports.useEffect((function(){if(!r)return e()}),t)};function useUpdateValue(e,t){const[r,n]=reactExports.useState(e);return useUpdateEffect$1((()=>n(e)),t),[r,n]}const EyeDropperIcon=jsxRuntimeExports.jsx("svg",{className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"12863",width:"200",height:"200",children:jsxRuntimeExports.jsx("path",{d:"M883.84 132.032c60.544 52.48 57.344 156.288 7.808 205.824L783.744 439.68l81.6 82.944a32 32 0 0 1 3.392 40.832l-3.776 4.48-55.872 54.848a32 32 0 0 1-45.248-0.384l-83.2-84.608-328.064 339.2c-65.152 64.512-137.664 75.072-199.04 32.768l-8.704-6.4c-64.512-50.624-72.32-149.888-9.92-212.288l351.68-350.4L408.32 261.12a32 32 0 0 1 0.32-45.312l55.936-54.848a32 32 0 0 1 45.248 0.384L587.52 240.448l99.84-102.592a145.088 145.088 0 0 1 196.48-5.76zM537.088 392l-351.36 350.08c-31.36 31.36-27.52 80.384 3.52 104.768 33.28 26.176 69.184 22.208 112.128-20.352l328.704-339.968-92.992-94.528z","p-id":"12864"})}),ArtboardIcon=jsxRuntimeExports.jsx("svg",{className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"13020",width:"200",height:"200",children:jsxRuntimeExports.jsx("path",{d:"M512 96c70.464 0 97.344 25.152 107.968 84.8l1.28 7.808 1.088 8.192a416 416 0 0 1 1.344 12.992l0.64 6.144 0.512 5.888 1.28 11.072 1.28 10.24c4.928 36.032 12.352 56.768 29.824 81.92 7.36 10.56 16.192 20.736 26.816 30.656 22.4 20.864 47.616 35.776 76.48 46.08l6.4 2.24 6.144 2.048 6.144 1.856 6.08 1.728 6.208 1.536 6.4 1.472 6.72 1.28 7.168 1.28 7.68 1.28 8.192 1.28 8.96 1.152 14.912 1.856 34.112 3.84 9.728 1.28 8.832 1.28 8 1.28c16.576 2.816 28.16 6.272 39.68 11.712 28.544 13.632 44.288 38.144 44.288 71.808 0 231.04-217.792 416-484.16 416C245.632 928 27.84 743.04 27.84 512S245.632 96 512 96z m0 64C278.912 160 91.84 318.848 91.84 512S278.912 864 512 864c233.088 0 420.16-158.848 420.16-352v-1.216c-0.32-8.192-3.904-12.928-18.432-16.704l-4.48-1.088a163.328 163.328 0 0 0-2.432-0.512l-5.44-0.96-6.144-1.024-10.56-1.408-12.352-1.536-11.264-1.28-24.32-2.752-10.624-1.408-9.856-1.28-9.152-1.408-8.512-1.408a435.84 435.84 0 0 1-4.096-0.768l-7.808-1.472-3.84-0.832-7.296-1.664a299.392 299.392 0 0 1-3.648-0.96l-7.168-1.92-7.168-2.112a362.432 362.432 0 0 1-3.648-1.088l-7.36-2.432-7.68-2.688a280.832 280.832 0 0 1-98.56-59.648 255.68 255.68 0 0 1-35.584-40.832c-27.52-39.424-36.736-70.4-42.88-126.4l-1.28-12.8-1.28-14.08-1.024-9.6a270.336 270.336 0 0 0-0.384-2.88l-0.768-5.376-0.832-4.8-0.96-4.288c-3.392-13.44-9.088-18.496-21.696-20.352l-3.968-0.448-4.48-0.32-4.864-0.192L512 160zM384 640a64 64 0 1 1 0 128 64 64 0 0 1 0-128zM232 472a64 64 0 1 1 0 128 64 64 0 0 1 0-128z m176-232a88 88 0 1 1 0 176 88 88 0 0 1 0-176z","p-id":"13021"})});function __read(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function __spreadArray(e,t,r){if(2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var freeGlobal$2="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,_freeGlobal=freeGlobal$2,freeGlobal$1=_freeGlobal,freeSelf$1="object"==typeof self&&self&&self.Object===Object&&self,root$a=freeGlobal$1||freeSelf$1||Function("return this")(),_root=root$a,root$9=_root,Symbol$1$4=root$9.Symbol,_Symbol=Symbol$1$4,Symbol$1$3=_Symbol,objectProto$u=Object.prototype,hasOwnProperty$q=objectProto$u.hasOwnProperty,nativeObjectToString$3=objectProto$u.toString,symToStringTag$3=Symbol$1$3?Symbol$1$3.toStringTag:void 0;function getRawTag$2(e){var t=hasOwnProperty$q.call(e,symToStringTag$3),r=e[symToStringTag$3];try{e[symToStringTag$3]=void 0;var n=!0}catch(e3){}var o=nativeObjectToString$3.call(e);return n&&(t?e[symToStringTag$3]=r:delete e[symToStringTag$3]),o}var _getRawTag=getRawTag$2,objectProto$t=Object.prototype,nativeObjectToString$2=objectProto$t.toString;function objectToString$2(e){return nativeObjectToString$2.call(e)}var _objectToString=objectToString$2,Symbol$1$2=_Symbol,getRawTag$1=_getRawTag,objectToString$1=_objectToString,nullTag$1="[object Null]",undefinedTag$1="[object Undefined]",symToStringTag$2=Symbol$1$2?Symbol$1$2.toStringTag:void 0;function baseGetTag$5(e){return null==e?void 0===e?undefinedTag$1:nullTag$1:symToStringTag$2&&symToStringTag$2 in Object(e)?getRawTag$1(e):objectToString$1(e)}var _baseGetTag=baseGetTag$5;function useLatest$2(e){var t=reactExports.useRef(e);return t.current=e,t}var useUnmount$1=function(e){var t=useLatest$2(e);reactExports.useEffect((function(){return function(){t.current()}}),[])};function isObject$c(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var isObject_1=isObject$c,root$8=_root,now$3=function(){return root$8.Date.now()},now_1=now$3,reWhitespace=/\s/;function trimmedEndIndex$1(e){for(var t=e.length;t--&&reWhitespace.test(e.charAt(t)););return t}var _trimmedEndIndex=trimmedEndIndex$1,trimmedEndIndex=_trimmedEndIndex,reTrimStart=/^\s+/;function baseTrim$1(e){return e?e.slice(0,trimmedEndIndex(e)+1).replace(reTrimStart,""):e}var _baseTrim=baseTrim$1;function isObjectLike$6(e){return null!=e&&"object"==typeof e}var isObjectLike_1=isObjectLike$6,baseGetTag$4=_baseGetTag,isObjectLike$5=isObjectLike_1,symbolTag$4="[object Symbol]";function isSymbol$6(e){return"symbol"==typeof e||isObjectLike$5(e)&&baseGetTag$4(e)==symbolTag$4}var isSymbol_1=isSymbol$6,baseTrim=_baseTrim,isObject$b=isObject_1,isSymbol$5=isSymbol_1,NAN$1=NaN,reIsBadHex$1=/^[-+]0x[0-9a-f]+$/i,reIsBinary$1=/^0b[01]+$/i,reIsOctal$1=/^0o[0-7]+$/i,freeParseInt$1=parseInt;function toNumber$5(e){if("number"==typeof e)return e;if(isSymbol$5(e))return NAN$1;if(isObject$b(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=isObject$b(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=baseTrim(e);var r=reIsBinary$1.test(e);return r||reIsOctal$1.test(e)?freeParseInt$1(e.slice(2),r?2:8):reIsBadHex$1.test(e)?NAN$1:+e}var toNumber_1=toNumber$5,isObject$a=isObject_1,now$2=now_1,toNumber$4=toNumber_1,FUNC_ERROR_TEXT$7="Expected a function",nativeMax$8=Math.max,nativeMin$4=Math.min;function debounce$1(e,t,r){var n,o,i,a,s,l,c=0,u=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$7);function p(t){var r=n,i=o;return n=o=void 0,c=t,a=e.apply(i,r)}function f(e){var r=e-l;return void 0===l||r>=t||r<0||d&&e-c>=i}function g(){var e=now$2();if(f(e))return m(e);s=setTimeout(g,function(e){var r=t-(e-l);return d?nativeMin$4(r,i-(e-c)):r}(e))}function m(e){return s=void 0,h&&n?p(e):(n=o=void 0,a)}function y(){var e=now$2(),r=f(e);if(n=arguments,o=this,l=e,r){if(void 0===s)return function(e){return c=e,s=setTimeout(g,t),u?p(e):a}(l);if(d)return clearTimeout(s),s=setTimeout(g,t),p(l)}return void 0===s&&(s=setTimeout(g,t)),a}return t=toNumber$4(t)||0,isObject$a(r)&&(u=!!r.leading,i=(d="maxWait"in r)?nativeMax$8(toNumber$4(r.maxWait)||0,t):i,h="trailing"in r?!!r.trailing:h),y.cancel=function(){void 0!==s&&clearTimeout(s),c=0,n=l=o=s=void 0},y.flush=function(){return void 0===s?a:m(now$2())},y}var debounce_1=debounce$1;const debounce$1$1=getDefaultExportFromCjs(debounce_1);function useDebounceFn$1(e,t){var r,n=useLatest$2(e),o=null!==(r=null==t?void 0:t.wait)&&void 0!==r?r:1e3,i=reactExports.useMemo((function(){return debounce$1$1((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.current.apply(n,__spreadArray([],__read(e),!1))}),o,t)}),[]);return useUnmount$1((function(){i.cancel()})),{run:i,cancel:i.cancel,flush:i.flush}}var dist$1={exports:{}};dist$1.exports=function(){var e={d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{default:function(){return c}});var r="#FFFFFF",n="#000000",o={grey1:r,grey2:"#F5F6F8",grey3:"#F0F1F4",grey4:"#EDEFF3",grey5:"#E6E8ED",grey6:"#EBECEE",grey7:"#E1E3E5",grey8:"#D7D9DC",grey9:"#B5B8BE",grey10:"#838892",grey11:"#525967",grey12:"#141E31",grey13:n,white:r,black:n};function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return n=function(e){if("object"!==i(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"===i(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e;var n}var c=s(s({},{red1:"#FDEEEE",red2:"#F9CBCB",red3:"#F7B9B9",red4:"#F5A8A8",red5:"#F18585",red6:"#EB5050",red7:"#BC4040",red8:"#8D3030",red9:"#5E2020",red10:"#471818",orange1:"#FFF2E8",orange2:"#FED9BA",orange3:"#FDCDA3",orange4:"#FDC08C",orange5:"#FCA75D",orange6:"#FA8118",orange7:"#C86713",orange8:"#964D0E",orange9:"#64340A",orange10:"#4B2707",yellow1:"#FEF6E6",yellow2:"#FBE5B3",yellow3:"#F9DC99",yellow4:"#F8D480",yellow5:"#F5C24D",yellow6:"#F0A800",yellow7:"#C08600",yellow8:"#906500",yellow9:"#604300",yellow10:"#483200",maize1:"#FBF9E6",maize2:"#F3EEB4",maize3:"#EFE89B",maize4:"#EBE282",maize5:"#E2D64F",maize6:"#D6C504",maize7:"#AB9E03",maize8:"#807602",maize9:"#564F02",maize10:"#403B01",lime1:"#F6F9E6",lime2:"#E3EDB4",lime3:"#DAE79B",lime4:"#D1E182",lime5:"#BED44F",lime6:"#A2C204",lime7:"#829B03",lime8:"#617402",lime9:"#414E02",lime10:"#313A01",lightgreen1:"#F0F9EC",lightgreen2:"#D2EEC5",lightgreen3:"#C3E9B1",lightgreen4:"#B5E39E",lightgreen5:"#97D877",lightgreen6:"#6AC73C",lightgreen7:"#559F30",lightgreen8:"#407724",lightgreen9:"#2A5018",lightgreen10:"#203C12",green1:"#EDF9F1",green2:"#C8EDD4",green3:"#B5E7C5",green4:"#A3E1B7",green5:"#7ED49A",green6:"#46C26F",green7:"#389B59",green8:"#2A7443",green9:"#1C4E2C",green10:"#153A21",teal1:"#E6F8F5",teal2:"#B3EAE0",teal3:"#99E3D6",teal4:"#80DCCC",teal5:"#4DCDB8",teal6:"#00B899",teal7:"#00937A",teal8:"#006E5C",teal9:"#004A3D",teal10:"#00372E",cyan1:"#E6F7FA",cyan2:"#B3E7F1",cyan3:"#99DFED",cyan4:"#80D7E8",cyan5:"#4DC6DF",cyan6:"#00AED1",cyan7:"#008BA7",cyan8:"#00687D",cyan9:"#004654",cyan10:"#00343F",blue1:"#EAF2FD",blue2:"#C1D8F9",blue3:"#ACCBF7",blue4:"#97BEF5",blue5:"#6DA4F1",blue6:"#2F7DEB",blue7:"#2664BC",blue8:"#1C4B8D",blue9:"#13325E",blue10:"#0E2647",indigo1:"#EEF0FE",indigo2:"#CDD1FC",indigo3:"#BCC1FB",indigo4:"#ACB2FA",indigo5:"#8A93F8",indigo6:"#5865F5",indigo7:"#4651C4",indigo8:"#353D93",indigo9:"#232862",indigo10:"#1A1E4A",violet1:"#F2EDFD",violet2:"#D8C8F9",violet3:"#CBB5F7",violet4:"#BFA3F5",violet5:"#A57EF1",violet6:"#7E47EB",violet7:"#6539BC",violet8:"#4C2B8D",violet9:"#321C5E",violet10:"#261547",purple1:"#F9ECFC",purple2:"#EEC7F6",purple3:"#E8B4F3",purple4:"#E3A1F0",purple5:"#D77BE9",purple6:"#C643E0",purple7:"#9E36B3",purple8:"#772886",purple9:"#4F1B5A",purple10:"#3B1443",lilac1:"#FBECF9",lilac2:"#F4C6EC",lilac3:"#F0B3E6",lilac4:"#ECA0E0",lilac5:"#E47AD3",lilac6:"#D941C0",lilac7:"#AE349A",lilac8:"#822773",lilac9:"#571A4D",lilac10:"#41143A",pink1:"#FEECF2",pink2:"#FBC7D8",pink3:"#F9B4CB",pink4:"#F8A1BE",pink5:"#F57BA4",pink6:"#F0437D",pink7:"#C03664",pink8:"#90284B",pink9:"#601B32",pink10:"#481426",bluegrey1:"#EDEEF1",bluegrey2:"#C8CDD4",bluegrey3:"#B6BDC6",bluegrey4:"#A4ACB8",bluegrey5:"#7F8B9B",bluegrey6:"#485970",bluegrey7:"#3A475A",bluegrey8:"#2B3543",bluegrey9:"#1D242D",bluegrey10:"#161B22"}),o);return t}();var distExports=dist$1.exports;const COLOR=getDefaultExportFromCjs(distExports);function _arrayWithHoles$2(e){if(Array.isArray(e))return e}function _iterableToArrayLimit$2(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t);else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(u){c=!0,o=u}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}function _arrayLikeToArray$1(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _unsupportedIterableToArray$1(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$1(e,t):void 0}}function _nonIterableRest$2(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _slicedToArray$2(e,t){return _arrayWithHoles$2(e)||_iterableToArrayLimit$2(e,t)||_unsupportedIterableToArray$1(e,t)||_nonIterableRest$2()}var DEFAULT_PREFIX="x",defaultGetPrefixCls=function(e,t){return t||(e?"".concat(DEFAULT_PREFIX,"-").concat(e):DEFAULT_PREFIX)},ConfigProviderContext=React.createContext({getPrefixCls:defaultGetPrefixCls}),usePrefixCls=function(e,t){return(0,React.useContext(ConfigProviderContext).getPrefixCls)(e,t)},HueSlider=function(e){var t=e.hue,r=e.sliderWidth,n=void 0===r?140:r,o=e.cursorWidth,i=void 0===o?12:o,a=e.style,s=e.value,l=e.onChange,c=reactExports.useRef(null),u=_slicedToArray$2(reactExports.useState(!1),2),d=u[0],h=u[1],p=reactExports.useMemo((function(){var e=Math.round(t/360*n-i/2),r=Math.round(-i/2),o=Math.round(n-i/2);return e=Math.max(r,e),e=Math.min(o,e)}),[t]),f=usePrefixCls("hue"),g=reactExports.useCallback((function(e){d&&y(e)}),[d]),m=function(){h(!1)};reactExports.useEffect((function(){if(c.current)return document.addEventListener("mouseup",m),document.addEventListener("mousemove",g),function(){document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",m)}}),[g]);var y=function(e){if(c.current){var t=e.clientX-c.current.getBoundingClientRect().left,r=Math.round(t/n*360);l&&l(r)}};return React.createElement("div",{ref:c,className:"".concat(f,"-slider"),style:Object.assign({width:n},a),onMouseDown:function(e){d||(y(e),h(!0))}},React.createElement("div",{className:"".concat(f,"-slider-cursor"),style:{backgroundColor:s,left:p,width:i}}))},OpacitySlider=function(e){var t=e.color,r=e.opacity,n=void 0===r?0:r,o=e.sliderWidth,i=void 0===o?140:o,a=e.cursorWidth,s=void 0===a?12:a,l=e.style,c=e.onChange,u=reactExports.useRef(null),d=_slicedToArray$2(reactExports.useState(!1),2),h=d[0],p=d[1],f=reactExports.useMemo((function(){var e=n*i-s/2,t=Math.round(-s/2),r=Math.round(i-s/2);return e=Math.max(t,e),e=Math.min(r,e)}),[n]),g=usePrefixCls("opacity-slider"),m=reactExports.useCallback((function(e){h&&v(e)}),[h]),y=function(){p(!1)},v=function(e){if(u.current){var t=e.clientX-u.current.getBoundingClientRect().left;c&&c(t/i)}};return reactExports.useEffect((function(){if(u.current)return document.addEventListener("mouseup",y),document.addEventListener("mousemove",m),function(){document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",y)}}),[m]),React.createElement("div",{ref:u,className:g,style:Object.assign({width:i},l),onMouseDown:function(e){h||(v(e),p(!0))}},React.createElement("div",{className:"".concat(g,"-value"),style:{background:"linear-gradient(to right, rgba(0, 0, 0, 0) 0%, ".concat(t," 100%)")}},React.createElement("div",{className:"".concat(g,"-cursor"),style:{left:f,width:s}})))};function _classCallCheck$2C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _typeof$1(e){return(_typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toPrimitive$2x(e,t){if("object"!==_typeof$1(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==_typeof$1(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _toPropertyKey$2x(e){var t=_toPrimitive$2x(e,"string");return"symbol"===_typeof$1(t)?t:String(t)}function _defineProperties$2x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2x(n.key),n)}}function _createClass$2C(e,t,r){return r&&_defineProperties$2x(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function arrayEach$3(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}var _arrayEach=arrayEach$3;function createBaseFor$1(e){return function(t,r,n){for(var o=-1,i=Object(t),a=n(t),s=a.length;s--;){var l=a[e?s:++o];if(!1===r(i[l],l,i))break}return t}}var _createBaseFor=createBaseFor$1,createBaseFor=_createBaseFor,baseFor$1=createBaseFor(),_baseFor=baseFor$1;function baseTimes$3(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var _baseTimes=baseTimes$3,baseGetTag$3=_baseGetTag,isObjectLike$4=isObjectLike_1,argsTag$5="[object Arguments]";function baseIsArguments$2(e){return isObjectLike$4(e)&&baseGetTag$3(e)==argsTag$5}var _baseIsArguments=baseIsArguments$2,baseIsArguments$1=_baseIsArguments,isObjectLike$3=isObjectLike_1,objectProto$s=Object.prototype,hasOwnProperty$p=objectProto$s.hasOwnProperty,propertyIsEnumerable$2=objectProto$s.propertyIsEnumerable,isArguments$3=baseIsArguments$1(function(){return arguments}())?baseIsArguments$1:function(e){return isObjectLike$3(e)&&hasOwnProperty$p.call(e,"callee")&&!propertyIsEnumerable$2.call(e,"callee")},isArguments_1=isArguments$3,isArray$a=Array.isArray,isArray_1=isArray$a;getDefaultExportFromCjs(isArray_1);var isBuffer$4={exports:{}};function stubFalse$1(){return!1}var stubFalse_1=stubFalse$1,module2,exports2,root2,stubFalse2,freeExports2,freeModule2,Buffer2,isBuffer2;isBuffer$4.exports,module2=isBuffer$4,exports2=isBuffer$4.exports,root2=_root,stubFalse2=stubFalse_1,freeExports2=exports2&&!exports2.nodeType&&exports2,freeModule2=freeExports2&&module2&&!module2.nodeType&&module2,Buffer2=freeModule2&&freeModule2.exports===freeExports2?root2.Buffer:void 0,isBuffer2=(Buffer2?Buffer2.isBuffer:void 0)||stubFalse2,module2.exports=isBuffer2;var isBufferExports=isBuffer$4.exports,MAX_SAFE_INTEGER$3=9007199254740991,reIsUint$1=/^(?:0|[1-9]\d*)$/;function isIndex$6(e,t){var r=typeof e;return!!(t=null==t?MAX_SAFE_INTEGER$3:t)&&("number"==r||"symbol"!=r&&reIsUint$1.test(e))&&e>-1&&e%1==0&&e<t}var _isIndex=isIndex$6,MAX_SAFE_INTEGER$2=9007199254740991;function isLength$5(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER$2}var isLength_1=isLength$5,baseGetTag$2=_baseGetTag,isLength$4=isLength_1,isObjectLike$2=isObjectLike_1,argsTag$4="[object Arguments]",arrayTag$3="[object Array]",boolTag$4="[object Boolean]",dateTag$4="[object Date]",errorTag$3="[object Error]",funcTag$4="[object Function]",mapTag$7="[object Map]",numberTag$5="[object Number]",objectTag$4="[object Object]",regexpTag$4="[object RegExp]",setTag$7="[object Set]",stringTag$4="[object String]",weakMapTag$3="[object WeakMap]",arrayBufferTag$4="[object ArrayBuffer]",dataViewTag$5="[object DataView]",float32Tag$3="[object Float32Array]",float64Tag$3="[object Float64Array]",int8Tag$3="[object Int8Array]",int16Tag$3="[object Int16Array]",int32Tag$3="[object Int32Array]",uint8Tag$3="[object Uint8Array]",uint8ClampedTag$3="[object Uint8ClampedArray]",uint16Tag$3="[object Uint16Array]",uint32Tag$3="[object Uint32Array]",typedArrayTags$1={};function baseIsTypedArray$2(e){return isObjectLike$2(e)&&isLength$4(e.length)&&!!typedArrayTags$1[baseGetTag$2(e)]}typedArrayTags$1[float32Tag$3]=typedArrayTags$1[float64Tag$3]=typedArrayTags$1[int8Tag$3]=typedArrayTags$1[int16Tag$3]=typedArrayTags$1[int32Tag$3]=typedArrayTags$1[uint8Tag$3]=typedArrayTags$1[uint8ClampedTag$3]=typedArrayTags$1[uint16Tag$3]=typedArrayTags$1[uint32Tag$3]=!0,typedArrayTags$1[argsTag$4]=typedArrayTags$1[arrayTag$3]=typedArrayTags$1[arrayBufferTag$4]=typedArrayTags$1[boolTag$4]=typedArrayTags$1[dataViewTag$5]=typedArrayTags$1[dateTag$4]=typedArrayTags$1[errorTag$3]=typedArrayTags$1[funcTag$4]=typedArrayTags$1[mapTag$7]=typedArrayTags$1[numberTag$5]=typedArrayTags$1[objectTag$4]=typedArrayTags$1[regexpTag$4]=typedArrayTags$1[setTag$7]=typedArrayTags$1[stringTag$4]=typedArrayTags$1[weakMapTag$3]=!1;var _baseIsTypedArray=baseIsTypedArray$2;function baseUnary$2(e){return function(t){return e(t)}}var _baseUnary=baseUnary$2,_nodeUtil={exports:{}};_nodeUtil.exports,function(e,t){var r=_freeGlobal,n=t&&!t.nodeType&&t,o=n&&e&&!e.nodeType&&e,i=o&&o.exports===n&&r.process,a=function(){try{var e=o&&o.require&&o.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e3){}}();e.exports=a}(_nodeUtil,_nodeUtil.exports);var _nodeUtilExports=_nodeUtil.exports,baseIsTypedArray$1=_baseIsTypedArray,baseUnary$1=_baseUnary,nodeUtil$1=_nodeUtilExports,nodeIsTypedArray$1=nodeUtil$1&&nodeUtil$1.isTypedArray,isTypedArray$2=nodeIsTypedArray$1?baseUnary$1(nodeIsTypedArray$1):baseIsTypedArray$1,isTypedArray_1=isTypedArray$2,baseTimes$2=_baseTimes,isArguments$2=isArguments_1,isArray$9=isArray_1,isBuffer$3=isBufferExports,isIndex$5=_isIndex,isTypedArray$1=isTypedArray_1,objectProto$r=Object.prototype,hasOwnProperty$o=objectProto$r.hasOwnProperty;function arrayLikeKeys$2(e,t){var r=isArray$9(e),n=!r&&isArguments$2(e),o=!r&&!n&&isBuffer$3(e),i=!r&&!n&&!o&&isTypedArray$1(e),a=r||n||o||i,s=a?baseTimes$2(e.length,String):[],l=s.length;for(var c in e)!t&&!hasOwnProperty$o.call(e,c)||a&&("length"==c||o&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||isIndex$5(c,l))||s.push(c);return s}var _arrayLikeKeys=arrayLikeKeys$2,objectProto$q=Object.prototype;function isPrototype$3(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$q)}var _isPrototype=isPrototype$3;function overArg$2(e,t){return function(r){return e(t(r))}}var _overArg=overArg$2,overArg$1=_overArg,nativeKeys$2=overArg$1(Object.keys,Object),_nativeKeys=nativeKeys$2,isPrototype$2=_isPrototype,nativeKeys$1=_nativeKeys,objectProto$p=Object.prototype,hasOwnProperty$n=objectProto$p.hasOwnProperty;function baseKeys$2(e){if(!isPrototype$2(e))return nativeKeys$1(e);var t=[];for(var r in Object(e))hasOwnProperty$n.call(e,r)&&"constructor"!=r&&t.push(r);return t}var _baseKeys=baseKeys$2,baseGetTag$1=_baseGetTag,isObject$9=isObject_1,asyncTag$1="[object AsyncFunction]",funcTag$3="[object Function]",genTag$2="[object GeneratorFunction]",proxyTag$1="[object Proxy]";function isFunction$6(e){if(!isObject$9(e))return!1;var t=baseGetTag$1(e);return t==funcTag$3||t==genTag$2||t==asyncTag$1||t==proxyTag$1}var isFunction_1=isFunction$6;getDefaultExportFromCjs(isFunction_1);var isFunction$5=isFunction_1,isLength$3=isLength_1;function isArrayLike$5(e){return null!=e&&isLength$3(e.length)&&!isFunction$5(e)}var isArrayLike_1=isArrayLike$5,arrayLikeKeys$1=_arrayLikeKeys,baseKeys$1=_baseKeys,isArrayLike$4=isArrayLike_1;function keys$5(e){return isArrayLike$4(e)?arrayLikeKeys$1(e):baseKeys$1(e)}var keys_1=keys$5,baseFor=_baseFor,keys$4=keys_1;function baseForOwn$2(e,t){return e&&baseFor(e,t,keys$4)}var _baseForOwn=baseForOwn$2,isArrayLike$3=isArrayLike_1;function createBaseEach$1(e,t){return function(r,n){if(null==r)return r;if(!isArrayLike$3(r))return e(r,n);for(var o=r.length,i=t?o:-1,a=Object(r);(t?i--:++i<o)&&!1!==n(a[i],i,a););return r}}var _createBaseEach=createBaseEach$1,baseForOwn$1=_baseForOwn,createBaseEach=_createBaseEach,baseEach$1=createBaseEach(baseForOwn$1),_baseEach=baseEach$1;function identity$8(e){return e}var identity_1=identity$8,identity$7=identity_1;function castFunction$1(e){return"function"==typeof e?e:identity$7}var _castFunction=castFunction$1,arrayEach$2=_arrayEach,baseEach=_baseEach,castFunction=_castFunction,isArray$8=isArray_1;function forEach$1(e,t){return(isArray$8(e)?arrayEach$2:baseEach)(e,castFunction(t))}var forEach_1=forEach$1;getDefaultExportFromCjs(forEach_1);var each$2=forEach_1;const each$1$1=getDefaultExportFromCjs(each$2);var root$7=_root,coreJsData$2=root$7["__core-js_shared__"],_coreJsData=coreJsData$2,coreJsData$1=_coreJsData,maskSrcKey$1=function(){var e=/[^.]+$/.exec(coreJsData$1&&coreJsData$1.keys&&coreJsData$1.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function isMasked$2(e){return!!maskSrcKey$1&&maskSrcKey$1 in e}var _isMasked=isMasked$2,funcProto$3=Function.prototype,funcToString$3=funcProto$3.toString;function toSource$2(e){if(null!=e){try{return funcToString$3.call(e)}catch(e3){}try{return e+""}catch(e3){}}return""}var _toSource=toSource$2,isFunction$4=isFunction_1,isMasked$1=_isMasked,isObject$8=isObject_1,toSource$1=_toSource,reRegExpChar$1=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor$1=/^\[object .+?Constructor\]$/,funcProto$2=Function.prototype,objectProto$o=Object.prototype,funcToString$2=funcProto$2.toString,hasOwnProperty$m=objectProto$o.hasOwnProperty,reIsNative$1=RegExp("^"+funcToString$2.call(hasOwnProperty$m).replace(reRegExpChar$1,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative$2(e){return!(!isObject$8(e)||isMasked$1(e))&&(isFunction$4(e)?reIsNative$1:reIsHostCtor$1).test(toSource$1(e))}var _baseIsNative=baseIsNative$2;function getValue$4(e,t){return null==e?void 0:e[t]}var _getValue=getValue$4,baseIsNative$1=_baseIsNative,getValue$3=_getValue;function getNative$4(e,t){var r=getValue$3(e,t);return baseIsNative$1(r)?r:void 0}var _getNative=getNative$4,getNative$3=_getNative,defineProperty$3=function(){try{var e=getNative$3(Object,"defineProperty");return e({},"",{}),e}catch(e3){}}(),_defineProperty$2=defineProperty$3,defineProperty$2=_defineProperty$2;function baseAssignValue$6(e,t,r){"__proto__"==t&&defineProperty$2?defineProperty$2(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var _baseAssignValue=baseAssignValue$6;function eq$4(e,t){return e===t||e!=e&&t!=t}var eq_1=eq$4,baseAssignValue$5=_baseAssignValue,eq$3=eq_1,objectProto$n=Object.prototype,hasOwnProperty$l=objectProto$n.hasOwnProperty;function assignValue$4(e,t,r){var n=e[t];hasOwnProperty$l.call(e,t)&&eq$3(n,r)&&(void 0!==r||t in e)||baseAssignValue$5(e,t,r)}var _assignValue=assignValue$4,assignValue$3=_assignValue,baseAssignValue$4=_baseAssignValue;function copyObject$3(e,t,r,n){var o=!r;r||(r={});for(var i=-1,a=t.length;++i<a;){var s=t[i],l=n?n(r[s],e[s],s,r,e):void 0;void 0===l&&(l=e[s]),o?baseAssignValue$4(r,s,l):assignValue$3(r,s,l)}return r}var _copyObject=copyObject$3;function apply$5(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var _apply=apply$5,apply$4=_apply,nativeMax$7=Math.max;function overRest$1(e,t,r){return t=nativeMax$7(void 0===t?e.length-1:t,0),function(){for(var n=arguments,o=-1,i=nativeMax$7(n.length-t,0),a=Array(i);++o<i;)a[o]=n[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=n[o];return s[t]=r(a),apply$4(e,this,s)}}var _overRest=overRest$1;function constant$1(e){return function(){return e}}var constant_1=constant$1,constant=constant_1,defineProperty$1=_defineProperty$2,identity$6=identity_1,baseSetToString$1=defineProperty$1?function(e,t){return defineProperty$1(e,"toString",{configurable:!0,enumerable:!1,value:constant(t),writable:!0})}:identity$6,_baseSetToString=baseSetToString$1,HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut$2(e){var t=0,r=0;return function(){var n=nativeNow(),o=HOT_SPAN-(n-r);if(r=n,o>0){if(++t>=HOT_COUNT)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var _shortOut=shortOut$2,baseSetToString=_baseSetToString,shortOut$1=_shortOut,setToString$2=shortOut$1(baseSetToString),_setToString=setToString$2,identity$5=identity_1,overRest=_overRest,setToString$1=_setToString;function baseRest$5(e,t){return setToString$1(overRest(e,t,identity$5),e+"")}var _baseRest=baseRest$5,eq$2=eq_1,isArrayLike$2=isArrayLike_1,isIndex$4=_isIndex,isObject$7=isObject_1;function isIterateeCall$1(e,t,r){if(!isObject$7(r))return!1;var n=typeof t;return!!("number"==n?isArrayLike$2(r)&&isIndex$4(t,r.length):"string"==n&&t in r)&&eq$2(r[t],e)}var _isIterateeCall=isIterateeCall$1,baseRest$4=_baseRest,isIterateeCall=_isIterateeCall;function createAssigner$3(e){return baseRest$4((function(t,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,a=o>2?r[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&isIterateeCall(r[0],r[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++n<o;){var s=r[n];s&&e(t,s,n,i)}return t}))}var _createAssigner=createAssigner$3,assignValue$2=_assignValue,copyObject$2=_copyObject,createAssigner$2=_createAssigner,isArrayLike$1=isArrayLike_1,isPrototype$1=_isPrototype,keys$3=keys_1,objectProto$m=Object.prototype,hasOwnProperty$k=objectProto$m.hasOwnProperty,assign$2=createAssigner$2((function(e,t){if(isPrototype$1(t)||isArrayLike$1(t))copyObject$2(t,keys$3(t),e);else for(var r in t)hasOwnProperty$k.call(t,r)&&assignValue$2(e,r,t[r])})),assign_1=assign$2;const assign$1$1=getDefaultExportFromCjs(assign_1);function listCacheClear$2(){this.__data__=[],this.size=0}var _listCacheClear=listCacheClear$2,eq$1=eq_1;function assocIndexOf$5(e,t){for(var r=e.length;r--;)if(eq$1(e[r][0],t))return r;return-1}var _assocIndexOf=assocIndexOf$5,assocIndexOf$4=_assocIndexOf,arrayProto$2=Array.prototype,splice$2=arrayProto$2.splice;function listCacheDelete$2(e){var t=this.__data__,r=assocIndexOf$4(t,e);return!(r<0)&&(r==t.length-1?t.pop():splice$2.call(t,r,1),--this.size,!0)}var _listCacheDelete=listCacheDelete$2,assocIndexOf$3=_assocIndexOf;function listCacheGet$2(e){var t=this.__data__,r=assocIndexOf$3(t,e);return r<0?void 0:t[r][1]}var _listCacheGet=listCacheGet$2,assocIndexOf$2=_assocIndexOf;function listCacheHas$2(e){return assocIndexOf$2(this.__data__,e)>-1}var _listCacheHas=listCacheHas$2,assocIndexOf$1=_assocIndexOf;function listCacheSet$2(e,t){var r=this.__data__,n=assocIndexOf$1(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var _listCacheSet=listCacheSet$2,listCacheClear$1=_listCacheClear,listCacheDelete$1=_listCacheDelete,listCacheGet$1=_listCacheGet,listCacheHas$1=_listCacheHas,listCacheSet$1=_listCacheSet;function ListCache$2(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ListCache$2.prototype.clear=listCacheClear$1,ListCache$2.prototype.delete=listCacheDelete$1,ListCache$2.prototype.get=listCacheGet$1,ListCache$2.prototype.has=listCacheHas$1,ListCache$2.prototype.set=listCacheSet$1;var _ListCache=ListCache$2,getNative$2=_getNative,root$6=_root,Map$3=getNative$2(root$6,"Map"),_Map=Map$3,getNative$1=_getNative,nativeCreate$5=getNative$1(Object,"create"),_nativeCreate=nativeCreate$5,nativeCreate$4=_nativeCreate;function hashClear$2(){this.__data__=nativeCreate$4?nativeCreate$4(null):{},this.size=0}var _hashClear=hashClear$2;function hashDelete$2(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var _hashDelete=hashDelete$2,nativeCreate$3=_nativeCreate,HASH_UNDEFINED$4="__lodash_hash_undefined__",objectProto$l=Object.prototype,hasOwnProperty$j=objectProto$l.hasOwnProperty;function hashGet$2(e){var t=this.__data__;if(nativeCreate$3){var r=t[e];return r===HASH_UNDEFINED$4?void 0:r}return hasOwnProperty$j.call(t,e)?t[e]:void 0}var _hashGet=hashGet$2,nativeCreate$2=_nativeCreate,objectProto$k=Object.prototype,hasOwnProperty$i=objectProto$k.hasOwnProperty;function hashHas$2(e){var t=this.__data__;return nativeCreate$2?void 0!==t[e]:hasOwnProperty$i.call(t,e)}var _hashHas=hashHas$2,nativeCreate$1=_nativeCreate,HASH_UNDEFINED$3="__lodash_hash_undefined__";function hashSet$2(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=nativeCreate$1&&void 0===t?HASH_UNDEFINED$3:t,this}var _hashSet=hashSet$2,hashClear$1=_hashClear,hashDelete$1=_hashDelete,hashGet$1=_hashGet,hashHas$1=_hashHas,hashSet$1=_hashSet;function Hash$2(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Hash$2.prototype.clear=hashClear$1,Hash$2.prototype.delete=hashDelete$1,Hash$2.prototype.get=hashGet$1,Hash$2.prototype.has=hashHas$1,Hash$2.prototype.set=hashSet$1;var _Hash=Hash$2,Hash$1=_Hash,ListCache$1=_ListCache,Map$2=_Map;function mapCacheClear$2(){this.size=0,this.__data__={hash:new Hash$1,map:new(Map$2||ListCache$1),string:new Hash$1}}var _mapCacheClear=mapCacheClear$2;function isKeyable$2(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}var _isKeyable=isKeyable$2,isKeyable$1=_isKeyable;function getMapData$5(e,t){var r=e.__data__;return isKeyable$1(t)?r["string"==typeof t?"string":"hash"]:r.map}var _getMapData=getMapData$5,getMapData$4=_getMapData;function mapCacheDelete$2(e){var t=getMapData$4(this,e).delete(e);return this.size-=t?1:0,t}var _mapCacheDelete=mapCacheDelete$2,getMapData$3=_getMapData;function mapCacheGet$2(e){return getMapData$3(this,e).get(e)}var _mapCacheGet=mapCacheGet$2,getMapData$2=_getMapData;function mapCacheHas$2(e){return getMapData$2(this,e).has(e)}var _mapCacheHas=mapCacheHas$2,getMapData$1=_getMapData;function mapCacheSet$2(e,t){var r=getMapData$1(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var _mapCacheSet=mapCacheSet$2,mapCacheClear$1=_mapCacheClear,mapCacheDelete$1=_mapCacheDelete,mapCacheGet$1=_mapCacheGet,mapCacheHas$1=_mapCacheHas,mapCacheSet$1=_mapCacheSet;function MapCache$2(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}MapCache$2.prototype.clear=mapCacheClear$1,MapCache$2.prototype.delete=mapCacheDelete$1,MapCache$2.prototype.get=mapCacheGet$1,MapCache$2.prototype.has=mapCacheHas$1,MapCache$2.prototype.set=mapCacheSet$1;var _MapCache=MapCache$2;function arrayMap$5(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}var _arrayMap=arrayMap$5,isArray$7=isArray_1,isSymbol$4=isSymbol_1,reIsDeepProp$1=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp$1=/^\w*$/;function isKey$3(e,t){if(isArray$7(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!isSymbol$4(e))||(reIsPlainProp$1.test(e)||!reIsDeepProp$1.test(e)||null!=t&&e in Object(t))}var _isKey=isKey$3,MapCache$1=_MapCache,FUNC_ERROR_TEXT$6="Expected a function";function memoize$3(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT$6);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(memoize$3.Cache||MapCache$1),r}memoize$3.Cache=MapCache$1;var memoize_1=memoize$3,memoize$2=memoize_1,MAX_MEMOIZE_SIZE$1=500;function memoizeCapped$2(e){var t=memoize$2(e,(function(e){return r.size===MAX_MEMOIZE_SIZE$1&&r.clear(),e})),r=t.cache;return t}var _memoizeCapped=memoizeCapped$2,memoizeCapped$1=_memoizeCapped,rePropName$1=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar$1=/\\(\\)?/g,stringToPath$2=memoizeCapped$1((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(rePropName$1,(function(e,r,n,o){t.push(n?o.replace(reEscapeChar$1,"$1"):r||e)})),t})),_stringToPath=stringToPath$2,Symbol$1$1=_Symbol,arrayMap$4=_arrayMap,isArray$6=isArray_1,isSymbol$3=isSymbol_1,INFINITY$4=1/0,symbolProto$3=Symbol$1$1?Symbol$1$1.prototype:void 0,symbolToString$1=symbolProto$3?symbolProto$3.toString:void 0;function baseToString$2(e){if("string"==typeof e)return e;if(isArray$6(e))return arrayMap$4(e,baseToString$2)+"";if(isSymbol$3(e))return symbolToString$1?symbolToString$1.call(e):"";var t=e+"";return"0"==t&&1/e==-INFINITY$4?"-0":t}var _baseToString=baseToString$2,baseToString$1=_baseToString;function toString$4(e){return null==e?"":baseToString$1(e)}var toString_1=toString$4;getDefaultExportFromCjs(toString_1);var isArray$5=isArray_1,isKey$2=_isKey,stringToPath$1=_stringToPath,toString$3=toString_1;function castPath$4(e,t){return isArray$5(e)?e:isKey$2(e,t)?[e]:stringToPath$1(toString$3(e))}var _castPath=castPath$4,isSymbol$2=isSymbol_1,INFINITY$3=1/0;function toKey$4(e){if("string"==typeof e||isSymbol$2(e))return e;var t=e+"";return"0"==t&&1/e==-INFINITY$3?"-0":t}var _toKey=toKey$4,castPath$3=_castPath,toKey$3=_toKey;function baseGet$2(e,t){for(var r=0,n=(t=castPath$3(t,e)).length;null!=e&&r<n;)e=e[toKey$3(t[r++])];return r&&r==n?e:void 0}var _baseGet=baseGet$2,baseGet$1=_baseGet;function get$3(e,t,r){var n=null==e?void 0:baseGet$1(e,t);return void 0===n?r:n}var get_1=get$3;const get$1$2=getDefaultExportFromCjs(get_1);var castPath$2=_castPath,isArguments$1=isArguments_1,isArray$4=isArray_1,isIndex$3=_isIndex,isLength$2=isLength_1,toKey$2=_toKey;function hasPath$2(e,t,r){for(var n=-1,o=(t=castPath$2(t,e)).length,i=!1;++n<o;){var a=toKey$2(t[n]);if(!(i=null!=e&&r(e,a)))break;e=e[a]}return i||++n!=o?i:!!(o=null==e?0:e.length)&&isLength$2(o)&&isIndex$3(a,o)&&(isArray$4(e)||isArguments$1(e))}var _hasPath=hasPath$2,assignValue$1=_assignValue,castPath$1=_castPath,isIndex$2=_isIndex,isObject$6=isObject_1,toKey$1=_toKey;function baseSet$2(e,t,r,n){if(!isObject$6(e))return e;for(var o=-1,i=(t=castPath$1(t,e)).length,a=i-1,s=e;null!=s&&++o<i;){var l=toKey$1(t[o]),c=r;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(o!=a){var u=s[l];void 0===(c=n?n(u,l,s):void 0)&&(c=isObject$6(u)?u:isIndex$2(t[o+1])?[]:{})}assignValue$1(s,l,c),s=s[l]}return e}var _baseSet=baseSet$2,baseSet$1=_baseSet;function set$2(e,t,r){return null==e?e:baseSet$1(e,t,r)}var set_1=set$2;const set$1$1=getDefaultExportFromCjs(set_1);var ArrowCenterPlacementAlignMap={"top-left":{points:["bl","tc"]},"left-top":{points:["tr","cl"]},"top-right":{points:["br","tc"]},"right-top":{points:["tl","cr"]},"bottom-right":{points:["tr","bc"]},"right-bottom":{points:["bl","cr"]},"bottom-left":{points:["tl","bc"]},"left-bottom":{points:["br","cl"]}},getPlacements=function(e){var t=e.offset,r=e.arrowPointAtCenter,n=e.autoAdjustOverflow,o=void 0===n||n,i=e.arrowWidth,a=void 0===i?12:i,s=e.dropdownArrowOffset,l=void 0===s?8:s,c={targetOffset:[0,0],overflow:o?{adjustX:!0,adjustY:!0,alwaysByViewport:!0}:{adjustX:!1,adjustY:!1,alwaysByViewport:!1}},u={left:Object.assign(Object.assign({},c),{points:["cr","cl"],offset:[-t,0]}),right:Object.assign(Object.assign({},c),{points:["cl","cr"],offset:[t,0]}),top:Object.assign(Object.assign({},c),{points:["bc","tc"],offset:[0,-t]}),bottom:Object.assign(Object.assign({},c),{points:["tc","bc"],offset:[0,t]}),"top-left":Object.assign(Object.assign({},c),{points:["bl","tl"],offset:[0,-t]}),"left-top":Object.assign(Object.assign({},c),{points:["tr","tl"],offset:[-t,0]}),"top-right":Object.assign(Object.assign({},c),{points:["br","tr"],offset:[0,-t]}),"right-top":Object.assign(Object.assign({},c),{points:["tl","tr"],offset:[t,0]}),"bottom-right":Object.assign(Object.assign({},c),{points:["tr","br"],offset:[0,t]}),"right-bottom":Object.assign(Object.assign({},c),{points:["bl","br"],offset:[t,0]}),"bottom-left":Object.assign(Object.assign({},c),{points:["tl","bl"],offset:[0,t]}),"left-bottom":Object.assign(Object.assign({},c),{points:["br","bl"],offset:[-t,0]})};return r&&each$1$1(u,(function(e,t){ArrowCenterPlacementAlignMap[t]&&assign$1$1(e,ArrowCenterPlacementAlignMap[t]);var r=a/2;switch(t){case"top-left":case"bottom-left":set$1$1(e.offset,"0",-l-r);break;case"top-right":case"bottom-right":set$1$1(e.offset,"0",l+r);break;case"left-top":case"right-top":set$1$1(e.offset,"1",-l-r);break;case"left-bottom":case"right-bottom":set$1$1(e.offset,"1",l+r)}})),u},ARROW_OFFSET=10,NO_ARROW_OFFSET=4,placements=getPlacements({offset:ARROW_OFFSET});getPlacements({offset:NO_ARROW_OFFSET});var objectProto$j=Object.prototype,hasOwnProperty$h=objectProto$j.hasOwnProperty;function baseHas$1(e,t){return null!=e&&hasOwnProperty$h.call(e,t)}var _baseHas=baseHas$1,baseHas=_baseHas,hasPath$1=_hasPath;function has(e,t){return null!=e&&hasPath$1(e,t,baseHas)}var has_1=has;const has$1=getDefaultExportFromCjs(has_1);function isNil$1(e){return null==e}var isNil_1=isNil$1;const isNil$1$1=getDefaultExportFromCjs(isNil_1);!function(){function e(){_classCallCheck$2C(this,e)}_createClass$2C(e,null,[{key:"getPlacementTransitionName",value:function(e,t){if(!e)return"";switch(t){case"top-left":case"top":case"top-right":return"".concat(e,"-top");case"right-top":case"right":case"right-bottom":return"".concat(e,"-right");case"bottom-right":case"bottom":case"bottom-left":return"".concat(e,"-bottom");case"left-bottom":case"left":case"left-top":return"".concat(e,"-left");default:return""}}},{key:"isPointsEq",value:function(e,t){return e[0]===t[0]&&e[1]===t[1]}},{key:"getPlacementFromAlign",value:function(e,t){if(!e)return"bottom";for(var r=e.points,n=t||placements,o=0,i=Object.keys(n);o<i.length;o++){var a=i[o];if(this.isPointsEq(n[a].points,r))return a}return"bottom"}},{key:"is0xColor",value:function(e){return/^#[0-9A-F]{6}$/i.test(e)}},{key:"isDarkColor",value:function(e,t,r){return.299*e+.578*t+.114*r<192}},{key:"hexToRgbJson",value:function(e){if(!this.is0xColor(e))return{};for(var t=[],r=1;r<7;r+=2)t.push(parseInt("0x"+e.slice(r,r+2),16));return{r:t[0],g:t[1],b:t[2]}}},{key:"isObjectEmpty",value:function(e){if(isNil$1$1(e))return!0;if(e.length>0)return!1;if(0===e.length)return!0;for(var t in e)if(has$1(e,t))return!1;return isNaN(e)}}])}();var isStringEmpty=function(e){return""===e||isNil$1$1(e)},bound01=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,r=Math.min(t,Math.max(e,0));return Math.abs(r-t)<1e-6?1:r%t/parseFloat(t.toString())},hex2rgb$1=function(e){if(!/^#[0-9a-fA-F]{6}$/.test(e))return{};for(var t=[],r=1;r<7;r+=2)t.push(parseInt("0x"+e.slice(r,r+2),16));return{r:t[0],g:t[1],b:t[2]}},rgb2hex=function(e,t,r){return("#"+(Math.pow(2,24)+e*Math.pow(2,16)+t*Math.pow(2,8)+r).toString(16).slice(1)).toUpperCase()},rgb2hsv=function(e,t,r){var n=bound01(e,255),o=bound01(t,255),i=bound01(r,255),a=Math.max(n,o,i),s=Math.min(n,o,i),l=0,c=a,u=a-s,d=0===a?0:u/a;if(a!==s){switch(a){case n:l=(o-i)/u+(o<i?6:0);break;case o:l=(i-n)/u+2;break;case i:l=(n-o)/u+4}l/=6}return{h:Math.round(360*l),s:Math.round(100*d),v:Math.round(100*c)}},hsv2rgb=function(e,t,r){var n=6*bound01(e,360),o=bound01(t,100),i=bound01(r,100),a=Math.floor(n),s=n-a,l=i*(1-o),c=i*(1-s*o),u=i*(1-(1-s)*o),d=a%6,h=[i,c,l,l,u,i][d],p=[u,i,i,c,l,l][d],f=[l,l,u,i,i,c][d];return{r:Math.round(255*h),g:Math.round(255*p),b:Math.round(255*f)}},hex2RGBAStr=function(e,t){if(1===t||isStringEmpty(t))return e;var r=hex2rgb$1(e);return"rgba(".concat(r.r,", ").concat(r.g,", ").concat(r.b,", ").concat(t,")")},SVPanel=function(e){var t=e.hue,r=e.sat,n=e.val,o=e.onChange,i=e.panelWidth,a=void 0===i?140:i,s=e.panelHeight,l=void 0===s?109:s,c=e.style,u=reactExports.useRef(null),d=_slicedToArray$2(reactExports.useState(!1),2),h=d[0],p=d[1],f=hsv2rgb(t,100,100),g=reactExports.useMemo((function(){var e=Math.round(r/100*a),t=Math.round((1-n/100)*l);return e=Math.max(0,e),e=Math.min(a,e),t=Math.max(0,t),{left:e,top:t=Math.min(l,t)}}),[r,n]),m=usePrefixCls("sv-panel"),y=reactExports.useCallback((function(e){h&&_(e)}),[h]),v=function(){p(!1)};reactExports.useEffect((function(){if(u.current)return document.addEventListener("mouseup",v),document.addEventListener("mousemove",y),function(){document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",v)}}),[y]);var _=function(e){if(u.current){var t=e.clientX-u.current.getBoundingClientRect().left,r=e.clientY-u.current.getBoundingClientRect().top,n=Math.round(t/a*100),i=Math.round(100*(1-r/l));o&&o(n,i)}};return React.createElement("div",{ref:u,className:m,style:Object.assign({width:a,height:l,backgroundColor:"rgb(".concat(f.r,", ").concat(f.g,", ").concat(f.b,")")},c),onMouseDown:function(e){h||(_(e),p(!0))}},React.createElement("div",{className:"".concat(m,"-white")}),React.createElement("div",{className:"".concat(m,"-black")}),React.createElement("div",{className:"".concat(m,"-cursor"),style:{left:g.left,top:g.top}},React.createElement("div",null)))};function _defineProperty$1(e,t,r){return(t=_toPropertyKey$2x(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var attributes="accept acceptCharset accessKey action allowFullScreen allowTransparency\n    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge\n    charSet checked classID className colSpan cols content contentEditable contextMenu\n    controls coords crossOrigin data dateTime default defer dir disabled download draggable\n    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder\n    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity\n    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media\n    mediaGroup method min minLength multiple muted name noValidate nonce open\n    optimum pattern placeholder poster preload radioGroup readOnly rel required\n    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected\n    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style\n    summary tabIndex target title type useMap value width wmode wrap",eventsName="onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown\n    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick\n    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown\n    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel\n    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough\n    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata\n    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError",propList="".concat(attributes," ").concat(eventsName).split(/[\s\n]+/),ariaPrefix="aria-",dataPrefix="data-";function match(e,t){return 0===e.indexOf(t)}function pickAttrs(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t=!1===r?{aria:!0,data:!0,attr:!0}:!0===r?{aria:!0}:Object.assign({},r);var n={};return Object.keys(e).forEach((function(r){(t.aria&&("role"===r||match(r,ariaPrefix))||t.data&&match(r,dataPrefix)||t.attr&&propList.includes(r))&&assign$1$1(n,_defineProperty$1({},r,get$1$2(e,r)))})),n}const isSupportEyeDropper="EyeDropper"in window;function EyeDropper(e){return jsxRuntimeExports.jsx(SvgIcon,{style:{fontSize:16},icon:EyeDropperIcon,onClick:()=>{if("EyeDropper"in window){(new window.EyeDropper).open().then((t=>{var r;null==(r=e.onPickColor)||r.call(e,t.sRGBHex)}))}}})}var LocaleContext=reactExports.createContext({locale:zh_CN$1}),useLocale=function(e){var t=React.useContext(LocaleContext).locale;return[React.useMemo((function(){var r,n=zh_CN$1[e],o=null!==(r=null==t?void 0:t[e])&&void 0!==r?r:{};return Object.assign(Object.assign({},n),o||{})}),[e,t])]},useGlobalComponentConfig=function(e){var t;return null===(t=React.useContext(ConfigProviderContext))||void 0===t?void 0:t[e]};const checkAlphaValid=e=>e&&/^(\d|[1-9]\d|100)$/.test(e),checkRgbItemValid=e=>e&&/^(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])$/.test(e),checkColorValid=e=>e&&/^#([0-9a-fA-F]{6})$/.test(e),padColor=e=>{if(4===e.length){let t=e.charAt(0);for(let r=1;r<4;r++)t+=e.charAt(r)+e.charAt(r);return t}return e},getDefaultColor=e=>checkColorValid(e)?padColor(e):COLOR.white,checkOpacityValid=e=>!isNil$1$1(e)&&e>=0&&e<=1,getDefaultOpacity=e=>checkOpacityValid(e)?e:1,opacity2alpha=e=>isNil$1$1(e)?"":String(Math.round(100*e)),alpha2opacity=e=>e?Number(e)/100:0,hexAlpha2opacity=e=>parseInt(e,16)/255,getNumInRange=(e,t,r=0)=>Math.min(t,Math.max(r,e)),SLIDER_WIDTH=isSupportEyeDropper?162:192,PANEL_WIDTH=234,PANEL_HEIGHT=160,HEX_ALPHA_EDGE=7,ColorPicker=e=>{const{className:t,style:r,id:n,hasOpacity:o,presets:i,onChange:a,prefixCls:s}=e,[l]=useLocale("colorPicker"),c=getDefaultOpacity(e.opacity),u=opacity2alpha(c),d=getDefaultColor(e.color),h=hex2rgb$1(d),[p,f]=reactExports.useState(d),[g,m]=reactExports.useState(alpha2opacity(u)),[y,v]=reactExports.useState(rgb2hsv(h.r,h.g,h.b)),[_,b]=reactExports.useState(d),[C,E]=reactExports.useState(h),[T,S]=reactExports.useState(c),[P,w]=reactExports.useState(u),x=useGlobalComponentConfig("colorPicker"),O=usePrefixCls("color-picker",s),$=e=>{const{color:t=p,opacity:r=g}=e;a&&(o?a(t,r):a(t))},I=e=>{const{hue:t=y.h,sat:r=y.s,val:n=y.v}=e;v({h:t,s:r,v:n});const o=hsv2rgb(t,r,n);E(o);const i=rgb2hex(o.r,o.g,o.b);b(i),checkColorValid(i)&&(f(i),$({color:i}))},R=e=>{S(e);const t=opacity2alpha(getNumInRange(e,1));w(t);const r=alpha2opacity(t);return checkOpacityValid(r)?(m(r),r):null},A=e=>{let t,r=e,n=1;if(9===e.length&&(r=e.substring(0,HEX_ALPHA_EDGE),n=hexAlpha2opacity(e.substring(HEX_ALPHA_EDGE)),t=R(n)),b(r),checkColorValid(r)){const e=padColor(r);f(e);const n=hex2rgb$1(e);E(n),v(rgb2hsv(n.r,n.g,n.b)),$({color:e,opacity:t?g:void 0})}},D=e=>{const{r:t=C.r,g:r=C.g,b:n=C.b}=e;if(E({r:t,g:r,b:n}),has$1(e,"r")&&checkRgbItemValid(t)||has$1(e,"g")&&checkRgbItemValid(r)||has$1(e,"b")&&checkRgbItemValid(n)){const e=rgb2hsv(Number(t),Number(r),Number(n));v(e);const o=rgb2hex(Number(t),Number(r),Number(n));b(o),checkColorValid(o)&&(f(o),$({color:o}))}},L=e=>{const{r:t=C.r,g:r=C.g,b:n=C.b}=e;if(has$1(e,"r")&&!checkRgbItemValid(t)){const e=getNumInRange(parseInt(t,10)||0,255);E({r:String(e),g:r,b:n});const o=rgb2hsv(e,Number(r),Number(n));v(o);const i=rgb2hex(e,Number(r),Number(n));b(i),checkColorValid(i)&&(f(i),$({color:i}))}else if(has$1(e,"g")&&!checkRgbItemValid(r)){const e=getNumInRange(parseInt(r,10)||0,255);E({r:t,g:String(e),b:n});const o=rgb2hsv(Number(t),e,Number(n));v(o);const i=rgb2hex(Number(t),e,Number(n));b(i),checkColorValid(i)&&(f(i),$({color:i}))}else if(has$1(e,"b")&&!checkRgbItemValid(n)){const e=getNumInRange(parseInt(n,10)||0,255);E({r:t,g:r,b:String(e)});const o=rgb2hsv(Number(t),Number(r),e);v(o);const i=rgb2hex(Number(t),Number(r),e);b(i),checkColorValid(i)&&(f(i),$({color:i}))}},N=(e,t,r)=>{const{className:n,...o}=r;return jsxRuntimeExports.jsxs("div",{className:"region-wrapper",children:[jsxRuntimeExports.jsx("span",{className:"region-title",children:e}),jsxRuntimeExports.jsx(Input$3,{className:classNames$1("region-input",n),...o},t)]})},M={...null==x?void 0:x.style,...r};return jsxRuntimeExports.jsxs("div",{className:classNames$1(O,{"without-opacity":!o},t,null==x?void 0:x.className),style:M,id:n,...pickAttrs(e,{aria:!0,data:!0}),children:[jsxRuntimeExports.jsx("div",{className:"header-wrapper",children:jsxRuntimeExports.jsx(SVPanel,{sat:y.s,val:y.v,hue:y.h,onChange:(e,t)=>I({sat:e,val:t}),panelWidth:PANEL_WIDTH,panelHeight:PANEL_HEIGHT})}),jsxRuntimeExports.jsxs("div",{className:"main-wrapper",children:[jsxRuntimeExports.jsxs("div",{className:"main-left",children:[jsxRuntimeExports.jsx("div",{className:"color-value-bg"}),jsxRuntimeExports.jsx("div",{className:"color-value",style:{backgroundColor:hex2RGBAStr(p,g)}})]}),jsxRuntimeExports.jsxs("div",{className:"main-right",children:[jsxRuntimeExports.jsx(HueSlider,{value:p,hue:y.h,onChange:e=>I({hue:e}),sliderWidth:SLIDER_WIDTH}),o&&jsxRuntimeExports.jsx(OpacitySlider,{color:p,opacity:T,onChange:e=>{const t=R(e);isNil$1$1(t)||$({opacity:t})},sliderWidth:SLIDER_WIDTH})]}),isSupportEyeDropper?jsxRuntimeExports.jsx("div",{style:{width:30,display:"flex",justifyContent:"center",alignItems:"center"},children:jsxRuntimeExports.jsx(EyeDropper,{onPickColor:A})}):null]}),jsxRuntimeExports.jsxs("div",{className:"footer-wrapper",children:[N("HEX","hex",{className:"color-input hex-input",value:_?_.substring(1):"",size:"small",maxLength:o?8:6,onChange:e=>A("#"+e)}),jsxRuntimeExports.jsx(Divider,{className:"region-divider",direction:"vertical"}),N("R","rgb-r",{className:"color-input rgb-input r-input",value:C.r,size:"small",type:"number",onChange:e=>D({r:e}),onBlur:e=>L({r:e})}),N("G","rgb-g",{className:"color-input rgb-input g-input",value:C.g,size:"small",type:"number",onChange:e=>D({g:e}),onBlur:e=>L({g:e})}),N("B","rgb-b",{className:"color-input rgb-input b-input",value:C.b,size:"small",type:"number",onChange:e=>D({b:e}),onBlur:e=>L({b:e})}),o?N(l.alpha,"alpha",{className:"color-input alpha-input",value:P,size:"small",type:"number",suffix:jsxRuntimeExports.jsx("span",{children:"%"}),onChange:e=>{if(w(e),checkAlphaValid(e)){const t=alpha2opacity(e);S(t),checkOpacityValid(t)&&(m(t),$({opacity:t}))}},onBlur:e=>{if(!checkAlphaValid(e)){const t=getNumInRange(parseInt(e,10)||0,100),r=String(t);w(r);const n=alpha2opacity(r);S(n),checkOpacityValid(n)&&(m(n),$({opacity:n}))}}}):null]}),i?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Divider,{className:"extra-divider"}),jsxRuntimeExports.jsx("div",{className:"extra-wrapper",children:jsxRuntimeExports.jsx(Collapse$1,{size:"small",ghost:!0,items:i.map(((e,t)=>{var r;return{key:t,label:e.label,children:(null==(r=e.colors)?void 0:r.length)>1?jsxRuntimeExports.jsx("div",{className:"color-region",style:{maxWidth:PANEL_WIDTH},children:e.colors.map(((e,t)=>jsxRuntimeExports.jsxs("div",{className:"color-square",onClick:()=>{A(e)},children:[jsxRuntimeExports.jsx("div",{className:"color-value-bg"}),jsxRuntimeExports.jsx("div",{className:"color-value",style:{backgroundColor:e}})]},t)))}):jsxRuntimeExports.jsx("span",{className:"no-message",children:l.noMessage})}}))})})]}):null]})},Sketch=({color:e,onChange:t,onCompleteChange:r=()=>{},...n})=>{let o=1,i=e;9===(null==e?void 0:e.length)&&(i=e.substring(0,HEX_ALPHA_EDGE),o=hexAlpha2opacity(e.substring(HEX_ALPHA_EDGE)));const a=useDebounceFn$1(r,{wait:100});return jsxRuntimeExports.jsx(ColorPicker,{hasOpacity:!0,opacity:o,color:i,onChange:(e,r=1)=>{var n;const o="".concat(e).concat(Math.round(255*r).toString(16)).toUpperCase();null==t||t(o),null==(n=a.run)||n.call(a,o)},...n})};function replace(){var e=arguments,t=toString$5(e[0]);return e.length<3?t:t.replace(e[1],e[2])}const EMPTY$1=Symbol(),createContainer=e=>{const t=React.createContext(EMPTY$1),r=replace(e.name,"use","");t.displayName=r;return{Provider:r=>{const n=e(r.initialState);return jsxRuntimeExports.jsx(t.Provider,{value:n,children:r.children})},useContainer:()=>{const e=React.useContext(t);if(e===EMPTY$1)throw new Error("Component must be wrapped with <Container.Provider>");return e}}},MARK_KEY="fd-biz-theme-key",getContainer=()=>document.querySelector("head")||document.body,injectCSS=(e,t)=>{const r=document.createElement("style");r.innerHTML=e;return(t||getContainer()).appendChild(r),r},containerCache=new Map,findExistNode=(e,t)=>{const r=t||getContainer(),n=containerCache.get(r);return n?Array.from(n.children).find((t=>"STYLE"===t.tagName&&t.getAttribute(MARK_KEY)===e)):null},updateCSS=(e,t,r)=>{const n=r||getContainer();if(!containerCache.has(n)){const e=injectCSS("",n),{parentNode:t}=e;containerCache.set(n,t),t.removeChild(e)}const o=findExistNode(t,n);if(o)return o.innerHTML!==e&&(o.innerHTML=e),o;const i=injectCSS(e,n);return i.setAttribute(MARK_KEY,t),i},dynamicStyleMark="-fd-biz-".concat(Date.now(),"-").concat(Math.random()),getStyle=e=>{const t={};let r="";forEach$2(null==e?void 0:e.token,((r,n)=>{forEach$2(r,((r,o)=>{t["".concat(e.prefixKey,"-").concat(o+1,"-").concat(n+1)]=r}))}));const n=Object.keys(t).map((e=>"".concat(e,": ").concat(t[e],";"))),o=(null==e?void 0:e.scope)||":root";return r+="".concat(o," {").concat(n.join(""),"}").trim(),r},registerTheme=e=>{const t=getStyle(e);updateCSS(t,"".concat(dynamicStyleMark,"-dynamic-theme").concat(e.dynamicStyleClassName?"-".concat(e.dynamicStyleClassName):""),null==e?void 0:e.styleContainer)},BACKGROUND_COLOR_LINE_SEQ=1,TEXT_COLOR_LINE_SEQ=2,GROUP_COLOR_LINE_SEQ=3,useTheme=e=>{const[t]=useLocale$1("themeColor"),{token:r,prefixKey:n,...o}={scope:":root",prefixKey:"--fvs-theme-color",dynamicStyleClassName:"",cssVar:!0,token:["#000000","#FFFFFF","#0090AA","#75C9FF","#6E7AEB","#1853AC","#44C1C9","#EDDD86","#EFA666","#00B2FF"],presets:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2"],history:["#D0021B","#F5A623","#F8E71C","#8B572A"],fdScopeCls:"fvs-theme-scope",getThemeDefaultGroupColors:()=>Promise.resolve([{value:"preset_1",label:"春日花园",colors:["#63B2EE","#76DA91","#F8CB7F","#F89588","#7CD6CF","#9192AB","#7898E1","#EFA666"]},{value:"preset_2",label:"浪漫沙滩",colors:["#B2BF59","#F29D38","#ECD48D","#6EA740","#EBC582","#A57051","#75CD62","#F2D37F"]},{value:"preset_3",label:"忧郁森林",colors:["#5A8C8C","#BCBFA4","#F2D88D","#BFA288","#A98A61","#7E5F42","#D6C289","#594653"]},{value:"preset_4",label:"渐变色4",colors:["#5A8C8C","#BCBFA4"],gradient:!0},{value:"preset_5",label:"渐变色5",colors:["#A57051","#ECD48D"],gradient:!0}]),...e},i=formatTokenValue(r),a={...o,prefixKey:n,locale:t,sourceToken:r,token:i,formatThemeColor:formatThemeColor,getThemePureColor:e=>{if("string"!=typeof e)return e;if(!isThemeColor(n,e))return e;const t=formatThemeColor(e);return i[Number(t.col)-1][Number(t.row)-1]},getThemeColorText:e=>{if(!e)return"";if(!isThemeColor(n,e))return e;const r=formatThemeColor(e);switch(Number(r.col)){case BACKGROUND_COLOR_LINE_SEQ:return"".concat(t.backgroundColor).concat(1===Number(r.row)?"":Number(r.row)-1);case TEXT_COLOR_LINE_SEQ:return"".concat(t.textColor).concat(1===Number(r.row)?"":Number(r.row)-1);default:{const e=Number(r.col)-GROUP_COLOR_LINE_SEQ+1;return"".concat(t.groupColor).concat(1===Number(r.row)?e:"".concat(e,"-").concat(Number(r.row)-1))}}}};return reactExports.useEffect((()=>{registerTheme(a)}),[r]),a},ThemeContext=createContainer(useTheme),ColorPickerTrigger=({value:e,disabled:t=!1,colorViewId:r,popStyle:n,placement:o="bottom",children:i,onChange:a,onChangeComplete:s,disableAlpha:l=!1,onVisibleChange:c})=>{const u=reactExports.useRef(null),{fdScopeCls:d}=ThemeContext.useContainer();return jsxRuntimeExports.jsx(Popover$2,{trigger:"click",placement:o,content:t?null:jsxRuntimeExports.jsx("div",{className:"fd-biz-color-picker-sketch",tabIndex:-1,ref:u,children:jsxRuntimeExports.jsx(Sketch,{hasOpacity:!l,color:e,onChange:e=>{null==a||a(e)},onCompleteChange:e=>{null==s||s(e)}})}),style:{...n},autoAdjustOverflow:!0,hasPadding:!1,arrow:!1,className:d,onVisibleChange:e=>{var t;e&&(null==(t=u.current)||t.focus()),null==c||c(e)},children:i||jsxRuntimeExports.jsx("div",{className:classNames$1("fd-biz-color-picker-trigger",{disabled:t}),children:jsxRuntimeExports.jsx("div",{className:"view-btn-inner",style:{background:e}})})})};function parent$1(e,t){return t.length<2?e:baseGet$3(e,baseSlice$1(t,0,-1))}function baseUnset$1(e,t){return null==(e=parent$1(e,t=castPath$5(t,e)))||delete e[toKey$5(last$1(t))]}function customOmitClone(e){return isPlainObject(e)?void 0:e}function flatRest(e){return setToString$3(overRest$2(e,void 0,flatten),e+"")}var CLONE_DEEP_FLAG$3=1,CLONE_FLAT_FLAG$1=2,CLONE_SYMBOLS_FLAG$4=4,omit=flatRest((function(e,t){var r={};if(null==e)return r;var n=!1;t=arrayMap$6(t,(function(t){return t=castPath$5(t,e),n||(n=t.length>1),t})),copyObject$4(e,getAllKeysIn$2(e),r),n&&(r=baseClone$2(r,CLONE_DEEP_FLAG$3|CLONE_FLAT_FLAG$1|CLONE_SYMBOLS_FLAG$4,customOmitClone));for(var o=t.length;o--;)baseUnset$1(r,t[o]);return r}));const CHECKOUTLINE_ICON_SRC="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAAnCAYAAABAOmveAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAKdSURBVHgB1dnLbtpAFAbgAVyuIqECwaKbKosgsYBlq27zDEgEeIc8RbvPKyAgLHiFbKt0iSoWZJFtpQoQqrhfe36LiYhjsGOPJ/YvWb5MEvxl7NHMgTGPplarxfSu+5kHA4yiKN8bjcaNts3HPBaOocMLnO92u/tKpXLL2z3VQ4eYRCKRpe3S5/NdHfaUZ3pIi4nFYpe4PplMeqPR6JH3lCdAephMJsPG4zFAL1AB5vIcw2SzWZZOp9lwOMSPpQKBAFssFueufodOYRBqez6ORqMXfr9fcS3ICIPM53PW7XYx0q0Gg8HP7Xa7duU7ZBbT6XSwVzH0uP2jHmq6DmQHUyqVWq4C2cWg3TUgERjEENRsNq+xL5fLd8yhiMIgJ0F7zPX+9M4JlEgMcnTY5phQKHRO2xmOeW+5FXMUdIhJJpPfsIlGOYHRBWkxkUhECYfDH0SinMIgPiNMPp9X27R/nFl8p5zEIM89VK/XvwJDkzy1N2idoeRyOUa9o26FQoHZ7SmnMS9A1Wr1gX7xfrPZrKbT6ROu9Xo9tl6v1Xa7KBkY5NWw3Wq1bmiSd8U/lDYVgpntsQ9lBo+fLIwuSDRKJuYoSBRKNuYkyC7qPTCGIDso2r7IxiCGNYV2u/2rWCymZ7PZGQ3p+AcksY7Hep5uQIWlUilGNxUIBoOflsvlXxopUZH5KBtjCmQVFY/HP8vGIG9aD5l9/Ogm1XPZGORNZSyzPdXv99W9bAxiacVqpqcws+CRhUEsL8GNUDwyMYjluhzd0C1NYH9TCbZHpdhHlGRx43zuh8jGILYKjavV6gftnvRQ74FBbFd99GYEePz2KKkYREgZSw/Fy7MyMYiwupwWRUP7H9kYRGihUft1oWwMIrxyylGEeZCNQf4DXWz8pNP12Y4AAAAASUVORK5CYII=",ThemeColorPane=({value:e,onChange:t,disableAlpha:r=!1})=>{const{token:n,presets:o,history:i,prefixKey:a,cssVar:s,formatThemeColor:l,locale:c,getThemeColorText:u,onHistoryChange:d}=ThemeContext.useContainer(),h=isThemeColor(a,e),[p,f]=reactExports.useState("#FFFFFF"),[g,m]=reactExports.useState(""),[y,v]=reactExports.useState(!1);reactExports.useEffect((()=>{h?m(e):f(e)}),[e]);const _=(e=0,r=10)=>(null==i?void 0:i.length)?i.slice(e,r).map(((e,r)=>jsxRuntimeExports.jsx("div",{className:"color-line",children:jsxRuntimeExports.jsx("div",{className:"line-item",style:{background:e},onClick:()=>{f(e),null==t||t(e);const n=i.slice();n.unshift(...n.splice(r,1)),null==d||d(n)}})},r))):jsxRuntimeExports.jsx("div",{className:"empty-text",children:c.historyEmpty});return jsxRuntimeExports.jsxs("div",{className:"fd-biz-theme-color-pane",children:[jsxRuntimeExports.jsx("div",{className:"pane-label",children:c.themeColor}),jsxRuntimeExports.jsx("div",{className:"pane-colors",children:null==n?void 0:n.map(((e,r)=>{const n=l(g),o=h&&"1"===n.row&&n.col==="".concat(r+1),i="".concat(a,"-1-").concat(r+1);return jsxRuntimeExports.jsx("div",{className:"color-line",children:jsxRuntimeExports.jsx(Tooltip,{content:u(i),placement:"top",arrow:!1,children:jsxRuntimeExports.jsx("div",{className:classNames$1("line-item",{selected:o}),style:{background:e[0]},onClick:()=>{null==t||t(s?"var(".concat(i,")"):i),f(e[0])},children:jsxRuntimeExports.jsx("div",{className:"item-icon",style:{backgroundImage:"url(".concat(CHECKOUTLINE_ICON_SRC,")")}})},r)})},r)}))}),jsxRuntimeExports.jsx(Divider,{style:{margin:0}}),jsxRuntimeExports.jsx("div",{className:"pane-colors",children:null==n?void 0:n.map(((e,r)=>jsxRuntimeExports.jsx("div",{className:"color-line",children:e.map(((e,n)=>{if(0===n)return null;const o=l(g),i=h&&o.row==="".concat(n+1)&&o.col==="".concat(r+1),c="".concat(a,"-").concat(n+1,"-").concat(r+1);return jsxRuntimeExports.jsx(Tooltip,{content:u(c),placement:"top",arrow:!1,children:jsxRuntimeExports.jsx("div",{className:classNames$1("line-item",{selected:i}),style:{background:e},onClick:()=>{null==t||t(s?"var(".concat(c,")"):c),f(e)},children:jsxRuntimeExports.jsx("div",{className:"item-icon",style:{backgroundImage:"url(".concat(CHECKOUTLINE_ICON_SRC,")")}})},n)},n)}))},r)))}),jsxRuntimeExports.jsx("div",{className:"pane-label custom-label",children:c.presetColor}),jsxRuntimeExports.jsx("div",{className:"pane-colors",children:null==o?void 0:o.map(((e,r)=>jsxRuntimeExports.jsx(Tooltip,{content:c.presetColor+"".concat(r+1),placement:"top",arrow:!1,children:jsxRuntimeExports.jsx("div",{className:"color-line",children:jsxRuntimeExports.jsx("div",{className:"line-item",style:{background:e},onClick:()=>{f(e),null==t||t(e)}})},r)},r)))}),jsxRuntimeExports.jsx("div",{className:"pane-label custom-label",children:c.historyColor}),jsxRuntimeExports.jsx("div",{className:"pane-colors",children:_()}),i.length>10&&jsxRuntimeExports.jsx("div",{className:"pane-colors",children:_(10,20)}),jsxRuntimeExports.jsx("div",{className:"pane-label text-label custom-label",children:jsxRuntimeExports.jsx(ColorPickerTrigger,{value:p,placement:"left",onChange:f,onChangeComplete:e=>{f(e),null==t||t(e),v(!0)},disableAlpha:r,onVisibleChange:e=>{e?v(!1):y&&(null==d||d(Array.from(new Set([p,...i]))))},children:jsxRuntimeExports.jsxs("span",{className:"label-text clickable",children:[jsxRuntimeExports.jsx("span",{className:"label-icon",children:jsxRuntimeExports.jsx(SvgIcon,{icon:ArtboardIcon})}),jsxRuntimeExports.jsx("span",{children:c.moreColor})]})})})]})},ThemeColorPickerTrigger=({value:e,disabled:t=!1,popStyle:r,contentWidth:n=256,placement:o="bottom-left",onChange:i,disableAlpha:a=!1,children:s,useThemeColor:l=!0,onPopupVisibleChange:c})=>{const{onThemeColorChangeHooks:u,prefixKey:d,getThemePureColor:h,fdScopeCls:p}=ThemeContext.useContainer(),[f,g]=reactExports.useState(e);return jsxRuntimeExports.jsx(Popover$2,{trigger:"click",placement:o,content:t?null:l?jsxRuntimeExports.jsx(ThemeColorPane,{value:e,onChange:i,disableAlpha:a}):jsxRuntimeExports.jsx(Sketch,{hasOpacity:!a,color:f,onChange:e=>{g(e)},onCompleteChange:e=>{g(e),null==i||i(e)}}),style:{width:n+(l?20:0),...r},autoAdjustOverflow:!0,hasPadding:!1,arrow:!1,className:p,onVisibleChange:t=>{var r;null==c||c(t),t||null==(r=null==u?void 0:u.onThemeColorChangeComplete)||r.call(u,e,isThemeColor(d,e))},children:s||jsxRuntimeExports.jsx("div",{className:classNames$1("fd-biz-theme-view-btn-inner",{disabled:t}),style:{background:h(e)}})})},ThemeColorPicker=({value:e,disabled:t=!1,colorViewId:r,popStyle:n,contentWidth:o=256,placement:i="bottom-left",onChange:a,disableAlpha:s=!1,useThemeColor:l=!0,colorInputId:c,style:u,...d})=>{const{getThemeColorText:h,prefixKey:p}=ThemeContext.useContainer(),f=h(e),g=!isThemeColor(p,e),[m,y]=useUpdateValue(e,[e]);return jsxRuntimeExports.jsxs("div",{className:classNames$1("fd-biz-theme-color-picker-trigger",{disabled:t,"input-mode":g}),style:u,children:[jsxRuntimeExports.jsx("div",{className:"view-btn",children:jsxRuntimeExports.jsx(ThemeColorPickerTrigger,{value:e,placement:i,onChange:a,popStyle:n,contentWidth:o,disableAlpha:s,useThemeColor:l,disabled:t})}),jsxRuntimeExports.jsx("div",{className:"view-btn-text",title:f,children:g?jsxRuntimeExports.jsx(Input$3,{value:m,disabled:t,className:"color-value",...omit(d,["style"]),onChange:e=>{y(null==e?void 0:e.toLocaleUpperCase())},onBlur:t=>{const r=null==t?void 0:t.toLocaleUpperCase();y(r),r!==e&&(null==a||a(r))}}):jsxRuntimeExports.jsx("div",{children:f})})]})};function getSearchResult(e,t,r="text"){const n=isArray$b(e);e=n?flatten(e):e;const o=n?[]:{},i=n?[]:{};return isKey$4(t)?(t=toUpperCase(t),e.forEach(((e,a)=>{if(isNil$2(e))return;const s=stripEL(e),l=[s[r],s.text,s.value,s.name,s].find(isNotNull);if(isNil$2(l)||isObject$d(l))return;const c=makeFirstPY(l,{splitChar:"​"}),u=toUpperCase(l),d=toUpperCase(c).indexOf(t);u.indexOf(t)>-1?u===t?n?o.push(e):o[a]=e:n?i.push(e):i[a]=e:d>-1&&(u===t||t.length===u.length?n?o.push(e):o[a]=e:n?i.push(e):i[a]=e)})),{match:o,find:i}):{find:e,match:o}}var DP=20,RM=1,MAX_DP=1e6,MAX_POWER=1e6,NE=-7,PE=21,STRICT=!1,NAME="[big.js] ",INVALID=NAME+"Invalid ",INVALID_DP=INVALID+"decimal places",INVALID_RM=INVALID+"rounding mode",DIV_BY_ZERO=NAME+"Division by zero",P$3={},UNDEFINED=void 0,NUMERIC=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function _Big_(){function e(t){var r=this;if(!(r instanceof e))return t===UNDEFINED?_Big_():new e(t);if(t instanceof e)r.s=t.s,r.e=t.e,r.c=t.c.slice();else{if("string"!=typeof t){if(!0===e.strict&&"bigint"!=typeof t)throw TypeError(INVALID+"value");t=0===t&&1/t<0?"-0":String(t)}parse$1(r,t)}r.constructor=e}return e.prototype=P$3,e.DP=DP,e.RM=RM,e.NE=NE,e.PE=PE,e.strict=STRICT,e.roundDown=0,e.roundHalfUp=1,e.roundHalfEven=2,e.roundUp=3,e}function parse$1(e,t){var r,n,o;if(!NUMERIC.test(t))throw Error(INVALID+"number");for(e.s="-"==t.charAt(0)?(t=t.slice(1),-1):1,(r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),o=t.length,n=0;n<o&&"0"==t.charAt(n);)++n;if(n==o)e.c=[e.e=0];else{for(;o>0&&"0"==t.charAt(--o););for(e.e=r-n-1,e.c=[],r=0;n<=o;)e.c[r++]=+t.charAt(n++)}return e}function round$2(e,t,r,n){var o=e.c;if(r===UNDEFINED&&(r=e.constructor.RM),0!==r&&1!==r&&2!==r&&3!==r)throw Error(INVALID_RM);if(t<1)n=3===r&&(n||!!o[0])||0===t&&(1===r&&o[0]>=5||2===r&&(o[0]>5||5===o[0]&&(n||o[1]!==UNDEFINED))),o.length=1,n?(e.e=e.e-t+1,o[0]=1):o[0]=e.e=0;else if(t<o.length){if(n=1===r&&o[t]>=5||2===r&&(o[t]>5||5===o[t]&&(n||o[t+1]!==UNDEFINED||1&o[t-1]))||3===r&&(n||!!o[0]),o.length=t,n)for(;++o[--t]>9;)if(o[t]=0,0===t){++e.e,o.unshift(1);break}for(t=o.length;!o[--t];)o.pop()}return e}function stringify(e,t,r){var n=e.e,o=e.c.join(""),i=o.length;if(t)o=o.charAt(0)+(i>1?"."+o.slice(1):"")+(n<0?"e":"e+")+n;else if(n<0){for(;++n;)o="0"+o;o="0."+o}else if(n>0)if(++n>i)for(n-=i;n--;)o+="0";else n<i&&(o=o.slice(0,n)+"."+o.slice(n));else i>1&&(o=o.charAt(0)+"."+o.slice(1));return e.s<0&&r?"-"+o:o}P$3.abs=function(){var e=new this.constructor(this);return e.s=1,e},P$3.cmp=function(e){var t,r=this,n=r.c,o=(e=new r.constructor(e)).c,i=r.s,a=e.s,s=r.e,l=e.e;if(!n[0]||!o[0])return n[0]?i:o[0]?-a:0;if(i!=a)return i;if(t=i<0,s!=l)return s>l^t?1:-1;for(a=(s=n.length)<(l=o.length)?s:l,i=-1;++i<a;)if(n[i]!=o[i])return n[i]>o[i]^t?1:-1;return s==l?0:s>l^t?1:-1},P$3.div=function(e){var t=this,r=t.constructor,n=t.c,o=(e=new r(e)).c,i=t.s==e.s?1:-1,a=r.DP;if(a!==~~a||a<0||a>MAX_DP)throw Error(INVALID_DP);if(!o[0])throw Error(DIV_BY_ZERO);if(!n[0])return e.s=i,e.c=[e.e=0],e;var s,l,c,u,d,h=o.slice(),p=s=o.length,f=n.length,g=n.slice(0,s),m=g.length,y=e,v=y.c=[],_=0,b=a+(y.e=t.e-e.e)+1;for(y.s=i,i=b<0?0:b,h.unshift(0);m++<s;)g.push(0);do{for(c=0;c<10;c++){if(s!=(m=g.length))u=s>m?1:-1;else for(d=-1,u=0;++d<s;)if(o[d]!=g[d]){u=o[d]>g[d]?1:-1;break}if(!(u<0))break;for(l=m==s?o:h;m;){if(g[--m]<l[m]){for(d=m;d&&!g[--d];)g[d]=9;--g[d],g[m]+=10}g[m]-=l[m]}for(;!g[0];)g.shift()}v[_++]=u?c:++c,g[0]&&u?g[m]=n[p]||0:g=[n[p]]}while((p++<f||g[0]!==UNDEFINED)&&i--);return v[0]||1==_||(v.shift(),y.e--,b--),_>b&&round$2(y,b,r.RM,g[0]!==UNDEFINED),y},P$3.eq=function(e){return 0===this.cmp(e)},P$3.gt=function(e){return this.cmp(e)>0},P$3.gte=function(e){return this.cmp(e)>-1},P$3.lt=function(e){return this.cmp(e)<0},P$3.lte=function(e){return this.cmp(e)<1},P$3.minus=P$3.sub=function(e){var t,r,n,o,i=this,a=i.constructor,s=i.s,l=(e=new a(e)).s;if(s!=l)return e.s=-l,i.plus(e);var c=i.c.slice(),u=i.e,d=e.c,h=e.e;if(!c[0]||!d[0])return d[0]?e.s=-l:c[0]?e=new a(i):e.s=1,e;if(s=u-h){for((o=s<0)?(s=-s,n=c):(h=u,n=d),n.reverse(),l=s;l--;)n.push(0);n.reverse()}else for(r=((o=c.length<d.length)?c:d).length,s=l=0;l<r;l++)if(c[l]!=d[l]){o=c[l]<d[l];break}if(o&&(n=c,c=d,d=n,e.s=-e.s),(l=(r=d.length)-(t=c.length))>0)for(;l--;)c[t++]=0;for(l=t;r>s;){if(c[--r]<d[r]){for(t=r;t&&!c[--t];)c[t]=9;--c[t],c[r]+=10}c[r]-=d[r]}for(;0===c[--l];)c.pop();for(;0===c[0];)c.shift(),--h;return c[0]||(e.s=1,c=[h=0]),e.c=c,e.e=h,e},P$3.mod=function(e){var t,r=this,n=r.constructor,o=r.s,i=(e=new n(e)).s;if(!e.c[0])throw Error(DIV_BY_ZERO);return r.s=e.s=1,t=1==e.cmp(r),r.s=o,e.s=i,t?new n(r):(o=n.DP,i=n.RM,n.DP=n.RM=0,r=r.div(e),n.DP=o,n.RM=i,this.minus(r.times(e)))},P$3.neg=function(){var e=new this.constructor(this);return e.s=-e.s,e},P$3.plus=P$3.add=function(e){var t,r,n,o=this,i=o.constructor;if(e=new i(e),o.s!=e.s)return e.s=-e.s,o.minus(e);var a=o.e,s=o.c,l=e.e,c=e.c;if(!s[0]||!c[0])return c[0]||(s[0]?e=new i(o):e.s=o.s),e;if(s=s.slice(),t=a-l){for(t>0?(l=a,n=c):(t=-t,n=s),n.reverse();t--;)n.push(0);n.reverse()}for(s.length-c.length<0&&(n=c,c=s,s=n),t=c.length,r=0;t;s[t]%=10)r=(s[--t]=s[t]+c[t]+r)/10|0;for(r&&(s.unshift(r),++l),t=s.length;0===s[--t];)s.pop();return e.c=s,e.e=l,e},P$3.pow=function(e){var t=this,r=new t.constructor("1"),n=r,o=e<0;if(e!==~~e||e<-MAX_POWER||e>MAX_POWER)throw Error(INVALID+"exponent");for(o&&(e=-e);1&e&&(n=n.times(t)),e>>=1;)t=t.times(t);return o?r.div(n):n},P$3.prec=function(e,t){if(e!==~~e||e<1||e>MAX_DP)throw Error(INVALID+"precision");return round$2(new this.constructor(this),e,t)},P$3.round=function(e,t){if(e===UNDEFINED)e=0;else if(e!==~~e||e<-MAX_DP||e>MAX_DP)throw Error(INVALID_DP);return round$2(new this.constructor(this),e+this.e+1,t)},P$3.sqrt=function(){var e,t,r,n=this,o=n.constructor,i=n.s,a=n.e,s=new o("0.5");if(!n.c[0])return new o(n);if(i<0)throw Error(NAME+"No square root");0===(i=Math.sqrt(+stringify(n,!0,!0)))||i===1/0?((t=n.c.join("")).length+a&1||(t+="0"),a=((a+1)/2|0)-(a<0||1&a),e=new o(((i=Math.sqrt(t))==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+a)):e=new o(i+""),a=e.e+(o.DP+=4);do{r=e,e=s.times(r.plus(n.div(r)))}while(r.c.slice(0,a).join("")!==e.c.slice(0,a).join(""));return round$2(e,(o.DP-=4)+e.e+1,o.RM)},P$3.times=P$3.mul=function(e){var t,r=this,n=r.constructor,o=r.c,i=(e=new n(e)).c,a=o.length,s=i.length,l=r.e,c=e.e;if(e.s=r.s==e.s?1:-1,!o[0]||!i[0])return e.c=[e.e=0],e;for(e.e=l+c,a<s&&(t=o,o=i,i=t,c=a,a=s,s=c),t=new Array(c=a+s);c--;)t[c]=0;for(l=s;l--;){for(s=0,c=a+l;c>l;)s=t[c]+i[l]*o[c-l-1]+s,t[c--]=s%10,s=s/10|0;t[c]=s}for(s?++e.e:t.shift(),l=t.length;!t[--l];)t.pop();return e.c=t,e},P$3.toExponential=function(e,t){var r=this,n=r.c[0];if(e!==UNDEFINED){if(e!==~~e||e<0||e>MAX_DP)throw Error(INVALID_DP);for(r=round$2(new r.constructor(r),++e,t);r.c.length<e;)r.c.push(0)}return stringify(r,!0,!!n)},P$3.toFixed=function(e,t){var r=this,n=r.c[0];if(e!==UNDEFINED){if(e!==~~e||e<0||e>MAX_DP)throw Error(INVALID_DP);for(e=e+(r=round$2(new r.constructor(r),e+r.e+1,t)).e+1;r.c.length<e;)r.c.push(0)}return stringify(r,!1,!!n)},P$3[Symbol.for("nodejs.util.inspect.custom")]=P$3.toJSON=P$3.toString=function(){var e=this,t=e.constructor;return stringify(e,e.e<=t.NE||e.e>=t.PE,!!e.c[0])},P$3.toNumber=function(){var e=+stringify(this,!0,!0);if(!0===this.constructor.strict&&!this.eq(e.toString()))throw Error(NAME+"Imprecise conversion");return e},P$3.toPrecision=function(e,t){var r=this,n=r.constructor,o=r.c[0];if(e!==UNDEFINED){if(e!==~~e||e<1||e>MAX_DP)throw Error(INVALID+"precision");for(r=round$2(new n(r),e,t);r.c.length<e;)r.c.push(0)}return stringify(r,e<=r.e||r.e<=n.NE||r.e>=n.PE,!!o)},P$3.valueOf=function(){var e=this,t=e.constructor;if(!0===t.strict)throw Error(NAME+"valueOf disallowed");return stringify(e,e.e<=t.NE||e.e>=t.PE,!0)};var Big=_Big_(),useLatest$1=function(e){var t=reactExports.useRef(e);return t.current=e,t};const getPrecision=e=>e.includes(".")?e.length-e.lastIndexOf(".")-1:0,DEBOUNCE_DELAY_TIME=20,NumberInput=({width:e,suffix:t,onChange:r,value:n,instant:o=!1,max:i,min:a,defaultValue:s,step:l,precision:c,maxPrecision:u,onFinish:d,onBlur:h,wrapperClassName:p,style:f,...g})=>{const[m,y]=useUpdateValue(n,[n]),[v,_]=useUpdateValue(n,[n]),b=isUndefined$2(c)&&!isUndefined$2(l)?getPrecision(toString$5(l)):c,C=isUndefined$2(c)&&!isUndefined$2(l)||!isUndefined$2(c)?void 0:isUndefined$2(u)?8:u,{parser:E=e=>/^(\+|-)?[0-9]+(\.[0-9]+)?$/.test(e)||/^(\.\d+)$/.test(e)?toNumber$6(e):v}=g,T=e=>isNil$2(e)?isNil$2(s)?a||0:s:isUndefined$2(b)?e:new Big(e).round(b).toNumber(),S=useLatest$1(r),P=reactExports.useCallback(debounce$2((e=>{var t;null==(t=S.current)||t.call(S,e)}),DEBOUNCE_DELAY_TIME),[]);return jsxRuntimeExports.jsxs("div",{className:classNames$1("fd-biz-gradient-input-number",p),style:{width:e},children:[jsxRuntimeExports.jsx(InputNumber,{controlPosition:"right",defaultValue:s,max:i,min:a,value:m,step:l,precision:b,maxPrecision:C,onBlur:()=>{null==h||h(),(()=>{P.cancel();const e=T(v);y(e),null==r||r(e),null==d||d(e)})()},onStep:e=>{null==P||P(e)},onInput:e=>{const t=e.target.value,r=t?(e=>!isUndefined$2(i)&&!isNil$2(e)&&e>i?i:!isUndefined$2(a)&&!isNil$2(e)&&e<a?a:e)(E(t)):void 0;_(r),o&&(null==P||P(T(r)))},style:{width:"100%",paddingRight:t?15:0,...f},...g}),t&&jsxRuntimeExports.jsx("span",{className:classNames$1("input-number-unit-suffix",{disabled:g.disabled}),children:t})]})};var chroma$1={exports:{}};chroma$1.exports=function(){for(var e=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),e<t?t:e>r?r:e},t=e,r=function(e){e._clipped=!1,e._unclipped=e.slice(0);for(var r=0;r<=3;r++)r<3?((e[r]<0||e[r]>255)&&(e._clipped=!0),e[r]=t(e[r],0,255)):3===r&&(e[r]=t(e[r],0,1));return e},n={},o=0,i=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];o<i.length;o+=1){var a=i[o];n["[object "+a+"]"]=a.toLowerCase()}var s=function(e){return n[Object.prototype.toString.call(e)]||"object"},l=s,c=function(e,t){return void 0===t&&(t=null),e.length>=3?Array.prototype.slice.call(e):"object"==l(e[0])&&t?t.split("").filter((function(t){return void 0!==e[0][t]})).map((function(t){return e[0][t]})):e[0]},u=s,d=function(e){if(e.length<2)return null;var t=e.length-1;return"string"==u(e[t])?e[t].toLowerCase():null},h=Math.PI,p={clip_rgb:r,limit:e,type:s,unpack:c,last:d,PI:h,TWOPI:2*h,PITHIRD:h/3,DEG2RAD:h/180,RAD2DEG:180/h},f={format:{},autodetect:[]},g=p.last,m=p.clip_rgb,y=p.type,v=f,_=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=this;if("object"===y(e[0])&&e[0].constructor&&e[0].constructor===this.constructor)return e[0];var n=g(e),o=!1;if(!n){o=!0,v.sorted||(v.autodetect=v.autodetect.sort((function(e,t){return t.p-e.p})),v.sorted=!0);for(var i=0,a=v.autodetect;i<a.length;i+=1){var s=a[i];if(n=s.test.apply(s,e))break}}if(!v.format[n])throw new Error("unknown format: "+e);var l=v.format[n].apply(null,o?e:e.slice(0,-1));r._rgb=m(l),3===r._rgb.length&&r._rgb.push(1)};_.prototype.toString=function(){return"function"==y(this.hex)?this.hex():"["+this._rgb.join(",")+"]"};var b=_,C=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(C.Color,[null].concat(e)))};C.Color=b,C.version="2.4.2";var E=C,T=p.unpack,S=Math.max,P=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=T(e,"rgb"),n=r[0],o=r[1],i=r[2],a=1-S(n/=255,S(o/=255,i/=255)),s=a<1?1/(1-a):0;return[(1-n-a)*s,(1-o-a)*s,(1-i-a)*s,a]},w=P,x=p.unpack,O=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=(e=x(e,"cmyk"))[0],n=e[1],o=e[2],i=e[3],a=e.length>4?e[4]:1;return 1===i?[0,0,0,a]:[r>=1?0:255*(1-r)*(1-i),n>=1?0:255*(1-n)*(1-i),o>=1?0:255*(1-o)*(1-i),a]},$=O,I=E,R=b,A=f,D=p.unpack,L=p.type,N=w;R.prototype.cmyk=function(){return N(this._rgb)},I.cmyk=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(R,[null].concat(e,["cmyk"])))},A.format.cmyk=$,A.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=D(e,"cmyk"),"array"===L(e)&&4===e.length)return"cmyk"}});var M=p.unpack,k=p.last,F=function(e){return Math.round(100*e)/100},j=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=M(e,"hsla"),n=k(e)||"lsa";return r[0]=F(r[0]||0),r[1]=F(100*r[1])+"%",r[2]=F(100*r[2])+"%","hsla"===n||r.length>3&&r[3]<1?(r[3]=r.length>3?r[3]:1,n="hsla"):r.length=3,n+"("+r.join(",")+")"},B=j,W=p.unpack,V=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=(e=W(e,"rgba"))[0],n=e[1],o=e[2];r/=255,n/=255,o/=255;var i,a,s=Math.min(r,n,o),l=Math.max(r,n,o),c=(l+s)/2;return l===s?(i=0,a=Number.NaN):i=c<.5?(l-s)/(l+s):(l-s)/(2-l-s),r==l?a=(n-o)/(l-s):n==l?a=2+(o-r)/(l-s):o==l&&(a=4+(r-n)/(l-s)),(a*=60)<0&&(a+=360),e.length>3&&void 0!==e[3]?[a,i,c,e[3]]:[a,i,c]},H=V,G=p.unpack,U=p.last,Y=B,z=H,K=Math.round,Z=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=G(e,"rgba"),n=U(e)||"rgb";return"hsl"==n.substr(0,3)?Y(z(r),n):(r[0]=K(r[0]),r[1]=K(r[1]),r[2]=K(r[2]),("rgba"===n||r.length>3&&r[3]<1)&&(r[3]=r.length>3?r[3]:1,n="rgba"),n+"("+r.slice(0,"rgb"===n?3:4).join(",")+")")},X=Z,J=p.unpack,Q=Math.round,q=function(){for(var e,t=[],r=arguments.length;r--;)t[r]=arguments[r];var n,o,i,a=(t=J(t,"hsl"))[0],s=t[1],l=t[2];if(0===s)n=o=i=255*l;else{var c=[0,0,0],u=[0,0,0],d=l<.5?l*(1+s):l+s-l*s,h=2*l-d,p=a/360;c[0]=p+1/3,c[1]=p,c[2]=p-1/3;for(var f=0;f<3;f++)c[f]<0&&(c[f]+=1),c[f]>1&&(c[f]-=1),6*c[f]<1?u[f]=h+6*(d-h)*c[f]:2*c[f]<1?u[f]=d:3*c[f]<2?u[f]=h+(d-h)*(2/3-c[f])*6:u[f]=h;n=(e=[Q(255*u[0]),Q(255*u[1]),Q(255*u[2])])[0],o=e[1],i=e[2]}return t.length>3?[n,o,i,t[3]]:[n,o,i,1]},ee=q,te=ee,re=f,ne=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,oe=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,ie=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,ae=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,se=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,le=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,ce=Math.round,ue=function(e){var t;if(e=e.toLowerCase().trim(),re.format.named)try{return re.format.named(e)}catch(e3){}if(t=e.match(ne)){for(var r=t.slice(1,4),n=0;n<3;n++)r[n]=+r[n];return r[3]=1,r}if(t=e.match(oe)){for(var o=t.slice(1,5),i=0;i<4;i++)o[i]=+o[i];return o}if(t=e.match(ie)){for(var a=t.slice(1,4),s=0;s<3;s++)a[s]=ce(2.55*a[s]);return a[3]=1,a}if(t=e.match(ae)){for(var l=t.slice(1,5),c=0;c<3;c++)l[c]=ce(2.55*l[c]);return l[3]=+l[3],l}if(t=e.match(se)){var u=t.slice(1,4);u[1]*=.01,u[2]*=.01;var d=te(u);return d[3]=1,d}if(t=e.match(le)){var h=t.slice(1,4);h[1]*=.01,h[2]*=.01;var p=te(h);return p[3]=+t[4],p}};ue.test=function(e){return ne.test(e)||oe.test(e)||ie.test(e)||ae.test(e)||se.test(e)||le.test(e)};var de=ue,he=E,pe=b,fe=f,ge=p.type,me=X,ye=de;pe.prototype.css=function(e){return me(this._rgb,e)},he.css=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(pe,[null].concat(e,["css"])))},fe.format.css=ye,fe.autodetect.push({p:5,test:function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];if(!t.length&&"string"===ge(e)&&ye.test(e))return"css"}});var ve=b,_e=E,be=f,Ce=p.unpack;be.format.gl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=Ce(e,"rgba");return r[0]*=255,r[1]*=255,r[2]*=255,r},_e.gl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(ve,[null].concat(e,["gl"])))},ve.prototype.gl=function(){var e=this._rgb;return[e[0]/255,e[1]/255,e[2]/255,e[3]]};var Ee=p.unpack,Te=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r,n=Ee(e,"rgb"),o=n[0],i=n[1],a=n[2],s=Math.min(o,i,a),l=Math.max(o,i,a),c=l-s,u=100*c/255,d=s/(255-c)*100;return 0===c?r=Number.NaN:(o===l&&(r=(i-a)/c),i===l&&(r=2+(a-o)/c),a===l&&(r=4+(o-i)/c),(r*=60)<0&&(r+=360)),[r,u,d]},Se=Te,Pe=p.unpack,we=Math.floor,xe=function(){for(var e,t,r,n,o,i,a=[],s=arguments.length;s--;)a[s]=arguments[s];var l,c,u,d=(a=Pe(a,"hcg"))[0],h=a[1],p=a[2];p*=255;var f=255*h;if(0===h)l=c=u=p;else{360===d&&(d=0),d>360&&(d-=360),d<0&&(d+=360);var g=we(d/=60),m=d-g,y=p*(1-h),v=y+f*(1-m),_=y+f*m,b=y+f;switch(g){case 0:l=(e=[b,_,y])[0],c=e[1],u=e[2];break;case 1:l=(t=[v,b,y])[0],c=t[1],u=t[2];break;case 2:l=(r=[y,b,_])[0],c=r[1],u=r[2];break;case 3:l=(n=[y,v,b])[0],c=n[1],u=n[2];break;case 4:l=(o=[_,y,b])[0],c=o[1],u=o[2];break;case 5:l=(i=[b,y,v])[0],c=i[1],u=i[2]}}return[l,c,u,a.length>3?a[3]:1]},Oe=xe,$e=p.unpack,Ie=p.type,Re=E,Ae=b,De=f,Le=Se;Ae.prototype.hcg=function(){return Le(this._rgb)},Re.hcg=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Ae,[null].concat(e,["hcg"])))},De.format.hcg=Oe,De.autodetect.push({p:1,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=$e(e,"hcg"),"array"===Ie(e)&&3===e.length)return"hcg"}});var Ne=p.unpack,Me=p.last,ke=Math.round,Fe=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=Ne(e,"rgba"),n=r[0],o=r[1],i=r[2],a=r[3],s=Me(e)||"auto";void 0===a&&(a=1),"auto"===s&&(s=a<1?"rgba":"rgb");var l="000000"+((n=ke(n))<<16|(o=ke(o))<<8|(i=ke(i))).toString(16);l=l.substr(l.length-6);var c="0"+ke(255*a).toString(16);switch(c=c.substr(c.length-2),s.toLowerCase()){case"rgba":return"#"+l+c;case"argb":return"#"+c+l;default:return"#"+l}},je=Fe,Be=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,We=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,Ve=function(e){if(e.match(Be)){4!==e.length&&7!==e.length||(e=e.substr(1)),3===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]);var t=parseInt(e,16);return[t>>16,t>>8&255,255&t,1]}if(e.match(We)){5!==e.length&&9!==e.length||(e=e.substr(1)),4===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]);var r=parseInt(e,16);return[r>>24&255,r>>16&255,r>>8&255,Math.round((255&r)/255*100)/100]}throw new Error("unknown hex color: "+e)},He=E,Ge=b,Ue=p.type,Ye=f,ze=je;Ge.prototype.hex=function(e){return ze(this._rgb,e)},He.hex=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Ge,[null].concat(e,["hex"])))},Ye.format.hex=Ve,Ye.autodetect.push({p:4,test:function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];if(!t.length&&"string"===Ue(e)&&[3,4,5,6,7,8,9].indexOf(e.length)>=0)return"hex"}});var Ke=p.unpack,Ze=p.TWOPI,Xe=Math.min,Je=Math.sqrt,Qe=Math.acos,qe=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r,n=Ke(e,"rgb"),o=n[0],i=n[1],a=n[2],s=Xe(o/=255,i/=255,a/=255),l=(o+i+a)/3,c=l>0?1-s/l:0;return 0===c?r=NaN:(r=(o-i+(o-a))/2,r/=Je((o-i)*(o-i)+(o-a)*(i-a)),r=Qe(r),a>i&&(r=Ze-r),r/=Ze),[360*r,c,l]},et=qe,tt=p.unpack,rt=p.limit,nt=p.TWOPI,ot=p.PITHIRD,it=Math.cos,at=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r,n,o,i=(e=tt(e,"hsi"))[0],a=e[1],s=e[2];return isNaN(i)&&(i=0),isNaN(a)&&(a=0),i>360&&(i-=360),i<0&&(i+=360),(i/=360)<1/3?n=1-((o=(1-a)/3)+(r=(1+a*it(nt*i)/it(ot-nt*i))/3)):i<2/3?o=1-((r=(1-a)/3)+(n=(1+a*it(nt*(i-=1/3))/it(ot-nt*i))/3)):r=1-((n=(1-a)/3)+(o=(1+a*it(nt*(i-=2/3))/it(ot-nt*i))/3)),[255*(r=rt(s*r*3)),255*(n=rt(s*n*3)),255*(o=rt(s*o*3)),e.length>3?e[3]:1]},st=at,lt=p.unpack,ct=p.type,ut=E,dt=b,ht=f,pt=et;dt.prototype.hsi=function(){return pt(this._rgb)},ut.hsi=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(dt,[null].concat(e,["hsi"])))},ht.format.hsi=st,ht.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=lt(e,"hsi"),"array"===ct(e)&&3===e.length)return"hsi"}});var ft=p.unpack,gt=p.type,mt=E,yt=b,vt=f,_t=H;yt.prototype.hsl=function(){return _t(this._rgb)},mt.hsl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(yt,[null].concat(e,["hsl"])))},vt.format.hsl=ee,vt.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=ft(e,"hsl"),"array"===gt(e)&&3===e.length)return"hsl"}});var bt=p.unpack,Ct=Math.min,Et=Math.max,Tt=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r,n,o,i=(e=bt(e,"rgb"))[0],a=e[1],s=e[2],l=Ct(i,a,s),c=Et(i,a,s),u=c-l;return o=c/255,0===c?(r=Number.NaN,n=0):(n=u/c,i===c&&(r=(a-s)/u),a===c&&(r=2+(s-i)/u),s===c&&(r=4+(i-a)/u),(r*=60)<0&&(r+=360)),[r,n,o]},St=Tt,Pt=p.unpack,wt=Math.floor,xt=function(){for(var e,t,r,n,o,i,a=[],s=arguments.length;s--;)a[s]=arguments[s];var l,c,u,d=(a=Pt(a,"hsv"))[0],h=a[1],p=a[2];if(p*=255,0===h)l=c=u=p;else{360===d&&(d=0),d>360&&(d-=360),d<0&&(d+=360);var f=wt(d/=60),g=d-f,m=p*(1-h),y=p*(1-h*g),v=p*(1-h*(1-g));switch(f){case 0:l=(e=[p,v,m])[0],c=e[1],u=e[2];break;case 1:l=(t=[y,p,m])[0],c=t[1],u=t[2];break;case 2:l=(r=[m,p,v])[0],c=r[1],u=r[2];break;case 3:l=(n=[m,y,p])[0],c=n[1],u=n[2];break;case 4:l=(o=[v,m,p])[0],c=o[1],u=o[2];break;case 5:l=(i=[p,m,y])[0],c=i[1],u=i[2]}}return[l,c,u,a.length>3?a[3]:1]},Ot=xt,$t=p.unpack,It=p.type,Rt=E,At=b,Dt=f,Lt=St;At.prototype.hsv=function(){return Lt(this._rgb)},Rt.hsv=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(At,[null].concat(e,["hsv"])))},Dt.format.hsv=Ot,Dt.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=$t(e,"hsv"),"array"===It(e)&&3===e.length)return"hsv"}});var Nt={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},Mt=Nt,kt=p.unpack,Ft=Math.pow,jt=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=kt(e,"rgb"),n=r[0],o=r[1],i=r[2],a=Vt(n,o,i),s=a[0],l=a[1],c=116*l-16;return[c<0?0:c,500*(s-l),200*(l-a[2])]},Bt=function(e){return(e/=255)<=.04045?e/12.92:Ft((e+.055)/1.055,2.4)},Wt=function(e){return e>Mt.t3?Ft(e,1/3):e/Mt.t2+Mt.t0},Vt=function(e,t,r){return e=Bt(e),t=Bt(t),r=Bt(r),[Wt((.4124564*e+.3575761*t+.1804375*r)/Mt.Xn),Wt((.2126729*e+.7151522*t+.072175*r)/Mt.Yn),Wt((.0193339*e+.119192*t+.9503041*r)/Mt.Zn)]},Ht=jt,Gt=Nt,Ut=p.unpack,Yt=Math.pow,zt=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r,n,o,i=(e=Ut(e,"lab"))[0],a=e[1],s=e[2];return n=(i+16)/116,r=isNaN(a)?n:n+a/500,o=isNaN(s)?n:n-s/200,n=Gt.Yn*Zt(n),r=Gt.Xn*Zt(r),o=Gt.Zn*Zt(o),[Kt(3.2404542*r-1.5371385*n-.4985314*o),Kt(-.969266*r+1.8760108*n+.041556*o),Kt(.0556434*r-.2040259*n+1.0572252*o),e.length>3?e[3]:1]},Kt=function(e){return 255*(e<=.00304?12.92*e:1.055*Yt(e,1/2.4)-.055)},Zt=function(e){return e>Gt.t1?e*e*e:Gt.t2*(e-Gt.t0)},Xt=zt,Jt=p.unpack,Qt=p.type,qt=E,er=b,tr=f,rr=Ht;er.prototype.lab=function(){return rr(this._rgb)},qt.lab=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(er,[null].concat(e,["lab"])))},tr.format.lab=Xt,tr.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=Jt(e,"lab"),"array"===Qt(e)&&3===e.length)return"lab"}});var nr=p.unpack,or=p.RAD2DEG,ir=Math.sqrt,ar=Math.atan2,sr=Math.round,lr=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=nr(e,"lab"),n=r[0],o=r[1],i=r[2],a=ir(o*o+i*i),s=(ar(i,o)*or+360)%360;return 0===sr(1e4*a)&&(s=Number.NaN),[n,a,s]},cr=lr,ur=p.unpack,dr=Ht,hr=cr,pr=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=ur(e,"rgb"),n=r[0],o=r[1],i=r[2],a=dr(n,o,i),s=a[0],l=a[1],c=a[2];return hr(s,l,c)},fr=pr,gr=p.unpack,mr=p.DEG2RAD,yr=Math.sin,vr=Math.cos,_r=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=gr(e,"lch"),n=r[0],o=r[1],i=r[2];return isNaN(i)&&(i=0),[n,vr(i*=mr)*o,yr(i)*o]},br=_r,Cr=p.unpack,Er=br,Tr=Xt,Sr=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=(e=Cr(e,"lch"))[0],n=e[1],o=e[2],i=Er(r,n,o),a=i[0],s=i[1],l=i[2],c=Tr(a,s,l);return[c[0],c[1],c[2],e.length>3?e[3]:1]},Pr=Sr,wr=p.unpack,xr=Pr,Or=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=wr(e,"hcl").reverse();return xr.apply(void 0,r)},$r=Or,Ir=p.unpack,Rr=p.type,Ar=E,Dr=b,Lr=f,Nr=fr;Dr.prototype.lch=function(){return Nr(this._rgb)},Dr.prototype.hcl=function(){return Nr(this._rgb).reverse()},Ar.lch=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Dr,[null].concat(e,["lch"])))},Ar.hcl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Dr,[null].concat(e,["hcl"])))},Lr.format.lch=Pr,Lr.format.hcl=$r,["lch","hcl"].forEach((function(e){return Lr.autodetect.push({p:2,test:function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];if(t=Ir(t,e),"array"===Rr(t)&&3===t.length)return e}})}));var Mr={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},kr=b,Fr=f,jr=p.type,Br=Mr,Wr=Ve,Vr=je;kr.prototype.name=function(){for(var e=Vr(this._rgb,"rgb"),t=0,r=Object.keys(Br);t<r.length;t+=1){var n=r[t];if(Br[n]===e)return n.toLowerCase()}return e},Fr.format.named=function(e){if(e=e.toLowerCase(),Br[e])return Wr(Br[e]);throw new Error("unknown color name: "+e)},Fr.autodetect.push({p:5,test:function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];if(!t.length&&"string"===jr(e)&&Br[e.toLowerCase()])return"named"}});var Hr=p.unpack,Gr=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=Hr(e,"rgb");return(r[0]<<16)+(r[1]<<8)+r[2]},Ur=Gr,Yr=p.type,zr=function(e){if("number"==Yr(e)&&e>=0&&e<=16777215)return[e>>16,e>>8&255,255&e,1];throw new Error("unknown num color: "+e)},Kr=E,Zr=b,Xr=f,Jr=p.type,Qr=Ur;Zr.prototype.num=function(){return Qr(this._rgb)},Kr.num=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Zr,[null].concat(e,["num"])))},Xr.format.num=zr,Xr.autodetect.push({p:5,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(1===e.length&&"number"===Jr(e[0])&&e[0]>=0&&e[0]<=16777215)return"num"}});var qr=E,en=b,tn=f,rn=p.unpack,nn=p.type,on=Math.round;en.prototype.rgb=function(e){return void 0===e&&(e=!0),!1===e?this._rgb.slice(0,3):this._rgb.slice(0,3).map(on)},en.prototype.rgba=function(e){return void 0===e&&(e=!0),this._rgb.slice(0,4).map((function(t,r){return r<3?!1===e?t:on(t):t}))},qr.rgb=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(en,[null].concat(e,["rgb"])))},tn.format.rgb=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=rn(e,"rgba");return void 0===r[3]&&(r[3]=1),r},tn.autodetect.push({p:3,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=rn(e,"rgba"),"array"===nn(e)&&(3===e.length||4===e.length&&"number"==nn(e[3])&&e[3]>=0&&e[3]<=1))return"rgb"}});var an=Math.log,sn=function(e){var t,r,n,o=e/100;return o<66?(t=255,r=o<6?0:-155.25485562709179-.44596950469579133*(r=o-2)+104.49216199393888*an(r),n=o<20?0:.8274096064007395*(n=o-10)-254.76935184120902+115.67994401066147*an(n)):(t=351.97690566805693+.114206453784165*(t=o-55)-40.25366309332127*an(t),r=325.4494125711974+.07943456536662342*(r=o-50)-28.0852963507957*an(r),n=255),[t,r,n,1]},ln=sn,cn=p.unpack,un=Math.round,dn=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];for(var r,n=cn(e,"rgb"),o=n[0],i=n[2],a=1e3,s=4e4,l=.4;s-a>l;){var c=ln(r=.5*(s+a));c[2]/c[0]>=i/o?s=r:a=r}return un(r)},hn=E,pn=b,fn=f,gn=dn;pn.prototype.temp=pn.prototype.kelvin=pn.prototype.temperature=function(){return gn(this._rgb)},hn.temp=hn.kelvin=hn.temperature=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(pn,[null].concat(e,["temp"])))},fn.format.temp=fn.format.kelvin=fn.format.temperature=sn;var mn=p.unpack,yn=Math.cbrt,vn=Math.pow,_n=Math.sign,bn=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=mn(e,"rgb"),n=r[0],o=r[1],i=r[2],a=[En(n/255),En(o/255),En(i/255)],s=a[0],l=a[1],c=a[2],u=yn(.4122214708*s+.5363325363*l+.0514459929*c),d=yn(.2119034982*s+.6806995451*l+.1073969566*c),h=yn(.0883024619*s+.2817188376*l+.6299787005*c);return[.2104542553*u+.793617785*d-.0040720468*h,1.9779984951*u-2.428592205*d+.4505937099*h,.0259040371*u+.7827717662*d-.808675766*h]},Cn=bn;function En(e){var t=Math.abs(e);return t<.04045?e/12.92:(_n(e)||1)*vn((t+.055)/1.055,2.4)}var Tn=p.unpack,Sn=Math.pow,Pn=Math.sign,wn=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=(e=Tn(e,"lab"))[0],n=e[1],o=e[2],i=Sn(r+.3963377774*n+.2158037573*o,3),a=Sn(r-.1055613458*n-.0638541728*o,3),s=Sn(r-.0894841775*n-1.291485548*o,3);return[255*On(4.0767416621*i-3.3077115913*a+.2309699292*s),255*On(-1.2684380046*i+2.6097574011*a-.3413193965*s),255*On(-.0041960863*i-.7034186147*a+1.707614701*s),e.length>3?e[3]:1]},xn=wn;function On(e){var t=Math.abs(e);return t>.0031308?(Pn(e)||1)*(1.055*Sn(t,1/2.4)-.055):12.92*e}var $n=p.unpack,In=p.type,Rn=E,An=b,Dn=f,Ln=Cn;An.prototype.oklab=function(){return Ln(this._rgb)},Rn.oklab=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(An,[null].concat(e,["oklab"])))},Dn.format.oklab=xn,Dn.autodetect.push({p:3,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=$n(e,"oklab"),"array"===In(e)&&3===e.length)return"oklab"}});var Nn=p.unpack,Mn=Cn,kn=cr,Fn=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=Nn(e,"rgb"),n=r[0],o=r[1],i=r[2],a=Mn(n,o,i),s=a[0],l=a[1],c=a[2];return kn(s,l,c)},jn=Fn,Bn=p.unpack,Wn=br,Vn=xn,Hn=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=(e=Bn(e,"lch"))[0],n=e[1],o=e[2],i=Wn(r,n,o),a=i[0],s=i[1],l=i[2],c=Vn(a,s,l);return[c[0],c[1],c[2],e.length>3?e[3]:1]},Gn=Hn,Un=p.unpack,Yn=p.type,zn=E,Kn=b,Zn=f,Xn=jn;Kn.prototype.oklch=function(){return Xn(this._rgb)},zn.oklch=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Kn,[null].concat(e,["oklch"])))},Zn.format.oklch=Gn,Zn.autodetect.push({p:3,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=Un(e,"oklch"),"array"===Yn(e)&&3===e.length)return"oklch"}});var Jn=b,Qn=p.type;Jn.prototype.alpha=function(e,t){return void 0===t&&(t=!1),void 0!==e&&"number"===Qn(e)?t?(this._rgb[3]=e,this):new Jn([this._rgb[0],this._rgb[1],this._rgb[2],e],"rgb"):this._rgb[3]},b.prototype.clipped=function(){return this._rgb._clipped||!1};var qn=b,eo=Nt;qn.prototype.darken=function(e){void 0===e&&(e=1);var t=this,r=t.lab();return r[0]-=eo.Kn*e,new qn(r,"lab").alpha(t.alpha(),!0)},qn.prototype.brighten=function(e){return void 0===e&&(e=1),this.darken(-e)},qn.prototype.darker=qn.prototype.darken,qn.prototype.brighter=qn.prototype.brighten,b.prototype.get=function(e){var t=e.split("."),r=t[0],n=t[1],o=this[r]();if(n){var i=r.indexOf(n)-("ok"===r.substr(0,2)?2:0);if(i>-1)return o[i];throw new Error("unknown channel "+n+" in mode "+r)}return o};var to=b,ro=p.type,no=Math.pow,oo=1e-7,io=20;to.prototype.luminance=function(e){if(void 0!==e&&"number"===ro(e)){if(0===e)return new to([0,0,0,this._rgb[3]],"rgb");if(1===e)return new to([255,255,255,this._rgb[3]],"rgb");var t=this.luminance(),r="rgb",n=io,o=function(t,i){var a=t.interpolate(i,.5,r),s=a.luminance();return Math.abs(e-s)<oo||!n--?a:s>e?o(t,a):o(a,i)},i=(t>e?o(new to([0,0,0]),this):o(this,new to([255,255,255]))).rgb();return new to(i.concat([this._rgb[3]]))}return ao.apply(void 0,this._rgb.slice(0,3))};var ao=function(e,t,r){return.2126*(e=so(e))+.7152*(t=so(t))+.0722*(r=so(r))},so=function(e){return(e/=255)<=.03928?e/12.92:no((e+.055)/1.055,2.4)},lo={},co=b,uo=p.type,ho=lo,po=function(e,t,r){void 0===r&&(r=.5);for(var n=[],o=arguments.length-3;o-- >0;)n[o]=arguments[o+3];var i=n[0]||"lrgb";if(ho[i]||n.length||(i=Object.keys(ho)[0]),!ho[i])throw new Error("interpolation mode "+i+" is not defined");return"object"!==uo(e)&&(e=new co(e)),"object"!==uo(t)&&(t=new co(t)),ho[i](e,t,r).alpha(e.alpha()+r*(t.alpha()-e.alpha()))},fo=b,go=po;fo.prototype.mix=fo.prototype.interpolate=function(e,t){void 0===t&&(t=.5);for(var r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];return go.apply(void 0,[this,e,t].concat(r))};var mo=b;mo.prototype.premultiply=function(e){void 0===e&&(e=!1);var t=this._rgb,r=t[3];return e?(this._rgb=[t[0]*r,t[1]*r,t[2]*r,r],this):new mo([t[0]*r,t[1]*r,t[2]*r,r],"rgb")};var yo=b,vo=Nt;yo.prototype.saturate=function(e){void 0===e&&(e=1);var t=this,r=t.lch();return r[1]+=vo.Kn*e,r[1]<0&&(r[1]=0),new yo(r,"lch").alpha(t.alpha(),!0)},yo.prototype.desaturate=function(e){return void 0===e&&(e=1),this.saturate(-e)};var _o=b,bo=p.type;_o.prototype.set=function(e,t,r){void 0===r&&(r=!1);var n=e.split("."),o=n[0],i=n[1],a=this[o]();if(i){var s=o.indexOf(i)-("ok"===o.substr(0,2)?2:0);if(s>-1){if("string"==bo(t))switch(t.charAt(0)){case"+":case"-":a[s]+=+t;break;case"*":a[s]*=+t.substr(1);break;case"/":a[s]/=+t.substr(1);break;default:a[s]=+t}else{if("number"!==bo(t))throw new Error("unsupported value for Color.set");a[s]=t}var l=new _o(a,o);return r?(this._rgb=l._rgb,this):l}throw new Error("unknown channel "+i+" in mode "+o)}return a};var Co=b,Eo=function(e,t,r){var n=e._rgb,o=t._rgb;return new Co(n[0]+r*(o[0]-n[0]),n[1]+r*(o[1]-n[1]),n[2]+r*(o[2]-n[2]),"rgb")};lo.rgb=Eo;var To=b,So=Math.sqrt,Po=Math.pow,wo=function(e,t,r){var n=e._rgb,o=n[0],i=n[1],a=n[2],s=t._rgb,l=s[0],c=s[1],u=s[2];return new To(So(Po(o,2)*(1-r)+Po(l,2)*r),So(Po(i,2)*(1-r)+Po(c,2)*r),So(Po(a,2)*(1-r)+Po(u,2)*r),"rgb")};lo.lrgb=wo;var xo=b,Oo=function(e,t,r){var n=e.lab(),o=t.lab();return new xo(n[0]+r*(o[0]-n[0]),n[1]+r*(o[1]-n[1]),n[2]+r*(o[2]-n[2]),"lab")};lo.lab=Oo;var $o=b,Io=function(e,t,r,n){var o,i,a,s,l,c,u,d,h,p,f,g,m;return"hsl"===n?(a=e.hsl(),s=t.hsl()):"hsv"===n?(a=e.hsv(),s=t.hsv()):"hcg"===n?(a=e.hcg(),s=t.hcg()):"hsi"===n?(a=e.hsi(),s=t.hsi()):"lch"===n||"hcl"===n?(n="hcl",a=e.hcl(),s=t.hcl()):"oklch"===n&&(a=e.oklch().reverse(),s=t.oklch().reverse()),"h"!==n.substr(0,1)&&"oklch"!==n||(l=(o=a)[0],u=o[1],h=o[2],c=(i=s)[0],d=i[1],p=i[2]),isNaN(l)||isNaN(c)?isNaN(l)?isNaN(c)?g=Number.NaN:(g=c,1!=h&&0!=h||"hsv"==n||(f=d)):(g=l,1!=p&&0!=p||"hsv"==n||(f=u)):g=l+r*(c>l&&c-l>180?c-(l+360):c<l&&l-c>180?c+360-l:c-l),void 0===f&&(f=u+r*(d-u)),m=h+r*(p-h),new $o("oklch"===n?[m,f,g]:[g,f,m],n)},Ro=Io,Ao=function(e,t,r){return Ro(e,t,r,"lch")};lo.lch=Ao,lo.hcl=Ao;var Do=b,Lo=function(e,t,r){var n=e.num(),o=t.num();return new Do(n+r*(o-n),"num")};lo.num=Lo;var No=Io,Mo=function(e,t,r){return No(e,t,r,"hcg")};lo.hcg=Mo;var ko=Io,Fo=function(e,t,r){return ko(e,t,r,"hsi")};lo.hsi=Fo;var jo=Io,Bo=function(e,t,r){return jo(e,t,r,"hsl")};lo.hsl=Bo;var Wo=Io,Vo=function(e,t,r){return Wo(e,t,r,"hsv")};lo.hsv=Vo;var Ho=b,Go=function(e,t,r){var n=e.oklab(),o=t.oklab();return new Ho(n[0]+r*(o[0]-n[0]),n[1]+r*(o[1]-n[1]),n[2]+r*(o[2]-n[2]),"oklab")};lo.oklab=Go;var Uo=Io,Yo=function(e,t,r){return Uo(e,t,r,"oklch")};lo.oklch=Yo;var zo=b,Ko=p.clip_rgb,Zo=Math.pow,Xo=Math.sqrt,Jo=Math.PI,Qo=Math.cos,qo=Math.sin,ei=Math.atan2,ti=function(e,t,r){void 0===t&&(t="lrgb"),void 0===r&&(r=null);var n=e.length;r||(r=Array.from(new Array(n)).map((function(){return 1})));var o=n/r.reduce((function(e,t){return e+t}));if(r.forEach((function(e,t){r[t]*=o})),e=e.map((function(e){return new zo(e)})),"lrgb"===t)return ri(e,r);for(var i=e.shift(),a=i.get(t),s=[],l=0,c=0,u=0;u<a.length;u++)if(a[u]=(a[u]||0)*r[0],s.push(isNaN(a[u])?0:r[0]),"h"===t.charAt(u)&&!isNaN(a[u])){var d=a[u]/180*Jo;l+=Qo(d)*r[0],c+=qo(d)*r[0]}var h=i.alpha()*r[0];e.forEach((function(e,n){var o=e.get(t);h+=e.alpha()*r[n+1];for(var i=0;i<a.length;i++)if(!isNaN(o[i]))if(s[i]+=r[n+1],"h"===t.charAt(i)){var u=o[i]/180*Jo;l+=Qo(u)*r[n+1],c+=qo(u)*r[n+1]}else a[i]+=o[i]*r[n+1]}));for(var p=0;p<a.length;p++)if("h"===t.charAt(p)){for(var f=ei(c/s[p],l/s[p])/Jo*180;f<0;)f+=360;for(;f>=360;)f-=360;a[p]=f}else a[p]=a[p]/s[p];return h/=n,new zo(a,t).alpha(h>.99999?1:h,!0)},ri=function(e,t){for(var r=e.length,n=[0,0,0,0],o=0;o<e.length;o++){var i=e[o],a=t[o]/r,s=i._rgb;n[0]+=Zo(s[0],2)*a,n[1]+=Zo(s[1],2)*a,n[2]+=Zo(s[2],2)*a,n[3]+=s[3]*a}return n[0]=Xo(n[0]),n[1]=Xo(n[1]),n[2]=Xo(n[2]),n[3]>.9999999&&(n[3]=1),new zo(Ko(n))},ni=E,oi=p.type,ii=Math.pow,ai=function(e){var t="rgb",r=ni("#ccc"),n=0,o=[0,1],i=[],a=[0,0],s=!1,l=[],c=!1,u=0,d=1,h=!1,p={},f=!0,g=1,m=function(e){if((e=e||["#fff","#000"])&&"string"===oi(e)&&ni.brewer&&ni.brewer[e.toLowerCase()]&&(e=ni.brewer[e.toLowerCase()]),"array"===oi(e)){1===e.length&&(e=[e[0],e[0]]),e=e.slice(0);for(var t=0;t<e.length;t++)e[t]=ni(e[t]);i.length=0;for(var r=0;r<e.length;r++)i.push(r/(e.length-1))}return C(),l=e},y=function(e){if(null!=s){for(var t=s.length-1,r=0;r<t&&e>=s[r];)r++;return r-1}return 0},v=function(e){return e},_=function(e){return e},b=function(e,n){var o,c;if(null==n&&(n=!1),isNaN(e)||null===e)return r;c=n?e:s&&s.length>2?y(e)/(s.length-2):d!==u?(e-u)/(d-u):1,c=_(c),n||(c=v(c)),1!==g&&(c=ii(c,g)),c=a[0]+c*(1-a[0]-a[1]),c=Math.min(1,Math.max(0,c));var h=Math.floor(1e4*c);if(f&&p[h])o=p[h];else{if("array"===oi(l))for(var m=0;m<i.length;m++){var b=i[m];if(c<=b){o=l[m];break}if(c>=b&&m===i.length-1){o=l[m];break}if(c>b&&c<i[m+1]){c=(c-b)/(i[m+1]-b),o=ni.interpolate(l[m],l[m+1],c,t);break}}else"function"===oi(l)&&(o=l(c));f&&(p[h]=o)}return o},C=function(){return p={}};m(e);var E=function(e){var t=ni(b(e));return c&&t[c]?t[c]():t};return E.classes=function(e){if(null!=e){if("array"===oi(e))s=e,o=[e[0],e[e.length-1]];else{var t=ni.analyze(o);s=0===e?[t.min,t.max]:ni.limits(t,"e",e)}return E}return s},E.domain=function(e){if(!arguments.length)return o;u=e[0],d=e[e.length-1],i=[];var t=l.length;if(e.length===t&&u!==d)for(var r=0,n=Array.from(e);r<n.length;r+=1){var a=n[r];i.push((a-u)/(d-u))}else{for(var s=0;s<t;s++)i.push(s/(t-1));if(e.length>2){var c=e.map((function(t,r){return r/(e.length-1)})),h=e.map((function(e){return(e-u)/(d-u)}));h.every((function(e,t){return c[t]===e}))||(_=function(e){if(e<=0||e>=1)return e;for(var t=0;e>=h[t+1];)t++;var r=(e-h[t])/(h[t+1]-h[t]);return c[t]+r*(c[t+1]-c[t])})}}return o=[u,d],E},E.mode=function(e){return arguments.length?(t=e,C(),E):t},E.range=function(e,t){return m(e),E},E.out=function(e){return c=e,E},E.spread=function(e){return arguments.length?(n=e,E):n},E.correctLightness=function(e){return null==e&&(e=!0),h=e,C(),v=h?function(e){for(var t=b(0,!0).lab()[0],r=b(1,!0).lab()[0],n=t>r,o=b(e,!0).lab()[0],i=t+(r-t)*e,a=o-i,s=0,l=1,c=20;Math.abs(a)>.01&&c-- >0;)n&&(a*=-1),a<0?(s=e,e+=.5*(l-e)):(l=e,e+=.5*(s-e)),o=b(e,!0).lab()[0],a=o-i;return e}:function(e){return e},E},E.padding=function(e){return null!=e?("number"===oi(e)&&(e=[e,e]),a=e,E):a},E.colors=function(t,r){arguments.length<2&&(r="hex");var n=[];if(0===arguments.length)n=l.slice(0);else if(1===t)n=[E(.5)];else if(t>1){var i=o[0],a=o[1]-i;n=si(0,t).map((function(e){return E(i+e/(t-1)*a)}))}else{e=[];var c=[];if(s&&s.length>2)for(var u=1,d=s.length,h=1<=d;h?u<d:u>d;h?u++:u--)c.push(.5*(s[u-1]+s[u]));else c=o;n=c.map((function(e){return E(e)}))}return ni[r]&&(n=n.map((function(e){return e[r]()}))),n},E.cache=function(e){return null!=e?(f=e,E):f},E.gamma=function(e){return null!=e?(g=e,E):g},E.nodata=function(e){return null!=e?(r=ni(e),E):r},E};function si(e,t,r){for(var n=[],o=e<t,i=t,a=e;o?a<i:a>i;o?a++:a--)n.push(a);return n}var li=b,ci=ai,ui=function(e){for(var t=[1,1],r=1;r<e;r++){for(var n=[1],o=1;o<=t.length;o++)n[o]=(t[o]||0)+t[o-1];t=n}return t},di=function(e){var t,r,n,o,i,a,s;if(2===(e=e.map((function(e){return new li(e)}))).length)t=e.map((function(e){return e.lab()})),i=t[0],a=t[1],o=function(e){var t=[0,1,2].map((function(t){return i[t]+e*(a[t]-i[t])}));return new li(t,"lab")};else if(3===e.length)r=e.map((function(e){return e.lab()})),i=r[0],a=r[1],s=r[2],o=function(e){var t=[0,1,2].map((function(t){return(1-e)*(1-e)*i[t]+2*(1-e)*e*a[t]+e*e*s[t]}));return new li(t,"lab")};else if(4===e.length){var l;n=e.map((function(e){return e.lab()})),i=n[0],a=n[1],s=n[2],l=n[3],o=function(e){var t=[0,1,2].map((function(t){return(1-e)*(1-e)*(1-e)*i[t]+3*(1-e)*(1-e)*e*a[t]+3*(1-e)*e*e*s[t]+e*e*e*l[t]}));return new li(t,"lab")}}else{if(!(e.length>=5))throw new RangeError("No point in running bezier with only one color.");var c,u,d;c=e.map((function(e){return e.lab()})),d=e.length-1,u=ui(d),o=function(e){var t=1-e,r=[0,1,2].map((function(r){return c.reduce((function(n,o,i){return n+u[i]*Math.pow(t,d-i)*Math.pow(e,i)*o[r]}),0)}));return new li(r,"lab")}}return o},hi=function(e){var t=di(e);return t.scale=function(){return ci(t)},t},pi=E,fi=function(e,t,r){if(!fi[r])throw new Error("unknown blend mode "+r);return fi[r](e,t)},gi=function(e){return function(t,r){var n=pi(r).rgb(),o=pi(t).rgb();return pi.rgb(e(n,o))}},mi=function(e){return function(t,r){var n=[];return n[0]=e(t[0],r[0]),n[1]=e(t[1],r[1]),n[2]=e(t[2],r[2]),n}},yi=function(e){return e},vi=function(e,t){return e*t/255},_i=function(e,t){return e>t?t:e},bi=function(e,t){return e>t?e:t},Ci=function(e,t){return 255*(1-(1-e/255)*(1-t/255))},Ei=function(e,t){return t<128?2*e*t/255:255*(1-2*(1-e/255)*(1-t/255))},Ti=function(e,t){return 255*(1-(1-t/255)/(e/255))},Si=function(e,t){return 255===e||(e=t/255*255/(1-e/255))>255?255:e};fi.normal=gi(mi(yi)),fi.multiply=gi(mi(vi)),fi.screen=gi(mi(Ci)),fi.overlay=gi(mi(Ei)),fi.darken=gi(mi(_i)),fi.lighten=gi(mi(bi)),fi.dodge=gi(mi(Si)),fi.burn=gi(mi(Ti));for(var Pi=fi,wi=p.type,xi=p.clip_rgb,Oi=p.TWOPI,$i=Math.pow,Ii=Math.sin,Ri=Math.cos,Ai=E,Di=function(e,t,r,n,o){void 0===e&&(e=300),void 0===t&&(t=-1.5),void 0===r&&(r=1),void 0===n&&(n=1),void 0===o&&(o=[0,1]);var i,a=0;"array"===wi(o)?i=o[1]-o[0]:(i=0,o=[o,o]);var s=function(s){var l=Oi*((e+120)/360+t*s),c=$i(o[0]+i*s,n),u=(0!==a?r[0]+s*a:r)*c*(1-c)/2,d=Ri(l),h=Ii(l);return Ai(xi([255*(c+u*(-.14861*d+1.78277*h)),255*(c+u*(-.29227*d-.90649*h)),255*(c+u*(1.97294*d)),1]))};return s.start=function(t){return null==t?e:(e=t,s)},s.rotations=function(e){return null==e?t:(t=e,s)},s.gamma=function(e){return null==e?n:(n=e,s)},s.hue=function(e){return null==e?r:("array"===wi(r=e)?0==(a=r[1]-r[0])&&(r=r[1]):a=0,s)},s.lightness=function(e){return null==e?o:("array"===wi(e)?(o=e,i=e[1]-e[0]):(o=[e,e],i=0),s)},s.scale=function(){return Ai.scale(s)},s.hue(r),s},Li=b,Ni="0123456789abcdef",Mi=Math.floor,ki=Math.random,Fi=function(){for(var e="#",t=0;t<6;t++)e+=Ni.charAt(Mi(16*ki()));return new Li(e,"hex")},ji=s,Bi=Math.log,Wi=Math.pow,Vi=Math.floor,Hi=Math.abs,Gi=function(e,t){void 0===t&&(t=null);var r={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};return"object"===ji(e)&&(e=Object.values(e)),e.forEach((function(e){t&&"object"===ji(e)&&(e=e[t]),null==e||isNaN(e)||(r.values.push(e),r.sum+=e,e<r.min&&(r.min=e),e>r.max&&(r.max=e),r.count+=1)})),r.domain=[r.min,r.max],r.limits=function(e,t){return Ui(r,e,t)},r},Ui=function(e,t,r){void 0===t&&(t="equal"),void 0===r&&(r=7),"array"==ji(e)&&(e=Gi(e));var n=e.min,o=e.max,i=e.values.sort((function(e,t){return e-t}));if(1===r)return[n,o];var a=[];if("c"===t.substr(0,1)&&(a.push(n),a.push(o)),"e"===t.substr(0,1)){a.push(n);for(var s=1;s<r;s++)a.push(n+s/r*(o-n));a.push(o)}else if("l"===t.substr(0,1)){if(n<=0)throw new Error("Logarithmic scales are only possible for values > 0");var l=Math.LOG10E*Bi(n),c=Math.LOG10E*Bi(o);a.push(n);for(var u=1;u<r;u++)a.push(Wi(10,l+u/r*(c-l)));a.push(o)}else if("q"===t.substr(0,1)){a.push(n);for(var d=1;d<r;d++){var h=(i.length-1)*d/r,p=Vi(h);if(p===h)a.push(i[p]);else{var f=h-p;a.push(i[p]*(1-f)+i[p+1]*f)}}a.push(o)}else if("k"===t.substr(0,1)){var g,m=i.length,y=new Array(m),v=new Array(r),_=!0,b=0,C=null;(C=[]).push(n);for(var E=1;E<r;E++)C.push(n+E/r*(o-n));for(C.push(o);_;){for(var T=0;T<r;T++)v[T]=0;for(var S=0;S<m;S++)for(var P=i[S],w=Number.MAX_VALUE,x=void 0,O=0;O<r;O++){var $=Hi(C[O]-P);$<w&&(w=$,x=O),v[x]++,y[S]=x}for(var I=new Array(r),R=0;R<r;R++)I[R]=null;for(var A=0;A<m;A++)null===I[g=y[A]]?I[g]=i[A]:I[g]+=i[A];for(var D=0;D<r;D++)I[D]*=1/v[D];_=!1;for(var L=0;L<r;L++)if(I[L]!==C[L]){_=!0;break}C=I,++b>200&&(_=!1)}for(var N={},M=0;M<r;M++)N[M]=[];for(var k=0;k<m;k++)N[g=y[k]].push(i[k]);for(var F=[],j=0;j<r;j++)F.push(N[j][0]),F.push(N[j][N[j].length-1]);F=F.sort((function(e,t){return e-t})),a.push(F[0]);for(var B=1;B<F.length;B+=2){var W=F[B];isNaN(W)||-1!==a.indexOf(W)||a.push(W)}}return a},Yi={analyze:Gi,limits:Ui},zi=b,Ki=function(e,t){e=new zi(e),t=new zi(t);var r=e.luminance(),n=t.luminance();return r>n?(r+.05)/(n+.05):(n+.05)/(r+.05)},Zi=b,Xi=Math.sqrt,Ji=Math.pow,Qi=Math.min,qi=Math.max,ea=Math.atan2,ta=Math.abs,ra=Math.cos,na=Math.sin,oa=Math.exp,ia=Math.PI,aa=function(e,t,r,n,o){void 0===r&&(r=1),void 0===n&&(n=1),void 0===o&&(o=1);var i=function(e){return 360*e/(2*ia)},a=function(e){return 2*ia*e/360};e=new Zi(e),t=new Zi(t);var s=Array.from(e.lab()),l=s[0],c=s[1],u=s[2],d=Array.from(t.lab()),h=d[0],p=d[1],f=d[2],g=(l+h)/2,m=(Xi(Ji(c,2)+Ji(u,2))+Xi(Ji(p,2)+Ji(f,2)))/2,y=.5*(1-Xi(Ji(m,7)/(Ji(m,7)+Ji(25,7)))),v=c*(1+y),_=p*(1+y),b=Xi(Ji(v,2)+Ji(u,2)),C=Xi(Ji(_,2)+Ji(f,2)),E=(b+C)/2,T=i(ea(u,v)),S=i(ea(f,_)),P=T>=0?T:T+360,w=S>=0?S:S+360,x=ta(P-w)>180?(P+w+360)/2:(P+w)/2,O=1-.17*ra(a(x-30))+.24*ra(a(2*x))+.32*ra(a(3*x+6))-.2*ra(a(4*x-63)),$=w-P;$=ta($)<=180?$:w<=P?$+360:$-360,$=2*Xi(b*C)*na(a($)/2);var I=h-l,R=C-b,A=1+.015*Ji(g-50,2)/Xi(20+Ji(g-50,2)),D=1+.045*E,L=1+.015*E*O,N=30*oa(-Ji((x-275)/25,2)),M=-2*Xi(Ji(E,7)/(Ji(E,7)+Ji(25,7)))*na(2*a(N)),k=Xi(Ji(I/(r*A),2)+Ji(R/(n*D),2)+Ji($/(o*L),2)+M*(R/(n*D))*($/(o*L)));return qi(0,Qi(100,k))},sa=b,la=function(e,t,r){void 0===r&&(r="lab"),e=new sa(e),t=new sa(t);var n=e.get(r),o=t.get(r),i=0;for(var a in n){var s=(n[a]||0)-(o[a]||0);i+=s*s}return Math.sqrt(i)},ca=b,ua=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];try{return new(Function.prototype.bind.apply(ca,[null].concat(e))),!0}catch(e3){return!1}},da=E,ha=ai,pa={cool:function(){return ha([da.hsl(180,1,.9),da.hsl(250,.7,.4)])},hot:function(){return ha(["#000","#f00","#ff0","#fff"]).mode("rgb")}},fa={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},ga=0,ma=Object.keys(fa);ga<ma.length;ga+=1){var ya=ma[ga];fa[ya.toLowerCase()]=fa[ya]}var va=fa,_a=E;return _a.average=ti,_a.bezier=hi,_a.blend=Pi,_a.cubehelix=Di,_a.mix=_a.interpolate=po,_a.random=Fi,_a.scale=ai,_a.analyze=Yi.analyze,_a.contrast=Ki,_a.deltaE=aa,_a.distance=la,_a.limits=Yi.limits,_a.valid=ua,_a.scales=pa,_a.colors=Mr,_a.brewer=va,_a}();var chromaExports=chroma$1.exports;const chroma=getDefaultExportFromCjs(chromaExports),SliderType={Default:"default",Colour:"colour",Bright:"bright",Balance:"balance"},Slider=({className:e,value:t,onChange:r,min:n=0,max:o=100,disabled:i=!1,step:a,marks:s,type:l=SliderType.Default})=>{const[c,u]=reactExports.useState(null),[d,h]=reactExports.useState(),[p,f]=reactExports.useState(),[g,m]=reactExports.useState();return reactExports.useEffect((()=>{l===SliderType.Colour?u(["#FF3200","#FFE500","#3EFE00","#00FFF0","#0045FF","#AA00FF","#FF0564","#FF0027"]):l===SliderType.Bright?u(["#FFFFFF","#FF0000"]):l===SliderType.Balance?u(["#FFFFFF","#000000"]):u(null)}),[l]),reactExports.useEffect((()=>{isNil$2(c)||h({background:"linear-gradient(90deg,".concat(c.join(","),")")})}),[c]),reactExports.useEffect((()=>{if(!isNil$2(t)&&!isNil$2(c)){const e=(t-n)/(o-n),r=chroma.scale(c)(e).hex();f({foreColor:r,backColor:"white"})}}),[c,o,n,t]),reactExports.useEffect((()=>{isNil$2(t)||isNil$2(c)||m({background:"transparent"})}),[c,o,n,t]),jsxRuntimeExports.jsx(Slider$2,{className:classNames$1(e,{"fvs-custom-slider":l!==SliderType.Default}),styles:{track:g,rail:d},handleBg:p,value:t,onChange:r,min:n,max:o,disabled:i,step:a,marks:s})},SliderInput=({value:e,onChange:t,min:r=0,max:n=100,disabled:o=!1,style:i,className:a="",step:s,sliderType:l,sliderTestId:c,...u})=>jsxRuntimeExports.jsxs("div",{className:classNames$1("fd-biz-slider-input",a),style:i,children:[jsxRuntimeExports.jsxs("div",{className:"slider-wrapper",children:[jsxRuntimeExports.jsx(Slider,{className:"slider-bar",value:e,onChange:t,min:r,max:n,disabled:o,step:s,type:l}),jsxRuntimeExports.jsxs("div",{className:"slider-label",children:[jsxRuntimeExports.jsx("span",{children:r}),jsxRuntimeExports.jsx("span",{className:classNames$1({"not-full-label":e!==n}),children:n})]})]}),jsxRuntimeExports.jsx(NumberInput,{wrapperClassName:"slider-number-input",width:56,...{value:e,onChange:t,min:r,max:n,disabled:o,step:s,...u}})]}),VerticalItem=({label:e,children:t,prefix:r,className:n,style:o,icon:i})=>jsxRuntimeExports.jsxs("div",{style:o,className:classNames$1(n,"fd-biz-gradient-vertical-item"),children:[jsxRuntimeExports.jsxs("div",{className:"vertical-item-label",children:[r,jsxRuntimeExports.jsxs("div",{className:"vertical-item-content",children:[e,i]})]}),jsxRuntimeExports.jsx("div",{children:t})]}),LinearGradientColorSelector=({value:e,disableAlpha:t=!1,className:r,onChange:n,style:o})=>{const i=getLinearGradientColor(e,90),{locale:a}=ThemeContext.useContainer();return jsxRuntimeExports.jsxs("div",{style:o,children:[jsxRuntimeExports.jsx("div",{className:classNames$1(r,"fd-biz-linear-gradient-color-select"),children:jsxRuntimeExports.jsxs("div",{style:{background:i},className:"color-select-content",children:[jsxRuntimeExports.jsx("div",{className:"color-select",children:jsxRuntimeExports.jsx(ThemeColorPickerTrigger,{value:e.colors[0].value,onChange:t=>{n({...e,colors:[{value:t,position:"0"},...e.colors.slice(1)]})},disableAlpha:t})}),jsxRuntimeExports.jsx("div",{className:"color-select",children:jsxRuntimeExports.jsx(ThemeColorPickerTrigger,{value:e.colors[e.colors.length-1].value,onChange:t=>{n({...e,colors:[...e.colors.slice(0,e.colors.length-1),{value:t,position:"100%"}]})},disableAlpha:t})})]})}),jsxRuntimeExports.jsx(VerticalItem,{label:a.linearNumber,className:"fd-biz-linear-gradient-angle",children:jsxRuntimeExports.jsx(SliderInput,{value:e.angle,style:{width:"100%"},max:360,suffix:"°",onChange:t=>{n({...e,angle:t})}})})]})};function getLinearGradientColor(e,t=null){const r=e.colors.map((e=>[e.value,e.position].join(" ").trim())).join(",");return"linear-gradient(".concat(null!=t?t:e.angle,"deg,").concat(r,")")}function RadioGroup(e){const{onChange:t,value:r,optionType:n="button",buttonStyle:o="solid",className:i,...a}=e;return jsxRuntimeExports.jsx(Radio$4.Group,{className:classNames$1("fd-biz-radio-group",i),buttonStyle:o,onChange:t,value:r,optionType:n,...a})}var CLONE_DEEP_FLAG$2=1,CLONE_SYMBOLS_FLAG$3=4;function cloneDeep$1(e){return baseClone$2(e,CLONE_DEEP_FLAG$2|CLONE_SYMBOLS_FLAG$3)}const SINGLE_COLOR="singleColor",LINEAR_GRADIENT_COLOR="linearGradientColor",DEFAULT_SINGLE_COLOR="#FFFFFFFF",DEFAULT_START_GRADIENT_COLOR="#43A5FFFF",DEFAULT_END_GRADIENT_COLOR="#FFFFFFFF",CompositeColorSelector=({onChange:e,value:t,disableAlpha:r,defaultSingleColor:n=DEFAULT_SINGLE_COLOR,defaultGradientColor:o={colors:[{value:DEFAULT_START_GRADIENT_COLOR,position:"0"},{value:DEFAULT_END_GRADIENT_COLOR,position:"100%"}],angle:0}})=>{const{locale:i}=ThemeContext.useContainer();return jsxRuntimeExports.jsxs("div",{className:"fd-biz-composite-color-selector",children:[jsxRuntimeExports.jsx(RadioGroup,{value:isString$2(t)?SINGLE_COLOR:LINEAR_GRADIENT_COLOR,className:"radio-group",options:[{label:i.singleColor,value:SINGLE_COLOR},{label:i.linearGradientColor,value:LINEAR_GRADIENT_COLOR}],onChange:t=>{e(t===SINGLE_COLOR?n:o)}}),jsxRuntimeExports.jsx("div",{className:"color-content",children:isString$2(t)?jsxRuntimeExports.jsx(ThemeColorPicker,{value:t,onChange:e,disableAlpha:r}):jsxRuntimeExports.jsx(LinearGradientColorSelector,{value:cloneDeep$1(t),onChange:e,disableAlpha:r})})]})},getTemplateThemeDefaultColor=e=>{switch(e){case TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.BACKGROUND:return getThemeVariableColor(PREFIX_THEME_KEY,TEMPLATE_THEME_DEFAULT_COLOR_ROW,TEMPLATE_THEME_DEFAULT_COLOR_BACKGROUND_COL);case TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.TEXT:return getThemeVariableColor(PREFIX_THEME_KEY,TEMPLATE_THEME_DEFAULT_COLOR_ROW,TEMPLATE_THEME_DEFAULT_COLOR_TEXT_COL);case TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.ONE:return getThemeVariableColor(PREFIX_THEME_KEY,TEMPLATE_THEME_DEFAULT_COLOR_ROW,TEMPLATE_THEME_DEFAULT_COLOR_ONE_COL);default:return""}},LabelInnerItem=({children:e,style:t,isBottom:r=!1,...n})=>jsx("div",{className:r?"":"label-inner-item",style:t,...n,children:e});function LabelItem$1({label:e,children:t,hide:r,className:n,style:o,hideBottom:i=!1}){return r?jsx(Fragment,{}):isUndefined$3(e)?jsx(Fragment,{children:t}):jsxs(Row$1,{className:classNames$1(n,{"row-item":!i}),style:o,children:[jsx(Col,{span:9,children:e}),jsx(Col,{span:15,children:t})]})}const MarqueeConfig=e=>{const t=t=>{e.onChange({...e.value,...t})},r=e.value.enable||!1;return jsxs("div",{className:"marquee-config",children:[jsx(Checkbox$4,{value:r,onChange:e=>t({enable:e}),className:"marquee-check-box",text:duchampIntl.get("Duchamp-Marquee_Enable_Tip")}),r?jsx(MarqueeContent,{value:e.value,onChange:t}):null]})},MarqueeContent=e=>jsxs(GridItem,{style:{marginTop:12},children:[isNil$3(e.value.content)?null:jsx(LineItem,{label:duchampIntl.get("Duchamp-Scroll_Content"),children:jsx(RadioGroup$1,{value:e.value.content,options:[{label:duchampIntl.get("Duchamp-Marquee_Content_Item"),value:MARQUEE_CONTENT$1.ITEM},{label:duchampIntl.get("Duchamp-Marquee_Content_Full"),value:MARQUEE_CONTENT$1.FULL}],onChange:t=>{e.onChange({content:t})}})}),isNil$3(e.value.mode)?null:jsx(LineItem,{label:duchampIntl.get("Duchamp-Scroll_Mode"),children:jsx(RadioGroup$1,{value:e.value.mode,options:[{label:duchampIntl.get("Duchamp-Marquee_Mode_End_To_End"),value:MARQUEE_MODE$1.END_TO_END},{label:duchampIntl.get("Duchamp-Marquee_Mode_Start_New"),value:MARQUEE_MODE$1.START_NEW}],onChange:t=>{e.onChange({mode:t})}})}),jsx(LineItem,{label:duchampIntl.get("Duchamp-Scroll_Direction"),children:jsx(RadioGroup$1,{value:e.value.direction,mode:"grid",options:[{label:duchampIntl.get("Duchamp-Basic_To_Up"),value:MARQUEE_DIRECTION$1.TOP},{label:duchampIntl.get("Duchamp-Basic_To_Down"),value:MARQUEE_DIRECTION$1.BOTTOM},{label:duchampIntl.get("Duchamp-Basic_To_Left"),value:MARQUEE_DIRECTION$1.LEFT,style:{borderTop:"none"}},{label:duchampIntl.get("Duchamp-Basic_To_Right"),value:MARQUEE_DIRECTION$1.RIGHT,style:{borderTop:"none"}}],onChange:t=>e.onChange({direction:t})})}),jsx(LineItem,{label:duchampIntl.get("Duchamp-Scroll_Speed"),children:jsx(NumberInput$1,{value:e.value.speed,onChange:t=>{e.onChange({speed:t})},style:{paddingRight:26},min:1,suffix:"px/s"})}),jsx(LineItem,{label:duchampIntl.get("Duchamp-Scroll_Interval"),children:jsx(TimeUnitInput,{value:e.value.stay,onChange:t=>{e.onChange({stay:t})}})})]}),MarqueeHeader=()=>jsxs("div",{className:"marquee-header",children:[jsx("span",{className:"text",children:duchampIntl.get("Duchamp-Marquee")}),jsx(IconPopover,{icon:"icon-help",className:"collapse-header-tip",text:jsx(TipText,{}),placement:"top"})]}),TipText=()=>jsxs("div",{className:"marquee-tip",children:[jsx("span",{className:"text",children:duchampIntl.get("Duchamp-Marquee_Tip")}),jsx(Typography.Link,{href:duchampIntl.get("Duchamp-Marquee_Help_Link"),target:"_blank",children:duchampIntl.get("Duchamp-Marquee_Link")})]});function isInstanceofDegradeable(e){return!!e&&!isUndefined$3(e.degradeRender)}function isInstanceofHostDegradeable(e){return!!e&&!isUndefined$3(e.hostDegradeRender)}const SizeInput=({width:e,height:t,keepRatio:r=!1,onChange:n,onKeepRatioChange:o,maxWidth:i,maxHeight:a,minWidth:s,minHeight:l})=>{const c=reactExports.useMemo((()=>{const n=getEffectBoundingSize({minWidth:s,minHeight:l,maxWidth:i,maxHeight:a});if(e&&t){return calculateBoundingSize({width:e,height:t,keepRatio:r},n)}return n}),[r,e,t,s,l,i,a]),u=r=>{const{width:o,height:i}=calculateSizeWithThreshold(r,c);e===o&&t===i||null==n||n({width:o,height:i})};return jsxs("div",{className:"size-input",children:[jsxs("div",{className:"size-space-between",children:[jsx("span",{className:"size-title",children:"W"}),jsx(NumberInput$1,{value:e,max:c.maxWidth,min:c.minWidth,onChange:o=>{r&&e&&t?u({width:o,height:floor$2(o*t/e)}):null==n||n({width:o,height:t})}})]}),jsx(Icon$2,r?{title:duchampIntl.get("Duchamp-Unlock_Ratio"),type:"icon-lock",onClick:()=>{null==o||o(!1)}}:{title:duchampIntl.get("Duchamp-Lock_Ratio"),type:"icon-unlock",onClick:()=>{null==o||o(!0)}}),jsxs("div",{className:"size-space-between",children:[jsx("span",{className:"size-title",children:"H"}),jsx(NumberInput$1,{value:t,max:c.maxHeight,min:c.minHeight,onChange:o=>{r&&e&&t?u({width:floor$2(o*e/t),height:o}):null==n||n({width:e,height:o})}})]})]})},patchResizeCallback=(e,t,r,n)=>{switch(t){case"debounce":return debounce$4(e,r,n);case"throttle":return throttle$1(e,r,n);default:return e}},useCallbackRef=e=>{const t=reactExports.useRef(e);return reactExports.useEffect((()=>{t.current=e})),reactExports.useMemo((()=>(...e)=>{var r;return null===(r=t.current)||void 0===r?void 0:r.call(t,...e)}),[])},useRefProxy=e=>{const[t,r]=reactExports.useState((null==e?void 0:e.current)||null);e&&setTimeout((()=>{e.current!==t&&r(e.current)}),0);return{refProxy:reactExports.useMemo((()=>new Proxy((e=>{e!==t&&r(e)}),{get:(e,r)=>"current"===r?t:e[r],set:(e,t,n)=>("current"===t?r(n):e[t]=n,!0)})),[t]),refElement:t,setRefElement:r}},getDimensions$2=(e,t)=>"border-box"===t?{width:e.borderBoxSize[0].inlineSize,height:e.borderBoxSize[0].blockSize}:"content-box"===t?{width:e.contentBoxSize[0].inlineSize,height:e.contentBoxSize[0].blockSize}:{width:e.contentRect.width,height:e.contentRect.height};function useResizeDetector({skipOnMount:e=!1,refreshMode:t,refreshRate:r=1e3,refreshOptions:n,handleWidth:o=!0,handleHeight:i=!0,targetRef:a,observerOptions:s,onResize:l}={}){const c=reactExports.useRef(e),u=useCallbackRef(l),[d,h]=reactExports.useState({width:void 0,height:void 0}),{refProxy:p,refElement:f}=useRefProxy(a),{box:g}=s||{},m=reactExports.useCallback((e=>{if(!o&&!i)return;if(c.current)return void(c.current=!1);e.forEach((e=>{const t=getDimensions$2(e,g);h((r=>((e,t)=>o&&e.width!==t.width||i&&e.height!==t.height)(r,t)?(null==u||u({width:t.width,height:t.height,entry:e}),t):r))}))}),[o,i,c,g]),y=reactExports.useCallback(patchResizeCallback(m,t,r,n),[m,t,r,n]);return reactExports.useEffect((()=>{let e;return f?(e=new window.ResizeObserver(y),e.observe(f,s)):(d.width||d.height)&&(null==u||u({width:null,height:null,entry:null}),h({width:void 0,height:void 0})),()=>{var t,r,n;null===(t=null==e?void 0:e.disconnect)||void 0===t||t.call(e),null===(n=(r=y).cancel)||void 0===n||n.call(r)}}),[y,f]),Object.assign({ref:p},d)}const useScrollBarInitialize=(e,t)=>{const[r,n]=reactExports.useState(!1);return reactExports.useEffect((()=>{var o;const i=e.current instanceof HTMLDivElement?e.current:null==(o=e.current)?void 0:o.getElement();if(!i||r)return;const a=()=>{n(!0)};return t.forEach((e=>{i.addEventListener(e,a,{once:!0})})),()=>{t.forEach((e=>{i.removeEventListener(e,a)}))}}),[t,r,e]),r};function useAdaptiveStyle({bounds:e,padding:t,borderLine:r,renderWithoutScale:n,autoHeight:o,adaptiveScale:i}){const{width:a,height:s,matrix:l}=e,c=l.join(),u=reactExports.useMemo((()=>({...new Metrics(a,s,l).toCssObject(),height:o?void 0:s})),[o,s,a,l,c]);return{wrapperStyle:reactExports.useMemo((()=>calculateAdaptiveScaleStyle({style:u,adaptiveScale:i,withTransform:!1})),[u,i]),...reactExports.useMemo((()=>{const{left:e,top:o,right:a,bottom:s}=t,l=i?convertAdaptiveScaleToTransformScale(i):1,{borderWidth:c}=convertBorderStyle(r),{borderWidth:d}=convertBorderStyle(r,l),h=d/l,{width:p,height:f,left:g,top:m,offsetLeft:y,offsetRight:v,offsetTop:_,offsetBottom:b,offsetLeftWithoutScale:C,offsetRightWithoutScale:E,...T}=calculateAdaptiveScaleStyle({style:{...u,offsetLeft:e+h,offsetRight:a+h,offsetTop:o+h,offsetBottom:s+h,offsetLeftWithoutScale:e+c,offsetRightWithoutScale:a+c},adaptiveScale:i,withTransform:!n}),S=p-C-E,P=f?f-_-b:void 0;return{contentBounds:{width:S,height:P,left:g+y,top:m+_},contentStyle:{width:S,height:P,...T}}}),[t,r,n,u,i])}}function useZoomScale({width:e,height:t,isZoomed:r,adaptiveScale:n},o=.8){const[i,a]=reactExports.useState(0);return reactExports.useEffect((()=>{const e=throttle({interval:200},(()=>{a((e=>e+1))}));return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[t,r,o,e]),reactExports.useMemo((()=>{if(!r||!n)return;const{width:i,height:a}=calculateAdaptiveScaleStyle({style:{width:e,height:t},adaptiveScale:n,withTransform:!1}),{width:s,height:l}=document.body.getBoundingClientRect(),c=Math.min(s*o/i,l*o/a);return{horizontal:n.horizontal*c,vertical:n.vertical*c}}),[r,e,t,n,o,i])}function useLazyRender(e,t=!1){const{ref:r,inView:n}=useInView({threshold:0,triggerOnce:!0});return reactExports.useEffect((()=>{if(t)return r(e.current),()=>{r(null)}}),[t,e,r]),{lazy:t&&!n}}function getTransformOrigin(e,t){const{origin:r,adaptiveScale:n}=t||{};if(r){const{width:t,height:o,matrix:i}=r,a=new Metrics(t,o,i),{width:s,height:l,matrix:c}=e,u=new Metrics(s,l,c);if(n){const e=calculateAdaptiveScaleStyle({adaptiveScale:n,style:a.toCssObject(),withTransform:!1});e&&a.resize(e.width,e.height).setTranslate(e.left,e.top);const t=calculateAdaptiveScaleStyle({adaptiveScale:n,style:u.toCssObject(),withTransform:!1});t&&u.resize(t.width,t.height).setTranslate(t.left,t.top)}const d=a.getCenter(),[h,p]=u.getPosition();return"".concat(d[0]-h,"px ").concat(d[1]-p,"px")}return"center center"}const FLUID_LAYOUT_CONFIG={WIDTH:390,HEIGHT:844,GRID:30};function calculateFluidGridHeight(e,t){return(FLUID_LAYOUT_CONFIG.HEIGHT-t)/FLUID_LAYOUT_CONFIG.GRID*e-t}function transformToMagneticLayoutItems(e,t){const r=[];return e.forEach((e=>{const{height:n,matrix:o}=e,[,i]=new Transform$2(o).getPosition(),a=i+n+t,s=r.length-1,l=r.at(s);l&&i<l.bottom?(l.items.push(e),l.bottom=Math.max(l.bottom,a)):r.push({items:[e],bottom:a})})),r.map((e=>e.items))}const ANIMATION_MOTION={START:"start",END:"end"},ANIMATION_TYPE={FADE_IN:"fadeIn",FADE_IN_LEFT:"fadeInLeft",FADE_IN_RIGHT:"fadeInRight",FADE_IN_UP:"fadeInUp",FADE_IN_DOWN:"fadeInDown",FADE_OUT:"fadeOut",FADE_OUT_LEFT:"fadeOutLeft",FADE_OUT_RIGHT:"fadeOutRight",FADE_OUT_UP:"fadeOutUp",FADE_OUT_DOWN:"fadeOutDown"};function useTransitionState(e,t){const[r,n]=reactExports.useState(e);return reactExports.useEffect((()=>{if(null==t||t===e)return;const r=window.requestAnimationFrame((()=>{n(t)}));return()=>window.cancelAnimationFrame(r)}),[e,t]),[r,n]}const useAutoHeight=(e=1)=>{const t=reactExports.useRef(null),[r,n]=reactExports.useState(0);reactExports.useEffect((()=>{if(!t.current)return;const e=new window.ResizeObserver((e=>{const t=e[0].contentRect.height;n(t)}));return e.observe(t.current),()=>e.disconnect()}),[]);const o=reactExports.useMemo((()=>({transform:1!==e?"scale(".concat(e,")"):void 0,width:"".concat(100/e,"%"),transformOrigin:"0 0",height:"auto"})),[e]);return{height:r?r*e:"auto",elementRef:t,elementStyle:o}},AutoHeightWrapper=({className:e,adaptiveScale:t={horizontal:1,vertical:1},children:r})=>{const n=convertAdaptiveScaleToTransformScale(t),{elementRef:o,height:i,elementStyle:a}=useAutoHeight(n);return jsx("div",{className:e,style:{height:i},children:jsx("div",{ref:o,className:"duchamp-auto-height-wrapper",style:a,children:r})})};class ResourceHandler{constructor(e,t){this.resourceCenter=e,this.baseUrl=t}getResources(e){return convertToRecord(e.map((e=>({name:e,value:this.getResource(e)}))))}getResource(e){const t=getResourceInfoByID(e,this.resourceCenter);if(!t)return null;const{subResource:r,payload:n}=t,o=n?{url:this.getResourceUrl(t),payload:n}:{url:this.getResourceUrl(t)};return r?{...o,subResource:Object.fromEntries(arrify(Object.entries(r)).filterMap((([e,t])=>{const r=this.getResource(t);return r&&[e,r]})).collect())}:o}getInfoByID(e){return this.resourceCenter.getInfoByID(e)}getResourceUrl(e){const t=this.resourceCenter.getResourceURL(e);return isRemoteURL(t)?t:this.baseUrl+t}}class SingletonManager{constructor(){__publicField(this,"instanceMap",new Map),__publicField(this,"releaseMap",new Map)}add(e,{value:t,container:r,size:n}){this.instanceMap.set(e,{value:t,idle:1,container:r,size:n}),this.releaseMap.delete(e)}get(e){const t=this.instanceMap.get(e);if(t)return{container:t.container,size:t.size,computed:t.computed}}update(e,t){const r=this.instanceMap.get(e);r&&this.instanceMap.set(e,{...r,...t})}mount(e){const t=this.instanceMap.get(e);if(t)return t.idle++,this.releaseMap.delete(e),t.value}unmount(e,t,r=!0){const n=this.instanceMap.get(e);if(n){if(n.idle--,0===n.idle){const o=()=>{t(n.container),n.container.remove()};r?(o(),this.instanceMap.delete(e)):this.releaseMap.set(e,(()=>{o()}))}}else t()}clear(){this.releaseMap.forEach((e=>e())),this.releaseMap.clear(),this.instanceMap.clear()}}function useFvsKit(e){const t=useI18n();return reactExports.useMemo((()=>{var r;return{i18n:t,refresh:e.recalculate.bind(e),calculate:e.calculate.bind(e),fetch:e.fetch,emit:e.emitEvent.bind(e),env:e.env,special:{getComputedParams:e.getComputedParams.bind(e),toggleZoom:"toggleZoom"in e&&"function"==typeof e.toggleZoom?e.toggleZoom.bind(e):()=>{},isZoomed:!!e.isZoomed,showMobilePopup:e.showMobilePopup.bind(e),duchampApi:e.duchampApi,root:e.root,simpleJson:e.simpleJson,getDataDictionary:null==(r=e.getDataDictionary)?void 0:r.bind(e)}}}),[t,e])}const LIFE_CYCLE_STATUS={BEFORE_MOUNT:0,MOUNTED:1,RENDERED:2},useLifeCycle=()=>{const e=reactExports.useRef(LIFE_CYCLE_STATUS.BEFORE_MOUNT);return reactExports.useMemo((()=>({setMounted:()=>{e.current=LIFE_CYCLE_STATUS.MOUNTED},canMount:()=>e.current===LIFE_CYCLE_STATUS.BEFORE_MOUNT,reset:()=>{e.current=LIFE_CYCLE_STATUS.BEFORE_MOUNT},canRender:()=>e.current===LIFE_CYCLE_STATUS.MOUNTED,setRendered:()=>{e.current=LIFE_CYCLE_STATUS.RENDERED},canRefresh:()=>e.current===LIFE_CYCLE_STATUS.RENDERED,canResize:()=>e.current>=LIFE_CYCLE_STATUS.MOUNTED})),[e])};function usePropsChangedStatus(e){const t=reactExports.useRef(e),r=reactExports.useRef({changed:!1});return r.current.changed=t.current!==e,t.current=e,r.current}function useClassWidget({widgetClass:e,model:t,computed:r,state:n,runtime:o,interaction:i,instanceSymbol:a,clearWhenIdle:s=!0,adaptiveScale:l,childWidgets:c}){const u=reactExports.useRef(null),d=useWidget(e,t),h=reactExports.useRef(null),p=useLifeCycle(),f=usePropsChangedStatus(r),g=usePropsChangedStatus(n),m=usePropsChangedStatus(l),y=usePropsChangedStatus(c),v=useLatest$3(o),_=useLatest$3(i),b=useLatest$3(t.singletonManager),C=useUpdate$1(),E=reactExports.useRef(null),T=t.widgetStory.id===t.currentStory.main.id||t.widgetStory.id===t.currentStory.background.id;return reactExports.useEffect((()=>{var e,r,n;null==(n=d.restore)||n.call(d,null!=(r=t.getTempState())?r:null==(e=d.save)?void 0:e.call(d))}),[t,d]),reactExports.useEffect((()=>{y.changed&&p.setMounted()}),[c,y,p]),reactExports.useEffect((()=>{var e;const o=u.current;if(!o)return;const i=a?b.current.get(a):void 0;let s=o,y=!1;if(i){if(!T)return()=>{!T&&a&&p.setMounted()};s=i.container,o.appendChild(i.container),y=!isEqual$5(i.size,n)}if(!h.current&&p.canMount()){let e=null;const r=a&&b.current.mount(a);r?e=r:(a&&(s=document.createElement("div"),s.classList.add("singleton-widget-container"),o.appendChild(s)),e=d.mount(getWidgetContext({el:s,model:t,state:n,config:{},adaptiveScale:l})),a&&b.current.add(a,{value:e,container:s,size:n})),h.current=e,p.setMounted()}if(!h.current)return;let C=0;if(p.canResize()&&(g.changed||m.changed||y)){const o=null!=(e=null!=r?r:E.current)?e:null==i?void 0:i.computed;d.resize?o&&d.resize({...h.current,...getWidgetContext({el:s,model:t,state:n,runtime:v.current,interaction:_.current,config:o,adaptiveScale:l,childWidgets:c})}):C++}if(p.canRefresh()&&f.changed&&r&&(d.refresh?d.refresh({...h.current,...getWidgetContext({el:s,model:t,state:n,interaction:_.current,config:r,adaptiveScale:l,childWidgets:c}),runtime:{...v.current,refreshStatus:t.refreshStatus}}):C++),a&&b.current.update(a,{size:n,computed:r}),p.canRender()&&r){const e=d.render({...h.current,...getWidgetContext({el:s,model:t,state:n,runtime:v.current,interaction:_.current,config:r,adaptiveScale:l,childWidgets:c})}),o=()=>{var e,r;p.setRendered(),null==(e=t.loadFinished)||e.call(t);const n=null==(r=d.save)?void 0:r.call(d);n&&t.setTempState(n)};e instanceof Promise?e.finally((()=>{o()})):e.subscribe((e=>{var r;"finished"!==e?null==(r=t.setLoadProgress)||r.call(t,e):o()}))}else C>0&&r&&d.render({...h.current,...getWidgetContext({el:s,model:t,state:n,runtime:v.current,interaction:_.current,config:r,adaptiveScale:l,childWidgets:c})})}),[t,d,r,t.props,p,n,f,g,m,v,_,a,b,T,l,c]),reactExports.useEffect((()=>{E.current=r}),[r]),reactExports.useEffect((()=>{const e=()=>{p.setMounted(),C()};return t.addPropsChangeListener(e),()=>{var r;const n=null==(r=d.save)?void 0:r.call(d);p.setMounted(),n&&t.setTempState(n),t.removePropsChangeListener(e)}}),[t,d,p,C]),reactExports.useEffect((()=>{const e=u.current,t=b.current;if(e)return()=>{const r=h.current,n=t=>{var n;null==(n=d.unmount)||n.call(d,{...r,el:null!=t?t:e})};a?window.requestAnimationFrame((()=>{t.unmount(a,(e=>{n(e)}),s)})):n(),h.current=null,p.reset()}}),[d,p,a,b,s]),u}function getWidgetContext({el:e,model:t,state:r,runtime:n,config:o,interaction:i,adaptiveScale:a,childWidgets:s=[]}){return{el:e,config:{...t.props,...o},runtime:{...n},interaction:{...i},state:{...r,name:t.name},adaptiveScale:a,childWidgets:s,theme:t.theme,allowRenderByScreenshot:!1,env:{assetBaseUrl:"",resourceBaseUrl:""}}}function useWidget(e,t){const r=useMutableRef(useFvsKit(t)),[n]=reactExports.useState((()=>new e(r)));return n}function useMutableRef(e){const[t]=reactExports.useState(e);return reactExports.useEffect((()=>{for(const r in e)t[r]=e[r]}),[t,e]),t}const colorBackground={render(e){const{value:t,style:r,className:n}=e;return jsx("div",{className:n,style:{...r,backgroundColor:t}})},blurryLayer:({value:e})=>({backgroundColor:e})},emptyBackground={render:e=>jsx(Fragment,{})};function getImageStyle$1({imageResourceValue:e,resourceCenter:t,urlParser:r}){const{id:n,fillType:o,backgroundFillType:i,borderScale:a,hue:s,saturation:l,contrast:c,brightness:u}=e;let d={};const{imageSource:h,imageSlice:p}=getImageResourceById(t,n);return d=o===FILL_TYPE.BORDER&&p&&p.length>0?convertBorderImageStyle({imageSource:h,imageSlice:p,borderScale:a,urlParser:r}):convertBackgroundStyle({imageSource:h,backgroundFillType:i,urlParser:r}),{...d,...getFilterStyle({hue:s,saturation:l,brightness:u,contrast:c})}}function withTransition({open:e,currentType:t,prevStoryIndex:r,prevBackgroundType:n=BACKGROUND_TYPE$1.EMPTY}){const o=n===t||["internal","custom"].includes(n)&&["internal","custom"].includes(t);return e&&-1!==r&&o}const imageBackground={render:({value:e,className:t,style:r,adaptiveScale:n,resourceCenter:o,urlParser:i})=>jsx("div",{className:classNames$1(t,{contain:e.backgroundFillType===BACKGROUND_FILL_TYPE.AUTO}),style:{...r,...getImageStyle$1({resourceCenter:o,imageResourceValue:e,urlParser:i}),...calculateAdaptiveScaleStyle({style:{width:"100%",height:"100%"},adaptiveScale:n})}}),blurryLayer:({value:e,resourceCenter:t,urlParser:r})=>({...convertBackgroundStyle({imageSource:getImageResource(e,t),backgroundFillType:BACKGROUND_FILL_TYPE.STRETCH,urlParser:r}),backdropFilter:"hue-rotate(".concat(e.hue,"deg) blur(20px)")}),preload:({value:e,resourceCenter:t})=>[getImageResource(e,t)]},getImageResource=(e,t)=>{const r=getResourceInfoByID(e.id,t);return r?r.name:""};function isColorBackground(e){return e.type===BACKGROUND_TYPE$1.COLOR}function isInternalBackground(e){return e.type===BACKGROUND_TYPE$1.INTERNAL}function isCustomBackground(e){return e.type===BACKGROUND_TYPE$1.CUSTOM}function isStoryBackground(e){return e.type===BACKGROUND_TYPE$1.STORY_BACKGROUND}const configKit=Object.fromEntries(Object.entries(configKit$1).map((([e,t])=>[e,t.utils])));var __defProp$Y=Object.defineProperty,__getOwnPropDesc$T=Object.getOwnPropertyDescriptor,__decorateClass$W=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$T(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$Y(t,r,i),i};class PageActuator{constructor(e,t){__publicField(this,"index"),__publicField(this,"context"),this.index=e,this.context=t}getInfo(){return this.context.pageInfos[this.getIndex()-1]}getId(){return this.getInfo().id}getName(){return this.getInfo().name}getIndex(){return this.index}isVisible(){return this.context.isVisible(this.index)}goto(e){if(!this.context.isVisible(this.index))throw new Error(i18n.t("Duchamp-Target_Page_Hide_Unable_Switch_Story"));this.context.actions.goto(this.getInfo(),e)}setVisible(e){e?this.show():this.hide()}hide(){if(this.context.current===this.index)throw new Error(i18n.t("Duchamp-Unable_To_Hide_Current_Story"));this.context.isVisible(this.index)&&this.context.actions.setVisible(this.getInfo(),!1)}show(){this.context.isVisible(this.index)||this.context.actions.setVisible(this.getInfo(),!0)}}__decorateClass$W([jsApi$1()],PageActuator.prototype,"getName"),__decorateClass$W([jsApi$1()],PageActuator.prototype,"getIndex"),__decorateClass$W([jsApi$1()],PageActuator.prototype,"isVisible"),__decorateClass$W([jsApi$1()],PageActuator.prototype,"goto"),__decorateClass$W([jsApi$1()],PageActuator.prototype,"setVisible");class PageContext{constructor(e,t){__publicField(this,"data"),__publicField(this,"actions"),this.data=e,this.actions=t}get pageInfos(){return this.data.getPages()}get current(){return this.data.getCurrent()}get total(){return this.pageInfos.length}get loop(){var e,t,r;return null!=(r=null==(t=(e=this.data).isLoop)?void 0:t.call(e))&&r}get visibleTotal(){return this.pageInfos.filter((e=>e.visible)).length}isVisible(e){var t,r;return null!=(r=null==(t=this.pageInfos[e-1])?void 0:t.visible)&&r}getPage(e){const t=isNumber$5(e)?e:this.pageInfos.findIndex((t=>t.name===e))+1;if(t<1||t>this.total)throw new Error(i18n.t("Duchamp-Target_Page_Not_Exist"));return new PageActuator(t,this)}indexToVisibleIndex(e){return list(e-1).filter((e=>this.isVisible(e+1))).length}visibleIndexToIndex(e){let t=0;for(;t<=this.total&&this.indexToVisibleIndex(t)!==e;t++);return t}getPreviousPage(){let e=0;const t=this.current-1,r=this.loop?this.current+1-this.total:1;for(let n=t;n>=r;n--){const t=n<=0?n+this.total:n;if(this.isVisible(t)){e=t;break}}return this.getPage(e)}getNextPage(){let e=0;const t=this.current+1,r=this.loop?this.total+this.current-1:this.total;for(let n=t;n<=r;n++){const t=n>this.total?n-this.total:n;if(this.isVisible(t)){e=t;break}}return this.getPage(e)}getFirstPage(){let e=0;for(let t=1;t<=this.total;t++)if(this.isVisible(t)){e=t;break}return this.getPage(e)}getLastPage(){let e=0;for(let t=this.total;t>=1;t--)if(this.isVisible(t)){e=t;break}return this.getPage(e)}getCurrentPage(){return this.getPage(this.current)}getAllPages(){return list(this.total-1).map((e=>this.getPage(e+1)))}}__decorateClass$W([jsApi$1({travel:!0})],PageContext.prototype,"getPage"),__decorateClass$W([jsApi$1({travel:!0})],PageContext.prototype,"getPreviousPage"),__decorateClass$W([jsApi$1({travel:!0})],PageContext.prototype,"getNextPage"),__decorateClass$W([jsApi$1({travel:!0})],PageContext.prototype,"getFirstPage"),__decorateClass$W([jsApi$1({travel:!0})],PageContext.prototype,"getLastPage"),__decorateClass$W([jsApi$1({travel:!0})],PageContext.prototype,"getCurrentPage"),__decorateClass$W([jsApi$1({travel:!0})],PageContext.prototype,"getAllPages");const DUCHAMP_COMP_TYPE={"3D":"3D",CHART:"chart",RELATION:"relation",CONTROLLER:"controller",AI:"ai"},DUCHAMP_APP_FUNC={OFF_SCREEN:"off_Screen",WATER_MARK:"water_mark",STORY_RENDER:"painter",LOAD:"load",STORY_REFRESH:"story_refresh",WIDGET_REFRESH:"widget_refresh",CACHE:"cache",MOBILE:"mobile",PERFORMANCE_MODE:"performance_mode",INTERACTIVE_SETTING:"interactive_setting",SELECTION_ZOOM:"selection_zoom",LINEAGE:"lineage"},DUCHAMP_APP_SERVICE={REUSE:"reuse",FORMULA:"formula",JS:"js",THEME_CUSTOM:"theme_custom",PAGE_PARAM:"page_param",INNER_POSITION_SELECT:"inner_position_select",MOBILE_TOUCH_EVENT:"mobile_touch_event",DYNAMIC_VALUE:"dynamicValue"},SETTING_CONTROLLER_PARAM_TRIGGER={DROPDOWN:"dropdown",INPUT:"input"},SETTING_CONTROLLER_SOURCE_TYPE={AUTO:"auto",CUSTOM:"custom",CHART:"chart",DATA_TABLE:"data_table",DATA_QUERY:"data_query"},SETTING_CONTROLLER_VALUE_TYPE={CUSTOM:"custom",FIELDS:"fields"},DefaultAppSetting={app:{func:{[DUCHAMP_APP_FUNC.LOAD]:{enable:!0},[DUCHAMP_APP_FUNC.MOBILE]:{enable:!0,config:{supportAutoCheck:!0}},[DUCHAMP_APP_FUNC.CACHE]:{enable:!0},[DUCHAMP_APP_FUNC.OFF_SCREEN]:{enable:!0},[DUCHAMP_APP_FUNC.STORY_REFRESH]:{enable:!0},[DUCHAMP_APP_FUNC.WATER_MARK]:{enable:!0},[DUCHAMP_APP_FUNC.WIDGET_REFRESH]:{enable:!0},[DUCHAMP_APP_FUNC.STORY_RENDER]:{enable:!0},[DUCHAMP_APP_FUNC.PERFORMANCE_MODE]:{enable:!0},[DUCHAMP_APP_FUNC.INTERACTIVE_SETTING]:{enable:!1},[DUCHAMP_APP_FUNC.SELECTION_ZOOM]:{enable:!0},[DUCHAMP_APP_FUNC.LINEAGE]:{enable:!0}},service:{[DUCHAMP_APP_SERVICE.REUSE]:{enable:!0,config:{newResourceEnable:!0,widgetPanelEnable:!0,resourceEnable:!0}},[DUCHAMP_APP_SERVICE.FORMULA]:{enable:!0},[DUCHAMP_APP_SERVICE.JS]:{enable:!0},[DUCHAMP_APP_SERVICE.THEME_CUSTOM]:{enable:!0},[DUCHAMP_APP_SERVICE.PAGE_PARAM]:{enable:!0},[DUCHAMP_APP_SERVICE.INNER_POSITION_SELECT]:{enable:!1},[DUCHAMP_APP_SERVICE.MOBILE_TOUCH_EVENT]:{enable:!0},[DUCHAMP_APP_SERVICE.DYNAMIC_VALUE]:{enable:!0,config:{supportConditionStyle:!0,supportSummary:!1}}}},components:{[DUCHAMP_COMP_TYPE["3D"]]:{enable:!0},[DUCHAMP_COMP_TYPE.CHART]:{enable:!0},[DUCHAMP_COMP_TYPE.RELATION]:{enable:!1},[DUCHAMP_COMP_TYPE.AI]:{enable:!1},[DUCHAMP_COMP_TYPE.CONTROLLER]:{enable:!0,config:{parameter:{format:[],triggers:[SETTING_CONTROLLER_PARAM_TRIGGER.DROPDOWN,SETTING_CONTROLLER_PARAM_TRIGGER.INPUT]},fields:{enableBind:!1},source:[SETTING_CONTROLLER_SOURCE_TYPE.DATA_TABLE,SETTING_CONTROLLER_SOURCE_TYPE.DATA_QUERY,SETTING_CONTROLLER_SOURCE_TYPE.CUSTOM],sourceAllowEmptyValues:!1,displayValue:!0,returnValue:!0,defaultValue:[SETTING_CONTROLLER_VALUE_TYPE.CUSTOM,SETTING_CONTROLLER_VALUE_TYPE.FIELDS],defaultValueRange:!0,allowDuplicateRemoval:!0}}}};class SettingCenter{constructor(){__publicField(this,"appSetting",DefaultAppSetting.app),__publicField(this,"componentsSetting",DefaultAppSetting.components)}initConfig(e=DefaultAppSetting){const{app:t,components:r}=e;this.appSetting=t,this.componentsSetting=r}get app(){return this.appSetting}get components(){return this.componentsSetting}isFastMode(){return!this.app.func[DUCHAMP_APP_FUNC.PERFORMANCE_MODE].enable}getComponentConfigMeta(e){var t;const r=this.components[e];return(null==(t=null==r?void 0:r.config)?void 0:t.meta)||{}}supportWidgetCheck(e,t){var r,n;const o=null!=(r=this.components[e])?r:this.components[t||""];return null==(n=null==o?void 0:o.enable)||n}supportAppFunc(e){return this.app.func[e].enable}supportAppService(e){return this.app.service[e].enable}getResourceConfig(){return this.app.service[DUCHAMP_APP_SERVICE.REUSE].config}getAppFuncConfig(e){var t;return null==(t=this.app.func[e])?void 0:t.config}support3DEvent(){return this.components["3D"].enable}get controllerConfig(){return settingCenter.components[DUCHAMP_COMP_TYPE.CONTROLLER].config}get parameterCanInput(){var e;return null==(e=this.controllerConfig)?void 0:e.parameter.triggers.includes(SETTING_CONTROLLER_PARAM_TRIGGER.INPUT)}getComponentConfig(e){const t=this.components[e];return(null==t?void 0:t.config)||{}}getWidgetResultOptions(e){var t;const{type:r}=e,n=this.components[r];return(null==(t=null==n?void 0:n.config)?void 0:t.handleOptions)?n.config.handleOptions(e):e}getDynamicValueConfig(){return this.app.service[DUCHAMP_APP_SERVICE.DYNAMIC_VALUE].config}}const settingCenter=new SettingCenter;var FUNC_ERROR_TEXT$5="Expected a function";function negate$1(e){if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$5);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}var negate_1=negate$1;const negate$2=getDefaultExportFromCjs$1(negate_1);var arrayMap$3=_arrayMap$1,baseIteratee$5=_baseIteratee,basePickBy=_basePickBy,getAllKeysIn$1=_getAllKeysIn;function pickBy$2(e,t){if(null==e)return{};var r=arrayMap$3(getAllKeysIn$1(e),(function(e){return[e]}));return t=baseIteratee$5(t),basePickBy(e,r,(function(e,r){return t(e,r[0])}))}var pickBy_1=pickBy$2;const pickBy$3=getDefaultExportFromCjs$1(pickBy_1);var baseIteratee$4=_baseIteratee,negate=negate_1,pickBy$1=pickBy_1;function omitBy(e,t){return pickBy$1(e,negate(baseIteratee$4(t)))}var omitBy_1=omitBy;const omitBy$1=getDefaultExportFromCjs$1(omitBy_1),DATA_LAYER_TYPE={Point:"point",Cylinder:"cylinder",Line:"line",Model:"model"},DEFAULT_CONFIG={MODEL_INVISIBLE:!1,LAYER_VISIBLE:!1,ANIMATION_ENABLED:!1},CALDER_TYPE=["d-calder","d-calder-custom","d-unity"];function mergeOptions(e,t,r){var n,o,i;const{dataLayers:a=[],animations:s=[],cameraState:l,envSettingId:c,models:u=[]}=null!=(n=cloneDeep$2(r))?n:{},d=cloneDeep$2(e.getModelsFromOptions(t))||[],h=(e,t)=>{e.forEach((e=>{var r;const n=t.find((t=>t.id===e.id));e.invisible=null!=(r=null==n?void 0:n.invisible)?r:DEFAULT_CONFIG.MODEL_INVISIBLE,e.children&&h(e.children,t)}))};h(d,u);const p=[];null==t||t.dataLayers.forEach((e=>{var t;const r=a.find((t=>t.id===e.id));p.push({...e,visible:null!=(t=null==r?void 0:r.visible)?t:DEFAULT_CONFIG.LAYER_VISIBLE})}));const f=[];null==t||t.animationSchemes.forEach((e=>{var t;const r=s.find((t=>t.uuid===e.id));f.push({...e,enabled:null!=(t=null==r?void 0:r.enabled)?t:DEFAULT_CONFIG.ANIMATION_ENABLED})}));const g=e.getOptionsWithModels(d,t);if(g||t){const e={...t,...g,selectedEnvSettingId:c||(null==t?void 0:t.selectedEnvSettingId),dataLayers:p,animationSchemes:f,camera:{...null==t?void 0:t.camera,cameraState:null!=(i=null!=l?l:null==(o=null==t?void 0:t.camera)?void 0:o.cameraState)?i:null==t?void 0:t.cameraState}};return(null==e?void 0:e.cameraState)&&(e.cameraState=void 0),e}return null}function isCalderCameraState(e){return isObject$e(e)&&"position"in e&&"target"in e}function isTargetAnimation(e){return Array.isArray(e)&&e.length>0&&"animationType"in e[0]}function setAllCalderRenderResource(e,t){const{allWidgets:r}=e;CALDER_TYPE.forEach((e=>{if(e===t)return;const n=r.find((t=>t.type===e));n&&n.getInstance().setRenderResource()}))}const coordinate=["X","Y","Z"],coordinateType=["position","target"],PerspectiveInputGroup=observer((({value:e,onChange:t,pasteActionEnabled:r=!0})=>jsxs("div",{className:"perspective-input-group",children:[r&&jsx(Button$4,{className:"icon-button",icon:jsx(Icon$2,{type:"icon-paste-change",placement:"right"}),onClick:()=>{fvsService.readTextFromClipboard().then((e=>{try{const r=JSON.parse(e);isCalderCameraState(r)&&(r.target[1]=0,null==t||t(r),sendFocusPoint({id:"S327",param:{...r}}))}catch(e3){Message.error(duchampIntl.get("Duchamp-No_Content_To_Paste"))}}))},"data-focus-point":"S178",children:duchampIntl.get("Duchamp-Paste_Replace")}),coordinateType.map(((r,n)=>jsx(VerticalItem$1,{label:"position"===r?duchampIntl.get("Duchamp-Perspective_Camera_Coordinates"):duchampIntl.get("Duchamp-Viewport_Coordinates"),contentClassName:"coordinate-row",children:coordinate.map(((n,o)=>jsxs("div",{className:"coordinate-row-item",children:[jsx("div",{className:"direction",children:n}),jsx(NumberInput$1,{defaultValue:null==e?void 0:e[r][o],step:.1,precision:2,disabled:"target"===r&&"Y"===n,value:null==e?void 0:e[r][o],onChange:n=>((r,n,o)=>{const i=null==e?void 0:e[o].slice();i&&e&&(i[n]=r,null==t||t({...e,[o]:[i.at(0),i.at(1),i.at(2)]}))})(n,o,r)})]},o)))},n))),r&&jsx("div",{className:"coordinate-tip",children:duchampIntl.get("Duchamp-Paste_Perspective_Tip")})]}))),TriggerWidget$1=({onChange:e,value:t,calderWidgetOptions:r})=>{const n=t&&r.every((e=>e.value!==t));return jsx(Select$1,{style:{width:"100%"},className:classNames$1({"select-error":n}),placeholder:duchampIntl.get("Duchamp-Select_Three-D_Components"),options:r,value:n?duchampIntl.get("Duchamp-Widget_Is_Not_Found"):t,onChange:e})},CustomPerspectiveSelector=observer((({value:e,onChange:t,calderWidgetOptions:r})=>{var n,o;const i=null==r?void 0:r.find((t=>t.value===(null==e?void 0:e.triggerCalderWidget))),a=null==(n=null==i?void 0:i.publicPerspective.find((t=>t.id===(null==e?void 0:e.publicPerspectiveId))))?void 0:n.id,s=(null==e?void 0:e.publicPerspectiveId)&&!a,l=null==i?void 0:i.publicPerspective.map((e=>({label:e.name,value:e.id}))),c=null==(o=null==e?void 0:e.isPublic)||o;return jsxs(Fragment,{children:[jsx(Form.Item,{label:duchampIntl.get("Duchamp-Trigger_Object"),children:jsx(TriggerWidget$1,{calderWidgetOptions:r,onChange:r=>{null==t||t({...e,triggerCalderWidget:r,publicPerspectiveId:void 0,isPublic:!0,customPerspective:{position:[0,0,0],target:[0,0,0]}})},value:null==e?void 0:e.triggerCalderWidget})}),jsx(Form.Item,{label:duchampIntl.get("Duchamp-Perspectives-Source"),children:jsxs(Fragment,{children:[jsx(RadioGroup$1,{options:[{label:duchampIntl.get("Duchamp-Public_Perspective"),value:!0},{label:duchampIntl.get("Duchamp-Custom_Value"),value:!1}],value:c,onChange:r=>{null==t||t({...e,isPublic:r})},style:{marginBottom:8}}),c?jsx(Select$1,{style:{width:"100%"},options:l,placeholder:duchampIntl.get("Duchamp-Select_Camera_Perspective"),value:s?duchampIntl.get("Duchamp-Target_Is_Not_Found",duchampIntl.get("Duchamp-Perspective")):a,onChange:r=>{null==t||t({...e,publicPerspectiveId:r})},className:classNames$1({"select-error":s})}):jsx(PerspectiveInputGroup,{value:null==e?void 0:e.customPerspective,onChange:r=>{null==t||t({...e,customPerspective:r})}})]})})]})})),CustomPerspectiveConfig=observer((({target:e,value:t,...r})=>{var n;const o=useStore(),{story:i}=o,[a]=useForm(),s=reactExports.useMemo((()=>getCurrentStoryCalderWidgetOptions(i.relatedWidgets)),[i.relatedWidgets]),{triggerCalderWidget:l}=t.perspectiveData||{},c=null==(n=i.getRelatedWidgetById(l))?void 0:n.getInstance();return reactExports.useEffect((()=>{if(!c)return;c.fireEvent("disableDegrade");const e=c.getCameraState();return()=>{c.changeCalderPerspectiveByState(e),c.fireEvent("enableDegrade",{snapshot:!1})}}),[c]),reactExports.useEffect((()=>{t.perspectiveData&&changeCalderPerspective(t.perspectiveData,o)}),[o,t.perspectiveData]),jsx(ActionConfigWrapper,{...r,value:t,form:a,defaultValues:{perspectiveData:{isPublic:!0,customPerspective:{position:[0,0,0],target:[0,0,0]}}},className:"custom-perspective-config",children:jsx(Form.Item,{name:"perspectiveData",noStyle:!0,children:jsx(CustomPerspectiveSelector,{calderWidgetOptions:s})})})})),changeCalderPerspective=(e,{story:t})=>{const{triggerCalderWidget:r,customPerspective:n,publicPerspectiveId:o,isPublic:i}=e,a=t.getRelatedWidgetById(r),s=null==a?void 0:a.getInstance();i&&o&&(null==s||s.changeCalderPerspectiveById(o)),!i&&n&&(null==s||s.changeCalderPerspectiveByState({position:n.position,target:n.target}))},executeCustomPerspectiveAction=({config:e,store:t})=>{changeCalderPerspective(e.body.perspectiveData,t)},customPerspectiveAction={type:DUCHAMP_ACTION_TYPE.CUSTOM_PERSPECTIVE,menu:{title:duchampIntl.get("Duchamp-3d_Custom_Perspective"),description:duchampIntl.get("Duchamp-3d_Custom_Perspective_Description"),testId:"click-action-custom-perspective"},configPane:CustomPerspectiveConfig,execute:executeCustomPerspectiveAction,hook:{onRecord:({body:e})=>({sourceOfPerspective:e.perspectiveData.isPublic?"public":"custom"})}},TriggerWidget=({onChange:e,value:t,calderWidgetOptions:r})=>{const n=t&&r.every((e=>e.value!==t));return jsx(Select$1,{style:{width:"100%"},className:classNames$1({"select-error":n}),placeholder:duchampIntl.get("Duchamp-Select_Three-D_Components"),options:r,value:n?duchampIntl.get("Duchamp-Widget_Is_Not_Found"):t,onChange:e})},EnvSettingSelector=observer((({value:e,onChange:t,calderWidgetOptions:r})=>{var n;const o=null==r?void 0:r.find((t=>t.value===(null==e?void 0:e.triggerCalderWidget))),i=null==(n=null==o?void 0:o.envSettings.find((t=>t.id===(null==e?void 0:e.envSettingId))))?void 0:n.id,a=(null==e?void 0:e.envSettingId)&&!i,s=null==o?void 0:o.envSettings.map((e=>({label:e.name,value:e.id})));return jsxs(Fragment,{children:[jsx(Form.Item,{label:duchampIntl.get("Duchamp-Trigger_Object"),children:jsx(TriggerWidget,{calderWidgetOptions:r,onChange:r=>{null==t||t({...e,triggerCalderWidget:r,envSettingId:void 0})},value:null==e?void 0:e.triggerCalderWidget})}),jsx(Form.Item,{label:duchampIntl.get("Duchamp-Environment_Style"),children:jsx(Select$1,{style:{width:"100%"},options:s,placeholder:duchampIntl.get("Duchamp-Please_Select_Environment_Style"),value:a?duchampIntl.get("Duchamp-Target_Is_Not_Found",duchampIntl.get("Duchamp-Environment_Style")):i,onChange:r=>{null==t||t({...e,envSettingId:r})},className:classNames$1({"select-error":a})})})]})})),EnvSettingSwitchConfig=observer((({target:e,value:t,...r})=>{var n;const o=useStore(),{story:i}=o,[a]=useForm(),s=reactExports.useMemo((()=>getCurrentStoryCalderWidgetOptionsForEnvSettings(i.relatedWidgets)),[i.relatedWidgets]),{triggerCalderWidget:l}=t.envSettingData||{},c=null==(n=i.getRelatedWidgetById(l))?void 0:n.getInstance();return reactExports.useEffect((()=>{if(!c)return;c.fireEvent("disableDegrade");const e=c.getEnvSettingId();return()=>{c.changeCalderEnvSettingById(e),c.fireEvent("enableDegrade",{snapshot:!1})}}),[c]),reactExports.useEffect((()=>{t.envSettingData&&changeCalderEnvSetting(t.envSettingData,o)}),[o,t.envSettingData]),jsx(ActionConfigWrapper,{...r,value:t,form:a,defaultValues:{envSettingData:{triggerCalderWidget:void 0,envSettingId:void 0}},className:"envsetting-config",children:jsx(Form.Item,{name:"envSettingData",noStyle:!0,children:jsx(EnvSettingSelector,{calderWidgetOptions:s})})})})),changeCalderEnvSetting=(e,{story:t})=>{const{triggerCalderWidget:r,envSettingId:n}=e;if(!n)return;const o=t.getRelatedWidgetById(r),i=null==o?void 0:o.getInstance();null==i||i.changeCalderEnvSettingById(n)},executeEnvSettingSwitchAction=({config:e,store:t})=>{changeCalderEnvSetting(e.body.envSettingData,t)},envSettingSwitchAction={type:DUCHAMP_ACTION_TYPE.ENV_SETTING_SWITCH,menu:{title:duchampIntl.get("Duchamp-Switch_Three-D_Environment_Style"),description:duchampIntl.get("Duchamp-Switch_Three-D_Environment_Style_Description")},configPane:EnvSettingSwitchConfig,execute:executeEnvSettingSwitchAction},JsConfig=observer((e=>jsx(baseJavascriptAction.configPane,{...e,showFormulaDialog:(e,t)=>fvsService.openFormulaEditor(e,t)}))),executeJsAction=({store:e,config:t,widget:r,parameters:n})=>{const{code:o}=t.body,{duchampApi:i}=e.duchampServer;runJavascriptCode({code:o,args:n&&Array.from(n.keys()),values:n&&Array.from(n.values()),context:i.getWidgetById(r.id),duchampApi:i})},jsAction={...baseJavascriptAction,configPane:JsConfig,execute:executeJsAction},JumpStoryConfig=observer((e=>{const{stories:t}=useStore();return jsx(baseJumpStoryAction.configPane,{...e,stories:t,showFormulaDialog:(e,t)=>fvsService.openFormulaEditor(e,t),showParameterConfig:settingCenter.supportAppService(DUCHAMP_APP_SERVICE.PAGE_PARAM)})})),executeJumpStoryAction=({store:e,config:t,parameters:r})=>{const{storyId:n}=t.body,o=e.previewStories.findIndex((e=>e.id===n));if(o>=0){const t=r&&r.size>0?Object.fromEntries(r):void 0;e.previewSwitchStory(o,t)}},jumpStoryAction={...baseJumpStoryAction,configPane:JumpStoryConfig,execute:executeJumpStoryAction};function isInstanceofAnimationable(e){return void 0!==(null==e?void 0:e.playAnimation)}const ModelAnimationConfig=observer((e=>{const{story:t}=useStore();return jsx(baseModelAnimationAction.configPane,{...e,options:getWidgetsAnimations(t.relatedWidgets).filter((e=>!isEmpty$3(e.animations)))})})),executeModelAnimationAction=({config:e,store:t})=>{const{animations:r,playMode:n,playCommand:o,animationsSourceWidgetId:i,commandTiming:a}=e.body,s=t.story.getRelatedWidgetById(i),l=null==s?void 0:s.getInstance();isInstanceofAnimationable(l)&&(null==r||r.forEach((e=>{const t=n===PLAY_MODE_TYPE.LOOP,r=a.isDelay&&a.delayTime?timeUnitToMillisecond(oldTime2TimeMillisecond(a.delayTime)):void 0;l.playAnimation(e,t,r,o)})))},modelAnimationAction={...baseModelAnimationAction,configPane:ModelAnimationConfig,execute:executeModelAnimationAction},PlayRoamAnimationConfig=observer((e=>{const{story:t}=useStore();return jsx(basePlayRoamAnimationAction.configPane,{...e,options:getRoamAnimation(t.relatedWidgets).filter((e=>!isEmpty$3(e.animations)))})})),executePlayRoamAnimationAction=({config:e,store:t})=>{const{story:r}=t,{animations:n,playMode:o,playCommand:i,animationsSourceWidgetId:a}=e.body,s=r.getRelatedWidgetById(a),l=null==s?void 0:s.getInstance();t.eventEmitter.once(DUCHAMP_EVENTS.STORY_CHANGE,(()=>{null==l||l.updateCameraWalkAnimationStatus({playAction:PLAY_COMMAND_TYPE.EXIT})})),null==l||l.updateCameraWalkAnimationStatus({playAction:i,names:n,playMode:o})},playRoamAnimationAction={...basePlayRoamAnimationAction,configPane:PlayRoamAnimationConfig,execute:executePlayRoamAnimationAction},WidgetMask=observer((({selectedWidgetIds:e=[],hoveredWidgetIds:t=[]})=>{const r=useStore(),{story:n}=r,o=reactExports.useMemo((()=>n.getRelatedWidgetByIds(e)),[e,n]),i=reactExports.useMemo((()=>n.getRelatedWidgetByIds(t.filter((t=>!e.includes(t))))),[t,n,e]),a=usePrevious(i);reactExports.useEffect((()=>{i.forEach((e=>{e.getInstance().setShowHoverTip(!0)})),null==a||a.forEach((e=>{e.getInstance().setShowHoverTip(!1)}))}),[i,a]);const{left:s,top:l}=r.target.getBoundingClientRect();return reactDomExports.createPortal(jsx("div",{children:o.map((e=>{const{visibleBindingClientRect:t}=e.getInstance(),r=t&&{left:t.left-s,top:t.top-l,width:t.width,height:t.height};return jsx("div",{className:"action-preview-widget-selected-mask",style:r},e.id)}))}),r.target)})),TARGET_TYPE_WIDGET="widget",TARGET_TYPE_MODEL="model",VISIBLE_ACTION_TYPE_OPTIONS=[{label:duchampIntl.get("Duchamp-Show"),value:"visible"},{label:duchampIntl.get("Duchamp-Hide"),value:"hidden"},{label:duchampIntl.get("Duchamp-Switch_Show_Or_Hidden"),value:"toggle"}],TARGET_TYPE_OPTIONS=[{label:duchampIntl.get("Duchamp-Component"),value:TARGET_TYPE_WIDGET},{label:duchampIntl.get("Duchamp-Model"),value:TARGET_TYPE_MODEL}],defaultVisibleConfigItem={checked:[],halfChecked:[]};function getAllChildKeys(e){const t=[];return function e(r){if(r.children)for(const n of r.children)t.push(n.key),e(n)}(e),t}function getChildKeys(e){var t;return(null==(t=e.children)?void 0:t.map((e=>e.key)))||[]}function findParentNodes(e,t,r){let n=e;const o=[];for(;n&&t.has(n);){const e=t.get(n);if(!e||!e.parentId||e.parentId===n||(null==r?void 0:r.has(n))){""===(null==e?void 0:e.parentId)&&o.push(e);break}o.push(e),n=e.parentId}return o.filter((t=>t.key!==e))}const flattenTreeData=e=>{let t=[];return e.forEach((e=>{const r={label:e.title,value:e.key,disabled:!0};t.push(r),e.children&&(t=[...t,...flattenTreeData(e.children)])})),t},getTreeData$1=(e,t="")=>e.map((e=>{const r=getTreeData$1(e.childWidgets.slice().reverse(),e.id),n=widgetIsGroup(e);return{title:e.name,key:e.id,children:r,parentId:t,isGroupNode:n}}));function convertModelsToDataNodes(e,t="",r=new Map){const n=new Map(r);return[e.map((e=>{const r=e.children.map((e=>e.id));n.set(e.id,{children:r,parentId:t});let o=[];if(e.children.length>0){const[t,r]=convertModelsToDataNodes(e.children,e.id,n);o=t,r.forEach(((e,t)=>n.set(t,e)))}return{key:e.id,title:e.name,parentId:t,children:o}})),n]}const buildNodeMap=e=>{const t=new Map,r=e=>{t.set(e.key,e),e.children&&e.children.forEach(r)};return e.forEach(r),t},setWidgetsVisible=(e,t)=>{t&&e.filter((e=>!widgetIsGroup(e))).forEach((e=>{if(e)switch(t){case"hidden":e.setVisible(!1);break;case"visible":e.setVisible(!0);break;default:e.setVisible(!e.visible)}}))},setCalderModelVisible=(e,t="hidden",r)=>{const n="hidden"!==t&&("visible"===t||void 0);e.forEach((e=>{e.getInstance().setModelsVisible(r,n)}))},filterStringKeys=e=>e.filter((e=>"string"==typeof e)),createVisibleControlModelConfig=e=>{const{relatedWidgets:t}=e.story,r=t.filter((e=>widgetIsSupportVisibleControl(e.type)));return{targetType:TARGET_TYPE_MODEL,visibleConfigData:r.map((e=>({value:defaultVisibleConfigItem,type:e.id})))}},createVisibleControlWidgetConfig=e=>{const{story:t,backgroundStory:r}=e,n=[{value:defaultVisibleConfigItem,type:t.id},...r?[{value:defaultVisibleConfigItem,type:r.id}]:[]];return{targetType:TARGET_TYPE_WIDGET,visibleConfigData:n}},updateCheckStatus=(e,t)=>{const r=t.filter((t=>{const r=e.get(t);return r&&!r.isGroupNode})),n=new Set(r),o=new Set,i=new Set;return r.forEach((t=>{findParentNodes(t,e,i).forEach((e=>{e.isGroupNode&&i.add(e.key)}))})),i.forEach((t=>{var r;const a=e.get(t),s=null==(r=null==a?void 0:a.children)?void 0:r.map((e=>e.key));if(!s||0===s.length)return;const l=s.every((e=>n.has(e))),c=s.some((e=>n.has(e)||i.has(e)));l?n.add(t):c&&o.add(t)})),{checked:Array.from(n),halfChecked:Array.from(o)}};var baseClone$1=_baseClone,CLONE_SYMBOLS_FLAG$2=4;function clone$2(e){return baseClone$1(e,CLONE_SYMBOLS_FLAG$2)}var clone_1=clone$2;const clone$3=getDefaultExportFromCjs$1(clone_1),SelectTree=({treeData:e,onChange:t,searchValue:r,visibleData:n,targetType:o,nodeMap:i})=>{const[a,s]=reactExports.useState([]),[l,c]=reactExports.useState(!0),u=o===TARGET_TYPE_WIDGET,d=reactExports.useMemo((()=>{const t=e=>e.map((e=>{const n=e.title,o=n.indexOf(r),i=n.substring(0,o),a=n.slice(o+r.length),s=o>-1?jsxs("span",{children:[i,jsx("span",{className:"tree-search-value",children:r}),a]}):jsx("span",{children:n});return e.children?{title:s,key:e.key,children:t(e.children)}:{title:s,key:e.key}}));return t(e)}),[r,e]);reactExports.useEffect((()=>{const e=Array.from(i.values()).map((e=>{var t;return(null==(t=e.title)?void 0:t.indexOf(r))>-1?e.parentId:null})).filter(((e,t,r)=>e&&r.indexOf(e)===t));e.length>0&&s(e),c(!0)}),[r,i]);return jsx("div",{className:"visible-select-tree",children:jsx(Tree,{checkable:!0,onExpand:e=>{s(e),c(!1)},checkStrictly:u,checkedKeys:{checked:n.checked,halfChecked:n.halfChecked},checkPos:"middle",expandArea:"icon",nodeHeight:24,selectable:!1,expandedKeys:a,autoExpand:l,treeData:d,contentEllipsis:!0,showIcon:!1,onCheck:u?(e,r)=>{if(!("checked"in e))return;const n=getAllChildKeys(r.node),o=findParentNodes(r.node.key,i),a=new Set(e.checked),s=new Set(e.halfChecked);n.forEach((e=>r.checked?a.add(e):a.delete(e))),o.forEach((e=>{const t=getChildKeys(e),r=t.every((e=>a.has(e))),n=t.some((e=>a.has(e)||s.has(e)));e.isGroupNode&&(r?(a.add(e.key),s.delete(e.key)):(a.delete(e.key),n?s.add(e.key):s.delete(e.key)))})),null==t||t(Array.from(a),Array.from(s))}:(e,r)=>{!("checked"in e)&&"halfCheckedKeys"in r&&(null==t||t(e,r.halfCheckedKeys||[]))}})})},VisibleSelectPanel=({data:e,treeData:t,onChange:r,onHover:n,targetType:o})=>{const i=clone$3(e),[a,s]=reactExports.useState(""),l=reactExports.useMemo((()=>t.map((e=>e.type))),[t]),{treeDataNode:c=[],type:u=""}=first(t)||{},d=reactExports.useMemo((()=>buildNodeMap(c)),[c]),h=(e,t,n)=>{const o=i.filter((e=>(null==e?void 0:e.type)&&l.includes(e.type))),a=i.findIndex((e=>e.type===n)),s={type:n,value:{checked:e,halfChecked:t}};-1===a?o.push(s):o[a]=s,null==r||r(o)};if(useMount$1((()=>{if("model"===o)return;const{checked:e,halfChecked:t}=updateCheckStatus(d,f.checked),r=filterStringKeys(e),n=filterStringKeys(t);h(r,n,u)})),0===c.length)return jsx(Fragment,{});const p=i.find((e=>e.type===u)),f=(null==p?void 0:p.value)||defaultVisibleConfigItem;return jsxs("div",{className:"visible-control-select-panel",children:[jsx(Input$2,{className:"search-input",placeholder:duchampIntl.get("Duchamp-Please_Enter"),suffix:jsx(Icon$2,{type:"icon-search"}),onChange:e=>{s(e)}}),jsx("div",{className:"visible-control-tree-panel",children:jsx(SelectTree,{onChange:(e,t)=>{const r=filterStringKeys(e),n=filterStringKeys(t);h(r,n,u)},onHover:n,treeData:c,searchValue:a,targetType:o,visibleData:f,nodeMap:d})})]})},VisibleConfigPathItem=observer((({index:e,visibleConfig:t,onDelete:r,onChange:n,onPreviewChange:o,treeData:i,nodeMap:a,title:s})=>{const{actionType:l,visibleConfigData:c,targetType:u}=t,d=useStore(),{story:h}=d,{relatedWidgets:p}=h,f=u===TARGET_TYPE_WIDGET,[g,m]=reactExports.useMemo((()=>{const e=flattenTreeData(i.flatMap((e=>e.treeDataNode))),t=p.filter((e=>widgetIsGroup(e))).map((e=>e.id));return[e,e.map((e=>e.value)).filter((e=>!t.includes(e)))]}),[p,i]),y=e=>{null==n||n({...t,visibleConfigData:e})},v=f?c.flatMap((e=>e.value.checked)):(()=>{const e=c.flatMap((e=>e.value.checked)),t=c.flatMap((e=>e.value.halfChecked)),r=new Set;return e.forEach((e=>{const t=a.get(e);t&&!t.parentId&&r.add(e)})),t.forEach((t=>{var n;const o=null==(n=a.get(t))?void 0:n.children;o&&o.forEach((t=>e.includes(t)&&r.add(t)))})),Array.from(r)})();return jsxs("div",{className:"visible-control-config-item",children:[jsx(Select$1,{style:{display:"none"},onChange:e=>{const t=e===TARGET_TYPE_WIDGET?createVisibleControlWidgetConfig(d):createVisibleControlModelConfig(d);null==n||n({...t,actionType:l})},value:u,options:TARGET_TYPE_OPTIONS,placeholder:duchampIntl.get("Duchamp-Please_Choose_Tip")}),jsxs("div",{className:"title",children:[s,jsx(Icon$2,{type:"icon-delete",onClick:r,"data-focus-point":"S184"})]}),jsxs("div",{className:"content",children:[jsx(Form.Item,{label:duchampIntl.get("Duchamp-Target_Object"),labelCol:{span:7},wrapperCol:{span:17},children:jsx(Select$1,{onDropdownVisibleChange:t=>{o({activeIndex:t?e:void 0})},className:"visible-control-config-item-widget",value:v.filter((e=>m.includes(e))),multiple:!0,tags:!0,tagRender:e=>jsx("div",{className:"selection-item",children:e.label}),showSearch:!1,maxTagCount:"responsive",dropdownRender:()=>jsx(VisibleSelectPanel,{onChange:y,onHover:e=>{o({hoveredWidgets:[e]})},data:c,treeData:i,targetType:u}),options:g,placeholder:duchampIntl.get("Duchamp-Please_Select_Object")})}),jsx(Form.Item,{label:duchampIntl.get("Duchamp-Interactive_Action"),labelCol:{span:7},wrapperCol:{span:17},style:{marginBottom:0},children:jsx(Select$1,{style:{width:"100%"},onChange:e=>{var r;r=e,null==n||n({...t,actionType:r})},value:l,options:VISIBLE_ACTION_TYPE_OPTIONS,placeholder:duchampIntl.get("Duchamp-Please_Choose_Tip")})})]})]})})),VisibleControlSelector=observer((e=>{const t=useStore(),{story:r}=t,{rootWidgets:n,name:o,relatedWidgets:i,id:a}=r,{backgroundStory:s}=r.platform.backgroundLayer,{rootWidgets:l,name:c="",id:u}=s||{},{value:d=[],onChange:h,onPreviewChange:p}=e,f=reactExports.useMemo((()=>[{treeDataNode:getTreeData$1([...n].reverse()),name:o,type:a},{treeDataNode:getTreeData$1([...l||[]].reverse()||[]),name:c,type:u||""}]),[n,o,a,l,c,u]),[g,m]=reactExports.useMemo((()=>{const e=new Map;return[i.filter((e=>widgetIsSupportVisibleControl(e.type))).map((t=>{const r=t.getInstance(),[n,o]=convertModelsToDataNodes(r.getModels(),"");return o.forEach(((t,r)=>e.set(r,t))),{treeDataNode:n,name:t.name,type:t.id}})),e]}),[i]);return jsxs(Fragment,{children:[jsx(Form.Item,{label:duchampIntl.get("Duchamp-Object_Setting"),children:jsx(IconTextButton,{icon:"icon-add",text:duchampIntl.get("Duchamp-Add_Object"),onClick:()=>{const e=createVisibleControlWidgetConfig(t);null==h||h([...d,e])},className:"visible-control-config-content-add","data-focus-point":"S182"})}),d.length>0&&jsx("div",{className:"visible-control-config-content",children:d.map(((e,t)=>jsx(VisibleConfigPathItem,{index:t,title:"".concat(duchampIntl.get("Duchamp-Object")).concat(t+1),visibleConfig:e,onChange:e=>((e,t)=>{const r=d.slice();r[e]=t,null==h||h(r)})(t,e),onDelete:()=>(e=>{null==h||h(d.filter(((t,r)=>r!==e)))})(t),onPreviewChange:p,treeData:e.targetType===TARGET_TYPE_WIDGET?f:g,nodeMap:m},t)))})]})})),VisibleControlPreview=observer((({value:e,previewProps:{activeIndex:t,hoveredWidgets:r}})=>{var n;return jsx(WidgetMask,{selectedWidgetIds:isNil$3(t)?[]:null==(n=e.visibleData)?void 0:n[t].visibleConfigData.flatMap((e=>e.value.checked)),hoveredWidgetIds:r})})),VisibleControlConfig=observer((({target:e,onPreviewChange:t,...r})=>{const n=useStore();return jsx(ActionConfigWrapper,{...r,defaultValues:{visibleData:[createVisibleControlWidgetConfig(n)]},children:jsx(Form.Item,{name:"visibleData",noStyle:!0,children:jsx(VisibleControlSelector,{onPreviewChange:t})})})})),executeVisibleControlAction=({config:e,store:{story:t}})=>{const{visibleData:r}=e.body;r.forEach((e=>{const{targetType:r,actionType:n}=e,{visibleConfigData:o}=e;if(r===TARGET_TYPE_WIDGET){const e=o.flatMap((e=>e.value.checked)),r=t.getRelatedWidgetByIds(e);setWidgetsVisible(r,n)}else{const e=o.flatMap((e=>[...e.value.checked,...e.value.halfChecked])),r=t.relatedWidgets.filter((e=>widgetIsSupportVisibleControl(e.type)));setCalderModelVisible(r,n,e)}}))},visibleControlAction={type:DUCHAMP_ACTION_TYPE.VISIBLE_CONTROL,menu:{title:duchampIntl.get("Duchamp-Show_Or_Hide"),description:duchampIntl.get("Duchamp-Add_Visible_Control_Describe"),testId:"click-action-visible-control"},configPane:VisibleControlConfig,previewPane:VisibleControlPreview,execute:executeVisibleControlAction},CONTENT_TYPE={...PATH_TYPE,TEXT_PROMPT:"textPrompt"},TRIANGLE_ARROW_DEFAULT_CONFIG={type:"color",value:{color:"#024F67"}},LINE_DEFAULT_CONFIG={type:"color",value:{color:"#00FFFF"}},MOBILE_DEFAULT_BUBBLE_SIZE={type:SIZE_REGULAR_TYPE.CUSTOM,widthPercent:40,heightPercent:12},MOBILE_DEFAULT_POPUP_SIZE={type:SIZE_REGULAR_TYPE.CUSTOM,widthPercent:70,heightPercent:50},WEB_PAGE_POPOVER_BORDER_STYLE_DEFAULT_CONFIG={hue:0,saturation:0,brightness:0,contrast:0,opacity:100},DEFAULT_BORDER_RADIUS={type:"px",value:4},MOBILE_DEFAULT_BORDER={format:"whole",topLeft:DEFAULT_BORDER_RADIUS,topRight:DEFAULT_BORDER_RADIUS,bottomLeft:DEFAULT_BORDER_RADIUS,bottomRight:DEFAULT_BORDER_RADIUS},WEB_PAGE_POPOVER_DEFAULT_CONFIG={requestType:"GET",parameters:[],url:{value:[],pathType:PATH_TYPE.URL},width:500,height:500,border:{type:"color",value:"#024F67"},borderStyle:{...WEB_PAGE_POPOVER_BORDER_STYLE_DEFAULT_CONFIG,opacity:85},borderScale:1,fillType:FILL_TYPE.BORDER,backgroundFillType:BACKGROUND_FILL_TYPE.AUTO,actionType:TARGET_TYPE.DIALOG,titleConfig:TITLE_DEFAULT_CONFIG,padding:{top:20,right:20,bottom:20,left:20},dialogType:DIALOG_TYPE.CENTER,line:LINE_DEFAULT_CONFIG,triangleArrow:TRIANGLE_ARROW_DEFAULT_CONFIG,borderRadius:DEFAULT_BORDER$1,padSize:MOBILE_DEFAULT_POPUP_SIZE,phoneSize:MOBILE_DEFAULT_POPUP_SIZE,mobileConfig:{padding:{top:12,right:12,bottom:12,left:12},borderRadius:MOBILE_DEFAULT_BORDER}},WEB_PAGE_DEFAULT_CONFIG={...WEB_PAGE_POPOVER_DEFAULT_CONFIG,padding:{top:0,right:0,bottom:0,left:0},titleConfig:{fontFamily:"Helvetica Neue",fontSize:14,color:"#000000",textAlign:"left",displayTitle:!1,isBold:!1},border:{type:"color",value:"#ffffff"},borderStyle:WEB_PAGE_POPOVER_BORDER_STYLE_DEFAULT_CONFIG},POPOVER_DEFAULT_CONFIG={...WEB_PAGE_POPOVER_DEFAULT_CONFIG,dialogType:DIALOG_TYPE.DYNAMIC},DEFAULT_BORDER_CONFIG=WEB_PAGE_POPOVER_DEFAULT_CONFIG.borderStyle,TEXT_PROMPT_DEFAULT_CONFIG={dialogType:DIALOG_TYPE.DYNAMIC,popupStyle:POPUP_STYLE.TRIANGLE_ARROW,padSize:MOBILE_DEFAULT_BUBBLE_SIZE,phoneSize:MOBILE_DEFAULT_BUBBLE_SIZE,width:240,height:160},LINK_DEFAULT_CONFIG={dialogType:DIALOG_TYPE.CENTER,popupStyle:void 0,padSize:MOBILE_DEFAULT_POPUP_SIZE,phoneSize:MOBILE_DEFAULT_POPUP_SIZE,width:500,height:500},MOBILE_POPUP_SIZE_OPTIONS=[{label:duchampIntl.get("Duchamp-Phone_Device"),value:MOBILE_MODE.PHONE},{label:duchampIntl.get("Duchamp-Pad_Device"),value:MOBILE_MODE.PAD}],MOBILE_POPUP_SIZE_TYPE_OPTIONS=[{label:duchampIntl.get("Duchamp-Custom_Width_Height"),value:SIZE_REGULAR_TYPE.CUSTOM},{label:duchampIntl.get("Duchamp-Auto_Height"),value:SIZE_REGULAR_TYPE.AUTO_HEIGHT}],POPOVER_TEXT_PROMPT_DEFAULT_URL={pathType:"textPrompt",value:{value:[],verticalAlign:RICH_TEXT_VERTICAL_ALIGN.START}},DIALOG_TYPE_CONFIGS={[DIALOG_TYPE.BUBBLE]:{dialogType:DIALOG_TYPE.DYNAMIC,popupStyle:POPUP_STYLE.TRIANGLE_ARROW},[DIALOG_TYPE.DYNAMIC]:{dialogType:DIALOG_TYPE.DYNAMIC,popupStyle:POPUP_STYLE.CONNECTION_LINE},[DIALOG_TYPE.CENTER]:{dialogType:DIALOG_TYPE.CENTER}};function getBackgroundStyle$1({resourceCenter:e,props:t,baseUrl:r}){if(!t)return{};const{borderStyle:n={},border:o={},fillType:i=FILL_TYPE.BORDER,backgroundFillType:a=BACKGROUND_FILL_TYPE.AUTO,borderScale:s=1}=t;return convertBorderBackgroundStyle({borderOpacity:n.opacity,borderHue:n.hue,borderSaturation:n.saturation,borderBrightness:n.brightness,borderContrast:n.contrast,border:o,fillType:i,backgroundFillType:a,borderScale:s,resourceCenter:e,urlParser:e=>createResourceURL(e,r)})}const getTextPromptTitleStyle=e=>isString$3(e)?{}:{height:"initial",padding:0,marginBottom:3,lineHeight:"normal"};function getIframeCustomConfig(e,t,r){const n=getPopoverContentStyleConfig(e),o=getTextPromptTitleStyle(e.contentSource),i=getBackgroundStyle$1({resourceCenter:t,props:e,baseUrl:r});return{...n,backgroundStyle:i,titleStyle:{...n.titleStyle,...o}}}const initializeDataForDevice=(e,t)=>{if(!t)return e;const r={...e,...e.mobileConfig};return{...r,dialogType:getDialogType(r)}},getDialogType=e=>e.url.pathType===CONTENT_TYPE.URL||e.url.pathType===CONTENT_TYPE.TEMPLATE?DIALOG_TYPE.CENTER:e.dialogType===DIALOG_TYPE.DYNAMIC?DIALOG_TYPE.BUBBLE:e.dialogType,initializeExecuteDataToConfig=e=>({...e,...DIALOG_TYPE_CONFIGS[e.dialogType]}),initializeData=(e,t)=>{const r=initializeDataForDevice(e,t);return initializeExecuteDataToConfig(r)},isRequiredToSave=e=>{const{dialogType:t,popupStyle:r,titleConfig:n}=e,{displayTitle:o}=n,i=t===DIALOG_TYPE.CENTER,a=r===POPUP_STYLE.TRIANGLE_ARROW,s=r===POPUP_STYLE.CONNECTION_LINE;return{...e,popupStyle:i?void 0:e.popupStyle,triangleArrow:a?e.triangleArrow:TRIANGLE_ARROW_DEFAULT_CONFIG,line:s?e.line:LINE_DEFAULT_CONFIG,titleConfig:o?n:TITLE_DEFAULT_CONFIG}},revertConfigToExecuteData=e=>{const{popupStyle:t,...r}=isRequiredToSave(e);return{...r,dialogType:t===POPUP_STYLE.TRIANGLE_ARROW?DIALOG_TYPE.BUBBLE:r.dialogType,mobileConfig:{...r.mobileConfig,dialogType:getDialogType(r)}}},applyMobileConfig=(e,t)=>{const r={...t.titleConfig,fontSize:e.titleConfig.fontSize},n=t.dialogType===DIALOG_TYPE.DYNAMIC?DIALOG_TYPE.BUBBLE:t.dialogType;return{...t,border:e.border,backgroundFillType:e.backgroundFillType,borderRadius:e.borderRadius,borderScale:e.borderScale,dialogType:e.dialogType,fillType:e.fillType,padding:e.padding,borderStyle:e.borderStyle,triangleArrow:e.triangleArrow,titleConfig:r,mobileConfig:{border:t.border,backgroundFillType:t.backgroundFillType,borderRadius:t.borderRadius,borderScale:t.borderScale,dialogType:n,fillType:t.fillType,padding:t.padding,titleConfig:t.titleConfig,borderStyle:t.borderStyle,triangleArrow:t.triangleArrow}}};function transformWebpageActionData(e,t,r){const n=revertConfigToExecuteData(t);return r?applyMobileConfig(e,n):n}const DialogRichText=observer((({value:e,style:t})=>jsx("div",{className:"dialog-rich-text-wrapper",style:{justifyContent:e.verticalAlign},children:jsx("div",{className:"dialog-rich-text-quill",children:jsx(RichTextCore,{className:"dialog-rich-text",innerClassName:"dialog-rich-text-inner",value:{ops:e.ops},readOnly:!0,style:t})})}))),useFrameParentDuchamp=(e,t,r=window)=>{const n=reactExports.useRef(null);return reactExports.useEffect((()=>{var t;if(n.current){const{contentWindow:i}=n.current;try{if(null==(t=null==i?void 0:i.parent)?void 0:t.duchamp)Object.defineProperty(i,"parent",{get:()=>r});else{const t={};Object.defineProperty(i,"parent",{value:new Proxy(t,{get:(t,n)=>{if("duchamp"===n)return e;if(Object.hasOwn(t,n))return t[n];const o=r[n];return"function"==typeof o?o.bind(r):o}})})}}catch(o){console.error(o)}}}),t),n};function getParentWindowHasDec(){let e=window;try{for(;isUndefined$3(null==e?void 0:e.Dec)&&e!==e.top;)e=e.parent;return e}catch(e3){return window}}const isDecision=()=>{var e;return!!(null==(e=getParentWindowHasDec())?void 0:e.Dec)},getTabPaneService=()=>{var e;try{return null==(e=getParentWindowHasDec())?void 0:e.BI.Services.getService("dec.service.frame.tab_pane")}catch(e3){return}};var baseAssignValue$3=_baseAssignValue$1,createAggregator$2=_createAggregator,keyBy=createAggregator$2((function(e,t,r){baseAssignValue$3(e,r,t)})),keyBy_1=keyBy;const keyBy$1=getDefaultExportFromCjs$1(keyBy_1);var baseAssignValue$2=_baseAssignValue$1,baseForOwn=_baseForOwn$1,baseIteratee$3=_baseIteratee;function mapValues(e,t){var r={};return t=baseIteratee$3(t),baseForOwn(e,(function(e,n,o){baseAssignValue$2(r,n,t(e,n,o))})),r}var mapValues_1=mapValues;const mapValues$1=getDefaultExportFromCjs$1(mapValues_1),canUseDom=!("undefined"==typeof window||"undefined"==typeof document||!window.document||!window.document.createElement);canUseDom&&document.addEventListener("touchstart",(()=>{}),!0),window._iconfont_svg_string_3936926='<svg><symbol id="fdm-chart-descending" viewBox="0 0 1024 1024"><path d="M888.768 818.048c21.632 0 39.232 17.408 39.232 38.976 0 21.504-17.6 38.976-39.232 38.976H135.232a39.104 39.104 0 0 1-39.232-39.04c0-21.504 17.6-38.912 39.232-38.912zM229.44 128c21.696 0 39.232 17.472 39.232 39.04v561.28c0 21.568-17.536 39.04-39.232 39.04a39.104 39.104 0 0 1-39.232-39.04V167.04c0-21.568 17.536-39.04 39.232-39.04z m188.352 124.8c21.696 0 39.296 17.408 39.296 38.912v436.672c0 21.504-17.6 38.976-39.296 38.976a39.104 39.104 0 0 1-39.232-39.04V291.776c0-21.504 17.6-38.976 39.232-38.976z m188.416 124.672c21.632 0 39.232 17.472 39.232 39.04v311.872c0 21.504-17.6 38.976-39.232 38.976a39.104 39.104 0 0 1-39.296-39.04V416.576c0-21.568 17.6-39.04 39.296-39.04z m188.352 124.8c21.696 0 39.232 17.408 39.232 38.976v187.136c0 21.504-17.536 38.976-39.232 38.976a39.104 39.104 0 0 1-39.232-39.04V541.312c0-21.568 17.536-39.04 39.232-39.04z"  ></path></symbol><symbol id="fdm-chart-ascending" viewBox="0 0 1024 1024"><path d="M888.768 818.048c21.632 0 39.232 17.408 39.232 38.976 0 21.504-17.6 38.976-39.232 38.976H135.232a39.104 39.104 0 0 1-39.232-39.04c0-21.504 17.6-38.912 39.232-38.912zM794.56 128c21.696 0 39.232 17.472 39.232 39.04v561.28c0 21.568-17.536 39.04-39.232 39.04a39.104 39.104 0 0 1-39.232-39.04V167.04c0-21.568 17.536-39.04 39.232-39.04zM606.208 252.8c21.632 0 39.232 17.408 39.232 38.912v436.672c0 21.504-17.6 38.976-39.232 38.976a39.104 39.104 0 0 1-39.296-39.04V291.776c0-21.504 17.6-38.976 39.296-38.976zM417.792 377.408c21.696 0 39.296 17.472 39.296 39.04v311.872c0 21.504-17.6 38.976-39.296 38.976a39.104 39.104 0 0 1-39.232-39.04V416.576c0-21.568 17.6-39.04 39.232-39.04z m-188.352 124.8c21.696 0 39.232 17.408 39.232 38.976v187.136c0 21.504-17.536 38.976-39.232 38.976a39.104 39.104 0 0 1-39.232-39.04V541.312c0-21.568 17.536-39.04 39.232-39.04z"  ></path></symbol><symbol id="fdm-chart-reset" viewBox="0 0 1024 1024"><path d="M496.96 128c137.856 0 260.48 79.36 323.776 199.68V182.848a38.4 38.4 0 0 1 37.632-39.168 38.4 38.4 0 0 1 37.632 39.168v250.816a38.4 38.4 0 0 1-37.632 39.168H617.408a38.4 38.4 0 0 1-37.632-39.168 38.4 38.4 0 0 1 37.632-39.232h150.72c-44.8-111.872-150.656-188.096-271.168-188.096C334.72 206.336 203.264 343.232 203.264 512s131.52 305.664 293.696 305.664c101.056 0 193.28-53.568 247.04-140.352 10.368-16.768 19.2-34.56 26.24-53.12a37.184 37.184 0 0 1 48.768-22.08 39.68 39.68 0 0 1 21.184 50.88 388.096 388.096 0 0 1-32.96 66.752C739.84 828.8 623.872 896 496.96 896 293.12 896 128 724.096 128 512s165.184-384 368.96-384z"  ></path></symbol><symbol id="fdm-zoom-in" viewBox="0 0 1024 1024"><path d="M915.911111 420.977778a34.133333 34.133333 0 1 1-68.266667 0V224.654222L224.654222 847.644444H420.977778a34.133333 34.133333 0 1 1 0 68.266667h-284.444445a28.444444 28.444444 0 0 1-28.444444-28.444444v-284.444445a34.133333 34.133333 0 1 1 68.266667 0v196.380445L799.345778 176.355556H603.022222a34.133333 34.133333 0 1 1 0-68.266667h284.444445a28.444444 28.444444 0 0 1 28.444444 28.444444v284.444445z"  ></path></symbol><symbol id="fdm-hollow-triangle-up" viewBox="0 0 1024 1024"><path d="M796.330667 796.444444c31.061333 0 42.894222-21.162667 25.486222-47.217777L543.516444 331.662222c-17.294222-25.884444-45.624889-26.055111-63.032888 0l-278.300445 417.564445c-17.294222 25.884444-5.973333 47.217778 25.486222 47.217777h568.604445z m-519.395556-56.888888L512 387.015111 747.064889 739.555556H276.992z"  ></path></symbol><symbol id="fdm-zoom-out" viewBox="0 0 1024 1024"><path d="M910.222222 113.777778a34.133333 34.133333 0 0 0-48.241778 0L603.022222 372.679111V176.355556a34.133333 34.133333 0 1 0-68.266666 0v284.444444a28.444444 28.444444 0 0 0 28.444444 28.444444h284.444444a34.133333 34.133333 0 1 0 0-68.266666h-196.380444L910.222222 162.076444A34.133333 34.133333 0 0 0 910.222222 113.777778zM372.679111 603.022222H176.355556a34.133333 34.133333 0 0 1 0-68.266666h284.444444a28.444444 28.444444 0 0 1 28.444444 28.444444v284.444444a34.133333 34.133333 0 0 1-68.266666 0v-196.380444L162.076444 910.222222A34.133333 34.133333 0 0 1 113.777778 861.980444L372.679111 603.022222z"  ></path></symbol><symbol id="fdm-hollow-triangle-down" viewBox="0 0 1024 1024"><path d="M227.669333 312.206222c-31.118222 0-42.951111 21.162667-25.543111 47.217778l278.357334 417.564444c17.237333 25.884444 45.568 26.055111 62.976 0l278.357333-417.564444c17.237333-25.884444 5.973333-47.217778-25.543111-47.217778H227.669333z m519.395556 56.888889L512 721.635556 276.935111 369.095111h470.072889z"  ></path></symbol><symbol id="fdm-toolbar-expand" viewBox="0 0 1024 1024"><path d="M896 506.514286a18.285714 18.285714 0 0 0-18.285714-18.285715h-347.428572v-347.428571a18.285714 18.285714 0 0 0-36.571428 0v347.428571H146.285714a18.285714 18.285714 0 1 0 0 36.571429h347.428572v347.428571a18.285714 18.285714 0 0 0 36.571428 0v-347.428571H877.714286a18.285714 18.285714 0 0 0 18.285714-18.285714z"  ></path></symbol><symbol id="fdm-close" viewBox="0 0 1024 1024"><path d="M186.595556 869.262222l311.182222-311.182222 311.182222 311.182222a42.666667 42.666667 0 1 0 60.302222-60.302222L558.08 497.777778l311.182222-311.182222a42.666667 42.666667 0 0 0-60.302222-60.302223L497.777778 437.475556 186.595556 126.293333a42.666667 42.666667 0 0 0-60.302223 60.302223l311.182223 311.182222-311.182223 311.182222a42.666667 42.666667 0 1 0 60.302223 60.302222z"  ></path></symbol><symbol id="fdm-guanbianniu-shuangse" viewBox="0 0 1024 1024"><path d="M512 42.666667c259.2 0 469.333333 210.133333 469.333333 469.333333s-210.133333 469.333333-469.333333 469.333333S42.666667 771.2 42.666667 512 252.8 42.666667 512 42.666667z" fill="#000000" fill-opacity=".6" ></path><path d="M693.034667 367.189333a25.6 25.6 0 0 0-36.224-36.224L512 475.776 367.189333 330.965333a25.6 25.6 0 1 0-36.181333 36.224L475.818667 512l-144.853334 144.810667a25.6 25.6 0 1 0 36.224 36.181333L512 548.181333l144.810667 144.853334a25.6 25.6 0 1 0 36.224-36.224L548.224 512l144.810667-144.810667z" fill="#FFFFFF" ></path></symbol><symbol id="fdm-clear-linkage" viewBox="0 0 1024 1024"><path d="M219.428571 219.428571h182.857143v109.714286h36.571429V219.428571a36.571429 36.571429 0 0 0-36.571429-36.571428H219.428571a36.571429 36.571429 0 0 0-36.571428 36.571428v585.142858a36.571429 36.571429 0 0 0 36.571428 36.571428h182.857143a36.571429 36.571429 0 0 0 36.571429-36.571428v-73.142858h-36.571429v73.142858H219.428571V219.428571zM804.571429 219.428571h-182.857143v109.714286h-36.571429V219.428571a36.571429 36.571429 0 0 1 36.571429-36.571428h182.857143a36.571429 36.571429 0 0 1 36.571428 36.571428v585.142858a36.571429 36.571429 0 0 1-36.571428 36.571428h-182.857143a36.571429 36.571429 0 0 1-36.571429-36.571428v-73.142858h36.571429v73.142858h182.857143V219.428571z"  ></path><path d="M614.509714 640.365714a18.285714 18.285714 0 1 0 25.856-25.856l-90.477714-90.514285 90.514286-90.477715a18.285714 18.285714 0 0 0-25.892572-25.856l-90.514285 90.477715-90.477715-90.514286a18.285714 18.285714 0 0 0-25.892571 25.892571l90.514286 90.514286-90.514286 90.477714a18.285714 18.285714 0 0 0 25.892571 25.856l90.514286-90.477714 90.477714 90.477714z"  ></path></symbol><symbol id="fdm-qingkong" viewBox="0 0 1024 1024"><path d="M182.857143 329.142857h182.857143V182.857143h292.571428v146.285714h182.857143v182.857143h-47.542857l65.828571 329.142857h-694.857142l65.828571-329.142857H182.857143V329.142857z m475.428571 475.428572h156.525715l-58.514286-292.571429H267.702857l-58.514286 292.571429H365.714286v-182.857143h36.571428v182.857143h219.428572v-182.857143h36.571428v182.857143z m146.285715-329.142858v-109.714285h-182.857143V219.428571h-219.428572v146.285715H219.428571v109.714285h585.142858z"  ></path></symbol><symbol id="fdm-toggle-less-than" viewBox="0 0 1024 1024"><path d="M607.185455 378.391273a3.258182 3.258182 0 0 1 4.538181 0.861091l12.916364 18.920727a3.258182 3.258182 0 0 1-0.861091 4.538182l-159.464727 108.730182 159.464727 108.706909a3.258182 3.258182 0 0 1 0.861091 4.561454l-12.916364 18.920727a3.258182 3.258182 0 0 1-4.538181 0.861091l-179.293091-122.228363a13.102545 13.102545 0 0 1 0-21.643637l179.293091-122.228363zM781.870545 720.733091v195.723636l-45.474909-45.474909a2.56 2.56 0 0 0-3.584 0l-12.613818 12.590546a2.56 2.56 0 0 0 0 3.607272l67.188364 67.188364c6.423273 6.4 17.384727 1.861818 17.384727-7.214545v-226.443637a2.56 2.56 0 0 0-2.56-2.536727h-17.803636a2.56 2.56 0 0 0-2.56 2.56z m111.988364 234.077091v-195.700364l45.474909 45.474909a2.56 2.56 0 0 0 3.584 0l12.613818-12.613818a2.56 2.56 0 0 0 0-3.584l-67.188363-67.211636a10.193455 10.193455 0 0 0-17.384728 7.214545v226.443637c0 1.396364 1.140364 2.536727 2.56 2.536727h17.803637a2.56 2.56 0 0 0 2.56-2.56z"  ></path></symbol><symbol id="fdm-toggle-less-equal" viewBox="0 0 1024 1024"><path d="M588.032 339.106909a3.258182 3.258182 0 0 1 4.538182 0.861091l12.916363 18.944a3.258182 3.258182 0 0 1-0.86109 4.538182l-159.441455 108.706909 159.441455 108.730182a3.258182 3.258182 0 0 1 0.86109 4.538182l-12.916363 18.920727a3.258182 3.258182 0 0 1-4.538182 0.884363l-179.269818-122.251636a13.079273 13.079273 0 0 1 0-21.643636l179.269818-122.228364zM592.570182 682.891636a3.258182 3.258182 0 0 1-4.538182 0.861091l-190.976-130.490182a3.258182 3.258182 0 0 1-0.861091-4.538181l12.939636-18.920728a3.258182 3.258182 0 0 1 4.538182-0.861091l190.976 130.490182a3.258182 3.258182 0 0 1 0.837818 4.538182l-12.916363 18.920727zM781.870545 720.733091v195.723636l-45.474909-45.474909a2.56 2.56 0 0 0-3.584 0l-12.613818 12.590546a2.56 2.56 0 0 0 0 3.607272l67.188364 67.188364c6.423273 6.4 17.384727 1.861818 17.384727-7.214545v-226.443637a2.56 2.56 0 0 0-2.56-2.536727h-17.803636a2.56 2.56 0 0 0-2.56 2.56z m111.988364 234.077091v-195.700364l45.474909 45.474909a2.56 2.56 0 0 0 3.584 0l12.613818-12.613818a2.56 2.56 0 0 0 0-3.584l-67.188363-67.211636a10.193455 10.193455 0 0 0-17.384728 7.214545v226.443637c0 1.396364 1.140364 2.536727 2.56 2.536727h17.803637a2.56 2.56 0 0 0 2.56-2.56z"  ></path></symbol><symbol id="fdm-expand" viewBox="0 0 1024 1024"><path d="M512 113.778a56.889 56.889 0 0 1 56.889 56.889V455.11h284.444a56.889 56.889 0 0 1 0 113.778H568.89v284.444a56.889 56.889 0 0 1-113.778 0V568.89H170.667a56.889 56.889 0 1 1 0-113.778H455.11V170.667A56.889 56.889 0 0 1 512 113.777z"  ></path></symbol><symbol id="fdm-select" viewBox="0 0 1024 1024"><path d="M212.345263 631.322947a26.947368 26.947368 0 0 1-2.694737-38.750315l24.791579-27.216843a26.947368 26.947368 0 0 1 33.522527-5.12l195.961263 114.688L780.934737 308.277895a26.947368 26.947368 0 0 1 32.498526-6.467369l17.354105 8.784842a26.947368 26.947368 0 0 1 9.808843 39.720421l-343.848422 481.657264a26.947368 26.947368 0 0 1-39.235368 5.01221L212.345263 631.322947z"  ></path></symbol><symbol id="fdm-collect" viewBox="0 0 1024 1024"><path d="M531.456 162.157714A28.708571 28.708571 0 0 0 505.234286 146.285714a28.708571 28.708571 0 0 0-26.075429 16.164572l-88.32 179.382857a28.964571 28.964571 0 0 1-21.796571 15.872l-197.778286 28.452571a29.001143 29.001143 0 0 0-16.128 49.517715l143.104 139.410285a28.964571 28.964571 0 0 1 8.411429 25.673143l-33.792 196.900572a28.964571 28.964571 0 0 0 42.057142 30.646857l176.530286-93.001143a28.964571 28.964571 0 0 1 27.611429 0l176.786285 92.891428a28.964571 28.964571 0 0 0 42.057143-30.646857l-33.938285-196.790857a29.001143 29.001143 0 0 1 8.301714-25.673143l142.994286-139.410285a28.964571 28.964571 0 0 0-16.164572-49.517715l-197.485714-28.708571a29.001143 29.001143 0 0 1-21.833143-15.872l-88.32-179.419429zM505.709714 182.857143h-0.585143 0.585143z m-0.329143 9.142857L586.971429 357.668571c9.545143 19.382857 27.977143 32.804571 49.334857 35.913143l182.491428 26.514286-132.059428 128.731429a65.572571 65.572571 0 0 0-18.797715 58.148571l31.341715 181.650286-163.218286-85.76a65.353143 65.353143 0 0 0-62.025143 0.256l-162.56 85.650285 31.232-181.869714a65.572571 65.572571 0 0 0-19.017143-58.148571L191.561143 420.205714l182.637714-26.258285a65.572571 65.572571 0 0 0 49.408-35.913143l81.737143-166.034286z"  ></path></symbol><symbol id="fdm-navigation" viewBox="0 0 1024 1024"><path d="M786.029714 237.970286l-581.010285 223.451428 268.8 70.509715a25.6 25.6 0 0 1 18.285714 18.285714l70.473143 268.763428 223.451428-581.010285z m9.947429-43.008a25.6 25.6 0 0 1 33.060571 33.097143L584.484571 863.817143c-8.923429 23.222857-42.349714 21.357714-48.64-2.669714l-77.531428-295.497143-295.497143-77.531429c-24.027429-6.290286-25.892571-39.716571-2.669714-48.64L795.977143 194.925714z"  ></path></symbol><symbol id="fdm-ascend" viewBox="0 0 1024 1024"><path d="M764.342857 168.228571a21.942857 21.942857 0 1 1 43.885714 0v577.828572a21.942857 21.942857 0 1 1-43.885714 0V168.228571zM581.485714 314.514286a21.942857 21.942857 0 1 1 43.885715 0v431.542857a21.942857 21.942857 0 1 1-43.885715 0V314.514286zM420.571429 438.857143a21.942857 21.942857 0 0 0-21.942858 21.942857v285.257143a21.942857 21.942857 0 1 0 43.885715 0v-285.257143a21.942857 21.942857 0 0 0-21.942857-21.942857zM215.771429 533.942857a21.942857 21.942857 0 1 1 43.885714 0v212.114286a21.942857 21.942857 0 1 1-43.885714 0v-212.114286zM124.342857 863.085714A21.942857 21.942857 0 0 1 146.285714 841.142857h731.428572a21.942857 21.942857 0 1 1 0 43.885714H146.285714a21.942857 21.942857 0 0 1-21.942857-21.942857z"  ></path></symbol><symbol id="fdm-uncollect" viewBox="0 0 1024 1024"><path d="M479.158857 162.450286l-88.32 179.382857a28.964571 28.964571 0 0 1-21.796571 15.872l-197.778286 28.452571a29.001143 29.001143 0 0 0-16.128 49.517715l143.104 139.410285a28.964571 28.964571 0 0 1 8.411429 25.673143l-33.792 196.900572a28.964571 28.964571 0 0 0 42.057142 30.646857l176.530286-93.001143a28.964571 28.964571 0 0 1 27.611429 0l176.786285 92.891428a28.964571 28.964571 0 0 0 42.057143-30.646857l-33.938285-196.790857a29.001143 29.001143 0 0 1 8.301714-25.673143l142.994286-139.410285a28.964571 28.964571 0 0 0-16.164572-49.517715l-197.485714-28.708571a29.001143 29.001143 0 0 1-21.833143-15.872l-88.32-179.419429A28.708571 28.708571 0 0 0 505.234286 146.285714a28.708571 28.708571 0 0 0-26.075429 16.164572z"  ></path></symbol><symbol id="fdm-descend" viewBox="0 0 1024 1024"><path d="M259.657143 168.228571a21.942857 21.942857 0 0 0-43.885714 0v577.828572a21.942857 21.942857 0 1 0 43.885714 0V168.228571zM442.514286 314.514286a21.942857 21.942857 0 1 0-43.885715 0v431.542857a21.942857 21.942857 0 1 0 43.885715 0V314.514286zM603.428571 438.857143a21.942857 21.942857 0 0 1 21.942858 21.942857v285.257143a21.942857 21.942857 0 1 1-43.885715 0v-285.257143a21.942857 21.942857 0 0 1 21.942857-21.942857zM808.228571 533.942857a21.942857 21.942857 0 1 0-43.885714 0v212.114286a21.942857 21.942857 0 1 0 43.885714 0v-212.114286zM899.657143 863.085714a21.942857 21.942857 0 0 0-21.942857-21.942857H146.285714a21.942857 21.942857 0 1 0 0 43.885714h731.428572a21.942857 21.942857 0 0 0 21.942857-21.942857z"  ></path></symbol><symbol id="fdm-filter" viewBox="0 0 1024 1024"><path d="M574.122667 525.937778l201.500444-329.955556H250.424889L457.955556 525.425778v318.065778l116.224-39.424V525.937778z m71.964444 20.252444v275.057778c0 20.536889-13.084444 38.855111-32.540444 45.454222l-164.238223 55.751111a48.014222 48.014222 0 0 1-63.431111-45.454222V546.190222l-219.591111-348.615111a48.014222 48.014222 0 0 1 40.675556-73.557333h611.441778a48.014222 48.014222 0 0 1 40.96 72.988444l-213.276445 349.184z"  ></path></symbol><symbol id="fdm-note" viewBox="0 0 1024 1024"><path d="M453.485714 741.046857l310.308572-310.308571-37.778286-37.741715-310.308571 310.308572 37.741714 37.741714h0.036571z m-25.892571 25.856L272.457143 611.766857a54.857143 54.857143 0 0 0-13.202286 23.771429l-43.629714 165.961143a18.285714 18.285714 0 0 0 22.345143 22.345142l165.851428-43.702857c8.923429-2.340571 17.078857-6.912 23.771429-13.238857zM273.517714 610.742857l24.795429-24.795428 91.538286 91.538285 310.308571-310.308571-91.538286-91.538286 25.856-25.892571 155.172572 155.172571 13.970285-13.970286a54.857143 54.857143 0 0 0 0-77.568l-77.604571-77.568a54.857143 54.857143 0 0 0-77.568 0L273.517714 610.706286v0.036571z m555.958857-193.938286L453.449143 792.795429a91.611429 91.611429 0 0 1-40.301714 22.674285l-165.851429 43.739429a54.857143 54.857143 0 0 1-67.035429-66.998857l43.629715-165.961143a91.428571 91.428571 0 0 1 23.771428-41.398857L622.592 209.92a91.428571 91.428571 0 0 1 129.28 0l77.604571 77.531429a91.428571 91.428571 0 0 1 0 129.316571v0.036571z"  ></path></symbol><symbol id="fdm-refresh" viewBox="0 0 1024 1024"><path d="M217.636571 668.672l3.291429-0.292571h146.285714a18.285714 18.285714 0 0 1 3.291429 36.278857l-3.291429 0.292571h-100.571428l4.754285 5.851429a310.857143 310.857143 0 0 0 548.937143-174.921143 18.322286 18.322286 0 1 1 36.461715 2.816 347.428571 347.428571 0 0 1-617.545143 190.537143v103.716571a18.285714 18.285714 0 0 1-14.994286 17.993143l-3.291429 0.292571a18.285714 18.285714 0 0 1-18.029714-14.994285l-0.292571-3.291429v-146.285714a18.285714 18.285714 0 0 1 14.994285-17.993143zM784.128 298.057143c13.897143 17.773714 25.892571 36.644571 35.986286 56.356571l-0.073143-101.558857a18.285714 18.285714 0 0 1 14.994286-17.993143l3.291428-0.292571a18.285714 18.285714 0 0 1 17.993143 14.994286l0.292571 3.291428v146.285714a18.285714 18.285714 0 0 1-14.994285 17.993143l-3.291429 0.292572h-146.285714a18.285714 18.285714 0 0 1-3.291429-36.278857l3.291429-0.292572h100.242286a310.857143 310.857143 0 0 0-589.019429 179.602286 18.285714 18.285714 0 0 1-36.132571 5.632 347.428571 347.428571 0 0 1 617.033142-268.068572v0.036572z"  ></path></symbol><symbol id="fdm-search" viewBox="0 0 1024 1024"><path d="M455.111111 796.444444a341.333333 341.333333 0 1 1 269.653333-131.982222l160.768 160.711111a42.666667 42.666667 0 0 1-60.302222 60.302223l-160.824889-160.711112A339.854222 339.854222 0 0 1 455.111111 796.444444z m0-85.333333a256 256 0 1 0 0-512 256 256 0 0 0 0 512z"  ></path></symbol><symbol id="fdm-triangle-up" viewBox="0 0 1080 1024"><path d="M559.388444 369.777778l185.002667 277.504a22.755556 22.755556 0 0 1-18.944 35.328H355.384889a22.755556 22.755556 0 0 1-18.887111-35.328L521.500444 369.777778a22.755556 22.755556 0 0 1 37.888 0z"  ></path></symbol><symbol id="fdm-triangle-down" viewBox="0 0 1080 1024"><path d="M521.500444 654.222222L336.497778 376.775111A22.755556 22.755556 0 0 1 355.384889 341.333333h370.119111a22.755556 22.755556 0 0 1 18.887111 35.384889L559.388444 654.222222a22.755556 22.755556 0 0 1-37.888 0z"  ></path></symbol><symbol id="fdm-right" viewBox="0 0 1024 1024"><path d="M311.182222 200.817778a42.666667 42.666667 0 0 1 60.302222-60.302222l341.333334 341.333333a42.666667 42.666667 0 0 1 0 60.302222l-341.333334 341.333333a42.666667 42.666667 0 0 1-60.302222-60.302222L622.364444 512 311.182222 200.817778z"  ></path></symbol><symbol id="fdm-unfold" viewBox="0 0 1080 1024"><path d="M127.488 346.339556a11.377778 11.377778 0 0 0-6.656 20.593777l382.350222 278.414223a56.888889 56.888889 0 0 0 74.524445 0l382.350222-278.414223a11.377778 11.377778 0 0 0-6.656-20.593777h-135.395556a11.377778 11.377778 0 0 0-6.257777 1.877333L540.444444 527.075556 269.084444 348.216889a11.377778 11.377778 0 0 0-6.257777-1.877333H127.544889z"  ></path></symbol><symbol id="fdm-down" viewBox="0 0 1024 1024"><path d="M823.182222 311.182222a42.666667 42.666667 0 1 1 60.302222 60.302222l-341.333333 341.333334a42.666667 42.666667 0 0 1-60.302222 0l-341.333333-341.333334a42.666667 42.666667 0 0 1 60.302222-60.302222L512 622.364444l311.182222-311.182222z"  ></path></symbol><symbol id="fdm-fold" viewBox="0 0 1080 1024"><path d="M953.400889 677.660444a11.377778 11.377778 0 0 0 6.656-20.593777l-382.350222-278.414223a56.888889 56.888889 0 0 0-74.524445 0L120.832 657.066667a11.377778 11.377778 0 0 0 6.656 20.593777h135.395556a11.377778 11.377778 0 0 0 6.257777-1.877333L540.444444 496.924444l271.36 178.858667a11.377778 11.377778 0 0 0 6.257778 1.877333h135.338667z"  ></path></symbol><symbol id="fdm-a-shoudongsaoma" viewBox="0 0 1024 1024"><path d="M208 64h140a8 8 0 0 1 8 8v52a8 8 0 0 1-8 8H208c-41.972 0-76 34.028-76 76v140a8 8 0 0 1-8 8H72a8 8 0 0 1-8-8V208c0-79.528 64.472-144 144-144zM72 668a8 8 0 0 0-8 8v140c0 79.528 64.472 144 144 144h140a8 8 0 0 0 8-8v-52a8 8 0 0 0-8-8H208c-41.972 0-76-34.028-76-76v-140a8 8 0 0 0-8-8H72z m820 8a8 8 0 0 1 8-8h52a8 8 0 0 1 8 8v140c0 79.528-64.472 144-144 144h-140a8 8 0 0 1-8-8v-52a8 8 0 0 1 8-8h140c41.972 0 76-34.028 76-76v-140z m60-320a8 8 0 0 0 8-8V208c0-79.528-64.472-144-144-144h-140a8 8 0 0 0-8 8v52a8 8 0 0 0 8 8h140c41.972 0 76 34.028 76 76v140a8 8 0 0 0 8 8h52z m-341.376-115.848c22.512-22.512 59.008-22.512 81.52 0 22.512 22.508 22.512 59.008 0 81.52L363.84 649.98c-1.76 1.764-4 2.972-6.444 3.484l-75.332 15.7c-11.288 2.352-21.28-7.64-18.928-18.928l15.7-75.332c0.512-2.44 1.72-4.68 3.48-6.444l328.308-328.308zM272 704a8 8 0 0 0-8 8v56a8 8 0 0 0 8 8h480a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8H272z"  ></path></symbol><symbol id="fdm-order-ascending" viewBox="0 0 1024 1024"><path d="M550.059 765.724a39.822 39.822 0 1 1 0 79.645H210.603a39.822 39.822 0 0 1 0-79.645h339.513z m202.695-584.817a11.378 11.378 0 0 1 2.218 2.275l132.78 175.844a11.378 11.378 0 0 1-9.103 18.204h-98.702l0.057 434.062a34.133 34.133 0 0 1-68.267 0V377.173h-98.645a11.378 11.378 0 0 1-9.103-18.204l132.779-175.844a11.378 11.378 0 0 1 15.929-2.275zM552.277 491.065a39.822 39.822 0 1 1 0 79.644H210.603a39.822 39.822 0 1 1 0-79.644h341.674zM440.718 216.348a39.822 39.822 0 0 1 0 79.645H210.603a39.822 39.822 0 1 1 0-79.645h230.115z"  ></path></symbol><symbol id="fdm-order-no" viewBox="0 0 1024 1024"><path d="M780.004 453.29V305.665h89.543a11.378 11.378 0 0 0 8.533-18.83L754.233 144.27a11.378 11.378 0 0 0-17.18 0L613.147 286.834a11.378 11.378 0 0 0 8.59 18.83h89.942l0.057 147.627h68.267zM436.28 258.277a39.822 39.822 0 0 0 0-79.645H210.603a39.822 39.822 0 1 0 0 79.645h225.735z m115.996 274.66a39.822 39.822 0 1 0 0-79.645H210.603a39.822 39.822 0 1 0 0 79.644h341.674z m200.818 312.092a11.378 11.378 0 0 0 1.138-1.195l124.131-144.441a11.378 11.378 0 0 0-8.647-18.773h-89.713V532.935h-68.267V680.62h-90.169a11.378 11.378 0 0 0-8.647 18.773l124.075 144.44a11.378 11.378 0 0 0 16.042 1.196z m-312.377-37.376a39.822 39.822 0 0 0 0-79.645H210.603a39.822 39.822 0 0 0 0 79.645h230.115z"  ></path></symbol><symbol id="fdm-order-descending" viewBox="0 0 1024 1024"><path d="M550.059 258.276a39.822 39.822 0 1 0 0-79.645H210.603a39.822 39.822 0 0 0 0 79.645h339.513z m202.695 584.817a11.378 11.378 0 0 0 2.218-2.275l132.78-175.844a11.378 11.378 0 0 0-9.103-18.204h-98.702l0.057-434.006a34.133 34.133 0 0 0-68.267 0v434.063l-98.645-0.114a11.378 11.378 0 0 0-9.103 18.261l132.779 175.9a11.378 11.378 0 0 0 15.929 2.22zM552.277 532.935a39.822 39.822 0 1 0 0-79.644H210.603a39.822 39.822 0 1 0 0 79.644h341.674zM440.718 807.652a39.822 39.822 0 0 0 0-79.645H210.603a39.822 39.822 0 1 0 0 79.645h230.115z"  ></path></symbol><symbol id="fdm-table-down" viewBox="0 0 1024 1024"><path d="M513.17187471 737a18.69140654 18.69140654 0 0 1-13.25976504-5.49023467l-375.0000003-374.99999941A18.74999971 18.74999971 0 0 1 138.17187529 324.50000029h749.99999972a18.74999971 18.74999971 0 0 1 13.25976591 32.00976563l-375.0000003 374.99999941A18.69140654 18.69140654 0 0 1 513.17187471 737zM183.43554717 361.99999971L513.17187471 691.73632813 842.90820313 361.99999971z"  ></path></symbol><symbol id="fdm-table-up" viewBox="0 0 1024 1024"><path d="M887 699.5H137a18.75 18.75 0 0 1-13.26-32.01l375-375a18.75 18.75 0 0 1 26.52 0l375 375A18.75 18.75 0 0 1 887 699.5zM182.264 662h659.472L512 332.264z"  ></path></symbol><symbol id="fdm-tree-open" viewBox="0 0 1024 1024"><path d="M554.666667 469.333333V270.336a42.609778 42.609778 0 1 0-85.333334 0V469.333333H270.336a42.609778 42.609778 0 1 0 0 85.333334H469.333333v198.997333a42.609778 42.609778 0 1 0 85.333334 0V554.666667h198.997333a42.609778 42.609778 0 1 0 0-85.333334H554.666667zM113.777778 171.064889C113.777778 139.377778 139.377778 113.777778 171.064889 113.777778h681.870222C884.622222 113.777778 910.222222 139.377778 910.222222 171.064889v681.870222C910.222222 884.622222 884.622222 910.222222 852.935111 910.222222H171.064889C139.377778 910.222222 113.777778 884.622222 113.777778 852.935111V171.064889z"  ></path></symbol><symbol id="fdm-tree-close" viewBox="0 0 1024 1024"><path d="M852.935111 113.777778C884.622222 113.777778 910.222222 139.377778 910.222222 171.064889v681.870222C910.222222 884.622222 884.622222 910.222222 852.935111 910.222222H171.064889C139.377778 910.222222 113.777778 884.622222 113.777778 852.935111V171.064889C113.777778 139.377778 139.377778 113.777778 171.064889 113.777778h681.870222z m-99.271111 355.555555H270.336A42.552889 42.552889 0 0 0 227.555556 512l0.398222 5.802667a42.666667 42.666667 0 0 0 42.382222 36.864h483.328A42.552889 42.552889 0 0 0 796.444444 512l-0.398222-5.802667a42.666667 42.666667 0 0 0-42.382222-36.864z"  ></path></symbol><symbol id="fdm-text-scan" viewBox="0 0 1024 1024"><path d="M348 64H208c-79.528 0-144 64.472-144 144v140a8 8 0 0 0 8 8h52a8 8 0 0 0 8-8V208c0-41.972 34.028-76 76-76h140a8 8 0 0 0 8-8V72a8 8 0 0 0-8-8zM64 816v-148h68v148c0 41.972 34.028 76 76 76h140a8 8 0 0 1 8 8v52a8 8 0 0 1-8 8H208c-79.528 0-144-64.472-144-144zM892 668v148c0 41.972-34.028 76-76 76h-140a8 8 0 0 0-8 8v52a8 8 0 0 0 8 8h140c79.528 0 144-64.472 144-144v-148h-68zM960 348a8 8 0 0 1-8 8h-52a8 8 0 0 1-8-8V208c0-41.972-34.028-76-76-76h-140a8 8 0 0 1-8-8V72a8 8 0 0 1 8-8h140c79.528 0 144 64.472 144 144v140zM112 494a16 16 0 0 1 16-16h768a16 16 0 0 1 16 16v36a16 16 0 0 1-16 16H128a16 16 0 0 1-16-16v-36z"  ></path></symbol><symbol id="fdm-text-hide-password" viewBox="0 0 1024 1024"><path d="M869.724 394.144c9.968-13.808 28.576-18.892 43.532-10.748l17.428 9.484c16.08 8.756 21.628 29.268 11.004 44.18-24.836 34.868-54.292 66.488-87.584 94.128l66.208 78.904a32 32 0 0 1-3.944 45.084l-12.256 10.284a32 32 0 0 1-45.084-3.944l-70.508-84.028a530.936 530.936 0 0 1-17.612 10.032 533.968 533.968 0 0 1-108.948 44.476l29.428 109.824a32 32 0 0 1-22.628 39.192l-15.456 4.14a32 32 0 0 1-39.192-22.628l-30.616-114.26a0.504 0.504 0 0 0-0.012-0.04 547.952 547.952 0 0 1-138.452 0.508l-30.492 113.792a32 32 0 0 1-39.192 22.628l-15.456-4.14a32 32 0 0 1-22.624-39.192L366.4 633.08a534.4 534.4 0 0 1-112.8-45.56 529.816 529.816 0 0 1-14.844-8.396l-69.136 82.392a32 32 0 0 1-45.08 3.944l-12.26-10.284a32 32 0 0 1-3.944-45.084l64.516-76.884c-34.3-28.116-64.588-60.428-90.032-96.148-10.624-14.912-5.08-35.424 11.004-44.18l17.424-9.484c14.96-8.144 33.568-3.06 43.536 10.748 77.772 107.704 208.86 178.432 357.468 178.432s279.696-70.728 357.468-178.432z"  ></path></symbol><symbol id="fdm-more" viewBox="0 0 1024 1024"><path d="M284 512c0 28.72 23.28 52 52 52s52-23.28 52-52-23.28-52-52-52-52 23.28-52 52zM512 564c28.72 0 52-23.28 52-52s-23.28-52-52-52-52 23.28-52 52 23.28 52 52 52zM744 512c0 28.72-23.28 52-52 52s-52-23.28-52-52 23.28-52 52-52 52 23.28 52 52z"  ></path><path d="M512 960l2-0.004 2 0.004c247.424 0 448-200.576 448-448S763.424 64 516 64l-2 0.004L512 64C264.576 64 64 264.576 64 512s200.576 448 448 448z m4-72c-207.66 0-376-168.34-376-376s168.34-376 376-376 376 168.34 376 376-168.34 376-376 376z"  ></path></symbol><symbol id="fdm-text" viewBox="0 0 1024 1024"><path d="M596.948 187.052c66.376-66.4 174.012-66.424 240.416-0.048s66.424 174.012 0.048 240.416L310.22 954.832a16 16 0 0 1-11.28 4.688l-218.212 0.464a16 16 0 0 1-16.032-16.028l0.38-218.212a16.004 16.004 0 0 1 4.68-11.284L596.948 187.052z m108.24 276.46l-144.276-144.224L133.036 747.344l-0.252 144.528 144.532-0.308 427.872-428.052z m48.076-48.096l36.056-36.072c39.824-39.84 39.812-104.424-0.028-144.248-39.844-39.824-104.428-39.812-144.252 0.028l-36.056 36.072 144.28 144.22zM496 908a16 16 0 0 1 16-16h432a16 16 0 0 1 16 16v36a16 16 0 0 1-16 16H512a16 16 0 0 1-16-16v-36zM680 736a16 16 0 0 0-16 16v36a16 16 0 0 0 16 16h264a16 16 0 0 0 16-16v-36a16 16 0 0 0-16-16h-264z"  ></path></symbol><symbol id="fdm-text-show-password" viewBox="0 0 1024 1024"><path d="M704 512c0 108.248-87.752 196-196 196s-196-87.752-196-196 87.752-196 196-196 196 87.752 196 196z m-320 0c0 68.484 55.516 124 124 124 68.484 0 124-55.516 124-124 0-67.144-53.368-121.824-120-123.936V512H384z"  ></path><path d="M78.76 453.472C128.504 370.14 269.612 176 512 176s383.496 194.14 433.24 277.472c21.864 36.628 20.948 81.436-1.692 117.204-26.912 42.52-76.58 111.144-148 169.452C723.956 798.576 628.768 848 512 848s-211.956-49.424-283.548-107.872c-71.42-58.308-121.088-126.932-148-169.452-22.64-35.768-23.556-80.576-1.692-117.204zM512 248c-201.12 0-323.608 162.284-371.416 242.376-7.784 13.04-7.588 28.688 0.704 41.792 24.62 38.896 69.464 100.56 132.7 152.188C337.052 735.84 416.664 776 512 776c95.336 0 174.948-40.16 238.012-91.644 63.236-51.628 108.08-113.292 132.7-152.188 8.292-13.104 8.484-28.752 0.704-41.792C835.608 410.284 713.116 248 512 248z"  ></path></symbol><symbol id="fdm-text-password" viewBox="0 0 1024 1024"><path d="M480 580a8 8 0 0 0-8 8v160a8 8 0 0 0 8 8h64a8 8 0 0 0 8-8v-160a8 8 0 0 0-8-8h-64z"  ></path><path d="M728.944 349.032V384H256c-79.528 0-144 64.472-144 144v288c0 79.528 64.472 144 144 144h512c79.528 0 144-64.472 144-144v-288c0-69.948-49.872-128.248-116-141.28v-37.688C796 191.612 668.848 64 512 64c-119.68 0-222.068 74.296-263.876 179.44-2.04 5.128 1.82 10.58 7.336 10.58h56.268c3.068 0 5.856-1.76 7.256-4.492 36-70.208 108.924-118.228 193.016-118.228 119.816 0 216.944 97.48 216.944 217.732zM256 456h512c39.764 0 72 32.236 72 72v288c0 39.764-32.236 72-72 72H256c-39.764 0-72-32.236-72-72v-288c0-39.764 32.236-72 72-72z"  ></path></symbol><symbol id="fdm-date" viewBox="0 0 1024 1024"><path d="M316.2 652.592a8 8 0 0 0 0 11.316l147.184 147.184a8 8 0 0 0 11.316 0l244.816-244.816a8 8 0 0 0 0-11.316l-39.6-39.596a8 8 0 0 0-11.312 0l-199.564 199.56-101.928-101.928a8 8 0 0 0-11.312 0l-39.6 39.596z"  ></path><path d="M300 72a8 8 0 0 1 8-8h56a8 8 0 0 1 8 8v40h280V72a8 8 0 0 1 8-8h56a8 8 0 0 1 8 8v40h92c79.528 0 144 64.472 144 144v560c0 79.528-64.472 144-144 144H208c-79.528 0-144-64.472-144-144V256c0-79.528 64.472-144 144-144h92V72z m72 112v76a8 8 0 0 1-8 8H308a8 8 0 0 1-8-8V184H208c-39.764 0-72 32.236-72 72v88h752V256c0-39.764-32.236-72-72-72h-92v76a8 8 0 0 1-8 8h-56a8 8 0 0 1-8-8V184H372z m-236 232v400c0 39.764 32.236 72 72 72h608c39.764 0 72-32.236 72-72V416H136z"  ></path></symbol><symbol id="fdm-text-number" viewBox="0 0 1024 1024"><path d="M587.06 726.912a8 8 0 0 1-8 8H370.552v-39.852c0-76.26 48.452-127.752 91.336-173.332 34.052-36.192 64.596-68.652 64.596-106.824 0-26.172-16.192-48.776-47.976-48.776-27.328 0-45.316 16.972-48.672 49.952-0.44 4.3-3.94 7.744-8.26 7.744h-39.608c-4.576 0-8.24-3.852-7.808-8.412C380.328 349.8 418.624 312 477.908 312c69.568 0 106.152 48.776 106.152 101.12 0 58.904-42.152 104.252-82.284 147.428-36.456 39.228-71.248 76.66-71.248 120.832h148.532a8 8 0 0 1 8 8v37.532zM313.148 726.912a8 8 0 0 1-8 8H262.972a8 8 0 0 1-8-8V396.464l-50.388 35.22c-5.304 3.708-12.584-0.084-12.584-6.556V379.132a8 8 0 0 1 3.304-6.476l72.56-52.588a8 8 0 0 1 4.696-1.52h32.588a8 8 0 0 1 8 8v400.364zM723.616 741.456c71.972 0 109.152-42.232 109.152-123.124v-27.956c0-57.7-31.184-102.904-90.56-105.88l80.368-127.288v-30.664a8 8 0 0 0-8-8h-178.316a8 8 0 0 0-8 8v36.94a8 8 0 0 0 8 8h115.544l-73.764 117.772v40.448h38.38c36.584 0 58.176 16.06 58.176 61.86v25.576c0 47.584-16.192 68.404-51.576 68.404-28.86 0-47.04-14.824-51.016-55.46-0.416-4.24-3.904-7.588-8.16-7.588h-41.792c-4.492 0-8.116 3.708-7.844 8.188 4.46 73.136 45.772 110.772 109.408 110.772z"  ></path><path d="M64 256c0-79.528 64.472-144 144-144h608c79.528 0 144 64.472 144 144v512c0 79.528-64.472 144-144 144H208c-79.528 0-144-64.472-144-144V256z m144-76c-41.972 0-76 34.028-76 76v512c0 41.972 34.028 76 76 76h608c41.972 0 76-34.028 76-76V256c0-41.972-34.028-76-76-76H208z"  ></path></symbol><symbol id="fdm-text-nfc" viewBox="0 0 1024 1024"><path d="M348 64H208c-79.528 0-144 64.472-144 144v140a8 8 0 0 0 8 8h52a8 8 0 0 0 8-8V208c0-41.972 34.028-76 76-76h140a8 8 0 0 0 8-8V72a8 8 0 0 0-8-8zM64 676a8 8 0 0 1 8-8h52a8 8 0 0 1 8 8v140c0 41.972 34.028 76 76 76h140a8 8 0 0 1 8 8v52a8 8 0 0 1-8 8H208c-79.528 0-144-64.472-144-144v-140zM900 668a8 8 0 0 0-8 8v140c0 41.972-34.028 76-76 76h-140a8 8 0 0 0-8 8v52a8 8 0 0 0 8 8h140c79.528 0 144-64.472 144-144v-140a8 8 0 0 0-8-8h-52zM960 348a8 8 0 0 1-8 8h-52a8 8 0 0 1-8-8V208c0-41.972-34.028-76-76-76h-140a8 8 0 0 1-8-8V72a8 8 0 0 1 8-8h140c79.528 0 144 64.472 144 144v140zM648.916 778.816c-10.856-12.444-9.432-31.24 1.804-43.344 104.468-112.54 108-299.148 0.22-441.952-9.948-13.18-8.784-32.032 3.66-42.892 12.44-10.86 31.432-9.612 41.484 3.492 126.108 164.348 126.84 389.28-5.816 526.608-11.472 11.88-30.492 10.528-41.352-1.912z"  ></path><path d="M557.148 628.412c-10.384 12.844-11.916 31.604-1.056 44.044 10.86 12.444 29.932 13.832 40.912 1.5 80.876-90.832 80.008-231.704 4.368-337.236-9.62-13.42-28.648-14.636-41.088-3.776-12.444 10.86-13.54 29.672-4.196 43.288 56.932 82.94 54.736 185.804 1.06 252.18zM262.888 395.12a29.904 29.904 0 0 1 42.8-0.432l140.824 141.408c10.452-21.816 10.812-49.72-1.436-75.74-7.036-14.944-6.292-33.708 6.152-44.568 12.44-10.86 31.608-9.676 40.06 4.512 35.552 59.684 30.652 137.048-22.44 183.388a29.908 29.908 0 0 1-40.852-1.428l-138.652-139.232a96.632 96.632 0 0 0-6.564 23.504c-2.232 15.464-0.872 33.848 8.9 54.056 7.188 14.868 5.688 33.504-7.18 43.856-12.868 10.352-31.972 8.432-40.28-5.84-20.416-35.072-25.068-69.868-20.632-100.608 5.292-36.696 23.26-66.104 39.3-82.876z"  ></path></symbol><symbol id="fdm-drop-down" viewBox="0 0 1024 1024"><path d="M477.468444 699.221333l-242.403555-282.737777A45.511111 45.511111 0 0 1 269.596444 341.333333h484.807112a45.511111 45.511111 0 0 1 34.531555 75.093334l-242.346667 282.794666a45.511111 45.511111 0 0 1-69.12 0z"  ></path></symbol><symbol id="fdm-delete" viewBox="0 0 1024 1024"><path d="M723.456 178.403556c39.537778 5.518222 80.668444-1.592889 112.981333 3.868444 52.280889 8.874667 78.734222 53.134222 72.988445 118.272h-63.260445c-1.820444 115.541333-0.967111 230.115556-0.967111 346.055111 0 58.538667 4.892444 120.035556-0.967111 172.544-5.575111 49.607111-42.097778 79.815111-86.698667 87.210667-43.975111 7.395556-102.4 1.934222-150.926222 1.934222-101.831111 0-204.970667 1.991111-304.753778 0-48.64-0.910222-84.423111-16.270222-106.154666-45.511111-21.731556-29.240889-19.512889-73.557333-19.512889-126.065778V300.600889h-60.302222c-9.841778-59.960889 16.213333-102.968889 60.302222-117.304889 32.426667-10.467556 75.662222-1.991111 121.742222-4.835556-3.697778-64.512-0.227556-113.550222 55.523556-120.206222 24.860444-2.958222 58.140444 0 88.576 0h177.265777c33.792 0 68.380444-3.242667 85.674667 11.662222 23.950222 20.593778 17.692444 68.096 18.488889 108.544z m-365.169778-56.206223V180.337778h304.810667V119.296h-303.786667c-1.137778 0.170667-1.137778 1.536-1.024 2.844444zM298.894222 307.313778v369.322666c0 31.573333-7.281778 98.759111 11.662222 112.469334 7.566222 5.404444 27.022222 6.257778 36.067556 0 19.626667-13.653333 12.629333-78.904889 12.629333-111.502222v-373.191112H299.861333c-1.137778 0.170667-1.024 1.536-0.967111 2.901334z m181.134222 0v357.717333c0 28.216889-6.599111 95.004444 4.835556 114.346667 7.566222 12.8 33.052444 18.602667 45.795556 8.760889 17.237333-13.425778 9.728-84.195556 9.728-113.436445V304.412444H480.995556c-1.137778 0.170667-1.080889 1.536-0.967112 2.901334z m183.068445 0v374.158222c0 38.343111-7.509333 97.109333 17.521778 107.633778 10.865778 4.551111 30.208 1.024 35.043555-2.958222 16.327111-13.368889 8.760889-85.162667 8.760889-113.379556V304.412444h-60.359111c-1.137778 0.170667-1.080889 1.536-0.967111 2.901334z" fill="#FFFFFF" ></path></symbol><symbol id="fdm-radio-unselect" viewBox="0 0 1024 1024"><path d="M68.266667 512a443.733333 443.733333 0 1 0 887.466666 0A443.733333 443.733333 0 0 0 68.266667 512zM512 0a512 512 0 1 1 0 1024A512 512 0 0 1 512 0z"  ></path></symbol><symbol id="fdm-checkbox-unselect" viewBox="0 0 1024 1024"><path d="M853.333333 125.155556H170.666667a45.511111 45.511111 0 0 0-45.511111 45.511111v682.666666a45.511111 45.511111 0 0 0 45.511111 45.511111h682.666666a45.511111 45.511111 0 0 0 45.511111-45.511111V170.666667a45.511111 45.511111 0 0 0-45.511111-45.511111zM170.666667 56.888889h682.666666a113.777778 113.777778 0 0 1 113.777778 113.777778v682.666666a113.777778 113.777778 0 0 1-113.777778 113.777778H170.666667a113.777778 113.777778 0 0 1-113.777778-113.777778V170.666667a113.777778 113.777778 0 0 1 113.777778-113.777778z"  ></path></symbol><symbol id="fdm-next-page" viewBox="0 0 1024 1024"><path d="M284.444 253.156v517.688a28.444 28.444 0 0 0 44.544 23.382L705.48 535.438a28.444 28.444 0 0 0 0-46.876L328.99 229.717a28.444 28.444 0 0 0-44.545 23.495z"  ></path></symbol><symbol id="fdm-previous-page" viewBox="0 0 1024 1024"><path d="M739.556 253.156v517.688a28.444 28.444 0 0 1-44.544 23.382L318.52 535.438a28.444 28.444 0 0 1 0-46.876l376.49-258.845a28.444 28.444 0 0 1 44.545 23.495z"  ></path></symbol><symbol id="fdm-clear" viewBox="0 0 1024 1024"><path d="M512 445.056L400.832 333.888a47.36 47.36 0 1 0-66.944 66.944L445.056 512 333.888 623.168a47.36 47.36 0 0 0 66.944 66.944L512 578.944l111.168 111.168a47.36 47.36 0 0 0 66.944-66.944L578.944 512l111.168-111.168a47.36 47.36 0 0 0-66.944-66.944L512 445.056zM512 960a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"  ></path></symbol><symbol id="fdm-toolbar-filter" viewBox="0 0 1024 1024"><path d="M267.886 208.457a36.571 36.571 0 0 0-29.587 58.076l229.194 315.172a18.286 18.286 0 0 1 3.51 10.752v193.06a18.286 18.286 0 0 0 12.508 17.336l36.718 12.251a18.286 18.286 0 0 0 24.064-17.371V592.457a18.286 18.286 0 0 1 3.51-10.752l229.084-315.172a36.571 36.571 0 0 0-29.586-58.076H267.849z m-59.173 79.58a73.143 73.143 0 0 1 59.173-116.151h479.451a73.143 73.143 0 0 1 59.136 116.15L580.864 598.419v199.315a54.857 54.857 0 0 1-72.155 52.04l-36.755-12.214a54.857 54.857 0 0 1-37.522-52.041v-187.1L208.713 288.037z"  ></path></symbol><symbol id="fdm-toolbar-close" viewBox="0 0 1024 1024"><path d="M513.317 487.424l116.37-116.37a18.286 18.286 0 0 1 25.856 25.892l-116.37 116.37 116.37 116.37a18.286 18.286 0 0 1-25.856 25.857l-116.37-116.37-116.37 116.37a18.286 18.286 0 0 1-25.893-25.856l116.37-116.37-116.37-116.37a18.286 18.286 0 0 1 25.892-25.893l116.37 116.37zM512 877.714c-201.984 0-365.714-163.73-365.714-365.714S310.016 146.286 512 146.286 877.714 310.016 877.714 512 713.984 877.714 512 877.714z m0-36.571a329.143 329.143 0 1 0 0-658.286 329.143 329.143 0 0 0 0 658.286z"  ></path></symbol><symbol id="fdm-toolbar-more" viewBox="0 0 1024 1024"><path d="M237.714 237.714v219.429h219.429V237.714H237.714z m0-36.571h219.429a36.571 36.571 0 0 1 36.571 36.571v219.429a36.571 36.571 0 0 1-36.571 36.571H237.714a36.571 36.571 0 0 1-36.571-36.571V237.714a36.571 36.571 0 0 1 36.571-36.571z m0 329.143h219.429a36.571 36.571 0 0 1 36.571 36.571v219.429a36.571 36.571 0 0 1-36.571 36.571H237.714a36.571 36.571 0 0 1-36.571-36.571V566.857a36.571 36.571 0 0 1 36.571-36.571z m0 36.571v219.429h219.429V566.857H237.714z m329.143-36.571h219.429a36.571 36.571 0 0 1 36.571 36.571v219.429a36.571 36.571 0 0 1-36.571 36.571H566.857a36.571 36.571 0 0 1-36.571-36.571V566.857a36.571 36.571 0 0 1 36.571-36.571z m0-329.143h219.429a36.571 36.571 0 0 1 36.571 36.571v219.429a36.571 36.571 0 0 1-36.571 36.571H566.857a36.571 36.571 0 0 1-36.571-36.571V237.714a36.571 36.571 0 0 1 36.571-36.571z m0 36.571v219.429h219.429V237.714H566.857z m0 329.143v219.429h219.429V566.857H566.857z"  ></path></symbol></svg>',(e=>{var t=(r=(r=document.getElementsByTagName("script"))[r.length-1]).getAttribute("data-injectcss"),r=r.getAttribute("data-disable-injectsvg");if(!r){var n,o,i,a,s;if(t&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(c){console}}n=function(){var t,r=document.createElement("div");r.innerHTML=e._iconfont_svg_string_3936926,(r=r.getElementsByTagName("svg")[0])&&(r.setAttribute("aria-hidden","true"),r.style.position="absolute",r.style.width=0,r.style.height=0,r.style.overflow="hidden",(t=document.body).firstChild?function(e,t){t.parentNode.insertBefore(e,t)}(r,t.firstChild):t.appendChild(r))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(n,0):(o=function(){document.removeEventListener("DOMContentLoaded",o,!1),n()},document.addEventListener("DOMContentLoaded",o,!1)):document.attachEvent&&(i=n,a=e.document,s=!1,function e(){try{a.documentElement.doScroll("left")}catch(c){return void setTimeout(e,50)}l()}(),a.onreadystatechange=function(){"complete"==a.readyState&&(a.onreadystatechange=null,l())})}function l(){s||(s=!0,i())}})(window),window._iconfont_svg_string_fdm_opacity='<svg>\n  <symbol id="fdm-radio-select" viewBox="0 0 18 18" >    <rect x="0.5" y="0.5" width="17" height="17" rx="8.5"/>    <path fill-rule="evenodd" clip-rule="evenodd" d="M3.74672 8.58641C4.05914 8.27399 4.56567 8.27399 4.87809 8.58641L7.84793 11.5563L13.6203 5.78389C13.9327 5.47147 14.4393 5.47147 14.7517 5.78389C15.0641 6.09631 15.0641 6.60284 14.7517 6.91526L8.41362 13.2533C8.1012 13.5657 7.59467 13.5657 7.28225 13.2533L3.74672 9.71779C3.4343 9.40537 3.4343 8.89883 3.74672 8.58641Z" fill="white"/>  </symbol>  <symbol id="fdm-checkbox-select" viewBox="0 0 18 18" >    <rect x="1.5" y="1.5" width="15" height="15" rx="1.5" />    <path fill-rule="evenodd" clip-rule="evenodd" d="M3.74672 8.58641C4.05914 8.27399 4.56567 8.27399 4.87809 8.58641L7.84793 11.5563L13.6203 5.78389C13.9327 5.47147 14.4393 5.47147 14.7517 5.78389C15.0641 6.09631 15.0641 6.60284 14.7517 6.91526L8.41362 13.2533C8.1012 13.5657 7.59467 13.5657 7.28225 13.2533L3.74672 9.71779C3.4343 9.40537 3.4343 8.89883 3.74672 8.58641Z" fill="white"/>  </symbol>\n',function(e){var t,r=(t=(t=document.getElementsByTagName("script"))[t.length-1]).getAttribute("data-injectcss");if(!(t=t.getAttribute("data-disable-injectsvg"))){var n,o,i,a,s;if(r&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(c){console}}n=function(){var t,r=document.createElement("div");r.innerHTML=e._iconfont_svg_string_fdm_opacity,(r=r.getElementsByTagName("svg")[0])&&(r.setAttribute("aria-hidden","true"),r.style.position="absolute",r.style.width=0,r.style.height=0,r.style.overflow="hidden",(t=document.body).firstChild?function(e,t){t.parentNode.insertBefore(e,t)}(r,t.firstChild):t.appendChild(r))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(n,0):(o=function(){document.removeEventListener("DOMContentLoaded",o,!1),n()},document.addEventListener("DOMContentLoaded",o,!1)):document.attachEvent&&(i=n,a=e.document,s=!1,function e(){try{a.documentElement.doScroll("left")}catch(c){return void setTimeout(e,50)}l()}(),a.onreadystatechange=function(){"complete"==a.readyState&&(a.onreadystatechange=null,l())})}function l(){s||(s=!0,i())}}(window);const Icon$1=e=>{const{size:t,color:r,name:n,className:o}=e,i=null!=r?r:"currentcolor";return jsxRuntimeExports.jsx("svg",Object.assign({className:o,style:{width:null!=t?t:"var(--fdm-icon-size)",height:null!=t?t:"var(--fdm-icon-size)",fill:i}},{children:jsxRuntimeExports.jsx("use",{xlinkHref:"#".concat(n)})}))};var copyObject$1=_copyObject$1,createAssigner$1=_createAssigner$1,keys$2=keys_1$1,assignWith=createAssigner$1((function(e,t,r,n){copyObject$1(t,keys$2(t),e,n)})),assignWith_1=assignWith;const assignWith$1=getDefaultExportFromCjs$1(assignWith_1);function mergeProps(...e){function t(e,t){return void 0===t?e:t}let r=Object.assign({},e[0]);for(let n=1;n<e.length;n++)r=assignWith$1(r,e[n],t);return r}function withNativeProps(e,t){const r=Object.assign({},t.props);e.className&&(r.className=classNames$1(t.props.className,e.className)),e.style&&(r.style=Object.assign(Object.assign({},r.style),e.style)),void 0!==e.tabIndex&&(r.tabIndex=e.tabIndex);for(const n in e)e.hasOwnProperty(n)&&(n.startsWith("data-")||n.startsWith("aria-"))&&(r[n]=e[n]);return React.cloneElement(t,r)}const transSpacing=(e={})=>{const{paddingHorizontal:t,paddingVertical:r,marginHorizontal:n,marginVertical:o}=e,i=__rest$p(e,["paddingHorizontal","paddingVertical","marginHorizontal","marginVertical"]);return isUndefined$3(t)||(i.paddingLeft=t,i.paddingRight=t),isUndefined$3(r)||(i.paddingTop=t,i.paddingBottom=t),isUndefined$3(n)||(i.marginLeft=n,i.marginRight=n),isUndefined$3(o)||(i.marginTop=o,i.marginBottom=o),i};function transformStyle(e={}){return e=omitBy$1(e,isUndefined$3),e=transSpacing(e)}const classPrefix$D="fdm-button",defaultProps$M={fill:"solid",block:!1,type:"button"},Button$3=reactExports.forwardRef(((e,t)=>{const r=mergeProps(defaultProps$M,e),[n,o]=reactExports.useState(!1),i=reactExports.useRef(null),a=r.disabled;reactExports.useImperativeHandle(t,(()=>({get nativeElement(){return i.current}})));let s=r.style;return n&&(s=Object.assign(Object.assign({},r.style),r.pressedStyle)),withNativeProps(r,jsxRuntimeExports.jsxs("button",Object.assign({ref:i,type:r.type,style:transformStyle(s),onClick:e=>__awaiter(void 0,void 0,void 0,(function*(){var t;null===(t=r.onClick)||void 0===t||t.call(r,e)})),className:classNames$1(classPrefix$D,{["".concat(classPrefix$D,"-block")]:r.block,["".concat(classPrefix$D,"-disabled")]:a,["".concat(classPrefix$D,"-fill-outline")]:"outline"===r.fill,["".concat(classPrefix$D,"-fill-none")]:"none"===r.fill}),disabled:a,onMouseDown:e=>__awaiter(void 0,void 0,void 0,(function*(){var t;o(!0),null===(t=r.onMouseDown)||void 0===t||t.call(r,e)})),onMouseUp:e=>__awaiter(void 0,void 0,void 0,(function*(){var t;o(!1),null===(t=r.onMouseUp)||void 0===t||t.call(r,e)})),onTouchStart:e=>__awaiter(void 0,void 0,void 0,(function*(){var t;o(!0),null===(t=r.onTouchStart)||void 0===t||t.call(r,e)})),onTouchEnd:e=>__awaiter(void 0,void 0,void 0,(function*(){var t;o(!1),null===(t=r.onTouchEnd)||void 0===t||t.call(r,e)}))},{children:[r.icon&&jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$D,"-button-icon")},{children:isFunction$8(r.icon)?r.icon():jsxRuntimeExports.jsx(Icon$1,{name:r.icon})})),jsxRuntimeExports.jsx("span",Object.assign({className:"fdm-text-ellipsis"},{children:r.children}))]})))}));var createUpdateEffect=function(e){return function(t,r){var n=reactExports.useRef(!1);e((function(){return function(){n.current=!1}}),[]),e((function(){if(n.current)return t();n.current=!0}),r)}},isFunction$3=function(e){return"function"==typeof e},isNumber$3=function(e){return"number"==typeof e};function useMemoizedFn$1(e){var t=reactExports.useRef(e);t.current=reactExports.useMemo((function(){return e}),[e]);var r=reactExports.useRef();return r.current||(r.current=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.current.apply(this,e)}),r.current}const useUpdateEffect=createUpdateEffect(reactExports.useEffect);function depsAreSame(e,t){if(e===t)return!0;for(var r=0;r<e.length;r++)if(!Object.is(e[r],t[r]))return!1;return!0}function useLatest(e){var t=reactExports.useRef(e);return t.current=e,t}var useUnmount=function(e){var t=useLatest(e);reactExports.useEffect((function(){return function(){t.current()}}),[])},isBrowser$3=!("undefined"==typeof window||!window.document||!window.document.createElement),useMount=function(e){reactExports.useEffect((function(){null==e||e()}),[])},useUpdate=function(){var e=__read$1(reactExports.useState({}),2)[1];return reactExports.useCallback((function(){return e({})}),[])};function useToggle(e,t){void 0===e&&(e=!1);var r=__read$1(reactExports.useState(e),2),n=r[0],o=r[1];return[n,reactExports.useMemo((function(){var t=!e;return{toggle:function(){return o((function(r){return r===e?t:e}))},set:function(e){return o(e)},setLeft:function(){return o(e)},setRight:function(){return o(t)}}}),[])]}function useBoolean(e){var t=__read$1(useToggle(!!e),2),r=t[0],n=t[1],o=n.toggle,i=n.set;return[r,reactExports.useMemo((function(){return{toggle:o,set:function(e){return i(!!e)},setTrue:function(){return i(!0)},setFalse:function(){return i(!1)}}}),[])]}function getTargetElement(e,t){if(isBrowser$3)return e?isFunction$3(e)?e():"current"in e?e.current:e:t}var checkIfAllInShadow=function(e){return e.every((function(e){var t=getTargetElement(e);return!!t&&t.getRootNode()instanceof ShadowRoot}))},getShadow=function(e){return e?e.getRootNode():document},getDocumentOrShadow=function(e){if(!e||!document.getRootNode)return document;var t=Array.isArray(e)?e:[e];return checkIfAllInShadow(t)?getShadow(getTargetElement(t[0])):document},createEffectWithTarget=function(e){return function(t,r,n){var o=reactExports.useRef(!1),i=reactExports.useRef([]),a=reactExports.useRef([]),s=reactExports.useRef();e((function(){var e,l=(Array.isArray(n)?n:[n]).map((function(e){return getTargetElement(e)}));if(!o.current)return o.current=!0,i.current=l,a.current=r,void(s.current=t());l.length===i.current.length&&depsAreSame(i.current,l)&&depsAreSame(a.current,r)||(null===(e=s.current)||void 0===e||e.call(s),i.current=l,a.current=r,s.current=t())})),useUnmount((function(){var e;null===(e=s.current)||void 0===e||e.call(s),o.current=!1}))}},useEffectWithTarget$1=createEffectWithTarget(reactExports.useEffect);function useClickAway(e,t,r){void 0===r&&(r="click");var n=useLatest(e);useEffectWithTarget$1((function(){var e=function(e){(Array.isArray(t)?t:[t]).some((function(t){var r=getTargetElement(t);return!r||r.contains(e.target)}))||n.current(e)},o=getDocumentOrShadow(t),i=Array.isArray(r)?r:[r];return i.forEach((function(t){return o.addEventListener(t,e)})),function(){i.forEach((function(t){return o.removeEventListener(t,e)}))}}),Array.isArray(r)?r:[r],t)}function useDebounceFn(e,t){var r,n=useLatest(e),o=null!==(r=null==t?void 0:t.wait)&&void 0!==r?r:1e3,i=reactExports.useMemo((function(){return debounce$4((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.current.apply(n,__spreadArray$1([],__read$1(e),!1))}),o,t)}),[]);return useUnmount((function(){i.cancel()})),{run:i,cancel:i.cancel,flush:i.flush}}function useDebounceEffect(e,t,r){var n=__read$1(reactExports.useState({}),2),o=n[0],i=n[1],a=useDebounceFn((function(){i({})}),r).run;reactExports.useEffect((function(){return a()}),t),useUpdateEffect(e,[o])}var hasElementType="undefined"!=typeof Element,hasMap="function"==typeof Map,hasSet="function"==typeof Set,hasArrayBuffer="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function equal(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;var r,n,o,i;if(Array.isArray(e)){if((r=e.length)!=t.length)return!1;for(n=r;0!=n--;)if(!equal(e[n],t[n]))return!1;return!0}if(hasMap&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i=e.entries();!(n=i.next()).done;)if(!t.has(n.value[0]))return!1;for(i=e.entries();!(n=i.next()).done;)if(!equal(n.value[1],t.get(n.value[0])))return!1;return!0}if(hasSet&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i=e.entries();!(n=i.next()).done;)if(!t.has(n.value[0]))return!1;return!0}if(hasArrayBuffer&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if((r=e.length)!=t.length)return!1;for(n=r;0!=n--;)if(e[n]!==t[n])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&"function"==typeof e.valueOf&&"function"==typeof t.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&"function"==typeof e.toString&&"function"==typeof t.toString)return e.toString()===t.toString();if((r=(o=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(n=r;0!=n--;)if(!Object.prototype.hasOwnProperty.call(t,o[n]))return!1;if(hasElementType&&e instanceof Element)return!1;for(n=r;0!=n--;)if(("_owner"!==o[n]&&"__v"!==o[n]&&"__o"!==o[n]||!e.$$typeof)&&!equal(e[o[n]],t[o[n]]))return!1;return!0}return e!=e&&t!=t}var reactFastCompare=function(e,t){try{return equal(e,t)}catch(r){if((r.message||"").match(/stack|recursion/i))return!1;throw r}};const isEqual$3=getDefaultExportFromCjs$1(reactFastCompare);var depsEqual=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=[]),isEqual$3(e,t)},createDeepCompareEffect=function(e){return function(t,r){var n=reactExports.useRef(),o=reactExports.useRef(0);void 0!==r&&depsEqual(r,n.current)||(o.current+=1),n.current=r,e(t,[o.current])}};const useDeepCompareEffect=createDeepCompareEffect(reactExports.useEffect);function useEventListener(e,t,r){void 0===r&&(r={});var n=r.enable,o=void 0===n||n,i=useLatest(t);useEffectWithTarget$1((function(){if(o){var t=getTargetElement(r.target,window);if(null==t?void 0:t.addEventListener){var n=function(e){return i.current(e)};return t.addEventListener(e,n,{capture:r.capture,once:r.once,passive:r.passive}),function(){t.removeEventListener(e,n,{capture:r.capture})}}}}),[e,r.capture,r.once,r.passive,o],r.target)}function useFocusWithin(e,t){var r=__read$1(reactExports.useState(!1),2),n=r[0],o=r[1],i={},a=i.onFocus,s=i.onBlur,l=i.onChange;return useEventListener("focusin",(function(e){n||(null==a||a(e),null==l||l(!0),o(!0))}),{target:e}),useEventListener("focusout",(function(e){var t,r;n&&!(null===(r=null===(t=e.currentTarget)||void 0===t?void 0:t.contains)||void 0===r?void 0:r.call(t,e.relatedTarget))&&(null==s||s(e),null==l||l(!1),o(!1))}),{target:e}),n}function useGetState(e){var t=__read$1(reactExports.useState(e),2),r=t[0],n=t[1],o=useLatest(r);return[r,n,reactExports.useCallback((function(){return o.current}),[])]}var useInterval=function(e,t,r){void 0===r&&(r={});var n=useMemoizedFn$1(e),o=reactExports.useRef(null),i=reactExports.useCallback((function(){o.current&&clearInterval(o.current)}),[]);return reactExports.useEffect((function(){if(isNumber$3(t)&&!(t<0))return r.immediate&&n(),o.current=setInterval(n,t),i}),[t,r.immediate]),i};function useInViewport(e,t){var r={},n=r.callback,o=__rest$p(r,["callback"]),i=__read$1(reactExports.useState(),2),a=i[0],s=i[1],l=__read$1(reactExports.useState(),2),c=l[0],u=l[1];return useEffectWithTarget$1((function(){var t=(Array.isArray(e)?e:[e]).map((function(e){return getTargetElement(e)})).filter(Boolean);if(t.length){var r=new IntersectionObserver((function(e){var t,r;try{for(var o=__values(e),i=o.next();!i.done;i=o.next()){var a=i.value;u(a.intersectionRatio),s(a.isIntersecting),null==n||n(a)}}catch(l){t={error:l}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}}),__assign(__assign({},o),{root:getTargetElement(void 0)}));return t.forEach((function(e){return r.observe(e)})),function(){r.disconnect()}}}),[void 0,void 0,n],e),[a,c]}!function(){if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var e=function(){for(var e=window.document,t=o(e);t;)t=o(e=t.ownerDocument);return e}(),t=[],r=null,n=null;a.prototype.THROTTLE_TIMEOUT=100,a.prototype.POLL_INTERVAL=null,a.prototype.USE_MUTATION_OBSERVER=!0,a._setupCrossOriginUpdater=function(){return r||(r=function(e,r){n=e&&r?d(e,r):{top:0,bottom:0,left:0,right:0,width:0,height:0},t.forEach((function(e){e._checkForIntersections()}))}),r},a._resetCrossOriginUpdater=function(){r=null,n=null},a.prototype.observe=function(e){if(!this._observationTargets.some((function(t){return t.element==e}))){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(e.ownerDocument),this._checkForIntersections()}},a.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter((function(t){return t.element!=e})),this._unmonitorIntersections(e.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},a.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},a.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},a.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter((function(e,t,r){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==r[t-1]}))},a.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map((function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}}));return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},a.prototype._monitorIntersections=function(t){var r=t.defaultView;if(r&&-1==this._monitoringDocuments.indexOf(t)){var n=this._checkForIntersections,i=null,a=null;this.POLL_INTERVAL?i=r.setInterval(n,this.POLL_INTERVAL):(s(r,"resize",n,!0),s(t,"scroll",n,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in r&&(a=new r.MutationObserver(n)).observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(t),this._monitoringUnsubscribes.push((function(){var e=t.defaultView;e&&(i&&e.clearInterval(i),l(e,"resize",n,!0)),l(t,"scroll",n,!0),a&&a.disconnect()}));var c=this.root&&(this.root.ownerDocument||this.root)||e;if(t!=c){var u=o(t);u&&this._monitorIntersections(u.ownerDocument)}}},a.prototype._unmonitorIntersections=function(t){var r=this._monitoringDocuments.indexOf(t);if(-1!=r){var n=this.root&&(this.root.ownerDocument||this.root)||e;if(!this._observationTargets.some((function(e){var r=e.element.ownerDocument;if(r==t)return!0;for(;r&&r!=n;){var i=o(r);if((r=i&&i.ownerDocument)==t)return!0}return!1}))){var i=this._monitoringUnsubscribes[r];if(this._monitoringDocuments.splice(r,1),this._monitoringUnsubscribes.splice(r,1),i(),t!=n){var a=o(t);a&&this._unmonitorIntersections(a.ownerDocument)}}}},a.prototype._unmonitorAllIntersections=function(){var e=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var t=0;t<e.length;t++)e[t]()},a.prototype._checkForIntersections=function(){if(this.root||!r||n){var e=this._rootIsInDom(),t=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach((function(n){var o=n.element,a=c(o),s=this._rootContainsTarget(o),l=n.entry,u=e&&s&&this._computeTargetAndRootIntersection(o,a,t),d=null;this._rootContainsTarget(o)?r&&!this.root||(d=t):d={top:0,bottom:0,left:0,right:0,width:0,height:0};var h=n.entry=new i({time:window.performance&&performance.now&&performance.now(),target:o,boundingClientRect:a,rootBounds:d,intersectionRect:u});l?e&&s?this._hasCrossedThreshold(l,h)&&this._queuedEntries.push(h):l&&l.isIntersecting&&this._queuedEntries.push(h):this._queuedEntries.push(h)}),this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},a.prototype._computeTargetAndRootIntersection=function(t,o,i){if("none"!=window.getComputedStyle(t).display){for(var a,s,l,u,h,f,g,m,y=o,v=p(t),_=!1;!_&&v;){var b=null,C=1==v.nodeType?window.getComputedStyle(v):{};if("none"==C.display)return null;if(v==this.root||9==v.nodeType)if(_=!0,v==this.root||v==e)r&&!this.root?!n||0==n.width&&0==n.height?(v=null,b=null,y=null):b=n:b=i;else{var E=p(v),T=E&&c(E),S=E&&this._computeTargetAndRootIntersection(E,T,i);T&&S?(v=E,b=d(T,S)):(v=null,y=null)}else{var P=v.ownerDocument;v!=P.body&&v!=P.documentElement&&"visible"!=C.overflow&&(b=c(v))}if(b&&(a=b,s=y,l=void 0,u=void 0,h=void 0,f=void 0,g=void 0,m=void 0,l=Math.max(a.top,s.top),u=Math.min(a.bottom,s.bottom),h=Math.max(a.left,s.left),f=Math.min(a.right,s.right),m=u-l,y=(g=f-h)>=0&&m>=0&&{top:l,bottom:u,left:h,right:f,width:g,height:m}||null),!y)break;v=v&&p(v)}return y}},a.prototype._getRootRect=function(){var t;if(this.root&&!f(this.root))t=c(this.root);else{var r=f(this.root)?this.root:e,n=r.documentElement,o=r.body;t={top:0,left:0,right:n.clientWidth||o.clientWidth,width:n.clientWidth||o.clientWidth,bottom:n.clientHeight||o.clientHeight,height:n.clientHeight||o.clientHeight}}return this._expandRectByRootMargin(t)},a.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map((function(t,r){return"px"==t.unit?t.value:t.value*(r%2?e.width:e.height)/100})),r={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3]};return r.width=r.right-r.left,r.height=r.bottom-r.top,r},a.prototype._hasCrossedThreshold=function(e,t){var r=e&&e.isIntersecting?e.intersectionRatio||0:-1,n=t.isIntersecting?t.intersectionRatio||0:-1;if(r!==n)for(var o=0;o<this.thresholds.length;o++){var i=this.thresholds[o];if(i==r||i==n||i<r!=i<n)return!0}},a.prototype._rootIsInDom=function(){return!this.root||h(e,this.root)},a.prototype._rootContainsTarget=function(t){var r=this.root&&(this.root.ownerDocument||this.root)||e;return h(r,t)&&(!this.root||r==t.ownerDocument)},a.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},a.prototype._unregisterInstance=function(){var e=t.indexOf(this);-1!=e&&t.splice(e,1)},window.IntersectionObserver=a,window.IntersectionObserverEntry=i}function o(e){try{return e.defaultView&&e.defaultView.frameElement||null}catch(e3){return null}}function i(e){this.time=e.time,this.target=e.target,this.rootBounds=u(e.rootBounds),this.boundingClientRect=u(e.boundingClientRect),this.intersectionRect=u(e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0}),this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,r=t.width*t.height,n=this.intersectionRect,o=n.width*n.height;this.intersectionRatio=r?Number((o/r).toFixed(4)):this.isIntersecting?1:0}function a(e,t){var r,n,o,i=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(i.root&&1!=i.root.nodeType&&9!=i.root.nodeType)throw new Error("root must be a Document or Element");this._checkForIntersections=(r=this._checkForIntersections.bind(this),n=this.THROTTLE_TIMEOUT,o=null,function(){o||(o=setTimeout((function(){r(),o=null}),n))}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(i.rootMargin),this.thresholds=this._initThresholds(i.threshold),this.root=i.root||null,this.rootMargin=this._rootMarginValues.map((function(e){return e.value+e.unit})).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}function s(e,t,r,n){"function"==typeof e.addEventListener?e.addEventListener(t,r,n):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,r)}function l(e,t,r,n){"function"==typeof e.removeEventListener?e.removeEventListener(t,r,n):"function"==typeof e.detachEvent&&e.detachEvent("on"+t,r)}function c(e){var t;try{t=e.getBoundingClientRect()}catch(r){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function u(e){return!e||"x"in e?e:{top:e.top,y:e.top,bottom:e.bottom,left:e.left,x:e.left,right:e.right,width:e.width,height:e.height}}function d(e,t){var r=t.top-e.top,n=t.left-e.left;return{top:r,left:n,height:t.height,width:t.width,bottom:r+t.height,right:n+t.width}}function h(e,t){for(var r=t;r;){if(r==e)return!0;r=p(r)}return!1}function p(t){var r=t.parentNode;return 9==t.nodeType&&t!=e?o(t):(r&&r.assignedSlot&&(r=r.assignedSlot.parentNode),r&&11==r.nodeType&&r.host?r.host:r)}function f(e){return e&&9===e.nodeType}}();var useIsomorphicLayoutEffect$2=isBrowser$3?reactExports.useLayoutEffect:reactExports.useEffect;function useRafState(e){var t=reactExports.useRef(0),r=__read$1(reactExports.useState(e),2),n=r[0],o=r[1],i=reactExports.useCallback((function(e){cancelAnimationFrame(t.current),t.current=requestAnimationFrame((function(){o(e)}))}),[]);return useUnmount((function(){cancelAnimationFrame(t.current)})),[n,i]}var useUnmountedRef=function(){var e=reactExports.useRef(!1);return reactExports.useEffect((function(){return e.current=!1,function(){e.current=!0}}),[]),e},useEffectWithTarget=createEffectWithTarget(reactExports.useLayoutEffect),useIsomorphicLayoutEffectWithTarget=isBrowser$3?useEffectWithTarget:useEffectWithTarget$1;function useSize$2(e){var t=__read$1(useRafState((function(){var t=getTargetElement(e);return t?{width:t.clientWidth,height:t.clientHeight}:void 0})),2),r=t[0],n=t[1];return useIsomorphicLayoutEffectWithTarget((function(){var t=getTargetElement(e);if(t){var r=new index$1((function(e){e.forEach((function(e){var t=e.target,r=t.clientWidth,o=t.clientHeight;n({width:r,height:o})}))}));return r.observe(t),function(){r.disconnect()}}}),[],e),r}const useUpdateLayoutEffect=createUpdateEffect(reactExports.useLayoutEffect),useVanChart=(e,t)=>{const r=reactExports.useRef(null),n=reactExports.useRef(!1),o=reactExports.useRef([]),i=reactExports.useRef(!1),a=e=>{var o;n.current||!e||r.current||(s(e),null===(o=t.onLoadFinished)||void 0===o||o.call(t),l(),n.current=!1)},s=t=>{var n;t&&window.VanCharts&&e.current&&(r.current=window.VanCharts.init(e.current),c(t),null===(n=r.current)||void 0===n||n.setOptions(t),h())},l=()=>{r.current&&(o.current.forEach((e=>{try{r.current.trigger(e.event,e.data)}catch(t){}})),o.current=[])},c=e=>{(isArray$c(e.options)?e.options:[e]).forEach((r=>{if(e){const e=(e,r,n)=>{var o;const a=u(e,r,n),s=r.type;i.current?"touchstart"===s?i.current=!1:a.interactionEnd=!0:"touchend"===s&&(a.interactionEnd=!0),"up"===n&&m(),null===(o=t.onClick)||void 0===o||o.call(t,a)};if(r.dTools){const t=(t,r)=>{const n=Object.prototype.hasOwnProperty.call(t,"allowDrillType")?t.allowDrillType||"none":"up";e(t,r,n)};r.dTools.click=(e,r)=>{t(e,r)}}if(r.plotOptions){const t=(t,r)=>{const n=t.allowDrillType||"none";e(t,r,n)};r.plotOptions.click=function(e){t(this,e)}}}}))},u=(t,r,n)=>{var o,i;const{jsonHyperlink:a,tooltipText:s,drillUpLink:l}=t,c=null===(o=e.current)||void 0===o?void 0:o.getBoundingClientRect();let u=0,d=0,h=0,p=0;if(r&&e.current&&c)if(Object.prototype.hasOwnProperty.call(r,"vanX")&&Object.prototype.hasOwnProperty.call(r,"vanY"))h=r.vanX,p=r.vanY,u=c.left+h,d=c.top+p;else{const t=c.height/e.current.clientHeight;u=r.clientX,d=r.clientY,h=(u-c.left)/t,p=(d-c.top)/t}const f=s&&(null===(i=t.options.tooltip)||void 0===i?void 0:i.enabled)?s:[];return{dataPoint:t,dynamicHyperlink:window.Van&&window.Van.Utils.createLinkData4VanChart(t),hyperlinks:a,tooltipText:f,drillTypeNeedExecuted:n,drillUpLink:l,screenOffset:{x:u,y:d},x:h,y:p}},d=(e,t)=>{var n;const o=r.current;null===(n=null==o?void 0:o.on)||void 0===n||n.call(o,e,t)},h=()=>{d("pointSelected",(e=>{f("pointSelected",e)})),d("pointCanceled",(()=>{p(),f("pointCanceled")})),d("hideMobileTooltip",(e=>{e.delay?p():f("hideMobileTooltip",e)}))},p=e=>{i.current=!0,f("interactionEnd",e)},f=(e,r)=>{var n;null===(n=t.onChartEventTrigger)||void 0===n||n.call(t,{event:e,data:r})},g=(e,t)=>{if(r.current)try{((e,t)=>{let n=t;isString$3(t)&&(n=JSON.parse(t));const o=r.current;if(o)switch(e){case"showIndexChart":o.carousel.showIndexChartAndRestTimer(n.index);break;case"switchCarouselChart":o.carousel.switchChartAndRestTimer(n.direction);break;case"setSeriesVisible":o.getChart(n.index).setSeriesVisible(n.chartSeries);break;default:o.trigger(e,t)}})(e,t)}catch(e3){}else o.current.push({event:e,data:t})},m=()=>{g("drill",{type:"up"})};return{get instance(){return r.current},loadChart:a,resizeChart:e=>{var t;const{width:n,height:o}=e;n>0&&o>0&&(null===(t=r.current)||void 0===t||t.resize())},clearChart:()=>{r.current&&r.current.clear()},refreshChartWithConfig:e=>{if(e)if(r.current){c(e);try{r.current.setData(e)}catch(t){}}else a(e)},refreshSubChartWithConfig:({subChartAttr:e,subChartIndex:t})=>{if(r.current)try{isString$3(e)&&(e=JSON.parse(e)),c(e),r.current.setData(e,t)}catch(n){}},registerChartEvent:d,triggerChartEvent:g,drillDown:()=>{g("drill",{type:"down"})},drillUp:m}},defaultProps$L={blockGestures:!1,nativeHandleEnable:!1,refresh:{interval:0}},useUpdateDeepCompareEffect=createUpdateEffect(useDeepCompareEffect);var MASK_REASON,MASK_REASON2;MASK_REASON2=MASK_REASON||(MASK_REASON={}),MASK_REASON2[MASK_REASON2.GANTT=1]="GANTT",MASK_REASON2[MASK_REASON2.PROPS=2]="PROPS";const Chart$1=e=>{const t=mergeProps(defaultProps$L,e),{height:r,width:n,vanchartRef:o,refresh:i,isClickAwayAllowed:a}=t,s=reactExports.useRef(),{interval:l,fetcher:c}=i,u=reactExports.useRef(null),d=reactExports.useRef(null),[h,p]=reactExports.useState([]);reactExports.useEffect((()=>{t.blockGestures?p((e=>[...e,MASK_REASON.PROPS])):p((e=>e.filter((e=>e!==MASK_REASON.PROPS))))}),[t.blockGestures]);const f=()=>(s.current=s.current||cloneDeep$2(t.options),s.current);useInterval((()=>{null==c||c().then((e=>{g.refreshChartWithConfig(e)}))}),l>0&&c?l:void 0);const g=useVanChart(d,{onLoadFinished:()=>{var e;null===(e=t.onLoadFinished)||void 0===e||e.call(t),g.registerChartEvent("nativeHandleNext",(()=>{t.nativeHandleEnable&&p((e=>[...e,MASK_REASON.GANTT]))}))},onClick:t.onClick,onChartEventTrigger:t.onChartEventTrigger});o&&(o.current=g);const m=useSize$2(u),y=reactExports.useRef();reactExports.useEffect((()=>{d.current&&g.loadChart(f())}),[d.current]),useUpdateDeepCompareEffect((()=>{s.current=cloneDeep$2(t.options),d.current&&g.refreshChartWithConfig(f())}),[t.options]),reactExports.useEffect((()=>{(null==m?void 0:m.height)&&(null==m?void 0:m.width)&&(y.current?g.resizeChart(m):(y.current=m,setTimeout((()=>{g.resizeChart(m)}),300)),g.triggerChartEvent("enable"))}),[null==m?void 0:m.height,null==m?void 0:m.width]);useClickAway((e=>{var r;t.blockGestures&&(null===(r=null==a?void 0:a(e))||void 0===r||r)&&p((e=>[...e,MASK_REASON.PROPS]))}),u,["click","touchstart"]);const v=!isEmpty$3(h);return jsxRuntimeExports.jsxs("div",Object.assign({className:"chart-container",style:{height:r,width:n},ref:u,onClickCapture:()=>{p((e=>e.filter((e=>e!==MASK_REASON.PROPS))))},onTouchStart:t.onTouchStart,onTouchEnd:t.onTouchEnd},{children:[jsxRuntimeExports.jsx("div",{ref:d,style:{flex:1}}),jsxRuntimeExports.jsx("div",{className:"mask",style:{display:v?"flex":"none"},onClickCapture:e=>{p((e=>e.filter((e=>e!==MASK_REASON.GANTT))));const t=d.current;if(t){const{left:r,top:n}=t.getBoundingClientRect();g.triggerChartEvent("enable",{x:e.pageX-r,y:e.pageY-n})}}})]}))};function mergeLocale(e,t){return function e(t,r){if("object"!=typeof t||"object"!=typeof r||Array.isArray(t)||Array.isArray(r))return void 0!==r?r:t;const n={};for(const o in t)t.hasOwnProperty(o)&&(n[o]=e(t[o],r[o]));return n}(e,t)}const typeTemplate$1="${label} is not a valid ${type}",base$2={locale:"en",common:{confirm:"Confirm",cancel:"Cancel",loading:"Loading",close:"Close"},Calendar:{markItems:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],renderYearAndMonth:(e,t)=>"".concat(e,"/").concat(t)},Cascader:{placeholder:"Selecting"},Dialog:{ok:"OK"},DatePicker:{tillNow:"Till Now"},ErrorBlock:{default:{title:"Oops, something went wrong",description:"Please wait a minute and try again"},busy:{title:"Oops, not loading",description:"Try to refresh the page"},disconnected:{title:"Network is busy",description:"Try to refresh the page"},empty:{title:"Hmm, couldn't find that...",description:"Want to try a new search?"}},Form:{required:"Required",optional:"Optional",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:typeTemplate$1,method:typeTemplate$1,array:typeTemplate$1,object:typeTemplate$1,number:typeTemplate$1,date:typeTemplate$1,boolean:typeTemplate$1,integer:typeTemplate$1,float:typeTemplate$1,regexp:typeTemplate$1,email:typeTemplate$1,url:typeTemplate$1,hex:typeTemplate$1},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},ImageUploader:{uploading:"Uploading...",upload:"Upload"},InfiniteScroll:{noMore:"No more",failedToLoad:"Failed to load",retry:"Retry"},Input:{clear:"clear"},Mask:{name:"Mask"},Modal:{ok:"OK"},PasscodeInput:{name:"Passcode Input"},PullToRefresh:{pulling:"Scroll down to refresh",canRelease:"Release to refresh immediately",complete:"Refresh successful"},SearchBar:{name:"Search Bar"},Slider:{name:"Slider"},Stepper:{decrease:"decrease",increase:"increase"},Switch:{name:"Switch"},Selector:{name:"Selector"}},typeTemplate="${label}不是一个有效的${type}",zhCN=mergeLocale(base$2,{locale:"zh-CH",common:{confirm:"确定",cancel:"取消",loading:"加载中",close:"关闭"},Calendar:{markItems:["一","二","三","四","五","六","日"],renderYearAndMonth:(e,t)=>"".concat(e,"年").concat(t,"月")},Cascader:{placeholder:"请选择"},Dialog:{ok:"我知道了"},DatePicker:{tillNow:"至今"},ErrorBlock:{default:{title:"页面遇到一些小问题",description:"待会来试试"},busy:{title:"前方拥堵",description:"刷新试试"},disconnected:{title:"网络有点忙",description:"动动手指帮忙修复"},empty:{title:"没有找到你需要的东西",description:"找找其他的吧"}},Form:{required:"必填",optional:"选填",defaultValidateMessages:{default:"字段验证错误${label}",required:"请输入${label}",enum:"${label}必须是其中一个[${enum}]",whitespace:"${label}不能为空字符",date:{format:"${label}日期格式无效",parse:"${label}不能转换为日期",invalid:"${label}是一个无效日期"},types:{string:typeTemplate,method:typeTemplate,array:typeTemplate,object:typeTemplate,number:typeTemplate,date:typeTemplate,boolean:typeTemplate,integer:typeTemplate,float:typeTemplate,regexp:typeTemplate,email:typeTemplate,url:typeTemplate,hex:typeTemplate},string:{len:"${label}须为${len}个字符",min:"${label}最少${min}个字符",max:"${label}最多${max}个字符",range:"${label}须在${min}-${max}字符之间"},number:{len:"${label}必须等于${len}",min:"${label}最小值为${min}",max:"${label}最大值为${max}",range:"${label}须在${min}-${max}之间"},array:{len:"须为${len}个${label}",min:"最少${min}个${label}",max:"最多${max}个${label}",range:"${label}数量须在${min}-${max}之间"},pattern:{mismatch:"${label}与模式不匹配${pattern}"}}},ImageUploader:{uploading:"上传中...",upload:"上传"},InfiniteScroll:{noMore:"没有更多了",failedToLoad:"加载失败",retry:"重新加载"},Input:{clear:"清除"},Mask:{name:"背景蒙层"},Modal:{ok:"我知道了"},PasscodeInput:{name:"密码输入框"},PullToRefresh:{pulling:"下拉刷新",canRelease:"释放立即刷新",complete:"刷新成功"},SearchBar:{name:"搜索框"},Slider:{name:"滑动输入条"},Stepper:{decrease:"减少",increase:"增加"},Switch:{name:"开关"},Selector:{name:"选择组"}}),defaultConfigRef={current:{locale:zhCN}};function setDefaultConfig$1(e){defaultConfigRef.current=e}function getDefaultConfig(){return defaultConfigRef.current}const ConfigContext=React.createContext(null);function useConfig$1(){var e;return null!==(e=reactExports.useContext(ConfigContext))&&void 0!==e?e:getDefaultConfig()}function attachPropertiesToComponent(e,t){const r=e;for(const n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);return r}const MIN_DISTANCE=10;function getDirection(e,t){return e>t&&e>MIN_DISTANCE?"horizontal":t>e&&t>MIN_DISTANCE?"vertical":""}function useTouch(){const e=reactExports.useRef(0),t=reactExports.useRef(0),r=reactExports.useRef(0),n=reactExports.useRef(0),o=reactExports.useRef(0),i=reactExports.useRef(0),a=reactExports.useRef(""),s=()=>{r.current=0,n.current=0,o.current=0,i.current=0,a.current=""};return{move:s=>{const l=s.touches[0];r.current=l.clientX<0?0:l.clientX-e.current,n.current=l.clientY-t.current,o.current=Math.abs(r.current),i.current=Math.abs(n.current),a.current||(a.current=getDirection(o.current,i.current))},start:r=>{s(),e.current=r.touches[0].clientX,t.current=r.touches[0].clientY},reset:s,startX:e,startY:t,deltaX:r,deltaY:n,offsetX:o,offsetY:i,direction:a,isVertical:()=>"vertical"===a.current,isHorizontal:()=>"horizontal"===a.current}}const defaultRoot=canUseDom?window:void 0,overflowStylePatterns=["scroll","auto","overlay"];function isElement$3(e){return 1===e.nodeType}function getScrollParent(e,t=defaultRoot){let r=e;for(;r&&r!==t&&isElement$3(r);){if(r===document.body)return t;const{overflowY:e}=window.getComputedStyle(r);if(overflowStylePatterns.includes(e)&&r.scrollHeight>r.clientHeight)return r;r=r.parentNode}return t}let supportsPassive=!1;if(canUseDom)try{const e={};Object.defineProperty(e,"passive",{get(){supportsPassive=!0}}),window.addEventListener("test-passive",null,e)}catch(e3){}let totalLockCount=0;const BODY_LOCK_CLASS="adm-overflow-hidden";function getScrollableElement(e){let t=null==e?void 0:e.parentElement;for(;t;){if(t.clientHeight<t.scrollHeight)return t;t=t.parentElement}return null}function useLockScroll(e,t){const r=useTouch(),n=n=>{r.move(n);const o=r.deltaY.current>0?"10":"01",i=getScrollParent(n.target,e.current);if(!i)return;if("strict"===t){const e=getScrollableElement(n.target);if(e===document.body||e===document.documentElement)return void n.preventDefault()}const{scrollHeight:a,offsetHeight:s,scrollTop:l}=i;let c="11";0===l?c=s>=a?"00":"01":l+s>=a&&(c="10"),"11"===c||!r.isVertical()||parseInt(c,2)&parseInt(o,2)||n.cancelable&&n.preventDefault()};reactExports.useEffect((()=>{if(t)return document.addEventListener("touchstart",r.start),document.addEventListener("touchmove",n,!!supportsPassive&&{passive:!1}),totalLockCount||document.body.classList.add(BODY_LOCK_CLASS),totalLockCount++,()=>{totalLockCount&&(document.removeEventListener("touchstart",r.start),document.removeEventListener("touchmove",n),totalLockCount--,totalLockCount||document.body.classList.remove(BODY_LOCK_CLASS))}}),[t])}let updateQueue$1=makeQueue$1();const raf$2=e=>schedule$1(e,updateQueue$1);let writeQueue$1=makeQueue$1();raf$2.write=e=>schedule$1(e,writeQueue$1);let onStartQueue$1=makeQueue$1();raf$2.onStart=e=>schedule$1(e,onStartQueue$1);let onFrameQueue$1=makeQueue$1();raf$2.onFrame=e=>schedule$1(e,onFrameQueue$1);let onFinishQueue$1=makeQueue$1();raf$2.onFinish=e=>schedule$1(e,onFinishQueue$1);let timeouts$1=[];raf$2.setTimeout=(e,t)=>{let r=raf$2.now()+t,n=()=>{let e=timeouts$1.findIndex((e=>e.cancel==n));~e&&timeouts$1.splice(e,1),pendingCount$1-=~e?1:0},o={time:r,handler:e,cancel:n};return timeouts$1.splice(findTimeout$1(r),0,o),pendingCount$1+=1,start$1(),o};let findTimeout$1=e=>~(~timeouts$1.findIndex((t=>t.time>e))||~timeouts$1.length);raf$2.cancel=e=>{onStartQueue$1.delete(e),onFrameQueue$1.delete(e),onFinishQueue$1.delete(e),updateQueue$1.delete(e),writeQueue$1.delete(e)},raf$2.sync=e=>{sync$1=!0,raf$2.batchedUpdates(e),sync$1=!1},raf$2.throttle=e=>{let t;function r(){try{e(...t)}finally{t=null}}function n(...e){t=e,raf$2.onStart(r)}return n.handler=e,n.cancel=()=>{onStartQueue$1.delete(r),t=null},n};let nativeRaf$1="undefined"!=typeof window?window.requestAnimationFrame:()=>{};raf$2.use=e=>nativeRaf$1=e,raf$2.now="undefined"!=typeof performance?()=>performance.now():Date.now,raf$2.batchedUpdates=e=>e(),raf$2.catch=console.error,raf$2.frameLoop="always",raf$2.advance=()=>{"demand"!==raf$2.frameLoop||update$1()};let ts$1=-1,pendingCount$1=0,sync$1=!1;function schedule$1(e,t){sync$1?(t.delete(e),e(0)):(t.add(e),start$1())}function start$1(){ts$1<0&&(ts$1=0,"demand"!==raf$2.frameLoop&&nativeRaf$1(loop$1))}function stop$1(){ts$1=-1}function loop$1(){~ts$1&&(nativeRaf$1(loop$1),raf$2.batchedUpdates(update$1))}function update$1(){let e=ts$1;ts$1=raf$2.now();let t=findTimeout$1(ts$1);t&&(eachSafely$1(timeouts$1.splice(0,t),(e=>e.handler())),pendingCount$1-=t),pendingCount$1?(onStartQueue$1.flush(),updateQueue$1.flush(e?Math.min(64,ts$1-e):16.667),onFrameQueue$1.flush(),writeQueue$1.flush(),onFinishQueue$1.flush()):stop$1()}function makeQueue$1(){let e=new Set,t=e;return{add(r){pendingCount$1+=t!=e||e.has(r)?0:1,e.add(r)},delete:r=>(pendingCount$1-=t==e&&e.has(r)?1:0,e.delete(r)),flush(r){t.size&&(e=new Set,pendingCount$1-=t.size,eachSafely$1(t,(t=>t(r)&&e.add(t))),pendingCount$1+=e.size,t=e)}}}function eachSafely$1(e,t){e.forEach((e=>{try{t(e)}catch(e3){raf$2.catch(e3)}}))}function noop$4(){}const defineHidden$1=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,configurable:!0}),is$1={arr:Array.isArray,obj:e=>!!e&&"Object"===e.constructor.name,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,und:e=>void 0===e};function isEqual$2(e,t){if(is$1.arr(e)){if(!is$1.arr(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return e===t}const each$1=(e,t)=>e.forEach(t);function eachProp$1(e,t,r){if(is$1.arr(e))for(let n=0;n<e.length;n++)t.call(r,e[n],"".concat(n));else for(const n in e)e.hasOwnProperty(n)&&t.call(r,e[n],n)}const toArray$2=e=>is$1.und(e)?[]:is$1.arr(e)?e:[e];function flush$1(e,t){if(e.size){const r=Array.from(e);e.clear(),each$1(r,t)}}const flushCalls$1=(e,...t)=>flush$1(e,(e=>e(...t))),isSSR$1=()=>"undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent);let createStringInterpolator$1,to$2,colors$1=null,skipAnimation$1=!1,willAdvance$1=noop$4;const assign$1=e=>{e.to&&(to$2=e.to),e.now&&(raf$2.now=e.now),void 0!==e.colors&&(colors$1=e.colors),null!=e.skipAnimation&&(skipAnimation$1=e.skipAnimation),e.createStringInterpolator&&(createStringInterpolator$1=e.createStringInterpolator),e.requestAnimationFrame&&raf$2.use(e.requestAnimationFrame),e.batchedUpdates&&(raf$2.batchedUpdates=e.batchedUpdates),e.willAdvance&&(willAdvance$1=e.willAdvance),e.frameLoop&&(raf$2.frameLoop=e.frameLoop)};var globals=Object.freeze({__proto__:null,get createStringInterpolator(){return createStringInterpolator$1},get to(){return to$2},get colors(){return colors$1},get skipAnimation(){return skipAnimation$1},get willAdvance(){return willAdvance$1},assign:assign$1});const startQueue$1=new Set;let currentFrame$1=[],prevFrame$1=[],priority$1=0;const frameLoop$1={get idle(){return!startQueue$1.size&&!currentFrame$1.length},start(e){priority$1>e.priority?(startQueue$1.add(e),raf$2.onStart(flushStartQueue$1)):(startSafely$1(e),raf$2(advance$1))},advance:advance$1,sort(e){if(priority$1)raf$2.onFrame((()=>frameLoop$1.sort(e)));else{const t=currentFrame$1.indexOf(e);~t&&(currentFrame$1.splice(t,1),startUnsafely$1(e))}},clear(){currentFrame$1=[],startQueue$1.clear()}};function flushStartQueue$1(){startQueue$1.forEach(startSafely$1),startQueue$1.clear(),raf$2(advance$1)}function startSafely$1(e){currentFrame$1.includes(e)||startUnsafely$1(e)}function startUnsafely$1(e){currentFrame$1.splice(findIndex$2(currentFrame$1,(t=>t.priority>e.priority)),0,e)}function advance$1(e){const t=prevFrame$1;for(let r=0;r<currentFrame$1.length;r++){const n=currentFrame$1[r];priority$1=n.priority,n.idle||(willAdvance$1(n),n.advance(e),n.idle||t.push(n))}return priority$1=0,prevFrame$1=currentFrame$1,prevFrame$1.length=0,currentFrame$1=t,currentFrame$1.length>0}function findIndex$2(e,t){const r=e.findIndex(t);return r<0?e.length:r}const clamp$4=(e,t,r)=>Math.min(Math.max(r,e),t),colors$2={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},NUMBER$1="[-+]?\\d*\\.?\\d+",PERCENTAGE$1=NUMBER$1+"%";function call$2(...e){return"\\(\\s*("+e.join(")\\s*,\\s*(")+")\\s*\\)"}const rgb$2=new RegExp("rgb"+call$2(NUMBER$1,NUMBER$1,NUMBER$1)),rgba$2=new RegExp("rgba"+call$2(NUMBER$1,NUMBER$1,NUMBER$1,NUMBER$1)),hsl$1=new RegExp("hsl"+call$2(NUMBER$1,PERCENTAGE$1,PERCENTAGE$1)),hsla$1=new RegExp("hsla"+call$2(NUMBER$1,PERCENTAGE$1,PERCENTAGE$1,NUMBER$1)),hex3$2=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex4$1=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6$2=/^#([0-9a-fA-F]{6})$/,hex8$1=/^#([0-9a-fA-F]{8})$/;function normalizeColor$1(e){let t;return"number"==typeof e?e>>>0===e&&e>=0&&e<=4294967295?e:null:(t=hex6$2.exec(e))?parseInt(t[1]+"ff",16)>>>0:colors$1&&void 0!==colors$1[e]?colors$1[e]:(t=rgb$2.exec(e))?(parse255$1(t[1])<<24|parse255$1(t[2])<<16|parse255$1(t[3])<<8|255)>>>0:(t=rgba$2.exec(e))?(parse255$1(t[1])<<24|parse255$1(t[2])<<16|parse255$1(t[3])<<8|parse1$1(t[4]))>>>0:(t=hex3$2.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+"ff",16)>>>0:(t=hex8$1.exec(e))?parseInt(t[1],16)>>>0:(t=hex4$1.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+t[4]+t[4],16)>>>0:(t=hsl$1.exec(e))?(255|hslToRgb$1(parse360$1(t[1]),parsePercentage$1(t[2]),parsePercentage$1(t[3])))>>>0:(t=hsla$1.exec(e))?(hslToRgb$1(parse360$1(t[1]),parsePercentage$1(t[2]),parsePercentage$1(t[3]))|parse1$1(t[4]))>>>0:null}function hue2rgb$1(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function hslToRgb$1(e,t,r){const n=r<.5?r*(1+t):r+t-r*t,o=2*r-n,i=hue2rgb$1(o,n,e+1/3),a=hue2rgb$1(o,n,e),s=hue2rgb$1(o,n,e-1/3);return Math.round(255*i)<<24|Math.round(255*a)<<16|Math.round(255*s)<<8}function parse255$1(e){const t=parseInt(e,10);return t<0?0:t>255?255:t}function parse360$1(e){return(parseFloat(e)%360+360)%360/360}function parse1$1(e){const t=parseFloat(e);return t<0?0:t>1?255:Math.round(255*t)}function parsePercentage$1(e){const t=parseFloat(e);return t<0?0:t>100?1:t/100}function colorToRgba$1(e){let t=normalizeColor$1(e);if(null===t)return e;t=t||0;let r=(16711680&t)>>>16,n=(65280&t)>>>8,o=(255&t)/255;return"rgba(".concat((4278190080&t)>>>24,", ").concat(r,", ").concat(n,", ").concat(o,")")}const createInterpolator$1=(e,t,r)=>{if(is$1.fun(e))return e;if(is$1.arr(e))return createInterpolator$1({range:e,output:t,extrapolate:r});if(is$1.str(e.output[0]))return createStringInterpolator$1(e);const n=e,o=n.output,i=n.range||[0,1],a=n.extrapolateLeft||n.extrapolate||"extend",s=n.extrapolateRight||n.extrapolate||"extend",l=n.easing||(e=>e);return e=>{const t=findRange$1(e,i);return interpolate$1(e,i[t],i[t+1],o[t],o[t+1],l,a,s,n.map)}};function interpolate$1(e,t,r,n,o,i,a,s,l){let c=l?l(e):e;if(c<t){if("identity"===a)return c;"clamp"===a&&(c=t)}if(c>r){if("identity"===s)return c;"clamp"===s&&(c=r)}return n===o?n:t===r?e<=t?n:o:(t===-1/0?c=-c:r===1/0?c-=t:c=(c-t)/(r-t),c=i(c),n===-1/0?c=-c:o===1/0?c+=n:c=c*(o-n)+n,c)}function findRange$1(e,t){for(var r=1;r<t.length-1&&!(t[r]>=e);++r);return r-1}const steps$1=(e,t="end")=>r=>{const n=(r="end"===t?Math.min(r,.999):Math.max(r,.001))*e,o="end"===t?Math.floor(n):Math.ceil(n);return clamp$4(0,1,o/e)},c1$1=1.70158,c2$1=1.525*c1$1,c3$1=c1$1+1,c4$1=2*Math.PI/3,c5$1=2*Math.PI/4.5,bounceOut$1=e=>{const t=7.5625,r=2.75;return e<1/r?t*e*e:e<2/r?t*(e-=1.5/r)*e+.75:e<2.5/r?t*(e-=2.25/r)*e+.9375:t*(e-=2.625/r)*e+.984375},easings$1={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>1-(1-e)*(1-e),easeInOutQuad:e=>e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2,easeInCubic:e=>e*e*e,easeOutCubic:e=>1-Math.pow(1-e,3),easeInOutCubic:e=>e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1-Math.pow(1-e,4),easeInOutQuart:e=>e<.5?8*e*e*e*e:1-Math.pow(-2*e+2,4)/2,easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1-Math.pow(1-e,5),easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1-Math.pow(-2*e+2,5)/2,easeInSine:e=>1-Math.cos(e*Math.PI/2),easeOutSine:e=>Math.sin(e*Math.PI/2),easeInOutSine:e=>-(Math.cos(Math.PI*e)-1)/2,easeInExpo:e=>0===e?0:Math.pow(2,10*e-10),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>0===e?0:1===e?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2,easeInCirc:e=>1-Math.sqrt(1-Math.pow(e,2)),easeOutCirc:e=>Math.sqrt(1-Math.pow(e-1,2)),easeInOutCirc:e=>e<.5?(1-Math.sqrt(1-Math.pow(2*e,2)))/2:(Math.sqrt(1-Math.pow(-2*e+2,2))+1)/2,easeInBack:e=>c3$1*e*e*e-c1$1*e*e,easeOutBack:e=>1+c3$1*Math.pow(e-1,3)+c1$1*Math.pow(e-1,2),easeInOutBack:e=>e<.5?Math.pow(2*e,2)*(2*(c2$1+1)*e-c2$1)/2:(Math.pow(2*e-2,2)*((c2$1+1)*(2*e-2)+c2$1)+2)/2,easeInElastic:e=>0===e?0:1===e?1:-Math.pow(2,10*e-10)*Math.sin((10*e-10.75)*c4$1),easeOutElastic:e=>0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin((10*e-.75)*c4$1)+1,easeInOutElastic:e=>0===e?0:1===e?1:e<.5?-Math.pow(2,20*e-10)*Math.sin((20*e-11.125)*c5$1)/2:Math.pow(2,-20*e+10)*Math.sin((20*e-11.125)*c5$1)/2+1,easeInBounce:e=>1-bounceOut$1(1-e),easeOutBounce:bounceOut$1,easeInOutBounce:e=>e<.5?(1-bounceOut$1(1-2*e))/2:(1+bounceOut$1(2*e-1))/2,steps:steps$1};function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_extends$2.apply(this,arguments)}const $get$1=Symbol.for("FluidValue.get"),$observers$1=Symbol.for("FluidValue.observers"),hasFluidValue$1=e=>Boolean(e&&e[$get$1]),getFluidValue$1=e=>e&&e[$get$1]?e[$get$1]():e,getFluidObservers$1=e=>e[$observers$1]||null;function callFluidObserver$1(e,t){e.eventObserved?e.eventObserved(t):e(t)}function callFluidObservers$1(e,t){let r=e[$observers$1];r&&r.forEach((e=>{callFluidObserver$1(e,t)}))}let FluidValue$1=class{constructor(e){if(this[$get$1]=void 0,this[$observers$1]=void 0,!e&&!(e=this.get))throw Error("Unknown getter");setFluidGetter$1(this,e)}};const setFluidGetter$1=(e,t)=>setHidden$1(e,$get$1,t);function addFluidObserver$1(e,t){if(e[$get$1]){let r=e[$observers$1];r||setHidden$1(e,$observers$1,r=new Set),r.has(t)||(r.add(t),e.observerAdded&&e.observerAdded(r.size,t))}return t}function removeFluidObserver$1(e,t){let r=e[$observers$1];if(r&&r.has(t)){const n=r.size-1;n?r.delete(t):e[$observers$1]=null,e.observerRemoved&&e.observerRemoved(n,t)}}const setHidden$1=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,configurable:!0}),numberRegex$1=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,colorRegex$1=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,unitRegex$1=new RegExp("(".concat(numberRegex$1.source,")(%|[a-z]+)"),"i"),rgbaRegex$3=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,cssVariableRegex$1=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,variableToRgba$1=e=>{const[t,r]=parseCSSVariable$1(e);if(!t||isSSR$1())return e;const n=window.getComputedStyle(document.documentElement).getPropertyValue(t);if(n)return n.trim();if(r&&r.startsWith("--")){const t=window.getComputedStyle(document.documentElement).getPropertyValue(r);return t||e}return r&&cssVariableRegex$1.test(r)?variableToRgba$1(r):r||e},parseCSSVariable$1=e=>{const t=cssVariableRegex$1.exec(e);if(!t)return[,];const[,r,n]=t;return[r,n]};let namedColorRegex$1;const rgbaRound$1=(e,t,r,n,o)=>"rgba(".concat(Math.round(t),", ").concat(Math.round(r),", ").concat(Math.round(n),", ").concat(o,")"),createStringInterpolator$2=e=>{namedColorRegex$1||(namedColorRegex$1=colors$1?new RegExp("(".concat(Object.keys(colors$1).join("|"),")(?!\\w)"),"g"):/^\b$/);const t=e.output.map((e=>getFluidValue$1(e).replace(cssVariableRegex$1,variableToRgba$1).replace(colorRegex$1,colorToRgba$1).replace(namedColorRegex$1,colorToRgba$1))),r=t.map((e=>e.match(numberRegex$1).map(Number))),n=r[0].map(((e,t)=>r.map((e=>{if(!(t in e))throw Error('The arity of each "output" value must be equal');return e[t]})))).map((t=>createInterpolator$1(_extends$2({},e,{output:t}))));return e=>{var r;const o=!unitRegex$1.test(t[0])&&(null==(r=t.find((e=>unitRegex$1.test(e))))?void 0:r.replace(numberRegex$1,""));let i=0;return t[0].replace(numberRegex$1,(()=>"".concat(n[i++](e)).concat(o||""))).replace(rgbaRegex$3,rgbaRound$1)}},prefix$2="react-spring: ",once$3=e=>{const t=e;let r=!1;if("function"!=typeof t)throw new TypeError("".concat(prefix$2,"once requires a function parameter"));return(...e)=>{r||(t(...e),r=!0)}},warnInterpolate$1=once$3(console.warn);function deprecateInterpolate$1(){warnInterpolate$1("".concat(prefix$2,'The "interpolate" function is deprecated in v9 (use "to" instead)'))}const warnDirectCall$1=once$3(console.warn);function deprecateDirectCall$1(){warnDirectCall$1("".concat(prefix$2,'Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions'))}function isAnimatedString$1(e){return is$1.str(e)&&("#"==e[0]||/\d/.test(e)||!isSSR$1()&&cssVariableRegex$1.test(e)||e in(colors$1||{}))}function useConstant(e){const t=reactExports.useRef(null);return null===t.current&&(t.current=e()),t.current}const useIsomorphicLayoutEffect$1=isSSR$1()?reactExports.useEffect:reactExports.useLayoutEffect,useIsMounted$1=()=>{const e=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1((()=>(e.current=!0,()=>{e.current=!1})),[]),e};function useForceUpdate$1(){const e=reactExports.useState()[1],t=useIsMounted$1();return()=>{t.current&&e(Math.random())}}function useMemoOne$1(e,t){const[r]=reactExports.useState((()=>({inputs:t,result:e()}))),n=reactExports.useRef(),o=n.current;let i=o;if(i){Boolean(t&&i.inputs&&areInputsEqual$1(t,i.inputs))||(i={inputs:t,result:e()})}else i=r;return reactExports.useEffect((()=>{n.current=i,o==r&&(r.inputs=r.result=void 0)}),[i]),i.result}function areInputsEqual$1(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}const useOnce$1=e=>reactExports.useEffect(e,emptyDeps$1),emptyDeps$1=[];function usePrev$1(e){const t=reactExports.useRef();return reactExports.useEffect((()=>{t.current=e})),t.current}const $node$1=Symbol.for("Animated:node"),isAnimated$1=e=>!!e&&e[$node$1]===e,getAnimated$1=e=>e&&e[$node$1],setAnimated$1=(e,t)=>defineHidden$1(e,$node$1,t),getPayload$1=e=>e&&e[$node$1]&&e[$node$1].getPayload();let Animated$1=class{constructor(){this.payload=void 0,setAnimated$1(this,this)}getPayload(){return this.payload||[]}},AnimatedValue$1=class e extends Animated$1{constructor(e){super(),this.done=!0,this.elapsedTime=void 0,this.lastPosition=void 0,this.lastVelocity=void 0,this.v0=void 0,this.durationProgress=0,this._value=e,is$1.num(this._value)&&(this.lastPosition=this._value)}static create(t){return new e(t)}getPayload(){return[this]}getValue(){return this._value}setValue(e,t){return is$1.num(e)&&(this.lastPosition=e,t&&(e=Math.round(e/t)*t,this.done&&(this.lastPosition=e))),this._value!==e&&(this._value=e,!0)}reset(){const{done:e}=this;this.done=!1,is$1.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}},AnimatedString$1=class e extends AnimatedValue$1{constructor(e){super(0),this._string=null,this._toString=void 0,this._toString=createInterpolator$1({output:[e,e]})}static create(t){return new e(t)}getValue(){let e=this._string;return null==e?this._string=this._toString(this._value):e}setValue(e){if(is$1.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else{if(!super.setValue(e))return!1;this._string=null}return!0}reset(e){e&&(this._toString=createInterpolator$1({output:[this.getValue(),e]})),this._value=0,super.reset()}};const TreeContext$1={dependencies:null};let AnimatedObject$1=class extends Animated$1{constructor(e){super(),this.source=e,this.setValue(e)}getValue(e){const t={};return eachProp$1(this.source,((r,n)=>{isAnimated$1(r)?t[n]=r.getValue(e):hasFluidValue$1(r)?t[n]=getFluidValue$1(r):e||(t[n]=r)})),t}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&each$1(this.payload,(e=>e.reset()))}_makePayload(e){if(e){const t=new Set;return eachProp$1(e,this._addToPayload,t),Array.from(t)}}_addToPayload(e){TreeContext$1.dependencies&&hasFluidValue$1(e)&&TreeContext$1.dependencies.add(e);const t=getPayload$1(e);t&&each$1(t,(e=>this.add(e)))}},AnimatedArray$1=class e extends AnimatedObject$1{constructor(e){super(e)}static create(t){return new e(t)}getValue(){return this.source.map((e=>e.getValue()))}setValue(e){const t=this.getPayload();return e.length==t.length?t.map(((t,r)=>t.setValue(e[r]))).some(Boolean):(super.setValue(e.map(makeAnimated$1)),!0)}};function makeAnimated$1(e){return(isAnimatedString$1(e)?AnimatedString$1:AnimatedValue$1).create(e)}function getAnimatedType$1(e){const t=getAnimated$1(e);return t?t.constructor:is$1.arr(e)?AnimatedArray$1:isAnimatedString$1(e)?AnimatedString$1:AnimatedValue$1}function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_extends$1.apply(this,arguments)}const withAnimated$1=(e,t)=>{const r=!is$1.fun(e)||e.prototype&&e.prototype.isReactComponent;return reactExports.forwardRef(((n,o)=>{const i=reactExports.useRef(null),a=r&&reactExports.useCallback((e=>{i.current=updateRef$1(o,e)}),[o]),[s,l]=getAnimatedState$1(n,t),c=useForceUpdate$1(),u=()=>{const e=i.current;if(r&&!e)return;!1===(!!e&&t.applyAnimatedValues(e,s.getValue(!0)))&&c()},d=new PropsObserver$1(u,l),h=reactExports.useRef();useIsomorphicLayoutEffect$1((()=>(h.current=d,each$1(l,(e=>addFluidObserver$1(e,d))),()=>{h.current&&(each$1(h.current.deps,(e=>removeFluidObserver$1(e,h.current))),raf$2.cancel(h.current.update))}))),reactExports.useEffect(u,[]),useOnce$1((()=>()=>{const e=h.current;each$1(e.deps,(t=>removeFluidObserver$1(t,e)))}));const p=t.getComponentProps(s.getValue());return reactExports.createElement(e,_extends$1({},p,{ref:a}))}))};let PropsObserver$1=class{constructor(e,t){this.update=e,this.deps=t}eventObserved(e){"change"==e.type&&raf$2.write(this.update)}};function getAnimatedState$1(e,t){const r=new Set;return TreeContext$1.dependencies=r,e.style&&(e=_extends$1({},e,{style:t.createAnimatedStyle(e.style)})),e=new AnimatedObject$1(e),TreeContext$1.dependencies=null,[e,r]}function updateRef$1(e,t){return e&&(is$1.fun(e)?e(t):e.current=t),t}const cacheKey$1=Symbol.for("AnimatedComponent"),createHost$1=(e,{applyAnimatedValues:t=()=>!1,createAnimatedStyle:r=e=>new AnimatedObject$1(e),getComponentProps:n=e=>e}={})=>{const o={applyAnimatedValues:t,createAnimatedStyle:r,getComponentProps:n},i=e=>{const t=getDisplayName$1(e)||"Anonymous";return(e=is$1.str(e)?i[e]||(i[e]=withAnimated$1(e,o)):e[cacheKey$1]||(e[cacheKey$1]=withAnimated$1(e,o))).displayName="Animated(".concat(t,")"),e};return eachProp$1(e,((t,r)=>{is$1.arr(e)&&(r=getDisplayName$1(t)),i[r]=i(t)})),{animated:i}},getDisplayName$1=e=>is$1.str(e)?e:e&&is$1.str(e.displayName)?e.displayName:is$1.fun(e)&&e.name||null;function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_extends.apply(this,arguments)}function callProp$1(e,...t){return is$1.fun(e)?e(...t):e}const matchProp$1=(e,t)=>!0===e||!!(t&&e&&(is$1.fun(e)?e(t):toArray$2(e).includes(t))),resolveProp$1=(e,t)=>is$1.obj(e)?t&&e[t]:e,getDefaultProp$1=(e,t)=>!0===e.default?e[t]:e.default?e.default[t]:void 0,noopTransform$1=e=>e,getDefaultProps$1=(e,t=noopTransform$1)=>{let r=DEFAULT_PROPS$1;e.default&&!0!==e.default&&(e=e.default,r=Object.keys(e));const n={};for(const o of r){const r=t(e[o],o);is$1.und(r)||(n[o]=r)}return n},DEFAULT_PROPS$1=["config","onProps","onStart","onChange","onPause","onResume","onRest"],RESERVED_PROPS$1={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function getForwardProps$1(e){const t={};let r=0;if(eachProp$1(e,((e,n)=>{RESERVED_PROPS$1[n]||(t[n]=e,r++)})),r)return t}function inferTo$1(e){const t=getForwardProps$1(e);if(t){const r={to:t};return eachProp$1(e,((e,n)=>n in t||(r[n]=e))),r}return _extends({},e)}function computeGoal$1(e){return e=getFluidValue$1(e),is$1.arr(e)?e.map(computeGoal$1):isAnimatedString$1(e)?globals.createStringInterpolator({range:[0,1],output:[e,e]})(1):e}function hasProps$1(e){for(const t in e)return!0;return!1}function isAsyncTo$1(e){return is$1.fun(e)||is$1.arr(e)&&is$1.obj(e[0])}function detachRefs$1(e,t){var r;null==(r=e.ref)||r.delete(e),null==t||t.delete(e)}function replaceRef$2(e,t){var r;t&&e.ref!==t&&(null==(r=e.ref)||r.delete(e),t.add(e),e.ref=t)}const config$2={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},defaults$6=_extends({},config$2.default,{mass:1,damping:1,easing:easings$1.linear,clamp:!1});let AnimationConfig$2=class{constructor(){this.tension=void 0,this.friction=void 0,this.frequency=void 0,this.damping=void 0,this.mass=void 0,this.velocity=0,this.restVelocity=void 0,this.precision=void 0,this.progress=void 0,this.duration=void 0,this.easing=void 0,this.clamp=void 0,this.bounce=void 0,this.decay=void 0,this.round=void 0,Object.assign(this,defaults$6)}};function mergeConfig$1(e,t,r){r&&(sanitizeConfig$1(r=_extends({},r),t),t=_extends({},r,t)),sanitizeConfig$1(e,t),Object.assign(e,t);for(const a in defaults$6)null==e[a]&&(e[a]=defaults$6[a]);let{mass:n,frequency:o,damping:i}=e;return is$1.und(o)||(o<.01&&(o=.01),i<0&&(i=0),e.tension=Math.pow(2*Math.PI/o,2)*n,e.friction=4*Math.PI*i*n/o),e}function sanitizeConfig$1(e,t){if(is$1.und(t.decay)){const r=!is$1.und(t.tension)||!is$1.und(t.friction);!r&&is$1.und(t.frequency)&&is$1.und(t.damping)&&is$1.und(t.mass)||(e.duration=void 0,e.decay=void 0),r&&(e.frequency=void 0)}else e.duration=void 0}const emptyArray$1=[];let Animation$1=class{constructor(){this.changed=!1,this.values=emptyArray$1,this.toValues=null,this.fromValues=emptyArray$1,this.to=void 0,this.from=void 0,this.config=new AnimationConfig$2,this.immediate=!1}};function scheduleProps$1(e,{key:t,props:r,defaultProps:n,state:o,actions:i}){return new Promise(((a,s)=>{var l;let c,u,d=matchProp$1(null!=(l=r.cancel)?l:null==n?void 0:n.cancel,t);if(d)f();else{is$1.und(r.pause)||(o.paused=matchProp$1(r.pause,t));let e=null==n?void 0:n.pause;!0!==e&&(e=o.paused||matchProp$1(e,t)),c=callProp$1(r.delay||0,t),e?(o.resumeQueue.add(p),i.pause()):(i.resume(),p())}function h(){o.resumeQueue.add(p),o.timeouts.delete(u),u.cancel(),c=u.time-raf$2.now()}function p(){c>0&&!globals.skipAnimation?(o.delayed=!0,u=raf$2.setTimeout(f,c),o.pauseQueue.add(h),o.timeouts.add(u)):f()}function f(){o.delayed&&(o.delayed=!1),o.pauseQueue.delete(h),o.timeouts.delete(u),e<=(o.cancelId||0)&&(d=!0);try{i.start(_extends({},r,{callId:e,cancel:d}),a)}catch(t){s(t)}}}))}const getCombinedResult$1=(e,t)=>1==t.length?t[0]:t.some((e=>e.cancelled))?getCancelledResult$1(e.get()):t.every((e=>e.noop))?getNoopResult$1(e.get()):getFinishedResult$1(e.get(),t.every((e=>e.finished))),getNoopResult$1=e=>({value:e,noop:!0,finished:!0,cancelled:!1}),getFinishedResult$1=(e,t,r=!1)=>({value:e,finished:t,cancelled:r}),getCancelledResult$1=e=>({value:e,cancelled:!0,finished:!1});function runAsync$1(e,t,r,n){const{callId:o,parentId:i,onRest:a}=t,{asyncTo:s,promise:l}=r;return i||e!==s||t.reset?r.promise=(async()=>{r.asyncId=o,r.asyncTo=e;const c=getDefaultProps$1(t,((e,t)=>"onRest"===t?void 0:e));let u,d;const h=new Promise(((e,t)=>(u=e,d=t))),p=e=>{const t=o<=(r.cancelId||0)&&getCancelledResult$1(n)||o!==r.asyncId&&getFinishedResult$1(n,!1);if(t)throw e.result=t,d(e),e},f=(e,t)=>{const i=new BailSignal$1,a=new SkipAnimationSignal$1;return(async()=>{if(globals.skipAnimation)throw stopAsync$1(r),a.result=getFinishedResult$1(n,!1),d(a),a;p(i);const s=is$1.obj(e)?_extends({},e):_extends({},t,{to:e});s.parentId=o,eachProp$1(c,((e,t)=>{is$1.und(s[t])&&(s[t]=e)}));const l=await n.start(s);return p(i),r.paused&&await new Promise((e=>{r.resumeQueue.add(e)})),l})()};let g;if(globals.skipAnimation)return stopAsync$1(r),getFinishedResult$1(n,!1);try{let t;t=is$1.arr(e)?(async e=>{for(const t of e)await f(t)})(e):Promise.resolve(e(f,n.stop.bind(n))),await Promise.all([t.then(u),h]),g=getFinishedResult$1(n.get(),!0,!1)}catch(m){if(m instanceof BailSignal$1)g=m.result;else{if(!(m instanceof SkipAnimationSignal$1))throw m;g=m.result}}finally{o==r.asyncId&&(r.asyncId=i,r.asyncTo=i?s:void 0,r.promise=i?l:void 0)}return is$1.fun(a)&&raf$2.batchedUpdates((()=>{a(g,n,n.item)})),g})():l}function stopAsync$1(e,t){flush$1(e.timeouts,(e=>e.cancel())),e.pauseQueue.clear(),e.resumeQueue.clear(),e.asyncId=e.asyncTo=e.promise=void 0,t&&(e.cancelId=t)}let BailSignal$1=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise."),this.result=void 0}},SkipAnimationSignal$1=class extends Error{constructor(){super("SkipAnimationSignal"),this.result=void 0}};const isFrameValue$1=e=>e instanceof FrameValue$1;let nextId$1=1,FrameValue$1=class extends FluidValue$1{constructor(...e){super(...e),this.id=nextId$1++,this.key=void 0,this._priority=0}get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){const e=getAnimated$1(this);return e&&e.getValue()}to(...e){return globals.to(this,e)}interpolate(...e){return deprecateInterpolate$1(),globals.to(this,e)}toJSON(){return this.get()}observerAdded(e){1==e&&this._attach()}observerRemoved(e){0==e&&this._detach()}_attach(){}_detach(){}_onChange(e,t=!1){callFluidObservers$1(this,{type:"change",parent:this,value:e,idle:t})}_onPriorityChange(e){this.idle||frameLoop$1.sort(this),callFluidObservers$1(this,{type:"priority",parent:this,priority:e})}};const $P$1=Symbol.for("SpringPhase"),HAS_ANIMATED$1=1,IS_ANIMATING$1=2,IS_PAUSED$1=4,hasAnimated$1=e=>(e[$P$1]&HAS_ANIMATED$1)>0,isAnimating$1=e=>(e[$P$1]&IS_ANIMATING$1)>0,isPaused$1=e=>(e[$P$1]&IS_PAUSED$1)>0,setActiveBit$1=(e,t)=>t?e[$P$1]|=IS_ANIMATING$1|HAS_ANIMATED$1:e[$P$1]&=~IS_ANIMATING$1,setPausedBit$1=(e,t)=>t?e[$P$1]|=IS_PAUSED$1:e[$P$1]&=~IS_PAUSED$1;let SpringValue$1=class extends FrameValue$1{constructor(e,t){if(super(),this.key=void 0,this.animation=new Animation$1,this.queue=void 0,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!is$1.und(e)||!is$1.und(t)){const r=is$1.obj(e)?_extends({},e):_extends({},t,{from:e});is$1.und(r.default)&&(r.default=!0),this.start(r)}}get idle(){return!(isAnimating$1(this)||this._state.asyncTo)||isPaused$1(this)}get goal(){return getFluidValue$1(this.animation.to)}get velocity(){const e=getAnimated$1(this);return e instanceof AnimatedValue$1?e.lastVelocity||0:e.getPayload().map((e=>e.lastVelocity||0))}get hasAnimated(){return hasAnimated$1(this)}get isAnimating(){return isAnimating$1(this)}get isPaused(){return isPaused$1(this)}get isDelayed(){return this._state.delayed}advance(e){let t=!0,r=!1;const n=this.animation;let{config:o,toValues:i}=n;const a=getPayload$1(n.to);!a&&hasFluidValue$1(n.to)&&(i=toArray$2(getFluidValue$1(n.to))),n.values.forEach(((s,l)=>{if(s.done)return;const c=s.constructor==AnimatedString$1?1:a?a[l].lastPosition:i[l];let u=n.immediate,d=c;if(!u){if(d=s.lastPosition,o.tension<=0)return void(s.done=!0);let t=s.elapsedTime+=e;const r=n.fromValues[l],i=null!=s.v0?s.v0:s.v0=is$1.arr(o.velocity)?o.velocity[l]:o.velocity;let a;const h=o.precision||(r==c?.005:Math.min(1,.001*Math.abs(c-r)));if(is$1.und(o.duration))if(o.decay){const e=!0===o.decay?.998:o.decay,n=Math.exp(-(1-e)*t);d=r+i/(1-e)*(1-n),u=Math.abs(s.lastPosition-d)<=h,a=i*n}else{a=null==s.lastVelocity?i:s.lastVelocity;const t=o.restVelocity||h/10,n=o.clamp?0:o.bounce,l=!is$1.und(n),p=r==c?s.v0>0:r<c;let f,g=!1;const m=1,y=Math.ceil(e/m);for(let e=0;e<y&&(f=Math.abs(a)>t,f||(u=Math.abs(c-d)<=h,!u));++e){l&&(g=d==c||d>c==p,g&&(a=-a*n,d=c));a+=(1e-6*-o.tension*(d-c)+.001*-o.friction*a)/o.mass*m,d+=a*m}}else{let n=1;o.duration>0&&(this._memoizedDuration!==o.duration&&(this._memoizedDuration=o.duration,s.durationProgress>0&&(s.elapsedTime=o.duration*s.durationProgress,t=s.elapsedTime+=e)),n=(o.progress||0)+t/this._memoizedDuration,n=n>1?1:n<0?0:n,s.durationProgress=n),d=r+o.easing(n)*(c-r),a=(d-s.lastPosition)/e,u=1==n}s.lastVelocity=a,Number.isNaN(d)&&(u=!0)}a&&!a[l].done&&(u=!1),u?s.done=!0:t=!1,s.setValue(d,o.round)&&(r=!0)}));const s=getAnimated$1(this),l=s.getValue();if(t){const e=getFluidValue$1(n.to);l===e&&!r||o.decay?r&&o.decay&&this._onChange(l):(s.setValue(e),this._onChange(e)),this._stop()}else r&&this._onChange(l)}set(e){return raf$2.batchedUpdates((()=>{this._stop(),this._focus(e),this._set(e)})),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(isAnimating$1(this)){const{to:e,config:t}=this.animation;raf$2.batchedUpdates((()=>{this._onStart(),t.decay||this._set(e,!1),this._stop()}))}return this}update(e){return(this.queue||(this.queue=[])).push(e),this}start(e,t){let r;return is$1.und(e)?(r=this.queue||[],this.queue=[]):r=[is$1.obj(e)?e:_extends({},t,{to:e})],Promise.all(r.map((e=>this._update(e)))).then((e=>getCombinedResult$1(this,e)))}stop(e){const{to:t}=this.animation;return this._focus(this.get()),stopAsync$1(this._state,e&&this._lastCallId),raf$2.batchedUpdates((()=>this._stop(t,e))),this}reset(){this._update({reset:!0})}eventObserved(e){"change"==e.type?this._start():"priority"==e.type&&(this.priority=e.priority+1)}_prepareNode(e){const t=this.key||"";let{to:r,from:n}=e;r=is$1.obj(r)?r[t]:r,(null==r||isAsyncTo$1(r))&&(r=void 0),n=is$1.obj(n)?n[t]:n,null==n&&(n=void 0);const o={to:r,from:n};return hasAnimated$1(this)||(e.reverse&&([r,n]=[n,r]),n=getFluidValue$1(n),is$1.und(n)?getAnimated$1(this)||this._set(r):this._set(n)),o}_update(e,t){let r=_extends({},e);const{key:n,defaultProps:o}=this;r.default&&Object.assign(o,getDefaultProps$1(r,((e,t)=>/^on/.test(t)?resolveProp$1(e,n):e))),mergeActiveFn$1(this,r,"onProps"),sendEvent$1(this,"onProps",r,this);const i=this._prepareNode(r);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const a=this._state;return scheduleProps$1(++this._lastCallId,{key:n,props:r,defaultProps:o,state:a,actions:{pause:()=>{isPaused$1(this)||(setPausedBit$1(this,!0),flushCalls$1(a.pauseQueue),sendEvent$1(this,"onPause",getFinishedResult$1(this,checkFinished$1(this,this.animation.to)),this))},resume:()=>{isPaused$1(this)&&(setPausedBit$1(this,!1),isAnimating$1(this)&&this._resume(),flushCalls$1(a.resumeQueue),sendEvent$1(this,"onResume",getFinishedResult$1(this,checkFinished$1(this,this.animation.to)),this))},start:this._merge.bind(this,i)}}).then((e=>{if(r.loop&&e.finished&&(!t||!e.noop)){const e=createLoopUpdate$1(r);if(e)return this._update(e,!0)}return e}))}_merge(e,t,r){if(t.cancel)return this.stop(!0),r(getCancelledResult$1(this));const n=!is$1.und(e.to),o=!is$1.und(e.from);if(n||o){if(!(t.callId>this._lastToId))return r(getCancelledResult$1(this));this._lastToId=t.callId}const{key:i,defaultProps:a,animation:s}=this,{to:l,from:c}=s;let{to:u=l,from:d=c}=e;!o||n||t.default&&!is$1.und(u)||(u=d),t.reverse&&([u,d]=[d,u]);const h=!isEqual$2(d,c);h&&(s.from=d),d=getFluidValue$1(d);const p=!isEqual$2(u,l);p&&this._focus(u);const f=isAsyncTo$1(t.to),{config:g}=s,{decay:m,velocity:y}=g;(n||o)&&(g.velocity=0),t.config&&!f&&mergeConfig$1(g,callProp$1(t.config,i),t.config!==a.config?callProp$1(a.config,i):void 0);let v=getAnimated$1(this);if(!v||is$1.und(u))return r(getFinishedResult$1(this,!0));const _=is$1.und(t.reset)?o&&!t.default:!is$1.und(d)&&matchProp$1(t.reset,i),b=_?d:this.get(),C=computeGoal$1(u),E=is$1.num(C)||is$1.arr(C)||isAnimatedString$1(C),T=!f&&(!E||matchProp$1(a.immediate||t.immediate,i));if(p){const e=getAnimatedType$1(u);if(e!==v.constructor){if(!T)throw Error("Cannot animate between ".concat(v.constructor.name," and ").concat(e.name,', as the "to" prop suggests'));v=this._set(C)}}const S=v.constructor;let P=hasFluidValue$1(u),w=!1;if(!P){const e=_||!hasAnimated$1(this)&&h;(p||e)&&(w=isEqual$2(computeGoal$1(b),C),P=!w),(isEqual$2(s.immediate,T)||T)&&isEqual$2(g.decay,m)&&isEqual$2(g.velocity,y)||(P=!0)}if(w&&isAnimating$1(this)&&(s.changed&&!_?P=!0:P||this._stop(l)),!f&&((P||hasFluidValue$1(l))&&(s.values=v.getPayload(),s.toValues=hasFluidValue$1(u)?null:S==AnimatedString$1?[1]:toArray$2(C)),s.immediate!=T&&(s.immediate=T,T||_||this._set(l)),P)){const{onRest:e}=s;each$1(ACTIVE_EVENTS$1,(e=>mergeActiveFn$1(this,t,e)));const n=getFinishedResult$1(this,checkFinished$1(this,l));flushCalls$1(this._pendingCalls,n),this._pendingCalls.add(r),s.changed&&raf$2.batchedUpdates((()=>{s.changed=!_,null==e||e(n,this),_?callProp$1(a.onRest,n):null==s.onStart||s.onStart(n,this)}))}_&&this._set(b),f?r(runAsync$1(t.to,t,this._state,this)):P?this._start():isAnimating$1(this)&&!p?this._pendingCalls.add(r):r(getNoopResult$1(b))}_focus(e){const t=this.animation;e!==t.to&&(getFluidObservers$1(this)&&this._detach(),t.to=e,getFluidObservers$1(this)&&this._attach())}_attach(){let e=0;const{to:t}=this.animation;hasFluidValue$1(t)&&(addFluidObserver$1(t,this),isFrameValue$1(t)&&(e=t.priority+1)),this.priority=e}_detach(){const{to:e}=this.animation;hasFluidValue$1(e)&&removeFluidObserver$1(e,this)}_set(e,t=!0){const r=getFluidValue$1(e);if(!is$1.und(r)){const e=getAnimated$1(this);if(!e||!isEqual$2(r,e.getValue())){const n=getAnimatedType$1(r);e&&e.constructor==n?e.setValue(r):setAnimated$1(this,n.create(r)),e&&raf$2.batchedUpdates((()=>{this._onChange(r,t)}))}}return getAnimated$1(this)}_onStart(){const e=this.animation;e.changed||(e.changed=!0,sendEvent$1(this,"onStart",getFinishedResult$1(this,checkFinished$1(this,e.to)),this))}_onChange(e,t){t||(this._onStart(),callProp$1(this.animation.onChange,e,this)),callProp$1(this.defaultProps.onChange,e,this),super._onChange(e,t)}_start(){const e=this.animation;getAnimated$1(this).reset(getFluidValue$1(e.to)),e.immediate||(e.fromValues=e.values.map((e=>e.lastPosition))),isAnimating$1(this)||(setActiveBit$1(this,!0),isPaused$1(this)||this._resume())}_resume(){globals.skipAnimation?this.finish():frameLoop$1.start(this)}_stop(e,t){if(isAnimating$1(this)){setActiveBit$1(this,!1);const r=this.animation;each$1(r.values,(e=>{e.done=!0})),r.toValues&&(r.onChange=r.onPause=r.onResume=void 0),callFluidObservers$1(this,{type:"idle",parent:this});const n=t?getCancelledResult$1(this.get()):getFinishedResult$1(this.get(),checkFinished$1(this,null!=e?e:r.to));flushCalls$1(this._pendingCalls,n),r.changed&&(r.changed=!1,sendEvent$1(this,"onRest",n,this))}}};function checkFinished$1(e,t){const r=computeGoal$1(t);return isEqual$2(computeGoal$1(e.get()),r)}function createLoopUpdate$1(e,t=e.loop,r=e.to){let n=callProp$1(t);if(n){const o=!0!==n&&inferTo$1(n),i=(o||e).reverse,a=!o||o.reset;return createUpdate$1(_extends({},e,{loop:t,default:!1,pause:void 0,to:!i||isAsyncTo$1(r)?r:void 0,from:a?e.from:void 0,reset:a},o))}}function createUpdate$1(e){const{to:t,from:r}=e=inferTo$1(e),n=new Set;return is$1.obj(t)&&findDefined$1(t,n),is$1.obj(r)&&findDefined$1(r,n),e.keys=n.size?Array.from(n):null,e}function declareUpdate$1(e){const t=createUpdate$1(e);return is$1.und(t.default)&&(t.default=getDefaultProps$1(t)),t}function findDefined$1(e,t){eachProp$1(e,((e,r)=>null!=e&&t.add(r)))}const ACTIVE_EVENTS$1=["onStart","onRest","onChange","onPause","onResume"];function mergeActiveFn$1(e,t,r){e.animation[r]=t[r]!==getDefaultProp$1(t,r)?resolveProp$1(t[r],e.key):void 0}function sendEvent$1(e,t,...r){var n,o,i,a;null==(n=(o=e.animation)[t])||n.call(o,...r),null==(i=(a=e.defaultProps)[t])||i.call(a,...r)}const BATCHED_EVENTS$1=["onStart","onChange","onRest"];let nextId$2=1,Controller$2=class{constructor(e,t){this.id=nextId$2++,this.springs={},this.queue=[],this.ref=void 0,this._flush=void 0,this._initialProps=void 0,this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._item=void 0,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),t&&(this._flush=t),e&&this.start(_extends({default:!0},e))}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every((e=>e.idle&&!e.isDelayed&&!e.isPaused))}get item(){return this._item}set item(e){this._item=e}get(){const e={};return this.each(((t,r)=>e[r]=t.get())),e}set(e){for(const t in e){const r=e[t];is$1.und(r)||this.springs[t].set(r)}}update(e){return e&&this.queue.push(createUpdate$1(e)),this}start(e){let{queue:t}=this;return e?t=toArray$2(e).map(createUpdate$1):this.queue=[],this._flush?this._flush(this,t):(prepareKeys$1(this,t),flushUpdateQueue$1(this,t))}stop(e,t){if(e!==!!e&&(t=e),t){const r=this.springs;each$1(toArray$2(t),(t=>r[t].stop(!!e)))}else stopAsync$1(this._state,this._lastAsyncId),this.each((t=>t.stop(!!e)));return this}pause(e){if(is$1.und(e))this.start({pause:!0});else{const t=this.springs;each$1(toArray$2(e),(e=>t[e].pause()))}return this}resume(e){if(is$1.und(e))this.start({pause:!1});else{const t=this.springs;each$1(toArray$2(e),(e=>t[e].resume()))}return this}each(e){eachProp$1(this.springs,e)}_onFrame(){const{onStart:e,onChange:t,onRest:r}=this._events,n=this._active.size>0,o=this._changed.size>0;(n&&!this._started||o&&!this._started)&&(this._started=!0,flush$1(e,(([e,t])=>{t.value=this.get(),e(t,this,this._item)})));const i=!n&&this._started,a=o||i&&r.size?this.get():null;o&&t.size&&flush$1(t,(([e,t])=>{t.value=a,e(t,this,this._item)})),i&&(this._started=!1,flush$1(r,(([e,t])=>{t.value=a,e(t,this,this._item)})))}eventObserved(e){if("change"==e.type)this._changed.add(e.parent),e.idle||this._active.add(e.parent);else{if("idle"!=e.type)return;this._active.delete(e.parent)}raf$2.onFrame(this._onFrame)}};function flushUpdateQueue$1(e,t){return Promise.all(t.map((t=>flushUpdate$1(e,t)))).then((t=>getCombinedResult$1(e,t)))}async function flushUpdate$1(e,t,r){const{keys:n,to:o,from:i,loop:a,onRest:s,onResolve:l}=t,c=is$1.obj(t.default)&&t.default;a&&(t.loop=!1),!1===o&&(t.to=null),!1===i&&(t.from=null);const u=is$1.arr(o)||is$1.fun(o)?o:void 0;u?(t.to=void 0,t.onRest=void 0,c&&(c.onRest=void 0)):each$1(BATCHED_EVENTS$1,(r=>{const n=t[r];if(is$1.fun(n)){const o=e._events[r];t[r]=({finished:e,cancelled:t})=>{const r=o.get(n);r?(e||(r.finished=!1),t&&(r.cancelled=!0)):o.set(n,{value:null,finished:e||!1,cancelled:t||!1})},c&&(c[r]=t[r])}}));const d=e._state;t.pause===!d.paused?(d.paused=t.pause,flushCalls$1(t.pause?d.pauseQueue:d.resumeQueue)):d.paused&&(t.pause=!0);const h=(n||Object.keys(e.springs)).map((r=>e.springs[r].start(t))),p=!0===t.cancel||!0===getDefaultProp$1(t,"cancel");(u||p&&d.asyncId)&&h.push(scheduleProps$1(++e._lastAsyncId,{props:t,state:d,actions:{pause:noop$4,resume:noop$4,start(t,r){p?(stopAsync$1(d,e._lastAsyncId),r(getCancelledResult$1(e))):(t.onRest=s,r(runAsync$1(u,t,d,e)))}}})),d.paused&&await new Promise((e=>{d.resumeQueue.add(e)}));const f=getCombinedResult$1(e,await Promise.all(h));if(a&&f.finished&&(!r||!f.noop)){const r=createLoopUpdate$1(t,a,o);if(r)return prepareKeys$1(e,[r]),flushUpdate$1(e,r,!0)}return l&&raf$2.batchedUpdates((()=>l(f,e,e.item))),f}function getSprings$1(e,t){const r=_extends({},e.springs);return t&&each$1(toArray$2(t),(e=>{is$1.und(e.keys)&&(e=createUpdate$1(e)),is$1.obj(e.to)||(e=_extends({},e,{to:void 0})),prepareSprings$1(r,e,(e=>createSpring$1(e)))})),setSprings$1(e,r),r}function setSprings$1(e,t){eachProp$1(t,((t,r)=>{e.springs[r]||(e.springs[r]=t,addFluidObserver$1(t,e))}))}function createSpring$1(e,t){const r=new SpringValue$1;return r.key=e,t&&addFluidObserver$1(r,t),r}function prepareSprings$1(e,t,r){t.keys&&each$1(t.keys,(n=>{(e[n]||(e[n]=r(n)))._prepareNode(t)}))}function prepareKeys$1(e,t){each$1(t,(t=>{prepareSprings$1(e.springs,t,(t=>createSpring$1(t,e)))}))}function _objectWithoutPropertiesLoose$2(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}const _excluded$6=["children"],SpringContext$1=e=>{let{children:t}=e,r=_objectWithoutPropertiesLoose$2(e,_excluded$6);const n=reactExports.useContext(ctx$1),o=r.pause||!!n.pause,i=r.immediate||!!n.immediate;r=useMemoOne$1((()=>({pause:o,immediate:i})),[o,i]);const{Provider:a}=ctx$1;return reactExports.createElement(a,{value:r},t)},ctx$1=makeContext$1(SpringContext$1,{});function makeContext$1(e,t){return Object.assign(e,reactExports.createContext(t)),e.Provider._context=e,e.Consumer._context=e,e}SpringContext$1.Provider=ctx$1.Provider,SpringContext$1.Consumer=ctx$1.Consumer;const SpringRef$1=()=>{const e=[],t=function(t){deprecateDirectCall$1();const n=[];return each$1(e,((e,o)=>{if(is$1.und(t))n.push(e.start());else{const i=r(t,e,o);i&&n.push(e.start(i))}})),n};t.current=e,t.add=function(t){e.includes(t)||e.push(t)},t.delete=function(t){const r=e.indexOf(t);~r&&e.splice(r,1)},t.pause=function(){return each$1(e,(e=>e.pause(...arguments))),this},t.resume=function(){return each$1(e,(e=>e.resume(...arguments))),this},t.set=function(t){each$1(e,(e=>e.set(t)))},t.start=function(t){const r=[];return each$1(e,((e,n)=>{if(is$1.und(t))r.push(e.start());else{const o=this._getProps(t,e,n);o&&r.push(e.start(o))}})),r},t.stop=function(){return each$1(e,(e=>e.stop(...arguments))),this},t.update=function(t){return each$1(e,((e,r)=>e.update(this._getProps(t,e,r)))),this};const r=function(e,t,r){return is$1.fun(e)?e(r,t):e};return t._getProps=r,t};function useSprings$1(e,t,r){const n=is$1.fun(t)&&t;n&&!r&&(r=[]);const o=reactExports.useMemo((()=>n||3==arguments.length?SpringRef$1():void 0),[]),i=reactExports.useRef(0),a=useForceUpdate$1(),s=reactExports.useMemo((()=>({ctrls:[],queue:[],flush(e,t){const r=getSprings$1(e,t);return i.current>0&&!s.queue.length&&!Object.keys(r).some((t=>!e.springs[t]))?flushUpdateQueue$1(e,t):new Promise((n=>{setSprings$1(e,r),s.queue.push((()=>{n(flushUpdateQueue$1(e,t))})),a()}))}})),[]),l=reactExports.useRef([...s.ctrls]),c=[],u=usePrev$1(e)||0;function d(e,r){for(let o=e;o<r;o++){const e=l.current[o]||(l.current[o]=new Controller$2(null,s.flush)),r=n?n(o,e):t[o];r&&(c[o]=declareUpdate$1(r))}}reactExports.useMemo((()=>{each$1(l.current.slice(e,u),(e=>{detachRefs$1(e,o),e.stop(!0)})),l.current.length=e,d(u,e)}),[e]),reactExports.useMemo((()=>{d(0,Math.min(u,e))}),r);const h=l.current.map(((e,t)=>getSprings$1(e,c[t]))),p=reactExports.useContext(SpringContext$1),f=usePrev$1(p),g=p!==f&&hasProps$1(p);useIsomorphicLayoutEffect$1((()=>{i.current++,s.ctrls=l.current;const{queue:e}=s;e.length&&(s.queue=[],each$1(e,(e=>e()))),each$1(l.current,((e,t)=>{null==o||o.add(e),g&&e.start({default:p});const r=c[t];r&&(replaceRef$2(e,r.ref),e.ref?e.queue.push(r):e.start(r))}))})),useOnce$1((()=>()=>{each$1(s.ctrls,(e=>e.stop(!0)))}));const m=h.map((e=>_extends({},e)));return o?[m,o]:m}function useSpring$1(e,t){const r=is$1.fun(e),[[n],o]=useSprings$1(1,r?e:[e],r?t||[]:t);return r||2==arguments.length?[n,o]:n}const useSpringValue=(e,t)=>{const r=useConstant((()=>new SpringValue$1(e,t)));return useOnce$1((()=>()=>{r.stop()})),r};let TransitionPhase;var TransitionPhase2;TransitionPhase2=TransitionPhase||(TransitionPhase={}),TransitionPhase2.MOUNT="mount",TransitionPhase2.ENTER="enter",TransitionPhase2.UPDATE="update",TransitionPhase2.LEAVE="leave";let Interpolation$1=class extends FrameValue$1{constructor(e,t){super(),this.key=void 0,this.idle=!0,this.calc=void 0,this._active=new Set,this.source=e,this.calc=createInterpolator$1(...t);const r=this._get(),n=getAnimatedType$1(r);setAnimated$1(this,n.create(r))}advance(e){const t=this._get();isEqual$2(t,this.get())||(getAnimated$1(this).setValue(t),this._onChange(t,this.idle)),!this.idle&&checkIdle$1(this._active)&&becomeIdle$1(this)}_get(){const e=is$1.arr(this.source)?this.source.map(getFluidValue$1):toArray$2(getFluidValue$1(this.source));return this.calc(...e)}_start(){this.idle&&!checkIdle$1(this._active)&&(this.idle=!1,each$1(getPayload$1(this),(e=>{e.done=!1})),globals.skipAnimation?(raf$2.batchedUpdates((()=>this.advance())),becomeIdle$1(this)):frameLoop$1.start(this))}_attach(){let e=1;each$1(toArray$2(this.source),(t=>{hasFluidValue$1(t)&&addFluidObserver$1(t,this),isFrameValue$1(t)&&(t.idle||this._active.add(t),e=Math.max(e,t.priority+1))})),this.priority=e,this._start()}_detach(){each$1(toArray$2(this.source),(e=>{hasFluidValue$1(e)&&removeFluidObserver$1(e,this)})),this._active.clear(),becomeIdle$1(this)}eventObserved(e){"change"==e.type?e.idle?this.advance():(this._active.add(e.parent),this._start()):"idle"==e.type?this._active.delete(e.parent):"priority"==e.type&&(this.priority=toArray$2(this.source).reduce(((e,t)=>Math.max(e,(isFrameValue$1(t)?t.priority:0)+1)),0))}};function isIdle$1(e){return!1!==e.idle}function checkIdle$1(e){return!e.size||Array.from(e).every(isIdle$1)}function becomeIdle$1(e){e.idle||(e.idle=!0,each$1(getPayload$1(e),(e=>{e.done=!0})),callFluidObservers$1(e,{type:"idle",parent:e}))}function _objectWithoutPropertiesLoose$1(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}globals.assign({createStringInterpolator:createStringInterpolator$2,to:(e,t)=>new Interpolation$1(e,t)});const _excluded$2=["style","children","scrollTop","scrollLeft","viewBox"],isCustomPropRE$1=/^--/;function dangerousStyleValue$1(e,t){return null==t||"boolean"==typeof t||""===t?"":"number"!=typeof t||0===t||isCustomPropRE$1.test(e)||isUnitlessNumber$1.hasOwnProperty(e)&&isUnitlessNumber$1[e]?(""+t).trim():t+"px"}const attributeCache$1={};function applyAnimatedValues$1(e,t){if(!e.nodeType||!e.setAttribute)return!1;const r="filter"===e.nodeName||e.parentNode&&"filter"===e.parentNode.nodeName,n=t,{style:o,children:i,scrollTop:a,scrollLeft:s,viewBox:l}=n,c=_objectWithoutPropertiesLoose$1(n,_excluded$2),u=Object.values(c),d=Object.keys(c).map((t=>r||e.hasAttribute(t)?t:attributeCache$1[t]||(attributeCache$1[t]=t.replace(/([A-Z])/g,(e=>"-"+e.toLowerCase())))));void 0!==i&&(e.textContent=i);for(let h in o)if(o.hasOwnProperty(h)){const t=dangerousStyleValue$1(h,o[h]);isCustomPropRE$1.test(h)?e.style.setProperty(h,t):e.style[h]=t}d.forEach(((t,r)=>{e.setAttribute(t,u[r])})),void 0!==a&&(e.scrollTop=a),void 0!==s&&(e.scrollLeft=s),void 0!==l&&e.setAttribute("viewBox",l)}let isUnitlessNumber$1={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};const prefixKey$1=(e,t)=>e+t.charAt(0).toUpperCase()+t.substring(1),prefixes$1=["Webkit","Ms","Moz","O"];isUnitlessNumber$1=Object.keys(isUnitlessNumber$1).reduce(((e,t)=>(prefixes$1.forEach((r=>e[prefixKey$1(r,t)]=e[t])),e)),isUnitlessNumber$1);const _excluded$1=["x","y","z"],domTransforms$1=/^(matrix|translate|scale|rotate|skew)/,pxTransforms$1=/^(translate)/,degTransforms$1=/^(rotate|skew)/,addUnit$1=(e,t)=>is$1.num(e)&&0!==e?e+t:e,isValueIdentity$1=(e,t)=>is$1.arr(e)?e.every((e=>isValueIdentity$1(e,t))):is$1.num(e)?e===t:parseFloat(e)===t;let AnimatedStyle$1=class extends AnimatedObject$1{constructor(e){let{x:t,y:r,z:n}=e,o=_objectWithoutPropertiesLoose$1(e,_excluded$1);const i=[],a=[];(t||r||n)&&(i.push([t||0,r||0,n||0]),a.push((e=>["translate3d(".concat(e.map((e=>addUnit$1(e,"px"))).join(","),")"),isValueIdentity$1(e,0)]))),eachProp$1(o,((e,t)=>{if("transform"===t)i.push([e||""]),a.push((e=>[e,""===e]));else if(domTransforms$1.test(t)){if(delete o[t],is$1.und(e))return;const r=pxTransforms$1.test(t)?"px":degTransforms$1.test(t)?"deg":"";i.push(toArray$2(e)),a.push("rotate3d"===t?([e,t,n,o])=>["rotate3d(".concat(e,",").concat(t,",").concat(n,",").concat(addUnit$1(o,r),")"),isValueIdentity$1(o,0)]:e=>["".concat(t,"(").concat(e.map((e=>addUnit$1(e,r))).join(","),")"),isValueIdentity$1(e,t.startsWith("scale")?1:0)])}})),i.length&&(o.transform=new FluidTransform$1(i,a)),super(o)}},FluidTransform$1=class extends FluidValue$1{constructor(e,t){super(),this._value=null,this.inputs=e,this.transforms=t}get(){return this._value||(this._value=this._get())}_get(){let e="",t=!0;return each$1(this.inputs,((r,n)=>{const o=getFluidValue$1(r[0]),[i,a]=this.transforms[n](is$1.arr(o)?o:r.map(getFluidValue$1));e+=" "+i,t=t&&a})),t?"none":e}observerAdded(e){1==e&&each$1(this.inputs,(e=>each$1(e,(e=>hasFluidValue$1(e)&&addFluidObserver$1(e,this)))))}observerRemoved(e){0==e&&each$1(this.inputs,(e=>each$1(e,(e=>hasFluidValue$1(e)&&removeFluidObserver$1(e,this)))))}eventObserved(e){"change"==e.type&&(this._value=null),callFluidObservers$1(this,e)}};const primitives$1=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],_excluded$3=["scrollTop","scrollLeft"];globals.assign({batchedUpdates:reactDomExports.unstable_batchedUpdates,createStringInterpolator:createStringInterpolator$2,colors:colors$2});const host$1=createHost$1(primitives$1,{applyAnimatedValues:applyAnimatedValues$1,createAnimatedStyle:e=>new AnimatedStyle$1(e),getComponentProps:e=>_objectWithoutPropertiesLoose$1(e,_excluded$3)}),animated$1=host$1.animated;function resolveContainer(e){return("function"==typeof e?e():e)||document.body}function renderToContainer(e,t){if(canUseDom&&e){const r=resolveContainer(e);return reactDomExports.createPortal(t,r)}return t}function useInitialized(e){const t=reactExports.useRef(e);return e&&(t.current=!0),!!t.current}const ShouldRender=e=>useShouldRender(e.active,e.forceRender,e.destroyOnClose)?e.children:null;function useShouldRender(e,t,r){const n=useInitialized(e);return!!t||(!!e||!!n&&!r)}const eventToPropRecord$1={click:"onClick"};function withStopPropagation(e,t){const r=Object.assign({},t.props);for(const n of e){const e=eventToPropRecord$1[n];r[e]=function(r){var n,o;r.stopPropagation(),null===(o=(n=t.props)[e])||void 0===o||o.call(n,r)}}return React.cloneElement(t,r)}const classPrefix$C="adm-mask",opacityRecord={default:.55,thin:.35,thick:.75},colorRecord$2={black:"0, 0, 0",white:"255, 255, 255"},defaultProps$K={visible:!0,destroyOnClose:!1,forceRender:!1,color:"black",opacity:"default",disableBodyScroll:!0,getContainer:null,stopPropagation:["click"]},Mask=e=>{const t=mergeProps(defaultProps$K,e),{locale:r}=useConfig$1(),n=reactExports.useRef(null);useLockScroll(n,t.visible&&t.disableBodyScroll);const o=reactExports.useMemo((()=>{var e;const r=null!==(e=opacityRecord[t.opacity])&&void 0!==e?e:t.opacity,n=colorRecord$2[t.color];return n?"rgba(".concat(n,", ").concat(r,")"):t.color}),[t.color,t.opacity]),[i,a]=reactExports.useState(t.visible),s=useUnmountedRef(),{opacity:l}=useSpring$1({opacity:t.visible?1:0,config:{precision:.01,mass:1,tension:250,friction:30,clamp:!0},onStart:()=>{a(!0)},onRest:()=>{var e,r;s.current||(a(t.visible),t.visible?null===(e=t.afterShow)||void 0===e||e.call(t):null===(r=t.afterClose)||void 0===r||r.call(t))}}),c=withStopPropagation(t.stopPropagation,withNativeProps(t,React.createElement(animated$1.div,{className:classPrefix$C,ref:n,style:Object.assign(Object.assign({},t.style),{background:o,opacity:l,display:i?void 0:"none"}),onClick:e=>{var r;e.target===e.currentTarget&&(null===(r=t.onMaskClick)||void 0===r||r.call(t,e))}},t.onMaskClick&&React.createElement("div",{className:"".concat(classPrefix$C,"-aria-button"),role:"button","aria-label":r.Mask.name,onClick:t.onMaskClick}),React.createElement("div",{className:"".concat(classPrefix$C,"-content")},t.children))));return React.createElement(ShouldRender,{active:i,forceRender:t.forceRender,destroyOnClose:t.destroyOnClose},renderToContainer(t.getContainer,c))};function CheckOutline(e){return reactExports.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e,{style:Object.assign({verticalAlign:"-0.125em"},e.style),className:["antd-mobile-icon",e.className].filter(Boolean).join(" ")}),reactExports.createElement("g",{id:"CheckOutline-CheckOutline",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},reactExports.createElement("g",{id:"CheckOutline-编组"},reactExports.createElement("rect",{id:"CheckOutline-矩形",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),reactExports.createElement("path",{d:"M44.309608,12.6841286 L21.2180499,35.5661955 L21.2180499,35.5661955 C20.6343343,36.1446015 19.6879443,36.1446015 19.1042286,35.5661955 C19.0538201,35.5162456 19.0077648,35.4636155 18.9660627,35.4087682 C18.9113105,35.368106 18.8584669,35.3226694 18.808302,35.2729607 L3.6903839,20.2920499 C3.53346476,20.1365529 3.53231192,19.8832895 3.68780898,19.7263704 C3.7629255,19.6505669 3.86521855,19.6079227 3.97193622,19.6079227 L7.06238923,19.6079227 C7.16784214,19.6079227 7.26902895,19.6495648 7.34393561,19.7237896 L20.160443,32.4236157 L20.160443,32.4236157 L40.656066,12.115858 C40.7309719,12.0416387 40.8321549,12 40.9376034,12 L44.0280571,12 C44.248971,12 44.4280571,12.1790861 44.4280571,12.4 C44.4280571,12.5067183 44.3854124,12.609012 44.309608,12.6841286 Z",id:"CheckOutline-路径",fill:"currentColor",fillRule:"nonzero"}))))}function CloseCircleFill(e){return reactExports.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e,{style:Object.assign({verticalAlign:"-0.125em"},e.style),className:["antd-mobile-icon",e.className].filter(Boolean).join(" ")}),reactExports.createElement("g",{id:"CloseCircleFill-CloseCircleFill",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},reactExports.createElement("g",{id:"CloseCircleFill-编组"},reactExports.createElement("rect",{id:"CloseCircleFill-矩形",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),reactExports.createElement("path",{d:"M24,2 C36.1502645,2 46,11.8497355 46,24 C46,36.1502645 36.1502645,46 24,46 C11.8497355,46 2,36.1502645 2,24 C2,11.8497355 11.8497355,2 24,2 Z M18.6753876,16 L15.5637812,16 C15.4576916,16 15.3559474,16.0421451 15.2809323,16.1171635 C15.124726,16.2733766 15.1247316,16.5266426 15.2809447,16.6828489 L15.2809447,16.6828489 L22.299066,23.7006641 L14.6828159,31.3171619 C14.6078042,31.3921761 14.5656632,31.4939157 14.5656632,31.6 C14.5656632,31.8209139 14.7447493,32 14.9656632,32 L14.9656632,32 L18.0753284,32 C18.1814068,32 18.2831412,31.9578638 18.3581544,31.8828594 L18.3581544,31.8828594 L24.420066,25.8216641 L30.4818451,31.8828564 C30.5568585,31.9578626 30.6585942,32 30.7646741,32 L30.7646741,32 L33.8763476,32 C33.9824309,32 34.0841695,31.9578599 34.1591835,31.8828496 C34.315397,31.7266436 34.3154031,31.4733776 34.1591972,31.3171641 L34.1591972,31.3171641 L26.542066,23.6996641 L33.5591874,16.6828489 C33.6342057,16.6078338 33.6763508,16.5060896 33.6763508,16.4 C33.6763508,16.1790861 33.4972647,16 33.2763508,16 L33.2763508,16 L30.1637654,16 C30.0576705,16 29.9559218,16.0421493 29.8809058,16.1171741 L29.8809058,16.1171741 L24.420066,21.5786641 L18.9582218,16.1171488 C18.883208,16.0421394 18.7814701,16 18.6753876,16 L18.6753876,16 Z",id:"CloseCircleFill-形状结合",fill:"currentColor",fillRule:"nonzero"}))))}function CloseOutline(e){return reactExports.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e,{style:Object.assign({verticalAlign:"-0.125em"},e.style),className:["antd-mobile-icon",e.className].filter(Boolean).join(" ")}),reactExports.createElement("g",{id:"CloseOutline-CloseOutline",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},reactExports.createElement("g",{id:"CloseOutline-编组"},reactExports.createElement("rect",{id:"CloseOutline-矩形",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),reactExports.createElement("path",{d:"M10.6085104,8.11754663 L24.1768397,21.8195031 L24.1768397,21.8195031 L37.7443031,8.1175556 C37.8194278,8.04168616 37.9217669,7.999 38.0285372,7.999 L41.1040268,7.999 C41.3249407,7.999 41.5040268,8.1780861 41.5040268,8.399 C41.5040268,8.50440471 41.4624226,8.60554929 41.3882578,8.68044752 L26.2773302,23.9408235 L26.2773302,23.9408235 L41.5021975,39.3175645 C41.65763,39.4745475 41.6563731,39.7278104 41.4993901,39.8832429 C41.4244929,39.9574004 41.3233534,39.999 41.2179546,39.999 L38.1434012,39.999 C38.0366291,39.999 37.9342885,39.9563124 37.8591634,39.8804408 L24.1768397,26.0621438 L24.1768397,26.0621438 L10.4936501,39.8804497 C10.4185257,39.9563159 10.3161889,39.999 10.2094212,39.999 L7.13584526,39.999 C6.91493136,39.999 6.73584526,39.8199139 6.73584526,39.599 C6.73584526,39.4936017 6.77744443,39.3924627 6.85160121,39.3175656 L22.0763492,23.9408235 L22.0763492,23.9408235 L6.96554081,8.68044639 C6.81010226,8.52346929 6.81134951,8.27020637 6.9683266,8.11476782 C7.04322474,8.04060377 7.14436883,7.999 7.24977299,7.999 L10.3242852,7.999 C10.4310511,7.999 10.5333863,8.04168267 10.6085104,8.11754663 Z",id:"CloseOutline-路径",fill:"currentColor",fillRule:"nonzero"}))))}function SearchOutline(e){return reactExports.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e,{style:Object.assign({verticalAlign:"-0.125em"},e.style),className:["antd-mobile-icon",e.className].filter(Boolean).join(" ")}),reactExports.createElement("g",{id:"SearchOutline-SearchOutline",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},reactExports.createElement("g",{id:"SearchOutline-编组"},reactExports.createElement("rect",{id:"SearchOutline-矩形",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),reactExports.createElement("path",{d:"M10.2434135,10.1505371 C17.2346315,3.28315429 28.5696354,3.28315429 35.5608534,10.1505371 C42.3159331,16.7859644 42.5440954,27.4048667 36.2453405,34.3093889 L43.7095294,41.6422249 C43.8671196,41.7970419 43.8693677,42.0502979 43.7145508,42.2078881 C43.7128864,42.2095822 43.7112069,42.2112616 43.7095126,42.2129259 L42.1705322,43.7246464 C42.014915,43.8775072 41.7655181,43.8775006 41.6099089,43.7246316 L34.0775268,36.3248916 L34.0775268,36.3248916 C27.0485579,41.8551751 16.7593545,41.4200547 10.2434135,35.0195303 C3.25219551,28.1521474 3.25219551,17.0179199 10.2434135,10.1505371 Z M12.3532001,12.2229532 C6.52718516,17.9457722 6.52718516,27.2242951 12.3532001,32.9471142 C18.1792151,38.6699332 27.6250517,38.6699332 33.4510667,32.9471142 C39.2770817,27.2242951 39.2770817,17.9457722 33.4510667,12.2229532 C27.6250517,6.50013419 18.1792151,6.50013419 12.3532001,12.2229532 Z",id:"SearchOutline-形状",fill:"currentColor",fillRule:"nonzero"}))))}const defaultPopupBaseProps={closeOnMaskClick:!1,destroyOnClose:!1,disableBodyScroll:!0,forceRender:!1,getContainer:()=>document.body,mask:!0,showCloseButton:!1,stopPropagation:["click"],visible:!1};function useInnerVisible(e){const[t,r]=reactExports.useState(e);return useIsomorphicLayoutEffect$2((()=>{r(e)}),[e]),t}function clamp$3(e,t,r){return Math.max(t,Math.min(e,r))}const V$1={toVector:(e,t)=>(void 0===e&&(e=t),Array.isArray(e)?e:[e,e]),add:(e,t)=>[e[0]+t[0],e[1]+t[1]],sub:(e,t)=>[e[0]-t[0],e[1]-t[1]],addTo(e,t){e[0]+=t[0],e[1]+=t[1]},subTo(e,t){e[0]-=t[0],e[1]-=t[1]}};function rubberband$1(e,t,r){return 0===t||Math.abs(t)===1/0?Math.pow(e,5*r):e*t*r/(t+r*e)}function rubberbandIfOutOfBounds$1(e,t,r,n=.15){return 0===n?clamp$3(e,t,r):e<t?-rubberband$1(t-e,r-t,n)+t:e>r?+rubberband$1(e-r,r-t,n)+r:e}function computeRubberband(e,[t,r],[n,o]){const[[i,a],[s,l]]=e;return[rubberbandIfOutOfBounds$1(t,i,a,n),rubberbandIfOutOfBounds$1(r,s,l,o)]}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ownKeys$8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$8(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$8(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const EVENT_TYPE_MAP={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function capitalize(e){return e?e[0].toUpperCase()+e.slice(1):""}const actionsWithoutCaptureSupported=["enter","leave"];function hasCapture(e=!1,t){return e&&!actionsWithoutCaptureSupported.includes(t)}function toHandlerProp(e,t="",r=!1){const n=EVENT_TYPE_MAP[e],o=n&&n[t]||t;return"on"+capitalize(e)+capitalize(o)+(hasCapture(r,o)?"Capture":"")}const pointerCaptureEvents=["gotpointercapture","lostpointercapture"];function parseProp(e){let t=e.substring(2).toLowerCase();const r=!!~t.indexOf("passive");r&&(t=t.replace("passive",""));const n=pointerCaptureEvents.includes(t)?"capturecapture":"capture",o=!!~t.indexOf(n);return o&&(t=t.replace("capture","")),{device:t,capture:o,passive:r}}function toDomEventType(e,t=""){const r=EVENT_TYPE_MAP[e];return e+(r&&r[t]||t)}function isTouch(e){return"touches"in e}function getPointerType(e){return isTouch(e)?"touch":"pointerType"in e?e.pointerType:"mouse"}function getCurrentTargetTouchList(e){return Array.from(e.touches).filter((t=>{var r,n;return t.target===e.currentTarget||(null===(r=e.currentTarget)||void 0===r||null===(n=r.contains)||void 0===n?void 0:n.call(r,t.target))}))}function getTouchList(e){return"touchend"===e.type||"touchcancel"===e.type?e.changedTouches:e.targetTouches}function getValueEvent(e){return isTouch(e)?getTouchList(e)[0]:e}function touchIds(e){return getCurrentTargetTouchList(e).map((e=>e.identifier))}function pointerId(e){const t=getValueEvent(e);return isTouch(e)?t.identifier:t.pointerId}function pointerValues(e){const t=getValueEvent(e);return[t.clientX,t.clientY]}const LINE_HEIGHT=40,PAGE_HEIGHT=800;function wheelValues(e){let{deltaX:t,deltaY:r,deltaMode:n}=e;return 1===n?(t*=LINE_HEIGHT,r*=LINE_HEIGHT):2===n&&(t*=PAGE_HEIGHT,r*=PAGE_HEIGHT),[t,r]}function getEventDetails(e){const t={};if("buttons"in e&&(t.buttons=e.buttons),"shiftKey"in e){const{shiftKey:r,altKey:n,metaKey:o,ctrlKey:i}=e;Object.assign(t,{shiftKey:r,altKey:n,metaKey:o,ctrlKey:i})}return t}function call$1(e,...t){return"function"==typeof e?e(...t):e}function noop$3(){}function chain(...e){return 0===e.length?noop$3:1===e.length?e[0]:function(){let t;for(const r of e)t=r.apply(this,arguments)||t;return t}}function assignDefault(e,t){return Object.assign({},t,e||{})}const BEFORE_LAST_KINEMATICS_DELAY=32;class Engine{constructor(e,t,r){this.ctrl=e,this.args=t,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:t,ingKey:r,args:n}=this;t[r]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=n,e.axis=void 0,e.memo=void 0,e.elapsedTime=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const t=this.state,r=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=r.from?call$1(r.from,t):t.offset,t.offset=t.lastOffset),t.startTime=t.timeStamp=e.timeStamp}computeValues(e){const t=this.state;t._values=e,t.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:t,config:r,shared:n}=this;t.args=this.args;let o=0;if(e&&(t.event=e,r.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,n.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,n.locked=!!document.pointerLockElement,Object.assign(n,getEventDetails(e)),n.down=n.pressed=n.buttons%2==1||n.touches>0,o=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){const e=t._delta.map(Math.abs);V$1.addTo(t._distance,e)}this.axisIntent&&this.axisIntent(e);const[i,a]=t._movement,[s,l]=r.threshold,{_step:c,values:u}=t;if(r.hasCustomTransform?(!1===c[0]&&(c[0]=Math.abs(i)>=s&&u[0]),!1===c[1]&&(c[1]=Math.abs(a)>=l&&u[1])):(!1===c[0]&&(c[0]=Math.abs(i)>=s&&Math.sign(i)*s),!1===c[1]&&(c[1]=Math.abs(a)>=l&&Math.sign(a)*l)),t.intentional=!1!==c[0]||!1!==c[1],!t.intentional)return;const d=[0,0];if(r.hasCustomTransform){const[e,t]=u;d[0]=!1!==c[0]?e-c[0]:0,d[1]=!1!==c[1]?t-c[1]:0}else d[0]=!1!==c[0]?i-c[0]:0,d[1]=!1!==c[1]?a-c[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(d);const h=t.offset,p=t._active&&!t._blocked||t.active;p&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=n[this.ingKey]=t._active,e&&(t.first&&("bounds"in r&&(t._bounds=call$1(r.bounds,t)),this.setup&&this.setup()),t.movement=d,this.computeOffset()));const[f,g]=t.offset,[[m,y],[v,_]]=t._bounds;t.overflow=[f<m?-1:f>y?1:0,g<v?-1:g>_?1:0],t._movementBound[0]=!!t.overflow[0]&&(!1===t._movementBound[0]?t._movement[0]:t._movementBound[0]),t._movementBound[1]=!!t.overflow[1]&&(!1===t._movementBound[1]?t._movement[1]:t._movementBound[1]);const b=t._active&&r.rubberband||[0,0];if(t.offset=computeRubberband(t._bounds,t.offset,b),t.delta=V$1.sub(t.offset,h),this.computeMovement(),p&&(!t.last||o>BEFORE_LAST_KINEMATICS_DELAY)){t.delta=V$1.sub(t.offset,h);const e=t.delta.map(Math.abs);V$1.addTo(t.distance,e),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&o>0&&(t.velocity=[e[0]/o,e[1]/o])}}emit(){const e=this.state,t=this.shared,r=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!r.triggerAllEvents)return;const n=this.handler(_objectSpread2(_objectSpread2(_objectSpread2({},t),e),{},{[this.aliasKey]:e.values}));void 0!==n&&(e.memo=n)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function selectAxis([e,t],r){const n=Math.abs(e),o=Math.abs(t);return n>o&&n>r?"x":o>n&&o>r?"y":void 0}class CoordinatesEngine extends Engine{constructor(...e){super(...e),_defineProperty(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=V$1.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=V$1.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const t=this.state,r=this.config;if(!t.axis&&e){const n="object"==typeof r.axisThreshold?r.axisThreshold[getPointerType(e)]:r.axisThreshold;t.axis=selectAxis(t._movement,n)}t._blocked=(r.lockDirection||!!r.axis)&&!t.axis||!!r.axis&&r.axis!==t.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0}}}const identity$4=e=>e,DEFAULT_RUBBERBAND=.15,commonConfigResolver={enabled:(e=!0)=>e,eventOptions:(e,t,r)=>_objectSpread2(_objectSpread2({},r.shared.eventOptions),e),preventDefault:(e=!1)=>e,triggerAllEvents:(e=!1)=>e,rubberband(e=0){switch(e){case!0:return[DEFAULT_RUBBERBAND,DEFAULT_RUBBERBAND];case!1:return[0,0];default:return V$1.toVector(e)}},from:e=>"function"==typeof e?e:null!=e?V$1.toVector(e):void 0,transform(e,t,r){const n=e||r.shared.transform;return this.hasCustomTransform=!!n,n||identity$4},threshold:e=>V$1.toVector(e,0)},DEFAULT_AXIS_THRESHOLD=0,coordinatesConfigResolver=_objectSpread2(_objectSpread2({},commonConfigResolver),{},{axis(e,t,{axis:r}){if(this.lockDirection="lock"===r,!this.lockDirection)return r},axisThreshold:(e=DEFAULT_AXIS_THRESHOLD)=>e,bounds(e={}){if("function"==typeof e)return t=>coordinatesConfigResolver.bounds(e(t));if("current"in e)return()=>e.current;if("function"==typeof HTMLElement&&e instanceof HTMLElement)return e;const{left:t=-1/0,right:r=1/0,top:n=-1/0,bottom:o=1/0}=e;return[[t,r],[n,o]]}}),DISPLACEMENT=10,KEYS_DELTA_MAP={ArrowRight:(e=1)=>[DISPLACEMENT*e,0],ArrowLeft:(e=1)=>[-DISPLACEMENT*e,0],ArrowUp:(e=1)=>[0,-DISPLACEMENT*e],ArrowDown:(e=1)=>[0,DISPLACEMENT*e]};class DragEngine extends CoordinatesEngine{constructor(...e){super(...e),_defineProperty(this,"ingKey","dragging")}reset(){super.reset();const e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){const e=this.state;if(e._bounds instanceof HTMLElement){const t=e._bounds.getBoundingClientRect(),r=e.currentTarget.getBoundingClientRect(),n={left:t.left-r.left+e.offset[0],right:t.right-r.right+e.offset[0],top:t.top-r.top+e.offset[1],bottom:t.bottom-r.bottom+e.offset[1]};e._bounds=coordinatesConfigResolver.bounds(n)}}cancel(){const e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout((()=>{this.compute(),this.emit()}),0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){const t=this.config,r=this.state;if(null!=e.buttons&&(Array.isArray(t.pointerButtons)?!t.pointerButtons.includes(e.buttons):-1!==t.pointerButtons&&t.pointerButtons!==e.buttons))return;const n=this.ctrl.setEventIds(e);t.pointerCapture&&e.target.setPointerCapture(e.pointerId),n&&n.size>1&&r._pointerActive||(this.start(e),this.setupPointer(e),r._pointerId=pointerId(e),r._pointerActive=!0,this.computeValues(pointerValues(e)),this.computeInitial(),t.preventScrollAxis&&"mouse"!==getPointerType(e)?(r._active=!1,this.setupScrollPrevention(e)):t.delay>0?(this.setupDelayTrigger(e),t.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){const t=this.state;t._active=!0,t._preventScroll=!0,t._delayed=!1,this.compute(e),this.emit()}pointerMove(e){const t=this.state,r=this.config;if(!t._pointerActive)return;if(t.type===e.type&&e.timeStamp===t.timeStamp)return;const n=pointerId(e);if(void 0!==t._pointerId&&n!==t._pointerId)return;const o=pointerValues(e);return document.pointerLockElement===e.target?t._delta=[e.movementX,e.movementY]:(t._delta=V$1.sub(o,t._values),this.computeValues(o)),V$1.addTo(t._movement,t._delta),this.compute(e),t._delayed&&t.intentional?(this.timeoutStore.remove("dragDelay"),t.active=!1,void this.startPointerDrag(e)):r.preventScrollAxis&&!t._preventScroll?t.axis?t.axis===r.preventScrollAxis||"xy"===r.preventScrollAxis?(t._active=!1,void this.clean()):(this.timeoutStore.remove("startPointerDrag"),void this.startPointerDrag(e)):void 0:void this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch(a){}const t=this.state,r=this.config;if(!t._active||!t._pointerActive)return;const n=pointerId(e);if(void 0!==t._pointerId&&n!==t._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);const[o,i]=t._distance;if(t.tap=o<=r.tapsThreshold&&i<=r.tapsThreshold,t.tap&&r.filterTaps)t._force=!0;else{const[e,n]=t.direction,[o,i]=t.velocity,[a,s]=t.movement,[l,c]=r.swipe.velocity,[u,d]=r.swipe.distance,h=r.swipe.duration;t.elapsedTime<h&&(Math.abs(o)>l&&Math.abs(a)>u&&(t.swipe[0]=e),Math.abs(i)>c&&Math.abs(s)>d&&(t.swipe[1]=n))}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){const t=this.config,r=t.device;t.pointerLock&&e.currentTarget.requestPointerLock(),t.pointerCapture||(this.eventStore.add(this.sharedConfig.window,r,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,r,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,r,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,persistEvent(e);const t=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",t),this.eventStore.add(this.sharedConfig.window,"touch","cancel",t),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",(()=>{this.state._step=[0,0],this.startPointerDrag(e)}),this.config.delay)}keyDown(e){const t=KEYS_DELTA_MAP[e.key];if(t){const r=this.state,n=e.shiftKey?10:e.altKey?.1:1;this.start(e),r._delta=t(n),r._keyboardActive=!0,V$1.addTo(r._movement,r._delta),this.compute(e),this.emit()}}keyUp(e){e.key in KEYS_DELTA_MAP&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){const t=this.config.device;e(t,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(t,"change",this.pointerMove.bind(this)),e(t,"end",this.pointerUp.bind(this)),e(t,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function persistEvent(e){"persist"in e&&"function"==typeof e.persist&&e.persist()}const isBrowser$2="undefined"!=typeof window&&window.document&&window.document.createElement;function supportsTouchEvents(){return isBrowser$2&&"ontouchstart"in window}function isTouchScreen(){return supportsTouchEvents()||isBrowser$2&&window.navigator.maxTouchPoints>1}function supportsPointerEvents(){return isBrowser$2&&"onpointerdown"in window}function supportsPointerLock(){return isBrowser$2&&"exitPointerLock"in window.document}function supportsGestureEvents(){try{return"constructor"in GestureEvent}catch(e3){return!1}}const SUPPORT={isBrowser:isBrowser$2,gesture:supportsGestureEvents(),touch:isTouchScreen(),touchscreen:isTouchScreen(),pointer:supportsPointerEvents(),pointerLock:supportsPointerLock()},DEFAULT_PREVENT_SCROLL_DELAY=250,DEFAULT_DRAG_DELAY=180,DEFAULT_SWIPE_VELOCITY=.5,DEFAULT_SWIPE_DISTANCE=50,DEFAULT_SWIPE_DURATION=250,DEFAULT_DRAG_AXIS_THRESHOLD={mouse:0,touch:0,pen:8},dragConfigResolver=_objectSpread2(_objectSpread2({},coordinatesConfigResolver),{},{device(e,t,{pointer:{touch:r=!1,lock:n=!1,mouse:o=!1}={}}){return this.pointerLock=n&&SUPPORT.pointerLock,SUPPORT.touch&&r?"touch":this.pointerLock?"mouse":SUPPORT.pointer&&!o?"pointer":SUPPORT.touch?"touch":"mouse"},preventScrollAxis(e,t,{preventScroll:r}){if(this.preventScrollDelay="number"==typeof r?r:r||void 0===r&&e?DEFAULT_PREVENT_SCROLL_DELAY:void 0,SUPPORT.touchscreen&&!1!==r)return e||(void 0!==r?"y":void 0)},pointerCapture(e,t,{pointer:{capture:r=!0,buttons:n=1}={}}){return this.pointerButtons=n,!this.pointerLock&&"pointer"===this.device&&r},keys:(e=!0)=>e,threshold(e,t,{filterTaps:r=!1,tapsThreshold:n=3,axis:o}){const i=V$1.toVector(e,r?n:o?1:0);return this.filterTaps=r,this.tapsThreshold=n,i},swipe({velocity:e=DEFAULT_SWIPE_VELOCITY,distance:t=DEFAULT_SWIPE_DISTANCE,duration:r=DEFAULT_SWIPE_DURATION}={}){return{velocity:this.transform(V$1.toVector(e)),distance:this.transform(V$1.toVector(t)),duration:r}},delay(e=0){switch(e){case!0:return DEFAULT_DRAG_DELAY;case!1:return 0;default:return e}},axisThreshold:e=>e?_objectSpread2(_objectSpread2({},DEFAULT_DRAG_AXIS_THRESHOLD),e):DEFAULT_DRAG_AXIS_THRESHOLD});_objectSpread2(_objectSpread2({},commonConfigResolver),{},{device(e,t,{shared:r,pointer:{touch:n=!1}={}}){if(r.target&&!SUPPORT.touch&&SUPPORT.gesture)return"gesture";if(SUPPORT.touch&&n)return"touch";if(SUPPORT.touchscreen){if(SUPPORT.pointer)return"pointer";if(SUPPORT.touch)return"touch"}},bounds(e,t,{scaleBounds:r={},angleBounds:n={}}){const o=e=>{const t=assignDefault(call$1(r,e),{min:-1/0,max:1/0});return[t.min,t.max]},i=e=>{const t=assignDefault(call$1(n,e),{min:-1/0,max:1/0});return[t.min,t.max]};return"function"!=typeof r&&"function"!=typeof n?[o(),i()]:e=>[o(e),i(e)]},threshold(e,t,r){this.lockDirection="lock"===r.axis;return V$1.toVector(e,this.lockDirection?[.1,3]:0)},modifierKey:e=>void 0===e?"ctrlKey":e}),_objectSpread2(_objectSpread2({},coordinatesConfigResolver),{},{mouseOnly:(e=!0)=>e});class WheelEngine extends CoordinatesEngine{constructor(...e){super(...e),_defineProperty(this,"ingKey","wheeling")}wheel(e){this.state._active||this.start(e),this.wheelChange(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(e){const t=this.state;t._delta=wheelValues(e),V$1.addTo(t._movement,t._delta);const[r,n]=t.overflow,[o,i]=t._delta,[a,s]=t._direction;(r<0&&o>0&&a<0||r>0&&o<0&&a>0)&&(t._movement[0]=t._movementBound[0]),(n<0&&i>0&&s<0||n>0&&i<0&&s>0)&&(t._movement[1]=t._movementBound[1]),this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("wheel","",this.wheel.bind(this))}}const wheelConfigResolver=coordinatesConfigResolver;_objectSpread2(_objectSpread2({},coordinatesConfigResolver),{},{mouseOnly:(e=!0)=>e});const EngineMap=new Map,ConfigResolverMap=new Map;function registerAction(e){EngineMap.set(e.key,e.engine),ConfigResolverMap.set(e.key,e.resolver)}const dragAction={key:"drag",engine:DragEngine,resolver:dragConfigResolver},wheelAction={key:"wheel",engine:WheelEngine,resolver:wheelConfigResolver};function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}function _objectWithoutProperties$1(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}const sharedConfigResolver={target(e){if(e)return()=>"current"in e?e.current:e},enabled:(e=!0)=>e,window:(e=(SUPPORT.isBrowser?window:void 0))=>e,eventOptions:({passive:e=!0,capture:t=!1}={})=>({passive:e,capture:t}),transform:e=>e},_excluded=["target","eventOptions","window","enabled","transform"];function resolveWith(e={},t){const r={};for(const[n,o]of Object.entries(t))switch(typeof o){case"function":r[n]=o.call(r,e[n],n,e);break;case"object":r[n]=resolveWith(e[n],o);break;case"boolean":o&&(r[n]=e[n])}return r}function parse(e,t,r={}){const n=e,{target:o,eventOptions:i,window:a,enabled:s,transform:l}=n,c=_objectWithoutProperties$1(n,_excluded);if(r.shared=resolveWith({target:o,eventOptions:i,window:a,enabled:s,transform:l},sharedConfigResolver),t){const e=ConfigResolverMap.get(t);r[t]=resolveWith(_objectSpread2({shared:r.shared},c),e)}else for(const u in c){const e=ConfigResolverMap.get(u);e&&(r[u]=resolveWith(_objectSpread2({shared:r.shared},c[u]),e))}return r}class EventStore{constructor(e,t){_defineProperty(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=t}add(e,t,r,n,o){const i=this._listeners,a=toDomEventType(t,r),s=_objectSpread2(_objectSpread2({},this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{}),o);e.addEventListener(a,n,s);const l=()=>{e.removeEventListener(a,n,s),i.delete(l)};return i.add(l),l}clean(){this._listeners.forEach((e=>e())),this._listeners.clear()}}class TimeoutStore{constructor(){_defineProperty(this,"_timeouts",new Map)}add(e,t,r=140,...n){this.remove(e),this._timeouts.set(e,window.setTimeout(t,r,...n))}remove(e){const t=this._timeouts.get(e);t&&window.clearTimeout(t)}clean(){this._timeouts.forEach((e=>{window.clearTimeout(e)})),this._timeouts.clear()}}let Controller$1=class{constructor(e){_defineProperty(this,"gestures",new Set),_defineProperty(this,"_targetEventStore",new EventStore(this)),_defineProperty(this,"gestureEventStores",{}),_defineProperty(this,"gestureTimeoutStores",{}),_defineProperty(this,"handlers",{}),_defineProperty(this,"config",{}),_defineProperty(this,"pointerIds",new Set),_defineProperty(this,"touchIds",new Set),_defineProperty(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),resolveGestures(this,e)}setEventIds(e){return isTouch(e)?(this.touchIds=new Set(touchIds(e)),this.touchIds):"pointerId"in e?("pointerup"===e.type||"pointercancel"===e.type?this.pointerIds.delete(e.pointerId):"pointerdown"===e.type&&this.pointerIds.add(e.pointerId),this.pointerIds):void 0}applyHandlers(e,t){this.handlers=e,this.nativeHandlers=t}applyConfig(e,t){this.config=parse(e,t,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const t=this.config.shared,r={};let n;if(!t.target||(n=t.target(),n)){if(t.enabled){for(const t of this.gestures){const o=this.config[t],i=bindToProps(r,o.eventOptions,!!n);if(o.enabled){new(EngineMap.get(t))(this,e,t).bind(i)}}const o=bindToProps(r,t.eventOptions,!!n);for(const t in this.nativeHandlers)o(t,"",(r=>this.nativeHandlers[t](_objectSpread2(_objectSpread2({},this.state.shared),{},{event:r,args:e}))),void 0,!0)}for(const e in r)r[e]=chain(...r[e]);if(!n)return r;for(const e in r){const{device:t,capture:o,passive:i}=parseProp(e);this._targetEventStore.add(n,t,"",r[e],{capture:o,passive:i})}}}};function setupGesture(e,t){e.gestures.add(t),e.gestureEventStores[t]=new EventStore(e,t),e.gestureTimeoutStores[t]=new TimeoutStore}function resolveGestures(e,t){t.drag&&setupGesture(e,"drag"),t.wheel&&setupGesture(e,"wheel"),t.scroll&&setupGesture(e,"scroll"),t.move&&setupGesture(e,"move"),t.pinch&&setupGesture(e,"pinch"),t.hover&&setupGesture(e,"hover")}const bindToProps=(e,t,r)=>(n,o,i,a={},s=!1)=>{var l,c;const u=null!==(l=a.capture)&&void 0!==l?l:t.capture,d=null!==(c=a.passive)&&void 0!==c?c:t.passive;let h=s?n:toHandlerProp(n,o,u);r&&d&&(h+="Passive"),e[h]=e[h]||[],e[h].push(i)};function useRecognizers(e,t={},r,n){const o=React.useMemo((()=>new Controller$1(e)),[]);if(o.applyHandlers(e,n),o.applyConfig(t,r),React.useEffect(o.effect.bind(o)),React.useEffect((()=>o.clean.bind(o)),[]),void 0===t.target)return o.bind.bind(o)}function useDrag(e,t){return registerAction(dragAction),useRecognizers({drag:e},t||{},"drag")}function useWheel(e,t){return registerAction(wheelAction),useRecognizers({wheel:e},t||{},"wheel")}const classPrefix$B="adm-popup",defaultProps$J=Object.assign(Object.assign({},defaultPopupBaseProps),{closeOnSwipe:!1,position:"bottom"}),Popup=e=>{const t=mergeProps(defaultProps$J,e),{locale:r}=useConfig$1(),n=classNames$1("".concat(classPrefix$B,"-body"),t.bodyClassName,"".concat(classPrefix$B,"-body-position-").concat(t.position)),[o,i]=reactExports.useState(t.visible);useIsomorphicLayoutEffect$2((()=>{t.visible&&i(!0)}),[t.visible]);const a=reactExports.useRef(null);useLockScroll(a,!(!t.disableBodyScroll||!o)&&"strict");const s=useUnmountedRef(),{percent:l}=useSpring$1({percent:t.visible?0:100,config:{precision:.1,mass:.4,tension:300,friction:30},onRest:()=>{var e,r;s.current||(i(t.visible),t.visible?null===(e=t.afterShow)||void 0===e||e.call(t):null===(r=t.afterClose)||void 0===r||r.call(t))}}),c=useDrag((({swipe:[,e]})=>{var r;t.closeOnSwipe&&(1===e&&"bottom"===t.position||-1===e&&"top"===t.position)&&(null===(r=t.onClose)||void 0===r||r.call(t))}),{axis:"y",enabled:["top","bottom"].includes(t.position)}),u=useInnerVisible(o&&t.visible),d=withStopPropagation(t.stopPropagation,withNativeProps(t,React.createElement("div",Object.assign({className:classPrefix$B,onClick:t.onClick,style:{display:o?void 0:"none",touchAction:["top","bottom"].includes(t.position)?"none":"auto"}},c()),t.mask&&React.createElement(Mask,{visible:u,forceRender:t.forceRender,destroyOnClose:t.destroyOnClose,onMaskClick:e=>{var r,n;null===(r=t.onMaskClick)||void 0===r||r.call(t,e),t.closeOnMaskClick&&(null===(n=t.onClose)||void 0===n||n.call(t))},className:t.maskClassName,style:t.maskStyle,disableBodyScroll:!1,stopPropagation:t.stopPropagation}),React.createElement(animated$1.div,{className:n,style:Object.assign(Object.assign({},t.bodyStyle),{transform:l.to((e=>"bottom"===t.position?"translate(0, ".concat(e,"%)"):"top"===t.position?"translate(0, -".concat(e,"%)"):"left"===t.position?"translate(-".concat(e,"%, 0)"):"right"===t.position?"translate(".concat(e,"%, 0)"):"none"))}),ref:a},t.showCloseButton&&React.createElement("a",{className:classNames$1("".concat(classPrefix$B,"-close-icon"),"adm-plain-anchor"),onClick:()=>{var e;null===(e=t.onClose)||void 0===e||e.call(t)},role:"button","aria-label":r.common.close},React.createElement(CloseOutline,null)),t.children))));return React.createElement(ShouldRender,{active:o,forceRender:t.forceRender,destroyOnClose:t.destroyOnClose},renderToContainer(t.getContainer,d))},fullClone=Object.assign({},ReactDOM$1),{version:version,render:reactRender,unmountComponentAtNode:unmountComponentAtNode}=fullClone;let createRoot;try{const e=Number((version||"").split(".")[0]);e>=18&&fullClone.createRoot&&(createRoot=fullClone.createRoot)}catch(e3){}function toggleWarning(e){const{__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:t}=fullClone;t&&"object"==typeof t&&(t.usingClientEntryPoint=e)}const MARK="__antd_mobile_root__";function legacyRender(e,t){reactRender(e,t)}function concurrentRender(e,t){toggleWarning(!0);const r=t[MARK]||createRoot(t);toggleWarning(!1),r.render(e),t[MARK]=r}function render(e,t){createRoot?concurrentRender(e,t):legacyRender(e,t)}function legacyUnmount(e){return unmountComponentAtNode(e)}function concurrentUnmount(e){return __awaiter(this,void 0,void 0,(function*(){return Promise.resolve().then((()=>{var t;null===(t=e[MARK])||void 0===t||t.unmount(),delete e[MARK]}))}))}function unmount(e){return createRoot?concurrentUnmount(e):legacyUnmount(e)}function renderToBody(e){const t=document.createElement("div");return document.body.appendChild(t),render(e,t),function(){unmount(t)&&t.parentNode&&t.parentNode.removeChild(t)}}function renderImperatively(e){const t=React.forwardRef(((t,r)=>{const[o,i]=reactExports.useState(!1),a=reactExports.useRef(!1),[s,l]=reactExports.useState(e),c=reactExports.useRef(0);function u(){var e,t;a.current=!0,i(!1),null===(t=(e=s.props).onClose)||void 0===t||t.call(e)}function d(){var e,t;n(),null===(t=(e=s.props).afterClose)||void 0===t||t.call(e)}return reactExports.useEffect((()=>{a.current?d():i(!0)}),[]),reactExports.useImperativeHandle(r,(()=>({close:u,replace:e=>{var t,r;c.current++,null===(r=(t=s.props).afterClose)||void 0===r||r.call(t),l(e)}}))),React.cloneElement(s,Object.assign(Object.assign({},s.props),{key:c.current,visible:o,onClose:u,afterClose:d}))})),r=React.createRef(),n=renderToBody(React.createElement(t,{ref:r}));return{close:()=>__awaiter(this,void 0,void 0,(function*(){var e;r.current?null===(e=r.current)||void 0===e||e.close():n()})),replace:e=>{var t;null===(t=r.current)||void 0===t||t.replace(e)}}}const classPrefix$A="adm-auto-center",AutoCenter=e=>withNativeProps(e,React.createElement("div",{className:classPrefix$A},React.createElement("div",{className:"".concat(classPrefix$A,"-content")},e.children)));var stagedComponents={},__importDefault=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(stagedComponents,"__esModule",{value:!0});var staged_1=stagedComponents.staged=void 0;const react_1=__importDefault(reactExports);function processNext(e){return"function"==typeof e?react_1.default.createElement(Stage,{stage:e}):e}function Stage(e){return processNext(e.stage())}function staged(e){return function(t,r){return processNext(e(t,r))}}function toCSSLength(e){return"number"==typeof e?"".concat(e,"px"):e}staged_1=stagedComponents.staged=staged;const LazyDetector=e=>{const t=reactExports.useRef(null),[r]=useInViewport(t);return reactExports.useEffect((()=>{r&&e.onActive()}),[r]),React.createElement("div",{ref:t})},useIsomorphicUpdateLayoutEffect=createUpdateEffect(useIsomorphicLayoutEffect$2),ImageIcon=()=>React.createElement("svg",{viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M41.396 6.234c1.923 0 3.487 1.574 3.487 3.505v29.14c0 1.937-1.568 3.51-3.491 3.51H6.604c-1.923 0-3.487-1.573-3.487-3.51V9.745c0-1.936 1.564-3.51 3.487-3.51Zm0 2.847H6.604c-.355 0-.654.3-.654.658V34.9l5.989-8.707a2.373 2.373 0 0 1 1.801-1.005 2.405 2.405 0 0 1 1.933.752l4.182 4.525 7.58-11.005a2.374 2.374 0 0 1 1.96-1.01c.79 0 1.532.38 1.966 1.01L42.05 34.89V9.74a.664.664 0 0 0-.654-.658Zm-28.305 2.763a3.119 3.119 0 0 1 3.117 3.117 3.119 3.119 0 0 1-3.117 3.117 3.122 3.122 0 0 1-3.117-3.117 3.119 3.119 0 0 1 3.117-3.117Z",fill:"#DBDBDB",fillRule:"nonzero"})),BrokenImageIcon=()=>React.createElement("svg",{viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M19.233 6.233 17.42 9.08l-10.817.001a.665.665 0 0 0-.647.562l-.007.096V34.9l5.989-8.707a2.373 2.373 0 0 1 1.801-1.005 2.415 2.415 0 0 1 1.807.625l.126.127 4.182 4.525 2.267-3.292 5.461 7.841-4.065 7.375H6.604c-1.86 0-3.382-1.47-3.482-3.317l-.005-.192V9.744c0-1.872 1.461-3.405 3.296-3.505l.19-.005h12.63Zm22.163 0c1.86 0 3.382 1.472 3.482 3.314l.005.192v29.14a3.507 3.507 0 0 1-3.3 3.505l-.191.006H27.789l3.63-6.587.06-.119a1.87 1.87 0 0 0-.163-1.853l-6.928-9.949 3.047-4.422a2.374 2.374 0 0 1 1.96-1.01 2.4 2.4 0 0 1 1.86.87l.106.14L42.05 34.89V9.74a.664.664 0 0 0-.654-.658H21.855l1.812-2.848h17.73Zm-28.305 5.611c.794 0 1.52.298 2.07.788l-.843 1.325-.067.114a1.87 1.87 0 0 0 .11 1.959l.848 1.217c-.556.515-1.3.83-2.118.83a3.122 3.122 0 0 1-3.117-3.116 3.119 3.119 0 0 1 3.117-3.117Z",fill:"#DBDBDB",fillRule:"nonzero"})),classPrefix$z="adm-image",defaultProps$I={fit:"fill",placeholder:React.createElement("div",{className:"".concat(classPrefix$z,"-tip")},React.createElement(ImageIcon,null)),fallback:React.createElement("div",{className:"".concat(classPrefix$z,"-tip")},React.createElement(BrokenImageIcon,null)),lazy:!1,draggable:!1},Image$1=staged_1((e=>{const t=mergeProps(defaultProps$I,e),[r,n]=reactExports.useState(!1),[o,i]=reactExports.useState(!1),a=reactExports.useRef(null),s=reactExports.useRef(null);let l=t.src,c=t.srcSet;const[u,d]=reactExports.useState(!t.lazy);l=u?t.src:void 0,c=u?t.srcSet:void 0,useIsomorphicUpdateLayoutEffect((()=>{n(!1),i(!1)}),[l]),reactExports.useEffect((()=>{var e;(null===(e=s.current)||void 0===e?void 0:e.complete)&&n(!0)}),[]);const h={};return t.width&&(h["--width"]=toCSSLength(t.width),h.width=toCSSLength(t.width)),t.height&&(h["--height"]=toCSSLength(t.height),h.height=toCSSLength(t.height)),withNativeProps(t,React.createElement("div",{ref:a,className:classPrefix$z,style:h,onClick:t.onContainerClick},t.lazy&&!u&&React.createElement(LazyDetector,{onActive:()=>{d(!0)}}),function(){if(o)return React.createElement(React.Fragment,null,t.fallback);const e=React.createElement("img",{ref:s,id:t.id,className:"".concat(classPrefix$z,"-img"),src:l,alt:t.alt,onClick:t.onClick,onLoad:e=>{var r;n(!0),null===(r=t.onLoad)||void 0===r||r.call(t,e)},onError:e=>{var r;i(!0),null===(r=t.onError)||void 0===r||r.call(t,e)},style:{objectFit:t.fit,display:r?"block":"none"},crossOrigin:t.crossOrigin,decoding:t.decoding,loading:t.loading,referrerPolicy:t.referrerPolicy,sizes:t.sizes,srcSet:c,useMap:t.useMap,draggable:t.draggable});return React.createElement(React.Fragment,null,!r&&t.placeholder,e)}()))})),classPrefix$y="adm-dot-loading",colorRecord$1={default:"var(--adm-color-weak)",primary:"var(--adm-color-primary)",white:"var(--adm-color-white)"},defaultProps$H={color:"default"},DotLoading$1=reactExports.memo((e=>{var t;const r=mergeProps(defaultProps$H,e);return withNativeProps(r,React.createElement("div",{style:{color:null!==(t=colorRecord$1[r.color])&&void 0!==t?t:r.color},className:classNames$1("adm-loading",classPrefix$y)},React.createElement("svg",{height:"1em",viewBox:"0 0 100 40",style:{verticalAlign:"-0.125em"}},React.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},React.createElement("g",{transform:"translate(-100.000000, -71.000000)"},React.createElement("g",{transform:"translate(95.000000, 71.000000)"},React.createElement("g",{transform:"translate(5.000000, 0.000000)"},[0,1,2].map((e=>React.createElement("rect",{key:e,fill:"currentColor",x:20+26*e,y:"16",width:"8",height:"8",rx:"2"},React.createElement("animate",{attributeName:"y",from:"16",to:"16",dur:"2s",begin:"".concat(.2*e,"s"),repeatCount:"indefinite",values:"16; 6; 26; 16; 16",keyTimes:"0; 0.1; 0.3; 0.4; 1"})))))))))))}));function isPromise(e){return!!e&&"object"==typeof e&&"function"==typeof e.then}function isIOS(){return!!canUseDom&&/ios|iphone|ipad|ipod/.test(navigator.userAgent.toLowerCase())}const classPrefix$x="adm-button",defaultProps$G={color:"default",fill:"solid",block:!1,loading:!1,loadingIcon:React.createElement(DotLoading$1,{color:"currentColor"}),type:"button",shape:"default",size:"middle"},Button$2=reactExports.forwardRef(((e,t)=>{const r=mergeProps(defaultProps$G,e),[n,o]=reactExports.useState(!1),i=reactExports.useRef(null),a="auto"===r.loading?n:r.loading,s=r.disabled||a;reactExports.useImperativeHandle(t,(()=>({get nativeElement(){return i.current}})));return withNativeProps(r,React.createElement("button",{ref:i,type:r.type,onClick:e=>__awaiter(void 0,void 0,void 0,(function*(){if(!r.onClick)return;const t=r.onClick(e);if(isPromise(t))try{o(!0),yield t,o(!1)}catch(n){throw o(!1),n}})),className:classNames$1(classPrefix$x,r.color?"".concat(classPrefix$x,"-").concat(r.color):null,{["".concat(classPrefix$x,"-block")]:r.block,["".concat(classPrefix$x,"-disabled")]:s,["".concat(classPrefix$x,"-fill-outline")]:"outline"===r.fill,["".concat(classPrefix$x,"-fill-none")]:"none"===r.fill,["".concat(classPrefix$x,"-mini")]:"mini"===r.size,["".concat(classPrefix$x,"-small")]:"small"===r.size,["".concat(classPrefix$x,"-large")]:"large"===r.size,["".concat(classPrefix$x,"-loading")]:a},"".concat(classPrefix$x,"-shape-").concat(r.shape)),disabled:s,onMouseDown:r.onMouseDown,onMouseUp:r.onMouseUp,onTouchStart:r.onTouchStart,onTouchEnd:r.onTouchEnd},a?React.createElement("div",{className:"".concat(classPrefix$x,"-loading-wrapper")},r.loadingIcon,r.loadingText):React.createElement("span",null,r.children)))})),ArrowLeft=()=>React.createElement("svg",{height:"1em",viewBox:"0 0 44 44"},React.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},React.createElement("g",{transform:"translate(-100.000000, -22.000000)"},React.createElement("g",{transform:"translate(100.000000, 22.000000)"},React.createElement("rect",{x:"0",y:"0",width:"44",height:"44"}),React.createElement("g",{transform:"translate(12.000000, 4.000000)",fill:"currentColor",fillRule:"nonzero"},React.createElement("path",{d:"M19.4833058,2.71985611 L3.53051139,17.0699744 C3.0173831,17.5315665 2.97522952,18.3220903 3.43630803,18.8357433 L3.43630796,18.8357432 C3.46601289,18.8688164 3.49745845,18.9002801 3.53051133,18.9300007 L19.4833057,33.2801611 C20.1234001,33.8559077 20.1759552,34.8420707 19.6007967,35.4827774 C19.0256382,36.1235263 18.0404824,36.1761351 17.400388,35.6003885 L1.44759367,21.2502703 L1.4475933,21.25027 C1.33208743,21.1463692 1.22220259,21.036372 1.11840792,20.920748 C-0.49302969,19.1256817 -0.345639536,16.3628317 1.4475933,14.7497465 L17.4003877,0.399628282 C18.0404821,-0.176160428 19.0256378,-0.123509422 19.6007963,0.517239417 C20.1759548,1.1579461 20.1233997,2.14410915 19.4833053,2.7198557 L19.4833058,2.71985611 Z"})))))),ArrowLeftDouble=()=>React.createElement("svg",{height:"1em",viewBox:"0 0 44 44"},React.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},React.createElement("g",{transform:"translate(-24.000000, -22.000000)"},React.createElement("g",{transform:"translate(24.000000, 22.000000)"},React.createElement("rect",{x:"0",y:"0",width:"44",height:"44"}),React.createElement("g",{transform:"translate(7.000000, 4.000000)",fill:"currentColor",fillRule:"nonzero"},React.createElement("path",{d:"M19.4833058,2.71985611 L3.53051139,17.0699744 C3.0173831,17.5315665 2.97522952,18.3220903 3.43630803,18.8357433 L3.43630796,18.8357432 C3.46601289,18.8688164 3.49745845,18.9002801 3.53051133,18.9300007 L19.4833057,33.2801611 C20.1234001,33.8559077 20.1759552,34.8420707 19.6007967,35.4827774 C19.0256382,36.1235263 18.0404824,36.1761351 17.400388,35.6003885 L1.44759367,21.2502703 L1.4475933,21.25027 C1.33208743,21.1463692 1.22220259,21.036372 1.11840792,20.920748 C-0.49302969,19.1256817 -0.345639536,16.3628317 1.4475933,14.7497465 L17.4003877,0.399628282 C18.0404821,-0.176160428 19.0256378,-0.123509422 19.6007963,0.517239417 C20.1759548,1.1579461 20.1233997,2.14410915 19.4833053,2.7198557 L19.4833058,2.71985611 Z"}),React.createElement("path",{d:"M19.5305114,17.0699744 C19.0173831,17.5315665 18.9752295,18.3220903 19.436308,18.8357433 C19.4660129,18.8688164 19.4974585,18.9002801 19.5305113,18.9300007 L29.4833057,27.2801611 C30.1234001,27.8559077 30.1759552,28.8420707 29.6007967,29.4827774 C29.0256382,30.1235263 28.0404824,30.1761351 27.400388,29.6003885 L17.4475937,21.2502703 C17.3320874,21.1463692 17.2222026,21.036372 17.1184079,20.920748 C15.5069703,19.1256817 15.6543605,16.3628317 17.4475933,14.7497465 L27.4003877,6.39962828 C28.0404821,5.82383957 29.0256378,5.87649058 29.6007963,6.51723942 C30.1759548,7.1579461 30.1233997,8.14410915 29.4833053,8.7198557 L19.5305114,17.0699744 Z"}))))));var isoWeek$1={exports:{}},e3;isoWeek$1.exports=(e3="day",function(e,t,r){var n=function(e){return e.add(4-e.isoWeekday(),e3)},o=t.prototype;o.isoWeekYear=function(){return n(this).year()},o.isoWeek=function(e){if(!this.$utils().u(e))return this.add(7*(e-this.isoWeek()),e3);var t,o,i,a=n(this),s=(t=this.isoWeekYear(),i=4-(o=(this.$u?r.utc:r)().year(t).startOf("year")).isoWeekday(),o.isoWeekday()>4&&(i+=7),o.add(i,e3));return a.diff(s,"week")+1},o.isoWeekday=function(e){return this.$utils().u(e)?this.day()||7:this.day(this.day()%7?e:e-7)};var i=o.startOf;o.startOf=function(e,t){var r=this.$utils(),n=!!r.u(t)||t;return"isoweek"===r.p(e)?n?this.date(this.date()-(this.isoWeekday()-1)).startOf("day"):this.date(this.date()-1-(this.isoWeekday()-1)+7).endOf("day"):i.bind(this)(e,t)}});var isoWeekExports=isoWeek$1.exports;const isoWeek=getDefaultExportFromCjs$1(isoWeekExports);function usePropsValue(e){const{value:t,defaultValue:r,onChange:n}=e,o=useUpdate(),i=reactExports.useRef(void 0!==t?t:r);void 0!==t&&(i.current=t);const a=useMemoizedFn$1(((e,t=!1)=>{const r="function"==typeof e?e(i.current):e;if(t||r!==i.current)return i.current=r,o(),null==n?void 0:n(r)}));return[i.current,a]}function convertValueToRange(e,t){return void 0===e||null===t?null:Array.isArray(t)?t:[t,t]}function convertPageToDayjs(e){return dayjs().year(e.year).month(e.month-1).date(1)}dayjs.extend(isoWeek);const classPrefix$w="adm-calendar",defaultProps$F={weekStartsOn:"Sunday",defaultValue:null,allowClear:!0,prevMonthButton:React.createElement(ArrowLeft,null),prevYearButton:React.createElement(ArrowLeftDouble,null),nextMonthButton:React.createElement(ArrowLeft,null),nextYearButton:React.createElement(ArrowLeftDouble,null)},Calendar$1=reactExports.forwardRef(((e,t)=>{const r=dayjs(),n=mergeProps(defaultProps$F,e),{locale:o}=useConfig$1(),i=[...o.Calendar.markItems];if("Sunday"===n.weekStartsOn){const e=i.pop();e&&i.unshift(e)}const[a,s]=usePropsValue({value:void 0===n.value?void 0:convertValueToRange(n.selectionMode,n.value),defaultValue:convertValueToRange(n.selectionMode,n.defaultValue),onChange:e=>{var t,r;"single"===n.selectionMode?null===(t=n.onChange)||void 0===t||t.call(n,e?e[0]:null):"range"===n.selectionMode&&(null===(r=n.onChange)||void 0===r||r.call(n,e))}}),[l,c]=reactExports.useState(!1),[u,d]=reactExports.useState((()=>dayjs(a?a[0]:r).date(1)));useUpdateEffect((()=>{var e;null===(e=n.onPageChange)||void 0===e||e.call(n,u.year(),u.month()+1)}),[u]),reactExports.useImperativeHandle(t,(()=>({jumpTo:e=>{let t;t="function"==typeof e?e({year:u.year(),month:u.month()+1}):e,d(convertPageToDayjs(t))},jumpToToday:()=>{d(dayjs().date(1))}})));const h=(e,t,r)=>{const o=u[e](t,r);if("subtract"===e&&n.minPage){const e=convertPageToDayjs(n.minPage);if(o.isBefore(e,r))return}if("add"===e&&n.maxPage){const e=convertPageToDayjs(n.maxPage);if(o.isAfter(e,r))return}d(o)},p=React.createElement("div",{className:"".concat(classPrefix$w,"-header")},React.createElement("a",{className:"".concat(classPrefix$w,"-arrow-button ").concat(classPrefix$w,"-arrow-button-year"),onClick:()=>{h("subtract",1,"year")}},n.prevYearButton),React.createElement("a",{className:"".concat(classPrefix$w,"-arrow-button ").concat(classPrefix$w,"-arrow-button-month"),onClick:()=>{h("subtract",1,"month")}},n.prevMonthButton),React.createElement("div",{className:"".concat(classPrefix$w,"-title")},o.Calendar.renderYearAndMonth(u.year(),u.month()+1)),React.createElement("a",{className:classNames$1("".concat(classPrefix$w,"-arrow-button"),"".concat(classPrefix$w,"-arrow-button-right"),"".concat(classPrefix$w,"-arrow-button-right-month")),onClick:()=>{h("add",1,"month")}},n.nextMonthButton),React.createElement("a",{className:classNames$1("".concat(classPrefix$w,"-arrow-button"),"".concat(classPrefix$w,"-arrow-button-right"),"".concat(classPrefix$w,"-arrow-button-right-year")),onClick:()=>{h("add",1,"year")}},n.nextYearButton)),f=reactExports.useMemo((()=>n.max&&dayjs(n.max)),[n.max]),g=reactExports.useMemo((()=>n.min&&dayjs(n.min)),[n.min]);const m=React.createElement("div",{className:"".concat(classPrefix$w,"-cells")},function(){var e;const t=[];let o=u.subtract(u.isoWeekday(),"day");for("Monday"===n.weekStartsOn&&(o=o.add(1,"day"));t.length<42;){const i=o;let h=!1,p=!1,m=!1,y=!1,v=!1;if(a){const[e,r]=a;p=i.isSame(e,"day"),m=i.isSame(r,"day"),h=p||m||i.isAfter(e,"day")&&i.isBefore(r,"day"),h&&(y=(t.length%7==0||i.isSame(i.startOf("month"),"day"))&&!p,v=(t.length%7==6||i.isSame(i.endOf("month"),"day"))&&!m)}const _=i.month()===u.month(),b=n.shouldDisableDate?n.shouldDisableDate(i.toDate()):f&&i.isAfter(f,"day")||g&&i.isBefore(g,"day");t.push(React.createElement("div",{key:i.valueOf(),className:classNames$1("".concat(classPrefix$w,"-cell"),(b||!_)&&"".concat(classPrefix$w,"-cell-disabled"),_&&{["".concat(classPrefix$w,"-cell-today")]:i.isSame(r,"day"),["".concat(classPrefix$w,"-cell-selected")]:h,["".concat(classPrefix$w,"-cell-selected-begin")]:p,["".concat(classPrefix$w,"-cell-selected-end")]:m,["".concat(classPrefix$w,"-cell-selected-row-begin")]:y,["".concat(classPrefix$w,"-cell-selected-row-end")]:v}),onClick:()=>{if(!n.selectionMode)return;if(b)return;const e=i.toDate();function t(){if(!n.allowClear)return!1;if(!a)return!1;const[e,t]=a;return i.isSame(e,"date")&&i.isSame(t,"day")}if(_||d(i.clone().date(1)),"single"===n.selectionMode){if(n.allowClear&&t())return void s(null);s([e,e])}else if("range"===n.selectionMode){if(!a)return s([e,e]),void c(!0);if(t())return s(null),void c(!1);if(l){const t=a[0];s(t>e?[e,t]:[t,e]),c(!1)}else s([e,e]),c(!0)}}},React.createElement("div",{className:"".concat(classPrefix$w,"-cell-top")},n.renderDate?n.renderDate(i.toDate()):i.date()),React.createElement("div",{className:"".concat(classPrefix$w,"-cell-bottom")},null===(e=n.renderLabel)||void 0===e?void 0:e.call(n,i.toDate())))),o=o.add(1,"day")}return t}()),y=React.createElement("div",{className:"".concat(classPrefix$w,"-mark")},i.map(((e,t)=>React.createElement("div",{key:t,className:"".concat(classPrefix$w,"-mark-cell")},e))));return withNativeProps(n,React.createElement("div",{className:classPrefix$w},p,y,m))}));function useResizeEffect(e,t){const r=useMemoizedFn$1(e);useIsomorphicLayoutEffect$2((()=>{const e=t.current;if(e){if(window.ResizeObserver){let t;const n=new ResizeObserver((()=>{t=window.requestAnimationFrame((()=>r(e)))}));return n.observe(e),()=>{window.cancelAnimationFrame(t),n.disconnect()}}r(e)}}),[t])}function bound(e,t,r){let n=e;return void 0!==t&&(n=Math.max(e,t)),void 0!==r&&(n=Math.min(n,r)),n}function rubberband(e,t,r){return e*t*r/(t+r*e)}function rubberbandIfOutOfBounds(e,t,r,n,o=.15){return 0===o?bound(e,t,r):e<t?-rubberband(t-e,n,o)+t:e>r?+rubberband(e-r,n,o)+r:e}function measureCSSLength(e){if(null==e||""===e)return 0;const t=e.trim();return t.endsWith("px")?parseFloat(t):t.endsWith("rem")?parseFloat(t)*parseFloat(window.getComputedStyle(document.documentElement).fontSize):t.endsWith("vw")?parseFloat(t)*window.innerWidth/100:0}function withCache(e){let t=null;return()=>(null===t&&(t=e()),t)}const defaultRenderLabel=e=>e.label;let reduced=!1;const subscribers=new Set;function isMotionReduced(){return reduced}function subscribe(e){return subscribers.add(e),()=>{subscribers.delete(e)}}function useMotionReduced(){return shimExports.useSyncExternalStore(subscribe,isMotionReduced,isMotionReduced)}const classPrefix$v="adm-spin-loading",colorRecord={default:"var(--adm-color-weak)",primary:"var(--adm-color-primary)",white:"var(--adm-color-white)"},defaultProps$E={color:"default"},circumference=94.2477796076937,SpinLoading=reactExports.memo((e=>{var t;const r=mergeProps(defaultProps$E,e),n=useMotionReduced(),{percent:o}=useSpring$1({cancel:n,loop:{reverse:!0},from:{percent:80},to:{percent:30},config:{duration:1200}});return withNativeProps(r,React.createElement(animated$1.div,{className:classPrefix$v,style:{"--color":null!==(t=colorRecord[r.color])&&void 0!==t?t:r.color,"--percent":o}},React.createElement("svg",{className:"".concat(classPrefix$v,"-svg"),viewBox:"0 0 32 32"},React.createElement(animated$1.circle,{className:"".concat(classPrefix$v,"-fill"),fill:"transparent",strokeWidth:"2",strokeDasharray:circumference,strokeDashoffset:o,strokeLinecap:"square",r:15,cx:16,cy:16}))))})),defaultProps$D=Object.assign(Object.assign({},defaultPopupBaseProps),{getContainer:null}),CenterPopup$1=e=>{const t=mergeProps(defaultProps$D,e),r=useUnmountedRef(),n=useSpring$1({scale:t.visible?1:.8,opacity:t.visible?1:0,config:{mass:1.2,tension:200,friction:25,clamp:!0},onRest:()=>{var e,n;r.current||(i(t.visible),t.visible?null===(e=t.afterShow)||void 0===e||e.call(t):null===(n=t.afterClose)||void 0===n||n.call(t))}}),[o,i]=reactExports.useState(t.visible);useIsomorphicLayoutEffect$2((()=>{t.visible&&i(!0)}),[t.visible]);const a=reactExports.useRef(null);useLockScroll(a,t.disableBodyScroll&&o);const s=useInnerVisible(o&&t.visible),l=React.createElement("div",{className:classNames$1("adm-center-popup-body",t.bodyClassName),style:t.bodyStyle},t.children),c=withStopPropagation(t.stopPropagation,withNativeProps(t,React.createElement("div",{className:"adm-center-popup",style:{display:o?void 0:"none",pointerEvents:o?void 0:"none"}},t.mask&&React.createElement(Mask,{visible:s,forceRender:t.forceRender,destroyOnClose:t.destroyOnClose,onMaskClick:e=>{var r,n;null===(r=t.onMaskClick)||void 0===r||r.call(t,e),t.closeOnMaskClick&&(null===(n=t.onClose)||void 0===n||n.call(t))},style:t.maskStyle,className:classNames$1("adm-center-popup-mask",t.maskClassName),disableBodyScroll:!1,stopPropagation:t.stopPropagation}),React.createElement("div",{className:"adm-center-popup-wrap",role:t.role,"aria-label":t["aria-label"]},React.createElement(animated$1.div,{style:n,ref:a},t.showCloseButton&&React.createElement("a",{className:classNames$1("adm-center-popup-close","adm-plain-anchor"),onClick:()=>{var e;null===(e=t.onClose)||void 0===e||e.call(t)}},React.createElement(CloseOutline,null)),l)))));return React.createElement(ShouldRender,{active:o,forceRender:t.forceRender,destroyOnClose:t.destroyOnClose},renderToContainer(t.getContainer,c))},CheckboxGroupContext=reactExports.createContext(null),defaultProps$C={disabled:!1,defaultValue:[]},Group$3=e=>{const t=mergeProps(defaultProps$C,e),[r,n]=usePropsValue(t);return React.createElement(CheckboxGroupContext.Provider,{value:{value:r,disabled:t.disabled,check:e=>{n([...r,e])},uncheck:e=>{n(r.filter((t=>t!==e)))}}},t.children)},CheckIcon=reactExports.memo((e=>withNativeProps(e,React.createElement("svg",{viewBox:"0 0 40 40"},React.createElement("path",{d:"M31.5541766,15 L28.0892433,15 L28.0892434,15 C27.971052,15 27.8576674,15.044522 27.7740471,15.1239792 L18.2724722,24.1625319 L13.2248725,19.3630279 L13.2248725,19.3630279 C13.1417074,19.2834412 13.0287551,19.2384807 12.9107898,19.2380079 L9.44474455,19.2380079 L9.44474454,19.2380079 C9.19869815,19.2384085 8.99957935,19.4284738 9,19.66253 C9,19.7747587 9.04719253,19.8823283 9.13066188,19.9616418 L17.0907466,27.5338228 C17.4170809,27.8442545 17.8447695,28 18.2713393,28 L18.2980697,28 C18.7168464,27.993643 19.133396,27.8378975 19.4530492,27.5338228 L31.8693384,15.7236361 L31.8693384,15.7236361 C32.0434167,15.5582251 32.0435739,15.2898919 31.8696892,15.1242941 C31.7860402,15.0446329 31.6725052,15 31.5541421,15 L31.5541766,15 Z",fill:"currentColor"}))))),IndeterminateIcon=reactExports.memo((e=>withNativeProps(e,React.createElement("svg",{viewBox:"0 0 40 40"},React.createElement("path",{d:"M20,9 C26.0752953,9 31,13.9247047 31,20 C31,26.0752953 26.0752953,31 20,31 C13.9247047,31 9,26.0752953 9,20 C9,13.9247047 13.9247047,9 20,9 Z",fill:"currentColor"}))))),NativeInput=e=>{const t=reactExports.useRef(null),r=useMemoizedFn$1((t=>{t.stopPropagation(),t.stopImmediatePropagation();const r=t.target.checked;r!==e.checked&&e.onChange(r)}));return reactExports.useEffect((()=>{if(e.disabled)return;if(!t.current)return;const n=t.current;return n.addEventListener("click",r),()=>{n.removeEventListener("click",r)}}),[e.disabled,e.onChange]),React.createElement("input",{ref:t,type:e.type,checked:e.checked,onChange:()=>{},disabled:e.disabled,id:e.id})},classPrefix$u="adm-checkbox",defaultProps$B={defaultChecked:!1,indeterminate:!1},Checkbox$3=reactExports.forwardRef(((e,t)=>{const r=reactExports.useContext(CheckboxGroupContext),n=mergeProps(defaultProps$B,e);let[o,i]=usePropsValue({value:n.checked,defaultValue:n.defaultChecked,onChange:n.onChange}),a=n.disabled;const{value:s}=n;r&&void 0!==s&&(o=r.value.includes(s),i=e=>{var t;e?r.check(s):r.uncheck(s),null===(t=n.onChange)||void 0===t||t.call(n,e)},a=a||r.disabled),reactExports.useImperativeHandle(t,(()=>({check:()=>{i(!0)},uncheck:()=>{i(!1)},toggle:()=>{i(!o)}})));return withNativeProps(n,React.createElement("label",{className:classNames$1(classPrefix$u,{["".concat(classPrefix$u,"-checked")]:o&&!n.indeterminate,["".concat(classPrefix$u,"-indeterminate")]:n.indeterminate,["".concat(classPrefix$u,"-disabled")]:a,["".concat(classPrefix$u,"-block")]:n.block})},React.createElement(NativeInput,{type:"checkbox",checked:o,onChange:i,disabled:a,id:n.id}),n.icon?React.createElement("div",{className:"".concat(classPrefix$u,"-custom-icon")},n.icon(o,n.indeterminate)):React.createElement("div",{className:"".concat(classPrefix$u,"-icon")},n.indeterminate?React.createElement(IndeterminateIcon,null):o&&React.createElement(CheckIcon,null)),n.children&&React.createElement("div",{className:"".concat(classPrefix$u,"-content")},n.children)))})),Checkbox$2=attachPropertiesToComponent(Checkbox$3,{Group:Group$3});var isLeapYear$2={exports:{}};isLeapYear$2.exports=function(e,t){t.prototype.isLeapYear=function(){return this.$y%4==0&&this.$y%100!=0||this.$y%400==0}};var isLeapYearExports=isLeapYear$2.exports;const isLeapYear$1=getDefaultExportFromCjs$1(isLeapYearExports),DialogActionButton=e=>{const{action:t}=e;return withNativeProps(e.action,React.createElement(Button$2,{key:t.key,onClick:e.onAction,className:classNames$1("adm-dialog-button",{"adm-dialog-button-bold":t.bold}),fill:"none",shape:"rectangular",block:!0,color:t.danger?"danger":"primary",loading:"auto",disabled:t.disabled},t.text))},defaultProps$A={actions:[],closeOnAction:!1,closeOnMaskClick:!1,getContainer:null},Dialog=e=>{const t=mergeProps(defaultProps$A,e),r=React.createElement(React.Fragment,null,!!t.image&&React.createElement("div",{className:cls("image-container")},React.createElement(Image$1,{src:t.image,alt:"dialog header image",width:"100%"})),!!t.header&&React.createElement("div",{className:cls("header")},React.createElement(AutoCenter,null,t.header)),!!t.title&&React.createElement("div",{className:cls("title")},t.title),React.createElement("div",{className:classNames$1(cls("content"),!t.content&&cls("content-empty"))},"string"==typeof t.content?React.createElement(AutoCenter,null,t.content):t.content),React.createElement("div",{className:cls("footer")},t.actions.map(((e,r)=>{const n=Array.isArray(e)?e:[e];return React.createElement("div",{className:cls("action-row"),key:r},n.map(((e,r)=>React.createElement(DialogActionButton,{key:e.key,action:e,onAction:()=>__awaiter(void 0,void 0,void 0,(function*(){var n,o,i;yield Promise.all([null===(n=e.onClick)||void 0===n?void 0:n.call(e),null===(o=t.onAction)||void 0===o?void 0:o.call(t,e,r)]),t.closeOnAction&&(null===(i=t.onClose)||void 0===i||i.call(t))}))}))))}))));return React.createElement(CenterPopup$1,{className:classNames$1(cls(),t.className),style:t.style,afterClose:t.afterClose,afterShow:t.afterShow,onMaskClick:t.closeOnMaskClick?()=>{var e;null===(e=t.onClose)||void 0===e||e.call(t)}:void 0,visible:t.visible,getContainer:t.getContainer,bodyStyle:t.bodyStyle,bodyClassName:classNames$1(cls("body"),t.image&&cls("with-image"),t.bodyClassName),maskStyle:t.maskStyle,maskClassName:t.maskClassName,stopPropagation:t.stopPropagation,disableBodyScroll:t.disableBodyScroll,destroyOnClose:t.destroyOnClose,forceRender:t.forceRender,role:"dialog","aria-label":t["aria-label"]},r)};function cls(e=""){return"adm-dialog"+(e&&"-")+e}const closeFnSet$1=new Set;function show$3(e){const t=renderImperatively(React.createElement(Dialog,Object.assign({},e,{afterClose:()=>{var r;closeFnSet$1.delete(t.close),null===(r=e.afterClose)||void 0===r||r.call(e)}})));return closeFnSet$1.add(t.close),t}function alert$2(e){const t=mergeProps({confirmText:getDefaultConfig().locale.Dialog.ok},e);return new Promise((e=>{show$3(Object.assign(Object.assign({},t),{closeOnAction:!0,actions:[{key:"confirm",text:t.confirmText}],onAction:t.onConfirm,onClose:()=>{var r;null===(r=t.onClose)||void 0===r||r.call(t),e()}}))}))}const defaultProps$z={confirmText:"确认",cancelText:"取消"};function confirm$1(e){const{locale:t}=getDefaultConfig(),r=mergeProps(defaultProps$z,{confirmText:t.common.confirm,cancelText:t.common.cancel},e);return new Promise((e=>{show$3(Object.assign(Object.assign({},r),{closeOnAction:!0,onClose:()=>{var t;null===(t=r.onClose)||void 0===t||t.call(r),e(!1)},actions:[[{key:"cancel",text:r.cancelText,onClick:()=>__awaiter(this,void 0,void 0,(function*(){var t;yield null===(t=r.onCancel)||void 0===t?void 0:t.call(r),e(!1)}))},{key:"confirm",text:r.confirmText,bold:!0,onClick:()=>__awaiter(this,void 0,void 0,(function*(){var t;yield null===(t=r.onConfirm)||void 0===t?void 0:t.call(r),e(!0)}))}]]}))}))}function clear$1(){closeFnSet$1.forEach((e=>{e()}))}const Alert$1=attachPropertiesToComponent(Dialog,{show:show$3,alert:alert$2,confirm:confirm$1,clear:clear$1});var i$2,i2;i2=i$2||(i$2={}),i2[i2.HIGH_SURROGATE_START=55296]="HIGH_SURROGATE_START",i2[i2.HIGH_SURROGATE_END=56319]="HIGH_SURROGATE_END",i2[i2.LOW_SURROGATE_START=56320]="LOW_SURROGATE_START",i2[i2.REGIONAL_INDICATOR_START=127462]="REGIONAL_INDICATOR_START",i2[i2.REGIONAL_INDICATOR_END=127487]="REGIONAL_INDICATOR_END",i2[i2.FITZPATRICK_MODIFIER_START=127995]="FITZPATRICK_MODIFIER_START",i2[i2.FITZPATRICK_MODIFIER_END=127999]="FITZPATRICK_MODIFIER_END",i2[i2.VARIATION_MODIFIER_START=65024]="VARIATION_MODIFIER_START",i2[i2.VARIATION_MODIFIER_END=65039]="VARIATION_MODIFIER_END",i2[i2.DIACRITICAL_MARKS_START=8400]="DIACRITICAL_MARKS_START",i2[i2.DIACRITICAL_MARKS_END=8447]="DIACRITICAL_MARKS_END",i2[i2.SUBDIVISION_INDICATOR_START=127988]="SUBDIVISION_INDICATOR_START",i2[i2.TAGS_START=917504]="TAGS_START",i2[i2.TAGS_END=917631]="TAGS_END",i2[i2.ZWJ=8205]="ZWJ";const e$2=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);var n$2;function runes(e){if("string"!=typeof e)throw new TypeError("string cannot be undefined or null");const t=[];let r=0,n=0;for(;r<e.length;)n+=nextUnits(r+n,e),isGrapheme(e[r+n])&&n++,isVariationSelector(e[r+n])&&n++,isDiacriticalMark(e[r+n])&&n++,isZeroWidthJoiner(e[r+n])?n++:(t.push(e.substring(r,r+n)),r+=n,n=0);return t}function nextUnits(e,t){const r=t[e];if(!isFirstOfSurrogatePair(r)||e===t.length-1)return 1;const n=r+t[e+1];let o=t.substring(e+2,e+5);return isRegionalIndicator(n)&&isRegionalIndicator(o)?4:isSubdivisionFlag(n)&&isSupplementarySpecialpurposePlane(o)?t.slice(e).indexOf(String.fromCodePoint(917631))+2:isFitzpatrickModifier(o)?4:2}function isFirstOfSurrogatePair(e){return e&&betweenInclusive(e[0].charCodeAt(0),55296,56319)}function isRegionalIndicator(e){return betweenInclusive(codePointFromSurrogatePair(e),127462,127487)}function isSubdivisionFlag(e){return betweenInclusive(codePointFromSurrogatePair(e),127988,127988)}function isFitzpatrickModifier(e){return betweenInclusive(codePointFromSurrogatePair(e),127995,127999)}function isVariationSelector(e){return"string"==typeof e&&betweenInclusive(e.charCodeAt(0),65024,65039)}function isDiacriticalMark(e){return"string"==typeof e&&betweenInclusive(e.charCodeAt(0),8400,8447)}function isSupplementarySpecialpurposePlane(e){const t=e.codePointAt(0);return"string"==typeof e&&"number"==typeof t&&betweenInclusive(t,917504,917631)}function isGrapheme(e){return"string"==typeof e&&e$2.includes(e.charCodeAt(0))}function isZeroWidthJoiner(e){return"string"==typeof e&&8205===e.charCodeAt(0)}function codePointFromSurrogatePair(e){return(e.charCodeAt(0)-55296<<10)+(e.charCodeAt(1)-56320)+65536}function betweenInclusive(e,t,r){return e>=t&&e<=r}!function(e){e[e.unit_1=1]="unit_1",e[e.unit_2=2]="unit_2",e[e.unit_4=4]="unit_4"}(n$2||(n$2={}));const classPrefix$t="adm-ellipsis",defaultProps$y={direction:"end",rows:1,expandText:"",content:"",collapseText:"",stopPropagationForActionButtons:[],onContentClick:()=>{},defaultExpanded:!1},Ellipsis=e=>{const t=mergeProps(defaultProps$y,e),r=reactExports.useRef(null),n=reactExports.useRef(null),o=reactExports.useRef(null),[i,a]=reactExports.useState({}),[s,l]=reactExports.useState(t.defaultExpanded),[c,u]=reactExports.useState(!1),d=reactExports.useMemo((()=>runes(t.content)),[t.content]);function h(e,t){return d.slice(e,t).join("")}function p(){var e,i;const l=r.current;if(!l)return;const c=l.style.display;l.style.display="block";const d=window.getComputedStyle(l),p=document.createElement("div");Array.prototype.slice.apply(d).forEach((e=>{p.style.setProperty(e,d.getPropertyValue(e))})),l.style.display=c,p.style.height="auto",p.style.minHeight="auto",p.style.maxHeight="auto",p.style.textOverflow="clip",p.style.whiteSpace="normal",p.style.webkitLineClamp="unset",p.style.display="block";const f=pxToNumber(d.lineHeight),g=Math.floor(f*(t.rows+.5)+pxToNumber(d.paddingTop)+pxToNumber(d.paddingBottom));if(p.innerText=t.content,document.body.appendChild(p),p.offsetHeight<=g)u(!1);else{let r=function(e,n){if(n-e<=1)return"end"===t.direction?{leading:h(0,e)+"..."}:{tailing:"..."+h(n,c)};const o=Math.round((e+n)/2);return"end"===t.direction?p.innerHTML=h(0,o)+"..."+m:p.innerHTML=m+"..."+h(o,c),p.offsetHeight<=g?"end"===t.direction?r(o,n):r(e,o):"end"===t.direction?r(e,o):r(o,n)},l=function(e,t){if(e[1]-e[0]<=1&&t[1]-t[0]<=1)return{leading:h(0,e[0])+"...",tailing:"..."+h(t[1],c)};const r=Math.floor((e[0]+e[1])/2),n=Math.ceil((t[0]+t[1])/2);return p.innerHTML=h(0,r)+"..."+m+"..."+h(n,c),p.offsetHeight<=g?l([r,e[1]],[t[0],n]):l([e[0],r],[n,t[1]])};u(!0);const c=t.content.length,d="string"==typeof t.collapseText?t.collapseText:null===(e=o.current)||void 0===e?void 0:e.innerHTML,f="string"==typeof t.expandText?t.expandText:null===(i=n.current)||void 0===i?void 0:i.innerHTML,m=s?d:f,y=Math.floor((0+c)/2),v="middle"===t.direction?l([0,y],[y,c]):r(0,c);a(v)}document.body.removeChild(p)}useResizeEffect(p,r),useIsomorphicLayoutEffect$2((()=>{p()}),[t.content,t.direction,t.rows,t.expandText,t.collapseText]);const f=c&&t.expandText?withStopPropagation(t.stopPropagationForActionButtons,React.createElement("a",{ref:n,onClick:()=>{l(!0)}},t.expandText)):null,g=c&&t.collapseText?withStopPropagation(t.stopPropagationForActionButtons,React.createElement("a",{ref:o,onClick:()=>{l(!1)}},t.collapseText)):null;return withNativeProps(t,React.createElement("div",{ref:r,className:classPrefix$t,onClick:e=>{e.target===e.currentTarget&&t.onContentClick(e)}},c?s?React.createElement(React.Fragment,null,t.content,g):React.createElement(React.Fragment,null,i.leading,f,i.tailing):t.content))};function pxToNumber(e){if(!e)return 0;const t=e.match(/^\d*(\.\d*)?/);return t?Number(t[0]):0}function _objectWithoutProperties(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _arrayWithHoles$1(e){if(Array.isArray(e))return e}function _nonIterableRest$1(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit$1(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t);else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(u){c=!0,o=u}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}function _slicedToArray$1(e,t){return _arrayWithHoles$1(e)||_iterableToArrayLimit$1(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest$1()}const sides=["top","right","bottom","left"],min$1=Math.min,max$3=Math.max,round$1=Math.round,floor=Math.floor,createCoords=e=>({x:e,y:e}),oppositeSideMap={left:"right",right:"left",bottom:"top",top:"bottom"},oppositeAlignmentMap={start:"end",end:"start"};function clamp$2(e,t,r){return max$3(e,min$1(t,r))}function evaluate(e,t){return"function"==typeof e?e(t):e}function getSide(e){return e.split("-")[0]}function getAlignment(e){return e.split("-")[1]}function getOppositeAxis(e){return"x"===e?"y":"x"}function getAxisLength(e){return"y"===e?"height":"width"}function getSideAxis(e){return["top","bottom"].includes(getSide(e))?"y":"x"}function getAlignmentAxis(e){return getOppositeAxis(getSideAxis(e))}function getAlignmentSides(e,t,r){void 0===r&&(r=!1);const n=getAlignment(e),o=getAlignmentAxis(e),i=getAxisLength(o);let a="x"===o?n===(r?"end":"start")?"right":"left":"start"===n?"bottom":"top";return t.reference[i]>t.floating[i]&&(a=getOppositePlacement(a)),[a,getOppositePlacement(a)]}function getExpandedPlacements(e){const t=getOppositePlacement(e);return[getOppositeAlignmentPlacement(e),t,getOppositeAlignmentPlacement(t)]}function getOppositeAlignmentPlacement(e){return e.replace(/start|end/g,(e=>oppositeAlignmentMap[e]))}function getSideList(e,t,r){const n=["left","right"],o=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return r?t?o:n:t?n:o;case"left":case"right":return t?i:a;default:return[]}}function getOppositeAxisPlacements(e,t,r,n){const o=getAlignment(e);let i=getSideList(getSide(e),"start"===r,n);return o&&(i=i.map((e=>e+"-"+o)),t&&(i=i.concat(i.map(getOppositeAlignmentPlacement)))),i}function getOppositePlacement(e){return e.replace(/left|right|bottom|top/g,(e=>oppositeSideMap[e]))}function expandPaddingObject(e){return{top:0,right:0,bottom:0,left:0,...e}}function getPaddingObject(e){return"number"!=typeof e?expandPaddingObject(e):{top:e,right:e,bottom:e,left:e}}function rectToClientRect(e){const{x:t,y:r,width:n,height:o}=e;return{width:n,height:o,top:r,left:t,right:t+n,bottom:r+o,x:t,y:r}}function computeCoordsFromPlacement(e,t,r){let{reference:n,floating:o}=e;const i=getSideAxis(t),a=getAlignmentAxis(t),s=getAxisLength(a),l=getSide(t),c="y"===i,u=n.x+n.width/2-o.width/2,d=n.y+n.height/2-o.height/2,h=n[s]/2-o[s]/2;let p;switch(l){case"top":p={x:u,y:n.y-o.height};break;case"bottom":p={x:u,y:n.y+n.height};break;case"right":p={x:n.x+n.width,y:d};break;case"left":p={x:n.x-o.width,y:d};break;default:p={x:n.x,y:n.y}}switch(getAlignment(t)){case"start":p[a]-=h*(r&&c?-1:1);break;case"end":p[a]+=h*(r&&c?-1:1)}return p}const computePosition$1=async(e,t,r)=>{const{placement:n="bottom",strategy:o="absolute",middleware:i=[],platform:a}=r,s=i.filter(Boolean),l=await(null==a.isRTL?void 0:a.isRTL(t));let c=await a.getElementRects({reference:e,floating:t,strategy:o}),{x:u,y:d}=computeCoordsFromPlacement(c,n,l),h=n,p={},f=0;for(let g=0;g<s.length;g++){const{name:r,fn:i}=s[g],{x:m,y:y,data:v,reset:_}=await i({x:u,y:d,initialPlacement:n,placement:h,strategy:o,middlewareData:p,rects:c,platform:a,elements:{reference:e,floating:t}});u=null!=m?m:u,d=null!=y?y:d,p={...p,[r]:{...p[r],...v}},_&&f<=50&&(f++,"object"==typeof _&&(_.placement&&(h=_.placement),_.rects&&(c=!0===_.rects?await a.getElementRects({reference:e,floating:t,strategy:o}):_.rects),({x:u,y:d}=computeCoordsFromPlacement(c,h,l))),g=-1)}return{x:u,y:d,placement:h,strategy:o,middlewareData:p}};async function detectOverflow(e,t){var r;void 0===t&&(t={});const{x:n,y:o,platform:i,rects:a,elements:s,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=evaluate(t,e),f=getPaddingObject(p),g=s[h?"floating"===d?"reference":"floating":d],m=rectToClientRect(await i.getClippingRect({element:null==(r=await(null==i.isElement?void 0:i.isElement(g)))||r?g:g.contextElement||await(null==i.getDocumentElement?void 0:i.getDocumentElement(s.floating)),boundary:c,rootBoundary:u,strategy:l})),y="floating"===d?{x:n,y:o,width:a.floating.width,height:a.floating.height}:a.reference,v=await(null==i.getOffsetParent?void 0:i.getOffsetParent(s.floating)),_=await(null==i.isElement?void 0:i.isElement(v))&&await(null==i.getScale?void 0:i.getScale(v))||{x:1,y:1},b=rectToClientRect(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:y,offsetParent:v,strategy:l}):y);return{top:(m.top-b.top+f.top)/_.y,bottom:(b.bottom-m.bottom+f.bottom)/_.y,left:(m.left-b.left+f.left)/_.x,right:(b.right-m.right+f.right)/_.x}}const arrow$1=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:o,rects:i,platform:a,elements:s,middlewareData:l}=t,{element:c,padding:u=0}=evaluate(e,t)||{};if(null==c)return{};const d=getPaddingObject(u),h={x:r,y:n},p=getAlignmentAxis(o),f=getAxisLength(p),g=await a.getDimensions(c),m="y"===p,y=m?"top":"left",v=m?"bottom":"right",_=m?"clientHeight":"clientWidth",b=i.reference[f]+i.reference[p]-h[p]-i.floating[f],C=h[p]-i.reference[p],E=await(null==a.getOffsetParent?void 0:a.getOffsetParent(c));let T=E?E[_]:0;T&&await(null==a.isElement?void 0:a.isElement(E))||(T=s.floating[_]||i.floating[f]);const S=b/2-C/2,P=T/2-g[f]/2-1,w=min$1(d[y],P),x=min$1(d[v],P),O=w,$=T-g[f]-x,I=T/2-g[f]/2+S,R=clamp$2(O,I,$),A=!l.arrow&&null!=getAlignment(o)&&I!==R&&i.reference[f]/2-(I<O?w:x)-g[f]/2<0,D=A?I<O?I-O:I-$:0;return{[p]:h[p]+D,data:{[p]:R,centerOffset:I-R-D,...A&&{alignmentOffset:D}},reset:A}}}),flip$1=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:o,middlewareData:i,rects:a,initialPlacement:s,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:g=!0,...m}=evaluate(e,t);if(null!=(r=i.arrow)&&r.alignmentOffset)return{};const y=getSide(o),v=getSideAxis(s),_=getSide(s)===s,b=await(null==l.isRTL?void 0:l.isRTL(c.floating)),C=h||(_||!g?[getOppositePlacement(s)]:getExpandedPlacements(s)),E="none"!==f;!h&&E&&C.push(...getOppositeAxisPlacements(s,g,f,b));const T=[s,...C],S=await detectOverflow(t,m),P=[];let w=(null==(n=i.flip)?void 0:n.overflows)||[];if(u&&P.push(S[y]),d){const e=getAlignmentSides(o,a,b);P.push(S[e[0]],S[e[1]])}if(w=[...w,{placement:o,overflows:P}],!P.every((e=>e<=0))){var x,O;const e=((null==(x=i.flip)?void 0:x.index)||0)+1,t=T[e];if(t)return{data:{index:e,overflows:w},reset:{placement:t}};let r=null==(O=w.filter((e=>e.overflows[0]<=0)).sort(((e,t)=>e.overflows[1]-t.overflows[1]))[0])?void 0:O.placement;if(!r)switch(p){case"bestFit":{var $;const e=null==($=w.filter((e=>{if(E){const t=getSideAxis(e.placement);return t===v||"y"===t}return!0})).map((e=>[e.placement,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:$[0];e&&(r=e);break}case"initialPlacement":r=s}if(o!==r)return{reset:{placement:r}}}return{}}}};function getSideOffsets(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function isAnySideFullyClipped(e){return sides.some((t=>e[t]>=0))}const hide$1=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...o}=evaluate(e,t);switch(n){case"referenceHidden":{const e=getSideOffsets(await detectOverflow(t,{...o,elementContext:"reference"}),r.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:isAnySideFullyClipped(e)}}}case"escaped":{const e=getSideOffsets(await detectOverflow(t,{...o,altBoundary:!0}),r.floating);return{data:{escapedOffsets:e,escaped:isAnySideFullyClipped(e)}}}default:return{}}}}};async function convertValueToCoords(e,t){const{placement:r,platform:n,elements:o}=e,i=await(null==n.isRTL?void 0:n.isRTL(o.floating)),a=getSide(r),s=getAlignment(r),l="y"===getSideAxis(r),c=["left","top"].includes(a)?-1:1,u=i&&l?-1:1,d=evaluate(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:f}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return s&&"number"==typeof f&&(p="end"===s?-1*f:f),l?{x:p*u,y:h*c}:{x:h*c,y:p*u}}const offset$2=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:o,y:i,placement:a,middlewareData:s}=t,l=await convertValueToCoords(t,e);return a===(null==(r=s.offset)?void 0:r.placement)&&null!=(n=s.arrow)&&n.alignmentOffset?{}:{x:o+l.x,y:i+l.y,data:{...l,placement:a}}}}},shift$1=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:o}=t,{mainAxis:i=!0,crossAxis:a=!1,limiter:s={fn:e=>{let{x:t,y:r}=e;return{x:t,y:r}}},...l}=evaluate(e,t),c={x:r,y:n},u=await detectOverflow(t,l),d=getSideAxis(getSide(o)),h=getOppositeAxis(d);let p=c[h],f=c[d];if(i){const e="y"===h?"bottom":"right";p=clamp$2(p+u["y"===h?"top":"left"],p,p-u[e])}if(a){const e="y"===d?"bottom":"right";f=clamp$2(f+u["y"===d?"top":"left"],f,f-u[e])}const g=s.fn({...t,[h]:p,[d]:f});return{...g,data:{x:g.x-r,y:g.y-n,enabled:{[h]:i,[d]:a}}}}}},limitShift$1=function(e){return void 0===e&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:o,rects:i,middlewareData:a}=t,{offset:s=0,mainAxis:l=!0,crossAxis:c=!0}=evaluate(e,t),u={x:r,y:n},d=getSideAxis(o),h=getOppositeAxis(d);let p=u[h],f=u[d];const g=evaluate(s,t),m="number"==typeof g?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const e="y"===h?"height":"width",t=i.reference[h]-i.floating[e]+m.mainAxis,r=i.reference[h]+i.reference[e]-m.mainAxis;p<t?p=t:p>r&&(p=r)}if(c){var y,v;const e="y"===h?"width":"height",t=["top","left"].includes(getSide(o)),r=i.reference[d]-i.floating[e]+(t&&(null==(y=a.offset)?void 0:y[d])||0)+(t?0:m.crossAxis),n=i.reference[d]+i.reference[e]+(t?0:(null==(v=a.offset)?void 0:v[d])||0)-(t?m.crossAxis:0);f<r?f=r:f>n&&(f=n)}return{[h]:p,[d]:f}}}};function hasWindow(){return"undefined"!=typeof window}function getNodeName(e){return isNode(e)?(e.nodeName||"").toLowerCase():"#document"}function getWindow$1(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function getDocumentElement(e){var t;return null==(t=(isNode(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function isNode(e){return!!hasWindow()&&(e instanceof Node||e instanceof getWindow$1(e).Node)}function isElement$2(e){return!!hasWindow()&&(e instanceof Element||e instanceof getWindow$1(e).Element)}function isHTMLElement(e){return!!hasWindow()&&(e instanceof HTMLElement||e instanceof getWindow$1(e).HTMLElement)}function isShadowRoot(e){return!(!hasWindow()||"undefined"==typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof getWindow$1(e).ShadowRoot)}function isOverflowElement(e){const{overflow:t,overflowX:r,overflowY:n,display:o}=getComputedStyle$1(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(o)}function isTableElement(e){return["table","td","th"].includes(getNodeName(e))}function isTopLayer(e){return[":popover-open",":modal"].some((t=>{try{return e.matches(t)}catch(e3){return!1}}))}function isContainingBlock(e){const t=isWebKit(),r=isElement$2(e)?getComputedStyle$1(e):e;return"none"!==r.transform||"none"!==r.perspective||!!r.containerType&&"normal"!==r.containerType||!t&&!!r.backdropFilter&&"none"!==r.backdropFilter||!t&&!!r.filter&&"none"!==r.filter||["transform","perspective","filter"].some((e=>(r.willChange||"").includes(e)))||["paint","layout","strict","content"].some((e=>(r.contain||"").includes(e)))}function getContainingBlock(e){let t=getParentNode(e);for(;isHTMLElement(t)&&!isLastTraversableNode(t);){if(isContainingBlock(t))return t;if(isTopLayer(t))return null;t=getParentNode(t)}return null}function isWebKit(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function isLastTraversableNode(e){return["html","body","#document"].includes(getNodeName(e))}function getComputedStyle$1(e){return getWindow$1(e).getComputedStyle(e)}function getNodeScroll(e){return isElement$2(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function getParentNode(e){if("html"===getNodeName(e))return e;const t=e.assignedSlot||e.parentNode||isShadowRoot(e)&&e.host||getDocumentElement(e);return isShadowRoot(t)?t.host:t}function getNearestOverflowAncestor(e){const t=getParentNode(e);return isLastTraversableNode(t)?e.ownerDocument?e.ownerDocument.body:e.body:isHTMLElement(t)&&isOverflowElement(t)?t:getNearestOverflowAncestor(t)}function getOverflowAncestors(e,t,r){var n;void 0===t&&(t=[]),void 0===r&&(r=!0);const o=getNearestOverflowAncestor(e),i=o===(null==(n=e.ownerDocument)?void 0:n.body),a=getWindow$1(o);if(i){const e=getFrameElement(a);return t.concat(a,a.visualViewport||[],isOverflowElement(o)?o:[],e&&r?getOverflowAncestors(e):[])}return t.concat(o,getOverflowAncestors(o,[],r))}function getFrameElement(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function getCssDimensions(e){const t=getComputedStyle$1(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const o=isHTMLElement(e),i=o?e.offsetWidth:r,a=o?e.offsetHeight:n,s=round$1(r)!==i||round$1(n)!==a;return s&&(r=i,n=a),{width:r,height:n,$:s}}function unwrapElement(e){return isElement$2(e)?e:e.contextElement}function getScale(e){const t=unwrapElement(e);if(!isHTMLElement(t))return createCoords(1);const r=t.getBoundingClientRect(),{width:n,height:o,$:i}=getCssDimensions(t);let a=(i?round$1(r.width):r.width)/n,s=(i?round$1(r.height):r.height)/o;return a&&Number.isFinite(a)||(a=1),s&&Number.isFinite(s)||(s=1),{x:a,y:s}}const noOffsets=createCoords(0);function getVisualOffsets(e){const t=getWindow$1(e);return isWebKit()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:noOffsets}function shouldAddVisualOffsets(e,t,r){return void 0===t&&(t=!1),!(!r||t&&r!==getWindow$1(e))&&t}function getBoundingClientRect(e,t,r,n){void 0===t&&(t=!1),void 0===r&&(r=!1);const o=e.getBoundingClientRect(),i=unwrapElement(e);let a=createCoords(1);t&&(n?isElement$2(n)&&(a=getScale(n)):a=getScale(e));const s=shouldAddVisualOffsets(i,r,n)?getVisualOffsets(i):createCoords(0);let l=(o.left+s.x)/a.x,c=(o.top+s.y)/a.y,u=o.width/a.x,d=o.height/a.y;if(i){const e=getWindow$1(i),t=n&&isElement$2(n)?getWindow$1(n):n;let r=e,o=getFrameElement(r);for(;o&&n&&t!==r;){const e=getScale(o),t=o.getBoundingClientRect(),n=getComputedStyle$1(o),i=t.left+(o.clientLeft+parseFloat(n.paddingLeft))*e.x,a=t.top+(o.clientTop+parseFloat(n.paddingTop))*e.y;l*=e.x,c*=e.y,u*=e.x,d*=e.y,l+=i,c+=a,r=getWindow$1(o),o=getFrameElement(r)}}return rectToClientRect({width:u,height:d,x:l,y:c})}function getWindowScrollBarX(e,t){const r=getNodeScroll(e).scrollLeft;return t?t.left+r:getBoundingClientRect(getDocumentElement(e)).left+r}function getHTMLOffset(e,t,r){void 0===r&&(r=!1);const n=e.getBoundingClientRect();return{x:n.left+t.scrollLeft-(r?0:getWindowScrollBarX(e,n)),y:n.top+t.scrollTop}}function convertOffsetParentRelativeRectToViewportRelativeRect(e){let{elements:t,rect:r,offsetParent:n,strategy:o}=e;const i="fixed"===o,a=getDocumentElement(n),s=!!t&&isTopLayer(t.floating);if(n===a||s&&i)return r;let l={scrollLeft:0,scrollTop:0},c=createCoords(1);const u=createCoords(0),d=isHTMLElement(n);if((d||!d&&!i)&&(("body"!==getNodeName(n)||isOverflowElement(a))&&(l=getNodeScroll(n)),isHTMLElement(n))){const e=getBoundingClientRect(n);c=getScale(n),u.x=e.x+n.clientLeft,u.y=e.y+n.clientTop}const h=!a||d||i?createCoords(0):getHTMLOffset(a,l,!0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:r.y*c.y-l.scrollTop*c.y+u.y+h.y}}function getClientRects(e){return Array.from(e.getClientRects())}function getDocumentRect(e){const t=getDocumentElement(e),r=getNodeScroll(e),n=e.ownerDocument.body,o=max$3(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),i=max$3(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let a=-r.scrollLeft+getWindowScrollBarX(e);const s=-r.scrollTop;return"rtl"===getComputedStyle$1(n).direction&&(a+=max$3(t.clientWidth,n.clientWidth)-o),{width:o,height:i,x:a,y:s}}function getViewportRect(e,t){const r=getWindow$1(e),n=getDocumentElement(e),o=r.visualViewport;let i=n.clientWidth,a=n.clientHeight,s=0,l=0;if(o){i=o.width,a=o.height;const e=isWebKit();(!e||e&&"fixed"===t)&&(s=o.offsetLeft,l=o.offsetTop)}return{width:i,height:a,x:s,y:l}}function getInnerBoundingClientRect(e,t){const r=getBoundingClientRect(e,!0,"fixed"===t),n=r.top+e.clientTop,o=r.left+e.clientLeft,i=isHTMLElement(e)?getScale(e):createCoords(1);return{width:e.clientWidth*i.x,height:e.clientHeight*i.y,x:o*i.x,y:n*i.y}}function getClientRectFromClippingAncestor(e,t,r){let n;if("viewport"===t)n=getViewportRect(e,r);else if("document"===t)n=getDocumentRect(getDocumentElement(e));else if(isElement$2(t))n=getInnerBoundingClientRect(t,r);else{const r=getVisualOffsets(e);n={x:t.x-r.x,y:t.y-r.y,width:t.width,height:t.height}}return rectToClientRect(n)}function hasFixedPositionAncestor(e,t){const r=getParentNode(e);return!(r===t||!isElement$2(r)||isLastTraversableNode(r))&&("fixed"===getComputedStyle$1(r).position||hasFixedPositionAncestor(r,t))}function getClippingElementAncestors(e,t){const r=t.get(e);if(r)return r;let n=getOverflowAncestors(e,[],!1).filter((e=>isElement$2(e)&&"body"!==getNodeName(e))),o=null;const i="fixed"===getComputedStyle$1(e).position;let a=i?getParentNode(e):e;for(;isElement$2(a)&&!isLastTraversableNode(a);){const t=getComputedStyle$1(a),r=isContainingBlock(a);r||"fixed"!==t.position||(o=null);(i?!r&&!o:!r&&"static"===t.position&&!!o&&["absolute","fixed"].includes(o.position)||isOverflowElement(a)&&!r&&hasFixedPositionAncestor(e,a))?n=n.filter((e=>e!==a)):o=t,a=getParentNode(a)}return t.set(e,n),n}function getClippingRect(e){let{element:t,boundary:r,rootBoundary:n,strategy:o}=e;const i=[..."clippingAncestors"===r?isTopLayer(t)?[]:getClippingElementAncestors(t,this._c):[].concat(r),n],a=i[0],s=i.reduce(((e,r)=>{const n=getClientRectFromClippingAncestor(t,r,o);return e.top=max$3(n.top,e.top),e.right=min$1(n.right,e.right),e.bottom=min$1(n.bottom,e.bottom),e.left=max$3(n.left,e.left),e}),getClientRectFromClippingAncestor(t,a,o));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}}function getDimensions$1(e){const{width:t,height:r}=getCssDimensions(e);return{width:t,height:r}}function getRectRelativeToOffsetParent(e,t,r){const n=isHTMLElement(t),o=getDocumentElement(t),i="fixed"===r,a=getBoundingClientRect(e,!0,i,t);let s={scrollLeft:0,scrollTop:0};const l=createCoords(0);if(n||!n&&!i)if(("body"!==getNodeName(t)||isOverflowElement(o))&&(s=getNodeScroll(t)),n){const e=getBoundingClientRect(t,!0,i,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else o&&(l.x=getWindowScrollBarX(o));const c=!o||n||i?createCoords(0):getHTMLOffset(o,s);return{x:a.left+s.scrollLeft-l.x-c.x,y:a.top+s.scrollTop-l.y-c.y,width:a.width,height:a.height}}function isStaticPositioned(e){return"static"===getComputedStyle$1(e).position}function getTrueOffsetParent(e,t){if(!isHTMLElement(e)||"fixed"===getComputedStyle$1(e).position)return null;if(t)return t(e);let r=e.offsetParent;return getDocumentElement(e)===r&&(r=r.ownerDocument.body),r}function getOffsetParent(e,t){const r=getWindow$1(e);if(isTopLayer(e))return r;if(!isHTMLElement(e)){let t=getParentNode(e);for(;t&&!isLastTraversableNode(t);){if(isElement$2(t)&&!isStaticPositioned(t))return t;t=getParentNode(t)}return r}let n=getTrueOffsetParent(e,t);for(;n&&isTableElement(n)&&isStaticPositioned(n);)n=getTrueOffsetParent(n,t);return n&&isLastTraversableNode(n)&&isStaticPositioned(n)&&!isContainingBlock(n)?r:n||getContainingBlock(e)||r}const getElementRects=async function(e){const t=this.getOffsetParent||getOffsetParent,r=this.getDimensions,n=await r(e.floating);return{reference:getRectRelativeToOffsetParent(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function isRTL(e){return"rtl"===getComputedStyle$1(e).direction}const platform={convertOffsetParentRelativeRectToViewportRelativeRect:convertOffsetParentRelativeRectToViewportRelativeRect,getDocumentElement:getDocumentElement,getClippingRect:getClippingRect,getOffsetParent:getOffsetParent,getElementRects:getElementRects,getClientRects:getClientRects,getDimensions:getDimensions$1,getScale:getScale,isElement:isElement$2,isRTL:isRTL};function observeMove(e,t){let r,n=null;const o=getDocumentElement(e);function i(){var e;clearTimeout(r),null==(e=n)||e.disconnect(),n=null}return function a(s,l){void 0===s&&(s=!1),void 0===l&&(l=1),i();const{left:c,top:u,width:d,height:h}=e.getBoundingClientRect();if(s||t(),!d||!h)return;const p={rootMargin:-floor(u)+"px "+-floor(o.clientWidth-(c+d))+"px "+-floor(o.clientHeight-(u+h))+"px "+-floor(c)+"px",threshold:max$3(0,min$1(1,l))||1};let f=!0;function g(e){const t=e[0].intersectionRatio;if(t!==l){if(!f)return a();t?a(!1,t):r=setTimeout((()=>{a(!1,1e-7)}),1e3)}f=!1}try{n=new IntersectionObserver(g,{...p,root:o.ownerDocument})}catch(e3){n=new IntersectionObserver(g,p)}n.observe(e)}(!0),i}function autoUpdate(e,t,r,n){void 0===n&&(n={});const{ancestorScroll:o=!0,ancestorResize:i=!0,elementResize:a="function"==typeof ResizeObserver,layoutShift:s="function"==typeof IntersectionObserver,animationFrame:l=!1}=n,c=unwrapElement(e),u=o||i?[...c?getOverflowAncestors(c):[],...getOverflowAncestors(t)]:[];u.forEach((e=>{o&&e.addEventListener("scroll",r,{passive:!0}),i&&e.addEventListener("resize",r)}));const d=c&&s?observeMove(c,r):null;let h,p=-1,f=null;a&&(f=new ResizeObserver((e=>{let[n]=e;n&&n.target===c&&f&&(f.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame((()=>{var e;null==(e=f)||e.observe(t)}))),r()})),c&&!l&&f.observe(c),f.observe(t));let g=l?getBoundingClientRect(e):null;return l&&function t(){const n=getBoundingClientRect(e);!g||n.x===g.x&&n.y===g.y&&n.width===g.width&&n.height===g.height||r();g=n,h=requestAnimationFrame(t)}(),r(),()=>{var e;u.forEach((e=>{o&&e.removeEventListener("scroll",r),i&&e.removeEventListener("resize",r)})),null==d||d(),null==(e=f)||e.disconnect(),f=null,l&&cancelAnimationFrame(h)}}const offset$1=offset$2,shift=shift$1,flip=flip$1,hide=hide$1,arrow=arrow$1,limitShift=limitShift$1,computePosition=(e,t,r)=>{const n=new Map,o={platform:platform,...r},i={...o.platform,_c:n};return computePosition$1(e,t,{...o,platform:i})};let tenPxTester=null,tester=null;function convertPx(e){return null===tenPxTester||null===tester||10===tenPxTester.getBoundingClientRect().height?e:(tester.style.setProperty("--size",e.toString()),tester.getBoundingClientRect().height)}canUseDom&&(tenPxTester=document.createElement("div"),tenPxTester.className="adm-px-tester",tenPxTester.style.setProperty("--size","10"),document.body.appendChild(tenPxTester),tester=document.createElement("div"),tester.className="adm-px-tester",document.body.appendChild(tester));const classPrefix$s="adm-input",defaultProps$x={defaultValue:"",onlyShowClearWhenFocus:!0},Input=reactExports.forwardRef(((e,t)=>{const r=mergeProps(defaultProps$x,e),[n,o]=usePropsValue(r),[i,a]=reactExports.useState(!1),s=reactExports.useRef(!1),l=reactExports.useRef(null),{locale:c}=useConfig$1();reactExports.useImperativeHandle(t,(()=>({clear:()=>{o("")},focus:()=>{var e;null===(e=l.current)||void 0===e||e.focus()},blur:()=>{var e;null===(e=l.current)||void 0===e||e.blur()},get nativeElement(){return l.current}})));useIsomorphicLayoutEffect$2((()=>{var e;if(r.enterKeyHint)return null===(e=l.current)||void 0===e||e.setAttribute("enterkeyhint",r.enterKeyHint),()=>{var e;null===(e=l.current)||void 0===e||e.removeAttribute("enterkeyhint")}}),[r.enterKeyHint]);const u=!(!r.clearable||!n||r.readOnly)&&(!r.onlyShowClearWhenFocus||i);return withNativeProps(r,React.createElement("div",{className:classNames$1("".concat(classPrefix$s),r.disabled&&"".concat(classPrefix$s,"-disabled"))},React.createElement("input",{ref:l,className:"".concat(classPrefix$s,"-element"),value:n,onChange:e=>{o(e.target.value)},onFocus:e=>{var t;a(!0),null===(t=r.onFocus)||void 0===t||t.call(r,e)},onBlur:e=>{var t;a(!1),function(){let e=n;"number"===r.type&&(e=e&&bound(parseFloat(e),r.min,r.max).toString()),e!==n&&o(e)}(),null===(t=r.onBlur)||void 0===t||t.call(r,e)},id:r.id,placeholder:r.placeholder,disabled:r.disabled,readOnly:r.readOnly,maxLength:r.maxLength,minLength:r.minLength,max:r.max,min:r.min,autoComplete:r.autoComplete,autoFocus:r.autoFocus,pattern:r.pattern,inputMode:r.inputMode,type:r.type,name:r.name,autoCapitalize:r.autoCapitalize,autoCorrect:r.autoCorrect,onKeyDown:e=>{var t;!r.onEnterPress||"Enter"!==e.code&&13!==e.keyCode||r.onEnterPress(e),null===(t=r.onKeyDown)||void 0===t||t.call(r,e)},onKeyUp:r.onKeyUp,onCompositionStart:e=>{var t;s.current=!0,null===(t=r.onCompositionStart)||void 0===t||t.call(r,e)},onCompositionEnd:e=>{var t;s.current=!1,null===(t=r.onCompositionEnd)||void 0===t||t.call(r,e)},onClick:r.onClick,step:r.step,role:r.role,"aria-valuenow":r["aria-valuenow"],"aria-valuemax":r["aria-valuemax"],"aria-valuemin":r["aria-valuemin"],"aria-label":r["aria-label"]}),u&&React.createElement("div",{className:"".concat(classPrefix$s,"-clear"),onMouseDown:e=>{e.preventDefault()},onClick:()=>{var e,t;o(""),null===(e=r.onClear)||void 0===e||e.call(r),isIOS()&&s.current&&(s.current=!1,null===(t=l.current)||void 0===t||t.blur())},"aria-label":c.Input.clear},React.createElement(CloseCircleFill,null))))})),classPrefix$r="adm-page-indicator",defaultProps$w={color:"primary",direction:"horizontal"},PageIndicator=reactExports.memo((e=>{const t=mergeProps(defaultProps$w,e),r=[];for(let n=0;n<t.total;n++)r.push(React.createElement("div",{key:n,className:classNames$1("".concat(classPrefix$r,"-dot"),{["".concat(classPrefix$r,"-dot-active")]:t.current===n})}));return withNativeProps(t,React.createElement("div",{className:classNames$1(classPrefix$r,"".concat(classPrefix$r,"-").concat(t.direction),"".concat(classPrefix$r,"-color-").concat(t.color))},r))})),RadioGroupContext=reactExports.createContext(null),defaultProps$v={disabled:!1,defaultValue:null},Group$2=e=>{const t=mergeProps(defaultProps$v,e),[r,n]=usePropsValue({value:t.value,defaultValue:t.defaultValue,onChange:e=>{var r;null!==e&&(null===(r=t.onChange)||void 0===r||r.call(t,e))}});return React.createElement(RadioGroupContext.Provider,{value:{value:null===r?[]:[r],check:e=>{n(e)},uncheck:()=>{},disabled:t.disabled}},t.children)},classPrefix$q="adm-radio",defaultProps$u={defaultChecked:!1},Radio$3=e=>{const t=mergeProps(defaultProps$u,e),r=reactExports.useContext(RadioGroupContext);let[n,o]=usePropsValue({value:t.checked,defaultValue:t.defaultChecked,onChange:t.onChange}),i=t.disabled;const{value:a}=t;r&&void 0!==a&&(n=r.value.includes(a),o=e=>{var n;e?r.check(a):r.uncheck(a),null===(n=t.onChange)||void 0===n||n.call(t,e)},i=i||r.disabled);return withNativeProps(t,React.createElement("label",{className:classNames$1(classPrefix$q,{["".concat(classPrefix$q,"-checked")]:n,["".concat(classPrefix$q,"-disabled")]:i,["".concat(classPrefix$q,"-block")]:t.block})},React.createElement(NativeInput,{type:"radio",checked:n,onChange:o,disabled:i,id:t.id}),t.icon?React.createElement("div",{className:"".concat(classPrefix$q,"-custom-icon")},t.icon(n)):React.createElement("div",{className:"".concat(classPrefix$q,"-icon")},n&&React.createElement(CheckIcon,null)),t.children&&React.createElement("div",{className:"".concat(classPrefix$q,"-content")},t.children)))},Radio$2=attachPropertiesToComponent(Radio$3,{Group:Group$2}),classPrefix$p="adm-search-bar",defaultProps$t={clearable:!0,onlyShowClearWhenFocus:!1,showCancelButton:!1,defaultValue:"",clearOnCancel:!0,icon:React.createElement(SearchOutline,null)},SearchBar$1=reactExports.forwardRef(((e,t)=>{const{locale:r}=useConfig$1(),n=mergeProps(defaultProps$t,{cancelText:r.common.cancel},e),[o,i]=usePropsValue(n),[a,s]=reactExports.useState(!1),l=reactExports.useRef(null),c=reactExports.useRef(!1);reactExports.useImperativeHandle(t,(()=>({clear:()=>{var e;return null===(e=l.current)||void 0===e?void 0:e.clear()},focus:()=>{var e;return null===(e=l.current)||void 0===e?void 0:e.focus()},blur:()=>{var e;return null===(e=l.current)||void 0===e?void 0:e.blur()},get nativeElement(){var e,t;return null!==(t=null===(e=l.current)||void 0===e?void 0:e.nativeElement)&&void 0!==t?t:null}})));return withNativeProps(n,React.createElement("div",{className:classNames$1(classPrefix$p,{["".concat(classPrefix$p,"-active")]:a})},React.createElement("div",{className:"".concat(classPrefix$p,"-input-box")},n.icon&&React.createElement("div",{className:"".concat(classPrefix$p,"-input-box-icon")},n.icon),React.createElement(Input,{ref:l,className:classNames$1("".concat(classPrefix$p,"-input"),{["".concat(classPrefix$p,"-input-without-icon")]:!n.icon}),value:o,onChange:i,maxLength:n.maxLength,placeholder:n.placeholder,clearable:n.clearable,onlyShowClearWhenFocus:n.onlyShowClearWhenFocus,onFocus:e=>{var t;s(!0),null===(t=n.onFocus)||void 0===t||t.call(n,e)},onBlur:e=>{var t;s(!1),null===(t=n.onBlur)||void 0===t||t.call(n,e)},onClear:n.onClear,type:"search",enterKeyHint:"search",onEnterPress:()=>{var e,t;c.current||(null===(e=l.current)||void 0===e||e.blur(),null===(t=n.onSearch)||void 0===t||t.call(n,o))},"aria-label":r.SearchBar.name,onCompositionStart:e=>{var t;c.current=!0,null===(t=n.onCompositionStart)||void 0===t||t.call(n,e)},onCompositionEnd:e=>{var t;c.current=!1,null===(t=n.onCompositionEnd)||void 0===t||t.call(n,e)}})),(()=>{let e;return e="function"==typeof n.showCancelButton?n.showCancelButton(a,o):n.showCancelButton&&a,e&&React.createElement("div",{className:"".concat(classPrefix$p,"-suffix")},React.createElement(Button$2,{fill:"none",className:"".concat(classPrefix$p,"-cancel-button"),onClick:()=>{var e,t,r;n.clearOnCancel&&(null===(e=l.current)||void 0===e||e.clear()),null===(t=l.current)||void 0===t||t.blur(),null===(r=n.onCancel)||void 0===r||r.call(n)},onMouseDown:e=>{e.preventDefault()}},n.cancelText))})()))})),SwiperItem$2=e=>withNativeProps(e,React.createElement("div",{className:"adm-swiper-item",onClick:e.onClick},e.children));function useRefState(e){const[t,r]=reactExports.useState(e),n=reactExports.useRef(t);return reactExports.useEffect((()=>{n.current=t}),[t]),[t,r,n]}function mergeFuncProps(e,t){const r=Object.keys(e),n=Object.keys(t),o=new Set([...r,...n]),i={};return o.forEach((r=>{const n=e[r],o=t[r];i[r]="function"==typeof n&&"function"==typeof o?function(...e){n(...e),o(...e)}:n||o})),i}const classPrefix$o="adm-swiper",eventToPropRecord={mousedown:"onMouseDown",mousemove:"onMouseMove",mouseup:"onMouseUp"},defaultProps$s={defaultIndex:0,allowTouchMove:!0,autoplay:!1,autoplayInterval:3e3,loop:!1,direction:"horizontal",slideSize:100,trackOffset:0,stuckAtBoundary:!0,rubberband:!0,stopPropagation:[]};let currentUid;const Swiper$2=reactExports.forwardRef(staged_1(((e,t)=>{const r=mergeProps(defaultProps$s,e),[n]=reactExports.useState({}),o=reactExports.useRef(null),i="vertical"===r.direction,a=r.slideSize/100,s=r.trackOffset/100,{validChildren:l,count:c}=reactExports.useMemo((()=>{let e=0;return{validChildren:React.Children.map(r.children,(t=>React.isValidElement(t)?t.type!==SwiperItem$2?null:(e++,t):null)),count:e}}),[r.children]);return 0!==c&&l?()=>{let e=r.loop;a*(c-1)<1&&(e=!1);const u=reactExports.useRef(null);function d(){const e=u.current;if(!e)return 0;return(i?e.offsetHeight:e.offsetWidth)*r.slideSize/100}const[h,p,f]=useGetState(r.defaultIndex),[g,m,y]=useRefState(!1);function v(e){let t=0,n=c-1;return r.stuckAtBoundary&&(t+=s/a,n-=(1-a-s)/a),bound(e,t,n)}const[{position:_},b]=useSpring$1((()=>({position:100*v(h),config:{tension:200,friction:30},onRest:()=>{if(y.current)return;if(!e)return;const t=_.get(),r=modulus(t,100*c);r!==t&&b.start({position:r,immediate:!0})}})),[c]),C=reactExports.useRef(null);const E=useDrag((e=>{if(C.current=e.cancel,!e.intentional)return;if(e.first&&!currentUid&&(currentUid=n),currentUid!==n)return;currentUid=e.last?void 0:n;const t=d();if(!t)return;const r=i?1:0,o=e.offset[r],a=e.direction[r],s=e.velocity[r];if(m(!0),e.last){const e=Math.floor(o/t),r=e+1;T(bound(Math.round((o+2e3*s*a)/t),e,r)),window.setTimeout((()=>{m(!1)}))}else b.start({position:100*o/t,immediate:!0})}),{transform:([e,t])=>[-e,-t],from:()=>{const e=d();return[_.get()/100*e,_.get()/100*e]},triggerAllEvents:!0,bounds:()=>{if(e)return{};const t=d(),r=v(0)*t,n=v(c-1)*t;return i?{top:r,bottom:n}:{left:r,right:n}},rubberband:r.rubberband,axis:i?"y":"x",preventScroll:!i,pointer:{touch:!0}});function T(t,n=!1){var o;const i=Math.round(t),a=e?modulus(i,c):bound(i,0,c-1);a!==f()&&(null===(o=r.onIndexChange)||void 0===o||o.call(r,a)),p(a),b.start({position:100*(e?i:v(i)),immediate:n})}function S(){T(Math.round(_.get()/100)+1)}function P(){T(Math.round(_.get()/100)-1)}reactExports.useImperativeHandle(t,(()=>({swipeTo:T,swipeNext:S,swipePrev:P}))),useIsomorphicLayoutEffect$2((()=>{const e=l.length-1;h>e&&T(e,!0)}));const{autoplay:w,autoplayInterval:x}=r,O=()=>{o.current=window.setTimeout((()=>{S(),O()}),x)};reactExports.useEffect((()=>{if(w&&!g)return O(),()=>{o.current&&window.clearTimeout(o.current)}}),[w,x,g,c]);const $={"--slide-size":"".concat(r.slideSize,"%"),"--track-offset":"".concat(r.trackOffset,"%")},I=Object.assign({},r.allowTouchMove?E():{}),R={};for(const t of r.stopPropagation){R[eventToPropRecord[t]]=function(e){e.stopPropagation()}}const A=mergeFuncProps(I,R);return withNativeProps(r,React.createElement("div",{className:classNames$1(classPrefix$o,"".concat(classPrefix$o,"-").concat(r.direction)),style:$},React.createElement("div",Object.assign({ref:u,className:classNames$1("".concat(classPrefix$o,"-track"),{["".concat(classPrefix$o,"-track-allow-touch-move")]:r.allowTouchMove}),onClickCapture:e=>{var t;y.current&&e.stopPropagation(),null===(t=C.current)||void 0===t||t.call(C),y.current=!1}},A),e?React.createElement("div",{className:"".concat(classPrefix$o,"-track-inner")},React.Children.map(l,((e,t)=>React.createElement(animated$1.div,{className:classNames$1("".concat(classPrefix$o,"-slide"),{["".concat(classPrefix$o,"-slide-active")]:h===t}),style:{[i?"y":"x"]:_.to((e=>{let r=100*t-e;const n=100*c,o=n/2;return r=modulus(r+o,n)-o,"".concat(r,"%")})),[i?"top":"left"]:"-".concat(100*t,"%")}},e)))):React.createElement(animated$1.div,{className:"".concat(classPrefix$o,"-track-inner"),style:{[i?"y":"x"]:_.to((e=>"".concat(-e,"%")))}},React.Children.map(l,((e,t)=>React.createElement("div",{className:classNames$1("".concat(classPrefix$o,"-slide"),{["".concat(classPrefix$o,"-slide-active")]:h===t})},e))))),void 0===r.indicator?React.createElement("div",{className:"".concat(classPrefix$o,"-indicator")},React.createElement(PageIndicator,Object.assign({},r.indicatorProps,{total:c,current:h,direction:r.direction}))):r.indicator(c,h)))}:null})));function modulus(e,t){const r=e%t;return r<0?r+t:r}const AntdSwiper=attachPropertiesToComponent(Swiper$2,{Item:SwiperItem$2}),classPrefix$n="adm-toast",defaultProps$r={maskClickable:!0,stopPropagation:["click"]},InternalToast=e=>{const t=mergeProps(defaultProps$r,e),{maskClickable:r,content:n,icon:o,position:i}=t,a=reactExports.useMemo((()=>{if(null==o)return null;switch(o){case"success":return React.createElement(CheckOutline,{className:"".concat(classPrefix$n,"-icon-success")});case"fail":return React.createElement(CloseOutline,{className:"".concat(classPrefix$n,"-icon-fail")});case"loading":return React.createElement(SpinLoading,{color:"white",className:"".concat(classPrefix$n,"-loading")});default:return o}}),[o]),s=reactExports.useMemo((()=>{switch(i){case"top":return"20%";case"bottom":return"80%";default:return"50%"}}),[i]);return React.createElement(Mask,{visible:t.visible,destroyOnClose:!0,opacity:0,disableBodyScroll:!r,getContainer:t.getContainer,afterClose:t.afterClose,style:Object.assign({pointerEvents:r?"none":"auto"},t.maskStyle),className:classNames$1("".concat(classPrefix$n,"-mask"),t.maskClassName),stopPropagation:t.stopPropagation},React.createElement("div",{className:classNames$1("".concat(classPrefix$n,"-wrap"))},React.createElement("div",{style:{top:s},className:classNames$1("".concat(classPrefix$n,"-main"),"".concat(classPrefix$n,o?"-main-icon":"-main-text"))},a&&React.createElement("div",{className:"".concat(classPrefix$n,"-icon")},a),React.createElement(AutoCenter,null,n))))};let currentHandler=null,currentTimeout=null;const defaultProps$q={duration:2e3,position:"center",maskClickable:!0},ToastInner=e=>React.createElement(InternalToast,Object.assign({},e));function show$2(e){const t=mergeProps(defaultProps$q,"string"==typeof e?{content:e}:e),r=React.createElement(ToastInner,Object.assign({},t,{onClose:()=>{currentHandler=null}}));return currentHandler?currentHandler.replace(r):currentHandler=renderImperatively(r),currentTimeout&&window.clearTimeout(currentTimeout),0!==t.duration&&(currentTimeout=window.setTimeout((()=>{clear()}),t.duration)),currentHandler}function clear(){null==currentHandler||currentHandler.close(),currentHandler=null}function config$1(e){void 0!==e.duration&&(defaultProps$q.duration=e.duration),void 0!==e.position&&(defaultProps$q.position=e.position),void 0!==e.maskClickable&&(defaultProps$q.maskClickable=e.maskClickable)}const Toast$1={show:show$2,clear:clear,config:config$1},fine={ERROR_MIN_GT_MAX:"请保证前面数值小于/等于后面的数值",ERROR_MIN_EQ_MAX:"前后值相等，请将操作符改为“⩽”",REQUIRED:"不可为空",SELECT_ALL:"全选",NOT_SELECT:"不选",CLEAR:"清空",CANCEL:"取消",CONFIRM:"确定",VALUE:"值",TOMORROW:"明日",YESTERDAY:"昨日",THIS_DAY:"当日",LAST_7_DAYS:"最近七天",LAST_15_DAYS:"最近十五天",LAST_MONTH:"最近一月",LAST_YEAR:"最近一年",SINCE_START_OF_MONTH:"月初至今",SINCE_START_OF_QUARTER:"季度初至今",SINCE_START_OF_YEAR:"年初至今",HOUR:"时",MINUTE:"分",SECONDS:"秒",YEAR:"年",MONTH:"月",DATE:"日",QUARTER_ONE:"一季度",QUARTER_TWO:"二季度",QUARTER_THREE:"三季度",QUARTER_FOUR:"四季度",TODAY:"今天",CURRENT_MONTH:"本月",CURRENT_TIME:"此刻",CURRENT_YEAR:"今年",CURRENT_QUARTER:"本季度",OFFSET_PICKER_INTRO:"相对当前时间",OFFSET_PICKER_TAB:"动态时间",TAB_YEAR:"年份",TAB_QUARTER:"季度",TAB_MONTH:"月份",TAB_YEAR_QUARTER:"年季度",TAB_YEAR_MONTH:"年月",TAB_DATE:"日期",YEAR_AS_UNIT:"年",QUARTER_AS_UNIT:"季",MONTH_AS_UNIT:"月",WEEK_AS_UNIT:"周",DATE_AS_UNIT:"天",WORKDAY_AS_UNIT:"工作日",YEAR_AS_UNIT_PLURAL:"年",QUARTER_AS_UNIT_PLURAL:"季",MONTH_AS_UNIT_PLURAL:"月",WEEK_AS_UNIT_PLURAL:"周",DATE_AS_UNIT_PLURAL:"天",WORKDAY_AS_UNIT_PLURAL:"工作日",BEFORE:"前",AFTER:"后",THAT_DAY:"当天",HEAD_YEAR:"年初",HEAD_QUARTER:"季初",HEAD_MONTH:"月初",HEAD_WEEK:"周初",TAIL_YEAR:"年末",TAIL_QUARTER:"季末",TAIL_MONTH:"月末",TAIL_WEEK:"周末",PREV_DAY:"前一天",NEXT_DAY:"后一天",PREV_WEEK:"前一周",NEXT_WEEK:"后一周",PREV_MONTH:"前一月",NEXT_MONTH:"后一月",PREV_YEAR:"前一年",NEXT_YEAR:"后一年",ALL_SELECT:"全选",VIEW_IMAGE:"查看图片",CUSTOM_VALUE:"自定义值",SEARCH:"搜索",JUMP_TO:"跳转到",DRILL:"钻取",QUERY:"查询",SAVE:"保存",MORE:"更多",QUERY_PANEL:"查询面板",ERROR_NUMBER_OUT_OF_BOUNDS:"请输入${lowerBound}-${upperBound}的数值",EMPTY_RESULT:"暂无结果"},zh_CN=merge$1({},zhCN,{fine:fine});function setDefaultConfig(e){const t=getDefaultConfig();setDefaultConfig$1(Object.assign({},t,e))}function useConfig(){try{return useConfig$1()}catch(e3){return getDefaultConfig()}}setDefaultConfig$1({locale:zh_CN});const OFFSET$1=10,adaptivePosition=(e,t,r)=>t>=r+OFFSET$1?t-r-OFFSET$1:e-t>=r+OFFSET$1?t+OFFSET$1:e>=r?t<=e/2?OFFSET$1:e-r-OFFSET$1:0,OVERLAY_WIDTH=138,DELAY=3e3,defaultProps$p={bounds:{width:0,height:0}},ToolTip$1=reactExports.forwardRef(((e,t)=>{const r=mergeProps(defaultProps$p,e),{bounds:n,toolTipClassName:o,vanchartRef:i}=r,{locale:a}=useConfig(),s=reactExports.useRef(null),[l,c]=reactExports.useState(!0),[u,d]=reactExports.useState(),h=useSize$2(s),p=useDebounceFn((()=>c(!1)),{wait:DELAY});reactExports.useImperativeHandle(t,(()=>({show(e){d(e),p.cancel(),p.run(),c(!0)},hide(){c(!1)}})));const f=()=>{const e=(null==h?void 0:h.width)||0,t=.9*n.width;if(e>0)return e<OVERLAY_WIDTH?OVERLAY_WIDTH:e>=t?Math.max(t,OVERLAY_WIDTH):Math.min(t,e)};let g,m;(null==h?void 0:h.width)?(g="tooltip-text",m={width:f()}):(g="extra-measure",m=h||{});const y=(null==u?void 0:u.tooltipText)||[];return y.length>0&&l?jsxRuntimeExports.jsxs("div",Object.assign({className:classNames$1("tooltip-container",o),style:Object.assign({},(()=>{if(isEmpty$3(u)||isEmpty$3(h))return{left:0,top:0};const e=Math.min(u.x,n.width),t=Math.min(u.y,n.height);return{left:adaptivePosition(n.width,e,h.width),top:adaptivePosition(n.height,t,h.height)}})())},{children:[jsxRuntimeExports.jsx("div",Object.assign({className:classNames$1("tooltip-content",g),style:m,ref:s},{children:y.map(((e,t)=>jsxRuntimeExports.jsx("div",Object.assign({className:"row-tooltip-container"},{children:e.map(((e,t)=>{const{fontStyle:r,fontWeight:n}=e.style||{};return jsxRuntimeExports.jsx("span",Object.assign({className:"fdm-text-ellipsis",style:{fontStyle:r,fontWeight:n}},{children:e.text}),e.text+t)}))}),t)))})),jsxRuntimeExports.jsx("div",Object.assign({onClick:()=>c(!1)},{children:jsxRuntimeExports.jsx(Icon$1,{className:"fdm-close-icon",name:"fdm-clear",size:14})})),"down"===(null==u?void 0:u.drillTypeNeedExecuted)&&jsxRuntimeExports.jsx("div",Object.assign({className:"drill-button",onClick:()=>{var e;null===(e=i.current)||void 0===e||e.drillDown(),c(!1)}},{children:a.fine.DRILL}))]})):null})),Chart=e=>{const t=reactExports.useRef(null),r=reactExports.useRef(null),n=reactExports.useRef(null),o=e.vanchartRef||n,i=useSize$2(r);return jsxRuntimeExports.jsxs("div",Object.assign({style:{position:"relative"},ref:r},{children:[jsxRuntimeExports.jsx(Chart$1,Object.assign({},e,{vanchartRef:o,onClick:r=>{var n,i,a;null===(n=t.current)||void 0===n||n.show(r);const{tooltipText:s=[],drillTypeNeedExecuted:l}=r||{};0===s.length&&"down"===l&&(null===(i=o.current)||void 0===i||i.drillDown()),null===(a=e.onClick)||void 0===a||a.call(e,r)},onChartEventTrigger:r=>{var n,o;const{event:i}=r;switch(null===(n=e.onChartEventTrigger)||void 0===n||n.call(e,r),i){case"pointCanceled":case"hideMobileTooltip":null===(o=t.current)||void 0===o||o.hide()}}})),jsxRuntimeExports.jsx(ToolTip$1,{ref:t,bounds:i,vanchartRef:o,toolTipClassName:e.toolTipClassName})]}))},_userAgent$1=window.navigator.userAgent,specialTabletKeys=["huaweisht"],specialPhoneKeys=["padt00","padm00","pdem30","gm1910"];function _find(e){return _userAgent$1.toLowerCase().includes(e)}function _isSpecialTablet(){return specialTabletKeys.some((e=>_find(e)))}function _isSpecialPhone(){return specialPhoneKeys.some((e=>_find(e)))}function _isPadSize(){return Math.max(window.screen.height,window.screen.width)>1e3}const DeviceInfo={getUserAgent:()=>_userAgent$1,isTablet:()=>!_isSpecialPhone()&&(_find("pad")||_isPadSize()||_isSpecialTablet()),isAndroid:()=>_find("android")||_find("linux")||_find("adr"),isIOS:()=>_find("iphone")||_find("ipad")||_find("ipod")||_find("ios"),getManufacturer:()=>"",isWeChat:()=>_find("micromessenger"),isDingTalk:()=>_find("dingtalk"),getSystemVersion(){const e=this.isIOS()?/OS (\d+[_\d+]?[_\d+]?)/:/android (\d+[\d+]?[\d+]?)/,t=_userAgent$1.match(e);return t?t[1].replace(/_/g,"."):""}},_userAgent=DeviceInfo.getUserAgent().toLowerCase();function find$1(e){return _userAgent.includes(e)}function isTablet(){return DeviceInfo.isTablet()}const Device={pad:()=>isTablet(),ios:()=>find$1("iphone")||find$1("ipad")||find$1("ipod"),iphone:()=>find$1("iphone"),ipad:()=>find$1("ipad"),android:()=>find$1("android"),androidPhone(){return find$1("android")&&!this.pad()},androidPad(){return find$1("android")&&this.pad()}},VALUE={PORTRAIT:"PORTRAIT",LANDSCAPE:"LANDSCAPE",UNKNOWN:"UNKNOWN"};function _getOrientationByAngle(){switch(window.orientation){case 0:case 180:return VALUE.PORTRAIT;case 90:case-90:return VALUE.LANDSCAPE;default:return VALUE.UNKNOWN}}function _getOrientationByClient(){const e=document.documentElement;return e.clientWidth<e.clientHeight?VALUE.PORTRAIT:VALUE.LANDSCAPE}function _getOrientation(){return isUndefined$3(window.orientation)?_getOrientationByClient():_getOrientationByAngle()}let _currentOrientation=_getOrientation();class OrientationUtils{static isLandscape(){return _currentOrientation===this.VALUE.LANDSCAPE}static isPortrait(){return _currentOrientation===this.VALUE.PORTRAIT}static getCurrentOrientation(){return _getOrientation()}}OrientationUtils.VALUE=VALUE,OrientationUtils._listeners=[],OrientationUtils.addOrientationListener=e=>{OrientationUtils._listeners.push(e)},OrientationUtils.removeOrientationListener=e=>{const t=OrientationUtils._listeners.indexOf(e);t>0&&OrientationUtils._listeners.splice(t,1)},OrientationUtils.getOrientation=function(){return Promise.resolve(_getOrientation())};const _createOrientationChangeEvent=e=>()=>{const t=null==e?void 0:e();t!==_currentOrientation&&(_currentOrientation=t,OrientationUtils._listeners.forEach((e=>{e(t)})))},_onOrientationChange=_createOrientationChangeEvent(_getOrientation);function getRootWindow(){let e=window,t=window;for(;t.parent!==t;){try{t.parent.FDM&&(e=t.parent)}catch(e3){}t=t.parent}return e}window.hasOwnProperty("onorientationchange")?window.onorientationchange=_onOrientationChange:window.addEventListener("resize",debounce$4(_onOrientationChange,16),!1);const prefix$1="Portal-".concat(location.href,"-");function _syncCSS(e){const t=useConfig(),{shadowCSS:r}=t;r&&(document.querySelectorAll('link[rel="stylesheet"]').forEach((t=>{const n=t;r.link&&!r.link(n)||fetch(n.href).then((e=>e.text())).then((t=>{injectStylesToShadow(t.replace(/:root/g,":host"),e)}))})),document.querySelectorAll("style").forEach((t=>{var n;if(r.style&&!r.style(t))return;const o=null===(n=t.textContent)||void 0===n?void 0:n.replace(/:root/g,":host");o&&injectStylesToShadow(o,e)})))}function _syncICONFONT(e){const t=document.querySelectorAll('body > svg[aria-hidden="true"]');Array.from(t).map((e=>e.cloneNode(!0))).forEach((t=>{e.appendChild(t)}))}function _getRootPortalContainerInShadowDom(e){const t=getRootWindow(),r=t.document.getElementById("Portal")||t.document.body;if(t===window)return r;const n=t.document.getElementById("".concat(prefix$1).concat(e));if(n&&n.shadowRoot)return n.shadowRoot.getElementById("portal-root");const o=document.createElement("div");o.id="".concat(prefix$1).concat(e),o.classList.add("needsclick"),r.appendChild(o);const i=o.attachShadow({mode:"open"}),a=document.createElement("style");i.appendChild(a);const s=document.createElement("div");return s.id="portal-root",i.appendChild(s),_syncCSS(i),_syncICONFONT(i),s}function getRootPortalContainer(e){const t=getRootWindow(),r=t.document.getElementById("Portal")||t.document.body;if(t===window)return r;const n=useConfig(),{shadowCSS:o}=n;if(isEmpty$3(o)){const n=t.document.getElementById("".concat(prefix$1).concat(e));if(n)return n;const o=document.createElement("div");return o.id="".concat(prefix$1).concat(e),r.appendChild(o),o}return _getRootPortalContainerInShadowDom(e)}function injectStylesToShadow(e,t){const r=document.createElement("style");r.textContent=e,t.appendChild(r)}function removePortals(){const e=getRootWindow(),t=e.document.getElementById("Portal")||e.document.body,r='div[id^="'.concat(prefix$1,'"]');t.querySelectorAll(r).forEach((e=>{e.remove()}))}window.addEventListener("unload",removePortals);var FUNC_ERROR_TEXT$4="Expected a function";function baseDelay$1(e,t,r){if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$4);return setTimeout((function(){e.apply(void 0,r)}),t)}var _baseDelay=baseDelay$1,baseDelay=_baseDelay,baseRest$3=_baseRest$1,toNumber$3=toNumber_1$1,delay=baseRest$3((function(e,t,r){return baseDelay(e,toNumber$3(t)||0,r)})),delay_1=delay;const delay$1=getDefaultExportFromCjs$1(delay_1);function useIsOnScreenKeyboardActive(e=200,t=!1){const[r,n]=reactExports.useState(t);return reactExports.useEffect((()=>{var t;const r=()=>{const t=window.visualViewport;n(void 0!==t&&e<window.screen.height-window.visualViewport.height)};return null===(t=window.visualViewport)||void 0===t||t.addEventListener("resize",r),()=>{var e;null===(e=window.visualViewport)||void 0===e||e.removeEventListener("resize",r)}}),[]),r}const addDays=(e,t)=>e.add(t,"day"),endOfDay=e=>e.endOf("day"),makeStartOfPeriod=e=>t=>t.startOf(e),startOfMonth=makeStartOfPeriod("month"),startOfQuarter=makeStartOfPeriod("quarter"),startOfYear=makeStartOfPeriod("year"),makeSubtract=e=>(t,r)=>t.subtract(r,e),subtractDays=makeSubtract("days"),subtractMonths=makeSubtract("months"),subtractYears=makeSubtract("years"),defaultProps$o={get confirmText(){return useConfig().locale.fine.CONFIRM},getContainer:()=>getRootPortalContainer("alert")};function alert$1(e){const t=mergeProps(defaultProps$o,e);return new Promise((e=>{Alert$1.show(Object.assign(Object.assign({},t),{bodyStyle:Object.assign(Object.assign({},t.bodyStyle),{paddingBottom:"45px"}),closeOnAction:!0,actions:[{key:"confirm",className:"confirm-cancel",text:t.confirmText,style:{backgroundColor:"var(--fdm-color-theme)",color:"var(--fdm-color-white)"}}],onAction:t.onConfirm,onClose:()=>{var r;null===(r=t.onClose)||void 0===r||r.call(t),e()}}))}))}const defaultProps$n={get confirmText(){return useConfig().locale.fine.CONFIRM},get cancelText(){return useConfig().locale.fine.CANCEL},getContainer:()=>getRootPortalContainer("confirm")};function confirm(e){const t=mergeProps(defaultProps$n,e);return new Promise((e=>{Alert$1.show(Object.assign(Object.assign({},t),{bodyStyle:Object.assign(Object.assign({},t.bodyStyle),{paddingBottom:"45px"}),closeOnAction:!0,onClose:()=>{var r;null===(r=t.onClose)||void 0===r||r.call(t),e(!1)},actions:[[{key:"cancel",text:t.cancelText,style:{backgroundColor:"var(--fdm-color-background-weak)",color:"var(--fdm-color-text-highlight)"},onClick:()=>__awaiter(this,void 0,void 0,(function*(){var r;yield null===(r=t.onCancel)||void 0===r?void 0:r.call(t),e(!1)}))},{key:"confirm",text:t.confirmText,className:"confirm-cancel",style:{backgroundColor:"var(--fdm-color-theme)",color:"var(--fdm-color-white)"},onClick:()=>__awaiter(this,void 0,void 0,(function*(){var r;yield null===(r=t.onConfirm)||void 0===r?void 0:r.call(t),e(!0)}))}]]}))}))}const defaultProps$m={actions:[],get cancelText(){return useConfig().locale.fine.CANCEL},getContainer:()=>getRootPortalContainer("action")};function action(e){const t=mergeProps(defaultProps$m,e),r=t.actions.map((e=>Object.assign(Object.assign({},e),{className:classNames$1("fdm-text-ellipsis",e.className)})));return new Promise((e=>{Alert$1.show(Object.assign(Object.assign({},t),{bodyStyle:Object.assign(Object.assign({},t.bodyStyle),{paddingBottom:"45px"}),closeOnAction:!0,actions:[...r,{key:"cancel",className:"confirm-cancel",text:t.cancelText,style:{backgroundColor:"var(--fdm-color-theme)",color:"var(--fdm-color-white)"},onClick:()=>__awaiter(this,void 0,void 0,(function*(){var r;yield null===(r=t.onClose)||void 0===r?void 0:r.call(t),e()}))}],onAction:t.onAction,onClose:()=>{var r;null===(r=t.onClose)||void 0===r||r.call(t),e()}}))}))}const defaultProps$l={get confirmText(){return useConfig().locale.fine.CONFIRM},get cancelText(){return useConfig().locale.fine.CANCEL},getContainer:()=>getRootPortalContainer("prompt")};function prompt(e){var t,r;const{locale:n}=getDefaultConfig(),o=mergeProps(defaultProps$l,{confirmText:n.common.confirm,cancelText:n.common.cancel},e);let i=null!==(r=null!==(t=o.defaultValue)&&void 0!==t?t:o.value)&&void 0!==r?r:"";const a=e=>{var t;i=e,null===(t=o.onChange)||void 0===t||t.call(o,e)};return new Promise((e=>{Alert$1.show(Object.assign(Object.assign({},o),{bodyStyle:Object.assign(Object.assign({},o.bodyStyle),{paddingBottom:"45px"}),closeOnAction:!0,onClose:()=>{var t;null===(t=o.onClose)||void 0===t||t.call(o),e(!1)},content:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[o.content,jsxRuntimeExports.jsx(Input,{onChange:a,defaultValue:o.defaultValue,value:o.value,type:o.inputType,className:"fdm-alert-content-input"})]}),actions:[[{key:"cancel",text:o.cancelText,className:"confirm-cancel",style:{backgroundColor:"var(--fdm-color-background-weak)",color:"var(--fdm-color-text-highlight)"},onClick:()=>__awaiter(this,void 0,void 0,(function*(){var t;yield null===(t=o.onCancel)||void 0===t?void 0:t.call(o),e(!1)}))},{key:"confirm",text:o.confirmText,className:"confirm-cancel",style:{backgroundColor:"var(--fdm-color-theme)",color:"var(--fdm-color-white)"},onClick:()=>__awaiter(this,void 0,void 0,(function*(){var t;yield null===(t=o.onConfirm)||void 0===t?void 0:t.call(o,i),e(!0)}))}]]}))}))}const Alert=attachPropertiesToComponent(Alert$1,{alert:alert$1,confirm:confirm,action:action,prompt:prompt}),classPrefix$m="fdm-text-input",defaultProps$k={invisible:!1,invalid:!1,iconSize:18,onIconClick:()=>{},defaultValue:"",preventIosAutoScrollOnFocus:!0},TextInput=reactExports.forwardRef(((e,t)=>{const r=mergeProps(defaultProps$k,e),{icon:n,iconSize:o,invisible:i,className:a,style:s,onIconClick:l,onContainerClick:c,onChange:u}=r,d=__rest$p(r,["icon","iconSize","invisible","className","style","onIconClick","onContainerClick","onChange"]),h=reactExports.useRef(null),[p,f]=usePropsValue(r),g=useFocusWithin(h),m=transformStyle(s),y=g&&!r.invalid?Object.assign(Object.assign({},m),{"--border-color":"var(--fdm-color-theme)"}):m;return i?null:withNativeProps(Object.assign(Object.assign({},r),{style:y}),jsxRuntimeExports.jsxs("div",Object.assign({ref:h,onClick:c,className:classNames$1(classPrefix$m,{["".concat(classPrefix$m,"-disabled")]:r.disabled,"fdm-border-error":r.invalid})},{children:[jsxRuntimeExports.jsx(Input,Object.assign({},d,{ref:t,value:p,onChange:e=>f(e),onFocus:e=>{var t;if(Device.ios()&&r.preventIosAutoScrollOnFocus){const t=e.target;t.style.opacity="0",setTimeout((()=>t.style.opacity="1"))}null===(t=r.onFocus)||void 0===t||t.call(r,e)}})),n&&jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$m,"-icon"),onClick:e=>{var t,n;e.stopPropagation(),r.disabled||(null===(n=null===(t=h.current)||void 0===t?void 0:t.blur)||void 0===n||n.call(t),l())}},{children:jsxRuntimeExports.jsx(Icon$1,{name:n,size:o,className:classNames$1("icon",{"icon-error":r.invalid})})}))]})))})),CLASS_NAME_WRAPPER="fdm-toast-wrapper",CLASS_NAME_NORMAL="fdm-toast-normal",CLASS_NAME_WARNING="fdm-toast-warning",CLASS_NAME_ERROR="fdm-toast-error",defaultProps$j={duration:2e3,getContainer:()=>getRootPortalContainer("toast")},antdToastShow=Toast$1.show;function _show(e,t){const r=mergeProps(defaultProps$j,e);return antdToastShow(Object.assign(Object.assign({},r),{getContainer:createToastWrapper(r.getContainer,t)}))}function show$1(e){_show(e,CLASS_NAME_NORMAL)}function showWarning(e){_show(e,CLASS_NAME_WARNING)}function showError(e){_show(e,CLASS_NAME_ERROR)}const createToastWrapper=(e,t)=>{const r="function"==typeof e?e():e||getRootPortalContainer("toast");return r.classList.add(CLASS_NAME_WRAPPER),r.classList.add(t),r};function _clear(){var e;const t=getRootPortalContainer("toast");t.getRootNode()instanceof ShadowRoot&&(null===(e=t.parentNode)||void 0===e||e.removeChild(t))}window.addEventListener("unload",_clear);const Toast=attachPropertiesToComponent(Toast$1,{show:show$1,showWarning:showWarning,showError:showError}),ImperativeComponent=e=>{const{saveUpdateTrigger:t,Component:r,unmountHandler:n}=e,o=__rest$p(e,["saveUpdateTrigger","Component","unmountHandler"]),[i,a]=reactExports.useState(o);return e.saveUpdateTrigger((e=>{a(e)})),jsxRuntimeExports.jsx(r,Object.assign({},i,{style:{display:"none"},afterEditorClose:()=>{var e;null===(e=i.afterEditorClose)||void 0===e||e.call(i),n()},autoEditorShow:!0}))},attachShowProperty=e=>attachPropertiesToComponent(e,{show(t){let r=e=>{};const n=renderToBody(jsxRuntimeExports.jsx(ImperativeComponent,Object.assign({},t,{Component:e,saveUpdateTrigger:e=>r=e,unmountHandler:()=>null==n?void 0:n()})));return{update:r,close:()=>null==n?void 0:n()}}});function toVal(e){var t,r,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=toVal(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function clsx(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=toVal(e))&&(n&&(n+=" "),n+=t);return n}const BACKGROUND_TYPE={COLOR:"color",IMAGE:"image",GRADIENT:"gradient"},IMAGE_TYPE$1={REPEAT:"repeat",STRETCH:"stretch",ADAPT:"adapt",DEFAULT:"default"},getBackgroundStyle=e=>{let t;if(e){const{type:r,value:n}=e;switch(r){case BACKGROUND_TYPE.COLOR:t=n;break;case BACKGROUND_TYPE.IMAGE:t=parseImageBackground(n);break;case BACKGROUND_TYPE.GRADIENT:t=parseGradientBackground(n)}}return t},parseImageBackground=e=>{const{data:t,layout:r,src:n}=e;let o="";return t?o=_getImageBackgroundBase64(t):n&&(o=_getImageBackgroundUrl(n)),o&&o+" "+_getImageBackgroundLayout(r)},parseGradientBackground=({beginColor:e,endColor:t,direction:r})=>"linear-gradient(".concat("horizontal"===r?"90deg":"180deg",", ").concat(e,", ").concat(t,")");function _getImageBackgroundBase64(e){return"url(data:image/png;base64,".concat(e,")")}function _getImageBackgroundUrl(e){return"url(".concat(e,")")}function _getImageBackgroundLayout(e){let t="";switch(e){case IMAGE_TYPE$1.REPEAT:t="repeat";break;case IMAGE_TYPE$1.STRETCH:t="0% 0% / 100% 100% no-repeat";break;case IMAGE_TYPE$1.ADAPT:t="center center / contain no-repeat";break;case IMAGE_TYPE$1.DEFAULT:default:t="center center no-repeat"}return t}const T$3="top",L$3="left",R$3="right",B$3="bottom";class CellStyle{static getInstance(e){const t=CellStyle.instance?CellStyle.instance:CellStyle.instance=new CellStyle;return t.resetStyleType(e),t}static stringifyStyle(e){let t="";const r=["z-index"];return forEach$3(e,((e,n)=>{if(e||0===e){n=n.replace(/([A-Z])/g,"-$1").toLowerCase(),e=isNaN(e)||r.includes(n)?e:"".concat(e,"px");const o="".concat(n,": ").concat(e,";");t+=o}})),t}static getCornerKey(e,t){return e=e.toLowerCase(),t=t.toLowerCase(),e[0].toLowerCase()+e.slice(1)+t[0].toUpperCase()+t.slice(1)}static hasBorderRadiusSize(e){return(null==e?void 0:e.radius)>0}resetStyleType(e){this.isString=e,this.style=e?"":{}}getStyle(){return this.style}setPosition(e){return forEach$3(e,((e,t)=>{this._setStyle(t,e+"px")})),this}setZIndex(e){return this._setStyle("z-index",e),this}setLineHeight(e,t="normal"){const{lineSpace:r,font:n}=e,o=r>0?"".concat(r+n.size,"px"):t;return this._setStyle("line-height",o),this}setTransform(e){return this._setStyle("transform","rotate(".concat(e,"deg)")),this}setBackground(e,t=!0){if(e){const r=t?getBackgroundStyle(e):e;r&&this._setStyle("background",r)}return this}setBorder(e={}){const t=__rest$p(e,["borderRadius"]);for(let[r,n]of Object.entries(t||{}))if(!isEmpty$3(n)){const{width:e,color:t,type:o}=n[0],i="border-".concat(r),a="".concat(e,"px ").concat(o," ").concat(t);this._setStyle(i,a)}return this}setBorderRadius(e){const t=(t,r)=>{const n="border-".concat(t,"-").concat(r,"-radius"),o="".concat(e.radius,"px");this._setStyle(n,o)},r=e[CellStyle.getCornerKey(T$3,L$3)],n=e[CellStyle.getCornerKey(T$3,R$3)],o=e[CellStyle.getCornerKey(B$3,L$3)],i=e[CellStyle.getCornerKey(B$3,R$3)];return r&&n&&o&&i?this._setStyle("border-radius","".concat(e.radius,"px")):(r&&t(T$3,L$3),n&&t(T$3,R$3),o&&t(B$3,L$3),i&&t(B$3,R$3)),this}setPadding(e){const t=e.style;let{coveredRightWidth:r=0,coveredBottomWidth:n=0}=e.position;const{top:o=0,right:i=0,bottom:a=0,left:s=0}=t.padding||{};if(o+a+n>0||s+i+r>0){const e="".concat(o,"px ").concat(i+r,"px ").concat(a+n,"px ").concat(s,"px");this._setStyle("padding",e)}return this}setFont(e={}){const{family:t,size:r,color:n,underLine:o,strikethrough:i,italic:a,bold:s,shadow:l}=e;t&&this._setStyle("font-family","'".concat(t,"'")),this._setStyle("color",n),this._setStyle("font-size",Math.round(r)+"px");const c=[];return o&&c.push("underLine"),i&&c.push("line-through"),c.length&&this._setStyle("text-decoration",c.join(" ")),a&&this._setStyle("font-style","italic"),s&&this._setStyle("font-weight","bold"),l&&this._setStyle("text-shadow","1px 1px 2px"),this}_setStyle(e,t){if(this.isString)this.style+="".concat(e,":").concat(t,";");else{const r=e.split("-").map(((e,t)=>t>0?e[0].toUpperCase()+e.slice(1):e)).join("");this.style[r]=t}}}CellStyle.instance=null;const cellUtils={getClass(e){return["pa","bsbb","oh","toe",this._getAlignClass(e)]},getCellRadiusClass(e){return this.getClass(e).concat("l0 r0 t0 b0")},getStyle(e,t,r){const n=e.style,{background:o,border:i,padding:a}=n;return CellStyle.getInstance(r).setPosition(t).setZIndex(e.zIndex).setBackground(o).setBorder(i).setPadding(e).getStyle()},getPositionStyle:(e,t,r)=>CellStyle.getInstance(r).setPosition(t).setZIndex(e.zIndex).getStyle(),getCellRadiusStyle(e,t){const r=e.style,{background:n,border:o}=r;return CellStyle.getInstance(t).setBackground(n).setBorder(o).setLineHeight(r).setPadding(e).setBorderRadius(null==o?void 0:o.borderRadius).getStyle()},getCornerStyle(e,t,r){const{h:n,v:o}=t,{radius:i,outerBackground:a}=e,s=Math.ceil(i),l={[n]:0,[o]:0,width:s,height:s},c="radial-gradient(".concat(s,"px at 100% 100%, transparent 99.99%, ").concat(a,")"),u=this._getRotateAngle(CellStyle.getCornerKey(n,o));return CellStyle.getInstance(r).setPosition(l).setBackground(c,!1).setTransform(u).getStyle()},isZeroCell(e){const{width:t,height:r}=e;return t<=0||r<=0},getCellKey:e=>"col_".concat(e.col,"_row_").concat(e.row),isNoWrap:e=>1===(null==e?void 0:e.textStyle),getBorderWidth(e,t,r=0){var n,o,i;const a=null===(n=null==e?void 0:e.style)||void 0===n?void 0:n.border;return(null===(i=null===(o=null==a?void 0:a[t])||void 0===o?void 0:o[0])||void 0===i?void 0:i.width)||r},getCellsPosition(e){const t=[];return e.forEach((e=>{e.forEach((e=>{const{col:r,colSpan:n,row:o,rowSpan:i}=e.position;for(let a=0;a<i;a++)for(let i=0;i<n;i++)t[a+o]||(t[a+o]=[]),t[a+o][i+r]=e}))})),t},_getAlignClass(e){const{verticalAlign:t,horizontalAlign:r}=e,n={left:["jcs","tal"],center:["jcc","tac"],right:["jce","tar"],top:"ais",middle:"aic",bottom:"aie"};return["df",n[t],n[r]]},_getRotateAngle(e){switch(e){case"topLeft":default:return 0;case"topRight":return 90;case"bottomRight":return 180;case"bottomLeft":return 270}}};class SortHeaderIcon extends reactExports.Component{constructor(e){super(e),this._onClick=this._onClick.bind(this)}shouldComponentUpdate(e){return!isEqual$4(this.props,e)}render(){return jsxRuntimeExports.jsx("button",Object.assign({className:"sort-icon",style:this._getStyle(),onClick:this._onClick},{children:this._getIcon()}))}_getStyle(){const e=get$5(this.props,"cell.zIndex");return{position:"absolute",right:SortHeaderIcon.MARGIN_RIGHT,zIndex:_isNumber(e)?e+1:999}}_getIcon(){const e=get$5(this.props,"cell.sortHeader",{}),{iconName:t="icon-sortable",iconColor:r}=e;return t?jsxRuntimeExports.jsx(Icon$1,{name:t,color:r}):null}_onClick(){const{row:e,col:t}=get$5(this.props,"cell.position",{});this.props.onSendCellMessage({row:e,column:t,data:{touchTarget:"icon"}})}}SortHeaderIcon.ICON_SIZE=18,SortHeaderIcon.MARGIN_LEFT=5,SortHeaderIcon.MARGIN_RIGHT=5;const findNodeHandle=e=>{let t;try{t=reactDomExports.findDOMNode(e)}catch(e3){}return t},DIRECTION$1={TOP:"Top",RIGHT:"Right",BOTTOM:"Bottom",LEFT:"Left"};class BaseCell extends reactExports.Component{constructor(e,t){super(e,t),this.handleClick=this.handleClick.bind(this),this.fontSize=0,this.state={data:cloneDeep$2(e.data)}}get cellValue(){return this.state.data.content.value}updateCell(e){this.setState({data:Object.assign({},this.state.data,e)})}getPosition(){return this.state.data.position}renderCellContent(){return""}componentWillReceiveProps(e){isEqual$4(this.state.data,e.data)||this.setState({data:cloneDeep$2(e.data)})}shouldComponentUpdate(e,t){return!isEqual$4(this.props,e)||!isEqual$4(this.state,t)}render(){const{position:e,sortHeader:t}=this.state.data,r=this._hasBorderRadius(),n=this.getStyleData();return r?jsxRuntimeExports.jsxs("div",Object.assign({onClick:this.handleClick,ref:e=>this.cell=e,style:this.getPositionStyle(),id:cellUtils.getCellKey(e),className:"pa bsbb oh"},{children:[this._getCorners(),jsxRuntimeExports.jsxs("div",Object.assign({className:clsx(this.getCellRadiusClass()),style:cellUtils.getCellRadiusStyle(this.state.data)},{children:[this.isPreviewContent()&&this.renderCellContent(),t&&this.renderSortHeaderIcon()]}))]})):jsxRuntimeExports.jsxs("div",Object.assign({onClick:this.handleClick,ref:e=>this.cell=e,style:this.getCellStyle(),id:cellUtils.getCellKey(e),className:clsx(cellUtils.getClass(n))},{children:[0!==this.getHeight()&&this.isPreviewContent()?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:this.renderCellContent()}):null,t&&this.renderSortHeaderIcon()]}))}isPreviewContent(){var e;return!1!==(null===(e=this.state.data)||void 0===e?void 0:e.previewContent)}renderSortHeaderIcon(){return jsxRuntimeExports.jsx(SortHeaderIcon,{cell:this.state.data,onSendCellMessage:this.props.onSendCellMessage})}componentDidMount(){const{saveCell:e}=this.props;return e(this.getPosition(),this)}componentWillUnmount(){const{saveCell:e}=this.props;e(this.getPosition(),null)}getCellRadiusClass(){const e=this.getStyleData();return cellUtils.getCellRadiusClass(e)}getStyleData(){return this.state.data.style}handleClick(){this.sendCellMessage()}sendCellMessage(e={}){const{left:t=0,top:r=0}=!!this.cell&&findNodeHandle(this.cell).getBoundingClientRect(),{row:n,col:o}=this.getPosition();this.props.onSendCellMessage({row:n,column:o,screenOffset:{left:t,top:r},data:e})}getCellStyle(){return cellUtils.getStyle(this.state.data,this.props.position)}getPositionStyle(){return cellUtils.getPositionStyle(this.state.data,this.props.position)}getHeight(){return this.props.position.height}getWidth(){return this.props.position.width}getContentHeight(){const e=this._getVBorderWidth()/2,t=Device.ios()?e:Math.ceil(e);return Math.max(this.getHeight()-t-this._getVerticalPadding(),0)}getContentWidth(){return Math.max(this.getWidth()-this._getHBorderWidth()/2-this._getHorizontalPadding(),0)}getFontStyle(){const{font:e}=this.getStyleData();return CellStyle.getInstance().setFont(e).getStyle()}getLineHeightStyle(e){const t=this.getStyleData();return CellStyle.getInstance().setLineHeight(t,e).getStyle()}_getCorners(){var e;const t=(null===(e=this.getStyleData().border)||void 0===e?void 0:e.borderRadius)||{},{radius:r,outerBackground:n}=t,o=[],i=(e,r)=>{const n=CellStyle.getCornerKey(e,r);if(t[n]){const n=cellUtils.getCornerStyle(t,{h:e,v:r});o.push(jsxRuntimeExports.jsx("div",{className:"pa",style:n},e+r))}};return r&&n&&(i("top","left"),i("bottom","left"),i("top","right"),i("bottom","right")),o}_getVBorderWidth(){return this._getSingleBorderWidth(DIRECTION$1.TOP)+this._getSingleBorderWidth(DIRECTION$1.BOTTOM)}_getHBorderWidth(){return this._getSingleBorderWidth(DIRECTION$1.LEFT)+this._getSingleBorderWidth(DIRECTION$1.RIGHT)}_getSingleBorderWidth(e){var t,r,n,o;return(null===(o=null===(n=null===(r=null===(t=this.getStyleData())||void 0===t?void 0:t.border)||void 0===r?void 0:r[e.toLowerCase()])||void 0===n?void 0:n[0])||void 0===o?void 0:o.width)||0}_getVerticalPadding(){const{padding:e}=this.getStyleData();return e.top+e.bottom}_getHorizontalPadding(){const{padding:e}=this.getStyleData();return e.left+e.right}_hasBorderRadius(){var e;const t=this.getStyleData();return CellStyle.hasBorderRadiusSize(null===(e=t.border)||void 0===e?void 0:e.borderRadius)}}const dataUriPattern=/^data:/;class ImageUriCache{static has(e){const t=ImageUriCache._entries;return dataUriPattern.test(e)||Boolean(t[e])}static add(e){const t=ImageUriCache._entries,r=Date.now();t[e]?(t[e].lastUsedTimestamp=r,t[e].refCount+=1):t[e]={lastUsedTimestamp:r,refCount:1}}static remove(e){const t=ImageUriCache._entries;t[e]&&(t[e].refCount-=1),ImageUriCache._cleanUpIfNeeded()}static _cleanUpIfNeeded(){const e=ImageUriCache._entries,t=Object.keys(e);if(t.length+1>ImageUriCache._maximumEntries){let r,n;t.forEach((t=>{const o=e[t];(!n||o.lastUsedTimestamp<n.lastUsedTimestamp)&&0===o.refCount&&(r=t,n=o)})),r&&delete e[r]}}}ImageUriCache._maximumEntries=256,ImageUriCache._entries={};let id$1=0;const requests={},ImageLoader={abort(e){let t=requests["".concat(e)];t&&(t.onerror=null,t.onload=null,t=void 0,delete requests["".concat(e)])},getSize(e,t,r){let n=!1;const o=setInterval(a,16),i=ImageLoader.load(e,a,(function(){"function"==typeof r&&r();ImageLoader.abort(i),clearInterval(o)}));function a(){const e=requests["".concat(i)];if(e){const{naturalHeight:r,naturalWidth:o}=e;r&&o&&(t(o,r),n=!0)}n&&(ImageLoader.abort(i),clearInterval(o))}},has:e=>ImageUriCache.has(e),load(e,t,r){id$1+=1;const n=new window.Image;return n.onerror=r,n.onload=e=>{const r=()=>t({nativeEvent:e});"function"==typeof n.decode?n.decode().then(r,r):setTimeout(r,0)},n.src=e,requests["".concat(id$1)]=n,id$1},prefetch:e=>new Promise(((t,r)=>{ImageLoader.load(e,(()=>{ImageUriCache.add(e),ImageUriCache.remove(e),t()}),r)})),queryCache(e){const t={};return e.forEach((e=>{ImageUriCache.has(e)&&(t[e]="disk/memory")})),Promise.resolve(t)}};let ImageCell$1=class extends BaseCell{constructor(e,t){super(e,t),this.state.measured=!1}renderCellContent(){const e=this.getContentHeight(),{value:t}=this.state.data.content;let{data:r}=t;const n=get$5(t,"layout","default");return this._isImageType()&&n===IMAGE_TYPE$1.DEFAULT?jsxRuntimeExports.jsx("div",Object.assign({style:{height:e},className:"df jcc aic ov f1"},{children:this.state.measured&&jsxRuntimeExports.jsx("img",{src:"data:image/png;base64,"+r,style:{transformOrigin:"center"}})})):jsxRuntimeExports.jsx("div",{style:{height:e,flex:1,background:getBackgroundStyle(Object.assign(Object.assign({},this.state.data.content),{value:Object.assign(Object.assign({},t),{layout:n})}))}})}componentDidMount(){super.componentDidMount(),this._setDefaultLayoutType()}componentDidUpdate(e,t){const r=get$5(this.state,"data.content.value.data",""),n=get$5(t,"data.content.value.data","");isEqual$4(r,n)||this._setDefaultLayoutType()}_updateMeasuredLayoutType(e){this.setState({layoutType:e,measured:!0})}_isImageType(){const{type:e,value:t}=this.state.data.content,{data:r}=t;return r&&e===BACKGROUND_TYPE.IMAGE}_isDefaultLayout(){return get$5(this.props,"data.content.value.layout","default")===IMAGE_TYPE$1.DEFAULT}_setDefaultLayoutType(){if(this._isImageType()&&this._isDefaultLayout()){const e=get$5(this.state,"data.content.value.data","");e&&ImageLoader.getSize("data:image/png;base64,"+e,((e,t)=>{e>this.getWidth()||t>this.getHeight()?this._updateMeasuredLayoutType(IMAGE_TYPE$1.REPEAT):this._updateMeasuredLayoutType(IMAGE_TYPE$1.DEFAULT)}),(()=>{this._updateMeasuredLayoutType(IMAGE_TYPE$1.DEFAULT)}))}}};class HtmlCell extends BaseCell{constructor(e,t){super(e,t)}renderCellContent(){let e=this.cellValue;return e=e.replace(/font-size:(\d+)px/g,(function(e,t){return"font-size:"+Math.round(t)+"px"})),jsxRuntimeExports.jsx("div",Object.assign({style:{height:"".concat(this.getContentHeight(),"px"),overflow:"hidden"}},{children:jsxRuntimeExports.jsx("div",{className:this.getStyleData().className,style:Object.assign(Object.assign(Object.assign(Object.assign({},this.getFontStyle()),this.getAlignStyle()),this.getLineHeightStyle(this.getStyleData().defaultLineHeight)),{width:"".concat(this.getContentWidth(),"px"),height:"".concat(this.getContentHeight(),"px"),display:"table-cell"}),dangerouslySetInnerHTML:{__html:e}})}))}getAlignStyle(){const{verticalAlign:e,horizontalAlign:t}=this.getStyleData();return{verticalAlign:e,textAlign:t}}}class ChartCell extends BaseCell{constructor(e,t){super(e,t),this.state={data:cloneDeep$2(e.data)},this._handleChartClick=this._handleChartClick.bind(this),this._handleChartEvent=this._handleChartEvent.bind(this),this.chartView=React.createRef()}updateCell(e){const t=e.content.value;this.props.data.content=e.content;let r=t.action;if("refreshSubChart"===r&&this.chartView.current){this.state.data=Object.assign({},this.state.data,e);const{subChartAttr:r,subChartIndex:n}=t.chartOptions;this.chartView.current.refreshSubChartWithConfig({subChartAttr:r,subChartIndex:n})}else if("load"===r||"refresh"===r)this.setState({data:Object.assign({},this.state.data,e)});else if("trigger"===r){const{event:e,data:r}=t.data;this.chartView.current.triggerChartEvent(e,r)}}renderCellContent(){const{chartOptions:e}=this.cellValue,t=e.chartID;e.subChartIndex;let r={},n={};return e.config?(r=e.config.options,n=e.config.refresh):e.subChartAttr&&(r=e.subChartAttr),isEmpty$3(r)?null:(r.orientation=OrientationUtils.getCurrentOrientation().toLowerCase(),jsxRuntimeExports.jsx(Chart,{vanchartRef:this.chartView,chartID:t,options:r,height:this.getContentHeight(),width:this.getContentWidth(),onClick:this._handleChartClick,onChartEventTrigger:this._handleChartEvent,refresh:n},t))}getCellRadiusClass(){return super.getCellRadiusClass().concat("wct")}_handleChartClick(e){this.sendCellMessage({type:"hyperlink",data:e})}_handleChartEvent(e){this.sendCellMessage({type:"event",data:e})}showIndexChart(e){var t;null===(t=this.chartView.current)||void 0===t||t.triggerChartEvent("showIndexChart",e)}setSeriesVisible(e){var t;null===(t=this.chartView.current)||void 0===t||t.triggerChartEvent("setSeriesVisible",e)}switchCarouselChart(e){var t;null===(t=this.chartView.current)||void 0===t||t.triggerChartEvent("switchCarouselChart",e)}}var reactArt={exports:{}},reactArt_production_min={},getOwnPropertySymbols=Object.getOwnPropertySymbols,hasOwnProperty$g=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;function toObject$1(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function shouldUseNative(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(o){return!1}}var objectAssign=shouldUseNative()?Object.assign:function(e,t){for(var r,n,o=toObject$1(e),i=1;i<arguments.length;i++){for(var a in r=Object(arguments[i]))hasOwnProperty$g.call(r,a)&&(o[a]=r[a]);if(getOwnPropertySymbols){n=getOwnPropertySymbols(r);for(var s=0;s<n.length;s++)propIsEnumerable.call(r,n[s])&&(o[n[s]]=r[n[s]])}}return o},_class$7=function(e){for(var t={},r=0,n=arguments.length;r<n;r++){var o=arguments[r];for(var i in"function"==typeof o&&(o=o.prototype),o)t[i]=o[i]}return t.initialize||(t.initialize=function(){}),t.constructor=function(e,r,n,o,i,a,s,l){return new t.initialize(e,r,n,o,i,a,s,l)},t.constructor.prototype=t.initialize.prototype=t,t.constructor},Class=_class$7;function Transform$1(e,t,r,n,o,i){return e&&"object"==typeof e&&(t=e.yx,n=e.yy,i=e.y,r=e.xy,o=e.x,e=e.xx),this.xx=null==e?1:e,this.yx=t||0,this.xy=r||0,this.yy=null==n?1:n,this.x=(null==o?this.x:o)||0,this.y=(null==i?this.y:i)||0,this._transform(),this}var transform=Class({initialize:Transform$1,_transform:function(){},xx:1,yx:0,x:0,xy:0,yy:1,y:0,transform:function(e,t,r,n,o,i){var a=this;return e&&"object"==typeof e&&(t=e.yx,n=e.yy,i=e.y,r=e.xy,o=e.x,e=e.xx),o||(o=0),i||(i=0),this.transformTo(a.xx*e+a.xy*t,a.yx*e+a.yy*t,a.xx*r+a.xy*n,a.yx*r+a.yy*n,a.xx*o+a.xy*i+a.x,a.yx*o+a.yy*i+a.y)},transformTo:Transform$1,translate:function(e,t){return this.transform(1,0,0,1,e,t)},move:function(e,t){return this.x+=e||0,this.y+=t||0,this._transform(),this},scale:function(e,t){return null==t&&(t=e),this.transform(e,0,0,t,0,0)},rotate:function(e,t,r){null!=t&&null!=r||(t=(this.left||0)+(this.width||0)/2,r=(this.top||0)+(this.height||0)/2);var n=e*Math.PI/180,o=Math.sin(n),i=Math.cos(n);this.transform(1,0,0,1,t,r);var a=this;return this.transformTo(i*a.xx-o*a.yx,o*a.xx+i*a.yx,i*a.xy-o*a.yy,o*a.xy+i*a.yy,a.x,a.y).transform(1,0,0,1,-t,-r)},moveTo:function(e,t){var r=this;return this.transformTo(r.xx,r.yx,r.xy,r.yy,e,t)},rotateTo:function(e,t,r){var n=this,o=n.yx/n.xx>n.yy/n.xy?-1:1;return(n.xx<0?n.xy>=0:n.xy<0)&&(o=-o),this.rotate(e-180*Math.atan2(o*n.yx,o*n.xx)/Math.PI,t,r)},scaleTo:function(e,t){var r=this,n=Math.sqrt(r.xx*r.xx+r.yx*r.yx);return r.xx/=n,r.yx/=n,n=Math.sqrt(r.yy*r.yy+r.xy*r.xy),r.yy/=n,r.xy/=n,this.scale(e,t)},resizeTo:function(e,t){var r=this.width,n=this.height;return r&&n?this.scaleTo(e/r,t/n):this},inversePoint:function(e,t){var r=this.xx,n=this.yx,o=this.xy,i=this.yy,a=this.x,s=this.y,l=n*o-r*i;return 0==l?null:{x:(i*(a-e)+o*(t-s))/l,y:(r*(s-t)+n*(e-a))/l}},point:function(e,t){var r=this;return{x:r.xx*e+r.xy*t+r.x,y:r.yx*e+r.yy*t+r.y}}}),current={};!function(e){function t(){throw new Error("You must require a mode before requiring anything else.")}e.Surface=t,e.Path=t,e.Shape=t,e.Group=t,e.ClippingRectangle=t,e.Text=t,e.setCurrent=function(t){for(var r in t)e[r]=t[r]}}(current);var scheduler={exports:{}},scheduler_production_min={};!function(e){var t,r,n,o;if("object"==typeof performance&&"function"==typeof performance.now){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,s=a.now();e.unstable_now=function(){return a.now()-s}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var l=null,c=null,u=function(){if(null!==l)try{var t=e.unstable_now();l(!0,t),l=null}catch(r){throw setTimeout(u,0),r}};t=function(e){null!==l?setTimeout(t,0,e):(l=e,setTimeout(u,0))},r=function(e,t){c=setTimeout(e,t)},n=function(){clearTimeout(c)},e.unstable_shouldYield=function(){return!1},o=e.unstable_forceFrameRate=function(){}}else{var d=window.setTimeout,h=window.clearTimeout;if("undefined"!=typeof console){var p=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof p&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var f=!1,g=null,m=-1,y=5,v=0;e.unstable_shouldYield=function(){return e.unstable_now()>=v},o=function(){},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<e?Math.floor(1e3/e):5};var _=new MessageChannel,b=_.port2;_.port1.onmessage=function(){if(null!==g){var t=e.unstable_now();v=t+y;try{g(!0,t)?b.postMessage(null):(f=!1,g=null)}catch(r){throw b.postMessage(null),r}}else f=!1},t=function(e){g=e,f||(f=!0,b.postMessage(null))},r=function(t,r){m=d((function(){t(e.unstable_now())}),r)},n=function(){h(m),m=-1}}function C(e,t){var r=e.length;e.push(t);e:for(;;){var n=r-1>>>1,o=e[n];if(!(void 0!==o&&0<S(o,t)))break e;e[n]=t,e[r]=o,r=n}}function E(e){return void 0===(e=e[0])?null:e}function T(e){var t=e[0];if(void 0!==t){var r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,o=e.length;n<o;){var i=2*(n+1)-1,a=e[i],s=i+1,l=e[s];if(void 0!==a&&0>S(a,r))void 0!==l&&0>S(l,a)?(e[n]=l,e[s]=r,n=s):(e[n]=a,e[i]=r,n=i);else{if(!(void 0!==l&&0>S(l,r)))break e;e[n]=l,e[s]=r,n=s}}}return t}return null}function S(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}var P=[],w=[],x=1,O=null,$=3,I=!1,R=!1,A=!1;function D(e){for(var t=E(w);null!==t;){if(null===t.callback)T(w);else{if(!(t.startTime<=e))break;T(w),t.sortIndex=t.expirationTime,C(P,t)}t=E(w)}}function L(e){if(A=!1,D(e),!R)if(null!==E(P))R=!0,t(N);else{var n=E(w);null!==n&&r(L,n.startTime-e)}}function N(t,o){R=!1,A&&(A=!1,n()),I=!0;var i=$;try{for(D(o),O=E(P);null!==O&&(!(O.expirationTime>o)||t&&!e.unstable_shouldYield());){var a=O.callback;if("function"==typeof a){O.callback=null,$=O.priorityLevel;var s=a(O.expirationTime<=o);o=e.unstable_now(),"function"==typeof s?O.callback=s:O===E(P)&&T(P),D(o)}else T(P);O=E(P)}if(null!==O)var l=!0;else{var c=E(w);null!==c&&r(L,c.startTime-o),l=!1}return l}finally{O=null,$=i,I=!1}}var M=o;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){R||I||(R=!0,t(N))},e.unstable_getCurrentPriorityLevel=function(){return $},e.unstable_getFirstCallbackNode=function(){return E(P)},e.unstable_next=function(e){switch($){case 1:case 2:case 3:var t=3;break;default:t=$}var r=$;$=t;try{return e()}finally{$=r}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=M,e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=$;$=e;try{return t()}finally{$=r}},e.unstable_scheduleCallback=function(o,i,a){var s=e.unstable_now();switch("object"==typeof a&&null!==a?a="number"==typeof(a=a.delay)&&0<a?s+a:s:a=s,o){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return o={id:x++,callback:i,priorityLevel:o,startTime:a,expirationTime:l=a+l,sortIndex:-1},a>s?(o.sortIndex=a,C(w,o),null===E(P)&&o===E(w)&&(A?n():A=!0,r(L,a-s))):(o.sortIndex=l,C(P,o),R||I||(R=!0,t(N))),o},e.unstable_wrapCallback=function(e){var t=$;return function(){var r=$;$=t;try{return e.apply(this,arguments)}finally{$=r}}}}(scheduler_production_min),scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports,fastNoSideEffects={},container,hasRequiredContainer,native,hasRequiredNative,surface$1,hasRequiredSurface$1,path$2,hasRequiredPath$2,path$1,hasRequiredPath$1,color,hasRequiredColor,dummy,hasRequiredDummy,node$1,hasRequiredNode$1,base$1,hasRequiredBase$1,shape$1,hasRequiredShape$1,group$1,hasRequiredGroup$1,clippingrectangle$1,hasRequiredClippingrectangle$1,text$1,hasRequiredText$1;function requireContainer(){return hasRequiredContainer||(hasRequiredContainer=1,container=_class$7({grab:function(){for(var e=0;e<arguments.length;e++)arguments[e].inject(this);return this},empty:function(){for(var e;e=this.firstChild;)e.eject();return this}})),container}function requireNative(){if(hasRequiredNative)return native;function e(e){return e.toElement?e.toElement():e.getDOMNode?e.getDOMNode():e.getNode?e.getNode():e}return hasRequiredNative=1,native=_class$7({toElement:function(){return this.element},getDOMNode:function(){return this.toElement()},getNode:function(){return this.toElement()},inject:function(t){return(t.containerElement||e(t)).appendChild(this.element),this},injectBefore:function(t){var r=e(t);return r.parentNode.insertBefore(this.element,r),this},eject:function(){var e=this.element,t=e.parentNode;return t&&t.removeChild(e),this},subscribe:function(e,t,r){if("string"!=typeof e){var n=[];for(var o in e)n.push(this.subscribe(o,e[o]));return function(){for(var e=0,t=n.length;e<t;e++)n[e]();return this}}var i;r||(r=this),i="function"==typeof t?t.bind?t.bind(r):function(){return t.apply(r,arguments)}:t;var a=this.element;return a.addEventListener?(a.addEventListener(e,i,!1),function(){return a.removeEventListener(e,i,!1),this}):(a.attachEvent("on"+e,i),function(){return a.detachEvent("on"+e,i),this})}}),native}function requireSurface$1(){if(hasRequiredSurface$1)return surface$1;hasRequiredSurface$1=1;var e,t=_class$7,r=requireContainer(),n=requireNative(),o=1e3/60,i=[],a=function(){clearTimeout(e),e=null;var t=i;i=[];for(var r=0,n=t.length;r<n;r++){var o=t[r];o._valid=!0,o.render()}},s="undefined"!=typeof window&&window.devicePixelRatio||1,l=null,c=null,u=t(n,r,{initialize:function(e,t,r){var n=this.element=r||document.createElement("canvas");this.context=n.getContext("2d"),this._valid=!0,null!=e&&null!=t&&this.resize(e,t),n.addEventListener("mousemove",this,!1),n.addEventListener("mouseout",this,!1),n.addEventListener("mouseover",this,!1),n.addEventListener("mouseup",this,!1),n.addEventListener("mousedown",this,!1),n.addEventListener("click",this,!1)},handleEvent:function(e){if(null!=e.clientX){var t=this.element,r=t.getBoundingClientRect(),n=e.clientX-r.left-t.clientLeft,o=e.clientY-r.top-t.clientTop,i=this.hitTest(n,o);i!==l&&(l&&l.dispatch({type:"mouseout",target:l,relatedTarget:i,sourceEvent:e}),i&&i.dispatch({type:"mouseover",target:i,relatedTarget:l,sourceEvent:e}),l=i,c=this,this.refreshCursor()),i&&i.dispatch(e)}},refreshCursor:function(){if(c===this){for(var e=l,t="",r="";e&&(t||!e._cursor||(t=e._cursor,!r))&&(r||!e._tooltip||(r=e._tooltip,!t));)e=e.parentNode;this.element.style.cursor=t,this.element.title=r}},resize:function(e,t){var r=this.element;return r.setAttribute("width",e*s),r.setAttribute("height",t*s),r.style.width=e+"px",r.style.height=t+"px",this.width=e,this.height=t,this},invalidate:function(t,r,n,s){return this._valid&&(this._valid=!1,i.push(this),e||(window.mozRequestAnimationFrame?(e=!0,window.mozRequestAnimationFrame(a)):e=setTimeout(a,o))),this},hitTest:function(e,t){if(e<0||t<0||e>this.width||t>this.height)return null;for(var r=this.lastChild;r;){var n=r.hitTest(e,t);if(n)return n;r=r.previousSibling}return null},render:function(){var e=this.firstChild,t=this.context;for(t.setTransform(s,0,0,s,0,0),t.clearRect(0,0,this.width,this.height);e;)e.renderTo(t,s,0,0,s,0,0),e=e.nextSibling;this.refreshCursor()}});return u.tagName="canvas",surface$1=u}function requirePath$2(){return hasRequiredPath$2||(hasRequiredPath$2=1,path$2=_class$7({initialize:function(e){this.reset().push(e)},push:function(){var e=Array.prototype.join.call(arguments," ").match(/[a-df-z]|[\-+]?(?:[\d\.]e[\-+]?|[^\s\-+,a-z])+/gi);if(!e)return this;for(var t,r=e[0],n=1;r;){switch(r){case"m":this.move(e[n++],e[n++]);break;case"l":this.line(e[n++],e[n++]);break;case"c":this.curve(e[n++],e[n++],e[n++],e[n++],e[n++],e[n++]);break;case"s":this.curve(e[n++],e[n++],null,null,e[n++],e[n++]);break;case"q":this.curve(e[n++],e[n++],e[n++],e[n++]);break;case"t":this.curve(e[n++],e[n++]);break;case"a":this.arc(e[n+5],e[n+6],e[n],e[n+1],e[n+3],!+e[n+4],e[n+2]),n+=7;break;case"h":this.line(e[n++],0);break;case"v":this.line(0,e[n++]);break;case"M":this.moveTo(e[n++],e[n++]);break;case"L":this.lineTo(e[n++],e[n++]);break;case"C":this.curveTo(e[n++],e[n++],e[n++],e[n++],e[n++],e[n++]);break;case"S":this.curveTo(e[n++],e[n++],null,null,e[n++],e[n++]);break;case"Q":this.curveTo(e[n++],e[n++],e[n++],e[n++]);break;case"T":this.curveTo(e[n++],e[n++]);break;case"A":this.arcTo(e[n+5],e[n+6],e[n],e[n+1],e[n+3],!+e[n+4],e[n+2]),n+=7;break;case"H":this.lineTo(e[n++],this.penY);break;case"V":this.lineTo(this.penX,e[n++]);break;case"Z":case"z":this.close();break;default:r=t,n--;continue}"m"==(t=r)?t="l":"M"==t&&(t="L"),r=e[n++]}return this},reset:function(){return this.penX=this.penY=0,this.penDownX=this.penDownY=null,this._pivotX=this._pivotY=0,this.onReset(),this},move:function(e,t){return this.onMove(this.penX,this.penY,this._pivotX=this.penX+=+e,this._pivotY=this.penY+=+t),this},moveTo:function(e,t){return this.onMove(this.penX,this.penY,this._pivotX=this.penX=+e,this._pivotY=this.penY=+t),this},line:function(e,t){return this.lineTo(this.penX+ +e,this.penY+ +t)},lineTo:function(e,t){return null==this.penDownX&&(this.penDownX=this.penX,this.penDownY=this.penY),this.onLine(this.penX,this.penY,this._pivotX=this.penX=+e,this._pivotY=this.penY=+t),this},curve:function(e,t,r,n,o,i){var a=this.penX,s=this.penY;return this.curveTo(a+ +e,s+ +t,null==r?null:a+ +r,null==n?null:s+ +n,null==o?null:a+ +o,null==i?null:s+ +i)},curveTo:function(e,t,r,n,o,i){var a=this.penX,s=this.penY;return null==r&&(r=+e,n=+t,e=2*a-(this._pivotX||0),t=2*s-(this._pivotY||0)),null==o?(this._pivotX=+e,this._pivotY=+t,r=((o=+r)+2*+e)/3,n=((i=+n)+2*+t)/3,e=(a+2*+e)/3,t=(s+2*+t)/3):(this._pivotX=+r,this._pivotY=+n),null==this.penDownX&&(this.penDownX=a,this.penDownY=s),this.onBezierCurve(a,s,+e,+t,+r,+n,this.penX=+o,this.penY=+i),this},arc:function(e,t,r,n,o,i,a){return this.arcTo(this.penX+ +e,this.penY+ +t,r,n,o,i,a)},arcTo:function(e,t,r,n,o,i,a){if(n=Math.abs(+n||+r||+t-this.penY),!(r=Math.abs(+r||+e-this.penX))||!n||e==this.penX&&t==this.penY)return this.lineTo(e,t);var s=this.penX,l=this.penY,c=!+i,u=!!+o,d=a?a*Math.PI/180:0,h=Math.cos(d),p=Math.sin(d),f=h*(e-=s)/2+p*(t-=l)/2,g=-p*e/2+h*t/2,m=r*r*n*n,y=n*n*f*f,v=r*r*g*g,_=m-v-y;if(_<0)r*=_=Math.sqrt(1-_/m),n*=_,f=e/2,g=t/2;else{_=Math.sqrt(_/(v+y)),u==c&&(_=-_);var b=-_*g*r/n,C=_*f*n/r;f=h*b-p*C+e/2,g=p*b+h*C+t/2}var E=h/r,T=p/r,S=-p/n,P=h/n,w=Math.atan2(S*-f+P*-g,E*-f+T*-g),x=Math.atan2(S*(e-f)+P*(t-g),E*(e-f)+T*(t-g));return f+=s,g+=l,e+=s,t+=l,null==this.penDownX&&(this.penDownX=this.penX,this.penDownY=this.penY),this.onArc(s,l,this._pivotX=this.penX=e,this._pivotY=this.penY=t,f,g,r,n,w,x,!c,a),this},counterArc:function(e,t,r,n,o){return this.arc(e,t,r,n,o,!0)},counterArcTo:function(e,t,r,n,o){return this.arcTo(e,t,r,n,o,!0)},close:function(){return null!=this.penDownX&&(this.onClose(this.penX,this.penY,this.penX=this.penDownX,this.penY=this.penDownY),this.penDownX=null),this},onReset:function(){},onMove:function(e,t,r,n){},onLine:function(e,t,r,n){this.onBezierCurve(e,t,e,t,r,n,r,n)},onBezierCurve:function(e,t,r,n,o,i,a,s){var l,c,u,d,h,p=a-e,f=s-t,g=p*p+f*f;if((h=(u=r-e)*p+(d=n-t)*f)>g?(u-=p,d-=f):h>0&&0!=g&&(u-=h/g*p,d-=h/g*f),l=u*u+d*d,(h=(u=o-e)*p+(d=i-t)*f)>g?(u-=p,d-=f):h>0&&0!=g&&(u-=h/g*p,d-=h/g*f),c=u*u+d*d,l<.01&&c<.01)this.onLine(e,t,a,s);else{if(isNaN(l)||isNaN(c))throw new Error("Bad input");var m=.5*(r+o),y=.5*(n+i),v=.5*(r+e),_=.5*(n+t),b=.5*(v+m),C=.5*(_+y),E=.5*(a+o),T=.5*(s+i),S=.5*(E+m),P=.5*(T+y),w=.5*(b+S),x=.5*(C+P);this.onBezierCurve(e,t,v,_,b,C,w,x),this.onBezierCurve(w,x,S,P,E,T,a,s)}},onArc:function(e,t,r,n,o,i,a,s,l,c,u,d){var h=d?d*Math.PI/180:0,p=Math.cos(h),f=Math.sin(h),g=p*a,m=-f*s,y=f*a,v=p*s,_=c-l;_<0&&!u?_+=2*Math.PI:_>0&&u&&(_-=2*Math.PI);for(var b=Math.ceil(Math.abs(_/(Math.PI/2))),C=_/b,E=4/3*Math.tan(C/4),T=Math.cos(l),S=Math.sin(l),P=0;P<b;P++){var w=T-E*S,x=S+E*T;l+=C;var O=(T=Math.cos(l))+E*(S=Math.sin(l)),$=S-E*T;this.onBezierCurve(e,t,o+g*w+m*x,i+y*w+v*x,o+g*O+m*$,i+y*O+v*$,e=o+g*T+m*S,t=i+y*T+v*S)}},onClose:function(e,t,r,n){this.onLine(e,t,r,n)}})),path$2}function requirePath$1(){if(hasRequiredPath$1)return path$1;hasRequiredPath$1=1;var e=_class$7,t=requirePath$2(),r=e(t,{initialize:function(e){this.reset(),e instanceof r?this.path=e.path.slice(0):e&&(e.applyToPath?e.applyToPath(this):this.push(e))},onReset:function(){this.path=[]},onMove:function(e,t,r,n){this.path.push((function(e){e.moveTo(r,n)}))},onLine:function(e,t,r,n){this.path.push((function(e){e.lineTo(r,n)}))},onBezierCurve:function(e,t,r,n,o,i,a,s){this.path.push((function(e){e.bezierCurveTo(r,n,o,i,a,s)}))},_arcToBezier:t.prototype.onArc,onArc:function(e,t,r,n,o,i,a,s,l,c,u,d){if(a!=s||d)return this._arcToBezier(e,t,r,n,o,i,a,s,l,c,u,d);this.path.push((function(e){e.arc(o,i,a,l,c,u)}))},onClose:function(){this.path.push((function(e){e.closePath()}))},toCommands:function(){return this.path.slice(0)}});return path$1=r}function requireColor(){if(hasRequiredColor)return color;hasRequiredColor=1;var e={maroon:"#800000",red:"#ff0000",orange:"#ffA500",yellow:"#ffff00",olive:"#808000",purple:"#800080",fuchsia:"#ff00ff",white:"#ffffff",lime:"#00ff00",green:"#008000",navy:"#000080",blue:"#0000ff",aqua:"#00ffff",teal:"#008080",black:"#000000",silver:"#c0c0c0",gray:"#808080"},t=function(e,t){for(var r=[],n=0,o=e.length;n<o;n++)r[n]=t(e[n],n);return r},r=function(t,n){if(t.isColor)this.red=t.red,this.green=t.green,this.blue=t.blue,this.alpha=t.alpha;else{var o=e[t];switch(o&&(t=o,n="hex"),typeof t){case"string":n||(n=(n=t.match(/^rgb|^hsb|^hsl/))?n[0]:"hex");break;case"object":n=n||"rgb",t=t.toString();break;case"number":n="hex",t=t.toString(16)}t=r["parse"+n.toUpperCase()](t),this.red=t[0],this.green=t[1],this.blue=t[2],this.alpha=t[3]}this.isColor=!0},n=function(e,t,r){return Math.min(r,Math.max(t,e))},o=/([-.\d]+\%?)\s*,\s*([-.\d]+\%?)\s*,\s*([-.\d]+\%?)\s*,?\s*([-.\d]*\%?)/,i=/^#?([a-f0-9]{1,2})([a-f0-9]{1,2})([a-f0-9]{1,2})([a-f0-9]{0,2})$/i;r.parseRGB=function(e){return t(e.match(o).slice(1),(function(e,t){return e&&(e=parseFloat(e)*("%"==e[e.length-1]?2.55:1)),t<3?Math.round((e%=256)<0?e+256:e):n(""===e?1:Number(e),0,1)}))},r.parseHEX=function(e){return 1==e.length&&(e=e+e+e),t(e.match(i).slice(1),(function(e,t){return 3==t?e?parseInt(e,16)/255:1:parseInt(1==e.length?e+e:e,16)}))},r.parseHSB=function(e){var r=t(e.match(o).slice(1),(function(e,t){return e&&(e=parseFloat(e)),0===t?Math.round((e%=360)<0?e+360:e):t<3?n(Math.round(e),0,100):n(""===e?1:Number(e),0,1)})),i=r[3],a=Math.round(r[2]/100*255);if(0==r[1])return[a,a,a,i];var s=r[0],l=s%60,c=Math.round(r[2]*(100-r[1])/1e4*255),u=Math.round(r[2]*(6e3-r[1]*l)/6e5*255),d=Math.round(r[2]*(6e3-r[1]*(60-l))/6e5*255);switch(Math.floor(s/60)){case 0:return[a,d,c,i];case 1:return[u,a,c,i];case 2:return[c,a,d,i];case 3:return[c,u,a,i];case 4:return[d,c,a,i];default:return[a,c,u,i]}},r.parseHSL=function(e){var r=t(e.match(o).slice(1),(function(e,t){return e&&(e=parseFloat(e)),0===t?Math.round((e%=360)<0?e+360:e):t<3?n(Math.round(e),0,100):n(""===e?1:Number(e),0,1)})),i=r[0]/60,a=r[1]/100,s=r[2]/100,l=r[3],c=(1-Math.abs(2*s-1))*a,u=c*(1-Math.abs(i%2-1)),d=s-c/2,h=Math.round(255*(c+d)),p=Math.round(255*(u+d)),f=Math.round(255*d);switch(Math.floor(i)){case 0:return[h,p,f,l];case 1:return[p,h,f,l];case 2:return[f,h,p,l];case 3:return[f,p,h,l];case 4:return[p,f,h,l];default:return[h,f,p,l]}};var a=function(e,t){return 1!=t[3]?e+="a":t.pop(),e+"("+t.join(", ")+")"};return r.prototype={toHSB:function(e){var t=this.red,r=this.green,n=this.blue,o=this.alpha,i=Math.max(t,r,n),s=i-Math.min(t,r,n),l=0,c=0!=s?s/i:0,u=i/255;if(c){var d=(i-t)/s,h=(i-r)/s,p=(i-n)/s;l=t==i?p-h:r==i?2+d-p:4+h-d,(l/=6)<0&&l++}var f=[Math.round(360*l),Math.round(100*c),Math.round(100*u),o];return e?f:a("hsb",f)},toHSL:function(e){var t=this.red,r=this.green,n=this.blue,o=this.alpha,i=Math.max(t,r,n),s=Math.min(t,r,n),l=i-s,c=0,u=0!=l?l/(255-Math.abs(i+s-255)):0,d=(i+s)/512;if(u){var h=(i-t)/l,p=(i-r)/l,f=(i-n)/l;c=t==i?f-p:r==i?2+h-f:4+p-h,(c/=6)<0&&c++}var g=[Math.round(360*c),Math.round(100*u),Math.round(100*d),o];return e?g:a("hsl",g)},toHEX:function(e){var r=this.alpha,n=1==(r=Math.round(255*r).toString(16)).length?r+r:r,o=t([this.red,this.green,this.blue],(function(e){return 1==(e=e.toString(16)).length?"0"+e:e}));return e?o.concat(n):"#"+o.join("")+("ff"==n?"":n)},toRGB:function(e){var t=[this.red,this.green,this.blue,this.alpha];return e?t:a("rgb",t)}},r.prototype.toString=r.prototype.toRGB,r.hex=function(e){return new r(e,"hex")},null==commonjsGlobal$1.hex&&(commonjsGlobal$1.hex=r.hex),r.hsb=function(e,t,n,o){return new r([e||0,t||0,n||0,null==o?1:o],"hsb")},null==commonjsGlobal$1.hsb&&(commonjsGlobal$1.hsb=r.hsb),r.hsl=function(e,t,n,o){return new r([e||0,t||0,n||0,null==o?1:o],"hsl")},null==commonjsGlobal$1.hsl&&(commonjsGlobal$1.hsl=r.hsl),r.rgb=function(e,t,n,o){return new r([e||0,t||0,n||0,null==o?1:o],"rgb")},null==commonjsGlobal$1.rgb&&(commonjsGlobal$1.rgb=r.rgb),r.detach=function(e){return e=new r(e),[r.rgb(e.red,e.green,e.blue).toString(),e.alpha]},color=r}function requireDummy(){return hasRequiredDummy||(hasRequiredDummy=1,dummy=_class$7({_resetPlacement:function(){var e=this.parentNode;if(e){var t=this.previousSibling,r=this.nextSibling;t?t.nextSibling=r:e.firstChild=r,r?r.previousSibling=t:e.lastChild=this.previousSibling}return this.previousSibling=null,this.nextSibling=null,this.parentNode=null,this},inject:function(e){this._resetPlacement();var t=e.lastChild;return t?(t.nextSibling=this,this.previousSibling=t):e.firstChild=this,e.lastChild=this,this.parentNode=e,this._place(),this},injectBefore:function(e){this._resetPlacement();var t=e.parentNode;if(!t)return this;var r=e.previousSibling;return r?(r.nextSibling=this,this.previousSibling=r):t.firstChild=this,e.previousSibling=this,this.nextSibling=e,this.parentNode=t,this._place(),this},eject:function(){return this._resetPlacement(),this._place(),this},_place:function(){},dispatch:function(e){var t=this._events,r=t&&t[e.type];if(r)for(var n=0,o=(r=r.slice(0)).length;n<o;n++){var i=r[n];!1===("function"==typeof i?i.call(this,e):i.handleEvent(e))&&e.preventDefault()}this.parentNode&&this.parentNode.dispatch&&this.parentNode.dispatch(e)},subscribe:function(e,t,r){if("string"!=typeof e){var n=[];for(var o in e)n.push(this.subscribe(o,e[o]));return function(){for(var e=0,t=n.length;e<t;e++)n[e]();return this}}var i="function"==typeof t?t.bind(r||this):t,a=this._events||(this._events={}),s=a[e]||(a[e]=[]);return s.push(i),function(){for(var e=0,t=s.length;e<t;e++)if(s[e]===i){s.splice(e,1);break}}}})),dummy}function requireNode$1(){if(hasRequiredNode$1)return node$1;hasRequiredNode$1=1;var e=_class$7(transform,requireDummy(),{invalidate:function(){return this.parentNode&&this.parentNode.invalidate(),this._layer&&(this._layerCache=null),this},_place:function(){this.invalidate()},_transform:function(){this.invalidate()},blend:function(e){return e>=1&&this._layer&&(this._layer=null),this._opacity=e,this.parentNode&&this.parentNode.invalidate(),this},hide:function(){return this._invisible=!0,this.parentNode&&this.parentNode.invalidate(),this},show:function(){return this._invisible=!1,this.parentNode&&this.parentNode.invalidate(),this},indicate:function(e,t){return this._cursor=e,this._tooltip=t,this.invalidate()},hitTest:function(e,t){if(this._invisible)return null;var r=this.inversePoint(e,t);return r?this.localHitTest(r.x,r.y):null},renderTo:function(e,t,r,n,o,i,a){var s=this._opacity;if(null==s||s>=1)return this.renderLayerTo(e,t,r,n,o,i,a);var l,c=this._layer,u=!0,d=e.canvas.width,h=e.canvas.height;if(c)if(c.setTransform(1,0,0,1,0,0),(l=c.canvas).width<d||l.height<h)l.width=d,l.height=h;else{var p=this._layerCache;p&&p.xx===t&&p.yx===r&&p.xy===n&&p.yy===o&&p.x===i&&p.y===a?u=!1:c.clearRect(0,0,d,h)}else(l=document.createElement("canvas")).width=d,l.height=h,this._layer=c=l.getContext("2d");u&&(this.renderLayerTo(c,t,r,n,o,i,a),this._layerCache={xx:t,yx:r,xy:n,yy:o,x:i,y:a}),e.globalAlpha=s,e.setTransform(1,0,0,1,0,0),e.drawImage(l,0,0,d,h,0,0,d,h),e.globalAlpha=1}});return node$1=e}function requireBase$1(){if(hasRequiredBase$1)return base$1;hasRequiredBase$1=1;var e=_class$7,t=requireColor(),r=transform,n=requireNode$1(),o="undefined"!=typeof document&&document.createElement("canvas"),i=o&&o.getContext&&o.getContext("2d");var a=e(n,{initialize:function(){this._fill=null,this._pendingFill=null,this._fillTransform=null,this._stroke=null,this._strokeCap=null,this._strokeDash=null,this._strokeJoin=null,this._strokeWidth=null},_addColors:function(e,r){if("length"in r)for(var n=0,o=r.length-1;n<=o;n++)e.addColorStop(n/o,new t(r[n]).toString());else for(var i in r)e.addColorStop(i,new t(r[i]).toString());return e},fill:function(e){return arguments.length>1?this.fillLinear(arguments):(this._pendingFill&&this._pendingFill(),this._fill=e?new t(e).toString():null,this.invalidate())},fillRadial:function(e,n,o,a,s,l,c){if(null==n&&(n=(this.left||0)+.5*(this.width||0)),null==o&&(o=(this.top||0)+.5*(this.height||0)),null==s&&(s=a||.5*this.height||0),null==a&&(a=.5*(this.width||0)),null==l&&(l=n),null==c&&(c=o),l+=l-n,c+=c-o,0===a||"0"===a)return this.fillLinear(e);var u=s/a;this._pendingFill&&this._pendingFill();var d=i.createRadialGradient(n,o/u,0,l,c/u,2*a);if("length"in e)for(var h=0,p=e.length-1;h<=p;h++)d.addColorStop(h/p/2,new t(e[h]).toString()),d.addColorStop(1-h/p/2,new t(e[h]).toString());else for(var f in e)d.addColorStop(f/2,new t(e[f]).toString()),d.addColorStop(1-f/2,new t(e[f]).toString());return this._fill=d,this._fillTransform=new r(1,0,0,u),this.invalidate()},fillLinear:function(e,t,n,o,a){if(arguments.length<5){var s=(null==t?270:t)*Math.PI/180,l=Math.cos(s),c=-Math.sin(s),u=(Math.abs(l)+Math.abs(c))/2,d=this.width||1,h=this.height||1;t=.5-(l*=u),o=.5+l,n=.5-(c*=u),a=.5+c,this._fillTransform=new r(d,0,0,h)}else this._fillTransform=null;this._pendingFill&&this._pendingFill();var p=i.createLinearGradient(t,n,o,a);return this._addColors(p,e),this._fill=p,this.invalidate()},fillImage:function(e,t,r,n,o,i,a){this._pendingFill&&this._pendingFill();var s=e;if(s instanceof Image||((s=new Image).src=e),s.width&&s.height)return this._fillImage(s,t,r,n||0,o||0,i,a);this._fill=null;var l=this,c=function(){u(),l._fillImage(s,t,r,n||0,o||0,i,a)},u=function(){s.removeEventListener("load",c,!1),l._pendingFill=null};return this._pendingFill=u,s.addEventListener("load",c,!1),this},_fillImage:function(e,n,o,a,s,l,c){var u=n?n/e.width:1,d=o?o/e.height:1;return null!=l&&(e=function(e,r,n){r=t.detach(r),n=t.detach(n);var o=document.createElement("canvas"),i=o.getContext("2d");return o.width=e.width,o.height=e.height,i.fillStyle=n[0],i.fillRect(0,0,e.width,e.height),i.globalCompositeOperation="lighter",i.drawImage(e,0,0),o}(e,l,c)),this._fill=i.createPattern(e,"repeat"),this._fillTransform=new r(u,0,0,d,a||0,s||0),this.invalidate()},stroke:function(e,r,n,o,i){return this._stroke=e?new t(e).toString():null,this._strokeWidth=null!=r?r:1,this._strokeCap=null!=n?n:"round",this._strokeJoin=null!=o?o:"round",this._strokeDash=i,this.invalidate()},element_renderTo:n.prototype.renderTo,renderTo:function(e,t,r,n,o,i,a){var s=this._opacity;if(null==s||s>=1)return this.renderLayerTo(e,t,r,n,o,i,a);if(this._fill&&this._stroke)return this.element_renderTo(e,t,r,n,o,i,a);e.globalAlpha=s;var l=this.renderLayerTo(e,t,r,n,o,i,a);return e.globalAlpha=1,l},renderLayerTo:function(e,t,r,n,o,i,a){e.setTransform(t,r,n,o,i,a),this.renderShapeTo(e)}});return a._genericContext=i,base$1=a}function requireShape$1(){if(hasRequiredShape$1)return shape$1;hasRequiredShape$1=1;var e=_class$7,t=requireBase$1(),r=requirePath$1();return shape$1=e(t,{base_initialize:t.prototype.initialize,initialize:function(e,t,r){this.base_initialize(),this.width=t,this.height=r,null!=e&&this.draw(e)},draw:function(e,t,n){return e instanceof r||(e=new r(e)),this.path=e,this._commands=e.toCommands(),null!=t&&(this.width=t),null!=n&&(this.height=n),this.invalidate()},localHitTest:function(e,r){if(!this._fill)return null;if(null==this.width||null==this.height){var n=t._genericContext,o=this._commands;if(!o)return null;n.beginPath();for(var i=0,a=o.length;i<a;i++)o[i](n);return n.isPointInPath(e,r)?this:null}return e>0&&r>0&&e<this.width&&r<this.height?this:null},renderShapeTo:function(e){if(this._invisible||!this._commands||!this._fill&&!this._stroke)return null;e.transform(this.xx,this.yx,this.xy,this.yy,this.x,this.y);var t=this._commands,r=this._fill,n=this._stroke,o=this._strokeDash;e.beginPath(),o?e.setLineDash?e.setLineDash(o):e.mozDash=o:e.setLineDash?e.setLineDash([]):e.mozDash=null;for(var i=0,a=t.length;i<a;i++)t[i](e);if(r){var s=this._fillTransform;s?(e.save(),e.transform(s.xx,s.yx,s.xy,s.yy,s.x,s.y),e.fillStyle=r,e.fill(),e.restore()):(e.fillStyle=r,e.fill())}n&&(e.strokeStyle=n,e.lineWidth=this._strokeWidth,e.lineCap=this._strokeCap,e.lineJoin=this._strokeJoin,e.stroke())}}),shape$1}function requireGroup$1(){if(hasRequiredGroup$1)return group$1;hasRequiredGroup$1=1;var e=_class$7,t=requireContainer(),r=requireNode$1();return group$1=e(r,t,{initialize:function(e,t){this.width=e,this.height=t},localHitTest:function(e,t){for(var r=this.lastChild;r;){var n=r.hitTest(e,t);if(n)return n;r=r.previousSibling}return null},renderLayerTo:function(e,t,r,n,o,i,a){if(!this._invisible){i=t*this.x+n*this.y+i,a=r*this.x+o*this.y+a;var s=t;t=s*this.xx+n*this.yx,n=s*this.xy+n*this.yy,r=(s=r)*this.xx+o*this.yx,o=s*this.xy+o*this.yy;for(var l=this.firstChild;l;)l.renderTo(e,t,r,n,o,i,a),l=l.nextSibling}}})}function requireClippingrectangle$1(){if(hasRequiredClippingrectangle$1)return clippingrectangle$1;hasRequiredClippingrectangle$1=1;var e=_class$7,t=requireContainer(),r=requireNode$1();return clippingrectangle$1=e(r,t,{initialize:function(e,t){this.width=e,this.height=t},localHitTest:function(e,t){for(var r=this.lastChild;r;){var n=r.hitTest(e,t);if(n)return n;r=r.previousSibling}return null},renderLayerTo:function(e,t,r,n,o,i,a){e.setTransform(t,r,n,o,i,a),e.save(),e.beginPath(),e.rect(this.x,this.y,this.width,this.height),e.clip();for(var s=this.firstChild;s;)s.renderTo(e,t,r,n,o,i,a),s=s.nextSibling;e.restore()}})}function requireText$1(){if(hasRequiredText$1)return text$1;hasRequiredText$1=1;var e=_class$7,t=requireBase$1(),r={middle:"center"};return text$1=e(t,{base_initialize:t.prototype.initialize,initialize:function(e,t,r,n){this.base_initialize(),this.draw.apply(this,arguments)},draw:function(e,n,o,i){var a;"string"==typeof n?a=Number(/(\d+)/.exec(n)[0]):n?(a=parseFloat(n.fontSize||n["font-size"]||"12"),n=(n.fontStyle||n["font-style"]||"")+" "+(n.fontVariant||n["font-variant"]||"")+" "+(n.fontWeight||n["font-weight"]||"")+" "+a+"px "+(n.fontFamily||n["font-family"]||"Arial")):n=this._font;var s=e&&e.split(/\r?\n/);this._font=n,this._fontSize=a,this._text=s,this._alignment=r[o]||o||"left";var l=t._genericContext;l.font=this._font,l.textAlign=this._alignment,l.textBaseline="middle";for(var c=(s=this._text).length,u=0,d=0;d<c;d++){var h=l.measureText(s[d]).width;h>u&&(u=h)}return this.width=u,this.height=c?1.1*c*a:0,this.invalidate()},localHitTest:function(e,t){return this._fill&&e>0&&t>0&&e<this.width&&t<this.height?this:null},renderShapeTo:function(e){if(this._invisible||!this._text||!this._fill&&!this._stroke)return null;e.transform(this.xx,this.yx,this.xy,this.yy,this.x,this.y);var t=this._fill,r=this._stroke,n=this._text,o=this._strokeDash;e.font=this._font,e.textAlign=this._alignment,e.textBaseline="middle";var i=this._fontSize,a=i/2,s=1.1*i,l=n,c=l.length;if(t){e.fillStyle=t;for(var u=0;u<c;u++)e.fillText(l[u],0,a+u*s)}if(r)for(o?e.setLineDash?e.setLineDash(o):e.mozDash=o:e.setLineDash?e.setLineDash([]):e.mozDash=null,e.strokeStyle=r,e.lineWidth=this._strokeWidth,e.lineCap=this._strokeCap,e.lineJoin=this._strokeJoin,u=0;u<c;u++)e.strokeText(l[u],0,a+u*s)}}),text$1}var dom={},hasRequiredDom,surface,hasRequiredSurface,path,hasRequiredPath,shadow,hasRequiredShadow,node,hasRequiredNode,base,hasRequiredBase,shape,hasRequiredShape,group,hasRequiredGroup,clippingrectangle,hasRequiredClippingrectangle,text,hasRequiredText;function requireDom(){if(hasRequiredDom)return dom;hasRequiredDom=1;var e,t={},r=function(r){e&&(t[r]=e.addRule("av\\:"+r,"behavior:url(#default#VML);display:inline-block;position:absolute;left:0px;top:0px;"))};return dom.init=function(t){var n;try{n=t.namespaces}catch(e3){}return!!n&&(n.add("av","urn:schemas-microsoft-com:vml"),n.add("ao","urn:schemas-microsoft-com:office:office"),(e=t.createStyleSheet()).addRule("vml","display:inline-block;position:relative;overflow:hidden;"),r("vml"),!0)},dom.createElement=function(e){return e in t||r(e),document.createElement("av:"+e)},dom}function requireSurface(){if(hasRequiredSurface)return surface;hasRequiredSurface=1;var e=_class$7,t=requireContainer(),r=requireNative(),n=requireDom(),o=e(r,t,{initialize:function(e,t,r){this.element=r||document.createElement("vml"),this.containerElement=n.createElement("group"),this.element.appendChild(this.containerElement),null!=e&&null!=t&&this.resize(e,t)},resize:function(e,t){this.width=e,this.height=t;var r=this.element.style;r.pixelWidth=e,r.pixelHeight=t,(r=this.containerElement.style).width=e,r.height=t;return this.containerElement.coordorigin="50,50",this.containerElement.coordsize=100*e+","+100*t,this}});return o.tagName="av:vml",surface=o}function requirePath(){if(hasRequiredPath)return path;hasRequiredPath=1;var e=_class$7,t=requirePath$2(),r=100,n=Math.round,o=e(t,{initialize:function(e){this.reset(),e instanceof o?this.path=[Array.prototype.join.call(e.path," ")]:e&&(e.applyToPath?e.applyToPath(this):this.push(e))},onReset:function(){this.path=[]},onMove:function(e,t,o,i){this.path.push("m",n(o*r),n(i*r))},onLine:function(e,t,o,i){this.path.push("l",n(o*r),n(i*r))},onBezierCurve:function(e,t,o,i,a,s,l,c){this.path.push("c",n(o*r),n(i*r),n(a*r),n(s*r),n(l*r),n(c*r))},_arcToBezier:t.prototype.onArc,onArc:function(e,t,o,i,a,s,l,c,u,d,h,p){if(l!=c||p)return this._arcToBezier(e,t,o,i,a,s,l,c,u,d,h,p);a*=r,s*=r,l*=r,this.path.push(h?"at":"wa",n(a-l),n(s-l),n(a+l),n(s+l),n(e*r),n(t*r),n(o*r),n(i*r))},onClose:function(){this.path.push("x")},toVML:function(){return this.path.join(" ")}});return o.prototype.toString=o.prototype.toVML,path=o}function requireShadow(){if(hasRequiredShadow)return shadow;hasRequiredShadow=1;var e=_class$7,t=requireDummy(),r=requireNative();return shadow=e(t,r,{dummy_inject:t.prototype.inject,dummy_injectBefore:t.prototype.injectBefore,dummy_eject:t.prototype.eject,native_inject:r.prototype.inject,native_injectBefore:r.prototype.injectBefore,native_eject:r.prototype.eject,inject:function(e){return this.dummy_inject(e),this.native_inject(e),this},injectBefore:function(e){return this.dummy_injectBefore(e),this.native_injectBefore(e),this},eject:function(){return this.dummy_eject(),this.native_eject(),this}})}function requireNode(){if(hasRequiredNode)return node;hasRequiredNode=1;var e=_class$7,t=transform,r=requireShadow(),n=requireDom();return node=e(r,t,{initialize:function(e){this.element=n.createElement(e)},_place:function(){this.parentNode&&this._transform()},hide:function(){return this.element.style.display="none",this},show:function(){return this.element.style.display="",this},indicate:function(e,t){return e&&(this.element.style.cursor=e),t&&(this.element.title=t),this}})}function requireBase(){if(hasRequiredBase)return base;hasRequiredBase=1;var e=_class$7,t=transform,r=requireColor(),n=requireNode(),o=requireDom(),i=100,a={left:0,top:0,width:500,height:500};return base=e(n,{element_initialize:n.prototype.initialize,initialize:function(e){this.element_initialize(e);var t=this.element,r=this.skewElement=o.createElement("skew");r.on=!0,t.appendChild(r);var n=this.fillElement=o.createElement("fill");n.on=!1,t.appendChild(n);var i=this.strokeElement=o.createElement("stroke");i.on=!1,t.appendChild(i)},_transform:function(){var e=this.parentNode,r=e?new t(e._activeTransform).transform(this):this,n=this._boxCoords||this._size||a,o=n.left||0,s=n.top||0,l=n.width||1,c=n.height||1,u=r.yx/r.xx>r.yy/r.xy;(r.xx<0?r.xy>=0:r.xy<0)&&(u=!u),u=u?-1:1,r=(new t).scale(u,1).transform(r);var d=180*Math.atan2(-r.xy,r.yy)/Math.PI,h=d*Math.PI/180,p=Math.sin(h),f=Math.cos(h),g=new t(r.xx*f-r.xy*p,(r.yx*f-r.yy*p)*u,(r.xy*f+r.xx*p)*u,r.yy*f+r.yx*p),m=(new t).rotate(d,0,0),y=(new t).rotate(-d,0,0).transform(r).moveTo(0,0);l*=Math.abs(y.xx),c*=Math.abs(y.yy);var v=r.x,_=r.y,b=-l/2,C=-c/2,E=m.point(b,C);v-=E.x-b,_-=E.y-C;var T=new t(r).moveTo(0,0);v+=(E=T.point(o,s)).x,_+=E.y,u<0&&(v=-v-l);var S=T.point(-o,-s),P=m.point(l,c),w=m.point(l,0),x=m.point(0,c),O=Math.min(0,P.x,w.x,x.x),$=Math.max(0,P.x,w.x,x.x),I=Math.min(0,P.y,w.y,x.y),R=Math.max(0,P.y,w.y,x.y),A=(S.x-P.x/2)/($-O)*u,D=(S.y-P.y/2)/(R-I);o=(E=y.point(o,s)).x,s=E.y;var L=this._strokeWidth;if(L){b=r.xx+r.xy,C=r.yy+r.yx;L*=Math.sqrt(b*b+C*C)/Math.sqrt(2)}o*=i,s*=i,v*=i,_*=i,l*=i,c*=i;var N=this.element;N.coordorigin=o+","+s,N.coordsize=l+","+c,N.style.left=v+"px",N.style.top=_+"px",N.style.width=l,N.style.height=c,N.style.rotation=d.toFixed(8),N.style.flip=u<0?"x":"";var M=this.skewElement;M.matrix=[g.xx.toFixed(4),g.xy.toFixed(4),g.yx.toFixed(4),g.yy.toFixed(4),0,0],M.origin=A+","+D,this.strokeElement.weight=L+"px"},_createGradient:function(e,t){var n=this.fillElement;this.element.removeChild(n),n.type=e,n.method="none",n.rotate=!0;var o,i,a=[],s=function(e,t){t=r.detach(t),null==o?o=i=t:i=t,a.push(e+" "+t[0])};if("length"in t)for(var l=0,c=t.length-1;l<=c;l++)s(l/c,t[l]);else for(var u in t)s(u,t[u]);return n.color=o[0],n.color2=i[0],n.colors=a,n.opacity=i[1],n["ao:opacity2"]=o[1],n.on=!0,this.element.appendChild(n),n},_setColor:function(e,t){var n="fill"==e?this.fillElement:this.strokeElement;null==t?n.on=!1:(t=r.detach(t),n.color=t[0],n.opacity=t[1],n.on=!0)},fill:function(e){if(arguments.length>1)this.fillLinear(arguments);else{this._boxCoords=a;var t=this.fillElement;t.type="solid",t.color2="",t["ao:opacity2"]="",t.colors&&(t.colors.value=""),this._setColor("fill",e)}return this},fillRadial:function(e,t,r,n,o,i,a){var s=this._createGradient("gradientradial",e);null==t&&(t=this.left+.5*this.width),null==r&&(r=this.top+.5*this.height),null==o&&(o=n||.5*this.height),null==n&&(n=.5*this.width),null==i&&(i=t),null==a&&(a=r),i+=i-t,a+=a-r;var l=this._boxCoords={left:i-2*n,top:a-2*o,width:4*n,height:4*o};return t-=l.left,r-=l.top,t/=l.width,r/=l.height,s.focussize="0 0",s.focusposition=t+","+r,s.focus="50%",this._transform(),this},fillLinear:function(e,t,r,n,o){var i=this._createGradient("gradient",e);if(i.focus="100%",5==arguments.length){var a=Math.abs(n-t),s=Math.abs(o-r);this._boxCoords={left:Math.min(t,n),top:Math.min(r,o),width:a<1?s:a,height:s<1?a:s},i.angle=(360+180*Math.atan2((n-t)/s,(o-r)/a)/Math.PI)%360}else this._boxCoords=null,i.angle=null==t?0:(90+t)%360;return this._transform(),this},fillImage:function(e,t,n,o,i,a,s){var l=this.fillElement;return null!=a?(a=r.detach(a),null!=s&&(s=r.detach(s)),l.type="pattern",l.color=a[0],l.color2=null==s?a[0]:s[0],l.opacity=null==s?0:s[1],l["ao:opacity2"]=a[1]):(l.type="tile",l.color="",l.color2="",l.opacity=1,l["ao:opacity2"]=1),l.colors&&(l.colors.value=""),l.rotate=!0,l.src=e,l.size="1,1",l.position="0,0",l.origin="0,0",l.aspect="ignore",l.on=!0,o||(o=0),i||(i=0),this._boxCoords=t?{left:o+.5,top:i+.5,width:t,height:n}:null,this._transform(),this},stroke:function(e,t,r,n){var o=this.strokeElement;return this._strokeWidth=null!=t?t:1,o.weight=null!=t?t+"px":1,o.endcap=null!=r?"butt"==r?"flat":r:"round",o.joinstyle=null!=n?n:"round",this._setColor("stroke",e),this}}),base}function requireShape(){if(hasRequiredShape)return shape;hasRequiredShape=1;var e=_class$7,t=requireBase(),r=requirePath(),n=requireDom(),o=100;return shape=e(t,{base_initialize:t.prototype.initialize,initialize:function(e,t,r){this.base_initialize("shape");var o=this.pathElement=n.createElement("path");o.gradientshapeok=!0,this.element.appendChild(o),this.width=t,this.height=r,null!=e&&this.draw(e)},draw:function(e,t,n){return e instanceof r||(e=new r(e)),this._vml=e.toVML(),null!=t&&(this.width=t),null!=n&&(this.height=n),this._boxCoords||this._transform(),this._redraw(this._prefix,this._suffix),this},_redraw:function(e,t){var r=this._vml||"";this._prefix=e,this._suffix=t,e&&(r=[e,r,t,"ns e",r,"nf"].join(" ")),this.element.path=r+"e"},fillRadial:function(e,t,r,n,i,a,s){var l=this._createGradient("gradientradial",e);null==t&&(t=(this.left||0)+.5*(this.width||0)),null==r&&(r=(this.top||0)+.5*(this.height||0)),null==i&&(i=n||.5*this.height||0),null==n&&(n=.5*(this.width||0)),null==a&&(a=t),null==s&&(s=r),a+=a-t,s+=s-r;var c=Math.round(a*o),u=Math.round(s*o),d=Math.round(2*n*o),h=Math.round(2*i*o),p=["wa",c-d,u-h,c+d,u+h].join(" ");return this._redraw(["m",c,u-h,"l",c,u-h].join(" "),["m",c,u-h,p,c,u-h,c,u+h,p,c,u+h,c,u-h,p,c,u-h,c,u+h,p,c,u+h,c,u-h].join(" ")),this._boxCoords={left:t-2,top:r-2,width:4,height:4},l.focusposition="0.5,0.5",l.focussize="0 0",l.focus="50%",this._transform(),this}})}function requireGroup(){if(hasRequiredGroup)return group;hasRequiredGroup=1;var e=_class$7,t=transform,r=requireContainer(),n=requireNode();return group=e(n,r,{element_initialize:n.prototype.initialize,initialize:function(e,t){this.element_initialize("group"),this.width=e,this.height=t},_transform:function(){var e=this.element;e.coordorigin="0,0",e.coordsize="1000,1000",e.style.left=0,e.style.top=0,e.style.width=1e3,e.style.height=1e3,e.style.rotation=0;var r=this.parentNode;this._activeTransform=r?new t(r._activeTransform).transform(this):this;for(var n=this.firstChild;n;)n._transform(),n=n.nextSibling}})}function requireClippingrectangle(){if(hasRequiredClippingrectangle)return clippingrectangle;hasRequiredClippingrectangle=1;var e=_class$7,t=transform,r=requireContainer(),n=requireNode();return clippingrectangle=e(n,r,{element_initialize:n.prototype.initialize,initialize:function(e,t){this.element_initialize("clippingrectangle"),this.width=e,this.height=t},_transform:function(){var e=this.element;e.clip=!0,e.coordorigin=-this.x+","+-1*this.y,e.coordsize=this.width+","+this.height,e.style.clipLeft=this.x,e.style.clipRight=this.width+this.x,e.style.clipTop=this.y,e.style.left=-this.x,e.style.top=-this.y,e.style.width=this.width+this.x,e.style.height=this.height+this.y,e.style.rotation=0;var r=this.parentNode;this._activeTransform=r?new t(r._activeTransform).transform(this):this;for(var n=this.firstChild;n;)n._transform(),n=n.nextSibling}})}function requireText(){if(hasRequiredText)return text;hasRequiredText=1;var e=_class$7,t=requireBase(),r=requirePath(),n=requireSurface(),o=requireGroup(),i=requireDom(),a={start:"left",middle:"center",end:"right"};return text=e(t,{base_initialize:t.prototype.initialize,initialize:function(e,t,r,n){this.base_initialize("shape");var o=this.pathElement=i.createElement("path");o.textpathok=!0,this.element.appendChild(o),(o=this.textPathElement=i.createElement("textpath")).on=!0,o.style["v-text-align"]="left",this.element.appendChild(o),this.draw.apply(this,arguments)},draw:function(e,t,i,s){var l=this.element,c=this.textPathElement,u=c.style;if(c.string=e,t)if("string"==typeof t)u.font=t;else for(var d in t){var h=d.camelCase?d.camelCase():d;u[h]="fontFamily"==h?"'"+t[d]+"'":t[d]}if(i&&(u["v-text-align"]=a[i]||i),s)this.currentPath=s=new r(s),this.element.path=s.toVML();else if(!this.currentPath){for(var p=-1,f="\n";(p=e.indexOf("\n",p+1))>-1;)f+="\n";c.string=f+c.string,this.element.path="m0,0l1,0"}u=(l=l.cloneNode(!0)).style,l.coordorigin="0,0",l.coordsize="10000,10000",u.left="0px",u.top="0px",u.width="10000px",u.height="10000px",u.rotation=0,l.removeChild(l.firstChild);var g=new n(1,1),m=new o,y=l.ownerDocument.body;g.inject(y),m.element.appendChild(l),m.inject(g);var v=l.getBoundingClientRect(),_=g.toElement().getBoundingClientRect();return g.eject(),this.left=v.left-_.left,this.top=v.top-_.top,this.width=v.right-v.left,this.height=v.bottom-v.top,this.right=v.right-_.left,this.bottom=v.bottom-_.top,this._transform(),this}}),text}var hasCanvas=function(){var e="undefined"!=typeof window&&window.document&&window.document.createElement&&document.createElement("canvas");return e&&!!e.getContext};if(hasCanvas())fastNoSideEffects.Surface=requireSurface$1(),fastNoSideEffects.Path=requirePath$1(),fastNoSideEffects.Shape=requireShape$1(),fastNoSideEffects.Group=requireGroup$1(),fastNoSideEffects.ClippingRectangle=requireClippingrectangle$1(),fastNoSideEffects.Text=requireText$1();else{fastNoSideEffects.Surface=requireSurface(),fastNoSideEffects.Path=requirePath(),fastNoSideEffects.Shape=requireShape(),fastNoSideEffects.Group=requireGroup(),fastNoSideEffects.ClippingRectangle=requireClippingrectangle(),fastNoSideEffects.Text=requireText();var DOM=requireDom();"undefined"!=typeof document&&DOM.init(document)}var aa=reactExports,ba=objectAssign,ca=transform,da=current,n$1=schedulerExports,ea=fastNoSideEffects;function fa(){return fa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fa.apply(this,arguments)}function ha(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function ia(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q$2(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ja=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ka=60103,la=60106,ma=60107,na=60108,oa=60114,pa=60109,qa=60110,ra=60112,sa=60113,ta=60120,ua=60115,va=60116,wa=60121,xa=60129,ya=60130,za=60131;if("function"==typeof Symbol&&Symbol.for){var z$2=Symbol.for;ka=z$2("react.element"),la=z$2("react.portal"),ma=z$2("react.fragment"),na=z$2("react.strict_mode"),oa=z$2("react.profiler"),pa=z$2("react.provider"),qa=z$2("react.context"),ra=z$2("react.forward_ref"),sa=z$2("react.suspense"),ta=z$2("react.suspense_list"),ua=z$2("react.memo"),va=z$2("react.lazy"),wa=z$2("react.block"),z$2("react.scope"),xa=z$2("react.debug_trace_mode"),ya=z$2("react.offscreen"),za=z$2("react.legacy_hidden")}var Aa="function"==typeof Symbol&&Symbol.iterator;function Ca(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=Aa&&e[Aa]||e["@@iterator"])?e:null}function Da(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case ma:return"Fragment";case la:return"Portal";case oa:return"Profiler";case na:return"StrictMode";case sa:return"Suspense";case ta:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case qa:return(e.displayName||"Context")+".Consumer";case pa:return(e._context.displayName||"Context")+".Provider";case ra:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case ua:return Da(e.type);case wa:return Da(e._render);case va:t=e._payload,e=e._init;try{return Da(e(t))}catch(r){}}return null}function Ea(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(1026&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function Fa(e){if(Ea(e)!==e)throw Error(q$2(188))}function Ga(e){var t=e.alternate;if(!t){if(null===(t=Ea(e)))throw Error(q$2(188));return t!==e?null:e}for(var r=e,n=t;;){var o=r.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(n=o.return)){r=n;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===r)return Fa(o),e;if(i===n)return Fa(o),t;i=i.sibling}throw Error(q$2(188))}if(r.return!==n.return)r=o,n=i;else{for(var a=!1,s=o.child;s;){if(s===r){a=!0,r=o,n=i;break}if(s===n){a=!0,n=o,r=i;break}s=s.sibling}if(!a){for(s=i.child;s;){if(s===r){a=!0,r=i,n=o;break}if(s===n){a=!0,n=i,r=o;break}s=s.sibling}if(!a)throw Error(q$2(189))}}if(r.alternate!==n)throw Error(q$2(190))}if(3!==r.tag)throw Error(q$2(188));return r.stateNode.current===r?e:t}function Ha(e){if(!(e=Ga(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function Ia(e,t){for(var r=e.alternate;null!==t;){if(t===e||t===r)return!0;t=t.return}return!1}var Ja={CLIPPING_RECTANGLE:"ClippingRectangle",GROUP:"Group",SHAPE:"Shape",TEXT:"Text"},Ka={onClick:"click",onMouseMove:"mousemove",onMouseOver:"mouseover",onMouseOut:"mouseout",onMouseUp:"mouseup",onMouseDown:"mousedown"};function La(e){return e?"string"==typeof e?e:e.length?e.join(""):"":""}var Ma=new ca,Na={},Oa={};function Pa(e){return function(t){var r=e._listeners[t.type];r&&("function"==typeof r?r.call(e,t):r.handleEvent&&r.handleEvent(t))}}function Qa(e){if(e._subscriptions)for(var t in e._subscriptions)e._subscriptions[t]();e._subscriptions=null,e._listeners=null}function Ra(e,t){Sa(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}),e.width=t.width,e.height=t.height}function Ta(e,t){Sa(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}),e.width=t.width,e.height=t.height}function Sa(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=null!=t.scaleX?t.scaleX:null!=t.scale?t.scale:1,o=null!=t.scaleY?t.scaleY:null!=t.scale?t.scale:1;for(var i in Ma.transformTo(1,0,0,1,0,0).move(t.x||0,t.y||0).rotate(t.rotation||0,t.originX,t.originY).scale(n,o,t.originX,t.originY),null!=t.transform&&Ma.transform(t.transform),e.xx===Ma.xx&&e.yx===Ma.yx&&e.xy===Ma.xy&&e.yy===Ma.yy&&e.x===Ma.x&&e.y===Ma.y||e.transformTo(Ma),t.cursor===r.cursor&&t.title===r.title||e.indicate(t.cursor,t.title),e.blend&&t.opacity!==r.opacity&&e.blend(null==t.opacity?1:t.opacity),t.visible!==r.visible&&(null==t.visible||t.visible?e.show():e.hide()),Ka)r=e,n=Ka[i],o=t[i],r._listeners||(r._listeners={},r._subscriptions={}),(r._listeners[n]=o)?r._subscriptions[n]||(r._subscriptions[n]=r.subscribe(n,Pa(r),r)):r._subscriptions[n]&&(r._subscriptions[n](),delete r._subscriptions[n])}function Ua(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};Sa(e,t,r),r.fill!==t.fill&&(t.fill&&t.fill.applyFill?t.fill.applyFill(e):e.fill(t.fill)),r.stroke===t.stroke&&r.strokeWidth===t.strokeWidth&&r.strokeCap===t.strokeCap&&r.strokeJoin===t.strokeJoin&&r.strokeDash===t.strokeDash||e.stroke(t.stroke,t.strokeWidth,t.strokeCap,t.strokeJoin,t.strokeDash)}function Va(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};Ua(e,t,r);var n=t.d||La(t.children),o=e._prevDelta;n===e._prevPath&&n.delta===o&&r.height===t.height&&r.width===t.width||(e.draw(n,t.width,t.height),e._prevDelta=n.delta,e._prevPath=n)}function Wa(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};Ua(e,t,r);var n,o=t.children;if(!(n=e._currentString!==o)){n=t.font;var i=r.font;n=!(n=n===i||"string"!=typeof i&&"string"!=typeof n&&(i.fontSize===n.fontSize&&i.fontStyle===n.fontStyle&&i.fontVariant===n.fontVariant&&i.fontWeight===n.fontWeight&&i.fontFamily===n.fontFamily))}(n||t.alignment!==r.alignment||t.path!==r.path)&&(e.draw(o,t.font,t.alignment,t.path),e._currentString=o)}var Xa=setTimeout,Ya=clearTimeout,$a;function Za(e,t){return"string"==typeof t.children||"number"==typeof t.children}function ab(e){if(void 0===$a)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);$a=t&&t[1]||""}return"\n"+$a+e}var bb=!1;function cb(e,t){if(!e||bb)return"";bb=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var n=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){n=l}e.call(t.prototype)}else{try{throw Error()}catch(l){n=l}e()}}catch(l){if(l&&n&&"string"==typeof l.stack){for(var o=l.stack.split("\n"),i=n.stack.split("\n"),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(1!==a||1!==s)do{if(a--,0>--s||o[a]!==i[s])return"\n"+o[a].replace(" at new "," at ")}while(1<=a&&0<=s);break}}}finally{bb=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?ab(e):""}var db=[],eb=-1;function fb(e){return{current:e}}function A$2(e){0>eb||(e.current=db[eb],db[eb]=null,eb--)}function B$2(e,t){eb++,db[eb]=e.current,e.current=t}var gb={},C$2=fb(gb),D$2=fb(!1),hb=gb;function ib(e,t){var r=e.type.contextTypes;if(!r)return gb;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in r)i[o]=t[o];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function E$2(e){return null!=(e=e.childContextTypes)}function jb(){A$2(D$2),A$2(C$2)}function kb(e,t,r){if(C$2.current!==gb)throw Error(q$2(168));B$2(C$2,t),B$2(D$2,r)}function lb(e,t,r){var n=e.stateNode;if(e=t.childContextTypes,"function"!=typeof n.getChildContext)return r;for(var o in n=n.getChildContext())if(!(o in e))throw Error(q$2(108,Da(t)||"Unknown",o));return ba({},r,n)}function mb(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||gb,hb=C$2.current,B$2(C$2,e),B$2(D$2,D$2.current),!0}function nb(e,t,r){var n=e.stateNode;if(!n)throw Error(q$2(169));r?(e=lb(e,t,hb),n.__reactInternalMemoizedMergedChildContext=e,A$2(D$2),A$2(C$2),B$2(C$2,e)):A$2(D$2),B$2(D$2,r)}var ob=null,pb=null,qb=n$1.unstable_now;qb();var F$2=8;function rb(e){if(1&e)return F$2=15,1;if(2&e)return F$2=14,2;if(4&e)return F$2=13,4;var t=24&e;return 0!==t?(F$2=12,t):32&e?(F$2=11,32):0!==(t=192&e)?(F$2=10,t):256&e?(F$2=9,256):0!==(t=3584&e)?(F$2=8,t):4096&e?(F$2=7,4096):0!==(t=4186112&e)?(F$2=6,t):0!==(t=62914560&e)?(F$2=5,t):67108864&e?(F$2=4,67108864):134217728&e?(F$2=3,134217728):0!==(t=805306368&e)?(F$2=2,t):1073741824&e?(F$2=1,1073741824):(F$2=8,e)}function sb(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}function tb(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(q$2(358,e))}}function ub(e,t){var r=e.pendingLanes;if(0===r)return F$2=0;var n=0,o=0,i=e.expiredLanes,a=e.suspendedLanes,s=e.pingedLanes;if(0!==i)n=i,o=F$2=15;else if(0!==(i=134217727&r)){var l=i&~a;0!==l?(n=rb(l),o=F$2):0!==(s&=i)&&(n=rb(s),o=F$2)}else 0!==(i=r&~a)?(n=rb(i),o=F$2):0!==s&&(n=rb(s),o=F$2);if(0===n)return 0;if(n=r&((0>(n=31-vb(n))?0:1<<n)<<1)-1,0!==t&&t!==n&&!(t&a)){if(rb(t),o<=F$2)return t;F$2=o}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)o=1<<(r=31-vb(t)),n|=e[r],t&=~o;return n}function wb(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function xb(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=yb(24&~t))?xb(10,t):e;case 10:return 0===(e=yb(192&~t))?xb(8,t):e;case 8:return 0===(e=yb(3584&~t))&&(0===(e=yb(4186112&~t))&&(e=512)),e;case 2:return 0===(t=yb(805306368&~t))&&(t=268435456),t}throw Error(q$2(358,e))}function yb(e){return e&-e}function zb(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ab(e,t,r){e.pendingLanes|=t;var n=t-1;e.suspendedLanes&=n,e.pingedLanes&=n,(e=e.eventTimes)[t=31-vb(t)]=r}var vb=Math.clz32?Math.clz32:Bb,Cb=Math.log,Db=Math.LN2;function Bb(e){return 0===e?32:31-(Cb(e)/Db|0)|0}var Eb=n$1.unstable_runWithPriority,Fb=n$1.unstable_scheduleCallback,Gb=n$1.unstable_cancelCallback,Hb=n$1.unstable_shouldYield,Ib=n$1.unstable_requestPaint,Jb=n$1.unstable_now,Kb=n$1.unstable_getCurrentPriorityLevel,Lb=n$1.unstable_ImmediatePriority,Mb=n$1.unstable_UserBlockingPriority,Nb=n$1.unstable_NormalPriority,Ob=n$1.unstable_LowPriority,Pb=n$1.unstable_IdlePriority,Qb={},Rb=void 0!==Ib?Ib:function(){},Sb=null,Tb=null,Ub=!1,Vb=Jb(),G$2=1e4>Vb?Jb:function(){return Jb()-Vb};function Wb(){switch(Kb()){case Lb:return 99;case Mb:return 98;case Nb:return 97;case Ob:return 96;case Pb:return 95;default:throw Error(q$2(332))}}function Xb(e){switch(e){case 99:return Lb;case 98:return Mb;case 97:return Nb;case 96:return Ob;case 95:return Pb;default:throw Error(q$2(332))}}function Yb(e,t){return e=Xb(e),Eb(e,t)}function Zb(e,t,r){return e=Xb(e),Fb(e,t,r)}function $b(){if(null!==Tb){var e=Tb;Tb=null,Gb(e)}ac()}function ac(){if(!Ub&&null!==Sb){Ub=!0;var e=0;try{var t=Sb;Yb(99,(function(){for(;e<t.length;e++){var r=t[e];do{r=r(!0)}while(null!==r)}})),Sb=null}catch(r){throw null!==Sb&&(Sb=Sb.slice(e+1)),Fb(Lb,$b),r}finally{Ub=!1}}}var bc=ja.ReactCurrentBatchConfig;function cc(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t}var H$2="function"==typeof Object.is?Object.is:cc,dc=Object.prototype.hasOwnProperty;function ec(e,t){if(H$2(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++)if(!dc.call(t,r[n])||!H$2(e[r[n]],t[r[n]]))return!1;return!0}function fc(e){switch(e.tag){case 5:return ab(e.type);case 16:return ab("Lazy");case 13:return ab("Suspense");case 19:return ab("SuspenseList");case 0:case 2:case 15:return e=cb(e.type,!1);case 11:return e=cb(e.type.render,!1);case 22:return e=cb(e.type._render,!1);case 1:return e=cb(e.type,!0);default:return""}}function I$2(e,t){if(e&&e.defaultProps){for(var r in t=ba({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}var gc=fb(null),hc=null,ic=null,jc=null;function kc(){jc=ic=hc=null}function lc(e){var t=gc.current;A$2(gc),e.type._context._currentValue2=t}function mc(e,t){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)===t){if(null===r||(r.childLanes&t)===t)break;r.childLanes|=t}else e.childLanes|=t,null!==r&&(r.childLanes|=t);e=e.return}}function nc(e,t){hc=e,jc=ic=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(!!(e.lanes&t)&&(J$2=!0),e.firstContext=null)}function K$2(e,t){if(jc!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(jc=e,t=1073741823),t={context:e,observedBits:t,next:null},null===ic){if(null===hc)throw Error(q$2(308));ic=t,hc.dependencies={lanes:0,firstContext:t,responders:null}}else ic=ic.next=t;return e._currentValue2}var oc=!1;function pc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function qc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function rc(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function sc(e,t){if(null!==(e=e.updateQueue)){var r=(e=e.shared).pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}}function tc(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var o=null,i=null;if(null!==(r=r.firstBaseUpdate)){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===i?o=i=a:i=i.next=a,r=r.next}while(null!==r);null===i?o=i=t:i=i.next=t}else o=i=t;return r={baseState:n.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function uc(e,t,r,n){var o=e.updateQueue;oc=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var l=s,c=l.next;l.next=null,null===a?i=c:a.next=c,a=l;var u=e.alternate;if(null!==u){var d=(u=u.updateQueue).lastBaseUpdate;d!==a&&(null===d?u.firstBaseUpdate=c:d.next=c,u.lastBaseUpdate=l)}}if(null!==i){for(d=o.baseState,a=0,u=c=l=null;;){s=i.lane;var h=i.eventTime;if((n&s)===s){null!==u&&(u=u.next={eventTime:h,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var p=e,f=i;switch(s=t,h=r,f.tag){case 1:if("function"==typeof(p=f.payload)){d=p.call(h,d,s);break e}d=p;break e;case 3:p.flags=-4097&p.flags|64;case 0:if(null==(s="function"==typeof(p=f.payload)?p.call(h,d,s):p))break e;d=ba({},d,s);break e;case 2:oc=!0}}null!==i.callback&&(e.flags|=32,null===(s=o.effects)?o.effects=[i]:s.push(i))}else h={eventTime:h,lane:s,tag:i.tag,payload:i.payload,callback:i.callback,next:null},null===u?(c=u=h,l=d):u=u.next=h,a|=s;if(null===(i=i.next)){if(null===(s=o.shared.pending))break;i=s.next,s.next=null,o.lastBaseUpdate=s,o.shared.pending=null}}null===u&&(l=d),o.baseState=l,o.firstBaseUpdate=c,o.lastBaseUpdate=u,vc|=a,e.lanes=a,e.memoizedState=d}}function wc(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],o=n.callback;if(null!==o){if(n.callback=null,n=r,"function"!=typeof o)throw Error(q$2(191,o));o.call(n)}}}var xc=(new aa.Component).refs;function yc(e,t,r,n){r=null==(r=r(n,t=e.memoizedState))?t:ba({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var Cc={isMounted:function(e){return!!(e=e._reactInternals)&&Ea(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=zc(),o=Ac(e),i=rc(n,o);i.payload=t,null!=r&&(i.callback=r),sc(e,i),Bc(e,o,n)},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=zc(),o=Ac(e),i=rc(n,o);i.tag=1,i.payload=t,null!=r&&(i.callback=r),sc(e,i),Bc(e,o,n)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=zc(),n=Ac(e),o=rc(r,n);o.tag=2,null!=t&&(o.callback=t),sc(e,o),Bc(e,n,r)}};function Dc(e,t,r,n,o,i,a){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,i,a):!t.prototype||!t.prototype.isPureReactComponent||(!ec(r,n)||!ec(o,i))}function Ec(e,t,r){var n=!1,o=gb,i=t.contextType;return"object"==typeof i&&null!==i?i=K$2(i):(o=E$2(t)?hb:C$2.current,i=(n=null!=(n=t.contextTypes))?ib(e,o):gb),t=new t(r,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Cc,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function Fc(e,t,r,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Cc.enqueueReplaceState(t,t.state,null)}function Gc(e,t,r,n){var o=e.stateNode;o.props=r,o.state=e.memoizedState,o.refs=xc,pc(e);var i=t.contextType;"object"==typeof i&&null!==i?o.context=K$2(i):(i=E$2(t)?hb:C$2.current,o.context=ib(e,i)),uc(e,r,o,n),o.state=e.memoizedState,"function"==typeof(i=t.getDerivedStateFromProps)&&(yc(e,t,i,r),o.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(t=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&Cc.enqueueReplaceState(o,o.state,null),uc(e,r,o,n),o.state=e.memoizedState),"function"==typeof o.componentDidMount&&(e.flags|=4)}var Hc=Array.isArray;function Ic(e,t,r){if(null!==(e=r.ref)&&"function"!=typeof e&&"object"!=typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(q$2(309));var n=r.stateNode}if(!n)throw Error(q$2(147,e));var o=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===o?t.ref:((t=function(e){var t=n.refs;t===xc&&(t=n.refs={}),null===e?delete t[o]:t[o]=e})._stringRef=o,t)}if("string"!=typeof e)throw Error(q$2(284));if(!r._owner)throw Error(q$2(290,e))}return e}function Jc(e,t){if("textarea"!==e.type)throw Error(q$2(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function Kc(e){function t(t,r){if(e){var n=t.lastEffect;null!==n?(n.nextEffect=r,t.lastEffect=r):t.firstEffect=t.lastEffect=r,r.nextEffect=null,r.flags=8}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Mc(e,t)).index=0,e.sibling=null,e}function i(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags=2,r):n:(t.flags=2,r):r}function a(t){return e&&null===t.alternate&&(t.flags=2),t}function s(e,t,r,n){return null===t||6!==t.tag?((t=Nc(r,e.mode,n)).return=e,t):((t=o(t,r)).return=e,t)}function l(e,t,r,n){return null!==t&&t.elementType===r.type?((n=o(t,r.props)).ref=Ic(e,t,r),n.return=e,n):((n=Oc(r.type,r.key,r.props,null,e.mode,n)).ref=Ic(e,t,r),n.return=e,n)}function c(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Pc(r,e.mode,n)).return=e,t):((t=o(t,r.children||[])).return=e,t)}function u(e,t,r,n,i){return null===t||7!==t.tag?((t=Qc(r,e.mode,n,i)).return=e,t):((t=o(t,r)).return=e,t)}function d(e,t,r){if("string"==typeof t||"number"==typeof t)return(t=Nc(""+t,e.mode,r)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case ka:return(r=Oc(t.type,t.key,t.props,null,e.mode,r)).ref=Ic(e,null,t),r.return=e,r;case la:return(t=Pc(t,e.mode,r)).return=e,t}if(Hc(t)||Ca(t))return(t=Qc(t,e.mode,r,null)).return=e,t;Jc(e,t)}return null}function h(e,t,r,n){var o=null!==t?t.key:null;if("string"==typeof r||"number"==typeof r)return null!==o?null:s(e,t,""+r,n);if("object"==typeof r&&null!==r){switch(r.$$typeof){case ka:return r.key===o?r.type===ma?u(e,t,r.props.children,n,o):l(e,t,r,n):null;case la:return r.key===o?c(e,t,r,n):null}if(Hc(r)||Ca(r))return null!==o?null:u(e,t,r,n,null);Jc(e,r)}return null}function p(e,t,r,n,o){if("string"==typeof n||"number"==typeof n)return s(t,e=e.get(r)||null,""+n,o);if("object"==typeof n&&null!==n){switch(n.$$typeof){case ka:return e=e.get(null===n.key?r:n.key)||null,n.type===ma?u(t,e,n.props.children,o,n.key):l(t,e,n,o);case la:return c(t,e=e.get(null===n.key?r:n.key)||null,n,o)}if(Hc(n)||Ca(n))return u(t,e=e.get(r)||null,n,o,null);Jc(t,n)}return null}return function(s,l,c,u){var f="object"==typeof c&&null!==c&&c.type===ma&&null===c.key;f&&(c=c.props.children);var g="object"==typeof c&&null!==c;if(g)switch(c.$$typeof){case ka:e:{for(g=c.key,f=l;null!==f;){if(f.key===g){if(7===f.tag){if(c.type===ma){r(s,f.sibling),(l=o(f,c.props.children)).return=s,s=l;break e}}else if(f.elementType===c.type){r(s,f.sibling),(l=o(f,c.props)).ref=Ic(s,f,c),l.return=s,s=l;break e}r(s,f);break}t(s,f),f=f.sibling}c.type===ma?((l=Qc(c.props.children,s.mode,u,c.key)).return=s,s=l):((u=Oc(c.type,c.key,c.props,null,s.mode,u)).ref=Ic(s,l,c),u.return=s,s=u)}return a(s);case la:e:{for(f=c.key;null!==l;){if(l.key===f){if(4===l.tag&&l.stateNode.containerInfo===c.containerInfo&&l.stateNode.implementation===c.implementation){r(s,l.sibling),(l=o(l,c.children||[])).return=s,s=l;break e}r(s,l);break}t(s,l),l=l.sibling}(l=Pc(c,s.mode,u)).return=s,s=l}return a(s)}if("string"==typeof c||"number"==typeof c)return c=""+c,null!==l&&6===l.tag?(r(s,l.sibling),(l=o(l,c)).return=s,s=l):(r(s,l),(l=Nc(c,s.mode,u)).return=s,s=l),a(s);if(Hc(c))return function(o,a,s,l){for(var c=null,u=null,f=a,g=a=0,m=null;null!==f&&g<s.length;g++){f.index>g?(m=f,f=null):m=f.sibling;var y=h(o,f,s[g],l);if(null===y){null===f&&(f=m);break}e&&f&&null===y.alternate&&t(o,f),a=i(y,a,g),null===u?c=y:u.sibling=y,u=y,f=m}if(g===s.length)return r(o,f),c;if(null===f){for(;g<s.length;g++)null!==(f=d(o,s[g],l))&&(a=i(f,a,g),null===u?c=f:u.sibling=f,u=f);return c}for(f=n(o,f);g<s.length;g++)null!==(m=p(f,o,g,s[g],l))&&(e&&null!==m.alternate&&f.delete(null===m.key?g:m.key),a=i(m,a,g),null===u?c=m:u.sibling=m,u=m);return e&&f.forEach((function(e){return t(o,e)})),c}(s,l,c,u);if(Ca(c))return function(o,a,s,l){var c=Ca(s);if("function"!=typeof c)throw Error(q$2(150));if(null==(s=c.call(s)))throw Error(q$2(151));for(var u=c=null,f=a,g=a=0,m=null,y=s.next();null!==f&&!y.done;g++,y=s.next()){f.index>g?(m=f,f=null):m=f.sibling;var v=h(o,f,y.value,l);if(null===v){null===f&&(f=m);break}e&&f&&null===v.alternate&&t(o,f),a=i(v,a,g),null===u?c=v:u.sibling=v,u=v,f=m}if(y.done)return r(o,f),c;if(null===f){for(;!y.done;g++,y=s.next())null!==(y=d(o,y.value,l))&&(a=i(y,a,g),null===u?c=y:u.sibling=y,u=y);return c}for(f=n(o,f);!y.done;g++,y=s.next())null!==(y=p(f,o,g,y.value,l))&&(e&&null!==y.alternate&&f.delete(null===y.key?g:y.key),a=i(y,a,g),null===u?c=y:u.sibling=y,u=y);return e&&f.forEach((function(e){return t(o,e)})),c}(s,l,c,u);if(g&&Jc(s,c),void 0===c&&!f)switch(s.tag){case 1:case 22:case 0:case 11:case 15:throw Error(q$2(152,Da(s.type)||"Component"))}return r(s,l)}}var Rc=Kc(!0),Sc=Kc(!1),Tc={},Uc=fb(Tc),Vc=fb(Tc),Wc=fb(Tc);function Xc(e){if(e===Tc)throw Error(q$2(174));return e}function Yc(e,t){B$2(Wc,t),B$2(Vc,e),B$2(Uc,Tc),A$2(Uc),B$2(Uc,Na)}function Zc(){A$2(Uc),A$2(Vc),A$2(Wc)}function $c(e){Xc(Wc.current),Xc(Uc.current)!==Na&&(B$2(Vc,e),B$2(Uc,Na))}function ad(e){Vc.current===e&&(A$2(Uc),A$2(Vc))}var L$2=fb(0);function bd(e){for(var t=e;null!==t;){if(13===t.tag){var r,n=t.memoizedState;if(r=null!==n){if(!(n=null===n.dehydrated))throw Error(q$2(305));if(!n)throw Error(q$2(305));r=n}if(r)return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(64&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var cd=[];function dd(){for(var e=0;e<cd.length;e++)cd[e]._workInProgressVersionSecondary=null;cd.length=0}var ed=ja.ReactCurrentDispatcher,M$2=ja.ReactCurrentBatchConfig,fd=0,N$2=null,O$2=null,P$2=null,gd=!1,hd=!1;function Q$2(){throw Error(q$2(321))}function id(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!H$2(e[r],t[r]))return!1;return!0}function jd(e,t,r,n,o,i){if(fd=i,N$2=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ed.current=null===e||null===e.memoizedState?kd:ld,e=r(n,o),hd){i=0;do{if(hd=!1,!(25>i))throw Error(q$2(301));i+=1,P$2=O$2=null,t.updateQueue=null,ed.current=md,e=r(n,o)}while(hd)}if(ed.current=nd,t=null!==O$2&&null!==O$2.next,fd=0,P$2=O$2=N$2=null,gd=!1,t)throw Error(q$2(300));return e}function od(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===P$2?N$2.memoizedState=P$2=e:P$2=P$2.next=e,P$2}function pd(){if(null===O$2){var e=N$2.alternate;e=null!==e?e.memoizedState:null}else e=O$2.next;var t=null===P$2?N$2.memoizedState:P$2.next;if(null!==t)P$2=t,O$2=e;else{if(null===e)throw Error(q$2(310));e={memoizedState:(O$2=e).memoizedState,baseState:O$2.baseState,baseQueue:O$2.baseQueue,queue:O$2.queue,next:null},null===P$2?N$2.memoizedState=P$2=e:P$2=P$2.next=e}return P$2}function qd(e,t){return"function"==typeof t?t(e):t}function rd(e){var t=pd(),r=t.queue;if(null===r)throw Error(q$2(311));r.lastRenderedReducer=e;var n=O$2,o=n.baseQueue,i=r.pending;if(null!==i){if(null!==o){var a=o.next;o.next=i.next,i.next=a}n.baseQueue=o=i,r.pending=null}if(null!==o){o=o.next,n=n.baseState;var s=a=i=null,l=o;do{var c=l.lane;if((fd&c)===c)null!==s&&(s=s.next={lane:0,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null}),n=l.eagerReducer===e?l.eagerState:e(n,l.action);else{var u={lane:c,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null};null===s?(a=s=u,i=n):s=s.next=u,N$2.lanes|=c,vc|=c}l=l.next}while(null!==l&&l!==o);null===s?i=n:s.next=a,H$2(n,t.memoizedState)||(J$2=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=s,r.lastRenderedState=n}return[t.memoizedState,r.dispatch]}function sd(e){var t=pd(),r=t.queue;if(null===r)throw Error(q$2(311));r.lastRenderedReducer=e;var n=r.dispatch,o=r.pending,i=t.memoizedState;if(null!==o){r.pending=null;var a=o=o.next;do{i=e(i,a.action),a=a.next}while(a!==o);H$2(i,t.memoizedState)||(J$2=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function td(e,t,r){var n=t._getVersion;n=n(t._source);var o=t._workInProgressVersionSecondary;if(null!==o?e=o===n:(e=e.mutableReadLanes,(e=(fd&e)===e)&&(t._workInProgressVersionSecondary=n,cd.push(t))),e)return r(t._source);throw cd.push(t),Error(q$2(350))}function ud(e,t,r,n){var o=R$2;if(null===o)throw Error(q$2(349));var i=t._getVersion,a=i(t._source),s=ed.current,l=s.useState((function(){return td(o,t,r)})),c=l[1],u=l[0];l=P$2;var d=e.memoizedState,h=d.refs,p=h.getSnapshot,f=d.source;d=d.subscribe;var g=N$2;return e.memoizedState={refs:h,source:t,subscribe:n},s.useEffect((function(){h.getSnapshot=r,h.setSnapshot=c;var e=i(t._source);if(!H$2(a,e)){e=r(t._source),H$2(u,e)||(c(e),e=Ac(g),o.mutableReadLanes|=e&o.pendingLanes),e=o.mutableReadLanes,o.entangledLanes|=e;for(var n=o.entanglements,s=e;0<s;){var l=31-vb(s),d=1<<l;n[l]|=e,s&=~d}}}),[r,t,n]),s.useEffect((function(){return n(t._source,(function(){var e=h.getSnapshot,r=h.setSnapshot;try{r(e(t._source));var n=Ac(g);o.mutableReadLanes|=n&o.pendingLanes}catch(i){r((function(){throw i}))}}))}),[t,n]),H$2(p,r)&&H$2(f,t)&&H$2(d,n)||((e={pending:null,dispatch:null,lastRenderedReducer:qd,lastRenderedState:u}).dispatch=c=vd.bind(null,N$2,e),l.queue=e,l.baseQueue=null,u=td(o,t,r),l.memoizedState=l.baseState=u),u}function wd(e,t,r){return ud(pd(),e,t,r)}function xd(e){var t=od();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:qd,lastRenderedState:e}).dispatch=vd.bind(null,N$2,e),[t.memoizedState,e]}function yd(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=N$2.updateQueue)?(t={lastEffect:null},N$2.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function zd(e){return e={current:e},od().memoizedState=e}function Ad(){return pd().memoizedState}function Bd(e,t,r,n){var o=od();N$2.flags|=e,o.memoizedState=yd(1|t,r,void 0,void 0===n?null:n)}function Cd(e,t,r,n){var o=pd();n=void 0===n?null:n;var i=void 0;if(null!==O$2){var a=O$2.memoizedState;if(i=a.destroy,null!==n&&id(n,a.deps))return void yd(t,r,i,n)}N$2.flags|=e,o.memoizedState=yd(1|t,r,i,n)}function Dd(e,t){return Bd(516,4,e,t)}function Ed(e,t){return Cd(516,4,e,t)}function Fd(e,t){return Cd(4,2,e,t)}function Gd(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Hd(e,t,r){return r=null!=r?r.concat([e]):null,Cd(4,2,Gd.bind(null,t,e),r)}function Id(){}function Jd(e,t){var r=pd();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&id(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Kd(e,t){var r=pd();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&id(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Ld(e,t){var r=Wb();Yb(98>r?98:r,(function(){e(!0)})),Yb(97<r?97:r,(function(){var r=M$2.transition;M$2.transition=1;try{e(!1),t()}finally{M$2.transition=r}}))}function vd(e,t,r){var n=zc(),o=Ac(e),i={lane:o,action:r,eagerReducer:null,eagerState:null,next:null},a=t.pending;if(null===a?i.next=i:(i.next=a.next,a.next=i),t.pending=i,a=e.alternate,e===N$2||null!==a&&a===N$2)hd=gd=!0;else{if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,l=a(s,r);if(i.eagerReducer=a,i.eagerState=l,H$2(l,s))return}catch(c){}Bc(e,o,n)}}var nd={readContext:K$2,useCallback:Q$2,useContext:Q$2,useEffect:Q$2,useImperativeHandle:Q$2,useLayoutEffect:Q$2,useMemo:Q$2,useReducer:Q$2,useRef:Q$2,useState:Q$2,useDebugValue:Q$2,useDeferredValue:Q$2,useTransition:Q$2,useMutableSource:Q$2,useOpaqueIdentifier:Q$2,unstable_isNewReconciler:!1},kd={readContext:K$2,useCallback:function(e,t){return od().memoizedState=[e,void 0===t?null:t],e},useContext:K$2,useEffect:Dd,useImperativeHandle:function(e,t,r){return r=null!=r?r.concat([e]):null,Bd(4,2,Gd.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Bd(4,2,e,t)},useMemo:function(e,t){var r=od();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=od();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e=(e=n.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=vd.bind(null,N$2,e),[n.memoizedState,e]},useRef:zd,useState:xd,useDebugValue:Id,useDeferredValue:function(e){var t=xd(e),r=t[0],n=t[1];return Dd((function(){var t=M$2.transition;M$2.transition=1;try{n(e)}finally{M$2.transition=t}}),[e]),r},useTransition:function(){var e=xd(!1),t=e[0];return zd(e=Ld.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,r){var n=od();return n.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:r},ud(n,e,t,r)},useOpaqueIdentifier:function(){throw Error("Not yet implemented")},unstable_isNewReconciler:!1},ld={readContext:K$2,useCallback:Jd,useContext:K$2,useEffect:Ed,useImperativeHandle:Hd,useLayoutEffect:Fd,useMemo:Kd,useReducer:rd,useRef:Ad,useState:function(){return rd(qd)},useDebugValue:Id,useDeferredValue:function(e){var t=rd(qd),r=t[0],n=t[1];return Ed((function(){var t=M$2.transition;M$2.transition=1;try{n(e)}finally{M$2.transition=t}}),[e]),r},useTransition:function(){var e=rd(qd)[0];return[Ad().current,e]},useMutableSource:wd,useOpaqueIdentifier:function(){return rd(qd)[0]},unstable_isNewReconciler:!1},md={readContext:K$2,useCallback:Jd,useContext:K$2,useEffect:Ed,useImperativeHandle:Hd,useLayoutEffect:Fd,useMemo:Kd,useReducer:sd,useRef:Ad,useState:function(){return sd(qd)},useDebugValue:Id,useDeferredValue:function(e){var t=sd(qd),r=t[0],n=t[1];return Ed((function(){var t=M$2.transition;M$2.transition=1;try{n(e)}finally{M$2.transition=t}}),[e]),r},useTransition:function(){var e=sd(qd)[0];return[Ad().current,e]},useMutableSource:wd,useOpaqueIdentifier:function(){return sd(qd)[0]},unstable_isNewReconciler:!1},Md=ja.ReactCurrentOwner,J$2=!1;function S$2(e,t,r,n){t.child=null===e?Sc(t,null,r,n):Rc(t,e.child,r,n)}function Nd(e,t,r,n,o){r=r.render;var i=t.ref;return nc(t,o),n=jd(e,t,r,n,i,o),null===e||J$2?(t.flags|=1,S$2(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~o,Od(e,t,o))}function Pd(e,t,r,n,o,i){if(null===e){var a=r.type;return"function"!=typeof a||Qd(a)||void 0!==a.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Oc(r.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Rd(e,t,a,n,o,i))}return a=e.child,o&i||(o=a.memoizedProps,!(r=null!==(r=r.compare)?r:ec)(o,n)||e.ref!==t.ref)?(t.flags|=1,(e=Mc(a,n)).ref=t.ref,e.return=t,t.child=e):Od(e,t,i)}function Rd(e,t,r,n,o,i){if(null!==e&&ec(e.memoizedProps,n)&&e.ref===t.ref){if(J$2=!1,!(i&o))return t.lanes=e.lanes,Od(e,t,i);16384&e.flags&&(J$2=!0)}return Sd(e,t,r,n,i)}function Td(e,t,r){var n=t.pendingProps,o=n.children,i=null!==e?e.memoizedState:null;if("hidden"===n.mode||"unstable-defer-without-hiding"===n.mode)if(4&t.mode){if(!(1073741824&r))return e=null!==i?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},Ud(t,e),null;t.memoizedState={baseLanes:0},Ud(t,null!==i?i.baseLanes:r)}else t.memoizedState={baseLanes:0},Ud(t,r);else null!==i?(n=i.baseLanes|r,t.memoizedState=null):n=r,Ud(t,n);return S$2(e,t,o,r),t.child}function Vd(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=128)}function Sd(e,t,r,n,o){var i=E$2(r)?hb:C$2.current;return i=ib(t,i),nc(t,o),r=jd(e,t,r,n,i,o),null===e||J$2?(t.flags|=1,S$2(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~o,Od(e,t,o))}function Wd(e,t,r,n,o){if(E$2(r)){var i=!0;mb(t)}else i=!1;if(nc(t,o),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),Ec(t,r,n),Gc(t,r,n,o),n=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,c=r.contextType;"object"==typeof c&&null!==c?c=K$2(c):c=ib(t,c=E$2(r)?hb:C$2.current);var u=r.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof a.getSnapshotBeforeUpdate;d||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==n||l!==c)&&Fc(t,a,n,c),oc=!1;var h=t.memoizedState;a.state=h,uc(t,n,a,o),l=t.memoizedState,s!==n||h!==l||D$2.current||oc?("function"==typeof u&&(yc(t,r,u,n),l=t.memoizedState),(s=oc||Dc(t,r,s,n,h,l,c))?(d||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.flags|=4)):("function"==typeof a.componentDidMount&&(t.flags|=4),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=c,n=s):("function"==typeof a.componentDidMount&&(t.flags|=4),n=!1)}else{a=t.stateNode,qc(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:I$2(t.type,s),a.props=c,d=t.pendingProps,h=a.context,"object"==typeof(l=r.contextType)&&null!==l?l=K$2(l):l=ib(t,l=E$2(r)?hb:C$2.current);var p=r.getDerivedStateFromProps;(u="function"==typeof p||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==d||h!==l)&&Fc(t,a,n,l),oc=!1,h=t.memoizedState,a.state=h,uc(t,n,a,o);var f=t.memoizedState;s!==d||h!==f||D$2.current||oc?("function"==typeof p&&(yc(t,r,p,n),f=t.memoizedState),(c=oc||Dc(t,r,c,n,h,f,l))?(u||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(n,f,l),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(n,f,l)),"function"==typeof a.componentDidUpdate&&(t.flags|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=256),t.memoizedProps=n,t.memoizedState=f),a.props=n,a.state=f,a.context=l,n=c):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=256),n=!1)}return Xd(e,t,r,n,i,o)}function Xd(e,t,r,n,o,i){Vd(e,t);var a=!!(64&t.flags);if(!n&&!a)return o&&nb(t,r,!1),Od(e,t,i);n=t.stateNode,Md.current=t;var s=a&&"function"!=typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&a?(t.child=Rc(t,e.child,null,i),t.child=Rc(t,null,s,i)):S$2(e,t,s,i),t.memoizedState=n.state,o&&nb(t,r,!0),t.child}function Yd(e){var t=e.stateNode;t.pendingContext?kb(e,t.pendingContext,t.pendingContext!==t.context):t.context&&kb(e,t.context,!1),Yc(e,t.containerInfo)}var Zd={dehydrated:null,retryLane:0},ie,je,ke,le;function $d(e,t,r){var n,o=t.pendingProps,i=L$2.current,a=!1;return(n=!!(64&t.flags))||(n=(null===e||null!==e.memoizedState)&&!!(2&i)),n?(a=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(i|=1),B$2(L$2,1&i),null===e?(e=o.children,i=o.fallback,a?(e=ae(t,e,i,r),t.child.memoizedState={baseLanes:r},t.memoizedState=Zd,e):"number"==typeof o.unstable_expectedLoadTime?(e=ae(t,e,i,r),t.child.memoizedState={baseLanes:r},t.memoizedState=Zd,t.lanes=33554432,e):((r=ce({mode:"visible",children:e},t.mode,r,null)).return=t,t.child=r)):(e.memoizedState,a?(o=de(e,t,o.children,o.fallback,r),a=t.child,i=e.child.memoizedState,a.memoizedState=null===i?{baseLanes:r}:{baseLanes:i.baseLanes|r},a.childLanes=e.childLanes&~r,t.memoizedState=Zd,o):(r=ee(e,t,o.children,r),t.memoizedState=null,r))}function ae(e,t,r,n){var o=e.mode,i=e.child;return t={mode:"hidden",children:t},2&o||null===i?i=ce(t,o,0,null):(i.childLanes=0,i.pendingProps=t),r=Qc(r,o,n,null),i.return=e,r.return=e,i.sibling=r,e.child=i,r}function ee(e,t,r,n){var o=e.child;return e=o.sibling,r=Mc(o,{mode:"visible",children:r}),!(2&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=r}function de(e,t,r,n,o){var i=t.mode,a=e.child;e=a.sibling;var s={mode:"hidden",children:r};return 2&i||t.child===a?r=Mc(a,s):((r=t.child).childLanes=0,r.pendingProps=s,null!==(a=r.lastEffect)?(t.firstEffect=r.firstEffect,t.lastEffect=a,a.nextEffect=null):t.firstEffect=t.lastEffect=null),null!==e?n=Mc(e,n):(n=Qc(n,i,o,null)).flags|=2,n.return=t,r.return=t,r.sibling=n,t.child=r,n}function fe(e,t){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),mc(e.return,t)}function ge(e,t,r,n,o,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:o,lastEffect:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=o,a.lastEffect=i)}function he(e,t,r){var n=t.pendingProps,o=n.revealOrder,i=n.tail;if(S$2(e,t,n.children,r),2&(n=L$2.current))n=1&n|2,t.flags|=64;else{if(null!==e&&64&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&fe(e,r);else if(19===e.tag)fe(e,r);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(B$2(L$2,n),2&t.mode)switch(o){case"forwards":for(r=t.child,o=null;null!==r;)null!==(e=r.alternate)&&null===bd(e)&&(o=r),r=r.sibling;null===(r=o)?(o=t.child,t.child=null):(o=r.sibling,r.sibling=null),ge(t,!1,o,r,i,t.lastEffect);break;case"backwards":for(r=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===bd(e)){t.child=o;break}e=o.sibling,o.sibling=r,r=o,o=e}ge(t,!0,r,null,i,t.lastEffect);break;case"together":ge(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function Od(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),vc|=t.lanes,r&t.childLanes){if(null!==e&&t.child!==e.child)throw Error(q$2(153));if(null!==t.child){for(r=Mc(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Mc(e,e.pendingProps)).return=t;r.sibling=null}return t.child}return null}function me(e,t){switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ne(e,t,r){var n=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return E$2(t.type)&&jb(),null;case 3:return Zc(),A$2(D$2),A$2(C$2),dd(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||r.hydrate||(t.flags|=256),je(t),null;case 5:ad(t),r=Xc(Wc.current);var o=t.type;if(null!==e&&null!=t.stateNode)ke(e,t,o,n,r),e.ref!==t.ref&&(t.flags|=128);else{if(!n){if(null===t.stateNode)throw Error(q$2(166));return null}switch(Xc(Uc.current),o){case Ja.CLIPPING_RECTANGLE:var i=da.ClippingRectangle();i._applyProps=Ra;break;case Ja.GROUP:(i=da.Group())._applyProps=Ta;break;case Ja.SHAPE:(i=da.Shape())._applyProps=Va;break;case Ja.TEXT:(i=da.Text(n.children,n.font,n.alignment,n.path))._applyProps=Wa}if(!i)throw Error(q$2(217,o));i._applyProps(i,n),ie(e=i,t,!1,!1),t.stateNode=e,null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)le(e,t,e.memoizedProps,n);else{if("string"!=typeof n&&null===t.stateNode)throw Error(q$2(166));Xc(Wc.current),Xc(Uc.current),t.stateNode=n}return null;case 13:return A$2(L$2),n=t.memoizedState,64&t.flags?(t.lanes=r,t):(r=null!==n,n=!1,null!==e&&(n=null!==e.memoizedState),r&&!n&&2&t.mode&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||1&L$2.current?0===T$2&&(T$2=3):(0!==T$2&&3!==T$2||(T$2=4),null===R$2||!(134217727&vc)&&!(134217727&oe)||pe(R$2,U$1))),(r||n)&&(t.flags|=4),null);case 4:return Zc(),je(t),null;case 10:return lc(t),null;case 19:if(A$2(L$2),null===(n=t.memoizedState))return null;if(i=!!(64&t.flags),null===(o=n.rendering))if(i)me(n,!1);else{if(0!==T$2||null!==e&&64&e.flags)for(e=t.child;null!==e;){if(null!==(o=bd(e))){for(t.flags|=64,me(n,!1),null!==(e=o.updateQueue)&&(t.updateQueue=e,t.flags|=4),null===n.lastEffect&&(t.firstEffect=null),t.lastEffect=n.lastEffect,e=r,r=t.child;null!==r;)i=e,(n=r).flags&=2,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null,null===(o=n.alternate)?(n.childLanes=0,n.lanes=i,n.child=null,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,i=o.dependencies,n.dependencies=null===i?null:{lanes:i.lanes,firstContext:i.firstContext}),r=r.sibling;return B$2(L$2,1&L$2.current|2),t.child}e=e.sibling}null!==n.tail&&G$2()>qe&&(t.flags|=64,i=!0,me(n,!1),t.lanes=33554432)}else{if(!i)if(null!==(e=bd(o))){if(t.flags|=64,i=!0,null!==(e=e.updateQueue)&&(t.updateQueue=e,t.flags|=4),me(n,!0),null===n.tail&&"hidden"===n.tailMode&&!o.alternate)return null!==(t=t.lastEffect=n.lastEffect)&&(t.nextEffect=null),null}else 2*G$2()-n.renderingStartTime>qe&&1073741824!==r&&(t.flags|=64,i=!0,me(n,!1),t.lanes=33554432);n.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=n.last)?e.sibling=o:t.child=o,n.last=o)}return null!==n.tail?(e=n.tail,n.rendering=e,n.tail=e.sibling,n.lastEffect=t.lastEffect,n.renderingStartTime=G$2(),e.sibling=null,t=L$2.current,B$2(L$2,i?1&t|2:1&t),e):null;case 23:case 24:return re(),null!==e&&null!==e.memoizedState!=(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==n.mode&&(t.flags|=4),null}throw Error(q$2(156,t.tag))}function se(e){switch(e.tag){case 1:E$2(e.type)&&jb();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Zc(),A$2(D$2),A$2(C$2),dd(),64&(t=e.flags))throw Error(q$2(285));return e.flags=-4097&t|64,e;case 5:return ad(e),null;case 13:return A$2(L$2),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return A$2(L$2),null;case 4:return Zc(),null;case 10:return lc(e),null;case 23:case 24:return re(),null;default:return null}}function te(e,t){try{var r="",n=t;do{r+=fc(n),n=n.return}while(n);var o=r}catch(i){o="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:o}}function ue(e,t){try{console.error(t.value)}catch(r){setTimeout((function(){throw r}))}}ie=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag){var n=e,o=r.stateNode;if("string"==typeof o)throw Error(q$2(216));o.inject(n)}else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},je=function(){},ke=function(e,t,r,n){e.memoizedProps!==n&&(Xc(Uc.current),t.updateQueue=Oa)&&(t.flags|=4)},le=function(e,t,r,n){r!==n&&(t.flags|=4)};var ve="function"==typeof WeakMap?WeakMap:Map;function we(e,t,r){(r=rc(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){xe||(xe=!0,ye=n),ue(e,t)},r}function ze(e,t,r){(r=rc(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"==typeof n){var o=t.value;r.payload=function(){return ue(e,t),n(o)}}var i=e.stateNode;return null!==i&&"function"==typeof i.componentDidCatch&&(r.callback=function(){"function"!=typeof n&&(null===Ae?Ae=new Set([this]):Ae.add(this),ue(e,t));var r=t.stack;this.componentDidCatch(t.value,{componentStack:null!==r?r:""})}),r}var Be="function"==typeof WeakSet?WeakSet:Set;function Ce(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(r){De(e,r)}else t.current=null}function Ee(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 3:case 5:case 6:case 4:case 17:return;case 1:if(256&t.flags&&null!==e){var r=e.memoizedProps,n=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?r:I$2(t.type,r),n),e.__reactInternalSnapshotBeforeUpdate=t}return}throw Error(q$2(163))}function Fe(e,t,r){switch(r.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=r.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(!(3&~e.tag)){var n=e.create;e.destroy=n()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=r.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var o=e;n=o.next,4&(o=o.tag)&&1&o&&(Ge(r,e),He(r,e)),e=n}while(e!==t)}return;case 1:return e=r.stateNode,4&r.flags&&(null===t?e.componentDidMount():(n=r.elementType===r.type?t.memoizedProps:I$2(r.type,t.memoizedProps),e.componentDidUpdate(n,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=r.updateQueue)&&wc(r,t,e));case 3:if(null!==(t=r.updateQueue)){if(e=null,null!==r.child)switch(r.child.tag){case 5:case 1:e=r.child.stateNode}wc(r,t,e)}return;case 5:case 6:case 4:case 12:case 13:case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(q$2(163))}function Ie(e,t){for(var r=e;;){if(5===r.tag){var n=r.stateNode;t?n.hide():(null==(n=r.memoizedProps).visible||n.visible)&&r.stateNode.show()}else if(6!==r.tag&&(23!==r.tag&&24!==r.tag||null===r.memoizedState||r===e)&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===e)break;for(;null===r.sibling;){if(null===r.return||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}}function Je(e,t){if(pb&&"function"==typeof pb.onCommitFiberUnmount)try{pb.onCommitFiberUnmount(ob,t)}catch(i){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var r=e=e.next;do{var n=r,o=n.destroy;if(n=n.tag,void 0!==o)if(4&n)Ge(t,r);else{n=t;try{o()}catch(i){De(n,i)}}r=r.next}while(r!==e)}break;case 1:if(Ce(t),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(i){De(t,i)}break;case 5:Ce(t);break;case 4:Ke(e,t)}}function Le(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function Me(e){return 5===e.tag||3===e.tag||4===e.tag}function Ne(e){e:{for(var t=e.return;null!==t;){if(Me(t))break e;t=t.return}throw Error(q$2(160))}var r=t;switch(t=r.stateNode,r.tag){case 5:var n=!1;break;case 3:case 4:t=t.containerInfo,n=!0;break;default:throw Error(q$2(161))}16&r.flags&&(r.flags&=-17);e:t:for(r=e;;){for(;null===r.sibling;){if(null===r.return||Me(r.return)){r=null;break e}r=r.return}for(r.sibling.return=r.return,r=r.sibling;5!==r.tag&&6!==r.tag&&18!==r.tag;){if(2&r.flags)continue t;if(null===r.child||4===r.tag)continue t;r.child.return=r,r=r.child}if(!(2&r.flags)){r=r.stateNode;break e}}n?Oe(e,r,t):Pe(e,r,t)}function Oe(e,t,r){var n=e.tag,o=5===n||6===n;if(o)if(e=o?e.stateNode:e.stateNode.instance,t){if(e===t)throw Error(q$2(218));e.injectBefore(t)}else e.parentNode===r&&e.eject(),e.inject(r);else if(4!==n&&null!==(e=e.child))for(Oe(e,t,r),e=e.sibling;null!==e;)Oe(e,t,r),e=e.sibling}function Pe(e,t,r){var n=e.tag,o=5===n||6===n;if(o)if(e=o?e.stateNode:e.stateNode.instance,t){if(e===t)throw Error(q$2(218));e.injectBefore(t)}else e.parentNode===r&&e.eject(),e.inject(r);else if(4!==n&&null!==(e=e.child))for(Pe(e,t,r),e=e.sibling;null!==e;)Pe(e,t,r),e=e.sibling}function Ke(e,t){for(var r=t,n=!1;;){if(!n){n=r.return;e:for(;;){if(null===n)throw Error(q$2(160));switch(n.tag){case 5:0;break e;case 3:case 4:0;break e}n=n.return}n=!0}if(5===r.tag||6===r.tag){e:for(var o=e,i=r,a=i;;)if(Je(o,a),null!==a.child&&4!==a.tag)a.child.return=a,a=a.child;else{if(a===i)break e;for(;null===a.sibling;){if(null===a.return||a.return===i)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}Qa(o=r.stateNode),o.eject()}else if(4===r.tag){if(null!==r.child){r.child.return=r,r=r.child;continue}}else if(Je(e,r),null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;4===(r=r.return).tag&&(n=!1)}r.sibling.return=r.return,r=r.sibling}}function Qe(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if(!(3&~r.tag)){var n=r.destroy;r.destroy=void 0,void 0!==n&&n()}r=r.next}while(r!==t)}return;case 1:case 3:case 12:case 17:return;case 5:if(null!=(r=t.stateNode)){n=t.memoizedProps,e=null!==e?e.memoizedProps:n;var o=t.updateQueue;t.updateQueue=null,null!==o&&r._applyProps(r,n,e)}return;case 6:if(null===t.stateNode)throw Error(q$2(162));return;case 13:return null!==t.memoizedState&&(Re=G$2(),Ie(t.child,!0)),void Se(t);case 19:return void Se(t);case 23:case 24:return void Ie(t,null!==t.memoizedState)}throw Error(q$2(163))}function Se(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Be),t.forEach((function(t){var n=Te.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))}))}}function Ue(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var Ve=Math.ceil,We=ja.ReactCurrentDispatcher,Xe=ja.ReactCurrentOwner,W$1=0,R$2=null,X$1=null,U$1=0,Ye=0,Ze=fb(0),T$2=0,$e=null,af=0,vc=0,oe=0,bf=0,cf=null,Re=0,qe=1/0,Y$1=null,xe=!1,ye=null,Ae=null,df=!1,ef=null,ff=90,gf=[],hf=[],jf=null,kf=0,lf=null,mf=-1,nf=0,of=0,pf=null,qf=!1,If;function zc(){return 48&W$1?G$2():-1!==mf?mf:mf=G$2()}function Ac(e){if(!(2&(e=e.mode)))return 1;if(!(4&e))return 99===Wb()?1:2;if(0===nf&&(nf=af),0!==bc.transition){0!==of&&(of=null!==cf?cf.pendingLanes:0),e=nf;var t=4186112&~of;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=Wb(),4&W$1&&98===e?e=xb(12,nf):e=xb(e=sb(e),nf),e}function Bc(e,t,r){if(50<kf)throw kf=0,lf=null,Error(q$2(185));if(null===(e=rf(e,t)))return null;Ab(e,t,r),e===R$2&&(oe|=t,4===T$2&&pe(e,U$1));var n=Wb();1===t?8&W$1&&!(48&W$1)?sf(e):(Z$1(e,r),0===W$1&&(qe=G$2()+500,$b())):(!(4&W$1)||98!==n&&99!==n||(null===jf?jf=new Set([e]):jf.add(e)),Z$1(e,r)),cf=e}function rf(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}function Z$1(e,t){for(var r=e.callbackNode,n=e.suspendedLanes,o=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-vb(a),l=1<<s,c=i[s];if(-1===c){if(!(l&n)||l&o){c=t,rb(l);var u=F$2;i[s]=10<=u?c+250:6<=u?c+5e3:-1}}else c<=t&&(e.expiredLanes|=l);a&=~l}if(n=ub(e,e===R$2?U$1:0),t=F$2,0===n)null!==r&&(r!==Qb&&Gb(r),e.callbackNode=null,e.callbackPriority=0);else{if(null!==r){if(e.callbackPriority===t)return;r!==Qb&&Gb(r)}15===t?(r=sf.bind(null,e),null===Sb?(Sb=[r],Tb=Fb(Lb,ac)):Sb.push(r),r=Qb):14===t?r=Zb(99,sf.bind(null,e)):r=Zb(r=tb(t),wf.bind(null,e)),e.callbackPriority=t,e.callbackNode=r}}function wf(e){if(mf=-1,of=nf=0,48&W$1)throw Error(q$2(327));var t=e.callbackNode;if(xf()&&e.callbackNode!==t)return null;var r=ub(e,e===R$2?U$1:0);if(0===r)return null;var n=r,o=W$1;W$1|=16;var i=yf();for(R$2===e&&U$1===n||(qe=G$2()+500,zf(e,n));;)try{Af();break}catch(s){Bf(e,s)}if(kc(),We.current=i,W$1=o,null!==X$1?n=0:(R$2=null,U$1=0,n=T$2),af&oe)zf(e,0);else if(0!==n){if(2===n&&(W$1|=64,e.hydrate&&(e.hydrate=!1),0!==(r=wb(e))&&(n=Cf(e,r))),1===n)throw t=$e,zf(e,0),pe(e,r),Z$1(e,G$2()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=r,n){case 0:case 1:throw Error(q$2(345));case 2:case 5:Df(e);break;case 3:if(pe(e,r),(62914560&r)===r&&10<(n=Re+500-G$2())){if(0!==ub(e,0))break;if(((o=e.suspendedLanes)&r)!==r){zc(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Xa(Df.bind(null,e),n);break}Df(e);break;case 4:if(pe(e,r),(4186112&r)===r)break;for(n=e.eventTimes,o=-1;0<r;){var a=31-vb(r);i=1<<a,(a=n[a])>o&&(o=a),r&=~i}if(r=o,10<(r=(120>(r=G$2()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ve(r/1960))-r)){e.timeoutHandle=Xa(Df.bind(null,e),r);break}Df(e);break;default:throw Error(q$2(329))}}return Z$1(e,G$2()),e.callbackNode===t?wf.bind(null,e):null}function pe(e,t){for(t&=~bf,t&=~oe,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-vb(t),n=1<<r;e[r]=-1,t&=~n}}function sf(e){if(48&W$1)throw Error(q$2(327));if(xf(),e===R$2&&e.expiredLanes&U$1){var t=U$1,r=Cf(e,t);af&oe&&(r=Cf(e,t=ub(e,t)))}else r=Cf(e,t=ub(e,0));if(0!==e.tag&&2===r&&(W$1|=64,e.hydrate&&(e.hydrate=!1),0!==(t=wb(e))&&(r=Cf(e,t))),1===r)throw r=$e,zf(e,0),pe(e,t),Z$1(e,G$2()),r;return e.finishedWork=e.current.alternate,e.finishedLanes=t,Df(e),Z$1(e,G$2()),null}function Ud(e,t){B$2(Ze,Ye),Ye|=t,af|=t}function re(){Ye=Ze.current,A$2(Ze)}function zf(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,Ya(r)),null!==X$1)for(r=X$1.return;null!==r;){var n=r;switch(n.tag){case 1:null!=(n=n.type.childContextTypes)&&jb();break;case 3:Zc(),A$2(D$2),A$2(C$2),dd();break;case 5:ad(n);break;case 4:Zc();break;case 13:case 19:A$2(L$2);break;case 10:lc(n);break;case 23:case 24:re()}r=r.return}R$2=e,X$1=Mc(e.current,null),U$1=Ye=af=t,T$2=0,$e=null,bf=oe=vc=0}function Bf(e,t){for(;;){var r=X$1;try{if(kc(),ed.current=nd,gd){for(var n=N$2.memoizedState;null!==n;){var o=n.queue;null!==o&&(o.pending=null),n=n.next}gd=!1}if(fd=0,P$2=O$2=N$2=null,hd=!1,Xe.current=null,null===r||null===r.return){T$2=1,$e=t,X$1=null;break}e:{var i=e,a=r.return,s=r,l=t;if(t=U$1,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==l&&"object"==typeof l&&"function"==typeof l.then){var c=l;if(!(2&s.mode)){var u=s.alternate;u?(s.updateQueue=u.updateQueue,s.memoizedState=u.memoizedState,s.lanes=u.lanes):(s.updateQueue=null,s.memoizedState=null)}var d=!!(1&L$2.current),h=a;do{var p;if(p=13===h.tag){var f=h.memoizedState;if(null!==f)p=null!==f.dehydrated;else{var g=h.memoizedProps;p=void 0!==g.fallback&&(!0!==g.unstable_avoidThisFallback||!d)}}if(p){var m=h.updateQueue;if(null===m){var y=new Set;y.add(c),h.updateQueue=y}else m.add(c);if(!(2&h.mode)){if(h.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var v=rc(-1,1);v.tag=2,sc(s,v)}s.lanes|=1;break e}l=void 0,s=t;var _=i.pingCache;if(null===_?(_=i.pingCache=new ve,l=new Set,_.set(c,l)):void 0===(l=_.get(c))&&(l=new Set,_.set(c,l)),!l.has(s)){l.add(s);var b=Ef.bind(null,i,c,s);c.then(b,b)}h.flags|=4096,h.lanes=t;break e}h=h.return}while(null!==h);l=Error((Da(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==T$2&&(T$2=2),l=te(l,s),h=a;do{switch(h.tag){case 3:i=l,h.flags|=4096,t&=-t,h.lanes|=t,tc(h,we(h,i,t));break e;case 1:i=l;var C=h.type,E=h.stateNode;if(!(64&h.flags||"function"!=typeof C.getDerivedStateFromError&&(null===E||"function"!=typeof E.componentDidCatch||null!==Ae&&Ae.has(E)))){h.flags|=4096,t&=-t,h.lanes|=t,tc(h,ze(h,i,t));break e}}h=h.return}while(null!==h)}Ff(r)}catch(T){t=T,X$1===r&&null!==r&&(X$1=r=r.return);continue}break}}function yf(){var e=We.current;return We.current=nd,null===e?nd:e}function Cf(e,t){var r=W$1;W$1|=16;var n=yf();for(R$2===e&&U$1===t||zf(e,t);;)try{Gf();break}catch(e3){Bf(e,e3)}if(kc(),W$1=r,We.current=n,null!==X$1)throw Error(q$2(261));return R$2=null,U$1=0,T$2}function Gf(){for(;null!==X$1;)Hf(X$1)}function Af(){for(;null!==X$1&&!Hb();)Hf(X$1)}function Hf(e){var t=If(e.alternate,e,Ye);e.memoizedProps=e.pendingProps,null===t?Ff(e):X$1=t,Xe.current=null}function Ff(e){var t=e;do{var r=t.alternate;if(e=t.return,2048&t.flags){if(null!==(r=se(t)))return r.flags&=2047,void(X$1=r);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}else{if(null!==(r=ne(r,t,Ye)))return void(X$1=r);if(24!==(r=t).tag&&23!==r.tag||null===r.memoizedState||1073741824&Ye||!(4&r.mode)){for(var n=0,o=r.child;null!==o;)n|=o.lanes|o.childLanes,o=o.sibling;r.childLanes=n}null!==e&&!(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}if(null!==(t=t.sibling))return void(X$1=t);X$1=t=e}while(null!==t);0===T$2&&(T$2=5)}function Df(e){var t=Wb();return Yb(99,Jf.bind(null,e,t)),null}function Jf(e,t){do{xf()}while(null!==ef);if(48&W$1)throw Error(q$2(327));var r=e.finishedWork;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(q$2(177));e.callbackNode=null;var n=r.lanes|r.childLanes,o=n,i=e.pendingLanes&~o;e.pendingLanes=o,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=o,e.mutableReadLanes&=o,e.entangledLanes&=o,o=e.entanglements;for(var a=e.eventTimes,s=e.expirationTimes;0<i;){var l=31-vb(i),c=1<<l;o[l]=0,a[l]=-1,s[l]=-1,i&=~c}if(null!==jf&&!(24&n)&&jf.has(e)&&jf.delete(e),e===R$2&&(X$1=R$2=null,U$1=0),1<r.flags?null!==r.lastEffect?(r.lastEffect.nextEffect=r,n=r.firstEffect):n=r:n=r.firstEffect,null!==n){o=W$1,W$1|=32,pf=Xe.current=null,qf=!1,Y$1=n;do{try{Kf()}catch(y){if(null===Y$1)throw Error(q$2(330));De(Y$1,y),Y$1=Y$1.nextEffect}}while(null!==Y$1);pf=null,Y$1=n;do{try{for(a=e;null!==Y$1;){var u=Y$1.flags;if(128&u){var d=Y$1.alternate;if(null!==d){var h=d.ref;null!==h&&("function"==typeof h?h(null):h.current=null)}}switch(1038&u){case 2:Ne(Y$1),Y$1.flags&=-3;break;case 6:Ne(Y$1),Y$1.flags&=-3,Qe(Y$1.alternate,Y$1);break;case 1024:Y$1.flags&=-1025;break;case 1028:Y$1.flags&=-1025,Qe(Y$1.alternate,Y$1);break;case 4:Qe(Y$1.alternate,Y$1);break;case 8:Ke(a,s=Y$1);var p=s.alternate;Le(s),null!==p&&Le(p)}Y$1=Y$1.nextEffect}}catch(y){if(null===Y$1)throw Error(q$2(330));De(Y$1,y),Y$1=Y$1.nextEffect}}while(null!==Y$1);e.current=r,Y$1=n;do{try{for(u=e;null!==Y$1;){var f=Y$1.flags;if(36&f&&Fe(u,Y$1.alternate,Y$1),128&f){d=void 0;var g=Y$1.ref;if(null!==g){var m=Y$1.stateNode;Y$1.tag,d=m,"function"==typeof g?g(d):g.current=d}}Y$1=Y$1.nextEffect}}catch(y){if(null===Y$1)throw Error(q$2(330));De(Y$1,y),Y$1=Y$1.nextEffect}}while(null!==Y$1);Y$1=null,Rb(),W$1=o}else e.current=r;if(df)df=!1,ef=e,ff=t;else for(Y$1=n;null!==Y$1;)t=Y$1.nextEffect,Y$1.nextEffect=null,8&Y$1.flags&&((f=Y$1).sibling=null,f.stateNode=null),Y$1=t;if(0===(n=e.pendingLanes)&&(Ae=null),1===n?e===lf?kf++:(kf=0,lf=e):kf=0,r=r.stateNode,pb&&"function"==typeof pb.onCommitFiberRoot)try{pb.onCommitFiberRoot(ob,r,void 0,!(64&~r.current.flags))}catch(y){}if(Z$1(e,G$2()),xe)throw xe=!1,e=ye,ye=null,e;return 8&W$1||$b(),null}function Kf(){for(;null!==Y$1;){var e=Y$1.alternate;qf||null===pf||(8&Y$1.flags?Ia(Y$1,pf)&&(qf=!0):13===Y$1.tag&&Ue(e,Y$1)&&Ia(Y$1,pf)&&(qf=!0));var t=Y$1.flags;256&t&&Ee(e,Y$1),!(512&t)||df||(df=!0,Zb(97,(function(){return xf(),null}))),Y$1=Y$1.nextEffect}}function xf(){if(90!==ff){var e=97<ff?97:ff;return ff=90,Yb(e,Lf)}return!1}function He(e,t){gf.push(t,e),df||(df=!0,Zb(97,(function(){return xf(),null})))}function Ge(e,t){hf.push(t,e),df||(df=!0,Zb(97,(function(){return xf(),null})))}function Lf(){if(null===ef)return!1;var e=ef;if(ef=null,48&W$1)throw Error(q$2(331));var t=W$1;W$1|=32;var r=hf;hf=[];for(var n=0;n<r.length;n+=2){var o=r[n],i=r[n+1],a=o.destroy;if(o.destroy=void 0,"function"==typeof a)try{a()}catch(l){if(null===i)throw Error(q$2(330));De(i,l)}}for(r=gf,gf=[],n=0;n<r.length;n+=2){o=r[n],i=r[n+1];try{var s=o.create;o.destroy=s()}catch(l){if(null===i)throw Error(q$2(330));De(i,l)}}for(s=e.current.firstEffect;null!==s;)e=s.nextEffect,s.nextEffect=null,8&s.flags&&(s.sibling=null,s.stateNode=null),s=e;return W$1=t,$b(),!0}function Mf(e,t,r){sc(e,t=we(e,t=te(r,t),1)),t=zc(),null!==(e=rf(e,1))&&(Ab(e,1,t),Z$1(e,t))}function De(e,t){if(3===e.tag)Mf(e,e,t);else for(var r=e.return;null!==r;){if(3===r.tag){Mf(r,e,t);break}if(1===r.tag){var n=r.stateNode;if("function"==typeof r.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===Ae||!Ae.has(n))){var o=ze(r,e=te(t,e),1);if(sc(r,o),o=zc(),null!==(r=rf(r,1)))Ab(r,1,o),Z$1(r,o);else if("function"==typeof n.componentDidCatch&&(null===Ae||!Ae.has(n)))try{n.componentDidCatch(t,e)}catch(i){}break}}r=r.return}}function Ef(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=zc(),e.pingedLanes|=e.suspendedLanes&r,R$2===e&&(U$1&r)===r&&(4===T$2||3===T$2&&(62914560&U$1)===U$1&&500>G$2()-Re?zf(e,0):bf|=r),Z$1(e,t)}function Te(e,t){var r=e.stateNode;null!==r&&r.delete(t),0===(t=0)&&(2&(t=e.mode)?4&t?(0===nf&&(nf=af),0===(t=yb(62914560&~nf))&&(t=4194304)):t=99===Wb()?1:2:t=1),r=zc(),null!==(e=rf(e,t))&&(Ab(e,t,r),Z$1(e,r))}function Of(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Pf(e,t,r,n){return new Of(e,t,r,n)}function Qd(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Nf(e){if("function"==typeof e)return Qd(e)?1:0;if(null!=e){if((e=e.$$typeof)===ra)return 11;if(e===ua)return 14}return 2}function Mc(e,t){var r=e.alternate;return null===r?((r=Pf(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.nextEffect=null,r.firstEffect=null,r.lastEffect=null),r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Oc(e,t,r,n,o,i){var a=2;if(n=e,"function"==typeof e)Qd(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case ma:return Qc(r.children,o,i,t);case xa:a=8,o|=16;break;case na:a=8,o|=1;break;case oa:return(e=Pf(12,r,t,8|o)).elementType=oa,e.type=oa,e.lanes=i,e;case sa:return(e=Pf(13,r,t,o)).type=sa,e.elementType=sa,e.lanes=i,e;case ta:return(e=Pf(19,r,t,o)).elementType=ta,e.lanes=i,e;case ya:return ce(r,o,i,t);case za:return(e=Pf(24,r,t,o)).elementType=za,e.lanes=i,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case pa:a=10;break e;case qa:a=9;break e;case ra:a=11;break e;case ua:a=14;break e;case va:a=16,n=null;break e;case wa:a=22;break e}throw Error(q$2(130,null==e?e:typeof e,""))}return(t=Pf(a,r,t,o)).elementType=e,t.type=n,t.lanes=i,t}function Qc(e,t,r,n){return(e=Pf(7,e,n,t)).lanes=r,e}function ce(e,t,r,n){return(e=Pf(23,e,n,t)).elementType=ya,e.lanes=r,e}function Nc(e,t,r){return(e=Pf(6,e,null,t)).lanes=r,e}function Pc(e,t,r){return(t=Pf(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Qf(e,t,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=r,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=zb(0),this.expirationTimes=zb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zb(0)}function Rf(e,t,r,n){var o=t.current,i=zc(),a=Ac(o);e:if(r){t:{if(Ea(r=r._reactInternals)!==r||1!==r.tag)throw Error(q$2(170));var s=r;do{switch(s.tag){case 3:s=s.stateNode.context;break t;case 1:if(E$2(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break t}}s=s.return}while(null!==s);throw Error(q$2(171))}if(1===r.tag){var l=r.type;if(E$2(l)){r=lb(r,l,s);break e}}r=s}else r=gb;return null===t.context?t.context=r:t.pendingContext=r,(t=rc(i,a)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),sc(o,t),Bc(o,a,i),a}function Sf(){return null}If=function(e,t,r){var n=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||D$2.current)J$2=!0;else{if(!(r&n)){switch(J$2=!1,t.tag){case 3:Yd(t);break;case 5:$c(t);break;case 1:E$2(t.type)&&mb(t);break;case 4:Yc(t,t.stateNode.containerInfo);break;case 10:n=t.memoizedProps.value;var o=t.type._context;B$2(gc,o._currentValue2),o._currentValue2=n;break;case 13:if(null!==t.memoizedState)return r&t.child.childLanes?$d(e,t,r):(B$2(L$2,1&L$2.current),null!==(t=Od(e,t,r))?t.sibling:null);B$2(L$2,1&L$2.current);break;case 19:if(n=!!(r&t.childLanes),64&e.flags){if(n)return he(e,t,r);t.flags|=64}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),B$2(L$2,L$2.current),n)break;return null;case 23:case 24:return t.lanes=0,Td(e,t,r)}return Od(e,t,r)}J$2=!!(16384&e.flags)}else J$2=!1;switch(t.lanes=0,t.tag){case 2:if(n=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,o=ib(t,C$2.current),nc(t,r),o=jd(null,t,n,e,o,r),t.flags|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,E$2(n)){var i=!0;mb(t)}else i=!1;t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,pc(t);var a=n.getDerivedStateFromProps;"function"==typeof a&&yc(t,n,a,e),o.updater=Cc,t.stateNode=o,o._reactInternals=t,Gc(t,n,e,r),t=Xd(null,t,n,!0,i,r)}else t.tag=0,S$2(null,t,o,r),t=t.child;return t;case 16:o=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,o=(i=o._init)(o._payload),t.type=o,i=t.tag=Nf(o),e=I$2(o,e),i){case 0:t=Sd(null,t,o,e,r);break e;case 1:t=Wd(null,t,o,e,r);break e;case 11:t=Nd(null,t,o,e,r);break e;case 14:t=Pd(null,t,o,I$2(o.type,e),n,r);break e}throw Error(q$2(306,o,""))}return t;case 0:return n=t.type,o=t.pendingProps,Sd(e,t,n,o=t.elementType===n?o:I$2(n,o),r);case 1:return n=t.type,o=t.pendingProps,Wd(e,t,n,o=t.elementType===n?o:I$2(n,o),r);case 3:if(Yd(t),n=t.updateQueue,null===e||null===n)throw Error(q$2(282));return n=t.pendingProps,o=null!==(o=t.memoizedState)?o.element:null,qc(e,t),uc(t,n,null,r),(n=t.memoizedState.element)===o?t=Od(e,t,r):(S$2(e,t,n,r),t=t.child),t;case 5:return $c(t),n=t.type,o=t.pendingProps,i=null!==e?e.memoizedProps:null,a=o.children,Za(n,o)?a=null:null!==i&&Za(n,i)&&(t.flags|=16),Vd(e,t),S$2(e,t,a,r),t.child;case 6:return null;case 13:return $d(e,t,r);case 4:return Yc(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Rc(t,null,n,r):S$2(e,t,n,r),t.child;case 11:return n=t.type,o=t.pendingProps,Nd(e,t,n,o=t.elementType===n?o:I$2(n,o),r);case 7:return S$2(e,t,t.pendingProps,r),t.child;case 8:case 12:return S$2(e,t,t.pendingProps.children,r),t.child;case 10:e:{n=t.type._context,o=t.pendingProps,a=t.memoizedProps,i=o.value;var s=t.type._context;if(B$2(gc,s._currentValue2),s._currentValue2=i,null!==a)if(s=a.value,0===(i=H$2(s,i)?0:0|("function"==typeof n._calculateChangedBits?n._calculateChangedBits(s,i):1073741823))){if(a.children===o.children&&!D$2.current){t=Od(e,t,r);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){a=s.child;for(var c=l.firstContext;null!==c;){if(c.context===n&&c.observedBits&i){1===s.tag&&((c=rc(-1,r&-r)).tag=2,sc(s,c)),s.lanes|=r,null!==(c=s.alternate)&&(c.lanes|=r),mc(s.return,r),l.lanes|=r;break}c=c.next}}else a=10===s.tag&&s.type===t.type?null:s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}S$2(e,t,o.children,r),t=t.child}return t;case 9:return o=t.type,n=(i=t.pendingProps).children,nc(t,r),n=n(o=K$2(o,i.unstable_observedBits)),t.flags|=1,S$2(e,t,n,r),t.child;case 14:return i=I$2(o=t.type,t.pendingProps),Pd(e,t,o,i=I$2(o.type,i),n,r);case 15:return Rd(e,t,t.type,t.pendingProps,n,r);case 17:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:I$2(n,o),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,E$2(n)?(e=!0,mb(t)):e=!1,nc(t,r),Ec(t,n,o),Gc(t,n,o,r),Xd(null,t,n,!0,e,r);case 19:return he(e,t,r);case 23:case 24:return Td(e,t,r)}throw Error(q$2(156,t.tag))},da.setCurrent(ea);var Tf=Array.prototype.slice,Uf=function(){function e(e,t,r,n,o){this._args=Tf.call(arguments)}return e.prototype.applyFill=function(e){e.fillLinear.apply(e,this._args)},e}(),Vf=function(){function e(e,t,r,n,o,i,a){this._args=Tf.call(arguments)}return e.prototype.applyFill=function(e){e.fillRadial.apply(e,this._args)},e}(),Wf=function(){function e(e,t,r,n,o){this._args=Tf.call(arguments)}return e.prototype.applyFill=function(e){e.fillImage.apply(e,this._args)},e}(),Xf=function(e){function t(){return e.apply(this,arguments)||this}ha(t,e);var r=t.prototype;return r.componentDidMount=function(){var e=this.props;this._surface=da.Surface(+e.width,+e.height,this._tagRef),e=new Qf(this._surface,0,!1);var t=Pf(3,null,null,0);e.current=t,t.stateNode=e,pc(t),this._mountNode=e,Rf(this.props.children,this._mountNode,this)},r.componentDidUpdate=function(e){var t=this.props;t.height===e.height&&t.width===e.width||this._surface.resize(+t.width,+t.height),Rf(this.props.children,this._mountNode,this),this._surface.render&&this._surface.render()},r.componentWillUnmount=function(){Rf(null,this._mountNode,this)},r.render=function(){var e=this,t=this.props;return aa.createElement(da.Surface.tagName,{ref:function(t){return e._tagRef=t},accessKey:t.accessKey,className:t.className,draggable:t.draggable,role:t.role,style:t.style,tabIndex:t.tabIndex,title:t.title})},t}(aa.Component),Yf=function(e){function t(t){var r=e.call(this,t)||this;return["height","width","x","y"].forEach((function(e){Object.defineProperty(ia(r),e,{get:function(){return this._text?this._text[e]:void 0}})})),r}return ha(t,e),t.prototype.render=function(){var e=this;return aa.createElement(Ja.TEXT,fa({},this.props,{ref:function(t){return e._text=t}}),La(this.props.children))},t}(aa.Component),Zf={findFiberByHostInstance:function(){return null},bundleType:0,version:"17.0.1",rendererPackageName:"react-art"},$f={bundleType:Zf.bundleType,version:Zf.version,rendererPackageName:Zf.rendererPackageName,rendererConfig:Zf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ja.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ha(e))?null:e.stateNode},findFiberByHostInstance:Zf.findFiberByHostInstance||Sf,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ag=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ag.isDisabled&&ag.supportsFiber)try{ob=ag.inject($f),pb=ag}catch(a2){}}var bg=da.Path;reactArt_production_min.Transform=ca,reactArt_production_min.ClippingRectangle=Ja.CLIPPING_RECTANGLE,reactArt_production_min.Group=Ja.GROUP,reactArt_production_min.LinearGradient=Uf,reactArt_production_min.Path=bg,reactArt_production_min.Pattern=Wf,reactArt_production_min.RadialGradient=Vf,reactArt_production_min.Shape=Ja.SHAPE,reactArt_production_min.Surface=Xf,reactArt_production_min.Text=Yf,reactArt.exports=reactArt_production_min;var reactArtExports=reactArt.exports;const PI=Math.PI,RIGHT_ANGLE=PI/2;class BiasCell extends BaseCell{constructor(e,t){super(e,t)}renderCellContent(){const{value:e}=this.state.data.content,{texts:t}=e;return!isArray$c(t)||t.length<2?null:jsxRuntimeExports.jsxs("div",Object.assign({className:"oh pa t0 l0 r0 b0"},{children:[jsxRuntimeExports.jsx(reactArtExports.Surface,Object.assign({width:this.getContentWidth(),height:this.getContentHeight()},{children:jsxRuntimeExports.jsx(reactArtExports.Group,{children:this._renderSeparator()})})),this._renderText()]}))}_renderSeparator(){const{value:e}=this.state.data.content,{texts:t,backslash:r}=e,n=this._generateAngles(t.length,r);return this._generateSeperatorLines(n,r).map(((e,t)=>{const r=new reactArtExports.Path;return r.moveTo(e[0].x,e[0].y),r.lineTo(e[1].x,e[1].y),jsxRuntimeExports.jsx(reactArtExports.Shape,{d:r,stroke:get$5(this.state.data,"style.font.color","#000000"),strokeWidth:1},"shape"+t)}))}_renderText(){const e=get$5(this.state.data,"content.value",""),{texts:t,backslash:r}=e,n=this._generateAngles(t.length,r);return this._generateTextConfigs(n,r).map(((e,r)=>jsxRuntimeExports.jsx("div",Object.assign({className:"oh pa t0 l0 fdm-text-ellipsis",style:this._getFontStyle(e)},{children:t[r]}),"text"+r)))}_getFontStyle({width:e,translateX:t,translateY:r,rotateZ:n}){let o=this.getFontStyle(),i={width:e,height:this._getLineHeight(),lineHeight:this._getLineHeight()+"px",transform:"translateX(".concat(t,"px) translateY(").concat(r,"px) rotateZ(").concat(n,"deg)"),transformOrigin:"0 50%"};return Object.assign({},o,i)}_generateAngles(e,t){const r=this.getContentWidth(),n=this.getContentHeight();let o=[];if(1===e)return[];if(2===e)o=[Math.atan(n/r),RIGHT_ANGLE-Math.atan(n/r)];else if(3===e){const e={x:0,y:0},t={x:r,y:n*Math.tan(this._degreesToRadians(30))},i={x:r*Math.tan(this._degreesToRadians(30)),y:n},a=this._getAngle(e,t),s=this._getAngle(e,i);o=[a,s-a,RIGHT_ANGLE-s]}else{const t=RIGHT_ANGLE/e;for(let r=0;r<e;r++)o.push(t)}return t&&o.reverse(),o}_generateSeperatorLines(e,t){const r=this.getContentWidth(),n=this.getContentHeight();let o=[],i=0;if(t){const t=Math.atan(r/n);for(let a=0;a<e.length-1;a++)i+=e[a],i<=t?o.push([{x:0,y:n},{x:n*Math.tan(i),y:0}]):o.push([{x:0,y:n},{x:r,y:n-r/Math.tan(i)}])}else{const t=Math.atan(n/r);for(let a=0;a<e.length-1;a++)i+=e[a],i<=t?o.push([{x:0,y:0},{x:r,y:r*Math.tan(i)}]):o.push([{x:0,y:0},{x:n/Math.tan(i),y:n}])}return o}_generateTextConfigs(e,t){const r=this.getContentWidth(),n=this.getContentHeight();let o=[];const i=this._getLineHeight();if(2===e.length)if(t){const t=i/e[1];o.push({translateX:0,translateY:0,width:r-t,rotateZ:0}),o.push({translateX:t,translateY:n-i,width:r-t,rotateZ:0})}else{const t=i/e[0];o.push({translateX:t,translateY:0,width:r-t,rotateZ:0}),o.push({translateX:0,translateY:n-i,width:r-t,rotateZ:0})}else if(3===e.length){const a=i/2/Math.tan(e[1]/2),s=e[0]+e[1]/2;t?(o.push({translateX:0,translateY:0,width:(n-i)*Math.tan(e[0]),rotateZ:0}),o.push({translateX:a*Math.sin(s),translateY:n-a*Math.cos(s)-i/2,rotateZ:this._radiansToDegrees(s-PI/2)}),o.push({translateX:i/Math.tan(e[2]),translateY:n-i,width:r-i/Math.tan(e[2]),rotateZ:0})):(o.push({translateX:i/Math.tan(e[0]),translateY:0,width:r-i/Math.tan(e[0]),rotateZ:0}),o.push({translateX:a*Math.cos(s),translateY:a*Math.sin(s)-i/2,rotateZ:this._radiansToDegrees(s)}),o.push({translateX:0,translateY:n-i,width:(n-i)*Math.tan(e[2]),rotateZ:0}))}else{let r=0;e.forEach((e=>{const a=r+e/2,s=i/2/Math.tan(e/2);t?o.push({translateX:s*Math.sin(a),translateY:n-s*Math.cos(a)-i/2,rotateZ:this._radiansToDegrees(a-PI/2)}):o.push({translateX:s*Math.cos(a),translateY:s*Math.sin(a)-i/2,rotateZ:this._radiansToDegrees(a)}),r+=e}))}return o}_getFontSize(){const{size:e}=this.getStyleData().font;return e}_getLineHeight(){return 1.1*this._getFontSize()}_degreesToRadians(e){return e/180*Math.PI}_radiansToDegrees(e){return e/Math.PI*180}_getAngle(e,t){return Math.atan((t.y-e.y)/(t.x-e.x))}}class TextCell extends BaseCell{renderCellContent(){return jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("span",Object.assign({style:this._getTextStyle()},{children:this.cellValue}))})}_getTextStyle(){const e=this.getStyleData();return CellStyle.getInstance(!1).setFont(null==e?void 0:e.font).setLineHeight(e,"120%").getStyle()}}function getStrokeCss(e,t,r,n){const o=e<r;return{marginLeft:(o?e:r)+"%",width:Math.abs(r-e)+"%",background:"linear-gradient("+"  ".concat(o?"90deg":"-90deg",", ").concat(t,", ").concat(n)+")"}}function getAnimationParams(e,t){return{"--start-margin-left":e+"%","--end-margin-left":(e<t?e:t)+"%","--start-width":0,"--end-width":Math.abs(t-e)+"%"}}function DrawProgressBar(e){const{moveTo:t,lineTo:r,borderRadius:n,trackBackgroundColor:o,fillColorMode:i="solid",fillColorStart:a,fillColorEnd:s,showSplitLine:l,splitLineColor:c,thickness:u,animatedExpand:d}=e,h=t+"%",p=getStrokeCss(t,"solid"===i?s:a,r,s),f=d?getAnimationParams(t,r):{},g=Object.assign(Object.assign({height:"100%",borderRadius:n},p),f);return jsxRuntimeExports.jsxs("div",Object.assign({style:{width:"100%",height:u,display:"flex",borderRadius:n,backgroundColor:o}},{children:[l&&jsxRuntimeExports.jsx(SplitLine,{color:c,cssLeftOrRightForPositioning:h}),jsxRuntimeExports.jsx("div",Object.assign({className:classNames$1({"animated-progress-bar":d}),style:g},{children:e.children}))]}))}function SplitLine(e){const{color:t,cssLeftOrRightForPositioning:r}=e;return jsxRuntimeExports.jsx("div",{className:"split-line",style:{left:"calc(".concat(r," - 1px) "),background:"repeating-linear-gradient("+"  ".concat(t,", ").concat(t," var(--on-length),")+"  rgba(0,0,0,0) var(--on-length),  rgba(0,0,0,0) calc(var(--on-length) + var(--off-length)))"}})}function ProgressBarDispatch(e){var t,r,n;const{barPercent:o,ignoreNegative:i}=e,a=i&&o>0,s=i&&o<=0,l=!i&&o>=0,c=!i&&(null===(t=e.negativeConfig)||void 0===t?void 0:t.barPercent)>0,{radius:u,barBackground:d,barDirection:h,isAnimateExpand:p}=e,{barHeight:f}=e,g=0==+f?"100%":+f+"px",m=1===h?"rtl":"ltr",y=u/2,v={thickness:g,borderRadius:y,trackBackgroundColor:d,showSplitLine:!i,splitLineColor:null===(r=null==e?void 0:e.negativeConfig)||void 0===r?void 0:r.sepLineColor,animatedExpand:p};if(a){const t="ltr"===m,r=t?0:100,n=100*e.barPercent,o=t?r+n:r-n;return jsxRuntimeExports.jsx(DrawProgressBar,Object.assign({moveTo:r,lineTo:o},extractFillColorModeAndEndpointColors(e),v))}if(s)return jsxRuntimeExports.jsx(DrawProgressBar,{moveTo:0,lineTo:0,thickness:g,borderRadius:y,trackBackgroundColor:d});if(l){const t="ltr"===m,r=t?100*(1-e.positivePercentage):100*e.positivePercentage,n=100*e.barPercent*e.positivePercentage,o=t?r+n:r-n;return jsxRuntimeExports.jsx(DrawProgressBar,Object.assign({moveTo:r,lineTo:o},extractFillColorModeAndEndpointColors(e),v))}if(c){const t="ltr"===m,r=e.negativeConfig.negativePercentage,o=null!==(n=e.positivePercentage)&&void 0!==n?n:1-r,i=t?100*r:100*o,a=100*e.negativeConfig.barPercent*e.negativeConfig.negativePercentage,s=t?i-a:i+a;return jsxRuntimeExports.jsx(DrawProgressBar,Object.assign({moveTo:i,lineTo:s},extractFillColorModeAndEndpointColors(e.negativeConfig),v))}return null}function extractFillColorModeAndEndpointColors(e){const{barColor:t,fillingType:r}=e,n=0===r?"gradiant":"solid";let o,i;return"solid"===n?(i=t,o=t):(i=t,o="#FFF"),{fillColorMode:n,fillColorStart:o,fillColorEnd:i}}class ProgressBarCell extends BaseCell{renderCellContent(){const e=this.state.data.content.value,t=!e.isHideData,r=this.getStyleData(),n=CellStyle.getInstance(!1).setFont(null==r?void 0:r.font).setLineHeight(r,"120%").getStyle();return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[t&&jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("span",Object.assign({style:n},{children:e.progressBarValue}))}),jsxRuntimeExports.jsx("div",Object.assign({style:{position:"absolute",height:"100%",display:"flex",alignItems:"center",left:0,right:0,zIndex:-1}},{children:jsxRuntimeExports.jsx(ProgressBarDispatch,Object.assign({},e))}))]})}}const createTableCell=e=>{const{type:t,value:r}=e.content;switch(t){case"image":return ImageCell$1;case"html":return HtmlCell;case"chart":return ChartCell;case"bias":return BiasCell;case"widget":return createWidgetCell(r.type);case"progressbar":return ProgressBarCell;case"text":if(e.sortHeader)return TextCell}},widgetCellMap={},registerWidgetCell=(e,t)=>{widgetCellMap[e]=t},createWidgetCell=e=>widgetCellMap[e];function getSum$1(e){return e.reduce(((e,t)=>e+t),0)}function getSliceSum$1(e,t,r){return getSum$1(e.slice(t,Math.min(t+r,e.length)))}function getIntegerSize$1(e,t=1,r){const n=Math.min(r,Math.round(getSum$1(e)*t)),o=[],i=[];e.forEach(((e,r)=>{const n=e*t,a=Math.round(n),s=a-n;o.push(a),i.push({index:r,gap:s})}));const a=getSum$1(o)-n;if(0===a)return o;if(i.sort(((e,t)=>t.gap-e.gap)),a>0){let e=0,t=a;for(;t>0;){const r=i[e].index;o[r]>1&&(o[r]--,t--),e=e===i.length-1?0:e+1}}else if(a<0)for(let s=i.length+a;s<i.length;s++){const e=i[s].index;o[e]++}return o}const sizeUtils={getSum:getSum$1,getSliceSum:getSliceSum$1,getIntegerSize:getIntegerSize$1},{getSliceSum:getSliceSum}=sizeUtils;class CellsDOMBuilder{constructor(e){this.rows=[],this.columnWidth=[],this.rowHeight=[],this.parentDOM=null,this.reactNode=e,this.containerDOM=null,this.renderRange={},this.scale=1,this.removeExceedElements=debounce$4(this.removeExceedElements.bind(this),100),this.updateVisibleCells=throttle$1(this.updateVisibleCells,50,{leading:!0,trailing:!0}),this.renderMoreCells=throttle$1(this.renderMoreCells,50,{leading:!0,trailing:!0})}setSizes(e){const{columnWidth:t,rowHeight:r}=e;this.columnWidth=t,this.rowHeight=r}setParentDOM(e){this.parentDOM=e}setContainerDOM(e){this.containerDOM=e}setRowCells(e){this.rows=e}resetRawCells(e){if(this.rows=e,this._clearRawCells(),this.parentDOM&&this.containerDOM){const e=this.getRenderRange();this.renderRange=e;const t=this._createDomFragment(e);this.parentDOM.appendChild(t)}}onContainerSizeChange(){this.updateVisibleCells()}onScrollChange(){this.updateVisibleCells()}onScaleChange(e){this.scale=e,this.updateVisibleCells()}updateVisibleCells(){var e;if(!this.parentDOM||!this.containerDOM)return;const t=this.renderRange,r=this.getRenderRange(),n=[],o=r.startRowIndex<t.startRowIndex,i=r.endRowIndex>t.endRowIndex,a=r.startColIndex<t.startColIndex,s=r.endColIndex>t.endColIndex,l=({rowSpan:e,colSpan:t})=>e>1||t>1;i&&n.push(this._createDomFragment({startRowIndex:t.endRowIndex+1,endRowIndex:r.endRowIndex,startColIndex:r.startColIndex,endColIndex:r.endColIndex},l)),o&&n.push(this._createDomFragment({startRowIndex:r.startRowIndex,endRowIndex:t.startRowIndex-1,startColIndex:r.startColIndex,endColIndex:r.endColIndex},l)),s&&n.push(this._createDomFragment({startRowIndex:Math.max(t.startRowIndex,r.startRowIndex),endRowIndex:Math.min(t.endRowIndex,r.endRowIndex),startColIndex:t.endColIndex+1,endColIndex:r.endColIndex},l)),a&&n.push(this._createDomFragment({startRowIndex:Math.max(t.startRowIndex,r.startRowIndex),endRowIndex:Math.min(t.endRowIndex,r.endRowIndex),startColIndex:r.startColIndex,endColIndex:t.startColIndex-1},l));const c=document.createDocumentFragment(),u=new Set;this.parentDOM.querySelectorAll("div[grid]").forEach((e=>u.add(e.getAttribute("grid"))));for(let d=0;d<=r.endRowIndex;d++)for(let t=0;t<=r.endColIndex;t++){const n=null===(e=this.rows[d])||void 0===e?void 0:e[t];if(!n)continue;const{rowSpan:o,colSpan:i}=n.position,a="".concat(d,"-").concat(t);(o>1||i>1)&&!this._isGridExceedRange(a,r)&&(u.has(a)||this._appendTextCellDOM({rowIndex:d,colIndex:t},c))}n.push(c),this.removeExceedElements(r),n.forEach((e=>{this.parentDOM.appendChild(e)})),this.renderRange=r}removeExceedElements(e){const t=[];this.parentDOM.querySelectorAll("div[grid], div[point-grid]").forEach((r=>{const n=r.getAttribute("grid")||r.getAttribute("point-grid");this._isGridExceedRange(n,e)&&t.push(r)})),t.forEach((e=>{this.parentDOM.removeChild(e)}))}renderMoreCells(){if(!this.parentDOM)return;const e=this.renderRange,t=this.getRenderRange(),r=[],n=t.endRowIndex>e.endRowIndex,o=t.endColIndex>e.endColIndex;n&&r.push(this._createDomFragment({startRowIndex:e.endRowIndex+1,endRowIndex:t.endRowIndex,startColIndex:0,endColIndex:Math.min(e.endColIndex,t.endColIndex)})),o&&r.push(this._createDomFragment({startRowIndex:0,endRowIndex:Math.min(e.endRowIndex,t.endRowIndex),startColIndex:e.endColIndex+1,endColIndex:t.endColIndex})),(n||o)&&r.push(this._createDomFragment({startRowIndex:Math.min(e.endRowIndex,t.endRowIndex)+1,endRowIndex:Math.max(e.endRowIndex,t.endRowIndex),startColIndex:Math.min(e.endColIndex,t.endColIndex)+1,endColIndex:Math.max(e.endColIndex,t.endColIndex)})),r.forEach((e=>this.parentDOM.appendChild(e))),this.renderRange={startRowIndex:0,endRowIndex:Math.max(e.endRowIndex,t.endRowIndex),startColIndex:0,endColIndex:Math.max(e.endColIndex,t.endColIndex)}}resetRawCellsSize(){const e=this.parentDOM;if(e)for(let t=0;t<e.children.length;t++){const r=e.children[t],n=r.getAttribute("grid");if(n){const[e,t]=n.split("-").map((e=>Number(e))),o=this.getPosition(this.rows[e][t].position,{rowIndex:e,colIndex:t},!0);Object.assign(r.style,o)}}}updateRawCell(e,t){const r=this.parentDOM;if(!r)return;const n=r.querySelector("#".concat(e));if(n){const e=n.getAttribute("grid");if(e){const[r,o]=e.split("-").map((e=>Number(e))),i={rowIndex:r,colIndex:o};n.innerHTML="",t.zIndex=n.style.zIndex,this._setTextDOMAttributes(t,i,n)}}}getRenderRange(){let e=0,t=0,r=0,n=0;const o=100,i=this.scale,{clientWidth:a,clientHeight:s,scrollLeft:l,scrollTop:c}=this.containerDOM;let u=0;for(let h=0;h<this.rowHeight.length&&(u*i<c-o&&(e=h),u+=this.rowHeight[h],t=h,!(u*i>s+c+o));h++);let d=0;for(let h=0;h<this.columnWidth.length&&(d*i<l-o&&(r=h),d+=this.columnWidth[h],n=h,!(d*i>a+l+o));h++);return{startRowIndex:e,endRowIndex:t,startColIndex:r,endColIndex:n}}getPosition(e,t,r){var n,o;const{rowIndex:i,colIndex:a}=t,{colSpan:s,rowSpan:l}=e,c=null===(o=null===(n=this.rows)||void 0===n?void 0:n[i])||void 0===o?void 0:o[a],u=a>0&&s>0?cellUtils.getBorderWidth(c,"left",1):0,d=i>0&&l>0?cellUtils.getBorderWidth(c,"top",1):0,h=getSliceSum(this.columnWidth,0,a)-u,p=getSliceSum(this.rowHeight,0,i)-d,f=getSliceSum(this.columnWidth,a,s)+u,g=getSliceSum(this.rowHeight,i,l)+d;return{left:r?"".concat(h,"px"):h,top:r?"".concat(p,"px"):p,width:r?"".concat(f,"px"):f,height:r?"".concat(g,"px"):g}}_createDomFragment(e={},t){let r=document.createDocumentFragment();const{startRowIndex:n=0,endRowIndex:o=this.rows.length-1,startColIndex:i=0,endColIndex:a=this.rows[0].length-1}=e;for(let s=n;s<=o;s++)for(let e=i;e<=a;e++){const n={rowIndex:s,colIndex:e};this.parentDOM.querySelector('div[grid="'.concat(s,"-").concat(e,'"]'))||this._appendTextCellDOM(n,r,t)}return r}_appendTextCellDOM(e,t,r){var n;const{rowIndex:o,colIndex:i}=e,a=null===(n=this.rows[o])||void 0===n?void 0:n[i];if(!a||(null==r?void 0:r(a.position)))return;const{type:s}=a.content;if("text"===s&&!a.sortHeader){const r=this._createTextDOM(a,e);r&&t.appendChild(r)}if(a.cornerLose){const r=this._getPointDOM(a,e);r&&t.appendChild(r)}}_createTextDOM(e,t){const r=this.getPosition(e.position,t);if(!cellUtils.isZeroCell(r)){const r=document.createElement("div");return this._setTextDOMAttributes(e,t,r),r}return null}_clearRawCells(){const e=this.parentDOM;if(e)for(let t=0;t<e.children.length;t++){const r=e.children[t];(r.hasAttribute("grid")||r.hasAttribute("point-grid"))&&(e.removeChild(r),t--)}}_setTextDOMAttributes(e,t,r){var n;const o=this.getPosition(e.position,t);r.setAttribute("grid","".concat(t.rowIndex,"-").concat(t.colIndex)),r.setAttribute("id",cellUtils.getCellKey(e.position));const i=e.style,a=CellStyle.hasBorderRadiusSize(null===(n=e.style.border)||void 0===n?void 0:n.borderRadius);r.onclick=this.reactNode.onCellClick;const s=e.content.value&&!1!==e.previewContent;if(a){r.setAttribute("class","pa bsbb oh"),r.setAttribute("style",cellUtils.getPositionStyle(e,o,!0)),r.appendChild(this._getCornerDOMs(e));const t=document.createElement("div");t.setAttribute("class",clsx(cellUtils.getCellRadiusClass(i))),t.setAttribute("style",cellUtils.getCellRadiusStyle(e,!0)),s&&t.appendChild(this._getTextSpan(e)),r.appendChild(t)}else r.setAttribute("class",clsx(cellUtils.getClass(i))),r.setAttribute("style",cellUtils.getStyle(e,o,!0)),s&&r.appendChild(this._getTextSpan(e))}_getTextSpan(e){var t;const r=cellUtils.isNoWrap(e.style),n=document.createElement("span");n.setAttribute("class",r?"wsnw toe oh":"wspw");const o=CellStyle.getInstance(!0).setFont(null===(t=e.style)||void 0===t?void 0:t.font).setLineHeight(e.style,"120%").getStyle();return n.setAttribute("style",o),n.textContent=e.content.value,n}_getCornerDOMs(e){var t;const r=document.createDocumentFragment(),n=(null===(t=e.style.border)||void 0===t?void 0:t.borderRadius)||{},{radius:o,outerBackground:i}=n,a=(e,t)=>{const o=CellStyle.getCornerKey(e,t);if(n[o]){const o=document.createElement("div");o.setAttribute("class","pa"),o.setAttribute("style",cellUtils.getCornerStyle(n,{h:e,v:t},!0)),r.appendChild(o)}};return o&&i&&(a("top","left"),a("bottom","left"),a("top","right"),a("bottom","right")),r}_getPointDOM(e,t){const r=this._getPointData(e,t);if(r){const n=this.getPosition(e.position,t,!0),{pointSize:o,pointColor:i}=r,a=document.createElement("div");a.setAttribute("class","pa"),a.setAttribute("style",CellStyle.stringifyStyle({left:n.left,top:n.top,width:o,height:o,background:i,zIndex:e.zIndex+1}));const{rowIndex:s,colIndex:l}=t;return a.setAttribute("point-grid","".concat(s,"-").concat(l)),a}}_getPointData(e,t){const{width:r,height:n}=this.getPosition(e.position,t);let o=0,i="";if(r>0&&n>0){const{rowIndex:e,colIndex:r}=t,n=this._getNoRadiusBorder(e,r-1,"top"),a=this._getNoRadiusBorder(e-1,r,"left"),s=this._getNoRadiusBorder(e,r,"top"),l=this._getNoRadiusBorder(e,r,"left"),c=Math.max(n.width,a.width),u=Math.max(l.width,s.width),d=Math.max(c,u);c>u?n.width&&a.width&&(o=d,i=n.width>=a.width?n.color:a.color):(null==s?void 0:s.color)&&(null==l?void 0:l.color)&&s.color!==l.color&&(o=d,i=s.width>=l.width?s.color:l.color)}return o?{pointSize:o,pointColor:i}:null}_getNoRadiusBorder(e,t,r){var n,o,i,a,s;const l=null===(a=null===(i=null===(o=null===(n=this.rows)||void 0===n?void 0:n[e])||void 0===o?void 0:o[t])||void 0===i?void 0:i.style)||void 0===a?void 0:a.border;if(!CellStyle.hasBorderRadiusSize(null==l?void 0:l.borderRadius)){const e=null===(s=null==l?void 0:l[r])||void 0===s?void 0:s[0];return{color:null==e?void 0:e.color,width:(null==e?void 0:e.width)||0}}return{width:0}}_isGridExceedRange(e,t){const[r,n]=e.split("-").map((e=>Number(e))),{colSpan:o,rowSpan:i}=this.rows[r][n].position;return r>t.endRowIndex||r+i-1<t.startRowIndex||n>t.endColIndex||n+o-1<t.startColIndex}}class BaseTable extends reactExports.Component{constructor(e){super(e),this.onCellClick=e=>{const t=e.currentTarget,r=t.id,{left:n=0,top:o=0}=t.getBoundingClientRect(),[i,a]=r.match(/\d+/g).map((e=>Number(e)));this.props.onSendCellMessage({row:a,column:i,screenOffset:{left:n,top:o},data:{event:e}})},this.saveCellsWrap=this.saveCellsWrap.bind(this),this.setContainerDOM=this.setContainerDOM.bind(this),this.cellsDOMBuilder=new CellsDOMBuilder(this)}componentWillMount(){const{columnWidth:e,rowHeight:t}=this.props;this.cellsDOMBuilder.setSizes({columnWidth:e,rowHeight:t})}componentWillUpdate(e){const{columnWidth:t,rowHeight:r}=e;this.cellsDOMBuilder.setSizes({columnWidth:t,rowHeight:r})}componentDidMount(){this._resetEventListener(),this.props.cells&&this.cellsDOMBuilder.resetRawCells(this.props.cells)}componentDidUpdate(e){this._resetEventListener(),this._updateRawCells(e),isEqual$4(this.props.style,e.style)||this.cellsDOMBuilder.onContainerSizeChange()}onScrollChange(){this.cellsDOMBuilder.onScrollChange()}onScaleChange(e){this.cellsDOMBuilder.onScaleChange(e)}updateRawCell(e,t){this.cellsDOMBuilder.updateRawCell(e,t)}getTableStyle(){const{columnWidth:e,rowHeight:t}=this.props;return{zIndex:0,width:sizeUtils.getSum(e),height:sizeUtils.getSum(t),transformOrigin:"left top"}}createVirtualCells(){const{cells:e}=this.props;this.cellsDOMBuilder.setRowCells(e);const t=[];return e.forEach(((e,r)=>{e.forEach(((e,n)=>{const o={colIndex:n,rowIndex:r},i=this.cellsDOMBuilder.getPosition(e.position,o);cellUtils.isZeroCell(i)||t.push(this._renderCell(e,i))}))})),t}isEmpty(){const{columnWidth:e,rowHeight:t}=this.props;return 0===e.length||0===t.length}setContainerDOM(e){this.cellsDOMBuilder.setContainerDOM(e)}saveCellsWrap(e){e&&(this.cellsWrap=e,this.cellsDOMBuilder.setParentDOM(findNodeHandle(this.cellsWrap)))}_resetEventListener(){const e=findNodeHandle(this),t=this.props.touchResponder;for(let[r,n]of Object.entries(t))e&&(e.removeEventListener(r,n),e.addEventListener(r,n))}_updateRawCells(e){const{cells:t,columnWidth:r,rowHeight:n}=this.props;this._shouldResetRawCells(e)?this.cellsDOMBuilder.resetRawCells(t):isEqual$4(n,e.rowHeight)&&isEqual$4(r,e.columnWidth)||this.cellsDOMBuilder.resetRawCellsSize()}_shouldResetRawCells(e){const{cells:t,columnWidth:r,rowHeight:n}=this.props,o=e=>e.map((e=>e>0?1:0)),i=e=>e.map((e=>e.filter((e=>{var t;return"text"===(null===(t=e.content)||void 0===t?void 0:t.type)})))),a=!isEqual$4(t,e.cells)&&!isEqual$4(i(t),i(e.cells)),s=!isEqual$4(o(r),o(e.columnWidth))||!isEqual$4(o(n),o(e.rowHeight));return a||s}_renderCell(e,t){const{col:r,row:n,colSpan:o,rowSpan:i}=e.position,{saveCell:a,onSendCellMessage:s}=this.props;if(o>0&&i>0){const o=createTableCell(e);return o?jsxRuntimeExports.jsx(o,{data:e,position:t,saveCell:a,onSendCellMessage:s,scale:this.props.scale},"".concat(n,"-").concat(r)):null}}}class HeadTable extends BaseTable{render(){if(this.isEmpty())return null;const{fixed:e,saveRef:t,prefixCls:r,style:n,onScroll:o}=this.props;return jsxRuntimeExports.jsx("div",Object.assign({className:clsx(["".concat(r,"-head"),"z1","pr"]),ref:r=>{this.setContainerDOM(r),!e&&t("headTable")(r)},onScroll:()=>{o(...arguments),this.onScrollChange()},style:n},{children:jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(this.props.prefixCls," table"),style:this.getTableStyle(),ref:this.saveCellsWrap},{children:this.createVirtualCells()}))}))}}class BodyTable extends BaseTable{constructor(e,t){super(e,t),this._onLayout=this._onLayout.bind(this)}render(){if(this.isEmpty())return null;const{fixed:e,saveRef:t,prefixCls:r,style:n,onScroll:o}=this.props,i="left"===e?"leftBodyTable":"bodyTable";return jsxRuntimeExports.jsx("div",Object.assign({className:clsx(["".concat(r,"-body"),"z0","pr"]),ref:e=>{this.setContainerDOM(e),t(i)(e)},style:n,onScroll:()=>{o(...arguments),this.onScrollChange()}},{children:jsxRuntimeExports.jsx(Content,{className:"".concat(this.props.prefixCls," table"),style:this.getTableStyle(),onLayout:this._onLayout,ref:this.saveCellsWrap,children:this.createVirtualCells()})}))}_onLayout(){const e=this.props.getScale();let t=findNodeHandle(this.cellsWrap).getBoundingClientRect().height;t=Math.ceil(t),this.initialScale=this.initialScale||e,this.initialScale===e&&this.props.onContentSizeChange&&this.props.onContentSizeChange({height:Math.ceil(t)})}}const Content=React.forwardRef(((e,t)=>{const{onLayout:r,children:n}=e,o=__rest$p(e,["onLayout","children"]);return reactExports.useEffect((()=>{r()})),jsxRuntimeExports.jsx("div",Object.assign({},o,{ref:t},{children:n}))})),MOVE_AMPLITUDE=1.6,DECELERATION_AMPLITUDE=.1,DECELERATION_FACTOR=1e3,TRACKER_TIMEOUT=100,MOVE_DEBOUNCE=5;class TouchAutoScrollHandler{constructor(e){this._dragAnimationId=null,this._trackerId=null,this._lastAutoScrollTime=null,this._deltaX=0,this._deltaY=0,this._lastTouchX=0,this._lastTouchY=0,this._startX=0,this._startY=0,this._velocityX=0,this._velocityY=0,this._accumulatedDeltaX=0,this._accumulatedDeltaY=0,this._lastFrameTimestamp=Date.now(),this._autoScrollTimestamp=Date.now(),this._onScroll=e.onScroll,this._canHandleScrollX=e.canHandleScrollX,this._canHandleScrollY=e.canHandleScrollY,this._isDisabled=e.isDisabled,this._onTouchStart=e.onTouchStart,this._onTouchMove=e.onTouchMove,this._onTouchEnd=e.onTouchEnd,this._onTouchCancel=e.onTouchCancel,this._didTouchMove=this._didTouchMove.bind(this),this._track=this._track.bind(this),this._autoScroll=this._autoScroll.bind(this),this._startAutoScroll=this._startAutoScroll.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchCancel=this.onTouchCancel.bind(this)}onTouchStart(e){var t,r;(null===(t=this._isDisabled)||void 0===t?void 0:t.call(this,e))||(this._lastTouchX=e.touches[0].pageX,this._lastTouchY=e.touches[0].pageY,this._startX=e.touches[0].pageX,this._startY=e.touches[0].pageY,this._velocityX=0,this._velocityY=0,this._accumulatedDeltaX=0,this._accumulatedDeltaY=0,this._lastFrameTimestamp=Date.now(),this._lastAutoScrollTime=null,clearInterval(this._trackerId),this._trackerId=setInterval(this._track,TRACKER_TIMEOUT),null===(r=this._onTouchStart)||void 0===r||r.call(this,e))}onTouchMove(e){var t,r,n,o,i,a;if(null===(t=this._isDisabled)||void 0===t?void 0:t.call(this,e))return;const s=e.touches[0].pageX,l=e.touches[0].pageY;this._deltaX=MOVE_AMPLITUDE*(this._lastTouchX-s),this._deltaY=MOVE_AMPLITUDE*(this._lastTouchY-l);const{x:c,y:u}=this._getScrollDirection(s,l),d=c&&(null===(r=this._canHandleScrollX)||void 0===r?void 0:r.call(this,this._getDeltaXY(this._deltaX,this._deltaY))),h=u&&(null===(n=this._canHandleScrollY)||void 0===n?void 0:n.call(this,this._getDeltaXY(this._deltaX,this._deltaY)));d||h?(d?this._lastTouchX=s:this._deltaX=0,h?this._lastTouchY=l:this._deltaY=0,null===this._dragAnimationId&&(null===(i=this._onScroll)||void 0===i||i.call(this,this._getDeltaXY(this._deltaX,this._deltaY)),this._dragAnimationId=requestAnimationFrame(this._didTouchMove)),null===(a=this._onTouchMove)||void 0===a||a.call(this,e,!0)):null===(o=this._onTouchMove)||void 0===o||o.call(this,e,!1)}onTouchEnd(e){var t,r;(null===(t=this._isDisabled)||void 0===t?void 0:t.call(this,e))||(clearInterval(this._trackerId),this._trackerId=null,requestAnimationFrame(this._startAutoScroll),null===(r=this._onTouchEnd)||void 0===r||r.call(this,e))}onTouchCancel(e){var t,r;(null===(t=this._isDisabled)||void 0===t?void 0:t.call(this,e))||(clearInterval(this._trackerId),this._trackerId=null,null===(r=this._onTouchCancel)||void 0===r||r.call(this))}getDOMTouchEvents(){return{touchstart:this.onTouchStart,touchmove:this.onTouchMove,touchend:this.onTouchEnd,touchcancel:this.onTouchCancel}}_didTouchMove(){this._dragAnimationId=null,this._accumulatedDeltaX+=this._deltaX,this._accumulatedDeltaY+=this._deltaY,this._deltaX=0,this._deltaY=0}_track(){const e=Date.now(),t=e-this._lastFrameTimestamp,r=this._velocityX,n=this._velocityY;let o=.8;t<TRACKER_TIMEOUT&&(o*=t/TRACKER_TIMEOUT),0===r&&0===n&&(o=1),this._velocityX=o*(TRACKER_TIMEOUT*this._accumulatedDeltaX/(1+t)),o<1&&(this._velocityX+=(1-o)*r),this._velocityY=o*(TRACKER_TIMEOUT*this._accumulatedDeltaY/(1+t)),o<1&&(this._velocityY+=(1-o)*n),this._accumulatedDeltaX=0,this._accumulatedDeltaY=0,this._lastFrameTimestamp=e}_startAutoScroll(){this._autoScrollTimestamp=Date.now(),(Math.abs(this._deltaX)>0||Math.abs(this._deltaY)>0)&&this._didTouchMove(),this._track(),this._autoScroll()}_autoScroll(){var e,t,r;const n=Date.now(),o=n-this._autoScrollTimestamp,i=this._lastAutoScrollTime?Math.max((n-this._lastAutoScrollTime)/10,1):1;this._lastAutoScrollTime=n;const a=i*DECELERATION_AMPLITUDE*Math.exp(-o/DECELERATION_FACTOR);let s=a*this._velocityX,l=a*this._velocityY;const{x:c,y:u}=this._getScrollDirection(this._lastTouchX,this._lastTouchY),d=this._getDeltaXY(s,l);(!c||Math.abs(s)<=MOVE_DEBOUNCE||!(null===(e=this._canHandleScrollX)||void 0===e?void 0:e.call(this,d)))&&(s=0),(!u||Math.abs(l)<=MOVE_DEBOUNCE||!(null===(t=this._canHandleScrollY)||void 0===t?void 0:t.call(this,d)))&&(l=0),0===s&&0===l||(null===(r=this._onScroll)||void 0===r||r.call(this,d),requestAnimationFrame(this._autoScroll))}_getDeltaXY(e,t){return{deltaX:e,deltaY:t}}_getScrollDirection(e,t){const r=Math.abs(this._startX-e),n=Math.abs(this._startY-t);return{x:r>2*n,y:n>2*r}}}class TableMarquee{constructor(e){this.tableRef=e}get props(){return this.tableRef.props}get table(){return this.tableRef.table}get headTable(){return this.tableRef.headTable}get bodyTable(){return this.tableRef.bodyTable}_getScrollContainerInfo(){var e,t;let r,n,o;return this.tableRef.tableManager.useStickyFrozen()?(o=this.table,r=this.table.offsetHeight-(null===(e=this.headTable)||void 0===e?void 0:e.offsetHeight)||0,n=this.table.offsetWidth-(null===(t=this.leftBodyTable)||void 0===t?void 0:t.offsetWidth)||0):(o=this.bodyTable,r=this.bodyTable.offsetHeight,n=this.bodyTable.offsetWidth),{container:o,width:n,height:r}}_isHorizontal(e){return"left"===e||"right"===e}_isReverse(e){return"bottom"===e||"right"===e}_getMaxScroll(e){const{height:t,width:r}=this._getScrollContainerInfo();return this._isHorizontal(e)?this.bodyTable.scrollWidth-r:this.bodyTable.scrollHeight-t}startMarquee(e){this.stopMarquee(),this.bodyTable&&(e&&("offset"in e||"interval"in e)?this._startMarqueeOld(e):this._startMarquee(e))}_startMarqueeOld(e={}){const{offset:t=5,interval:r=.1,stopOnHover:n=!0,to:o="top"}=e,i=this._isHorizontal(o);this._marqueeInterval=setInterval((()=>{if(n&&this.tableRef.isHover)return;const{container:e}=this._getScrollContainerInfo(),r=i?"x":"y",a=i?"scrollLeft":"scrollTop",s=this._getMaxScroll(o);let l=e[a]+t;l>=s?this.tableRef.scrollTo({[r]:0}):this.tableRef.scrollTo({[r]:l})}),1e3*r)}_startMarquee(e={}){const{mode:t="page",speed:r=50,to:n="top",stay:o=0,joinable:i=!1,stopOnHover:a=!0}=e,{rowHeight:s,colWidth:l,frozenCol:c,frozenRow:u}=this.props.data;let d=0,h=0;const p=this._isHorizontal(n),f=this._isReverse(n);let g,m,y;const v=p?"x":"y",_=()=>{const{width:e,height:r}=this._getScrollContainerInfo();if("item"===t){return(p?l:s)[g]*this.props.getScale()}return p?e:r},b=()=>{g=p?c:u,y=_(),m=0};b();const C=e=>{if(!d)return void(d=e);const t=r*(e-d)/1e3;if(d=e,a&&this.tableRef.isHover)return;if(o&&m>y){if(!(e-h>1e3*o))return;g++,y+=_()}m+=t;const i=this._getMaxScroll(n);m>i&&b(),this.tableRef.scrollTo({[v]:f?i-m:m}),h=e},E=e=>{C(e),this._marqueeRaf=window.requestAnimationFrame(E)};this._marqueeRaf=window.requestAnimationFrame(E)}stopMarquee(){isNil$3(this._marqueeInterval)||(clearInterval(this._marqueeInterval),this._marqueeInterval=null),isNil$3(this._marqueeRaf)||(window.cancelAnimationFrame(this._marqueeRaf),this._marqueeRaf=null)}}const FRAME_UPDATE_TIME=16;let Table$2=class extends reactExports.Component{constructor(e,t){super(e,t),this.saveRef=e=>t=>{this[e]=t},this.onSendCellMessage=e=>{var t,r;return null===(r=(t=this.props).onSendCellMessage)||void 0===r?void 0:r.call(t,e)},this.saveCell=(e,t)=>{const r=cellUtils.getCellKey(e);this.cells[r]=t},this._onScroll=({deltaX:e,deltaY:t})=>{var r,n,o,i,a,s,l;this.lastScrollX=clamp$5(this.lastScrollX+e,0,this.maxScrollX),this.lastScrollY=clamp$5(this.lastScrollY+t,0,this.maxScrollY),this.target===this.headTable?(null===(r=this.headTable)||void 0===r||r.scrollBy(e,0),null===(n=this.bodyTable)||void 0===n||n.scrollBy(e,0)):this.target===this.leftBodyTable?(null===(o=this.leftBodyTable)||void 0===o||o.scrollBy(0,t),null===(i=this.bodyTable)||void 0===i||i.scrollBy(0,t)):this.target===this.bodyTable&&(null===(a=this.headTable)||void 0===a||a.scrollBy(e,0),null===(s=this.leftBodyTable)||void 0===s||s.scrollBy(0,t),null===(l=this.bodyTable)||void 0===l||l.scrollBy(e,t)),this.onScrollPositionChange()},this._isDisabled=e=>{if(this.props.blockGestures||e.touches.length>1)return!0},this._canHandleScrollX=({deltaX:e})=>(e=Math.round(e),this.lastScrollX>0&&e<0||this.lastScrollX<this.maxScrollX&&e>=0),this._canHandleScrollY=({deltaY:e})=>(e=Math.round(e),this.lastScrollY>0&&e<0||this.lastScrollY<this.maxScrollY&&e>=0),this._onTouchStart=e=>{var t,r;this.target=e.currentTarget,this.maxScrollX=this.bodyTable.scrollWidth-this.bodyTable.offsetWidth,this.maxScrollY=this.bodyTable.scrollHeight-this.bodyTable.offsetHeight,this.lastScrollX=null===(t=this.bodyTable)||void 0===t?void 0:t.scrollLeft,this.lastScrollY=null===(r=this.bodyTable)||void 0===r?void 0:r.scrollTop},this._onTouchMove=(e,t)=>{t&&e.preventDefault()},this.cells={},this.touchHandler=new TouchAutoScrollHandler({onScroll:this._onScroll,isDisabled:this._isDisabled,canHandleScrollX:this._canHandleScrollX,canHandleScrollY:this._canHandleScrollY,onTouchStart:this._onTouchStart,onTouchMove:this._onTouchMove}),this.syncScrollPositionByActiveElement=debounce$4(this.syncScrollPositionByActiveElement.bind(this),FRAME_UPDATE_TIME),this.onScrollPositionChange=this.onScrollPositionChange.bind(this),this.modifyTableData(e),this.tableManager.setData(e.data),this.completePosition(this.props.data.cells),this.tableMarquee=new TableMarquee(this)}get tableManager(){return this.props.tableManager}componentWillUpdate(e){var t,r;const{data:n}=e;if(null===(r=(t=this.props).onTableLayout)||void 0===r||r.call(t),!isEqual$4(n,this.props.data)){this.completePosition(n.cells),this.modifyTableData(e),this.tableManager.setData(n);const t=this.tableManager.leftContainerWidth(),r=this.tableManager.headContainerHeight();this.props.onSizeChange(t,r)}}modifyTableData(e){e.data&&e.forbidenRowFreeze&&(e.data.frozenRow=0)}componentDidMount(){var e,t;null===(t=(e=this.props).onTableLayout)||void 0===t||t.call(e)}render(){return jsxRuntimeExports.jsx("div",Object.assign({},this._getTouchEvent(),{className:this.props.prefixCls,style:this._getContainerStyle(),ref:e=>this.table=e},{children:this._renderLayoutTable()}))}_getTouchEvent(){return{onTouchStart:e=>{this.isHover=!0,this.props.onTouchStart(e)},onTouchMove:this.props.onTouchMove,onTouchEnd:e=>{this.isHover=!1,this.props.onTouchEnd(e)},onTouchCancel:e=>{this.isHover=!1,this.props.onTouchCancel(e)}}}completePosition(e){const t=cellUtils.getCellsPosition(e),{row:r,column:n}=this.tableManager.frozenInfo();e.forEach((e=>{e.forEach((e=>{var o,i,a;const s=e.position,{col:l,row:c,colSpan:u,rowSpan:d}=s,h=null===(o=t[c])||void 0===o?void 0:o[l+u],p=null===(i=t[c+d])||void 0===i?void 0:i[l],f=l+u===n,g=c+d===r;if(s.coveredRightWidth=f||!h?0:cellUtils.getBorderWidth(h,"left",1),e.sortHeader){const{ICON_SIZE:e,MARGIN_LEFT:t,MARGIN_RIGHT:r}=SortHeaderIcon;s.coveredRightWidth+=e+t+r}s.coveredBottomWidth=g||!p?0:cellUtils.getBorderWidth(p,"top",1);const m=null===(a=t[c+d])||void 0===a?void 0:a[l+p.position.colSpan];m&&this._markCornerLose(h,p,m)}))}))}updateCell(e){const t=cellUtils.getCellKey(e.position),r=this.cells[t];if(r)r.updateCell(e);else{["Body","Head","leftBody","leftHead"].forEach((r=>{var n;null===(n=this.refs[r])||void 0===n||n.updateRawCell(t,e)}))}}onScaleChange(e){["Body","Head","leftBody"].forEach((t=>{var r;null===(r=this.refs[t])||void 0===r||r.onScaleChange(e)}))}onReceiveCellMessage(e){var t;const{type:r,position:n={},data:o}=e,i=cellUtils.getCellKey(n),a=this.cells[i];null===(t=null==a?void 0:a[r])||void 0===t||t.call(a,o)}scrollTo({x:e,y:t}={}){const{bodyTable:r,headTable:n,leftBodyTable:o,table:i}=this,a=this.tableManager.useStickyFrozen()?i:r;a&&(a.scrollLeft=e,a.scrollTop=t),n&&(n.scrollLeft=e),o&&(o.scrollTop=t),this.onScrollPositionChange()}scrollBy({x:e,y:t}={}){const{bodyTable:r,headTable:n,leftBodyTable:o}=this;let i,a;if(r){const n=r.scrollWidth-r.offsetWidth,o=r.scrollHeight-r.offsetHeight;i=r.scrollLeft+e>n?0:r.scrollLeft+e,a=r.scrollTop+t>o?0:r.scrollTop+t,r.scrollLeft=i,r.scrollTop=a}n&&(n.scrollLeft=i),o&&(o.scrollTop=a)}getScrollOffset(){var e,t;return{x:Math.round(null===(e=this.bodyTable)||void 0===e?void 0:e.scrollLeft),y:Math.round(null===(t=this.bodyTable)||void 0===t?void 0:t.scrollTop)}}syncScrollPositionByActiveElement(){const e=document.activeElement;if(e===document.body)return;const{bodyTable:t,headTable:r,leftBodyTable:n}=this;t.contains(e)?(n&&(n.scrollTop=t.scrollTop),r&&(r.scrollLeft=t.scrollLeft)):(null==n?void 0:n.contains(e))?t.scrollTop=n.scrollTop:(null==r?void 0:r.contains(e))&&(t.scrollLeft=r.scrollLeft)}onScrollPositionChange(){this.props.onScrollPositionChange(this.getScrollOffset())}startMarquee(e){this.tableMarquee.startMarquee(e)}stopMarquee(){this.tableMarquee.stopMarquee()}_markCornerLose(e,t,r){const n=cellUtils.getBorderWidth(e,"left"),o=cellUtils.getBorderWidth(t,"top");1===n&&1===o&&(r.cornerLose=0===cellUtils.getBorderWidth(r,"left")&&0===cellUtils.getBorderWidth(r,"top"))}_getContainerStyle(){const{style:e,blockGestures:t,filter:r}=this.props,{width:n,height:o}=this.tableManager.containerSize();return Object.assign(Object.assign({},e),{width:n,height:o,overflow:t?"hidden":"auto",display:"block",filter:r})}_renderLayoutTable(){const{tableManager:e}=this,{prefixCls:t,useStickyFrozen:r}=this.props;if(e.isAnyColumnsFixed()){const n=this.props.prefixCls;return jsxRuntimeExports.jsxs("div",Object.assign({className:clsx([n,"df"]),style:r?{width:e.sectionIntegerSize().width}:{}},{children:[jsxRuntimeExports.jsx("div",Object.assign({className:clsx(["".concat(t,"-left"),"z1","pr"]),style:r?{position:"sticky",left:0}:{}},{children:this._renderTable("left")})),jsxRuntimeExports.jsx("div",Object.assign({className:clsx(["".concat(t,"-main"),"z0","pr"])},{children:this._renderTable()}))]}))}return this._renderTable()}_renderTable(e){const{cells:t}=this._getFixedTableData(e),r=this._getSharedProps(e);return[this._renderHeadTable(t.head,r),this._renderBodyTable(t.body,r)]}_getSharedProps(e){const{saveRef:t,saveCell:r,props:n,onSendCellMessage:o}=this,{onContentSizeChange:i,useStickyFrozen:a}=this.props,s=this.tableManager.isAnyFrozenTable()&&!a,l=s?this.touchHandler.getDOMTouchEvents():{},c=s?this.syncScrollPositionByActiveElement:this.onScrollPositionChange,{width:u,columnWidth:d}=this._getFixedTableData(e);return{fixed:e,saveRef:t,saveCell:r,width:a?"auto":u,columnWidth:d,touchResponder:l,onScroll:c,onSendCellMessage:o,onContentSizeChange:i,prefixCls:n.prefixCls,getScale:n.getScale}}_renderHeadTable(e,t){const{tableManager:r}=this,{useStickyFrozen:n}=this.props;return jsxRuntimeExports.jsx(HeadTable,Object.assign({},t,{ref:"".concat(t.fixed||"","Head"),cells:e,useStickyFrozen:n,style:n?{position:"sticky",top:0}:{width:t.width,height:r.headContainerHeight()},rowHeight:r.integerHeadRowHeight()}),"head")}_renderBodyTable(e,t){const{tableManager:r}=this,{useStickyFrozen:n,blockGestures:o}=this.props,i=r.isAnyFrozenTable();return jsxRuntimeExports.jsx(BodyTable,Object.assign({},t,{ref:"".concat(t.fixed||"","Body"),cells:e,style:{width:t.width,height:n?"auto":r.bodyContainerHeight(),overflow:o||i?"hidden":"auto",transformOrigin:"left top"},isAnyFrozenTable:i,rowHeight:r.integerBodyRowHeight()}),"body")}_getFixedTableData(e){let t,r,n,o;const{tableManager:i}=this;if("left"===e)t=i.leftHeadTableCells(),r=i.leftBodyTableCells(),n=i.leftContainerWidth(),o=i.integerLeftColumnWidth();else t=i.mainHeadTableCells(),r=i.mainBodyTableCells(),n=i.mainContainerWidth(),o=i.integerMainColumnWidth();return{width:n,columnWidth:o,cells:{head:t,body:r}}}};Table$2.defaultProps={prefixCls:"react-table",blockGestures:!1,filter:Device.ios()?"blur(0)":"none"};const{getSum:getSum}=sizeUtils;class TableManager{constructor(e){this._cached={},this.scale=1,this.cells=[],this.setData(e)}setData(e){this.reset(),this.data=e,e.cells&&(this.cells=e.cells)}setCells(e){this.reset(),this.cells=e}sizeInfo(){const{rowHeight:e,colWidth:t,rowCount:r,colCount:n}=this.data;return{rowHeight:e,colWidth:t,rowCount:r,colCount:n}}frozenInfo(){const{frozenCol:e,frozenRow:t,colCount:r,rowCount:n}=this.data;return{column:e===r?0:e,row:t===n?0:t}}isAnyColumnsFixed(){const{column:e}=this.frozenInfo();return e>0}isAnyRowsFixed(){const{row:e}=this.frozenInfo();return e>0}isAnyFrozenTable(){return this.isAnyColumnsFixed()||this.isAnyRowsFixed()}containerSize(){return this.data.containerSize}_tableCells(){return this.cells}_mainTableCells(){return this._cache("_mainTableCells",(()=>{const{column:e}=this.frozenInfo();return this._tableCells().map((t=>t.slice(e)))}))}_leftTableCells(){return this._cache("_leftTableCells",(()=>{const{column:e}=this.frozenInfo();return this._tableCells().map((t=>t.slice(0,e)))}))}mainHeadTableCells(){return this._cache("mainHeadTableCells",(()=>{const{row:e}=this.frozenInfo(),t=this._mainTableCells().slice(0,e);return this.setCellZIndex(t)}))}mainBodyTableCells(){return this._cache("mainBodyTableCells",(()=>{const{row:e}=this.frozenInfo(),t=this._mainTableCells().slice(e);return this.setCellZIndex(t)}))}leftHeadTableCells(){return this._cache("leftHeadTableCells",(()=>{const{row:e}=this.frozenInfo(),t=this._leftTableCells().slice(0,e);return this.setCellZIndex(t)}))}leftBodyTableCells(){return this._cache("leftBodyTableCells",(()=>{const{row:e}=this.frozenInfo(),t=this._leftTableCells().slice(e);return this.setCellZIndex(t)}))}setCellZIndex(e){return e.forEach(((t,r)=>{t.forEach(((t,n)=>{this._calculateCellZIndex(e,r,n)}))})),e}useStickyFrozen(){return!1}sectionIntegerSize(){return this._cache("sumIntegerColumnWidth",(()=>({width:sizeUtils.getSum(this._integerColumnWidth()),height:sizeUtils.getSum(this._integerRowHeight()),leftWidth:sizeUtils.getSum(this.integerLeftColumnWidth()),mainWidth:sizeUtils.getSum(this.integerMainColumnWidth()),headHeight:sizeUtils.getSum(this.integerHeadRowHeight()),bodyHeight:sizeUtils.getSum(this.integerBodyRowHeight())})))}_calculateCellZIndex(e,t,r){var n;const o=null===(n=null==e?void 0:e[t])||void 0===n?void 0:n[r];if(!o)return 0;if(_isNumber(o.zIndex))return o.zIndex;let i=0;const{colSpan:a,rowSpan:s}=o.position;return i=0===a||0===s?Math.max(this._calculateCellZIndex(e,t,r-1),this._calculateCellZIndex(e,t-1,r)):Math.max(this._calculateCellZIndex(e,t+s-1,r-1),this._calculateCellZIndex(e,t-1,r+a-1))+1,o.zIndex=i,i}_integerColumnWidth(){return this._cache("_integerColumnWidth",(()=>{const{colWidth:e}=this.sizeInfo();return e}))}_integerRowHeight(){return this._cache("_integerRowHeight",(()=>{const{rowHeight:e}=this.sizeInfo();return e}))}integerLeftColumnWidth(){return this._cache("integerLeftColumnWidth",(()=>{const{column:e}=this.frozenInfo();return this._integerColumnWidth().slice(0,e)}))}integerMainColumnWidth(){return this._cache("integerMainColumnWidth",(()=>{const{column:e}=this.frozenInfo();return this._integerColumnWidth().slice(e)}))}integerHeadRowHeight(){return this._cache("integerHeadRowHeight",(()=>{const{row:e}=this.frozenInfo();return this._integerRowHeight().slice(0,e)}))}integerBodyRowHeight(){return this._cache("integerBodyRowHeight",(()=>{const{row:e}=this.frozenInfo();return this._integerRowHeight().slice(e)}))}leftContainerWidth(){return this._cache("leftContainerWidth",(()=>{const e=this.integerLeftColumnWidth();return e.length>0?getSum(e):0}))}mainContainerWidth(){return this._cache("mainContainerWidth",(()=>{const{width:e}=this.containerSize();return e-this.leftContainerWidth()}))}headContainerHeight(){return this._cache("headContainerHeight",(()=>{const e=this.integerHeadRowHeight();return e.length>0?getSum(e):0}))}bodyContainerHeight(){return this._cache("bodyContainerHeight",(()=>{const{height:e}=this.containerSize();return e-this.headContainerHeight()}))}tableMaxScrollLeft(e){return getSum(this.integerMainColumnWidth())*e-(this.containerSize().width-this.leftContainerWidth()*e)}tableMaxScrollTop(e){return getSum(this.integerBodyRowHeight())*e-(this.containerSize().height-this.headContainerHeight()*e)}reset(){this._cached={}}_cache(e,t){return e in this._cached||(this._cached[e]=t()),this._cached[e]}}var DEG_TO_RAD=.017453292519943295,Matrix2D=function(e,t,r,n,o,i){return this.a=null==e?1:e,this.b=t||0,this.c=r||0,this.d=null==n?1:n,this.tx=o||0,this.ty=i||0,this};function observe(e,t,r){for(var n=0,o=t.length;n<o;n++){watch(e,t[n],r)}}function watch(e,t,r){Object.defineProperty(e,t,{get:function(){return this["_"+t]},set:function(e){this["_"+t]=e,r()}})}function isElement$1(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}function Transform(e){if(!e.___mixCSS3Transform2d){var t=isElement$1(e);e.___mixCSS3Transform2d=!0,observe(e,["translateX","translateY","scaleX","scaleY","rotation","skewX","skewY","originX","originY"],(function(){var r=e.matrix2d.identity().appendTransform(e.translateX,e.translateY,e.scaleX,e.scaleY,e.rotate,e.skewX,e.skewY,e.originX,e.originY),n="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.tx,",").concat(r.ty,")");t?(e.style.transform=e.style.msTransform=e.style.OTransform=e.style.MozTransform=e.style.webkitTransform=n,e.style.MozTransformOrigin=e.style.OTransformOrigin=e.style.msTransformOrigin=e.style.webkitTransformOrigin=e.style.transformOrigin):e.transform=n})),e.matrix2d=new Matrix2D,e.scaleX=e.scaleY=1,e.translateX=e.translateY=e.rotation=e.skewX=e.skewY=e.originX=e.originY=0}}Matrix2D.prototype={identity:function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},appendTransform:function(e,t,r,n,o,i,a,s,l){if(o%360)var c=o*DEG_TO_RAD,u=Math.cos(c),d=Math.sin(c);else u=1,d=0;return i||a?(i*=DEG_TO_RAD,a*=DEG_TO_RAD,this.append(Math.cos(a),Math.sin(a),-Math.sin(i),Math.cos(i),e,t),this.append(u*r,d*r,-d*n,u*n,0,0)):this.append(u*r,d*r,-d*n,u*n,e,t),(s||l)&&(this.tx-=s*this.a+l*this.c,this.ty-=s*this.b+l*this.d),this},append:function(e,t,r,n,o,i){var a=this.a,s=this.b,l=this.c,c=this.d;return this.a=e*a+t*l,this.b=e*s+t*c,this.c=r*a+n*l,this.d=r*s+n*c,this.tx=o*a+i*l+this.tx,this.ty=o*s+i*c+this.ty,this},initialize:function(e,t,r,n,o,i){return this.a=e,this.b=t,this.c=r,this.d=n,this.tx=o,this.ty=i,this},setValues:function(e,t,r,n,o,i){return this.a=null==e?1:e,this.b=t||0,this.c=r||0,this.d=null==n?1:n,this.tx=o||0,this.ty=i||0,this},copy:function(e){return this.setValues(e.a,e.b,e.c,e.d,e.tx,e.ty)}},Transform.getMatrix2D=function(e){var t={translateX:0,translateY:0,rotation:0,skewX:0,skewY:0,originX:0,originY:0,scaleX:1,scaleY:1};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return(new Matrix2D).identity().appendTransform(t.translateX,t.translateY,t.scaleX,t.scaleY,t.rotation,t.skewX,t.skewY,t.originX,t.originY)};class WebFinger extends reactExports.Component{constructor(e){super(e),this.preV={x:null,y:null},this.pinchStartLen=null,this.scale=1,this.isDoubleTap=!1,this.delta=null,this.last=null,this.now=null,this.end=null,this.multiTouch=!1,this.tapTimeout=null,this.longTapTimeout=null,this.singleTapTimeout=null,this.swipeTimeout=null,this.x1=this.x2=this.y1=this.y2=null,this.preTapPosition={x:null,y:null},this.afterLongTap=!1,this.afterLongTapTimeout=null}getLen(e){return Math.sqrt(e.x*e.x+e.y*e.y)}dot(e,t){return e.x*t.x+e.y*t.y}getAngle(e,t){var r=this.getLen(e)*this.getLen(t);if(0===r)return 0;var n=this.dot(e,t)/r;return n>1&&(n=1),Math.acos(n)}cross(e,t){return e.x*t.y-t.x*e.y}getRotateAngle(e,t){var r=this.getAngle(e,t);return this.cross(e,t)>0&&(r*=-1),180*r/Math.PI}_resetState(){this.setState({x:null,y:null,swiping:!1,start:0})}_emitEvent(e,...t){this.props[e]&&this.props[e](...t)}_isParentNode(e,t){for(;null!=e&&null!=e&&"BODY"!=e.tagName.toUpperCase();){if(e==t)return!0;e=e.parentNode}return!1}_handleTouchStart(e){if(e.touches){this._emitEvent("onTouchStart",e),this.now=Date.now(),this.x1=e.touches[0].pageX,this.y1=e.touches[0].pageY,this.delta=this.now-(this.last||this.now);var t=this.preV,r=e.touches.length;if(null!==this.preTapPosition.x&&(this.isDoubleTap=1===r&&this.delta>0&&this.delta<=250&&Math.abs(this.preTapPosition.x-this.x1)<30&&Math.abs(this.preTapPosition.y-this.y1)<30),this.preTapPosition.x=this.x1,this.preTapPosition.y=this.y1,this.last=this.now,r>1){this._cancelLongTap(),this._cancelSingleTap();var n={x:e.touches[1].pageX-this.x1,y:e.touches[1].pageY-this.y1};t.x=n.x,t.y=n.y,this.pinchStartLen=this.getLen(t),this._emitEvent("onMultipointStart",e)}this.longTapTimeout=setTimeout((()=>{this._emitEvent("onLongTap",e),this.afterLongTap=!0,this.afterLongTapTimeout=setTimeout((()=>{this.afterLongTap=!1}),1e3)}),750)}}_handleTouchMove(e){var t=this.preV,r=e.touches.length,n=e.touches[0].pageX,o=e.touches[0].pageY;if((Math.abs(this.preTapPosition.x-n)>10||Math.abs(this.preTapPosition.y-o)>10||r>1)&&(this.isDoubleTap=!1),r>1){const r=this._isParentNode(e.touches[0].target,e.currentTarget);if(!this._isParentNode(e.touches[1].target,e.currentTarget)||!r)return;var i={x:e.touches[1].pageX-n,y:e.touches[1].pageY-o};null!==t.x&&(this.pinchStartLen>0&&(e.center={x:(e.touches[1].pageX+n)/2,y:(e.touches[1].pageY+o)/2},e.scale=this.getLen(i)/this.pinchStartLen,this._emitEvent("onPinch",e)),e.angle=this.getRotateAngle(i,t),this._emitEvent("onRotate",e)),t.x=i.x,t.y=i.y,this.multiTouch=!0}else null!==this.x2?(e.deltaX=n-this.x2,e.deltaY=o-this.y2):(e.deltaX=0,e.deltaY=0),this._emitEvent("onPressMove",e);this._cancelLongTap(),this.x2=n,this.y2=o,r>1&&e.preventDefault()}_handleTouchCancel(){clearInterval(this.singleTapTimeout),clearInterval(this.tapTimeout),clearInterval(this.longTapTimeout),clearInterval(this.swipeTimeout)}_handleTouchEnd(e){this.end=Date.now(),this._cancelLongTap(),e.touches.length<2&&this.multiTouch&&this._emitEvent("onMultipointEnd",e),e.origin=[this.x1,this.y1],!1===this.multiTouch&&(this.x2&&Math.abs(this.x1-this.x2)>30||this.y2&&Math.abs(this.y1-this.y2)>30?(e.direction=this._swipeDirection(this.x1,this.x2,this.y1,this.y2),e.distance=Math.abs(this.x1-this.x2),this.swipeTimeout=setTimeout((()=>{this._emitEvent("onSwipe",e)}),0)):this.afterLongTap?(clearTimeout(this.afterLongTapTimeout),this.afterLongTap=!1):this.tapTimeout=setTimeout((()=>{this._emitEvent("onTap",e),this.isDoubleTap?(this._emitEvent("onDoubleTap",e),clearTimeout(this.singleTapTimeout),this.isDoubleTap=!1):this.singleTapTimeout=setTimeout((()=>{this._emitEvent("onSingleTap",e)}),250)}),0)),this.pinchStartLen>0&&(this._emitEvent("onPinchEnd",e),this.pinchStartLen=null),this.preV.x=0,this.preV.y=0,this.scale=1,this.x1=this.x2=this.y1=this.y2=null,this.multiTouch=!1}_cancelLongTap(){clearTimeout(this.longTapTimeout)}_cancelSingleTap(){clearTimeout(this.singleTapTimeout)}_swipeDirection(e,t,r,n){return Math.abs(e-t)>80||this.end-this.now<250?Math.abs(e-t)>=Math.abs(r-n)?e-t>0?"Left":"Right":r-n>0?"Up":"Down":"Nochange"}render(){return React.cloneElement(React.Children.only(this.props.children),{onTouchStart:this._handleTouchStart.bind(this),onTouchMove:this._handleTouchMove.bind(this),onTouchCancel:this._handleTouchCancel.bind(this),onTouchEnd:this._handleTouchEnd.bind(this)})}}class TableScaler extends reactExports.Component{constructor(e){super(e),this.setScale=e=>{this.scale=e},this.setScale(e.scale||1),this.onPinch=this.blockScaleGestureDec(this.onPinch.bind(this)),this.onPressMove=this.onPressMove.bind(this),this.onDoubleTap=this.blockScaleGestureDec(this.onDoubleTap.bind(this)),this.onMultipointEnd=this.blockScaleGestureDec(this.onMultipointEnd.bind(this))}componentDidMount(){this.table=findNodeHandle(this),this._observeSubTable();const{x:e,y:t}=this.props.getInitialCrossPoint();this.x=e,this.y=t,this.setLayoutScale(this.props.scale||1)}componentDidUpdate(){this._observeSubTable(),this.setLayoutScale(this.props.scale||1)}render(){return jsxRuntimeExports.jsx(WebFinger,Object.assign({onMultipointEnd:this.onMultipointEnd,onPinch:this.onPinch,onDoubleTap:this.onDoubleTap,onPressMove:this.onPressMove},{children:this.props.children}))}blockScaleGestureDec(e){return t=>{this.props.blockScaleGesture||e(t)}}getScale(){return this.scale}setLayoutScale(e){this.setScale(e),this._scaleTables(e),this.translateTables(e),this.calculateTablesMargin(),this._forceReflow()}onPinch(e){let t=e.scale*this.scale;this._scaleTables(t),this.translateTables(t)}translateTables(e){this.props.useStickyFrozen?this._translateStickyTables(e):this._translateTables(e)}onDoubleTap(){this.props.onDoubleTap&&this.props.onDoubleTap(),this.calculateTablesMargin()}onPressMove(e){this.props.onPressMove&&this.props.onPressMove(e)}onMultipointEnd(){var e,t;const r=this._getFirstSonTableElement(this.subTables[3]);this.setScale(null==r?void 0:r.scaleX),this._forceReflow(),null===(t=null===(e=this.props)||void 0===e?void 0:e.onScale)||void 0===t||t.call(e,this.scale),this.calculateTablesMargin()}_findSubTables(){this.left=this.table.getElementsByClassName("react-table-left")[0],this.main=this.table.getElementsByClassName("react-table-main")[0]||this.table,this.leftHead=this.left&&this.left.getElementsByClassName("react-table-head")[0],this.leftBody=this.left&&this.left.getElementsByClassName("react-table-body")[0],this.mainHead=this.main&&this.main.getElementsByClassName("react-table-head")[0],this.mainBody=this.main&&this.main.getElementsByClassName("react-table-body")[0],this.subTables=[this.leftHead,this.leftBody,this.mainHead,this.mainBody]}_translateStickyTables(e){if(0===this.x&&0===this.y)return;const{width:t,leftWidth:r,mainWidth:n,headHeight:o,bodyHeight:i}=this.props.getSectionIntegerSize(),a=this.table.getElementsByClassName("react-table")[0];if(a&&(a.style.cssText+="width:".concat(t*e,"px;")),this.leftHead&&(this.leftHead.style.cssText+="width:".concat(r*e,"px; height:").concat(o*e,"px;")),this.mainHead){let t="width:".concat(n*e,"px; height:").concat(o*e,"px;");this.left&&this.main&&(t+="margin-left:-".concat(e,"px")),this.mainHead.style.cssText+=t}if(this.leftBody){let t="width:".concat(r*e,"px; height:").concat(i*e,"px;");this.leftHead&&(t+="margin-top:-".concat(e,"px;")),this.leftBody.style.cssText+=t}if(this.mainBody){let t="width:".concat(n*e,"px; height:").concat(i*e,"px;");this.mainHead&&(t+="margin-top:-".concat(e,"px;")),this.left&&this.main&&(t+="margin-left:-".concat(e,"px")),this.mainBody.style.cssText+=t}}_translateTables(e){if(0===this.x&&0===this.y)return;const{width:t,height:r}=this.props.containerSize,n=this.x*e,o=this.y*e;if(this.leftHead&&(this.leftHead.style.cssText+="width:".concat(n,"px; height:").concat(o,"px;")),this.mainHead){let r="width:".concat(t-n,"px; height:").concat(o,"px;");this.left&&this.main&&(r+="margin-left:-".concat(e,"px")),this.mainHead.style.cssText+=r}if(this.leftBody){let t="width:".concat(n,"px; height:").concat(r-o,"px;");this.leftHead&&(t+="margin-top:-".concat(e,"px;")),this.leftBody.style.cssText+=t}if(this.mainBody){let i="width:".concat(t-n,"px; height:").concat(r-o,"px;");this.mainHead&&(i+="margin-top:-".concat(e,"px;")),this.left&&this.main&&(i+="margin-left:-".concat(e,"px")),this.mainBody.style.cssText+=i}}_scaleTables(e){var t,r;this.subTables.forEach((t=>{if(t){let r=this._getFirstSonTableElement(t);r.scaleX=e,r.scaleY=e}})),null===(r=(t=this.props).onScaleChange)||void 0===r||r.call(t,e)}calculateTablesMargin(){if(this.mainBody){const{offsetHeight:e,offsetWidth:t}=this._getFirstSonTableElement(this.mainBody);this.marginRight=Math.min(t*(this.scale-1),0);const r=Math.min(e*(this.scale-1),0);this._setBodyMarginBottom(r),this._setMainTableMarginRight(this.marginRight)}}_setBodyMarginBottom(e){[this.mainBody,this.leftBody].forEach((t=>{if(t){let r=this._getFirstSonTableElement(t);e<=0&&(r.style.marginBottom="".concat(e,"px"))}}))}_setMainTableMarginRight(e){[this.mainBody,this.mainHead].forEach((t=>{if(t){let r=this._getFirstSonTableElement(t);e<=0&&(r.style.marginRight="".concat(e,"px"))}}))}resetTableCrossPosition(e=0,t=0){this.x=e,this.y=t}_forceReflow(){var e;this._setMainTableMarginRight(this.marginRight-Math.random(1)),null===(e=this.left)||void 0===e||e.getBoundingClientRect()}_observeSubTable(){this._findSubTables(),this.subTables.forEach((e=>{e&&Transform(this._getFirstSonTableElement(e))}))}_getFirstSonTableElement(e){if(e)return e.getElementsByClassName("table")[0]}}TableScaler.propTypes={blockScaleGesture:PropTypes.bool,onScale:PropTypes.func,onScaleChange:PropTypes.func},TableScaler.defaultProps={blockScaleGesture:!1};class ReportView extends reactExports.Component{constructor(e){var t;super(e),this.onPressMove=this.onPressMove.bind(this),this.onTableLayout=this.onTableLayout.bind(this),this.onSizeChange=this.onSizeChange.bind(this),this.getScale=this.getScale.bind(this),this.getInitialCrossPoint=this.getInitialCrossPoint.bind(this),this.getSectionIntegerSize=this.getSectionIntegerSize.bind(this),this.onScrollPositionChange=this.onScrollPositionChange.bind(this),this.state={cells:(null===(t=e.data)||void 0===t?void 0:t.cells)||[],scale:e.scale||1},this.tableManager=new TableManager(this.getTableData())}render(){if(isEmpty$3(this.state.cells))return null;const e=this.props,{style:t={},onDoubleTap:r,onScale:n,onScrollPositionChange:o,scaleable:i}=e,a=__rest$p(e,["style","onDoubleTap","onScale","onScrollPositionChange","scaleable"]),s={width:t.width,height:t.height},l=this.tableManager.useStickyFrozen();return jsxRuntimeExports.jsx(TableScaler,Object.assign({scale:this.state.scale,blockScaleGesture:!i,onDoubleTap:r,onScale:n,onScaleChange:e=>{var t;null===(t=this.reportRef)||void 0===t||t.onScaleChange(e)},onPressMove:this.onPressMove,getInitialCrossPoint:this.getInitialCrossPoint,getSectionIntegerSize:this.getSectionIntegerSize,containerSize:s,useStickyFrozen:l,ref:e=>this.scaler=e},{children:jsxRuntimeExports.jsx(Table$2,Object.assign({},a,{data:this.getTableData(),size:s,getScale:this.getScale,onTableLayout:this.onTableLayout,onSizeChange:this.onSizeChange,onScrollPositionChange:this.onScrollPositionChange,tableManager:this.tableManager,useStickyFrozen:l,ref:e=>{this.reportRef=e}}))}))}getTableData(){const{style:e={},sizeInfo:t}=this.props;return Object.assign(Object.assign({},t),{containerSize:{width:e.width,height:e.height},cells:this.state.cells})}initData(e){this.tableManager.setCells(e),this.setState({cells:e})}updateCell(e){this.reportRef&&this.reportRef.updateCell(e)}scrollTo(e={}){var t;null===(t=this.reportRef)||void 0===t||t.scrollTo(e)}scrollBy(e={}){var t;null===(t=this.reportRef)||void 0===t||t.scrollBy(e)}getScrollOffset(){var e;return null===(e=this.reportRef)||void 0===e?void 0:e.getScrollOffset()}startMarquee(e){var t;null===(t=this.reportRef)||void 0===t||t.startMarquee(e)}stopMarquee(){var e;null===(e=this.reportRef)||void 0===e||e.stopMarquee()}setGridZoomScale(e){this.setTableLayoutScale(e)}postCellMessage(e={}){var t;null===(t=this.reportRef)||void 0===t||t.onReceiveCellMessage(e)}onPressMove(e){this.props.scaleable||this.props.scrollable||this.reportRef&&this.reportRef.lastScrollTop>0&&e.stopPropagation()}onTableLayout(e){var t,r,n;null===(r=(t=this.props).onLayout)||void 0===r||r.call(t),null===(n=this.scaler)||void 0===n||n.calculateTablesMargin()}onSizeChange(e,t){var r;null===(r=this.scaler)||void 0===r||r.resetTableCrossPosition(e,t)}onScrollPositionChange(e){var t,r;null===(r=(t=this.props).onScrollPositionChange)||void 0===r||r.call(t,e)}getScale(){return this.scaler&&this.scaler.getScale()||1}getInitialCrossPoint(){const e=this.tableManager;return{x:e.leftContainerWidth(),y:e.headContainerHeight()}}getSectionIntegerSize(){return this.tableManager.sectionIntegerSize()}setTableLayoutScale(e){this.setState({scale:e})}}class ReportScale{constructor(e){this.pageView=e,this.pinchScale=1}get tableNode(){return this.pageView.tableRef}get layoutScale(){return this.pageView.getLayoutScale()}get scale(){return this.pinchScale*this.layoutScale}setNativeScale(e=!1){this.tableNode&&this.tableNode.setGridZoomScale(this.scale,e)}toggleNativeScale(){const e=this._getToggleScale();this.updatePinchScale(e/this.layoutScale),this.setNativeScale(!0)}resetNativeScale(){this.updatePinchScale(1),this.setNativeScale()}updatePinchScale(e){this.pinchScale=e}_getToggleScale(){const e=this.layoutScale,t=e<=1?1.5:e,r=e<=1?e:1;return this.scale>=(t+r)/2?r:t}}class SinglePageDecider{constructor(e){this.dataLinkObservers={},this.chartCellModels=[],this.dataTransType=e.dataTransType,this.linkConfig=e.linkConfig}static create(e){return new SinglePageDecider(e)}setSinglePageModel(e){this.singlePageModel=e}queryClickCollapseCellMessage(e){var t;null===(t=this.singlePageModel)||void 0===t||t.onClickCollapseCell(e)}queryClickFileCellMessage(e,t){var r;null===(r=this.singlePageModel)||void 0===r||r.onClickFileCell(e,t)}queryRefreshCellMessage(e){var t;null===(t=this.singlePageModel)||void 0===t||t.onReceiveUpdateMessage(e)}queryCellFiredMessage(e){var t;null===(t=this.singlePageModel)||void 0===t||t.onReceiveChangedCellModel(e)}postCellMessage(e){var t;null===(t=this.singlePageModel)||void 0===t||t.postCellMessage(e)}getCellValueByLocation(e){var t;const r=null===(t=this.singlePageModel)||void 0===t?void 0:t.getCellModelByLocation(e);return null==r?void 0:r.getValue()}registerCellChartRelatedMessage(e){this.chartCellModels.push(e)}fireChartRelatedMessage(e){this.chartCellModels.forEach((t=>{null==t||t.fireChartRelatedMessage(e)}))}registerCellDataLink(e,t){const r=this.dataLinkObservers[t];r?r.push(e):this.dataLinkObservers[t]=[e]}getCellModelAtPosition(e,t){var r;return null===(r=this.singlePageModel)||void 0===r?void 0:r.getCellModelAtPosition(e,t)}fireDataLinkedCellsChange(e){const t=this.dataLinkObservers[e];t&&t.forEach((e=>{var t;const r=null===(t=this.singlePageModel)||void 0===t?void 0:t.getCellModelByLocation(e);null==r||r.resetDependenceData()}))}fireValueLinkedCellsChange(e){const{col:t,row:r,sheetIndex:n}=e;this.getCellModelAtPosition(r,t).generateCellsSubmitData()}updateCell(e){this.singlePageModel.onReceiveUpdateMessage(e)}}const IMAGE_BACKGROUND_LAYOUT=["repeat","default","stretch","default","adapt"];function gradientBackgroundTransform(e,t,r){const n={};switch(n.beginColor=e,n.endColor=t,r){case 0:n.direction="horizontal";break;case 1:n.direction="vertical"}return n}function imageBackgroundTransform(e,t){return{data:e,layout:imageBackgroundLayoutTransform(t)}}function imageBackgroundLayoutTransform(e){return IMAGE_BACKGROUND_LAYOUT[e]||"default"}function reportBackgroundTransform(e={}){const{backgroundType:t,color:r,image:n,layout:o,beginColor:i,endColor:a,direction:s,src:l}=e;if(isEmpty$3(e))return{};const c=urlTransform({src:l});switch(t){case"ColorBackground":return{type:"color",value:r};case"ImageBackground":return{type:"image",value:Object.assign(Object.assign({},imageBackgroundTransform(n,o)),c)};case"TextureBackground":case"PatternBackground":return{type:"image",value:Object.assign(Object.assign({},imageBackgroundTransform(n,0)),c)};case"GradientBackground":return{type:"gradient",value:gradientBackgroundTransform(i,a,s)};default:return{type:"image",value:Object.assign(Object.assign({},imageBackgroundTransform(n,2)),c)}}}function reportCellBackgroundTransform(e){return reportBackgroundTransform(e)}function urlTransform(e={}){const t=getImageSrc(e),r={};if(!isEmpty$3(t)){const{resourceUrl:e}=getDefaultConfig();r.src=e+t}return r}function getImageSrc(e){const{attachid:t,cache:r,src:n}=e;if(isEmpty$3(t)){const{resourceUrl:e}=getDefaultConfig();try{const t=new URL(e);return null==n?void 0:n.split(t.pathname)[1]}catch(e3){}return n}return"/view/form?id=".concat(t,"&cache=").concat(r,"&op=fr_attach&cmd=ah_image")}const ALIGN={CENTER:0,LEFT:2,RIGHT:4,JUSTIFY:6,TOP:1,BOTTOM:3};function reportCellDataTransform(e,t){const{col:r,colSpan:n,row:o,rowSpan:i,formula:a,hyperlink:s=[],present:l=!1,format:c,del:u=!1,collapse:d,previewContent:h=!0,sortHeader:p={}}=e,f={};return f.position=Object.assign({col:r,colSpan:n,row:o,rowSpan:i},t),f.del=u,n>0&&i>0&&(f.content=reportCellContentTransform(e),f.style=reportCellStyleTransform(e),f.hyperlink=s,f.formula=a,f.present=l,f.format=c,f.collapse=d,f.previewContent=h,f.sortHeader=p),f}function reportCellContentTransform(e){var t,r,n,o;const{text:i="",value:a,collapse:s,widget:l,showAsHtml:c,realValue:u="",format:d}=e;let h="text",p={};if(null==s?void 0:s.icons){const e=(null==s?void 0:s.expand)?null===(t=null==s?void 0:s.icons)||void 0===t?void 0:t.unfold:null===(r=null==s?void 0:s.icons)||void 0===r?void 0:r.fold;h="image";const n=urlTransform({src:e.src});p={text:"",value:Object.assign(Object.assign({},imageBackgroundTransform(void 0,e.imageLayout)),n)}}else if(l)if(h="widget",a&&"image"===a.type){const e=urlTransform(a);p={widget:Object.assign(Object.assign({format:d},l),{value:Object.assign(Object.assign({},imageBackgroundTransform(a.value,a.imageLayout)),e)}),cell:{text:i,value:imageBackgroundTransform(a.value,a.imageLayout)}}}else{const e=getWidgetCellTextAndValue(i,u,l);p={widget:Object.assign(Object.assign({format:d},l),{value:e.value}),cell:{text:e.text,value:e.value}}}else if("text"===h&&"BarJsonBackground"===(null===(o=null===(n=e.style)||void 0===n?void 0:n.background)||void 0===o?void 0:o.backgroundType))h="progressbar",p={text:(null==a?void 0:a.value)||i,value:e.style.background};else if(a||l){if(a)if("image"===a.type){h="image";const e=urlTransform(a);p={text:i,value:Object.assign(Object.assign({},imageBackgroundTransform(a.value,a.imageLayout)),e)}}else if("webimage"===a.type){h="image";const{value:e="",layout:t=a.imageLayout,width:r,height:n}=a;p={value:{src:e,layout:imageBackgroundLayoutTransform(t),width:r,height:n}}}else"simplechart"===a.type?(h="chart",p=a.items[0],p||(p={}),p.name&&p.url&&!p.simpleChartInShowID&&(h="image",p={value:imageBackgroundTransform(p.url,2)})):"bias"===a.type?(h="bias",p={text:"",value:a}):a.attach_id?(h="text",p={text:i||a.text,value:fileValueTransform(a)}):"text"===a.type?(h=c?"html":"text",p={text:a.value,value:u}):(h="text",p={text:"",value:""})}else h=c?"html":"text",p={text:i,value:u};return{type:h,value:p}}function fileValueTransform(e){if(e.attach_id){const t=resourceUrl+"/view/report?op=fr_attach&cmd=ah_download&id="+e.attach_id+"&gzip=false",r=e.attach_size;return{fileName:e.filename,fileUrl:t,fileSize:r}}return{}}function getWidgetCellTextAndValue(e,t,r){let n=e,o=t;return"checkbox"===r.type&&(n="",o=Boolean("true"===t||!0===t)),{text:n,value:o}}function reportCellStyleTransform(e){const{style:t,isLastCol:r,isLastRow:n,isnumber:o,widget:i}=e,a=o&&!i;let{background:s,border:l,font:c,ha:u,va:d,pl:h,pr:p}=t;const f=reportCellBackgroundTransform(s),g=reportCellBorderTransform$1(l,r,n),m=reportCellPaddingTransform(h,p,g),y=reportCellFontTransform(c);a&&isUndefined$3(u)&&(u=ALIGN.RIGHT);const v=t.horizontalAlign||reportCellTextAlignTransform(u),_=t.verticalAlign||reportCellVerticalAlignTransform(d),b=t.ts||0,C=t.ro||0,E=1===(null==t?void 0:t.vt);return{background:f,border:g,padding:m,font:y,horizontalAlign:v,verticalAlign:_,textStyle:b,textDirection:t.td||0,isVerticalText:E,rotation:C,lineSpace:isUndefined$3(t.ls)?0:Math.floor(4*t.ls/3)}}function reportCellBorderTransform$1(e,t,r){let n=!!(null==e?void 0:e.keepBottom),o=!!(null==e?void 0:e.keepRight);return Object.assign(Object.assign({},e),{hideRight:!t&&!o,hideBottom:!r&&!n})}function reportCellFontTransform(e){var t;const r=(null==e?void 0:e.fontFamily)||(null==e?void 0:e.fontName),n=(null==e?void 0:e.size)||12,o=!!(null==e?void 0:e.bold),i=(null==e?void 0:e.color)||"rgb(0,0,0)",a=!!(null==e?void 0:e.italic),s=!!(null===(t=null==e?void 0:e.underLine)||void 0===t?void 0:t.width)||!!(null==e?void 0:e.ul),l=!!(null==e?void 0:e.strikeThrough)||!!(null==e?void 0:e.st),c=(null==e?void 0:e.textShadow)||!!(null==e?void 0:e.sd),u=(null==e?void 0:e.supscript)||(null==e?void 0:e.su),d=(null==e?void 0:e.subscript)||(null==e?void 0:e.sb);let h=0;return u?h=1:d&&(h=2),{family:r,size:n,bold:o,color:i,italic:a,underLine:s,strikethrough:l,shadow:c,extraTextStyle:h}}function reportCellTextAlignTransform(e){switch(e){case ALIGN.CENTER:return"center";case ALIGN.LEFT:return"left";case ALIGN.RIGHT:return"right";case ALIGN.JUSTIFY:return"justify";default:return"inherit"}}function reportCellVerticalAlignTransform(e){switch(e){case ALIGN.TOP:return"top";case ALIGN.BOTTOM:return"bottom";default:return"middle"}}function reportCellPaddingTransform(e,t,r){return{left:(isUndefined$3(e)?0:e)+0,right:(isUndefined$3(t)?0:t)+0,top:0,bottom:0}}function getWidestSizeOfBorder(e){let t=0;return e.forEach((e=>{e.width>t&&(t=e.width)})),t}class ColorBackgroundModel{constructor(e){this.value=e}toNativeJson(){return this.value}}class GradientBackgroundModel{constructor(e){const{beginColor:t,direction:r,endColor:n}=e;this.beginColor=t,this.direction=r,this.endColor=n}toNativeJson(){const e={};return e.beginColor=this.beginColor,e.direction=this.direction,e.endColor=this.endColor,e}}class ImageBackgroundModel{constructor(e){const{data:t,layout:r,src:n}=e;this.data=t,this.layout=r,this.src=n}toNativeJson(){const e={};return e.data=this.data,e.layout=this.layout,e.src=this.src,e}}class BackgroundModel{constructor(e){const{type:t,value:r}=e;switch(this.type=t,t){case"color":this.value=new ColorBackgroundModel(r);break;case"image":this.value=new ImageBackgroundModel(r);break;case"gradient":this.value=new GradientBackgroundModel(r)}}toNativeJson(){const e={};return this.type&&this.value&&(e.type=this.type,e.value=this.value.toNativeJson()),e}}class FontModel{constructor(e){const{family:t,size:r,bold:n,color:o,italic:i,underLine:a,strikethrough:s,shadow:l,extraTextStyle:c}=e;this.family=t,this.size=r,this.bold=n,this.color=o,this.italic=i,this.underLine=a,this.strikethrough=s,this.shadow=l,this.extraTextStyle=c}toNativeJson(){const e={};return this.family&&(e.family=this.family),this.size&&(e.size=this.size),this.bold&&(e.bold=this.bold),this.color&&(e.color=this.color),this.italic&&(e.italic=this.italic),this.underLine&&(e.underLine=this.underLine),this.strikethrough&&(e.strikethrough=this.strikethrough),this.shadow&&(e.shadow=this.shadow),this.extraTextStyle&&(e.extraTextStyle=this.extraTextStyle),e}}class BorderModel{constructor(e){const{left:t,right:r,top:n,bottom:o,borderRadius:i}=e;this.left=t,this.right=r,this.top=n,this.bottom=o,this.hideRight=!!e.hideRight,this.hideBottom=!!e.hideBottom,this.borderRadius=i}toNativeJson(){const e={borderRadius:this.borderRadius};return(this.left.length>1||0!==this.left[0].width)&&(e.left=this.left),(this.right.length>1||0!==this.right[0].width)&&(this.hideRight||(e.right=this.right)),(this.top.length>1||0!==this.top[0].width)&&(e.top=this.top),(this.bottom.length>1||0!==this.bottom[0].width)&&(this.hideBottom||(e.bottom=this.bottom)),e}}class StyleModel{constructor(e){this._parse(e)}_parse(e){const{background:t,font:r,horizontalAlign:n,verticalAlign:o,textDirection:i,textStyle:a,padding:s,border:l,isVerticalText:c,rotation:u,lineSpace:d}=e;t&&(this.background=new BackgroundModel(t)),r&&(this.font=new FontModel(r)),n&&(this.horizontalAlign=n),o&&(this.verticalAlign=o),s&&(this.padding=s),l&&(this.border=new BorderModel(l)),this.textDirection=i,this.textStyle=a,this.rotation=u,this.isVerticalText=c,this.lineSpace=d}toNativeJson(){const e={};return this.background&&(e.background=this.background.toNativeJson()),this.font&&(e.font=this.font.toNativeJson()),this.verticalAlign&&(e.verticalAlign=this.verticalAlign),this.horizontalAlign&&(e.horizontalAlign=this.horizontalAlign),this.padding&&(e.padding=this.padding),this.border&&keys$7(this.border.toNativeJson()).length>0&&(e.border=this.border.toNativeJson()),this.rotation&&(e.rotation=this.rotation),this.textDirection&&(e.textDirection=this.textDirection),this.textStyle&&(e.textStyle=this.textStyle),this.isVerticalText&&(e.isVerticalText=this.isVerticalText),this.lineSpace&&(e.lineSpace=this.lineSpace),e}updateStyle(e){this._parse(e)}}const EncodeUtils={cjkDecode:function(text){if(null===text)return"";if(!isNaN(text)||-1===text.indexOf("["))return text;for(var newText="",i=0;i<text.length;i++){var ch=text.charAt(i);if("["===ch){var rightIdx=text.indexOf("]",i+1);if(rightIdx>i+1){var subText=text.substring(i+1,rightIdx);if(subText.length>0)try{ch=String.fromCharCode(eval("0x"+subText))}catch(e3){ch=text.substring(i,rightIdx+1)}i=rightIdx}}newText+=ch}return newText},jsonEncode:function(e){var t=this,r=!!{}.hasOwnProperty,n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};if(null==e)return"null";if(Array.isArray(e))return function(e){var r,n,o,i=["["],a=e.length;for(n=0;n<a;n+=1)switch(typeof(o=e[n])){case"undefined":case"function":case"unknown":break;default:r&&i.push(","),i.push(null===o?"null":t.jsonEncode(o)),r=!0}return i.push("]"),i.join("")}(e);if(e instanceof Date)return t.jsonEncode({__time__:e.getTime()});if("string"==typeof e)return/["\\\x00-\x1f]/.test(s=e)?'"'+s.replace(/([\x00-\x1f\\"])/g,(function(e,t){var r=n[t];return r||(r=t.charCodeAt(),"\\u00"+Math.floor(r/16).toString(16)+(r%16).toString(16))}))+'"':'"'+s+'"';if("number"==typeof e)return isFinite(e)?String(e):"null";if("boolean"==typeof e)return String(e);if("function"==typeof e)return String(e);var o,i,a,s,l=["{"];for(i in e)if(!r||e.hasOwnProperty(i))switch(typeof(a=e[i])){case"undefined":case"unknown":break;default:o&&l.push(","),l.push(t.jsonEncode(i),":",null===a?"null":t.jsonEncode(a)),o=!0}return l.push("}"),l.join("")},encodePrecentPlus:function(e){if(isEmpty$3(e))return e;if("string"==typeof e)e=(e=e.replace(/%/gi,"%25")).replace(/\+/gi,"%2B");else{if(Array.isArray(e)){let r=[];for(var t=0;t<e.length;t++)r[t]=this.encodePrecentPlus(e[t]);return r}if("object"==typeof e){var r={};for(let t in e){let n=e[t];n=this.encodePrecentPlus(n),r[t]=n}return r}}return e}};function generateSubmitJson4Cells(e,t){return JSON.stringify([_getSheetSubmitObj(e,t)])}function _getSheetSubmitObj(e,t,r){let n={sheetIndex:t,sheetData:[]};for(let o of e){const e=o.getSubmitValue(),{xType:t,xContent:r}=generateTypeAndContent(e);n.sheetData.push({c:o.position.col,r:o.position.row,v:{t:t,ov:r}})}return n}function generateSubmitXML4Cells(e,t){let r='<?xml version="1.0" encoding="UTF-8" ?>';return r+="<WorkBook>",r+="<Version>6.5</Version>",r+=_writeCells(e,t),r+="</WorkBook>",r}function _writeCells(e,t,r){let n='<Report class="com.fr.report.WorkSheet" name="'.concat(t,'">');n+="<CellElementList>";for(let o of e)n+='<C c="'.concat(o.position.col,'" r="').concat(o.position.row,'">').concat(_writeCellValue(o),"</C>");return n+="</CellElementList>",n+="</Report>",n}function _writeCellValue(e){const t=e.getSubmitValue(),{xType:r,xContent:n}=generateTypeAndContent(t);return'<O t="'.concat(r,'"><![CDATA[').concat(n,"]]></O>")}function generateTypeAndContent(e){if(null===e)return"";let t="S",r=null;if("number"==typeof e)r=e,t=/\./.test(""+e)?"D":(""+e).length>=10?"BigDecimal":"I";else if("object"==typeof e)if(null!=e.getTime)t="Date",r=e.getTime();else if(null!=e.attach_id)t="Attachment",r=e.attach_id;else if(Array.isArray(e)&&e.length>0&&e[0].attach_id){t="Attachments",r="";for(let t=0;t<e.length;t++)0!==t&&(r+=","),r+=e[t].attach_id}else Array.isArray(e)?(t=0===e.length?"A":"AA",forEach$3(e,(e=>{if(!Array.isArray(e))return t="A",!1})),r=EncodeUtils.jsonEncode(e)):isEmptyObject(e)&&(r="");else"boolean"==typeof e?t="B":"string"==typeof e&&(!0===e.encryption?(t="Encrypt",r=e):e=(e=EncodeUtils.jsonEncode(e)).substring(1,e.length-1));return null===r&&(r=""+e),{xType:t,xContent:r}}function isEmptyObject(e){var t;for(t in e)return!1;return!0}var hookCallback,some;function hooks(){return hookCallback.apply(null,arguments)}function setHookCallback(e){hookCallback=e}function isArray$3(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function isObject$5(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function hasOwnProp(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function isObjectEmpty(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(hasOwnProp(e,t))return!1;return!0}function isUndefined$1(e){return void 0===e}function isNumber$2(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function isDate$1(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function map$1(e,t){var r,n=[],o=e.length;for(r=0;r<o;++r)n.push(t(e[r],r));return n}function extend$1(e,t){for(var r in t)hasOwnProp(t,r)&&(e[r]=t[r]);return hasOwnProp(t,"toString")&&(e.toString=t.toString),hasOwnProp(t,"valueOf")&&(e.valueOf=t.valueOf),e}function createUTC(e,t,r,n){return createLocalOrUTC(e,t,r,n,!0).utc()}function defaultParsingFlags(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function getParsingFlags(e){return null==e._pf&&(e._pf=defaultParsingFlags()),e._pf}function isValid(e){if(null==e._isValid){var t=getParsingFlags(e),r=some.call(t.parsedDateParts,(function(e){return null!=e})),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return n;e._isValid=n}return e._isValid}function createInvalid(e){var t=createUTC(NaN);return null!=e?extend$1(getParsingFlags(t),e):getParsingFlags(t).userInvalidated=!0,t}some=Array.prototype.some?Array.prototype.some:function(e){var t,r=Object(this),n=r.length>>>0;for(t=0;t<n;t++)if(t in r&&e.call(this,r[t],t,r))return!0;return!1};var momentProperties=hooks.momentProperties=[],updateInProgress=!1;function copyConfig(e,t){var r,n,o,i=momentProperties.length;if(isUndefined$1(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),isUndefined$1(t._i)||(e._i=t._i),isUndefined$1(t._f)||(e._f=t._f),isUndefined$1(t._l)||(e._l=t._l),isUndefined$1(t._strict)||(e._strict=t._strict),isUndefined$1(t._tzm)||(e._tzm=t._tzm),isUndefined$1(t._isUTC)||(e._isUTC=t._isUTC),isUndefined$1(t._offset)||(e._offset=t._offset),isUndefined$1(t._pf)||(e._pf=getParsingFlags(t)),isUndefined$1(t._locale)||(e._locale=t._locale),i>0)for(r=0;r<i;r++)isUndefined$1(o=t[n=momentProperties[r]])||(e[n]=o);return e}function Moment(e){copyConfig(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===updateInProgress&&(updateInProgress=!0,hooks.updateOffset(this),updateInProgress=!1)}function isMoment(e){return e instanceof Moment||null!=e&&null!=e._isAMomentObject}function warn(e){!1===hooks.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn}function deprecate(e,t){var r=!0;return extend$1((function(){if(null!=hooks.deprecationHandler&&hooks.deprecationHandler(null,e),r){var n,o,i,a=[],s=arguments.length;for(o=0;o<s;o++){if(n="","object"==typeof arguments[o]){for(i in n+="\n["+o+"] ",arguments[0])hasOwnProp(arguments[0],i)&&(n+=i+": "+arguments[0][i]+", ");n=n.slice(0,-2)}else n=arguments[o];a.push(n)}warn(e+"\nArguments: "+Array.prototype.slice.call(a).join("")+"\n"+(new Error).stack),r=!1}return t.apply(this,arguments)}),t)}var deprecations={},keys$1;function deprecateSimple(e,t){null!=hooks.deprecationHandler&&hooks.deprecationHandler(e,t),deprecations[e]||(warn(t),deprecations[e]=!0)}function isFunction$2(e){return"undefined"!=typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function set(e){var t,r;for(r in e)hasOwnProp(e,r)&&(isFunction$2(t=e[r])?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function mergeConfigs(e,t){var r,n=extend$1({},e);for(r in t)hasOwnProp(t,r)&&(isObject$5(e[r])&&isObject$5(t[r])?(n[r]={},extend$1(n[r],e[r]),extend$1(n[r],t[r])):null!=t[r]?n[r]=t[r]:delete n[r]);for(r in e)hasOwnProp(e,r)&&!hasOwnProp(t,r)&&isObject$5(e[r])&&(n[r]=extend$1({},n[r]));return n}function Locale(e){null!=e&&this.set(e)}hooks.suppressDeprecationWarnings=!1,hooks.deprecationHandler=null,keys$1=Object.keys?Object.keys:function(e){var t,r=[];for(t in e)hasOwnProp(e,t)&&r.push(t);return r};var defaultCalendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function calendar(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return isFunction$2(n)?n.call(t,r):n}function zeroFill(e,t,r){var n=""+Math.abs(e),o=t-n.length;return(e>=0?r?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={},formatTokenFunctions={};function addFormatToken(e,t,r,n){var o=n;"string"==typeof n&&(o=function(){return this[n]()}),e&&(formatTokenFunctions[e]=o),t&&(formatTokenFunctions[t[0]]=function(){return zeroFill(o.apply(this,arguments),t[1],t[2])}),r&&(formatTokenFunctions[r]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function removeFormattingTokens(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function makeFormatFunction(e){var t,r,n=e.match(formattingTokens);for(t=0,r=n.length;t<r;t++)formatTokenFunctions[n[t]]?n[t]=formatTokenFunctions[n[t]]:n[t]=removeFormattingTokens(n[t]);return function(t){var o,i="";for(o=0;o<r;o++)i+=isFunction$2(n[o])?n[o].call(t,e):n[o];return i}}function formatMoment(e,t){return e.isValid()?(t=expandFormat(t,e.localeData()),formatFunctions[t]=formatFunctions[t]||makeFormatFunction(t),formatFunctions[t](e)):e.localeData().invalidDate()}function expandFormat(e,t){var r=5;function n(e){return t.longDateFormat(e)||e}for(localFormattingTokens.lastIndex=0;r>=0&&localFormattingTokens.test(e);)e=e.replace(localFormattingTokens,n),localFormattingTokens.lastIndex=0,r-=1;return e}var defaultLongDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function longDateFormat(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(formattingTokens).map((function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e})).join(""),this._longDateFormat[e])}var defaultInvalidDate="Invalid date";function invalidDate(){return this._invalidDate}var defaultOrdinal="%d",defaultDayOfMonthOrdinalParse=/\d{1,2}/;function ordinal(e){return this._ordinal.replace("%d",e)}var defaultRelativeTime={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function relativeTime(e,t,r,n){var o=this._relativeTime[r];return isFunction$2(o)?o(e,t,r,n):o.replace(/%d/i,e)}function pastFuture(e,t){var r=this._relativeTime[e>0?"future":"past"];return isFunction$2(r)?r(t):r.replace(/%s/i,t)}var aliases={};function addUnitAlias(e,t){var r=e.toLowerCase();aliases[r]=aliases[r+"s"]=aliases[t]=e}function normalizeUnits(e){return"string"==typeof e?aliases[e]||aliases[e.toLowerCase()]:void 0}function normalizeObjectUnits(e){var t,r,n={};for(r in e)hasOwnProp(e,r)&&(t=normalizeUnits(r))&&(n[t]=e[r]);return n}var priorities={};function addUnitPriority(e,t){priorities[e]=t}function getPrioritizedUnits(e){var t,r=[];for(t in e)hasOwnProp(e,t)&&r.push({unit:t,priority:priorities[t]});return r.sort((function(e,t){return e.priority-t.priority})),r}function isLeapYear(e){return e%4==0&&e%100!=0||e%400==0}function absFloor(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function toInt(e){var t=+e,r=0;return 0!==t&&isFinite(t)&&(r=absFloor(t)),r}function makeGetSet(e,t){return function(r){return null!=r?(set$1(this,e,r),hooks.updateOffset(this,t),this):get$1(this,e)}}function get$1(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function set$1(e,t,r){e.isValid()&&!isNaN(r)&&("FullYear"===t&&isLeapYear(e.year())&&1===e.month()&&29===e.date()?(r=toInt(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),daysInMonth(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function stringGet(e){return isFunction$2(this[e=normalizeUnits(e)])?this[e]():this}function stringSet(e,t){if("object"==typeof e){var r,n=getPrioritizedUnits(e=normalizeObjectUnits(e)),o=n.length;for(r=0;r<o;r++)this[n[r].unit](e[n[r].unit])}else if(isFunction$2(this[e=normalizeUnits(e)]))return this[e](t);return this}var match1=/\d/,match2=/\d\d/,match3=/\d{3}/,match4=/\d{4}/,match6=/[+-]?\d{6}/,match1to2=/\d\d?/,match3to4=/\d\d\d\d?/,match5to6=/\d\d\d\d\d\d?/,match1to3=/\d{1,3}/,match1to4=/\d{1,4}/,match1to6=/[+-]?\d{1,6}/,matchUnsigned=/\d+/,matchSigned=/[+-]?\d+/,matchOffset=/Z|[+-]\d\d:?\d\d/gi,matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi,matchTimestamp=/[+-]?\d+(\.\d{1,3})?/,matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,regexes;function addRegexToken(e,t,r){regexes[e]=isFunction$2(t)?t:function(e,n){return e&&r?r:t}}function getParseRegexForToken(e,t){return hasOwnProp(regexes,e)?regexes[e](t._strict,t._locale):new RegExp(unescapeFormat(e))}function unescapeFormat(e){return regexEscape(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,r,n,o){return t||r||n||o})))}function regexEscape(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}regexes={};var tokens={};function addParseToken(e,t){var r,n,o=t;for("string"==typeof e&&(e=[e]),isNumber$2(t)&&(o=function(e,r){r[t]=toInt(e)}),n=e.length,r=0;r<n;r++)tokens[e[r]]=o}function addWeekParseToken(e,t){addParseToken(e,(function(e,r,n,o){n._w=n._w||{},t(e,n._w,n,o)}))}function addTimeToArrayFromToken(e,t,r){null!=t&&hasOwnProp(tokens,e)&&tokens[e](t,r._a,r,e)}var YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,WEEK=7,WEEKDAY=8,indexOf;function mod(e,t){return(e%t+t)%t}function daysInMonth(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=mod(t,12);return e+=(t-r)/12,1===r?isLeapYear(e)?29:28:31-r%7%2}indexOf=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},addFormatToken("M",["MM",2],"Mo",(function(){return this.month()+1})),addFormatToken("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),addFormatToken("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),addUnitAlias("month","M"),addUnitPriority("month",8),addRegexToken("M",match1to2),addRegexToken("MM",match1to2,match2),addRegexToken("MMM",(function(e,t){return t.monthsShortRegex(e)})),addRegexToken("MMMM",(function(e,t){return t.monthsRegex(e)})),addParseToken(["M","MM"],(function(e,t){t[MONTH]=toInt(e)-1})),addParseToken(["MMM","MMMM"],(function(e,t,r,n){var o=r._locale.monthsParse(e,n,r._strict);null!=o?t[MONTH]=o:getParsingFlags(r).invalidMonth=e}));var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,defaultMonthsShortRegex=matchWord,defaultMonthsRegex=matchWord;function localeMonths(e,t){return e?isArray$3(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(t)?"format":"standalone"][e.month()]:isArray$3(this._months)?this._months:this._months.standalone}function localeMonthsShort(e,t){return e?isArray$3(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(t)?"format":"standalone"][e.month()]:isArray$3(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function handleStrictParse(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=createUTC([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?"MMM"===t?-1!==(o=indexOf.call(this._shortMonthsParse,a))?o:null:-1!==(o=indexOf.call(this._longMonthsParse,a))?o:null:"MMM"===t?-1!==(o=indexOf.call(this._shortMonthsParse,a))||-1!==(o=indexOf.call(this._longMonthsParse,a))?o:null:-1!==(o=indexOf.call(this._longMonthsParse,a))||-1!==(o=indexOf.call(this._shortMonthsParse,a))?o:null}function localeMonthsParse(e,t,r){var n,o,i;if(this._monthsParseExact)return handleStrictParse.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=createUTC([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),r||this._monthsParse[n]||(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&"MMMM"===t&&this._longMonthsParse[n].test(e))return n;if(r&&"MMM"===t&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function setMonth(e,t){var r;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=toInt(t);else if(!isNumber$2(t=e.localeData().monthsParse(t)))return e;return r=Math.min(e.date(),daysInMonth(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function getSetMonth(e){return null!=e?(setMonth(this,e),hooks.updateOffset(this,!0),this):get$1(this,"Month")}function getDaysInMonth(){return daysInMonth(this.year(),this.month())}function monthsShortRegex(e){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(hasOwnProp(this,"_monthsShortRegex")||(this._monthsShortRegex=defaultMonthsShortRegex),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function monthsRegex(e){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),e?this._monthsStrictRegex:this._monthsRegex):(hasOwnProp(this,"_monthsRegex")||(this._monthsRegex=defaultMonthsRegex),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function computeMonthsParse(){function e(e,t){return t.length-e.length}var t,r,n=[],o=[],i=[];for(t=0;t<12;t++)r=createUTC([2e3,t]),n.push(this.monthsShort(r,"")),o.push(this.months(r,"")),i.push(this.months(r,"")),i.push(this.monthsShort(r,""));for(n.sort(e),o.sort(e),i.sort(e),t=0;t<12;t++)n[t]=regexEscape(n[t]),o[t]=regexEscape(o[t]);for(t=0;t<24;t++)i[t]=regexEscape(i[t]);this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+n.join("|")+")","i")}function daysInYear(e){return isLeapYear(e)?366:365}addFormatToken("Y",0,0,(function(){var e=this.year();return e<=9999?zeroFill(e,4):"+"+e})),addFormatToken(0,["YY",2],0,(function(){return this.year()%100})),addFormatToken(0,["YYYY",4],0,"year"),addFormatToken(0,["YYYYY",5],0,"year"),addFormatToken(0,["YYYYYY",6,!0],0,"year"),addUnitAlias("year","y"),addUnitPriority("year",1),addRegexToken("Y",matchSigned),addRegexToken("YY",match1to2,match2),addRegexToken("YYYY",match1to4,match4),addRegexToken("YYYYY",match1to6,match6),addRegexToken("YYYYYY",match1to6,match6),addParseToken(["YYYYY","YYYYYY"],YEAR),addParseToken("YYYY",(function(e,t){t[YEAR]=2===e.length?hooks.parseTwoDigitYear(e):toInt(e)})),addParseToken("YY",(function(e,t){t[YEAR]=hooks.parseTwoDigitYear(e)})),addParseToken("Y",(function(e,t){t[YEAR]=parseInt(e,10)})),hooks.parseTwoDigitYear=function(e){return toInt(e)+(toInt(e)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",!0);function getIsLeapYear(){return isLeapYear(this.year())}function createDate(e,t,r,n,o,i,a){var s;return e<100&&e>=0?(s=new Date(e+400,t,r,n,o,i,a),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,r,n,o,i,a),s}function createUTCDate(e){var t,r;return e<100&&e>=0?((r=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function firstWeekOffset(e,t,r){var n=7+t-r;return-((7+createUTCDate(e,0,n).getUTCDay()-t)%7)+n-1}function dayOfYearFromWeeks(e,t,r,n,o){var i,a,s=1+7*(t-1)+(7+r-n)%7+firstWeekOffset(e,n,o);return s<=0?a=daysInYear(i=e-1)+s:s>daysInYear(e)?(i=e+1,a=s-daysInYear(e)):(i=e,a=s),{year:i,dayOfYear:a}}function weekOfYear(e,t,r){var n,o,i=firstWeekOffset(e.year(),t,r),a=Math.floor((e.dayOfYear()-i-1)/7)+1;return a<1?n=a+weeksInYear(o=e.year()-1,t,r):a>weeksInYear(e.year(),t,r)?(n=a-weeksInYear(e.year(),t,r),o=e.year()+1):(o=e.year(),n=a),{week:n,year:o}}function weeksInYear(e,t,r){var n=firstWeekOffset(e,t,r),o=firstWeekOffset(e+1,t,r);return(daysInYear(e)-n+o)/7}function localeWeek(e){return weekOfYear(e,this._week.dow,this._week.doy).week}addFormatToken("w",["ww",2],"wo","week"),addFormatToken("W",["WW",2],"Wo","isoWeek"),addUnitAlias("week","w"),addUnitAlias("isoWeek","W"),addUnitPriority("week",5),addUnitPriority("isoWeek",5),addRegexToken("w",match1to2),addRegexToken("ww",match1to2,match2),addRegexToken("W",match1to2),addRegexToken("WW",match1to2,match2),addWeekParseToken(["w","ww","W","WW"],(function(e,t,r,n){t[n.substr(0,1)]=toInt(e)}));var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow}function localeFirstDayOfYear(){return this._week.doy}function getSetWeek(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function getSetISOWeek(e){var t=weekOfYear(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function parseWeekday(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}function parseIsoWeekday(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function shiftWeekdays(e,t){return e.slice(t,7).concat(e.slice(0,t))}addFormatToken("d",0,"do","day"),addFormatToken("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),addFormatToken("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),addFormatToken("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),addFormatToken("e",0,0,"weekday"),addFormatToken("E",0,0,"isoWeekday"),addUnitAlias("day","d"),addUnitAlias("weekday","e"),addUnitAlias("isoWeekday","E"),addUnitPriority("day",11),addUnitPriority("weekday",11),addUnitPriority("isoWeekday",11),addRegexToken("d",match1to2),addRegexToken("e",match1to2),addRegexToken("E",match1to2),addRegexToken("dd",(function(e,t){return t.weekdaysMinRegex(e)})),addRegexToken("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),addRegexToken("dddd",(function(e,t){return t.weekdaysRegex(e)})),addWeekParseToken(["dd","ddd","dddd"],(function(e,t,r,n){var o=r._locale.weekdaysParse(e,n,r._strict);null!=o?t.d=o:getParsingFlags(r).invalidWeekday=e})),addWeekParseToken(["d","e","E"],(function(e,t,r,n){t[n]=toInt(e)}));var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),defaultWeekdaysRegex=matchWord,defaultWeekdaysShortRegex=matchWord,defaultWeekdaysMinRegex=matchWord;function localeWeekdays(e,t){var r=isArray$3(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?shiftWeekdays(r,this._week.dow):e?r[e.day()]:r}function localeWeekdaysShort(e){return!0===e?shiftWeekdays(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function localeWeekdaysMin(e){return!0===e?shiftWeekdays(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function handleStrictParse$1(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=createUTC([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?"dddd"===t?-1!==(o=indexOf.call(this._weekdaysParse,a))?o:null:"ddd"===t?-1!==(o=indexOf.call(this._shortWeekdaysParse,a))?o:null:-1!==(o=indexOf.call(this._minWeekdaysParse,a))?o:null:"dddd"===t?-1!==(o=indexOf.call(this._weekdaysParse,a))||-1!==(o=indexOf.call(this._shortWeekdaysParse,a))||-1!==(o=indexOf.call(this._minWeekdaysParse,a))?o:null:"ddd"===t?-1!==(o=indexOf.call(this._shortWeekdaysParse,a))||-1!==(o=indexOf.call(this._weekdaysParse,a))||-1!==(o=indexOf.call(this._minWeekdaysParse,a))?o:null:-1!==(o=indexOf.call(this._minWeekdaysParse,a))||-1!==(o=indexOf.call(this._weekdaysParse,a))||-1!==(o=indexOf.call(this._shortWeekdaysParse,a))?o:null}function localeWeekdaysParse(e,t,r){var n,o,i;if(this._weekdaysParseExact)return handleStrictParse$1.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=createUTC([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&"dddd"===t&&this._fullWeekdaysParse[n].test(e))return n;if(r&&"ddd"===t&&this._shortWeekdaysParse[n].test(e))return n;if(r&&"dd"===t&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function getSetDayOfWeek(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=parseWeekday(e,this.localeData()),this.add(e-t,"d")):t}function getSetLocaleDayOfWeek(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function getSetISODayOfWeek(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=parseIsoWeekday(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function weekdaysRegex(e){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(hasOwnProp(this,"_weekdaysRegex")||(this._weekdaysRegex=defaultWeekdaysRegex),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function weekdaysShortRegex(e){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(hasOwnProp(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=defaultWeekdaysShortRegex),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function weekdaysMinRegex(e){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(hasOwnProp(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=defaultWeekdaysMinRegex),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function computeWeekdaysParse(){function e(e,t){return t.length-e.length}var t,r,n,o,i,a=[],s=[],l=[],c=[];for(t=0;t<7;t++)r=createUTC([2e3,1]).day(t),n=regexEscape(this.weekdaysMin(r,"")),o=regexEscape(this.weekdaysShort(r,"")),i=regexEscape(this.weekdays(r,"")),a.push(n),s.push(o),l.push(i),c.push(n),c.push(o),c.push(i);a.sort(e),s.sort(e),l.sort(e),c.sort(e),this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function hFormat(){return this.hours()%12||12}function kFormat(){return this.hours()||24}function meridiem(e,t){addFormatToken(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function matchMeridiem(e,t){return t._meridiemParse}function localeIsPM(e){return"p"===(e+"").toLowerCase().charAt(0)}addFormatToken("H",["HH",2],0,"hour"),addFormatToken("h",["hh",2],0,hFormat),addFormatToken("k",["kk",2],0,kFormat),addFormatToken("hmm",0,0,(function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)})),addFormatToken("hmmss",0,0,(function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)})),addFormatToken("Hmm",0,0,(function(){return""+this.hours()+zeroFill(this.minutes(),2)})),addFormatToken("Hmmss",0,0,(function(){return""+this.hours()+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)})),meridiem("a",!0),meridiem("A",!1),addUnitAlias("hour","h"),addUnitPriority("hour",13),addRegexToken("a",matchMeridiem),addRegexToken("A",matchMeridiem),addRegexToken("H",match1to2),addRegexToken("h",match1to2),addRegexToken("k",match1to2),addRegexToken("HH",match1to2,match2),addRegexToken("hh",match1to2,match2),addRegexToken("kk",match1to2,match2),addRegexToken("hmm",match3to4),addRegexToken("hmmss",match5to6),addRegexToken("Hmm",match3to4),addRegexToken("Hmmss",match5to6),addParseToken(["H","HH"],HOUR),addParseToken(["k","kk"],(function(e,t,r){var n=toInt(e);t[HOUR]=24===n?0:n})),addParseToken(["a","A"],(function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e})),addParseToken(["h","hh"],(function(e,t,r){t[HOUR]=toInt(e),getParsingFlags(r).bigHour=!0})),addParseToken("hmm",(function(e,t,r){var n=e.length-2;t[HOUR]=toInt(e.substr(0,n)),t[MINUTE]=toInt(e.substr(n)),getParsingFlags(r).bigHour=!0})),addParseToken("hmmss",(function(e,t,r){var n=e.length-4,o=e.length-2;t[HOUR]=toInt(e.substr(0,n)),t[MINUTE]=toInt(e.substr(n,2)),t[SECOND]=toInt(e.substr(o)),getParsingFlags(r).bigHour=!0})),addParseToken("Hmm",(function(e,t,r){var n=e.length-2;t[HOUR]=toInt(e.substr(0,n)),t[MINUTE]=toInt(e.substr(n))})),addParseToken("Hmmss",(function(e,t,r){var n=e.length-4,o=e.length-2;t[HOUR]=toInt(e.substr(0,n)),t[MINUTE]=toInt(e.substr(n,2)),t[SECOND]=toInt(e.substr(o))}));var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i,getSetHour=makeGetSet("Hours",!0);function localeMeridiem(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var baseConfig={calendar:defaultCalendar,longDateFormat:defaultLongDateFormat,invalidDate:defaultInvalidDate,ordinal:defaultOrdinal,dayOfMonthOrdinalParse:defaultDayOfMonthOrdinalParse,relativeTime:defaultRelativeTime,months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:defaultLocaleWeek,weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:defaultLocaleMeridiemParse},locales={},localeFamilies={},globalLocale;function commonPrefix(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function normalizeLocale(e){return e?e.toLowerCase().replace("_","-"):e}function chooseLocale(e){for(var t,r,n,o,i=0;i<e.length;){for(t=(o=normalizeLocale(e[i]).split("-")).length,r=(r=normalizeLocale(e[i+1]))?r.split("-"):null;t>0;){if(n=loadLocale(o.slice(0,t).join("-")))return n;if(r&&r.length>=t&&commonPrefix(o,r)>=t-1)break;t--}i++}return globalLocale}function isLocaleNameSane(e){return null!=e.match("^[^/\\\\]*$")}function loadLocale(e){var t=null;if(void 0===locales[e]&&"undefined"!=typeof module&&module&&module.exports&&isLocaleNameSane(e))try{t=globalLocale._abbr,require("./locale/"+e),getSetGlobalLocale(t)}catch(e3){locales[e]=null}return locales[e]}function getSetGlobalLocale(e,t){var r;return e&&((r=isUndefined$1(t)?getLocale(e):defineLocale(e,t))?globalLocale=r:"undefined"!=typeof console&&console.warn),globalLocale._abbr}function defineLocale(e,t){if(null!==t){var r,n=baseConfig;if(t.abbr=e,null!=locales[e])deprecateSimple("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=locales[e]._config;else if(null!=t.parentLocale)if(null!=locales[t.parentLocale])n=locales[t.parentLocale]._config;else{if(null==(r=loadLocale(t.parentLocale)))return localeFamilies[t.parentLocale]||(localeFamilies[t.parentLocale]=[]),localeFamilies[t.parentLocale].push({name:e,config:t}),null;n=r._config}return locales[e]=new Locale(mergeConfigs(n,t)),localeFamilies[e]&&localeFamilies[e].forEach((function(e){defineLocale(e.name,e.config)})),getSetGlobalLocale(e),locales[e]}return delete locales[e],null}function updateLocale(e,t){if(null!=t){var r,n,o=baseConfig;null!=locales[e]&&null!=locales[e].parentLocale?locales[e].set(mergeConfigs(locales[e]._config,t)):(null!=(n=loadLocale(e))&&(o=n._config),t=mergeConfigs(o,t),null==n&&(t.abbr=e),(r=new Locale(t)).parentLocale=locales[e],locales[e]=r),getSetGlobalLocale(e)}else null!=locales[e]&&(null!=locales[e].parentLocale?(locales[e]=locales[e].parentLocale,e===getSetGlobalLocale()&&getSetGlobalLocale(e)):null!=locales[e]&&delete locales[e]);return locales[e]}function getLocale(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return globalLocale;if(!isArray$3(e)){if(t=loadLocale(e))return t;e=[e]}return chooseLocale(e)}function listLocales(){return keys$1(locales)}function checkOverflow(e){var t,r=e._a;return r&&-2===getParsingFlags(e).overflow&&(t=r[MONTH]<0||r[MONTH]>11?MONTH:r[DATE]<1||r[DATE]>daysInMonth(r[YEAR],r[MONTH])?DATE:r[HOUR]<0||r[HOUR]>24||24===r[HOUR]&&(0!==r[MINUTE]||0!==r[SECOND]||0!==r[MILLISECOND])?HOUR:r[MINUTE]<0||r[MINUTE]>59?MINUTE:r[SECOND]<0||r[SECOND]>59?SECOND:r[MILLISECOND]<0||r[MILLISECOND]>999?MILLISECOND:-1,getParsingFlags(e)._overflowDayOfYear&&(t<YEAR||t>DATE)&&(t=DATE),getParsingFlags(e)._overflowWeeks&&-1===t&&(t=WEEK),getParsingFlags(e)._overflowWeekday&&-1===t&&(t=WEEKDAY),getParsingFlags(e).overflow=t),e}var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tzRegex=/Z|[+-]\d\d(?::?\d\d)?/,isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],isoTimes=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],aspNetJsonRegex=/^\/?Date\((-?\d+)/i,rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,obsOffsets={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function configFromISO(e){var t,r,n,o,i,a,s=e._i,l=extendedIsoRegex.exec(s)||basicIsoRegex.exec(s),c=isoDates.length,u=isoTimes.length;if(l){for(getParsingFlags(e).iso=!0,t=0,r=c;t<r;t++)if(isoDates[t][1].exec(l[1])){o=isoDates[t][0],n=!1!==isoDates[t][2];break}if(null==o)return void(e._isValid=!1);if(l[3]){for(t=0,r=u;t<r;t++)if(isoTimes[t][1].exec(l[3])){i=(l[2]||" ")+isoTimes[t][0];break}if(null==i)return void(e._isValid=!1)}if(!n&&null!=i)return void(e._isValid=!1);if(l[4]){if(!tzRegex.exec(l[4]))return void(e._isValid=!1);a="Z"}e._f=o+(i||"")+(a||""),configFromStringAndFormat(e)}else e._isValid=!1}function extractFromRFC2822Strings(e,t,r,n,o,i){var a=[untruncateYear(e),defaultLocaleMonthsShort.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(o,10)];return i&&a.push(parseInt(i,10)),a}function untruncateYear(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function preprocessRFC2822(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function checkWeekday(e,t,r){if(e&&defaultLocaleWeekdaysShort.indexOf(e)!==new Date(t[0],t[1],t[2]).getDay())return getParsingFlags(r).weekdayMismatch=!0,r._isValid=!1,!1;return!0}function calculateOffset(e,t,r){if(e)return obsOffsets[e];if(t)return 0;var n=parseInt(r,10),o=n%100;return 60*((n-o)/100)+o}function configFromRFC2822(e){var t,r=rfc2822.exec(preprocessRFC2822(e._i));if(r){if(t=extractFromRFC2822Strings(r[4],r[3],r[2],r[5],r[6],r[7]),!checkWeekday(r[1],t,e))return;e._a=t,e._tzm=calculateOffset(r[8],r[9],r[10]),e._d=createUTCDate.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),getParsingFlags(e).rfc2822=!0}else e._isValid=!1}function configFromString(e){var t=aspNetJsonRegex.exec(e._i);null===t?(configFromISO(e),!1===e._isValid&&(delete e._isValid,configFromRFC2822(e),!1===e._isValid&&(delete e._isValid,e._strict?e._isValid=!1:hooks.createFromInputFallback(e)))):e._d=new Date(+t[1])}function defaults$5(e,t,r){return null!=e?e:null!=t?t:r}function currentDateArray(e){var t=new Date(hooks.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function configFromArray(e){var t,r,n,o,i,a=[];if(!e._d){for(n=currentDateArray(e),e._w&&null==e._a[DATE]&&null==e._a[MONTH]&&dayOfYearFromWeekInfo(e),null!=e._dayOfYear&&(i=defaults$5(e._a[YEAR],n[YEAR]),(e._dayOfYear>daysInYear(i)||0===e._dayOfYear)&&(getParsingFlags(e)._overflowDayOfYear=!0),r=createUTCDate(i,0,e._dayOfYear),e._a[MONTH]=r.getUTCMonth(),e._a[DATE]=r.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=a[t]=n[t];for(;t<7;t++)e._a[t]=a[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[HOUR]&&0===e._a[MINUTE]&&0===e._a[SECOND]&&0===e._a[MILLISECOND]&&(e._nextDay=!0,e._a[HOUR]=0),e._d=(e._useUTC?createUTCDate:createDate).apply(null,a),o=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[HOUR]=24),e._w&&void 0!==e._w.d&&e._w.d!==o&&(getParsingFlags(e).weekdayMismatch=!0)}}function dayOfYearFromWeekInfo(e){var t,r,n,o,i,a,s,l,c;null!=(t=e._w).GG||null!=t.W||null!=t.E?(i=1,a=4,r=defaults$5(t.GG,e._a[YEAR],weekOfYear(createLocal(),1,4).year),n=defaults$5(t.W,1),((o=defaults$5(t.E,1))<1||o>7)&&(l=!0)):(i=e._locale._week.dow,a=e._locale._week.doy,c=weekOfYear(createLocal(),i,a),r=defaults$5(t.gg,e._a[YEAR],c.year),n=defaults$5(t.w,c.week),null!=t.d?((o=t.d)<0||o>6)&&(l=!0):null!=t.e?(o=t.e+i,(t.e<0||t.e>6)&&(l=!0)):o=i),n<1||n>weeksInYear(r,i,a)?getParsingFlags(e)._overflowWeeks=!0:null!=l?getParsingFlags(e)._overflowWeekday=!0:(s=dayOfYearFromWeeks(r,n,o,i,a),e._a[YEAR]=s.year,e._dayOfYear=s.dayOfYear)}function configFromStringAndFormat(e){if(e._f!==hooks.ISO_8601)if(e._f!==hooks.RFC_2822){e._a=[],getParsingFlags(e).empty=!0;var t,r,n,o,i,a,s,l=""+e._i,c=l.length,u=0;for(s=(n=expandFormat(e._f,e._locale).match(formattingTokens)||[]).length,t=0;t<s;t++)o=n[t],(r=(l.match(getParseRegexForToken(o,e))||[])[0])&&((i=l.substr(0,l.indexOf(r))).length>0&&getParsingFlags(e).unusedInput.push(i),l=l.slice(l.indexOf(r)+r.length),u+=r.length),formatTokenFunctions[o]?(r?getParsingFlags(e).empty=!1:getParsingFlags(e).unusedTokens.push(o),addTimeToArrayFromToken(o,r,e)):e._strict&&!r&&getParsingFlags(e).unusedTokens.push(o);getParsingFlags(e).charsLeftOver=c-u,l.length>0&&getParsingFlags(e).unusedInput.push(l),e._a[HOUR]<=12&&!0===getParsingFlags(e).bigHour&&e._a[HOUR]>0&&(getParsingFlags(e).bigHour=void 0),getParsingFlags(e).parsedDateParts=e._a.slice(0),getParsingFlags(e).meridiem=e._meridiem,e._a[HOUR]=meridiemFixWrap(e._locale,e._a[HOUR],e._meridiem),null!==(a=getParsingFlags(e).era)&&(e._a[YEAR]=e._locale.erasConvertYear(a,e._a[YEAR])),configFromArray(e),checkOverflow(e)}else configFromRFC2822(e);else configFromISO(e)}function meridiemFixWrap(e,t,r){var n;return null==r?t:null!=e.meridiemHour?e.meridiemHour(t,r):null!=e.isPM?((n=e.isPM(r))&&t<12&&(t+=12),n||12!==t||(t=0),t):t}function configFromStringAndArray(e){var t,r,n,o,i,a,s=!1,l=e._f.length;if(0===l)return getParsingFlags(e).invalidFormat=!0,void(e._d=new Date(NaN));for(o=0;o<l;o++)i=0,a=!1,t=copyConfig({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[o],configFromStringAndFormat(t),isValid(t)&&(a=!0),i+=getParsingFlags(t).charsLeftOver,i+=10*getParsingFlags(t).unusedTokens.length,getParsingFlags(t).score=i,s?i<n&&(n=i,r=t):(null==n||i<n||a)&&(n=i,r=t,a&&(s=!0));extend$1(e,r||t)}function configFromObject(e){if(!e._d){var t=normalizeObjectUnits(e._i),r=void 0===t.day?t.date:t.day;e._a=map$1([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),configFromArray(e)}}function createFromConfig(e){var t=new Moment(checkOverflow(prepareConfig(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function prepareConfig(e){var t=e._i,r=e._f;return e._locale=e._locale||getLocale(e._l),null===t||void 0===r&&""===t?createInvalid({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),isMoment(t)?new Moment(checkOverflow(t)):(isDate$1(t)?e._d=t:isArray$3(r)?configFromStringAndArray(e):r?configFromStringAndFormat(e):configFromInput(e),isValid(e)||(e._d=null),e))}function configFromInput(e){var t=e._i;isUndefined$1(t)?e._d=new Date(hooks.now()):isDate$1(t)?e._d=new Date(t.valueOf()):"string"==typeof t?configFromString(e):isArray$3(t)?(e._a=map$1(t.slice(0),(function(e){return parseInt(e,10)})),configFromArray(e)):isObject$5(t)?configFromObject(e):isNumber$2(t)?e._d=new Date(t):hooks.createFromInputFallback(e)}function createLocalOrUTC(e,t,r,n,o){var i={};return!0!==t&&!1!==t||(n=t,t=void 0),!0!==r&&!1!==r||(n=r,r=void 0),(isObject$5(e)&&isObjectEmpty(e)||isArray$3(e)&&0===e.length)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=r,i._i=e,i._f=t,i._strict=n,createFromConfig(i)}function createLocal(e,t,r,n){return createLocalOrUTC(e,t,r,n,!1)}hooks.createFromInputFallback=deprecate("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),hooks.ISO_8601=function(){},hooks.RFC_2822=function(){};var prototypeMin=deprecate("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=createLocal.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:createInvalid()})),prototypeMax=deprecate("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=createLocal.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:createInvalid()}));function pickBy(e,t){var r,n;if(1===t.length&&isArray$3(t[0])&&(t=t[0]),!t.length)return createLocal();for(r=t[0],n=1;n<t.length;++n)t[n].isValid()&&!t[n][e](r)||(r=t[n]);return r}function min(){return pickBy("isBefore",[].slice.call(arguments,0))}function max$2(){return pickBy("isAfter",[].slice.call(arguments,0))}var now$1=function(){return Date.now?Date.now():+new Date},ordering=["year","quarter","month","week","day","hour","minute","second","millisecond"];function isDurationValid(e){var t,r,n=!1,o=ordering.length;for(t in e)if(hasOwnProp(e,t)&&(-1===indexOf.call(ordering,t)||null!=e[t]&&isNaN(e[t])))return!1;for(r=0;r<o;++r)if(e[ordering[r]]){if(n)return!1;parseFloat(e[ordering[r]])!==toInt(e[ordering[r]])&&(n=!0)}return!0}function isValid$1(){return this._isValid}function createInvalid$1(){return createDuration(NaN)}function Duration(e){var t=normalizeObjectUnits(e),r=t.year||0,n=t.quarter||0,o=t.month||0,i=t.week||t.isoWeek||0,a=t.day||0,s=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._isValid=isDurationValid(t),this._milliseconds=+u+1e3*c+6e4*l+1e3*s*60*60,this._days=+a+7*i,this._months=+o+3*n+12*r,this._data={},this._locale=getLocale(),this._bubble()}function isDuration(e){return e instanceof Duration}function absRound(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function compareArrays(e,t,r){var n,o=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),a=0;for(n=0;n<o;n++)toInt(e[n])!==toInt(t[n])&&a++;return a+i}function offset(e,t){addFormatToken(e,0,0,(function(){var e=this.utcOffset(),r="+";return e<0&&(e=-e,r="-"),r+zeroFill(~~(e/60),2)+t+zeroFill(~~e%60,2)}))}offset("Z",":"),offset("ZZ",""),addRegexToken("Z",matchShortOffset),addRegexToken("ZZ",matchShortOffset),addParseToken(["Z","ZZ"],(function(e,t,r){r._useUTC=!0,r._tzm=offsetFromString(matchShortOffset,e)}));var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(e,t){var r,n,o=(t||"").match(e);return null===o?null:0===(n=60*(r=((o[o.length-1]||[])+"").match(chunkOffset)||["-",0,0])[1]+toInt(r[2]))?0:"+"===r[0]?n:-n}function cloneWithOffset(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(isMoment(e)||isDate$1(e)?e.valueOf():createLocal(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),hooks.updateOffset(r,!1),r):createLocal(e).local()}function getDateOffset(e){return-Math.round(e._d.getTimezoneOffset())}function getSetOffset(e,t,r){var n,o=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=offsetFromString(matchShortOffset,e)))return this}else Math.abs(e)<16&&!r&&(e*=60);return!this._isUTC&&t&&(n=getDateOffset(this)),this._offset=e,this._isUTC=!0,null!=n&&this.add(n,"m"),o!==e&&(!t||this._changeInProgress?addSubtract(this,createDuration(e-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,hooks.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?o:getDateOffset(this)}function getSetZone(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function setOffsetToUTC(e){return this.utcOffset(0,e)}function setOffsetToLocal(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(getDateOffset(this),"m")),this}function setOffsetToParsedOffset(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=offsetFromString(matchOffset,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function hasAlignedHourOffset(e){return!!this.isValid()&&(e=e?createLocal(e).utcOffset():0,(this.utcOffset()-e)%60==0)}function isDaylightSavingTime(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function isDaylightSavingTimeShifted(){if(!isUndefined$1(this._isDSTShifted))return this._isDSTShifted;var e,t={};return copyConfig(t,this),(t=prepareConfig(t))._a?(e=t._isUTC?createUTC(t._a):createLocal(t._a),this._isDSTShifted=this.isValid()&&compareArrays(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function isLocal(){return!!this.isValid()&&!this._isUTC}function isUtcOffset(){return!!this.isValid()&&this._isUTC}function isUtc(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}hooks.updateOffset=function(){};var aspNetRegex=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(e,t){var r,n,o,i=e,a=null;return isDuration(e)?i={ms:e._milliseconds,d:e._days,M:e._months}:isNumber$2(e)||!isNaN(+e)?(i={},t?i[t]=+e:i.milliseconds=+e):(a=aspNetRegex.exec(e))?(r="-"===a[1]?-1:1,i={y:0,d:toInt(a[DATE])*r,h:toInt(a[HOUR])*r,m:toInt(a[MINUTE])*r,s:toInt(a[SECOND])*r,ms:toInt(absRound(1e3*a[MILLISECOND]))*r}):(a=isoRegex.exec(e))?(r="-"===a[1]?-1:1,i={y:parseIso(a[2],r),M:parseIso(a[3],r),w:parseIso(a[4],r),d:parseIso(a[5],r),h:parseIso(a[6],r),m:parseIso(a[7],r),s:parseIso(a[8],r)}):null==i?i={}:"object"==typeof i&&("from"in i||"to"in i)&&(o=momentsDifference(createLocal(i.from),createLocal(i.to)),(i={}).ms=o.milliseconds,i.M=o.months),n=new Duration(i),isDuration(e)&&hasOwnProp(e,"_locale")&&(n._locale=e._locale),isDuration(e)&&hasOwnProp(e,"_isValid")&&(n._isValid=e._isValid),n}function parseIso(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function positiveMomentsDifference(e,t){var r={};return r.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function momentsDifference(e,t){var r;return e.isValid()&&t.isValid()?(t=cloneWithOffset(t,e),e.isBefore(t)?r=positiveMomentsDifference(e,t):((r=positiveMomentsDifference(t,e)).milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function createAdder(e,t){return function(r,n){var o;return null===n||isNaN(+n)||(deprecateSimple(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),addSubtract(this,createDuration(r,n),e),this}}function addSubtract(e,t,r,n){var o=t._milliseconds,i=absRound(t._days),a=absRound(t._months);e.isValid()&&(n=null==n||n,a&&setMonth(e,get$1(e,"Month")+a*r),i&&set$1(e,"Date",get$1(e,"Date")+i*r),o&&e._d.setTime(e._d.valueOf()+o*r),n&&hooks.updateOffset(e,i||a))}createDuration.fn=Duration.prototype,createDuration.invalid=createInvalid$1;var add=createAdder(1,"add"),subtract=createAdder(-1,"subtract");function isString$1(e){return"string"==typeof e||e instanceof String}function isMomentInput(e){return isMoment(e)||isDate$1(e)||isString$1(e)||isNumber$2(e)||isNumberOrStringArray(e)||isMomentInputObject(e)||null==e}function isMomentInputObject(e){var t,r=isObject$5(e)&&!isObjectEmpty(e),n=!1,o=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i=o.length;for(t=0;t<i;t+=1)n=n||hasOwnProp(e,o[t]);return r&&n}function isNumberOrStringArray(e){var t=isArray$3(e),r=!1;return t&&(r=0===e.filter((function(t){return!isNumber$2(t)&&isString$1(e)})).length),t&&r}function isCalendarSpec(e){var t,r=isObject$5(e)&&!isObjectEmpty(e),n=!1,o=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(t=0;t<o.length;t+=1)n=n||hasOwnProp(e,o[t]);return r&&n}function getCalendarFormat(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function calendar$1(e,t){1===arguments.length&&(arguments[0]?isMomentInput(arguments[0])?(e=arguments[0],t=void 0):isCalendarSpec(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||createLocal(),n=cloneWithOffset(r,this).startOf("day"),o=hooks.calendarFormat(this,n)||"sameElse",i=t&&(isFunction$2(t[o])?t[o].call(this,r):t[o]);return this.format(i||this.localeData().calendar(o,this,createLocal(r)))}function clone(){return new Moment(this)}function isAfter(e,t){var r=isMoment(e)?e:createLocal(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=normalizeUnits(t)||"millisecond")?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf())}function isBefore(e,t){var r=isMoment(e)?e:createLocal(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=normalizeUnits(t)||"millisecond")?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf())}function isBetween(e,t,r,n){var o=isMoment(e)?e:createLocal(e),i=isMoment(t)?t:createLocal(t);return!!(this.isValid()&&o.isValid()&&i.isValid())&&(("("===(n=n||"()")[0]?this.isAfter(o,r):!this.isBefore(o,r))&&(")"===n[1]?this.isBefore(i,r):!this.isAfter(i,r)))}function isSame(e,t){var r,n=isMoment(e)?e:createLocal(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=normalizeUnits(t)||"millisecond")?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(t).valueOf()<=r&&r<=this.clone().endOf(t).valueOf()))}function isSameOrAfter(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function isSameOrBefore(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function diff(e,t,r){var n,o,i;if(!this.isValid())return NaN;if(!(n=cloneWithOffset(e,this)).isValid())return NaN;switch(o=6e4*(n.utcOffset()-this.utcOffset()),t=normalizeUnits(t)){case"year":i=monthDiff(this,n)/12;break;case"month":i=monthDiff(this,n);break;case"quarter":i=monthDiff(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-o)/864e5;break;case"week":i=(this-n-o)/6048e5;break;default:i=this-n}return r?i:absFloor(i)}function monthDiff(e,t){if(e.date()<t.date())return-monthDiff(t,e);var r=12*(t.year()-e.year())+(t.month()-e.month()),n=e.clone().add(r,"months");return-(r+(t-n<0?(t-n)/(n-e.clone().add(r-1,"months")):(t-n)/(e.clone().add(r+1,"months")-n)))||0}function toString$2(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function toISOString(e){if(!this.isValid())return null;var t=!0!==e,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?formatMoment(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):isFunction$2(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",formatMoment(r,"Z")):formatMoment(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function inspect(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,r,n="moment",o="";return this.isLocal()||(n=0===this.utcOffset()?"moment.utc":"moment.parseZone",o="Z"),e="["+n+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r=o+'[")]',this.format(e+t+"-MM-DD[T]HH:mm:ss.SSS"+r)}function format$1(e){e||(e=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat);var t=formatMoment(this,e);return this.localeData().postformat(t)}function from(e,t){return this.isValid()&&(isMoment(e)&&e.isValid()||createLocal(e).isValid())?createDuration({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function fromNow(e){return this.from(createLocal(),e)}function to$1(e,t){return this.isValid()&&(isMoment(e)&&e.isValid()||createLocal(e).isValid())?createDuration({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function toNow(e){return this.to(createLocal(),e)}function locale(e){var t;return void 0===e?this._locale._abbr:(null!=(t=getLocale(e))&&(this._locale=t),this)}hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",hooks.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function localeData(){return this._locale}var MS_PER_SECOND=1e3,MS_PER_MINUTE=60*MS_PER_SECOND,MS_PER_HOUR=60*MS_PER_MINUTE,MS_PER_400_YEARS=3506328*MS_PER_HOUR;function mod$1(e,t){return(e%t+t)%t}function localStartOfDate(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-MS_PER_400_YEARS:new Date(e,t,r).valueOf()}function utcStartOfDate(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-MS_PER_400_YEARS:Date.UTC(e,t,r)}function startOf(e){var t,r;if(void 0===(e=normalizeUnits(e))||"millisecond"===e||!this.isValid())return this;switch(r=this._isUTC?utcStartOfDate:localStartOfDate,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=mod$1(t+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR);break;case"minute":t=this._d.valueOf(),t-=mod$1(t,MS_PER_MINUTE);break;case"second":t=this._d.valueOf(),t-=mod$1(t,MS_PER_SECOND)}return this._d.setTime(t),hooks.updateOffset(this,!0),this}function endOf(e){var t,r;if(void 0===(e=normalizeUnits(e))||"millisecond"===e||!this.isValid())return this;switch(r=this._isUTC?utcStartOfDate:localStartOfDate,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=MS_PER_HOUR-mod$1(t+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR)-1;break;case"minute":t=this._d.valueOf(),t+=MS_PER_MINUTE-mod$1(t,MS_PER_MINUTE)-1;break;case"second":t=this._d.valueOf(),t+=MS_PER_SECOND-mod$1(t,MS_PER_SECOND)-1}return this._d.setTime(t),hooks.updateOffset(this,!0),this}function valueOf(){return this._d.valueOf()-6e4*(this._offset||0)}function unix(){return Math.floor(this.valueOf()/1e3)}function toDate(){return new Date(this.valueOf())}function toArray$1(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function toObject(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function toJSON(){return this.isValid()?this.toISOString():null}function isValid$2(){return isValid(this)}function parsingFlags(){return extend$1({},getParsingFlags(this))}function invalidAt(){return getParsingFlags(this).overflow}function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function localeEras(e,t){var r,n,o,i=this._eras||getLocale("en")._eras;for(r=0,n=i.length;r<n;++r){if("string"==typeof i[r].since)o=hooks(i[r].since).startOf("day"),i[r].since=o.valueOf();switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":o=hooks(i[r].until).startOf("day").valueOf(),i[r].until=o.valueOf()}}return i}function localeErasParse(e,t,r){var n,o,i,a,s,l=this.eras();for(e=e.toUpperCase(),n=0,o=l.length;n<o;++n)if(i=l[n].name.toUpperCase(),a=l[n].abbr.toUpperCase(),s=l[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(a===e)return l[n];break;case"NNNN":if(i===e)return l[n];break;case"NNNNN":if(s===e)return l[n]}else if([i,a,s].indexOf(e)>=0)return l[n]}function localeErasConvertYear(e,t){var r=e.since<=e.until?1:-1;return void 0===t?hooks(e.since).year():hooks(e.since).year()+(t-e.offset)*r}function getEraName(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until)return n[e].name;if(n[e].until<=r&&r<=n[e].since)return n[e].name}return""}function getEraNarrow(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until)return n[e].narrow;if(n[e].until<=r&&r<=n[e].since)return n[e].narrow}return""}function getEraAbbr(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until)return n[e].abbr;if(n[e].until<=r&&r<=n[e].since)return n[e].abbr}return""}function getEraYear(){var e,t,r,n,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(r=o[e].since<=o[e].until?1:-1,n=this.clone().startOf("day").valueOf(),o[e].since<=n&&n<=o[e].until||o[e].until<=n&&n<=o[e].since)return(this.year()-hooks(o[e].since).year())*r+o[e].offset;return this.year()}function erasNameRegex(e){return hasOwnProp(this,"_erasNameRegex")||computeErasParse.call(this),e?this._erasNameRegex:this._erasRegex}function erasAbbrRegex(e){return hasOwnProp(this,"_erasAbbrRegex")||computeErasParse.call(this),e?this._erasAbbrRegex:this._erasRegex}function erasNarrowRegex(e){return hasOwnProp(this,"_erasNarrowRegex")||computeErasParse.call(this),e?this._erasNarrowRegex:this._erasRegex}function matchEraAbbr(e,t){return t.erasAbbrRegex(e)}function matchEraName(e,t){return t.erasNameRegex(e)}function matchEraNarrow(e,t){return t.erasNarrowRegex(e)}function matchEraYearOrdinal(e,t){return t._eraYearOrdinalRegex||matchUnsigned}function computeErasParse(){var e,t,r=[],n=[],o=[],i=[],a=this.eras();for(e=0,t=a.length;e<t;++e)n.push(regexEscape(a[e].name)),r.push(regexEscape(a[e].abbr)),o.push(regexEscape(a[e].narrow)),i.push(regexEscape(a[e].name)),i.push(regexEscape(a[e].abbr)),i.push(regexEscape(a[e].narrow));this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+n.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+o.join("|")+")","i")}function addWeekYearFormatToken(e,t){addFormatToken(0,[e,e.length],0,t)}function getSetWeekYear(e){return getSetWeekYearHelper.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function getSetISOWeekYear(e){return getSetWeekYearHelper.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function getISOWeeksInYear(){return weeksInYear(this.year(),1,4)}function getISOWeeksInISOWeekYear(){return weeksInYear(this.isoWeekYear(),1,4)}function getWeeksInYear(){var e=this.localeData()._week;return weeksInYear(this.year(),e.dow,e.doy)}function getWeeksInWeekYear(){var e=this.localeData()._week;return weeksInYear(this.weekYear(),e.dow,e.doy)}function getSetWeekYearHelper(e,t,r,n,o){var i;return null==e?weekOfYear(this,n,o).year:(t>(i=weeksInYear(e,n,o))&&(t=i),setWeekAll.call(this,e,t,r,n,o))}function setWeekAll(e,t,r,n,o){var i=dayOfYearFromWeeks(e,t,r,n,o),a=createUTCDate(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}function getSetQuarter(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}addFormatToken("N",0,0,"eraAbbr"),addFormatToken("NN",0,0,"eraAbbr"),addFormatToken("NNN",0,0,"eraAbbr"),addFormatToken("NNNN",0,0,"eraName"),addFormatToken("NNNNN",0,0,"eraNarrow"),addFormatToken("y",["y",1],"yo","eraYear"),addFormatToken("y",["yy",2],0,"eraYear"),addFormatToken("y",["yyy",3],0,"eraYear"),addFormatToken("y",["yyyy",4],0,"eraYear"),addRegexToken("N",matchEraAbbr),addRegexToken("NN",matchEraAbbr),addRegexToken("NNN",matchEraAbbr),addRegexToken("NNNN",matchEraName),addRegexToken("NNNNN",matchEraNarrow),addParseToken(["N","NN","NNN","NNNN","NNNNN"],(function(e,t,r,n){var o=r._locale.erasParse(e,n,r._strict);o?getParsingFlags(r).era=o:getParsingFlags(r).invalidEra=e})),addRegexToken("y",matchUnsigned),addRegexToken("yy",matchUnsigned),addRegexToken("yyy",matchUnsigned),addRegexToken("yyyy",matchUnsigned),addRegexToken("yo",matchEraYearOrdinal),addParseToken(["y","yy","yyy","yyyy"],YEAR),addParseToken(["yo"],(function(e,t,r,n){var o;r._locale._eraYearOrdinalRegex&&(o=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[YEAR]=r._locale.eraYearOrdinalParse(e,o):t[YEAR]=parseInt(e,10)})),addFormatToken(0,["gg",2],0,(function(){return this.weekYear()%100})),addFormatToken(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),addWeekYearFormatToken("gggg","weekYear"),addWeekYearFormatToken("ggggg","weekYear"),addWeekYearFormatToken("GGGG","isoWeekYear"),addWeekYearFormatToken("GGGGG","isoWeekYear"),addUnitAlias("weekYear","gg"),addUnitAlias("isoWeekYear","GG"),addUnitPriority("weekYear",1),addUnitPriority("isoWeekYear",1),addRegexToken("G",matchSigned),addRegexToken("g",matchSigned),addRegexToken("GG",match1to2,match2),addRegexToken("gg",match1to2,match2),addRegexToken("GGGG",match1to4,match4),addRegexToken("gggg",match1to4,match4),addRegexToken("GGGGG",match1to6,match6),addRegexToken("ggggg",match1to6,match6),addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,r,n){t[n.substr(0,2)]=toInt(e)})),addWeekParseToken(["gg","GG"],(function(e,t,r,n){t[n]=hooks.parseTwoDigitYear(e)})),addFormatToken("Q",0,"Qo","quarter"),addUnitAlias("quarter","Q"),addUnitPriority("quarter",7),addRegexToken("Q",match1),addParseToken("Q",(function(e,t){t[MONTH]=3*(toInt(e)-1)})),addFormatToken("D",["DD",2],"Do","date"),addUnitAlias("date","D"),addUnitPriority("date",9),addRegexToken("D",match1to2),addRegexToken("DD",match1to2,match2),addRegexToken("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),addParseToken(["D","DD"],DATE),addParseToken("Do",(function(e,t){t[DATE]=toInt(e.match(match1to2)[0])}));var getSetDayOfMonth=makeGetSet("Date",!0);function getSetDayOfYear(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear"),addUnitAlias("dayOfYear","DDD"),addUnitPriority("dayOfYear",4),addRegexToken("DDD",match1to3),addRegexToken("DDDD",match3),addParseToken(["DDD","DDDD"],(function(e,t,r){r._dayOfYear=toInt(e)})),addFormatToken("m",["mm",2],0,"minute"),addUnitAlias("minute","m"),addUnitPriority("minute",14),addRegexToken("m",match1to2),addRegexToken("mm",match1to2,match2),addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",!1);addFormatToken("s",["ss",2],0,"second"),addUnitAlias("second","s"),addUnitPriority("second",15),addRegexToken("s",match1to2),addRegexToken("ss",match1to2,match2),addParseToken(["s","ss"],SECOND);var getSetSecond=makeGetSet("Seconds",!1),token,getSetMillisecond;for(addFormatToken("S",0,0,(function(){return~~(this.millisecond()/100)})),addFormatToken(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),addFormatToken(0,["SSS",3],0,"millisecond"),addFormatToken(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),addFormatToken(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),addFormatToken(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),addFormatToken(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),addFormatToken(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),addFormatToken(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),addUnitAlias("millisecond","ms"),addUnitPriority("millisecond",16),addRegexToken("S",match1to3,match1),addRegexToken("SS",match1to3,match2),addRegexToken("SSS",match1to3,match3),token="SSSS";token.length<=9;token+="S")addRegexToken(token,matchUnsigned);function parseMs(e,t){t[MILLISECOND]=toInt(1e3*("0."+e))}for(token="S";token.length<=9;token+="S")addParseToken(token,parseMs);function getZoneAbbr(){return this._isUTC?"UTC":""}function getZoneName(){return this._isUTC?"Coordinated Universal Time":""}getSetMillisecond=makeGetSet("Milliseconds",!1),addFormatToken("z",0,0,"zoneAbbr"),addFormatToken("zz",0,0,"zoneName");var proto$1=Moment.prototype;function createUnix(e){return createLocal(1e3*e)}function createInZone(){return createLocal.apply(null,arguments).parseZone()}function preParsePostFormat(e){return e}proto$1.add=add,proto$1.calendar=calendar$1,proto$1.clone=clone,proto$1.diff=diff,proto$1.endOf=endOf,proto$1.format=format$1,proto$1.from=from,proto$1.fromNow=fromNow,proto$1.to=to$1,proto$1.toNow=toNow,proto$1.get=stringGet,proto$1.invalidAt=invalidAt,proto$1.isAfter=isAfter,proto$1.isBefore=isBefore,proto$1.isBetween=isBetween,proto$1.isSame=isSame,proto$1.isSameOrAfter=isSameOrAfter,proto$1.isSameOrBefore=isSameOrBefore,proto$1.isValid=isValid$2,proto$1.lang=lang,proto$1.locale=locale,proto$1.localeData=localeData,proto$1.max=prototypeMax,proto$1.min=prototypeMin,proto$1.parsingFlags=parsingFlags,proto$1.set=stringSet,proto$1.startOf=startOf,proto$1.subtract=subtract,proto$1.toArray=toArray$1,proto$1.toObject=toObject,proto$1.toDate=toDate,proto$1.toISOString=toISOString,proto$1.inspect=inspect,"undefined"!=typeof Symbol&&null!=Symbol.for&&(proto$1[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),proto$1.toJSON=toJSON,proto$1.toString=toString$2,proto$1.unix=unix,proto$1.valueOf=valueOf,proto$1.creationData=creationData,proto$1.eraName=getEraName,proto$1.eraNarrow=getEraNarrow,proto$1.eraAbbr=getEraAbbr,proto$1.eraYear=getEraYear,proto$1.year=getSetYear,proto$1.isLeapYear=getIsLeapYear,proto$1.weekYear=getSetWeekYear,proto$1.isoWeekYear=getSetISOWeekYear,proto$1.quarter=proto$1.quarters=getSetQuarter,proto$1.month=getSetMonth,proto$1.daysInMonth=getDaysInMonth,proto$1.week=proto$1.weeks=getSetWeek,proto$1.isoWeek=proto$1.isoWeeks=getSetISOWeek,proto$1.weeksInYear=getWeeksInYear,proto$1.weeksInWeekYear=getWeeksInWeekYear,proto$1.isoWeeksInYear=getISOWeeksInYear,proto$1.isoWeeksInISOWeekYear=getISOWeeksInISOWeekYear,proto$1.date=getSetDayOfMonth,proto$1.day=proto$1.days=getSetDayOfWeek,proto$1.weekday=getSetLocaleDayOfWeek,proto$1.isoWeekday=getSetISODayOfWeek,proto$1.dayOfYear=getSetDayOfYear,proto$1.hour=proto$1.hours=getSetHour,proto$1.minute=proto$1.minutes=getSetMinute,proto$1.second=proto$1.seconds=getSetSecond,proto$1.millisecond=proto$1.milliseconds=getSetMillisecond,proto$1.utcOffset=getSetOffset,proto$1.utc=setOffsetToUTC,proto$1.local=setOffsetToLocal,proto$1.parseZone=setOffsetToParsedOffset,proto$1.hasAlignedHourOffset=hasAlignedHourOffset,proto$1.isDST=isDaylightSavingTime,proto$1.isLocal=isLocal,proto$1.isUtcOffset=isUtcOffset,proto$1.isUtc=isUtc,proto$1.isUTC=isUtc,proto$1.zoneAbbr=getZoneAbbr,proto$1.zoneName=getZoneName,proto$1.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth),proto$1.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth),proto$1.years=deprecate("years accessor is deprecated. Use year instead",getSetYear),proto$1.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",getSetZone),proto$1.isDSTShifted=deprecate("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",isDaylightSavingTimeShifted);var proto$1$1=Locale.prototype;function get$1$1(e,t,r,n){var o=getLocale(),i=createUTC().set(n,t);return o[r](i,e)}function listMonthsImpl(e,t,r){if(isNumber$2(e)&&(t=e,e=void 0),e=e||"",null!=t)return get$1$1(e,t,r,"month");var n,o=[];for(n=0;n<12;n++)o[n]=get$1$1(e,n,r,"month");return o}function listWeekdaysImpl(e,t,r,n){"boolean"==typeof e?(isNumber$2(t)&&(r=t,t=void 0),t=t||""):(r=t=e,e=!1,isNumber$2(t)&&(r=t,t=void 0),t=t||"");var o,i=getLocale(),a=e?i._week.dow:0,s=[];if(null!=r)return get$1$1(t,(r+a)%7,n,"day");for(o=0;o<7;o++)s[o]=get$1$1(t,(o+a)%7,n,"day");return s}function listMonths(e,t){return listMonthsImpl(e,t,"months")}function listMonthsShort(e,t){return listMonthsImpl(e,t,"monthsShort")}function listWeekdays(e,t,r){return listWeekdaysImpl(e,t,r,"weekdays")}function listWeekdaysShort(e,t,r){return listWeekdaysImpl(e,t,r,"weekdaysShort")}function listWeekdaysMin(e,t,r){return listWeekdaysImpl(e,t,r,"weekdaysMin")}proto$1$1.calendar=calendar,proto$1$1.longDateFormat=longDateFormat,proto$1$1.invalidDate=invalidDate,proto$1$1.ordinal=ordinal,proto$1$1.preparse=preParsePostFormat,proto$1$1.postformat=preParsePostFormat,proto$1$1.relativeTime=relativeTime,proto$1$1.pastFuture=pastFuture,proto$1$1.set=set,proto$1$1.eras=localeEras,proto$1$1.erasParse=localeErasParse,proto$1$1.erasConvertYear=localeErasConvertYear,proto$1$1.erasAbbrRegex=erasAbbrRegex,proto$1$1.erasNameRegex=erasNameRegex,proto$1$1.erasNarrowRegex=erasNarrowRegex,proto$1$1.months=localeMonths,proto$1$1.monthsShort=localeMonthsShort,proto$1$1.monthsParse=localeMonthsParse,proto$1$1.monthsRegex=monthsRegex,proto$1$1.monthsShortRegex=monthsShortRegex,proto$1$1.week=localeWeek,proto$1$1.firstDayOfYear=localeFirstDayOfYear,proto$1$1.firstDayOfWeek=localeFirstDayOfWeek,proto$1$1.weekdays=localeWeekdays,proto$1$1.weekdaysMin=localeWeekdaysMin,proto$1$1.weekdaysShort=localeWeekdaysShort,proto$1$1.weekdaysParse=localeWeekdaysParse,proto$1$1.weekdaysRegex=weekdaysRegex,proto$1$1.weekdaysShortRegex=weekdaysShortRegex,proto$1$1.weekdaysMinRegex=weekdaysMinRegex,proto$1$1.isPM=localeIsPM,proto$1$1.meridiem=localeMeridiem,getSetGlobalLocale("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===toInt(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",getSetGlobalLocale),hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",getLocale);var mathAbs=Math.abs;function abs(){var e=this._data;return this._milliseconds=mathAbs(this._milliseconds),this._days=mathAbs(this._days),this._months=mathAbs(this._months),e.milliseconds=mathAbs(e.milliseconds),e.seconds=mathAbs(e.seconds),e.minutes=mathAbs(e.minutes),e.hours=mathAbs(e.hours),e.months=mathAbs(e.months),e.years=mathAbs(e.years),this}function addSubtract$1(e,t,r,n){var o=createDuration(t,r);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function add$1(e,t){return addSubtract$1(this,e,t,1)}function subtract$1(e,t){return addSubtract$1(this,e,t,-1)}function absCeil(e){return e<0?Math.floor(e):Math.ceil(e)}function bubble(){var e,t,r,n,o,i=this._milliseconds,a=this._days,s=this._months,l=this._data;return i>=0&&a>=0&&s>=0||i<=0&&a<=0&&s<=0||(i+=864e5*absCeil(monthsToDays(s)+a),a=0,s=0),l.milliseconds=i%1e3,e=absFloor(i/1e3),l.seconds=e%60,t=absFloor(e/60),l.minutes=t%60,r=absFloor(t/60),l.hours=r%24,a+=absFloor(r/24),s+=o=absFloor(daysToMonths(a)),a-=absCeil(monthsToDays(o)),n=absFloor(s/12),s%=12,l.days=a,l.months=s,l.years=n,this}function daysToMonths(e){return 4800*e/146097}function monthsToDays(e){return 146097*e/4800}function as(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if("month"===(e=normalizeUnits(e))||"quarter"===e||"year"===e)switch(t=this._days+n/864e5,r=this._months+daysToMonths(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(monthsToDays(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return 24*t+n/36e5;case"minute":return 1440*t+n/6e4;case"second":return 86400*t+n/1e3;case"millisecond":return Math.floor(864e5*t)+n;default:throw new Error("Unknown unit "+e)}}function valueOf$1(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*toInt(this._months/12):NaN}function makeAs(e){return function(){return this.as(e)}}var asMilliseconds=makeAs("ms"),asSeconds=makeAs("s"),asMinutes=makeAs("m"),asHours=makeAs("h"),asDays=makeAs("d"),asWeeks=makeAs("w"),asMonths=makeAs("M"),asQuarters=makeAs("Q"),asYears=makeAs("y");function clone$1(){return createDuration(this)}function get$2(e){return e=normalizeUnits(e),this.isValid()?this[e+"s"]():NaN}function makeGetter(e){return function(){return this.isValid()?this._data[e]:NaN}}var milliseconds=makeGetter("milliseconds"),seconds=makeGetter("seconds"),minutes=makeGetter("minutes"),hours=makeGetter("hours"),days=makeGetter("days"),months=makeGetter("months"),years=makeGetter("years");function weeks(){return absFloor(this.days()/7)}var round=Math.round,thresholds={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function substituteTimeAgo(e,t,r,n,o){return o.relativeTime(t||1,!!r,e,n)}function relativeTime$1(e,t,r,n){var o=createDuration(e).abs(),i=round(o.as("s")),a=round(o.as("m")),s=round(o.as("h")),l=round(o.as("d")),c=round(o.as("M")),u=round(o.as("w")),d=round(o.as("y")),h=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||a<=1&&["m"]||a<r.m&&["mm",a]||s<=1&&["h"]||s<r.h&&["hh",s]||l<=1&&["d"]||l<r.d&&["dd",l];return null!=r.w&&(h=h||u<=1&&["w"]||u<r.w&&["ww",u]),(h=h||c<=1&&["M"]||c<r.M&&["MM",c]||d<=1&&["y"]||["yy",d])[2]=t,h[3]=+e>0,h[4]=n,substituteTimeAgo.apply(null,h)}function getSetRelativeTimeRounding(e){return void 0===e?round:"function"==typeof e&&(round=e,!0)}function getSetRelativeTimeThreshold(e,t){return void 0!==thresholds[e]&&(void 0===t?thresholds[e]:(thresholds[e]=t,"s"===e&&(thresholds.ss=t-1),!0))}function humanize(e,t){if(!this.isValid())return this.localeData().invalidDate();var r,n,o=!1,i=thresholds;return"object"==typeof e&&(t=e,e=!1),"boolean"==typeof e&&(o=e),"object"==typeof t&&(i=Object.assign({},thresholds,t),null!=t.s&&null==t.ss&&(i.ss=t.s-1)),n=relativeTime$1(this,!o,i,r=this.localeData()),o&&(n=r.pastFuture(+this,n)),r.postformat(n)}var abs$1=Math.abs;function sign(e){return(e>0)-(e<0)||+e}function toISOString$1(){if(!this.isValid())return this.localeData().invalidDate();var e,t,r,n,o,i,a,s,l=abs$1(this._milliseconds)/1e3,c=abs$1(this._days),u=abs$1(this._months),d=this.asSeconds();return d?(e=absFloor(l/60),t=absFloor(e/60),l%=60,e%=60,r=absFloor(u/12),u%=12,n=l?l.toFixed(3).replace(/\.?0+$/,""):"",o=d<0?"-":"",i=sign(this._months)!==sign(d)?"-":"",a=sign(this._days)!==sign(d)?"-":"",s=sign(this._milliseconds)!==sign(d)?"-":"",o+"P"+(r?i+r+"Y":"")+(u?i+u+"M":"")+(c?a+c+"D":"")+(t||e||l?"T":"")+(t?s+t+"H":"")+(e?s+e+"M":"")+(l?s+n+"S":"")):"P0D"}var proto$2=Duration.prototype;function convertNumRefToUnicodeCodePoints(e,t){const r=e.split(";");return r.pop(),r.map((e=>parseInt(e.replace(/^&#x?/,""),t)))}function convertUnicodeCodePointsToUtf16Codes(e){const t=[];for(let r=0;r<e.length;++r){const n=e[r];if(n<65536)t.push(n);else{const e=(n-65536)/1024+55296,r=n%1024+56320;t.push(e),t.push(r)}}return t}function convertUtf16CodesToString(e){let t="";for(let r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t}function convertUnicodeCodePointsToString(e){return convertUtf16CodesToString(convertUnicodeCodePointsToUtf16Codes(e))}function unescapeFromNumRef(e,t){return convertUnicodeCodePointsToString(convertNumRefToUnicodeCodePoints(e,t))}function format(e,t){let r=e;for(const n in t)if(t.hasOwnProperty(n)){const o=new RegExp("{".concat(n,"}"),"g");r=e.replace(o,t[n])}return r}function leftPad$1(e,t,r){let n=String(e);for(;n.length<t;)n=(r||" ")+n;return n.toString()}function convert123ToABC(e){const t=e/26-1,r=e%26;return t<0?String.fromCharCode(65+r):convert123ToABC(t)+String.fromCharCode(65+r)}function checkEmail(e){return/^[a-zA-Z0-9_#&-]+(\.[a-zA-Z0-9_#&-]+)*@([a-zA-Z0-9_-]+)+(\.[a-zA-Z0-9_-]+)+$/.test(e)}function checkPhone(e){return/^1[0-9]{10}$/.test(e)}function escapeSpace(e){return e.replace(/\s/g," ")}function escapeSpecialChar(e){return e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}function isNumeric(e){const t=typeof e;return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))}proto$2.isValid=isValid$1,proto$2.abs=abs,proto$2.add=add$1,proto$2.subtract=subtract$1,proto$2.as=as,proto$2.asMilliseconds=asMilliseconds,proto$2.asSeconds=asSeconds,proto$2.asMinutes=asMinutes,proto$2.asHours=asHours,proto$2.asDays=asDays,proto$2.asWeeks=asWeeks,proto$2.asMonths=asMonths,proto$2.asQuarters=asQuarters,proto$2.asYears=asYears,proto$2.valueOf=valueOf$1,proto$2._bubble=bubble,proto$2.clone=clone$1,proto$2.get=get$2,proto$2.milliseconds=milliseconds,proto$2.seconds=seconds,proto$2.minutes=minutes,proto$2.hours=hours,proto$2.days=days,proto$2.weeks=weeks,proto$2.months=months,proto$2.years=years,proto$2.humanize=humanize,proto$2.toISOString=toISOString$1,proto$2.toString=toISOString$1,proto$2.toJSON=toISOString$1,proto$2.locale=locale,proto$2.localeData=localeData,proto$2.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",toISOString$1),proto$2.lang=lang,addFormatToken("X",0,0,"unix"),addFormatToken("x",0,0,"valueOf"),addRegexToken("x",matchSigned),addRegexToken("X",matchTimestamp),addParseToken("X",(function(e,t,r){r._d=new Date(1e3*parseFloat(e))})),addParseToken("x",(function(e,t,r){r._d=new Date(toInt(e))})),hooks.version="2.29.4",setHookCallback(createLocal),hooks.fn=proto$1,hooks.min=min,hooks.max=max$2,hooks.now=now$1,hooks.utc=createUTC,hooks.unix=createUnix,hooks.months=listMonths,hooks.isDate=isDate$1,hooks.locale=getSetGlobalLocale,hooks.invalid=createInvalid,hooks.duration=createDuration,hooks.isMoment=isMoment,hooks.weekdays=listWeekdays,hooks.parseZone=createInZone,hooks.localeData=getLocale,hooks.isDuration=isDuration,hooks.monthsShort=listMonthsShort,hooks.weekdaysMin=listWeekdaysMin,hooks.defineLocale=defineLocale,hooks.updateLocale=updateLocale,hooks.locales=listLocales,hooks.weekdaysShort=listWeekdaysShort,hooks.normalizeUnits=normalizeUnits,hooks.relativeTimeRounding=getSetRelativeTimeRounding,hooks.relativeTimeThreshold=getSetRelativeTimeThreshold,hooks.calendarFormat=getCalendarFormat,hooks.prototype=proto$1,hooks.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const strUtils={format:format,convertNumRefToUnicodeCodePoints:convertNumRefToUnicodeCodePoints,convertUnicodeCodePointsToUtf16Codes:convertUnicodeCodePointsToUtf16Codes,convertUtf16CodesToString:convertUtf16CodesToString,convertUnicodeCodePointsToString:convertUnicodeCodePointsToString,unescapeFromNumRef:unescapeFromNumRef,leftPad:leftPad$1,convert123ToABC:convert123ToABC,checkEmail:checkEmail,checkPhone:checkPhone,escapeSpace:escapeSpace,escapeSpecialChar:escapeSpecialChar,isNumeric:isNumeric},leftPad=strUtils.leftPad;function getTimezone(){return this.toString().replace(/^.* (?:\((.*)\)|([A-Z]{1,4})(?:[\-+][0-9]{4})?(?: -?\d+)?)$/,"$1$2").replace(/[^A-Z]/g,"")}function compileJFmt(e,t){var r=e.str,n=e.len;switch(e.char){case"E":r=t.getDay();break;case"y":r=n<=3?(t.getFullYear()+"").slice(2,4):t.getFullYear();break;case"M":r=t.getMonth()+1,2===n&&(r=leftPad(r+"",2,"0"));break;case"d":r=n>1?leftPad(t.getDate()+"",2,"0"):t.getDate();break;case"h":var o=t.getHours()%12;0===o&&(o=12),r=n>1?leftPad(o+"",2,"0"):o;break;case"H":r=n>1?leftPad(t.getHours()+"",2,"0"):t.getHours();break;case"m":r=n>1?leftPad(t.getMinutes()+"",2,"0"):t.getMinutes();break;case"s":r=n>1?leftPad(t.getSeconds()+"",2,"0"):t.getSeconds();break;case"a":r=t.getHours()<12?"am":"pm";break;case"z":r=getTimezone();break;default:r=e.str}return r}function i18nText(e){var t="";t||(t=e);var r=arguments.length;if(r>1)for(var n=1;n<r;n++){t=replaceAll(t,e="{R"+n+"}",arguments[n]+"")}return t}function replaceAll(e,t,r){return e.split(t).join(r)}i18nText("FR-Base_January"),i18nText("FR-Base_February"),i18nText("FR-Base_March"),i18nText("FR-Base_April"),i18nText("FR-Base_May"),i18nText("FR-Base_June"),i18nText("FR-Base_July"),i18nText("FR-Base_August"),i18nText("FR-Base_September"),i18nText("FR-Base_October"),i18nText("FR-Base_November"),i18nText("FR-Base_December");const patterns={ISO8601Long:"Y-m-d H:i:s",ISO8601Short:"Y-m-d",ShortDate:"n/j/Y",LongDate:"l, F d, Y",FullDateTime:"l, F d, Y g:i:s A",MonthDay:"F d",ShortTime:"g:i A",LongTime:"g:i:s A",SortableDateTime:"Y-m-d\\TH:i:s",UniversalSortableDateTime:"Y-m-d H:i:sO",YearMonth:"F, Y"};function dateTransform(e){var t,r=(""+e).replace(/[-.]/g,"/"),n=new Date(Date.parse(r));if(!isNull(n)&&!isInvalidDate(n))return n;var o=r.split(" "),i=o[0],a=i.indexOf("/"),s=i.lastIndexOf("/");if(-1!==a&&a===s){var l=+i.substr(0,a);if(isNaN(l))return n;if(t=l>0&&l<=12?"2001/"+i:i+"/01",o.length>1)for(var c=1;c<o.length;c++)t=t+" "+o[c];return new Date(t)}return n}function isInvalidDate(e){return isNull(e)||"Invalid Date"==e||"NaN"==e}function isNull(e){return null==e||null==e}Date.y2kYear=50,Date.monthNumbers={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11};const dateUtils={compileJFmt:compileJFmt,dateTransform:dateTransform,isInvalidDate:isInvalidDate,patterns:patterns};function contentFormat(e,t){if(isEmpty$2(e))return"";var r=e.toString();if(isEmpty$2(t))return r;if(t.match(/^T/))return r;if(t.match(/^D/)){if(e instanceof Date||(e="number"==typeof e?new Date(e):dateUtils.dateTransform(r)),!dateUtils.isInvalidDate(e)){var n=t.match(/^DT/);r=date2Str(e,t.substring(n?2:1))}}else r=t.match(/E/)?_eFormat(r,t):_numberFormat(r,t);return r=r.replace(new RegExp("¤","g"),"￥")}function _dealNumberPrecision(e,t){if(/[eE]/.test(e)){var r,n=0,o=0;/[%‰]$/.test(t)&&(n=/[%]$/.test(t)?2:3);for(var i=t.length;o<i;o++)"0"!=(r=t.charAt(o))&&"#"!=r||n++;return Number(e).toFixed(n)}return e}function _numberFormat(e,t){if(!/[0-9]/.test(e=e+"")||!t)return e;var r=t.indexOf(";");if(r>-1)return e>=0?_numberFormat(e+"",t.substring(0,r)):_numberFormat(-e+"",t.substr(r+1));if(+e<0&&"-"!==t.charAt(0))return _numberFormat(-e+"","-"+t);var n=t.split("."),o=n[0]||"",i=n[1]||"",a=(e=_dealNumberPrecision(e,i)).split("."),s=a[0]||"",l=a[1]||"";if(/[%‰]/.test(t)){var c=/[%]/.test(t)?"00":"000";s="-"===(s+=(l+=c).substr(0,c.length)).charAt(0)?s.replace(/^-0+/gi,"-"):s.replace(/^0+/gi,""),l=l.substr(c.length).replace(/0+$/gi,"")}var u=_dealWithRight(l,i);u.leftPlus&&(s=parseInt(s)+1+"",s=isNaN(s)?"1":s),u=u.num;var d=_dealWithLeft(s,o);return/[0-9]/.test(d)||(d+="0"),/[0-9]/.test(u)?d+"."+u:d+u}function _eFormat(e,t){return function(e,t){var r=e<0?(e*=-1,"-"):"",n="",o=Math[e>0&&e<1?"ceil":"floor"](Math.log10(e));if(!isFinite(o))return t.replace(/#/gi,"").replace(/\.e/gi,"E");(e/=Math.pow(10,o))>0&&e<1&&(e*=10,o-=1);var i=function(e){if(!/e/gi.test(e))return 0;return e.split(/e/gi)[0].split(".")[0].length}(t);i>1&&(o-=i-1,e*=Math.pow(10,i-1)),o<0&&(n="-",o*=-1);var a=function(e){if(!/e/gi.test(e))return 0;var t=e.split(/e/gi)[0].split(".");return t.length>1?t[1].length:0}(t),s=function(e){var t=Math.round(e);return e=(e+"").split(".")[0],t=(t+"").split(".")[0],e.length!==t.length}(e);return e*=Math.pow(10,a),e=Math.round(e),s&&(e/=10,o+="-"===n?-1:1),e=(e/=Math.pow(10,a)).toFixed(a),o=function(e,t,r){if(t+="",!/e/gi.test(e))return t;e=e.split(/e/gi)[1];for(;t.length<e.length;)t="0"+t;for(var n=!0,o=0,i=t.length;o<i;o++)n&&(n="0"===t.charAt(o));return(r=n?"":r)+t}(t,o,n),r+e+"E"+o}(e=+e,t)}function _dealWithRight(e,t){for(var r="",n=0,o=0,i=t.length;o<i;o++){var a=t.charAt(o),s=e.charAt(n);switch(a){case"0":isEmpty$2(s)&&(s="0"),r+=s,n++;break;case"#":r+=s,n++;break;default:r+=a}}var l=e.substr(n),c={};if(!isEmpty$2(l)&&l.charAt(0)>4){c.leftPlus=!0;var u=r.match(/^[0-9]+/);if(u){var d=u[0],h=d.length,p=parseInt(d)+1+"";p.length>h?p=p.substr(1):(p=strUtils.leftPad(p,h,"0"),c.leftPlus=!1),r=r.replace(/^[0-9]+/,p)}}return c.num=r,c}function _dealWithLeft(e,t){for(var r="",n=e.length-1,o=-1,i=-1,a=t.length-1;a>=0;a--){var s=t.charAt(a),l=e.charAt(n);switch(s){case"0":isEmpty$2(l)&&(l="0"),i=-1,r=l+r,n--;break;case"#":i=a,r=l+r,n--;break;case",":if(!isEmpty$2(l)){var c=t.match(/,[#0]+/);c&&(o=c[0].length-1),r=","+r}break;default:r=s+r}}if(i>-1){var u=e.substr(0,n+1);r=r.substr(0,i)+u+r.substr(i)}if(o>0){var d=r.match(/[0-9]+,/);if(d){for(var h="",p=(d=d[0]).length-1-o;p>=0;p-=o)h=d.substr(p,o)+","+h;var f=d.substr(0,p+o);isEmpty$2(f)||(h=f+","+h)}r=r.replace(/[0-9]+,/,h)}return r}function isEmpty$2(e){return""===e||null==e}function date2Str(e,t){if(!e)return"";var r=t.length,n="";if(r>0){for(var o=t.charAt(0),i=0,a=o,s=1;s<r;s++){var l=t.charAt(s);o!==l?(n+=dateUtils.compileJFmt({char:o,str:a,len:s-i},e),i=s,a=o=l):a+=l}n+=dateUtils.compileJFmt({char:o,str:a,len:r-i},e)}return n}const formatUtils={contentFormat:contentFormat,date2Str:date2Str},SORT_RULE={ASCEND:1,DESCEND:2,NO_SORT:0},DEFAULT_COLOR="#212122";class SortHeaderModel{constructor(e,t,r){this.sortHeader=e||{},this.ecName=t,this.externals=r}toNativeJson(){const{sortItemType:e=SORT_RULE.NO_SORT,sortItems:t}=this.sortHeader,r=t.find((t=>t.type===e));return{iconName:this.getSortIconName(),iconColor:(null==r?void 0:r.iconColor)||DEFAULT_COLOR}}getSortIconName(){switch(this.sortHeader.sortItemType){case SORT_RULE.ASCEND:return"fdm-order-ascending";case SORT_RULE.DESCEND:return"fdm-order-descending";case SORT_RULE.NO_SORT:default:return"fdm-order-no"}}hasSortHeader(){return get$5(this.sortHeader,"sortItems.length",0)>0&&void 0!==this.sortHeader.sortItemType}handleHeaderSort(){if(!this.hasSortHeader())return;const{sortItemType:e,sortItems:t}=this.sortHeader;let r=0;if(1===t.length&&t[0].type===e)return;if(t.length>=2){r=(t.findIndex((t=>t.type===e))+1)%t.length}const n=Object.assign(Object.assign({},this.sortHeader),{sortRule:t[r].description,reportBlock:this.ecName||""});return this.externals.headerSortFetcher(n)}}const emptyJsApi=function(){};function createMultiRowColJSContainer(e,t,r){let n=[],o=0,i=0;const{col:a,row:s,colSpan:l,rowSpan:c}=t;switch(r){case"column":o=a,i=a+l-1;break;case"row":o=s,i=s+c-1}for(let u=0;u<i-o+1;u++){let t="column"===r?e.getColumn(o+u+1):e.getRow(o+u+1);n.push(t)}return Object.assign(Object.assign({},n),{getWidth:()=>n.map((e=>e.getWidth())),getHeight:()=>n.map((e=>e.getHeight())),getIndex:()=>n.map((e=>e.getIndex())),getCell:e=>n.map((t=>t.getCell(e))),setStyle:e=>n.map((t=>t.setStyle(e))),setHeight:emptyJsApi,setWidth:emptyJsApi,showToolTip:emptyJsApi})}function isColor$3(e){return!(!e||!isRGBColor(e)&&!isHexColor(e))}function isNonTransparentColor(e){return"transparent"!==e&&isColor$3(e)}function transformNumber2Hex(e){if(isString$3(e))return e;if(!e)return"#000";const t=(~e).toString(16),r=parseInt("0x".concat(t.replace(/#/g,"")),16),n="000000".concat((16777215-r).toString(16));return"#".concat(n.substring(n.length-6,n.length))}function isDarkColor(e){if("transparent"===e)return!0;if(!e||!isColor$3(e))return!1;const t=rgb2json(color2rgb(e));if(isUndefined$3(t.r)||isUndefined$3(t.g)||isUndefined$3(t.b))return!1;return Math.round(.299*t.r+.587*t.g+.114*t.b)<192}function isLightColor(e){return!isDarkColor(e)}function isHexColor(e){if(!e)return!1;return/^#([0-9A-F]{3}){1,2}$/i.test(e)}function isRGBColor(e){return!!e&&"rgb"===e.substr(0,3)}function isRgbaColor(e){if(isNil$3(e))return!1;if("rgba"!==e.substr(0,4))return!1;const t=e.match(/\d+(\.\d+)?/g);if(!t||t.length<4)return!1;const r=parseFloat(t[0]),n=parseFloat(t[1]),o=parseFloat(t[2]),i=parseFloat(t[3]);return _isNumber(r)&&_isNumber(n)&&_isNumber(o)&&_isNumber(i)}function rgb2json(e){if(!e)return{};const t=e.match(/\d+(\.\d+)?/g);return t?{r:Number.parseInt(t[0]),g:Number.parseInt(t[1]),b:Number.parseInt(t[2])}:{}}function rgba2json(e){const t=null==e?void 0:e.match(/rgba?\((\d{1,3}), ?(\d{1,3}), ?(\d{1,3})\)?(?:, ?(\d(?:\.?\d?))\))?/);return t?{r:parseInt(t[1]),g:parseInt(t[2]),b:parseInt(t[3]),a:parseFloat(t[4])}:{}}function hex2json(e){const t=e&&/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{}}function hex2rgb(e){if(!e)return"";if(!isHexColor(e))return"rgb(0,0,0)";let t="rgb(",r=[];return 7===e.length?r=[Number.parseInt("0x".concat(e.substring(1,3))),Number.parseInt("0x".concat(e.substring(3,5))),Number.parseInt("0x".concat(e.substring(5,7)))]:4===e.length&&(r=[Number.parseInt("0x".concat(e.substring(1,2))),Number.parseInt("0x".concat(e.substring(2,3))),Number.parseInt("0x".concat(e.substring(3,4)))]),t+="".concat(r[0],","),t+="".concat(r[1],","),t+="".concat(r[2],")"),t}function parseHEXAlpha(e,t){if(!isHexColor(e))return e;const r=rgb2json(hex2rgb(e));return r.a=t,json2rgba(r)}function json2rgba(e){return isKey$1(e.r)&&isKey$1(e.g)&&isKey$1(e.b)?"rgba(".concat(e.r,",").concat(e.g,",").concat(e.b,",").concat(e.a,")"):""}function getDefaultFontColor(){return"#1a1a1a"}function rgba2rgb(e,t){if(!e)return"";if(isNil$3(t)&&(t=1),"rgba"!==e.substr(0,4))return"";const r=e.match(/\d+(\.\d+)?/g);if(!r||r.length<4)return"";const n=parseFloat(r[0]),o=parseFloat(r[1]),i=parseFloat(r[2]),a=parseFloat(r[3]);return"rgb(".concat(Math.floor(t*(1-a)*255+n*a),",").concat(Math.floor(t*(1-a)*255+o*a),",").concat(Math.floor(t*(1-a)*255+i*a),")")}function color2Rgba(e,t){if(!e)return"";if(!isColor$3(e))return e;const r=rgb2json(isRGBColor(e)?e:hex2rgb(e));return r.a=t,json2rgba(r)}function color2rgb(e){return isRGBColor(e)?e:isRgbaColor(e)?rgba2rgb(e):isHexColor(e)?hex2rgb(e):""}function color2hsb(e){if(!e)return"";let t=[];if("rgb"===e.substr(0,3)){const r=e.match(/\d+(\.\d+)?/g);if(!r)return"";t=r.length<3?[255,255,255]:[parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2])]}else 7===e.length?t=[Number.parseInt("0x".concat(e.substring(1,3))),Number.parseInt("0x".concat(e.substring(3,5))),Number.parseInt("0x".concat(e.substring(5,7)))]:4===e.length&&(t=[Number.parseInt("0x".concat(e.substring(1,2))),Number.parseInt("0x".concat(e.substring(2,3))),Number.parseInt("0x".concat(e.substring(3,4)))]);const r=t[0],n=t[1],o=t[2];t.sort((function(e,t){return e-t}));const i=t[2],a=t[0];let s=0;return i===a?s=0:i===r&&n>=o?s=60*(n-o)/(i-a)+0:i===r&&n<o?s=60*(n-o)/(i-a)+360:i===n?s=60*(o-r)/(i-a)+120:i===o&&(s=60*(r-n)/(i-a)+240),[s,0===i?0:(i-a)/i,i/255]}function hsb2hex(e,t,r){if(e<0||e>360)return"";(t<0||t>1)&&(t=t<0?0:1),(r<0||r>1)&&(r=r<0?0:1);let n=0,o=0,i=0;const a=Math.floor(e/60%6),s=e/60-a,l=r*(1-t),c=r*(1-s*t),u=r*(1-(1-s)*t);switch(a){case 0:n=r,o=u,i=l;break;case 1:n=c,o=r,i=l;break;case 2:n=l,o=r,i=u;break;case 3:n=l,o=c,i=r;break;case 4:n=u,o=l,i=r;break;case 5:n=r,o=l,i=c}const d=[Math.floor(255*n),Math.floor(255*o),Math.floor(255*i)];return"#".concat(h(d[0].toString(16))).concat(h(d[1].toString(16))).concat(h(d[2].toString(16)));function h(e){return e.length<2&&(e="0".concat(e)),e}}function isKey$1(e){return _isNumber(e)||isString$3(e)&&e.length>0}const colorUtils={isColor:isColor$3,isNonTransparentColor:isNonTransparentColor,isDarkColor:isDarkColor,isLightColor:isLightColor,isHexColor:isHexColor,isRGBColor:isRGBColor,isRgbaColor:isRgbaColor,hex2rgb:hex2rgb,parseHEXAlpha:parseHEXAlpha,json2rgba:json2rgba,getDefaultFontColor:getDefaultFontColor,rgba2rgb:rgba2rgb,color2Rgba:color2Rgba,color2rgb:color2rgb,color2hsb:color2hsb,hsb2hex:hsb2hex,rgba2json:rgba2json,rgb2json:rgb2json,hex2json:hex2json,transformNumber2Hex:transformNumber2Hex};function compatEffectParams(){if(2===arguments.length){const e=arguments[0],t=arguments[1],{color:r,single:n=!1,style:o}=t;switch(e){case"highlightRow":return{target:"row",effect:{background:r},single:n};case"highlightCol":return{target:"column",effect:{background:r},single:n};case"highlightCross":return{target:"columnRow",effect:{background:r},single:n};case"highlightCell":return{target:"cell",effect:{background:r},single:n};case"setCellFont":return{target:"cell",effect:o,single:n};case"setRowFont":return{target:"row",effect:o,single:n};default:return{}}}return arguments[0]}function cellStyleTransform(e){const{verticalAlign:t,textAlign:r}=e,n=transformCellFont(e),o=transformCellBorder(e),i=transformCellPadding(e),a=transformCellBackground(e);return omitBy$1({font:n,border:o,padding:i,background:a,verticalAlign:t,horizontalAlign:r},isEmpty$3)}function transformCellBackground({background:e}){if(colorUtils.isColor(e))return{type:"color",value:e}}function transformCellFont(e){const{color:t,fontSize:r,textDecorationLine:n}=e,o={};return t&&(o.color=t),isNil$3(r)||(o.size=r),n&&(o[n]=!0),o}function transformCellBorder(e){const{border:t,borderTop:r,borderRight:n,borderBottom:o,borderLeft:i}=e;let a={};if(t){const e=transformCssBorder(t);a.top=e,a.right=e,a.bottom=e,a.left=e}return r&&(a.top=transformCssBorder(r)),n&&(a.right=transformCssBorder(n)),o&&(a.bottom=transformCssBorder(o)),i&&(a.left=transformCssBorder(i)),a}function transformCssBorder(e=""){const t=(e+"").split(" ");return{width:getIntValue(t[0]),type:t[1],color:t[2]}}function transformCellPadding(e){const{padding:t,paddingTop:r,paddingRight:n,paddingBottom:o,paddingLeft:i}=e;let a={};return t&&(a.top=t,a.right=t,a.bottom=t,a.left=t),r&&(a.top=r),n&&(a.right=n),o&&(a.bottom=o),i&&(a.left=i),a}function getIntValue(e){return parseInt(e.toString(),10)}class ReportCellJSApiContainer{constructor(e,t){this.showToolTip=emptyJsApi,this.model=e,this.reportApi=t}getValue(){var e,t;return null===(t=(e=this.model).getCellText)||void 0===t?void 0:t.call(e)}getPosition(){const e=this.model.getPosition();return[e.row+1,e.col+1]}getColumn(){return createMultiRowColJSContainer(this.reportApi,this.model.getPosition(),"column")}getRow(){return createMultiRowColJSContainer(this.reportApi,this.model.getPosition(),"row")}setStyle(e){const t=cellStyleTransform(e);this.model.updateCellStyle(t)}}class AbstractHyperlink{constructor(e={},t,r){this.rawData=e,this.type=e.type,this.name=e.name,this.hander=t,this.owneridgetModel=r}init(){}execute(){}getData(){return this.rawData}getOwnerWidgetModel(){return this.owneridgetModel}getType(){return this.type}getName(){return this.name}}const DEFAULT_RESERVED_KEYS=["op","cmd","reportlet","formlet"];function removeReservedKeysFrom(e,t){return omit$1(e,DEFAULT_RESERVED_KEYS)}class ChartRelateHyperlink extends AbstractHyperlink{init(){const{relateName:e,parameters:t,isCell:r}=this.rawData;this.relateName=e,this.parameters=removeReservedKeysFrom(t),this.isCell=r}execute(){if(this.isCell){const e=this.getOwnerWidgetModel();let t=Object.assign(Object.assign({},this.parameters),{relateName:this.relateName,sheetIndex:e.position&&e.position.sheetIndex||0,ecName:e&&e.ecName?e.ecName:""});e.singlePageDecider.fireChartRelatedMessage(t)}}directExecution(){return!0}}const Hyperlinks={},registerHyperlink=(e,t)=>{Hyperlinks[e]=t},HYPERLINK={WEB_LINK:"weblink",WEB:"web",REPORT:"report",EMAIL:"email",JAVASCRIPT:"javascript",WIDGET:"widget",CHART_RELATE:"chartRelate",DYNAMIC:"dynamic",DRILL:"drill",MOBILE_POPUP:"mobilepopup",DOWNLOAD:"download",VIEWLET:"viewlet",WEBLINK:"weblink",PARAMETER:"parameter",FORM_HYPERLINK:"formHyperlink",UNKNOWN:"unknown"},DefaultHyperlinks={[HYPERLINK.CHART_RELATE]:ChartRelateHyperlink};Object.keys(HYPERLINK).forEach((e=>{registerHyperlink(e,{execute:()=>{},init:()=>{}})}));class CustomHyperlink extends AbstractHyperlink{constructor(e,t){super(e),this.init=t.init,this.execute=t.execute,this.directExecution=t.directExecution}}const DEFAULT_HYPERLINK_TRANSFORM_DATA_TYPE={web:[transformHyperlinkWeb,transformNewHyperlinkWeb],report:[transformHyperlinkWeb,transformNewHyperlinkWeb],email:[transformHyperlinkEmail,transformNewHyperlinkEmail],javascript:[transformHyperlinkJavaScript,transformNewHyperlinkJavaScript],widget:[transformHyperlinkWidget,transformNewHyperlinkWidget],chartRelate:[transformHyperlinkChartRelate,transformNewHyperlinkChartRelate],dynamic:[transformHyperlinkDynamic,transformNewHyperlinkDynamic],viewlet:[transformHyperlinkWeb,transformNewHyperlinkWeb],weblink:[transformHyperlinkWeb,transformNewHyperlinkWeb],parameter:[transformHyperlinkDynamic,transformNewHyperlinkDynamic],formHyperlink:[transformHyperlinkWidget,transformNewHyperlinkWidget],mobilepopup:[transformHyperlinkMobilePopup,transformNewHyperlinkMobilePopup]};function transformHyperlinkData(e,t){let r={};r.name=e.name,r.type=get$5(e,t?"javaScript.type":"type");let n=DEFAULT_HYPERLINK_TRANSFORM_DATA_TYPE[r.type];return n?(n[t?1:0].call(null,r,e,t),r):e}function transformHyperlinkJavaScript(e,t){e.script=";return eval("+get$5(t,"script")+");"}function transformNewHyperlinkJavaScript(e,t){e.script=get$5(t,"javaScript.jsContent")}function transformHyperlinkWeb(e,t){e.method=get$5(t,"data","").indexOf("doHyperlinkByPost")>0?"POST":"GET",e.reportlet=get$5(t,"reportlet"),e.url=get$5(t,"url"),e.__pi__=get$5(t,"__pi__"),e.target=get$5(t,"target"),e.parameters=get$5(t,"parameters")}function transformNewHyperlinkWeb(e,t){e.method=get$5(t,"javaScript.byPost")?"POST":"GET",e.reportlet=get$5(t,"javaScript.reportPath"),e.url=get$5(t,"javaScript.url"),e.__pi__=get$5(t,"javaScript.showParameterInterface"),e.target=get$5(t,"javaScript.targetFrame"),e.extendParameters=get$5(t,"javaScript.extendParameters"),e.parameters=transformNewParameters(get$5(t,"javaScript.parameters"))}function transformHyperlinkEmail(e,t){e.mailText=get$5(t,"mailText"),e.mailTo=get$5(t,"mailTo"),e.showTplContent=get$5(t,"showTplContent"),e.title=get$5(t,"title"),e.cc=get$5(t,"cc"),e.bcc=get$5(t,"bcc")}function transformNewHyperlinkEmail(e,t){e.mailText=get$5(t,"javaScript.mailText"),e.mailTo=get$5(t,"javaScript.mailTo"),e.showTplContent=get$5(t,"javaScript.showTplContent"),e.title=get$5(t,"javaScript.title"),e.bcc=get$5(t,"javaScript.bcc"),e.cc=get$5(t,"javaScript.cc")}function transformHyperlinkDynamic(e,t){e.parameters=get$5(t,"parameters")}function transformNewHyperlinkDynamic(e,t){e.parameters=transformNewParameters(get$5(t,"javaScript.parameters"))}function transformHyperlinkWidget(e,t){e.related=get$5(t,"related"),e.parameters=get$5(t,"parameters")}function transformNewHyperlinkWidget(e,t){e.related=get$5(t,"javaScript.relatedEditorName"),e.parameters=transformNewParameters(get$5(t,"javaScript.parameters"))}function transformHyperlinkChartRelate(e,t){e.relateName=get$5(t,"relateName"),e.isCell=get$5(t,"isCell"),e.parameters=get$5(t,"parameters")}function transformNewHyperlinkChartRelate(e,t){e.relateName=get$5(t,"javaScript.relateCCName"),e.isCell=get$5(t,"javaScript.relateCell"),e.parameters=transformNewParameters(get$5(t,"javaScript.parameters"))}function transformNewHyperlinkMobilePopup(e,t){const r=get$5(t,"javaScript",{});Object.assign(e,r)}function transformHyperlinkMobilePopup(e,t){Object.assign(e,t)}function transformNewParameters(e){let t={};return e.map((e=>t[e.name]=e.value)),t}function transformHyperlinksData(e){return get$5(e,"nxNameJavascriptGroup.javaScriptGroup")||(isEmpty$3(e)?[]:e)}function createPrimitiveHyperlink(e,t,r){var n;const o=transformHyperlinkData(e,t),i=o.type,a=(null===(n=r.linkConfig)||void 0===n?void 0:n[i])||Hyperlinks[i];if(a)return new CustomHyperlink(o,a,r);const s=DefaultHyperlinks[i];if(s)return new s(o,{},r);const l=Hyperlinks[HYPERLINK.UNKNOWN];return l?new CustomHyperlink(o,l,r):void 0}function createHyperlinks(e,t){return __awaiter(this,void 0,void 0,(function*(){const r=[],n=!isEmpty$3(e)&&!isUndefined$3(e.nxNameJavascriptGroup);e=transformHyperlinksData(e);for(const o of e){const e=createPrimitiveHyperlink(o,n,t);e&&(r.push(e),yield e.init(e.getData()))}return r}))}class BaseReportCellModel{constructor(e,t){this.fireValueChangeRequest=()=>this.singlePageDecider.fireValueLinkedCellsChange(this.position);const{position:r,style:n,formula:o,present:i,format:a,del:s,previewContent:l,ecName:c,sortHeader:u}=e;this.externals=t,this.position=r,this.formula=o,this.present=i,this.format=a,this.hasDeleted=s,n&&(this.style=new StyleModel(n)),this._text=get$5(e,"content.value.cell.text",""),this.singlePageDecider=null,this.collapse=e.collapse,this.dataTransType=e.dataTransType,this.previewContent=l,this.sortHeaderModel=new SortHeaderModel(u,c,t),this.linksRawData=e.hyperlink}setSinglePageDecider(e){this.singlePageDecider=e,this._initHyperlinks()}_initHyperlinks(){this.linkConfig=this.singlePageDecider.linkConfig,createHyperlinks(this.linksRawData,this).then((e=>this.hyperlinks=e))}getSessionID(){}toNativeJson(){const e={previewContent:this.previewContent};return e.position=this.getPosition(),this._getStyle()&&(e.style=this._getStyle().toNativeJson()),this.hasSortHeader()&&(e.sortHeader=this.sortHeaderModel.toNativeJson()),e}getJSAPI(e){return this.jsApi||(this.jsApi=new ReportCellJSApiContainer(this,e)),this.jsApi}updateCellStyle(e){var t;if(this.isEmpty())return;null===(t=this.style)||void 0===t||t.updateStyle(e);this.singlePageDecider.singlePageModel.updateCell(this.getPosition())}dealWithNativeMessage(e){this.message=e,this.collapse&&this.singlePageDecider.queryClickCollapseCellMessage(this.position.row)}getSortHeaderModel(){return this.sortHeaderModel}hasSortHeader(){return this.sortHeaderModel.hasSortHeader()}handleHeaderSort(){this.sortHeaderModel.handleHeaderSort().then((e=>{this.singlePageDecider.singlePageModel.updateCells(e)}))}getValue(){return this.value}getSubmitValue(){return this.getValue()}setValue(e,t=!1){this.value!==e&&(this.value=e,this.fireDataLinkedCellsChange(),!t&&this.fireValueChange(),this._handleValueForText())}fireDataLinkedCellsChange(){this.singlePageDecider.fireDataLinkedCellsChange(this.getCellLocation())}releaseModel(){}_handleValueForText(){this.refreshCellView()}supportPattern(){return this.present}fireValueChange(){this.singlePageDecider.queryCellFiredMessage(this)}generateCellsSubmitData(){return"json"===this.singlePageDecider.dataTransType?generateSubmitJson4Cells([this],this.position.sheetIndex):generateSubmitXML4Cells([this],this.position.sheetIndex)}_dealWithResponse(e){let t;return t=strUtils.isNumeric(e)&&this.format?formatUtils.contentFormat(e,this.format):isString$3(e)?e:isArray$c(e)?isArray$c(e[0])?e.map((e=>e.join())).join(";"):e.join():e instanceof Date&&this.format?hooks(e).format(this.format.replace(/y/g,"Y").replace(/d/g,"D")):isUndefined$3(e)||isNil$3(e)?"":e.toString(),t}getCellLocation(){return""+strUtils.convert123ToABC(this.position.col)+(this.position.row+1)}refreshCellView(){const{colSpan:e,rowSpan:t}=this.position;e>0&&t>0&&this.singlePageDecider.queryRefreshCellMessage({col:this.position.col,row:this.position.row})}isPreviewContent(){return this.previewContent}_getText(){return this.present?this._text:this._dealWithResponse(this.value)}getPosition(){return this.position}_getStyle(){return this.style}isEmpty(){const{colSpan:e,rowSpan:t}=this.getPosition();return 0===e&&0===t}}function executeHyperlinks(e,t){if(isNil$3(e)||isEmpty$3(e))return;const r=e.filter((e=>{var r;return!(null===(r=e.directExecution)||void 0===r?void 0:r.call(e))||(e.execute(t),!1)}));1===(null==r?void 0:r.length)&&r[0].execute(t),(null==r?void 0:r.length)>1&&Alert.action({title:useConfig().locale.fine.JUMP_TO,actions:r.map((e=>({text:e.getName(),onClick:()=>__awaiter(this,void 0,void 0,(function*(){e.execute(t)}))})))})}const LOAD_STATE={UNLOAD:0,LOADING:1,LOADED:2};class ChartReportCellModel extends BaseReportCellModel{constructor(e,t){super(e,t),this.type="chart",this.loadState=LOAD_STATE.UNLOAD,this.value=null,this.url=get$5(e,"content.value.url",""),this.simpleChartInShowID=e.content.value.simpleChartInShowID,this.ecName=e.ecName||"",this.collapse=null,this.autoRefreshTime=0,this._getContentForLoadOrRefreshConfig=this._getContentForLoadOrRefreshConfig.bind(this)}isUnLoad(){return this.loadState===LOAD_STATE.UNLOAD}hasLoaded(){return this.loadState===LOAD_STATE.LOADED}toNativeJson(){const e=super.toNativeJson();return e.content=this._getContentForLoadOrRefreshConfig(!this.hasLoaded()),e}loadCellData(e){if(this.url)return this.loadState=LOAD_STATE.LOADING,this.externals.chart.chartDataFetcher(this.url,{index:e}).then((e=>(this.setChartAttr(e.chartAttr),this.autoRefreshTime=e.autoRefreshTime||0,this.loadState=LOAD_STATE.LOADED,e))).catch((()=>{this.loadState=LOAD_STATE.UNLOAD}))}dealWithNativeMessage(e){super.dealWithNativeMessage(e);const{type:t,data:r}=e;"hyperlink"===t&&this._dealWithHyperlinkMessage(r)}_dealWithHyperlinkMessage(e){let{dynamicHyperlink:t,drillTypeNeedExecuted:r,hyperlinks:n,drillUpLink:o}=e;t?this.externals.chart.chartHyperLinkFetcher(Object.assign(Object.assign({},t),{chartID:this.simpleChartInShowID})).then((e=>{this._dealWithHyperlink(e)})):this._dealWithHyperlink("up"===r&&o?JSON.parse(o):n)}_disallowFlowEffect(e){return e&&(e.reportType&&delete e.reportType,e.options&&e.options.forEach((e=>{e.reportType&&delete e.reportType}))),e}_forceUseCarouselSwitcher(e){return e&&e.options&&e.switchStyle&&(e.switchStyle.type="carousel"),e}setChartAttr(e){e&&(this.chartAttr=e,this.chartAttr=this._disallowFlowEffect(this.chartAttr),this.chartAttr=this._forceUseCarouselSwitcher(this.chartAttr),this.singlePageDecider.queryRefreshCellMessage({row:this.position.row,col:this.position.col}))}handleNativeChartEvent(e,t){const r=this.generateNativeJSON(e,t);this.singlePageDecider.queryRefreshCellMessage({row:this.position.row,col:this.position.col,nativeJSON:r})}generateNativeJSON(e,t){let r=this.toNativeJson(),n={chartOptions:this._getChartOptions(t.chartAttr,t.index)};return"refreshMobileSubChart"===e?n.action="refreshSubChart":(n.action="trigger",n.data={event:e,data:JSON.stringify(t)}),r.content={value:n,type:this.type},r}setSinglePageDecider(e){super.setSinglePageDecider(e),this.singlePageDecider.registerCellChartRelatedMessage(this)}fireChartRelatedMessage(e){if(0===this.simpleChartInShowID.indexOf("Cells__"+e.relateName)){const t={chartID:this.simpleChartInShowID,__parameters__:e};this.externals.chart.chartRelatedFetcher(t).then((e=>{if(e.relateChartList){let t=e.relateChartList[0];t&&(this.setChartAttr(t.chartAttr),this.singlePageDecider.updateCell(this.toNativeJson()))}}))}}getAllSingleChartIndexArray(){var e;return isArray$c(null===(e=this.chartAttr)||void 0===e?void 0:e.options)?range$1(0,this.chartAttr.options.length):[0]}_dealWithHyperlink(e){e&&createHyperlinks(e,this).then((e=>executeHyperlinks(e)))}_refreshChart(e){return this.externals.chart.chartAutoRefreshFetcher({chartID:this.simpleChartInShowID,index:e,ecName:this.ecName}).then((t=>{this.handleNativeChartEvent("refreshMobileSubChart",{chartAttr:t,index:e})}))}_getContentForLoadOrRefreshConfig(e){let t={options:this.chartAttr||{},refresh:{interval:1e3*this.autoRefreshTime,fetcher:()=>this.externals.chart.chartAutoRefreshFetcher({chartID:this.simpleChartInShowID})}};const r={action:e?"load":"refresh",chartOptions:{chartID:this.simpleChartInShowID,config:t}};return{type:this.type,value:r}}_getChartOptions(e,t){return e||(e=this.chartAttr),{chartID:this.simpleChartInShowID,subChartAttr:e,subChartIndex:t}}showIndexChart(e){this.singlePageDecider.postCellMessage({position:this.position,type:"showIndexChart",data:{index:e}})}getChartWithIndex(e){return{setSeriesVisible:t=>{this.singlePageDecider.postCellMessage({position:this.position,type:"setSeriesVisible",data:{chartSeries:t,index:e}})}}}switchCarouselChart(e){this.singlePageDecider.postCellMessage({position:this.position,type:"switchCarouselChart",data:{direction:e}})}dataRefresh(e=this.getAllSingleChartIndexArray()){isArray$c(e)?e.forEach((e=>{this._refreshChart(e)})):_isNumber(e)?this._refreshChart(e):this._refreshChart(0)}}class TextReportCellModel extends BaseReportCellModel{constructor(e,t){super(e,t),this.ecName=e.ecName,this.type="text",this.present?(this._text=e.content?e.content.value.text:"",this.value=e.content?e.content.value.value:""):(this.value=e.content?e.content.value.value:"",this.text=e.content?e.content.value.text:"",this.useText=!0)}toNativeJson(){const e=super.toNativeJson();return e.content=this._getContent(),e}updateHy(e){}setValue(e,t=!1){this.value!=e&&(this.useText=!1,super.setValue(e,t))}dealWithNativeMessage(e){super.dealWithNativeMessage(e),this.value&&this.value.fileUrl&&this.singlePageDecider.queryClickFileCellMessage(this.position.row,this.position.col),executeHyperlinks(this.hyperlinks,e)}_getContent(){return{value:this._getText(),type:this.type}}_getText(){return this.useText?this.text:super._getText()}getCellText(){return this._getText()}}class HtmlReportCellModel extends BaseReportCellModel{constructor(e,t){super(e,t),this.type="html",this.present?(this._text=e.content?e.content.value.text:"",this.value=e.content?e.content.value.value:""):(this.value=e.content?e.content.value.value:"",this.text=e.content?e.content.value.text:"",this.useText=!0)}setValue(e,t=!1){this.value!=e&&(this.useText=!1,super.setValue(e,t))}toNativeJson(){const e=super.toNativeJson();return e.content=this._getContent(e.style),this._addLineHeight(e.style),this._addClassName(e.style),e}_addLineHeight(e){e.defaultLineHeight=get$5(this.externals,"richText.defaultLineHeight","normal")}_addClassName(e){e.className=get$5(this.externals,"richText.className","")}updateHy(e){}_getContent(e){return this._isEmptyContent()?{value:"",type:"text"}:{value:this._createContentValue(e),type:this.type}}_isEmptyContent(){return isEmpty$3(this._getText())}_createContentValue(e){if(e)return this._getText()}_getText(){return this.useText?this.text:super._getText()}dealWithNativeMessage(e){super.dealWithNativeMessage(e),executeHyperlinks(this.hyperlinks,e)}}class ImageReportCellModel extends BaseReportCellModel{constructor(e,t){super(e,t),this.type=e.content?e.content.type:"image",this.value=e.content?e.content.value.value:""}toNativeJson(){const e=super.toNativeJson();return e.content=this._getContent(),e}dealWithNativeMessage(e){super.dealWithNativeMessage(e),executeHyperlinks(this.hyperlinks,e)}updateHy(e){}setValue(e){}_getContent(){return{value:this.value,type:this.type}}}class BiasReportCellModel extends BaseReportCellModel{constructor(e,t){super(e,t),this.type="bias",this.value=e.content?e.content.value.value:""}toNativeJson(){const e=super.toNativeJson();return e.content=this._getContent(),e}_getContent(){return{value:this.value,type:this.type}}}class ProgressBarCellModel extends TextReportCellModel{constructor(e,t){var r,n,o,i,a;super(e,t),this.text=null!==(o=null===(n=null===(r=e.content)||void 0===r?void 0:r.value)||void 0===n?void 0:n.text)&&void 0!==o?o:"",this.progressBarProps=null===(a=null===(i=e.content)||void 0===i?void 0:i.value)||void 0===a?void 0:a.value}setValue(){}_getContent(){return{value:Object.assign(Object.assign({},this.progressBarProps),{progressBarValue:this.text}),type:"progressbar"}}}let cellTypeMap={chart:ChartReportCellModel,html:HtmlReportCellModel,image:ImageReportCellModel,webimage:ImageReportCellModel,bias:BiasReportCellModel,progressbar:ProgressBarCellModel};function createReportCellModel(e,t){if(e.content){let r=e.content.type;if("widget"===r)return"";if(cellTypeMap[r]){return new(0,cellTypeMap[r])(e,t)}return new TextReportCellModel(e,t)}return new TextReportCellModel(e,t)}const ReportCellModelFactory={createReportCellModel:createReportCellModel},lineType={LINE_NONE:0,LINE_THIN:1,LINE_MEDIUM:2,LINE_DASH:3,LINE_HAIR:4,LINE_THICK:5,LINE_DOUBLE:6,LINE_DOT:7,LINE_MEDIUM_DASH:8,LINE_DASH_DOT:9,LINE_MEDIUM_DASH_DOT:10,LINE_DASH_DOT_DOT:11,LINE_MEDIUM_DASH_DOT_DOT:12,LINE_SLANTED_DASH_DOT:13,LINE_HAIR2:14,LINE_DOUBLE_DOT:15,LINE_LARGE:16,LINE_SLIM:17},PixelValueRadiusType=0,DEFAULT_ROW_HEIGHT$1=19,FIT_TYPE={DEFAULT:0,LANDSCAPE:1,PORTRAIT:2,NONE:3,CROSS:4};function pageDataTransform(e,t){return{style:reportStyleTransform(e,t),frozenInfo:reportFrozenInfoTransform(e,t),sizeInfo:reportSizeInfoTransform(e,t),pageInfo:reportPageInfoTransform(e,t)}}function reportRowInfoTransform(e,t){const r=getReportCellDataRows(e,t),n=initRowInfoWithRowData(r);return dealMergeCellWithRowDataAndRowInfo(r,n),convertRowLevelToStandardLayer(n),n}function initRowInfoWithRowData(e){const t=[];return e.forEach(((e,r)=>{t.push({rowLevel:constants$3.DEFAULT_COLLAPSE_ROW_LEVEL,expand:constants$3.DEFAULT_COLLAPSE_EXPAND,expandAll:constants$3.DEFAULT_COLLAPSE_EXPAND_ALL,subLayerRetain:constants$3.DEFAULT_COLLAPSE_SUBLAYER_RETAIN}),e.cells.reverse().some((e=>{if((null==e?void 0:e.collapse)&&e.collapse.rowLevel>constants$3.DEFAULT_COLLAPSE_ROW_LEVEL){const n=t[r];return n.rowLevel=e.collapse.rowLevel,n.expand=e.collapse.expand,e.collapse.expandAll&&(n.expandAll=!0),e.collapse.subLayerRetain>constants$3.DEFAULT_COLLAPSE_SUBLAYER_RETAIN&&(n.subLayerRetain=e.collapse.subLayerRetain),!0}}))})),t}function convertRowLevelToStandardLayer(e){for(let t=0;t<e.length;t++){const r=e[t];if(r.rowLevel>constants$3.DEFAULT_COLLAPSE_ROW_LEVEL){r.layer=constants$3.DEFAULT_COLLAPSE_ROOT_LAYER;const n=reportAffectedRowCountTransform(e,t);for(let r=1;r<n+1;r++){const n=t+r,o=e[n];if(o.rowLevel>constants$3.DEFAULT_COLLAPSE_ROW_LEVEL){const r=getLastEffectiveRowInfo(e.slice(t,n));o.rowLevel>r.rowLevel?o.layer=r.layer+1:o.layer=getLayerWithRowLevel(e.slice(t,n),o.rowLevel)}}t+=n}}return e.forEach((e=>{e.layer&&(e.rowLevel=e.layer),delete e.layer})),e}function getLastEffectiveRowInfo(e){let t={};return e.reverse().some((e=>{if(e.rowLevel>constants$3.DEFAULT_COLLAPSE_ROW_LEVEL)return t=e,!0})),t}function getLayerWithRowLevel(e,t){let r=constants$3.DEFAULT_COLLAPSE_INVALID_LAYER;for(let n=getLastEffectiveRowInfo(e).layer-1;n>constants$3.DEFAULT_COLLAPSE_INVALID_LAYER;n--){if(e.reverse().some((e=>{if(e.layer==n)return t>e.rowLevel&&(r=e.layer+1,!0)})))break}return r}function reportAffectedRowCountTransform(e,t){let r=0;return e.slice(t+1).some((n=>{if(n.rowLevel>constants$3.DEFAULT_COLLAPSE_ROW_LEVEL&&n.rowLevel<=e[t].rowLevel)return!0;r+=1})),e.slice(t+1,t+r+1).reverse().some((e=>{if(e.rowLevel>constants$3.DEFAULT_COLLAPSE_ROW_LEVEL)return!0;r-=1})),r}function dealMergeCellWithRowDataAndRowInfo(e,t){let r=-1,n=-1;return e.forEach(((e,o)=>{e.cells.forEach((e=>{(null==e?void 0:e.rowSpan)>1&&(r<0&&(r=o),n=Math.max(n,o+e.rowSpan-1))})),(n<o||o===t.length-1&&-1!=n)&&(t.slice(r,n+1).reverse().some((e=>{if(e.rowLevel!==constants$3.DEFAULT_COLLAPSE_ROW_LEVEL){return range$1(r,n+1).some((o=>{const i=t[o];i.rowLevel=e.rowLevel,i.expand=e.expand,i.mergeCellFromRowIndex=r,i.mergeCellToRowIndex=n+1})),!0}})),r=-1,n=-1)})),t}function reportPageInfoTransform(e,t){let r={};return"write"===t?(r.reportTotalPage=e.sheetTotalPage,r.currentPageIndex=e.currentPageIndex||0):(r.reportTotalPage=e.reportTotalPage,r.currentPageIndex=e.currentPageIndex||0),r}function reportFrozenInfoTransform(e,t){var r;let n,o;if("write"===t)n=e.content.frozenColumn||0,o=e.content.frozenRow||0;else{const t=(null===(r=e.pageContent)||void 0===r?void 0:r.detail[0].pageLayoutInfo)||e.pageLayoutInfo;n=t.frozenColumn||0,o=t.frozenRow||0}return{column:n,row:o}}function reportSizeInfoTransform(e,t){var r;let n;n="write"===t?e.content:(null===(r=e.pageContent)||void 0===r?void 0:r.detail[0].pageLayoutInfo)||e.pageLayoutInfo;const o=n.colCount,i=n.rowCount,a=n.rowHeight.length,s=n.colWidth.length;let l=[],c=[];for(var u=0;u<o;u++)l[u]=u<s?n.colWidth[u]:n.colWidth[s-1];for(u=0;u<i;u++)c[u]=u<a?n.rowHeight[u]:DEFAULT_ROW_HEIGHT$1;return{rowHeight:c,colWidth:l,colCount:o,rowCount:i}}function reportSizeInfoTransformWithRowInfo(e,t){const r=cloneDeep$2(e),{rowHeight:n}=r,o=new Set,i=t.length;t.forEach(((e,r)=>{if(!e.expand&&e.subLayerRetain<1){const n=e.rowLevel,a=r+1,s=i+1,l=t.slice(a,s);let c=!1;l.some(((e,t)=>{const r=e.rowLevel;if(r>n)o.add(t+a),c=!0;else if(r>constants$3.DEFAULT_COLLAPSE_ROW_LEVEL)return!0;c&&o.add(t+a)}))}}));for(let a of o.keys())n[a]=0;return r}function reportFitConfigTransform(e={}){const t=e=>{switch(e){case 0:return"default";case 1:return"landscape";case 2:return"portrait";case 4:return"cross";case 3:return"none"}};let r,n;return e.fitConfig?(r=e.fitConfig.horFit,n=e.fitConfig.verFit):(r=e.horFit,n=e.verFit),{horFit:t(r),verFit:t(n)}}function reportCellsTransform(e,t,r,n){const o=getReportCellDataRows(e,n),{colCount:i,rowCount:a,colWidth:s,rowHeight:l}=r,c=[],u=createVacantCells(i,a);return o.forEach((e=>{e.cells.forEach((e=>{if(e&&(markCellLocation(e,s,l,t),!c[e.row]||!c[e.row][e.col])){splitFrozenCell(e,t).forEach((e=>{const{borderRadius:t={}}=e,{col:r,row:n,colSpan:o,rowSpan:i}=e,a=transformBorderRadiusConfig(t,l,s,r,n,o,i),d=s.slice(r,r+o).every((e=>0===e)),h=l.slice(n,n+i).every((e=>0===e)),p=d||h;e.style.rawBorder=e.style.rawBorder||e.style.border,e.style.border=reportCellBorderTransform(e.style.rawBorder,p,a),addCellsPosition(e,c),u[n][r]=e}))}}))})),chooseReportCellBorder(u,c,r),u}function transformBorderRadiusConfig(e,t,r,n,o,i,a){if(!isEmpty$3(e)){return getRadiusConfig(r.slice(n,n+i).reduce(((e,t)=>e+t)),t.slice(o,o+a).reduce(((e,t)=>e+t)),e)}return{}}function getRadiusConfig(e,t,r){const{type:n,value:o,percent:i,topLeft:a,topRight:s,bottomLeft:l,bottomRight:c,outerBackground:u}=r,d=s&&a||c&&l?e/2:e,h=s&&c||a&&l?t/2:t,p=Math.min(d,h);let f=n!==PixelValueRadiusType?Math.min(e,t)*i/100:o;return{topLeft:a,topRight:s,bottomLeft:l,bottomRight:c,outerBackground:u,originPixelValue:f,radius:Math.min(f,p)}}function getReportCellDataRows(e,t){var r;let n;return n="write"===t?e.content.cellData.rows:(null===(r=e.pageContent)||void 0===r?void 0:r.detail[0].cellData.rows)||e.cellData.rows,n}function splitFrozenCell(e,t){const{column:r,row:n}=t,{col:o,colSpan:i,row:a,rowSpan:s}=e;let l;return l=o<r&&o+i>r?r<(2*o+i)/2?[Object.assign(Object.assign({},e),{style:Object.assign({},e.style),colSpan:r-o,text:"",value:Object.assign(Object.assign({},e.value),{type:"text"})}),Object.assign(Object.assign({},e),{style:Object.assign({},e.style),col:r,colSpan:o+i-r})]:[Object.assign(Object.assign({},e),{style:Object.assign({},e.style),colSpan:r-o}),Object.assign(Object.assign({},e),{style:Object.assign({},e.style),col:r,colSpan:o+i-r,text:"",value:Object.assign(Object.assign({},e.value),{type:"text"})})]:a<n&&a+s>n?n<(2*a+s)/2?[Object.assign(Object.assign({},e),{style:Object.assign({},e.style),rowSpan:n-a,text:"",value:Object.assign(Object.assign({},e.value),{type:"text"})}),Object.assign(Object.assign({},e),{style:Object.assign({},e.style),row:n,rowSpan:a+s-n})]:[Object.assign(Object.assign({},e),{style:Object.assign({},e.style),rowSpan:n-a}),Object.assign(Object.assign({},e),{style:Object.assign({},e.style),row:n,rowSpan:a+s-n,text:"",value:Object.assign(Object.assign({},e.value),{type:"text"})})]:[e],l}function addCellsPosition(e,t){const{col:r,colSpan:n,row:o,rowSpan:i}=e;for(let a=0;a<i;a++)for(let i=0;i<n;i++)t[a+o]||(t[a+o]=[]),t[a+o][i+r]=e}function createVacantCells(e,t){const r=[];for(let n=0;n<t;n++){r[n]=[];for(let t=0;t<e;t++)r[n][t]={col:t,colSpan:0,row:n,rowSpan:0}}return r}function markCellLocation(e,t,r,n){const{col:o,colSpan:i,row:a,rowSpan:s}=e,{column:l,row:c}=n,u=o+i,d=a+s;e.isLastCol=Boolean(u===t.length||u===l||o<l&&o+i>l||t.slice(u).every((e=>0===e))),e.isLastRow=Boolean(d===r.length||d===c||a<c&&a+s>c||r.slice(d).every((e=>0===e)))}function chooseReportCellBorder(e,t,r){e.forEach((e=>{e.forEach((e=>{e.style&&(e.style.cloneBorder=e.style.border)}))})),e.forEach((e=>{e.forEach((e=>{var n,o,i;const{left:a,right:s,top:l,bottom:c}=getReportCellBorderArr(e,t,r);e.colSpan>0&&e.rowSpan>0&&e.style&&(e.style.border={borderRadius:null===(n=e.style.border)||void 0===n?void 0:n.borderRadius,left:mergeReportCellBorder(a),right:mergeReportCellBorder(s),top:mergeReportCellBorder(l),bottom:mergeReportCellBorder(c),keepBottom:!!(null===(o=e.style.border)||void 0===o?void 0:o.keepBottom),keepRight:!!(null===(i=e.style.border)||void 0===i?void 0:i.keepRight)})}))}))}function getReportCellBorderArr(e,t,r){var n,o,i,a;const{col:s,colSpan:l,row:c,rowSpan:u}=e,{colWidth:d,rowHeight:h}=r,p=[],f=[],g=[],m=[];for(let y=s;y<s+l;y++){const r=getNearestNoZeroIndex(h,c,-1),i=t[r]&&t[r][y],a=getNearestNoZeroIndex(h,c+u-1,1),s=t[a]&&t[a][y];p.push(chooseWiderTopBorder(e,i));const l=chooseWiderBottomBorder(e,s);(null===(o=null===(n=e.style)||void 0===n?void 0:n.border)||void 0===o?void 0:o.keepBottom)?f[0]=l:f.push(l)}for(let y=c;y<c+u;y++){const r=getNearestNoZeroIndex(d,s,-1),n=t[y]&&t[y][r],o=getNearestNoZeroIndex(d,s+l-1,1),c=t[y]&&t[y][o];g.push(chooseWiderLeftBorder(e,n));const u=chooseWiderRightBorder(e,c);(null===(a=null===(i=e.style)||void 0===i?void 0:i.border)||void 0===a?void 0:a.keepRight)?m[0]=u:m.push(u)}return{left:g,right:m,top:p,bottom:f}}function getNearestNoZeroIndex(e,t,r){for(let n=t+r;n<e.length&&n>-1;n+=r)if(e[n]>0)return n;return-1}function chooseWiderTopBorder(e,t){const r=_hasBorderRadius(e.borderRadius,"top"),n=_hasBorderRadius(null==t?void 0:t.borderRadius,"bottom"),o=r||n;return(null==t?void 0:t.style.cloneBorder)&&!o?chooseWiderBorder(e.style.border.top,t.style.cloneBorder.bottom):e.style.border.top}function chooseWiderBottomBorder(e,t){const r=_hasBorderRadius(e.borderRadius,"bottom"),n=_hasBorderRadius(null==t?void 0:t.borderRadius,"top"),o=r||n;return e.style.border.keepBottom=o,(null==t?void 0:t.style.cloneBorder)&&!o?chooseWiderBorder(e.style.border.bottom,t.style.cloneBorder.top):e.style.border.bottom}function chooseWiderLeftBorder(e,t){const r=_hasBorderRadius(e.borderRadius,"left"),n=_hasBorderRadius(null==t?void 0:t.borderRadius,"right"),o=r||n;return(null==t?void 0:t.style.cloneBorder)&&!o?chooseWiderBorder(e.style.border.left,t.style.cloneBorder.right):e.style.border.left}function chooseWiderRightBorder(e,t){const r=_hasBorderRadius(e.borderRadius,"right"),n=_hasBorderRadius(null==t?void 0:t.borderRadius,"left"),o=r||n;return e.style.border.keepRight=o,(null==t?void 0:t.style.cloneBorder)&&!o?chooseWiderBorder(e.style.border.right,t.style.cloneBorder.left):e.style.border.right}function chooseWiderBorder(e,t){const r=e&&e.width?e.width:0;return(t.width?t.width:0)>r?t:e}function mergeReportCellBorder(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r-1],o=e[r];n&&o.width===n.width&&o.type===n.type&&o.color===n.color?t[t.length-1].span=t[t.length-1].span+1:t.push(Object.assign(Object.assign({},o),{span:1}))}return t}function _replaceUnsupportedBorder(e){if(isString$3(null==e?void 0:e.style))switch(e.style.toUpperCase()){case"HAIR":case"HAIR2":e.style="DASHED",e.type="DASHED"}}function reportCellBorderTransform(e,t,r={}){let n={};const o=_hasBorderRadiusSize(r),i=_hasBorderRadius(r);return t?createVacantBorder(n):e?!0===e.b1?createStandardBorder(n,!1):(n.left=(null==e?void 0:e.leftBorder)||parseReportCellBorderJson(e.l),n.right=(null==e?void 0:e.rightBorder)||parseReportCellBorderJson(e.r),n.top=(null==e?void 0:e.topBorder)||parseReportCellBorderJson(e.t),n.bottom=(null==e?void 0:e.bottomBorder)||parseReportCellBorderJson(e.b),_replaceUnsupportedBorder(n.left),_replaceUnsupportedBorder(n.right),_replaceUnsupportedBorder(n.top),_replaceUnsupportedBorder(n.bottom),o&&unifiedRadiusBorderStyle(r,n)):i?createStandardBorder(n,!0):createVacantBorder(n),n.borderRadius=r,n}function unifiedRadiusBorderStyle(e,t){e.topRight&&(t.right=t.top),e.topLeft&&(t.left=t.top),e.bottomRight&&(t.right=t.bottom),e.bottomLeft&&(t.left=t.bottom)}function createVacantBorder(e){const t={width:0};e.left=t,e.right=t,e.top=t,e.bottom=t}function createStandardBorder(e,t){const r={width:t?0:1,type:"solid",color:t?void 0:"rgb(0, 0, 0)"};e.left=r,e.right=r,e.top=r,e.bottom=r}function parseReportCellBorderJson(e){if(!e)return{width:0};const t={};return t.width=e.w,t.color=e.c||"rgb(0, 0, 0)",e.type?_transformBorderJsonByType(e.type,t):_transformBorderJson(e.s,t),t}function _hasBorderRadiusSize(e={}){const{type:t,value:r,percent:n,radius:o}=e;return o>0||(t!==PixelValueRadiusType?n:r)>0}function _hasBorderRadius(e,t="all"){const r="topLeft",n="topRight",o="bottomLeft",i="bottomRight",a={all:[r,n,o,i],left:[r,o],right:[n,i],top:[r,n],bottom:[o,i]};return _hasBorderRadiusSize(e)&&a[t].find((t=>e[t]))}function _transformBorderJsonByType(e,t){let r;switch(e){case lineType.LINE_NONE:break;case lineType.LINE_THIN:case lineType.LINE_MEDIUM:case lineType.LINE_THICK:r="solid";break;case lineType.LINE_DASH:case lineType.LINE_HAIR:case lineType.LINE_HAIR2:case lineType.LINE_MEDIUM_DASH:case lineType.LINE_MEDIUM_DASH_DOT:case lineType.LINE_MEDIUM_DASH_DOT_DOT:case lineType.LINE_SLANTED_DASH_DOT:r="dashed";break;case lineType.LINE_DOUBLE:r="double";break;case lineType.LINE_DOT:case lineType.LINE_DASH_DOT:case lineType.LINE_DASH_DOT_DOT:r="dotted";break;case lineType.LINE_SLIM:r="solid",t.color=colorUtils.color2Rgba(t.color,.2);break;default:r="solid"}t.type=r}function _transformBorderJson(e,t){let r;switch(e){case"m":case"tk":default:r="solid";break;case"dash":r="dashed";break;case"tightDash":r="tightDash";break;case"looseDash":r="looseDash";break;case"de":r="double";break;case"dt":r="dotted";break;case"longDash":r="longDash";break;case"dadt":r="dashDot";break;case"ddd":r="dashDoubleDot"}t.type=r}function reportStyleTransform(e,t){return{background:reportBackgroundTransform("write"===t?e.background:e.pageContent?e.pageContent.background:{})}}const constants$3={DEFAULT_COLLAPSE_ROW_LEVEL:0,DEFAULT_COLLAPSE_INVALID_LAYER:0,DEFAULT_COLLAPSE_ROOT_LAYER:1,DEFAULT_COLLAPSE_SUBLAYER_RETAIN:0,DEFAULT_COLLAPSE_EXPAND:!0,DEFAULT_COLLAPSE_EXPAND_ALL:!1};class SinglePageModelParamsHelper{constructor(){this.modelData=null,this.singlePageDecider=null,this.rowInfo=null,this.style=null,this.sizeInfo=null,this.frozenInfo=null,this.pageInfo=null,this.showType=null,this.cellModels=null,this.widgetCellModels=null,this.originalSizeInfo=null,this.pagePosition=null,this.ecName=null,this.hasValidCollapseRowInfo=!1}initModelParams(){this.rowInfo=reportRowInfoTransform(this.modelData,this.showType),this.hasValidCollapseRowInfo=this.rowInfo.some((e=>e.rowLevel>constants$3.DEFAULT_COLLAPSE_ROW_LEVEL)),this.updateModelParams(this.modelData,this.rowInfo,this.singlePageDecider)}setModelData(e){this.modelData=e}setShowType(e){this.showType=e}setExternals(e){this.externals=e}setPagePosition(e){this.pagePosition=e}setSinglePageDecider(e){this.singlePageDecider=e}setEcName(e){this.ecName=e}getEcName(){return this.ecName}getSinglePageDecider(){return this.singlePageDecider}hasValidCollapseData(){return this.hasValidCollapseRowInfo}getCellModels(){return this.cellModels}getStyle(){return this.style}getWidgetCellModels(){return this.widgetCellModels}getRowInfo(){return this.rowInfo}getFrozenInfo(){return this.frozenInfo}getPageInfo(){return this.pageInfo}getShowType(){return this.showType}getSizeInfo(){return this.sizeInfo}getRowHeight(){return this.sizeInfo.rowHeight}getColWidth(){return this.sizeInfo.colWidth}getColCount(){return this.sizeInfo.colWidth.length}getRowCount(){return this.sizeInfo.rowHeight.length}getFrozenRow(){return this.frozenInfo.row}getFrozenCol(){return this.frozenInfo.column}dealClickCollapseCell(e){this.updateRowInfoWithRowIndex(e),this.updateModelParams(this.modelData,this.rowInfo,this.singlePageDecider)}updateRowInfoWithRowIndex(e){const t=this.getRowInfoOfIndex(e);if(t.rowLevel>constants$3.DEFAULT_COLLAPSE_ROW_LEVEL){const r=t.mergeCellFromRowIndex,n=t.mergeCellToRowIndex,o=!t.expand;r>-1&&n>-1?this.makeMergeCellExpandConsistent(r,n,o):t.expand=o;const i=this.getAffectedRowCountWithRowIndex(e);if(o&&t.expandAll)this.rowInfo.slice(e+1,e+1+i).forEach((e=>{e.rowLevel>constants$3.DEFAULT_COLLAPSE_ROW_LEVEL&&(e.expand=!0)}));else if(!o&&t.subLayerRetain>constants$3.DEFAULT_COLLAPSE_SUBLAYER_RETAIN){const r=t.subLayerRetain;this.rowInfo.slice(e+1,e+1+i).forEach((e=>{e.rowLevel>constants$3.DEFAULT_COLLAPSE_ROW_LEVEL&&(e.rowLevel<t.rowLevel+r?e.expand=!0:e.expand=!1)}))}}}makeMergeCellExpandConsistent(e,t,r){this.rowInfo.slice(e,t).forEach((e=>{e.expand=r}))}getRowInfoOfIndex(e){return this.rowInfo[e]}getAffectedRowCountWithRowIndex(e){return reportAffectedRowCountTransform(this.rowInfo,e)}getOriginalSizeInfo(){return this.originalSizeInfo}getOriginalRowHeight(){return this.originalSizeInfo.rowHeight}getOriginalColWidth(){return this.originalSizeInfo.colWidth}getOriginalColCount(){return this.originalSizeInfo.colWidth.length}getOriginalRowCount(){return this.originalSizeInfo.rowHeight.length}updateModelParams(e,t,r){const{sizeInfo:n,frozenInfo:o,pageInfo:i,style:a}=pageDataTransform(e,this.showType),s=reportSizeInfoTransformWithRowInfo(n,t),l=reportCellsTransform(e,o,s,this.showType);this.cellModels=this._buildCellModels(l,r,t),this.widgetCellModels=this._collectWidgetCellModels(this.cellModels),this.sizeInfo=s,this.originalSizeInfo=n,this.frozenInfo=o,this.style=a,this.pageInfo=i}_buildCellModels(e,t,r){return e.map(((e,n)=>e.map((e=>{if(e.collapse){e.collapse.expand=r[n].expand;let t=n;r[n].mergeCellFromRowIndex>-1&&r[n].mergeCellToRowIndex>-1&&(t=r[n].mergeCellToRowIndex-1);0==this.getAffectedRowCountWithRowIndex(t)&&unset(e,"collapse.icons")}const o=reportCellDataTransform(e,this.pagePosition);o.ecName=this.ecName;const i=ReportCellModelFactory.createReportCellModel(o,this.externals);return i.setSinglePageDecider(t),i}))))}_collectWidgetCellModels(e){let t={};return e.forEach((e=>{e.forEach((e=>{if("widget"===e.type){let r=e.widgetModel,n=t[r.getName()];n||(n=[],t[r.getName()]=n),n.push(e)}}))})),t}}const DEFAULT_ROW_HEIGHT=19,NEW_LINE_TYPE={MULTI_LINE_ADJUST_FONT:3,SINGLE_LINE_ADJUST_FONT:2,SINGLE_LINE:1,AUTO:0};function reportDataAdaptive(e={}){const t=e.pageResult,r={};return r.currentPageIndex=e.pageIndex,r.reportTotalPage=e.totalPage,r.pageLayoutInfo=pageLayoutInfoAdaptive(t,e.frozen),r.cellData=cellsDataAdaptive(t),r}function cellsDataAdaptive(e){const t={};let r=1;return t.rows=[],e.forEach(((e,n)=>{let o=[];e.forEach(((e,t)=>{var n;if(r>1)return void r--;let i={};cellPositionAdaptive(i,e.position),i.borderRadius=e.borderRadius,i.collapse=e.collapse,i.style=cellStyleAdaptive(i,e.cellstyle)||{},i.value=cellValueAdaptive(i,e),i.showAsHtml=cellConfigAdaptive(i,e.celladvancedattr),i.previewContent=null===(n=e.celladvancedattr)||void 0===n?void 0:n.previewContent,i.hyperlink=e.cellhyperlink||{},i.sortHeader=e.sortHeader||{},o[t]=i,r=i.colSpan})),t.rows[n]={cells:o}})),t}function cellConfigAdaptive(e,t={}){const{contentShowType:r}=t;return"SHOW_AS_HTML"===r}function cellValueAdaptive(e,t){let r=t.value;return isString$3(r)&&(r=JSON.parse(r)),get$5(r,"attach_id")&&(r.filename=t.celladvancedattr.fileName),r}function cellStyleAdaptive(e,t){if(isEmpty$3(t))return;const{fontStyle:r,borderStyle:n,contentStyle:o,cellBackground:i}=t,a={};return a.font=r,a.font.size=r.fontSize,a.font.color=colorUtils.transformNumber2Hex(r.color),a.background=cellBackgroundAdaptive(i.background),a.ro=o.rotate,a.ls=lineHeight2LineSpace(o.lineHeight,r.fontSize),a.td=textDirectionAdapt(o.verTextDirection),a.ts=textLineStyleAdapt(o.newLine),a.vt="VERTICAL_TEXT"===o.verticalText?1:0,a.horizontalAlign=textAlignAdapt(o.textAlign.toLowerCase()),a.verticalAlign=o.verticalAlign.toLowerCase(),a.border=cellBorderAdaptive(n),a.pl=o.paddingLeft,a.pr=o.paddingRight,a}function textDirectionAdapt(e){return"RIGHT_TO_LEFT"===e?0:1}function textAlignAdapt(e){return"distributed"===e?"justify":e}function textLineStyleAdapt(e){switch(e){case"MULTI_LINE_ADJUST_FONT":return NEW_LINE_TYPE.MULTI_LINE_ADJUST_FONT;case"SINGLE_LINE_ADJUST_FONT":return NEW_LINE_TYPE.SINGLE_LINE_ADJUST_FONT;case"SINGLE_LINE":return NEW_LINE_TYPE.SINGLE_LINE;default:return NEW_LINE_TYPE.AUTO}}function cellBackgroundAdaptive(e={}){let t;const{backgroundType:r,color:n,layout:o,imgUrl:i}=e;switch(r){case"ColorBackground":return t=colorUtils.transformNumber2Hex(n),{backgroundType:r,color:t};case"GradientBackground":return gradientBackgroundAdapt(e);case"ImageBackground":case"TextureBackground":case"PatternBackground":return{backgroundType:r,src:i,layout:o};case"BarJsonBackground":return e;default:return}}function gradientBackgroundAdapt(e){const{startColor:t,endColor:r}=e;return Object.assign(Object.assign({},e),{beginColor:colorUtils.transformNumber2Hex(t),endColor:colorUtils.transformNumber2Hex(r)})}function lineHeight2LineSpace(e,t){return Math.max(e-(t+3),0)}function cellBorderAdaptive(e){const t={};return t.bottomBorder=createAdaptBorder(null==e?void 0:e.bottomBorder),t.topBorder=createAdaptBorder(null==e?void 0:e.topBorder),t.leftBorder=createAdaptBorder(null==e?void 0:e.leftBorder),t.rightBorder=createAdaptBorder(null==e?void 0:e.rightBorder),t}function createAdaptBorder(e={}){var t,r,n;let o=null===(r=null===(t=e.style)||void 0===t?void 0:t.toLowerCase)||void 0===r?void 0:r.call(t);return 0===e.width?{width:0}:((null===(n=null==o?void 0:o.indexOf)||void 0===n?void 0:n.call(o,"dash"))>-1?o="dashed":(null==o?void 0:o.indexOf("solid"))>-1&&(o="solid"),Object.assign(Object.assign({},e),{color:colorUtils.transformNumber2Hex(e.color),type:o}))}function cellPositionAdaptive(e,t){const{x:r,y:n,rowSpan:o,columnSpan:i}=t;e.rowSpan=o,e.colSpan=i,e.row=n,e.col=r}function pageLayoutInfoAdaptive(e,t={}){var r,n;let o,i={},a=[],s=[],l=calculateFrozenData(t);return i.rowCount=e.length,i.colCount=null===(r=e[0])||void 0===r?void 0:r.length,i.frozenColumn=l.frozenColumn,i.frozenRow=l.frozenRow,e.forEach(((e,t)=>{var r,n;const o=null===(n=null===(r=e[0])||void 0===r?void 0:r.celldimension)||void 0===n?void 0:n.height;s[t]=isNil$3(o)?DEFAULT_ROW_HEIGHT:o})),null===(n=e[0])||void 0===n||n.forEach(((e,t)=>{var r;const n=null===(r=null==e?void 0:e.celldimension)||void 0===r?void 0:r.width,i=isNil$3(n)?o:n;a[t]=i,o=i})),i.colWidth=a,i.rowHeight=s,i}function calculateFrozenData(e){let t=0,r=0;return isValidFrozenData(e.colFrom,e.colTo)&&(t=e.colTo-e.colFrom+1),isValidFrozenData(e.rowFrom,e.rowTo)&&(r=e.rowTo-e.rowFrom+1),{frozenColumn:t,frozenRow:r}}function isValidFrozenData(e,t){return _isNumber(e)&&_isNumber(t)&&t>=e&&0===e}const TOUCH_KEYS={LINE:"Line",LINE_HOLD:"LineHold",COLUMN:"Column",COLUMN_HOLD:"ColumnHold",CROSS:"Cross",CROSS_HOLD:"CrossHold",CELL:"Cell",CELL_HOLD:"CellHold"};class TouchStyle{constructor(e,t){this.style=e,this.cellModels=t,this.isHold=!1,this.activatedRows=[],this.activatedCols=[]}resetActivate(){this.activatedRows=[],this.activatedCols=[]}setHold(e){return this.isHold=e,this}clearTouchedCells(){const e=this.activatedCells;this.resetActivate(),e.forEach((e=>e.refreshCellView()))}get cellModels(){return this.currentCellModels}set cellModels(e){this.currentCellModels=e}setTouchedCell(e){const t=this.activatedCells;this.updateActivated(e);const r=this.activatedCells,n=difference(t,r),o=difference(r,t);n.forEach((e=>e.refreshCellView())),o.forEach((e=>e.refreshCellView()))}setTouchStyle(e){this.isActivated(e.position)&&forEach$3(this.style,((t,r)=>{Object.assign(e.style[r],t)}))}updateActivated(e){this.isHold?this.updateHoldActivated(e):this.updateUnHoldActivated(e)}updateHoldActivated(e){}updateUnHoldActivated(e){}isActivated(e){return!1}get activatedCells(){return this.cellModels?this.getActivatedCells():[]}getActivatedCells(){return[]}getRowsByPosition(e){const{row:t,rowSpan:r}=e,n=[];for(let o=t;o<t+r;o++)n.push(o);return n}getColsByPosition(e){const{col:t,colSpan:r}=e,n=[];for(let o=t;o<t+r;o++)n.push(o);return n}isArrInclude(e,t){return t.every((t=>e.includes(t)))}}class TouchLineStyle extends TouchStyle{updateHoldActivated(e){const t=this.getRowsByPosition(e),r=this.isArrInclude(this.activatedRows,t);this.activatedRows=r?this.activatedRows.filter((e=>!t.includes(e))):uniq(this.activatedRows.concat(t))}updateUnHoldActivated(e){const t=this.getRowsByPosition(e),r=this.isArrInclude(this.activatedRows,t);this.activatedRows=r?[]:t}isActivated(e){const t=this.getRowsByPosition(e);return this.isArrInclude(this.activatedRows,t)}getActivatedCells(){let e=[];return this.activatedRows.forEach((t=>{this.cellModels[t].forEach((t=>{this.isActivated(t.position)&&e.push(t)}))})),uniq(e)}}class TouchColumnStyle extends TouchStyle{updateHoldActivated(e){const t=this.getColsByPosition(e),r=this.isArrInclude(this.activatedCols,t);this.activatedCols=r?this.activatedCols.filter((e=>!t.includes(e))):uniq(this.activatedCols.concat(t))}updateUnHoldActivated(e){const t=this.getColsByPosition(e),r=this.isArrInclude(this.activatedCols,t);this.activatedCols=r?[]:t}isActivated(e){const t=this.getColsByPosition(e);return this.isArrInclude(this.activatedCols,t)}getActivatedCells(){let e=[];return this.cellModels.forEach((t=>{this.activatedCols.forEach((r=>{const n=t[r];this.isActivated(n.position)&&e.push(n)}))})),uniq(e)}}class TouchCrossStyle extends TouchStyle{updateHoldActivated(e){const t=this.getRowsByPosition(e),r=this.isArrInclude(this.activatedRows,t),n=this.getColsByPosition(e),o=this.isArrInclude(this.activatedCols,n);r||o?(this.activatedRows=this.activatedRows.filter((e=>!t.includes(e))),this.activatedCols=this.activatedCols.filter((e=>!n.includes(e))),0!==this.activatedRows.length&&0!==this.activatedCols.length||this.resetActivate()):(this.activatedRows=uniq(this.activatedRows.concat(t)),this.activatedCols=uniq(this.activatedCols.concat(n)))}updateUnHoldActivated(e){const t=this.getRowsByPosition(e),r=this.isArrInclude(this.activatedRows,t),n=this.getColsByPosition(e),o=this.isArrInclude(this.activatedCols,n);r||o?this.resetActivate():(this.activatedRows=t,this.activatedCols=n)}isActivated(e){const t=this.getRowsByPosition(e),r=this.getColsByPosition(e);return this.isArrInclude(this.activatedRows,t)||this.isArrInclude(this.activatedCols,r)}getActivatedCells(){let e=[];return this.cellModels.forEach((t=>{t.forEach((t=>{this.isActivated(t.position)&&e.push(t)}))})),e}}const isSamePosition=(e,t)=>e.row===t.row&&e.col===t.col;class TouchCellStyle extends TouchStyle{constructor(e,t){super(e,t),this.activatedPosition=[]}resetActivate(){super.resetActivate(),this.activatedPosition=[]}updateHoldActivated(e){this.activatedPosition=this.isActivated(e)?this.activatedPosition.filter((t=>!isSamePosition(t,e))):this.activatedPosition.concat(e)}updateUnHoldActivated(e){this.activatedPosition=this.isActivated(e)?[]:[e]}isActivated(e){return this.activatedPosition.some((t=>isSamePosition(t,e)))}getActivatedCells(){let e=[];return this.cellModels.forEach((t=>{t.forEach((t=>{this.isActivated(t.position)&&e.push(t)}))})),e}}function createTouchStyle(e,t,r){switch(e){case TOUCH_KEYS.LINE:return new TouchLineStyle(t,r);case TOUCH_KEYS.LINE_HOLD:return new TouchLineStyle(t,r).setHold(!0);case TOUCH_KEYS.COLUMN:return new TouchColumnStyle(t,r);case TOUCH_KEYS.COLUMN_HOLD:return new TouchColumnStyle(t,r).setHold(!0);case TOUCH_KEYS.CROSS:return new TouchCrossStyle(t,r);case TOUCH_KEYS.CROSS_HOLD:return new TouchCrossStyle(t,r).setHold(!0);case TOUCH_KEYS.CELL:return new TouchCellStyle(t,r);case TOUCH_KEYS.CELL_HOLD:return new TouchCellStyle(t,r).setHold(!0)}}class TouchStyleManager{get cellModels(){return this.currentCellModels}set cellModels(e){this.currentCellModels=e}updateHighlightStyle(e,t){if(this.clearHighlightTouchedCells(),e&&t){const r={background:{type:"color",value:t}};this.highLightStyle=createTouchStyle(e,r,this.currentCellModels)}else this.highLightStyle=null}updateFontStyle(e,t){this.clearFontTouchedCells();const r={fontFamily:"family",fontSize:"size",strikeThrough:"strikethrough",textShadow:"shadow"};if(e&&t){const n={};forEach$3(t,((e,t)=>{n[r[t]||t]=e})),this.fontStyle=createTouchStyle(e,{font:n},this.currentCellModels)}else this.fontStyle=null}makeHighlightLine(e){this.updateHighlightStyle(TOUCH_KEYS.LINE,e)}makeHighlightLineHold(e){this.updateHighlightStyle(TOUCH_KEYS.LINE_HOLD,e)}makeHighlightColumn(e){this.updateHighlightStyle(TOUCH_KEYS.COLUMN,e)}makeHighlightColumnHold(e){this.updateHighlightStyle(TOUCH_KEYS.COLUMN_HOLD,e)}makeHighlightCross(e){this.updateHighlightStyle(TOUCH_KEYS.CROSS,e)}makeHighlightCrossHold(e){this.updateHighlightStyle(TOUCH_KEYS.CROSS_HOLD,e)}makeHighlightCell(e){this.updateHighlightStyle(TOUCH_KEYS.CELL,e)}makeHighlightCellHold(e){this.updateHighlightStyle(TOUCH_KEYS.CELL_HOLD,e)}makeFontCell(e){this.updateFontStyle(TOUCH_KEYS.CELL,e)}makeFontCellHold(e){this.updateFontStyle(TOUCH_KEYS.CELL_HOLD,e)}makeFontLine(e){this.updateFontStyle(TOUCH_KEYS.LINE,e)}makeFontLineHold(e){this.updateFontStyle(TOUCH_KEYS.LINE_HOLD,e)}clearTouchedCells(){var e,t;null===(e=this.highLightStyle)||void 0===e||e.clearTouchedCells(),null===(t=this.fontStyle)||void 0===t||t.clearTouchedCells()}clearHighlightTouchedCells(){var e;null===(e=this.highLightStyle)||void 0===e||e.clearTouchedCells()}clearFontTouchedCells(){var e;null===(e=this.fontStyle)||void 0===e||e.clearTouchedCells()}setTouchedCell(e){var t,r;null===(t=this.highLightStyle)||void 0===t||t.setTouchedCell(e),null===(r=this.fontStyle)||void 0===r||r.setTouchedCell(e)}setTouchStyle(e){var t,r;null===(t=this.highLightStyle)||void 0===t||t.setTouchStyle(e),null===(r=this.fontStyle)||void 0===r||r.setTouchStyle(e)}}const SPLIT_MARK="-";class SinglePageDataFilter{constructor(e){this._cached={},this.model=e,this.positionMap=new Map}get rowHeight(){return this.model.displayLayout.rowHeight}get colWidth(){return this.model.displayLayout.colWidth}get rowCount(){return this.model.rowCount}get colCount(){return this.model.colCount}get frozenCol(){return this.model.frozenCol}get frozenRow(){return this.model.frozenRow}reset(){var e;this._cached={},null===(e=this.positionMap)||void 0===e||e.clear()}getFilterCells(e){return this._hasZeroSize()?this._getFilteredCells(e):e}filterCell(e){this._needCellFilter(e.position)&&this._filteredCell(e)}getInitialCellPosition(e){const t=this._getPositionStr(e);if(this.positionMap.has(t)){const e=this.positionMap.get(t);return this._getPositionObj(e)}return e}adjustedFrozenInfo(){return{frozenCol:this._adjustedFrozenCol(),frozenRow:this._adjustedFrozenRow()}}filterSizeInfo(){return{rowHeight:this._filterRowHeight(),colWidth:this._filterColWidth(),rowCount:this._filterRowCount(),colCount:this._filterColCount()}}isZeroCell(e){const{col:t,colSpan:r,row:n,rowSpan:o}=e;return 0===this._filterColSpan(t,r)||0===this._filterRowSpan(n,o)}_hasZeroSize(){return this._firstZeroCol()>-1||this._firstZeroRow()>-1}_getFilteredCells(e){const t=[];return e.forEach(((r,n)=>{const o=this._isZeroRow(n);let i=[];r.forEach(((t,r)=>{const{position:n}=t,{col:a,row:s}=n;if(this._isZeroCol(r)||o){const{right:r,bottom:o}=this._getShiftPosition(n);r>=0&&o>=0&&(e[s+o][a+r]=t)}else{const e=t.position;this.filterCell(t);const r=t.position;this._saveCellPosition(r,e),i.push(t)}})),!o&&t.push(i)})),t}_needCellFilter(e){const{col:t,colSpan:r,row:n,rowSpan:o}=e;return this._hasLeftZeroCol(t+r)||this._hasTopZeroRow(n+o)}_hasLeftZeroCol(e){return this._firstZeroCol()>-1&&e>this._firstZeroCol()}_hasTopZeroRow(e){return this._firstZeroRow()>-1&&e>this._firstZeroRow()}_filteredCell(e){const{style:t,position:r}=e;e.position=this._filterCellPosition(r),t&&(e.style=this._filterCellStyle(t,r))}_getShiftPosition(e){const{col:t,row:r,colSpan:n,rowSpan:o}=e;return{right:this._getShiftRight(t,n),bottom:this._getShiftBottom(r,o)}}_getShiftRight(e,t){return this.colWidth.slice(e,e+t).findIndex((e=>e>0))}_getShiftBottom(e,t){return this.rowHeight.slice(e,e+t).findIndex((e=>e>0))}_saveCellPosition(e,t){const r=this._getPositionStr(e),n=this._getPositionStr(t);r!==n&&this.positionMap.set(r,n)}_getPositionStr({row:e,col:t}){return e+SPLIT_MARK+t}_getPositionObj(e){const[t,r]=e.split(SPLIT_MARK);return{col:r,row:t}}_adjustedFrozenCol(){return this.frozenCol-this._zeroColLength(0,this.frozenCol)}_adjustedFrozenRow(){return this.frozenRow-this._zeroRowLength(0,this.frozenRow)}_filterRowHeight(){return this.rowHeight.filter((e=>e>0))}_filterColWidth(){return this.colWidth.filter((e=>e>0))}_filterRowCount(){return this._filterRowHeight().length}_filterColCount(){return this._filterColWidth().length}_filterCellPosition(e){const{col:t,colSpan:r,row:n,rowSpan:o}=e;return{col:this._filterColIndex(t),colSpan:this._filterColSpan(t,r),row:this._filterRowIndex(n),rowSpan:this._filterRowSpan(n,o)}}_filterCellStyle(e,t){const r={};return e&&e.border&&(r.border=this._filterCellBorder(e.border,t)),Object.assign(Object.assign({},e),r)}_filterCellBorder(e,t){const{col:r,row:n}=t,{top:o,bottom:i,left:a,right:s,borderRadius:l}=e,c={};return isEmpty$3(l)||(c.borderRadius=l),Array.isArray(o)&&(c.top=this._filterHorizontalBorder(r,o)),Array.isArray(i)&&(c.bottom=this._filterHorizontalBorder(r,i)),Array.isArray(a)&&(c.left=this._filterVerticalBorder(n,a)),Array.isArray(s)&&(c.right=this._filterVerticalBorder(n,s)),c}_filterHorizontalBorder(e,t=[]){const r=[];let n=e;return t.forEach((e=>{const t=this._zeroColLength(n,n+e.span),o=e.span-t;o>0&&r.push(Object.assign(Object.assign({},e),{span:o})),n+=e.span})),r}_filterVerticalBorder(e,t=[]){const r=[];let n=e;return t.forEach((e=>{const t=this._zeroRowLength(n,n+e.span),o=e.span-t;o>0&&r.push(Object.assign(Object.assign({},e),{span:o})),n+=e.span})),r}_filterColIndex(e){return e-this._zeroColLength(0,e)}_filterColSpan(e,t){return t-this._zeroColLength(e,e+t)}_filterRowIndex(e){return e-this._zeroRowLength(0,e)}_filterRowSpan(e,t){return t-this._zeroRowLength(e,e+t)}_isZeroCol(e){return 0===this.colWidth[e]}_isZeroRow(e){return 0===this.rowHeight[e]}_zeroColLength(e,t){return this._cache("zeroColLength:".concat(e,"-").concat(t),(()=>this.colWidth.slice(e,t).filter((e=>0===e)).length))}_zeroRowLength(e,t){return this._cache("zeroRowLength:".concat(e,"-").concat(t),(()=>this.rowHeight.slice(e,t).filter((e=>0===e)).length))}_firstZeroCol(){return this._cache("firstZeroCol",(()=>this.colWidth.findIndex((e=>0===e))))}_firstZeroRow(){return this._cache("firstZeroRow",(()=>this.rowHeight.findIndex((e=>0===e))))}_cache(e,t){return e in this._cached||(this._cached[e]=t()),this._cached[e]}}function cellLocation2RowCol(e){if(isObject$e(e)&&e.hasOwnProperty("row")&&e.hasOwnProperty("column")){let{row:t,column:r}=e;return{row:t,col:r}}return isString$3(e)?cellStr2RowCol(e):null}function cellStr2RowCol(e){if(isString$3(e)){let t=/^([a-z]+)(\d+)$/i,r=e.toUpperCase().match(t);if(r){const e=r[1],t=r[2];let n=Number(t)-1,o=e.split("").reduce(((e,t,r,n)=>e+(t.charCodeAt()-64)*Math.pow(26,n.length-r-1)),-1);return n<0||o<0?null:{row:n,col:o}}}return null}const CellUtils={cellLocation2RowCol:cellLocation2RowCol,cellStr2RowCol:cellStr2RowCol},{getIntegerSize:getIntegerSize}=sizeUtils,FitType={None:"none",Default:"default",Landscape:"landscape",Portrait:"portrait",Cross:"cross"};class BaseSinglePageModel{constructor(e){const{fitConfig:t,maxHeightPercent:r,singlePageModelParamsHelper:n}=e;this.singlePageModelParamsHelper=n,this.touchStyleManager=e.touchStyleManager,this.displayLayout={rowHeight:this.rowHeight,colWidth:this.colWidth,scale:1},this.makeModelParamsConsistent(),this.dataFilter=new SinglePageDataFilter(this),t&&(this.horFit=t.horFit,this.verFit=t.verFit),r&&(this.maxHeightPercent=r),this.containerSize={},this.changedCellModels={},this.pageIndex=this.pageInfo.currentPageIndex,this.sheetIndex=0,this.view=null,this.singlePageDecider=this.singlePageModelParamsHelper.getSinglePageDecider()}getNeedsRecordCollapseInfo(){return this.singlePageModelParamsHelper.hasValidCollapseData()}registerModel(){this.singlePageDecider.setSinglePageModel(this)}shouldCellModelLoad(e){var t;return(null===(t=e.isUnLoad)||void 0===t?void 0:t.call(e))&&!this.dataFilter.isZeroCell(e.position)}onReceiveUpdateMessage(e){let t=this.getCellModelAtPosition(e.row,e.col);if(t){if(this.dataFilter.isZeroCell(t.position))return;if(!1===t.needRefreshNativeView)return void(t.needRefreshNativeView=!0);let r=e.nativeJSON||t.toNativeJson();this.touchStyleManager.setTouchStyle(r),t.widgetModel||r.content&&isObject$e(r.content.value)&&(r.content.value.valid=!isBoolean(e.valid)||e.valid),this.filterCell(r),this.markCellBoundary(r),this.view.updateCell(r)}}updateCells(e){this.view.updateCells(e)}updateCell(e){let t=this.getCellModelAtPosition(e.row,e.col);if(e){let r=e.nativeJSON||t.toNativeJson();this.view.updateCell(r)}}scrollTo(e){this.view.scrollTo(e)}scrollBy(e){this.view.scrollBy(e)}getScrollOffset(){return this.view.getScrollOffset()}startMarquee(e){this.view.startMarquee(e)}stopMarquee(){this.view.stopMarquee()}getRowHeight(e){return this.rowHeight[e]}getColWidth(e){return this.colWidth[e]}postCellMessage(e){this.view.postCellMessage(e)}onClickCollapseCell(e){this.singlePageModelParamsHelper.dealClickCollapseCell(e),this.makeModelParamsConsistent(),this.dataFilter.reset(),this.view.forceUpdateData()}onClickFileCell(e,t,r){this.getCellModelAtPosition(e,t)}makeModelParamsConsistent(){this.rowHeight=this.singlePageModelParamsHelper.getRowHeight(),this.colWidth=this.singlePageModelParamsHelper.getColWidth(),this.colCount=this.singlePageModelParamsHelper.getColCount(),this.rowCount=this.singlePageModelParamsHelper.getRowCount(),this.originalRowHeight=this.singlePageModelParamsHelper.getOriginalRowHeight(),this.originalColWidth=this.singlePageModelParamsHelper.getOriginalColWidth(),this.frozenRow=this.singlePageModelParamsHelper.getFrozenRow(),this.frozenCol=this.singlePageModelParamsHelper.getFrozenCol(),this.pageInfo=this.singlePageModelParamsHelper.getPageInfo(),this.style=this.singlePageModelParamsHelper.getStyle(),this.cellModels=this.singlePageModelParamsHelper.getCellModels(),this.widgetCellModels=this.singlePageModelParamsHelper.getWidgetCellModels(),this.ecName=this.singlePageModelParamsHelper.getEcName(),this.displayLayout.rowHeight=this.rowHeight,this.displayLayout.colWidth=this.colWidth}filterCell(e){this.needDataFilter()&&this.dataFilter.filterCell(e)}markCellBoundary(e,t=this.dataFilter.filterSizeInfo()){const r=e.position,{row:n,rowSpan:o,col:i,colSpan:a}=r;r.isTopBoundary=0===n,r.isBottomBoundary=n+o===t.rowCount,r.isLeftBoundary=0===i,r.isRightBoundary=i+a===t.colCount}markCellsBoundary(e){const t=this.dataFilter.filterSizeInfo();e.forEach((e=>{e.forEach((e=>{this.markCellBoundary(e,t)}))}))}getChangedCellModels(){return this.changedCellModels}clearChangedCellModels(){this.changedCellModels={}}hasChangedCellModels(){return Object.keys(this.changedCellModels).length>0}setCellValue(e,t,r){var n;return null===(n=this.getCellModelAtPosition(e,t))||void 0===n?void 0:n.setValue(r)}getCellValue(e,t){var r;return null===(r=this.getCellModelAtPosition(e,t))||void 0===r?void 0:r.getValue()}getWidgetByNameAPI(e){let t=this.widgetCellModels[e]||this.widgetCellModels[e.toUpperCase()];return t?t[0].widgetModel:null}getWidgetsByNameAPI(e){let t=this.widgetCellModels[e]||this.widgetCellModels[e.toUpperCase()];return t?t.map((e=>e.widgetModel)):[]}getWidgetByCellAPI(e){if(isString$3(e)){let t=CellUtils.cellStr2RowCol(e);if(!t)return;let{row:r,col:n}=t;return this.getCellModelAtPosition(r,n).widgetModel}}addEffect(){const e=compatEffectParams(...arguments),{target:t,single:r,effect:n}=e,{background:o}=n,i=__rest$p(n,["background"]);isNil$3(o)||this._addHighlightEffect(t,o,r),isNil$3(i)||this._addFontEffect(t,i,r)}_addFontEffect(e,t,r){var n,o,i,a;"cell"===e?r?null===(n=this.touchStyleManager)||void 0===n||n.makeFontCell(t):null===(o=this.touchStyleManager)||void 0===o||o.makeFontCellHold(t):"row"===e&&(r?null===(i=this.touchStyleManager)||void 0===i||i.makeFontLine(t):null===(a=this.touchStyleManager)||void 0===a||a.makeFontLineHold(t))}_addHighlightEffect(e,t,r){var n,o,i,a,s,l,c,u;"row"===e?r?null===(n=this.touchStyleManager)||void 0===n||n.makeHighlightLine(t):null===(o=this.touchStyleManager)||void 0===o||o.makeHighlightLineHold(t):"column"===e?r?null===(i=this.touchStyleManager)||void 0===i||i.makeHighlightColumn(t):null===(a=this.touchStyleManager)||void 0===a||a.makeHighlightColumnHold(t):"columnRow"===e?r?null===(s=this.touchStyleManager)||void 0===s||s.makeHighlightCross(t):null===(l=this.touchStyleManager)||void 0===l||l.makeHighlightCrossHold(t):"cell"===e&&(r?null===(c=this.touchStyleManager)||void 0===c||c.makeHighlightCell(t):null===(u=this.touchStyleManager)||void 0===u||u.makeHighlightCellHold(t))}needDataFilter(){const e=this.displayLayout.rowHeight,t=this.displayLayout.colWidth;return e.filter((e=>e>0)).length*t.filter((e=>e>0)).length/(e.length*t.length)<1}getInitialCellPosition(e,t){return this.needDataFilter()?this.dataFilter.getInitialCellPosition({row:e,col:t}):{row:e,col:t}}getSizeInfo(){return this.needDataFilter()?this.getFilterSizeInfo():this.getOriginalSizeInfo()}getOriginalSizeInfo(){return{rowHeight:this.displayLayout.rowHeight,colWidth:this.displayLayout.colWidth,rowCount:this.rowCount,colCount:this.colCount,frozenCol:this.frozenCol,frozenRow:this.frozenRow}}getFilterSizeInfo(){return Object.assign(Object.assign({},this.dataFilter.adjustedFrozenInfo()),this.dataFilter.filterSizeInfo())}getScaledCellSize(e,t=1){const{rowHeight:r,colWidth:n}=this.getSizeInfo();return{width:n.slice(e.col,e.col+e.colSpan).reduce(((e,t)=>e+t),0)*t,height:r.slice(e.row,e.row+e.rowSpan).reduce(((e,t)=>e+t),0)*t}}initAutoFitAttr(e,t,r){const n=this._getFitTypeByOrientation(r);let o=this._getReportInitWidth(n),i=this._getReportInitHeight(n),a=1,s=this.colWidth,l=this.rowHeight;switch(n){case FitType.Landscape:case FitType.Default:a=this._getScale(e,o);break;case FitType.Portrait:a=this._getScale(t,i);break;case FitType.Cross:const r=this._getScale(e,t),n=this._getScale(o,i),c=this._getScale(n,r);if(c>=1){a=this._getScale(e,o);const r=Math.floor(t/a);l=getIntegerSize(this.rowHeight,c,r)}else{a=this._getScale(t,i);const r=Math.floor(e/a);s=getIntegerSize(this.colWidth,1/c,r)}case FitType.None:}this.containerSize={containerWidth:e,containerHeight:t},this.displayLayout.rowHeight=l,this.displayLayout.colWidth=s,this.displayLayout.scale=a}getAutoFitHeight(e,t,r){const n=this._getFitTypeByOrientation(r);let o=this._getReportInitWidth(n),i=this._getReportInitHeight(n),a=this._getMaxHeight(t),s=0;switch(n){case FitType.Landscape:case FitType.Default:let t=this._getScale(e,o);s=a?Math.min(i*t,a):i*t;break;case FitType.Portrait:s=a||i;break;case FitType.Cross:if(a)s=a;else{s=i*this._getScale(e,o)}break;case FitType.None:s=a?Math.min(i,a):i}return Math.round(s)}getScale(){return this.displayLayout.scale}getContainerSize(){return{width:this.containerSize.width,height:this.containerSize.height}}getSessionID(){}bindView(e){this.view=e}unBindView(){this.view=null}onCellReceiveMessage(e,t,r,n){this.message=r;let o=this.getCellModelAtPosition(e,t);"icon"===r.touchTarget&&o.hasSortHeader()?o.handleHeaderSort():(o&&o.isPreviewContent()&&o.dealWithNativeMessage(r,n),"text"===o.type&&this.touchStyleManager.setTouchedCell(o.position))}onReceiveChangedCellModel(e){this.changedCellModels[e.getCellLocation()]=e}releaseModel(){this.setScrollPosition({x:0,y:0}),this._iterateCellModel((e=>e.releaseModel()))}fireAfterInitEvent(){var e,t;for(let n of this.cellModels)for(let e of n)e&&e.fireDataLinkedCellsChange();for(let n of this.cellModels)for(let t of n)t&&(null===(e=t.initWidgetDataLink4Cell)||void 0===e||e.call(t));let r=[];for(let n of this.cellModels)for(let e of n){const n=null===(t=e.initPromise)||void 0===t?void 0:t.call(e);n&&r.push(n.then((()=>e.refreshCellView())))}Promise.all(r).then((()=>{var e;for(let t of this.cellModels)for(let r of t)null===(e=null==r?void 0:r.fireEvent)||void 0===e||e.call(r,"afterinit")}))}getHorizontalFitType(){return this.horFit}getVerticalFitType(){return this.verFit}getFitTypeGroup(){return FitType}getCellModelByLocation(e){if(isString$3(e)){const t=CellUtils.cellStr2RowCol(e);if(t){const{row:e,col:r}=t;return this.getCellModelAtPosition(e,r)}}}getCellModelAtPosition(e,t){let r=this.cellModels[e];return r&&r[t]}_iterateCellModel(e){for(let t of this.cellModels)for(let r of t)r&&e(r)}_getMaxHeight(e){if(this.maxHeightPercent)return this.maxHeightPercent*e}_getFitTypeByOrientation(e=OrientationUtils.getCurrentOrientation()){return"LANDSCAPE"===e?this.horFit:this.verFit}_getReportInitHeight(e){let t=0;return(this._isLandscapeFitType(e)?this.rowHeight:this.originalRowHeight).forEach((e=>{t+=e})),t}_getReportInitWidth(e){let t=0;return this.originalColWidth.forEach((e=>{t+=e})),t}_getScale(e,t){return 0==t?1:e/t}_isLandscapeFitType(e){return e===FitType.Landscape}}class SinglePageModel extends BaseSinglePageModel{getDisplayCells(){const e=this.cellModels.map((e=>e.map((e=>(this.shouldCellModelLoad(e)&&e.loadCellData().then((()=>{var t;const r=e.toNativeJson();this.filterCell(r),null===(t=this.view)||void 0===t||t.updateCell(r)})),e.toNativeJson()))))),t=this.needDataFilter()?this.dataFilter.getFilterCells(e):e;return this.markCellsBoundary(t),t}}const dataFetcher={chart:{chartDataFetcher:()=>Promise.reject("The chartDataFetcher interface is not implemented"),chartHyperLinkFetcher:()=>Promise.reject("The chartHyperLinkFetcher interface is not implemented"),chartAutoRefreshFetcher:()=>Promise.reject("The chartAutoRefreshFetcher interface is not implemented"),chartRelatedFetcher:()=>Promise.reject("The chartRelatedFetcher interface is not implemented")},headerSortFetcher:()=>Promise.reject("The headerSortFetcher interface is not implemented")};class SinglePageModelCreator{constructor(e,t){this.ecName=e.ecName,this.fitConfig=reportFitConfigTransform(e.fitConfig),this.frozen=e.frozen,this.maxHeightPercent=e.maxHeightPercent,this.showType=e.showType,this.pagePosition=e.pagePosition,this.dataTransType=e.dataTransType,this.linkConfig=e.linkConfig,this.externals=merge$1({},dataFetcher,e.externals),this.modelData=reportDataAdaptive(e.data),this.touchStyleManager=new TouchStyleManager,this.pageView=t}create(){const{ecName:e,fitConfig:t,maxHeightPercent:r,showType:n,pagePosition:o,modelData:i,pageView:a,externals:s,dataTransType:l,linkConfig:c}=this,u=SinglePageDecider.create({dataTransType:l,linkConfig:c}),d=new SinglePageModelParamsHelper;d.setModelData(i),d.setShowType(n),d.setPagePosition(o),d.setExternals(s),d.setSinglePageDecider(u),d.setEcName(e),d.initModelParams();const h=new SinglePageModel({fitConfig:t,maxHeightPercent:r,touchStyleManager:this.touchStyleManager,singlePageModelParamsHelper:d});return this.touchStyleManager.cellModels=h.cellModels,h.registerModel(),h.bindView(a),h}}class ReportColJSApiContainer{constructor(e,t){this.setWidth=emptyJsApi,this.showToolTip=emptyJsApi,this.reportJSAPI=e,this.index=t}get model(){return this.reportJSAPI.model}getCell(e){return this.reportJSAPI.getCell(e,this.index)}getIndex(){return this.index}getWidth(){return this.model.getColWidth(this.index-1)}setStyle(e){const t=this.reportJSAPI.getRowCount();for(let r=0;r<t;r++)this.getCell(r+1).setStyle(e)}}class ReportRowJSApiContainer{constructor(e,t){this.setHeight=emptyJsApi,this.showToolTip=emptyJsApi,this.reportJSAPI=e,this.index=t}get model(){return this.reportJSAPI.model}getCell(e){return this.reportJSAPI.getCell(this.index,e)}getIndex(){return this.index}getHeight(){return this.model.getRowHeight(this.index-1)}setStyle(e){const t=this.reportJSAPI.getColumnCount();for(let r=0;r<t;r++)this.getCell(r+1).setStyle(e)}}class ReportWidgetJSContainer{constructor(e){this.onMouseClick=emptyJsApi,this.onMouseDown=emptyJsApi,this.onMouseMoveInCell=emptyJsApi,this.onMouseUp=emptyJsApi,this.onMouseMoveOutCell=emptyJsApi,this.setRadius=emptyJsApi,this.setHScrollBarVisible=emptyJsApi,this.setVScrollBarVisible=emptyJsApi,this.setCellStyle=emptyJsApi,this.setRowHeight=emptyJsApi,this.setColWidth=emptyJsApi,this.expandNodeLayer=emptyJsApi,this.collapseNodeLayer=emptyJsApi,this.expandAllNodeLayer=emptyJsApi,this.collapseAllNodeLayer=emptyJsApi,this.centerReport=emptyJsApi,this.model=e,this.cols=[],this.rows=[]}getCell(e,t){return this.model.getCellModelAtPosition(e-1,t-1).getJSAPI(this)}getColumn(e){const t=e-1;return this.cols[t]||(this.cols[t]=new ReportColJSApiContainer(this,e)),this.cols[t]}getRow(e){const t=e-1;return this.rows[t]||(this.rows[t]=new ReportRowJSApiContainer(this,e)),this.rows[t]}getRowCount(){return this.model.rowCount}getColumnCount(){return this.model.colCount}scrollTo(e){this.model.scrollBy(e)}getScrollOffset(){var e,t;return(null===(t=(e=this.model).getScrollOffset)||void 0===t?void 0:t.call(e))||{x:0,y:0}}addEffect(){this.model.addEffect(...arguments)}startMarquee(e){this.model.startMarquee(e)}stopMarquee(){this.model.stopMarquee()}}class SinglePageView extends reactExports.Component{constructor(e,t){super(e,t),this.containerSize={},this.nativeData=null,this.reportScale=new ReportScale(this),isEmpty$3(get$5(e,"options.data"))||(this.model=new SinglePageModelCreator(e.options,this).create(),this.jsAPI=new ReportWidgetJSContainer(this.model)),this.onNativeDoubleTap=this.onNativeDoubleTap.bind(this),this.onReceiveMessage=this.onReceiveMessage.bind(this),this.onNativeScaleChange=this.onNativeScaleChange.bind(this),this.updateCell=this.updateCell.bind(this),this._onContentSizeChange=this._onContentSizeChange.bind(this),this._getFitType=this._getFitType.bind(this),this._isHorizontalAutoFit=this._isHorizontalAutoFit.bind(this),this._isNoneAutoFit=this._isNoneAutoFit.bind(this),this._shouldPostHeight=this._shouldPostHeight.bind(this),this.onScrollPositionChange=this.onScrollPositionChange.bind(this),this._blockScaleGesture=e.blockScaleGesture}getJSAPI(){return this.jsAPI}getPageHeight(){return this.props.pageHeight}onReceiveMessage({row:e,column:t,data:r={},screenOffset:n={}}){var o,i,a;const s=this.model,l=s.getInitialCellPosition(e,t);let c=null===(o=this.nativeData[e])||void 0===o?void 0:o[t];isUndefined$3(c)||(r.size=s.getScaledCellSize(c.position,this.reportScale.scale),r.position=n,r.containerSize=this.containerSize,s.onCellReceiveMessage(l.row,l.col,r,this.context.navigation),null===(a=(i=this.props).onCellClick)||void 0===a||a.call(i,{row:l.row,column:l.col,data:r}))}onNativeDoubleTap(){this.props.preventTapToZoom||this._blockScaleGesture||this.reportScale.toggleNativeScale()}onNativeScaleChange(e){this.reportScale.updatePinchScale(e/this.getLayoutScale())}onScrollPositionChange(e){var t,r;null===(r=(t=this.model).setScrollPosition)||void 0===r||r.call(t,e)}setScaleGestureBlocked(e){this._blockScaleGesture=e,this.tableRef&&this.tableRef.setScaleGestureBlocked(e)}getScaledSizeInfo(){const e=this.model,t=(null==e?void 0:e.getOriginalSizeInfo())||{},r=this.reportScale.scale,n=t.rowHeight,o=t.colWidth;return Object.assign(Object.assign({},t),{rowHeight:null==n?void 0:n.map((e=>e*r)),colWidth:null==o?void 0:o.map((e=>e*r))})}stopEdit(){var e,t;null===(t=null===(e=this.tableRef)||void 0===e?void 0:e.blur)||void 0===t||t.call(e)}saveTableNode(e){this.tableRef=e}getLayoutScale(){return this.model.getScale()}componentDidMount(){this._initNativeData(),this.reportScale.setNativeScale()}componentWillUpdate(e,t){e.mode&&this.model!==e.model&&this._initNativeData(e.model)}componentWillReceiveProps(e,t){var r,n;(null===(r=this.props.options)||void 0===r?void 0:r.data)!==(null===(n=e.options)||void 0===n?void 0:n.data)&&(this.model=new SinglePageModelCreator(e.options,this).create(),this.jsAPI=new ReportWidgetJSContainer(this.model),this.nativeData=this.model.getDisplayCells(),this._initNativeData(this.model))}componentDidUpdate(){this.reportScale.setNativeScale()}componentWillUnmount(){}updateCells(e){const t=Object.assign(Object.assign({},this.props.options),{data:e});this.model=new SinglePageModelCreator(t,this).create(),this.jsAPI=new ReportWidgetJSContainer(this.model),this.forceUpdateData()}updateCell(e){var t;const{col:r,row:n}=e.position;Object.isFrozen(this.nativeData)||isUndefined$3(null===(t=this.nativeData[n])||void 0===t?void 0:t[r])||Object.assign(this.nativeData[n][r],e),this.tableRef&&this.tableRef.updateCell(e)}forceUpdateData(){var e,t;this._initNativeData(),null===(t=(e=this.props).onDataForceUpdate)||void 0===t||t.call(e),this.forceUpdate()}postCellMessage(e){var t;null===(t=this.tableRef)||void 0===t||t.postCellMessage(e)}scrollTo(e){var t;null===(t=this.tableRef)||void 0===t||t.scrollTo(e)}scrollBy(e){var t;null===(t=this.tableRef)||void 0===t||t.scrollBy(e)}getScrollOffset(){var e;return null===(e=this.tableRef)||void 0===e?void 0:e.getScrollOffset()}startMarquee(e={}){var t,r;null===(r=null===(t=this.tableRef)||void 0===t?void 0:t.startMarquee)||void 0===r||r.call(t,e)}stopMarquee(){var e,t;null===(t=null===(e=this.tableRef)||void 0===e?void 0:e.stopMarquee)||void 0===t||t.call(e)}render(){const e=this.model;if(!e)return null;this._determineWidth(),this._determineHeight(),this._autoFit(),e.style.background;const t=e.getSizeInfo(),r=this.props.isHide?{height:0,overflow:"hidden"}:Object.assign({flexGrow:1,backgroundColor:"transparent"},this.props.wrapStyle||{});return jsxRuntimeExports.jsx("div",Object.assign({style:r,testID:this.props.testID},{children:jsxRuntimeExports.jsx(ReportView,{data:{cells:this.nativeData},style:Object.assign({},this.containerSize),blockGestures:this.props.blockGestures,blockScaleGesture:this.props.blockScaleGesture,onContentSizeChange:this._onContentSizeChange,forbidenRowFreeze:this.props.forbidenRowFreeze,sizeInfo:t,isElementCase:this.props.isElementCase,filter:this.props.filter,onSendCellMessage:this.onReceiveMessage,ref:e=>this.saveTableNode(e),onNativeDoubleTap:this.onNativeDoubleTap,onNativeScaleChange:this.onNativeScaleChange,onScrollPositionChange:this.onScrollPositionChange,onLayout:this._onTableLayout,scaleable:this.props.scaleable})}))}_determineWidth(){let e=this.props.style||{};this.containerSize.width=Math.ceil(e.width)}_determineHeight(){let e=this.props.style||{};e&&e.height?this.containerSize.height=Math.ceil(e.height):this.containerSize.height=this.model.getAutoFitHeight(this.containerSize.width,this.getPageHeight(),OrientationUtils.getCurrentOrientation())}_autoFit(){this.model.initAutoFitAttr(this.containerSize.width,this.containerSize.height,OrientationUtils.getCurrentOrientation())}_initNativeData(e=this.model){e&&this.tableRef&&(this.nativeData=e.getDisplayCells(),this.tableRef.initData(this.nativeData))}_onContentSizeChange(e){this._shouldPostHeight()&&this.props.onContentSizeChange&&this.props.onContentSizeChange(e)}_shouldPostHeight(){return this._isHorizontalAutoFit()||this._isNoneAutoFit()}_getFitType(){return"LANDSCAPE"===OrientationUtils.getCurrentOrientation()?this.model.getHorizontalFitType():this.model.getVerticalFitType()}_isHorizontalAutoFit(){return this._getFitType()===this.model.getFitTypeGroup().Landscape}_isNoneAutoFit(){return this._getFitType()===this.model.getFitTypeGroup().None}getCell(e){var t,r;return null===(r=null===(t=this.model)||void 0===t?void 0:t.getCellModelByLocation)||void 0===r?void 0:r.call(t,e)}}SinglePageView.propTypes={blockScaleGesture:PropTypes.bool,blockGestures:PropTypes.bool,preventTapToZoom:PropTypes.bool,filter:PropTypes.string},SinglePageView.defaultProps={blockScaleGesture:!1,blockGestures:!1,preventTapToZoom:!1},SinglePageView.contextTypes={navigation:PropTypes.object};const Report$1=attachPropertiesToComponent(SinglePageView,{registerWidgetCell:registerWidgetCell,registerHyperlink:registerHyperlink,HYPERLINK:HYPERLINK,FIT_TYPE:FIT_TYPE}),ToolbarButton=e=>{const{className:t,text:r,icon:n,color:o,size:i,onClick:a,weight:s,width:l,style:c}=e,u=__rest$p(e,["className","text","icon","color","size","onClick","weight","width","style"]),d=Object.assign({},c);_isNumber(l)&&(d.width=l),_isNumber(s)&&(d.flex=s);return withNativeProps(Object.assign({className:t,style:d},u),jsxRuntimeExports.jsxs("div",Object.assign({onClick:()=>{null==a||a()},className:"fdm-toolbar-button"},{children:["string"==typeof n?jsxRuntimeExports.jsx(Icon$1,{name:n,color:o,size:i}):"function"==typeof n?n():null!=n?n:null,r&&jsxRuntimeExports.jsx(Ellipsis,{className:"toolbar-item-text",style:{color:o},content:r})]})))},BookmarkToolbar=e=>jsxRuntimeExports.jsx("div",Object.assign({className:e.className},{children:e.children})),classPrefix$l="fdm-bottom-toolbar",BottomToolbar=e=>{const{totalWeight:t=5,children:r}=e,{locale:n}=useConfig(),o=reactExports.useRef(null),i=reactExports.useRef(),a=useSize$2(o),s=merge$1({expandIcon:"fdm-toolbar-more",expandText:n.fine.MORE},e.expandConfig),{expandIcon:l,expandText:c}=s,u=__rest$p(s,["expandIcon","expandText"]),[d,{setTrue:h,setFalse:p}]=useBoolean(!1),f=(null==a?void 0:a.width)||0,g=()=>f/t;let m=0,y=0,v=0;const _=reactExports.Children.map(r,(e=>{if(reactExports.isValidElement(e)&&e.type===ToolbarButton){const n=e.props,{weight:o=1,size:i,icon:a,color:s,className:l}=n,c=__rest$p(n,["weight","size","icon","color","className"]);m+=o;const u=Object.assign(Object.assign({},c),{icon:a,color:s,size:i,className:classNames$1("".concat(classPrefix$l,"-item"),l)});return m<t||e===r[r.length-1]&&m===t?(y+=1,v=Math.max(i,v),u.weight=o):u.width=g()*o,jsxRuntimeExports.jsx(ToolbarButton,Object.assign({},u),a+s+i)}return null}))||[];m===t&&(y+=1);const b=_.slice(0,y),C=_.slice(y);return withNativeProps(e,jsxRuntimeExports.jsxs("div",Object.assign({className:classPrefix$l,ref:o},{children:[jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$l,"-wrap")},{children:b})),y<_.length&&jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$l,"-expand-wrap")},{children:jsxRuntimeExports.jsx(ToolbarButton,Object.assign({className:"".concat(classPrefix$l,"-item"),text:c,name:l,icon:l,size:v||28,onClick:h,width:g()},u),l)})),C.length>0&&jsxRuntimeExports.jsxs(Popup,Object.assign({bodyClassName:"".concat(classPrefix$l,"-popup"),visible:d,onMaskClick:p,getContainer:(isFunction$8(e.getContainer)?e.getContainer():e.getContainer)||document.body,afterClose:()=>{i.current&&(i.current(),i.current=void 0)}},{children:[jsxRuntimeExports.jsxs("div",Object.assign({className:"".concat(classPrefix$l,"-popup-header")},{children:[jsxRuntimeExports.jsx("span",{children:c}),jsxRuntimeExports.jsx("span",Object.assign({className:"".concat(classPrefix$l,"-popup-close"),onClick:p},{children:jsxRuntimeExports.jsx(Icon$1,{name:"fdm-close",size:18})}))]})),jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$l,"-popup-content")},{children:C.map((e=>{const t=e.props,{name:r,size:n,icon:o,text:a,color:s,weight:l,width:c,className:u,onClick:d,clickAfterAnimation:h}=t,f=__rest$p(t,["name","size","icon","text","color","weight","width","className","onClick","clickAfterAnimation"]);return jsxRuntimeExports.jsxs("div",Object.assign({className:classNames$1("".concat(classPrefix$l,"-popup-button"),u),onClick:()=>((e,t)=>{p(),t?i.current=e:null==e||e()})(d,h)},f,{children:[isString$3(o)?jsxRuntimeExports.jsx(Icon$1,{name:o,color:s,size:n}):o,jsxRuntimeExports.jsx(Ellipsis,{className:"".concat(classPrefix$l,"-popup-text"),style:{color:s},content:a||""})]}),r)}))}))]}))]})))},classPrefix$k="fdm-float-toolbar",DEFAULT_MAX_FOLD_COUNT=4,ROTATE_DEG=45,DEFAULT_BOTTOM=24,DEFAULT_VERTICAL_GAP=8,DEFAULT_HORIZONTAL_GAP=56,DEFAULT_EXPAND_CONFIG={expandIcon:"fdm-toolbar-more",foldIcon:"fdm-toolbar-expand",expandBackground:"var(--fdm-color-warning)",foldBackground:"var(--fdm-color-theme)",color:"#FFF"},FloatToolbar=reactExports.forwardRef(((e,t)=>{const{size:r=40,maxExpandCountPerRow:n,getContainer:o,children:i}=e,a=r+DEFAULT_VERTICAL_GAP,s=reactExports.useRef([]),l=reactExports.useRef(null),c=reactExports.useRef([]),[u,{set:d,toggle:h}]=useBoolean(!1),p=i.length,f=Math.max(e.maxFoldCount||DEFAULT_MAX_FOLD_COUNT,1),g=f-1,m=p>f,y=merge$1(DEFAULT_EXPAND_CONFIG,e.expandConfig),{expandBackground:v,expandIcon:_,foldBackground:b,foldIcon:C,color:E}=y,T=__rest$p(y,["expandBackground","expandIcon","foldBackground","foldIcon","color"]);reactExports.useImperativeHandle(t,(()=>({toggle:(e=!u)=>{d(e)}})),[u]);const[S,P]=useSprings$1(p,(()=>({x:0,y:0,opacity:1,config:{mass:1.5,tension:300}})),[]),[w,x]=useSpring$1((()=>({from:{background:b,rotate:0},config:{tension:200}})),[]),O=reactExports.useMemo((()=>{if(!n||p<=n)return null;const e=range$1(0,p).map((e=>e*a)),t=e.slice(-1*n),r=chunk$1(e,n).map((e=>e.map(((e,r)=>t[r]-e)))).flatMap((e=>e));return range$1(0,p).map((e=>({x:-1*DEFAULT_HORIZONTAL_GAP*Math.floor(e/n),y:r[e],fold:e>=g})))}),[p,n,f]);reactExports.useEffect((()=>{m&&(c.current=range$1(0,p).map((e=>({x:0,y:e<g?a*(p-f+1):a*(p-e),fold:e>=g}))),u||P.start((e=>({x:c.current[e].x,y:c.current[e].y,opacity:c.current[e].fold?0:1,immediate:!0}))))}),[p,f,n,m]);const $=e=>O?u?O[e]:c.current[e]:u?{x:0,y:0,fold:!1}:c.current[e];useUpdateEffect((()=>{if(m)return P.start((e=>{return{x:$(t=e).x,y:$(t).y,opacity:u?1:$(t).fold?0:1,config:{clamp:!u}};var t})),void x.start((()=>({background:u?v:b,rotate:u?ROTATE_DEG:0})));n&&O?P.start((e=>({x:O[e].x,y:O[e].y,opacity:1,config:{clamp:!0}}))):P.start((e=>({x:0,y:0,opacity:1,config:{clamp:!0}})))}),[u,n,O,m]);return reactDomExports.createPortal(withNativeProps(e,jsxRuntimeExports.jsx("div",Object.assign({className:classPrefix$k,style:{bottom:DEFAULT_BOTTOM,gap:DEFAULT_VERTICAL_GAP,"--float-toolbar-button-size":"".concat(r,"px")}},{children:(()=>{const e=i.map(((e,t)=>jsxRuntimeExports.jsx(animated$1.div,Object.assign({className:classNames$1(get$5(e,"props.name")),ref:e=>s.current[t]=e,style:S[t]},{children:e}),get$5(e,"props.name",t))));return m&&e.push(jsxRuntimeExports.jsx(animated$1.div,Object.assign({ref:l,className:classNames$1("".concat(classPrefix$k,"-expand-button")),style:w,onClick:h},{children:jsxRuntimeExports.jsx(ToolbarButton,Object.assign({className:"".concat(classPrefix$k,"-expand-item"),name:"float-toolbar-expand-button",icon:u?C:_,color:E,size:28},T))}),"float-toolbar-expand-button")),e})()}))),(isFunction$8(o)?o():o)||document.body)})),TYPE={DEFAULT:"default",FLOAT:"float",BOOKMARK:"bookmark"},Toolbar$3=reactExports.forwardRef(((e,t)=>{const{type:r,children:n}=e,o=__rest$p(e,["type","children"]);return r===TYPE.FLOAT?jsxRuntimeExports.jsx(FloatToolbar,Object.assign({ref:t},o,{children:reactExports.Children.toArray(n)})):r===TYPE.BOOKMARK?jsxRuntimeExports.jsx(BookmarkToolbar,{children:reactExports.Children.toArray(n)}):jsxRuntimeExports.jsx(BottomToolbar,Object.assign({},o,{children:reactExports.Children.toArray(n)}))})),Toolbar$2=attachPropertiesToComponent(Toolbar$3,{Item:ToolbarButton,TYPE:TYPE}),defaultProps$i={iconSize:18},Radio$1=e=>{const t=mergeProps(defaultProps$i,e),{className:r,invalid:n,iconSize:o}=t,i=__rest$p(t,["className","invalid","iconSize"]);return jsxRuntimeExports.jsx(Radio$2,Object.assign({},i,{className:classNames$1(r,"fdm-radio"),icon:e=>jsxRuntimeExports.jsx(Icon$1,{size:o,name:e?"fdm-radio-select":"fdm-radio-unselect",className:classNames$1({[e?"fdm-radio-checked":"fdm-radio-unchecked"]:!n,"fdm-color-error":n})})}))},useDivideWidth=e=>{const t=reactExports.useRef(null),[r,n]=reactExports.useState(0),o=useSize$2(t);return reactExports.useEffect((()=>{if(_isNumber(e)&&e>0&&(null==o?void 0:o.width)&&t.current){const r=getComputedStyle(t.current),i=o.width-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight);n(Math.floor(i/e))}}),[o,e]),[t,r]},classPrefix$j="fdm-radio-group",Group$1=e=>{const[t,r]=useDivideWidth(e.cols||0);return withNativeProps(e,jsxRuntimeExports.jsx("div",Object.assign({ref:t,style:transformStyle(e.style),className:classNames$1(classPrefix$j,{["".concat(classPrefix$j,"-disabled")]:e.disabled,"fdm-border-error":e.invalid})},{children:jsxRuntimeExports.jsx(Radio$2.Group,Object.assign({},e,{children:reactExports.Children.map(e.children,(t=>{return reactExports.cloneElement(t,(n=t.props,r>0?{style:Object.assign(Object.assign({},n.style),{width:e.itemWidth||r})}:{}));var n}))}))})))},Radio=attachPropertiesToComponent(Radio$1,{Group:Group$1}),defaultProps$h={iconSize:18},Checkbox$1=e=>{const t=mergeProps(defaultProps$h,e),{className:r,disabled:n,invalid:o,iconSize:i}=t,a=__rest$p(t,["className","disabled","invalid","iconSize"]);return jsxRuntimeExports.jsx("div",Object.assign({style:t.style,className:classNames$1(r,"fdm-checkbox")},{children:jsxRuntimeExports.jsx(Checkbox$2,Object.assign({},a,{disabled:n,icon:e=>jsxRuntimeExports.jsx(Icon$1,{size:i,name:e?"fdm-checkbox-select":"fdm-checkbox-unselect",className:classNames$1({[e?"fdm-checkbox-select":"fdm-checkbox-unselect"]:!o,"fdm-color-error":o})})}))}))},classPrefix$i="fdm-checkbox-group",Group=e=>{const{locale:t}=useConfig(),[r,n]=useDivideWidth(e.cols||0),o=t=>n>0?{style:Object.assign(Object.assign({},t.style),{width:e.itemWidth||n})}:{},{style:i,invalid:a,allCheck:s,disabled:l,children:c}=e,u=s||{},{visible:d}=u,h=__rest$p(u,["visible"]);return withNativeProps(e,jsxRuntimeExports.jsx("div",Object.assign({ref:r,style:transformStyle(i),className:classNames$1(classPrefix$i,{["".concat(classPrefix$i,"-disabled")]:l,"fdm-border-error":a})},{children:jsxRuntimeExports.jsxs(Checkbox$2.Group,Object.assign({},e,{children:[d&&jsxRuntimeExports.jsx(Checkbox$1,Object.assign({disabled:l,iconSize:e.iconSize},h,o(Object.assign({},h)),{children:t.fine.SELECT_ALL})),reactExports.Children.map(c,(e=>reactExports.cloneElement(e,Object.assign({},o(e.props)))))]}))})))},Checkbox=attachPropertiesToComponent(Checkbox$1,{Group:Group}),defaultProps$g={volume:0,autoPlay:!0,controls:!1,loop:!1,fit:"fill",hueRotate:0,playsInline:!1},Video=e=>{const t=mergeProps(defaultProps$g,e),r=reactExports.useRef(null);reactExports.useEffect((()=>{r.current&&(r.current.volume=t.volume)}),[t.volume]);const{autoPlay:n,controls:o,loop:i,src:a,fit:s,hueRotate:l,playsInline:c}=t;return withNativeProps(t,jsxRuntimeExports.jsx("video",{ref:r,src:a,autoPlay:n,controls:o,loop:i,playsInline:c,style:{objectFit:s,filter:"hue-rotate(".concat(l,"deg)")}}))},FORMATS_MAP={YEAR:"YYYY",YEAR_MONTH:"YYYY-MM",YEAR_MONTH_DATE:"YYYY-MM-DD",YEAR_QUARTER:"YYYY-Q",TIME:"HH:mm:ss",DATETIME:"YYYY-MM-DD HH:mm:ss",MONTH:"MM",QUARTER:"Q"},FORMATS=["YYYY-MM-DD HH:mm:ss","YYYY-M-D HH:mm:ss","YYYY/MM/DD HH:mm:ss","YYYY-MM-DD","YYYY/MM/DD","YYYY-M-D","YYYY/MM/DD","YYYY/M/D"];function getMomentKeepNil(e,t){return isNil$3(e)?e:getMoment(e,t)}function getMoment(e,t){if(e instanceof hooks)return e;if(e instanceof Date)return hooks(e);if("number"==typeof e)return hooks(e);if(isString$3(e))return(e=e.toString()).indexOf("CST")>-1?hooks(new Date(e)).utcOffset(-6):hooks(e=(e=e.replace("上午","am")).replace("下午","pm"),t?[t,...FORMATS]:FORMATS);if(isObject$e(e)){if("date_milliseconds"in e)return hooks(e.date_milliseconds);if(isArray$c(e))return getMoment(e[0],t)}return hooks()}function getDateStringFromMoment(e,t){return e.isValid()?e.format(t):""}function getValidPickerFormat(e){const t=e.includes("YY"),r=e.includes("Q"),n=e.includes("M"),o=e.includes("D"),i=e.includes("H")||e.includes("h")||e.includes("m")||e.includes("s");return t?n?o?i?FORMATS_MAP.DATETIME:FORMATS_MAP.YEAR_MONTH_DATE:FORMATS_MAP.YEAR_MONTH:r?FORMATS_MAP.YEAR_QUARTER:FORMATS_MAP.YEAR:i?FORMATS_MAP.TIME:e}var TIME_UNIT,TIME_UNIT2;TIME_UNIT2=TIME_UNIT||(TIME_UNIT={}),TIME_UNIT2[TIME_UNIT2.year=0]="year",TIME_UNIT2[TIME_UNIT2.quarter=1]="quarter",TIME_UNIT2[TIME_UNIT2.month=2]="month",TIME_UNIT2[TIME_UNIT2.week=3]="week",TIME_UNIT2[TIME_UNIT2.date=4]="date",TIME_UNIT2[TIME_UNIT2.workday=5]="workday",TIME_UNIT2[TIME_UNIT2.hour=6]="hour",TIME_UNIT2[TIME_UNIT2.minute=7]="minute",TIME_UNIT2[TIME_UNIT2.second=8]="second";const TU=TIME_UNIT;function MOMENT_UNIT(e){return e===TU.date?"day":TIME_UNIT[e]}function applyOffset(e,t){return t.reduce(((e,t)=>t.beforeOrAfter?e.subtract(t.value,MOMENT_UNIT(t.unit)):e.add(t.value,MOMENT_UNIT(t.unit))),hooks(e).clone())}const LOOP_UPPER_BOUND=36500;function applyOffsetWorkday(e,t,r){const n=r[0].beforeOrAfter,o=hooks(t).clone();let i=r[0].value,a=0;for(;++a<=LOOP_UPPER_BOUND&&!(i<=0);)n?o.subtract(1,"day"):o.add(1,"day"),e(o)&&(i-=1);return o}function UNITS_BY_FORMAT(e){switch(e){case FORMATS_MAP.YEAR:return[TIME_UNIT.year];case FORMATS_MAP.MONTH:return[TIME_UNIT.month];case FORMATS_MAP.QUARTER:return[TIME_UNIT.quarter];case FORMATS_MAP.YEAR_QUARTER:return[TIME_UNIT.year,TIME_UNIT.quarter];case FORMATS_MAP.YEAR_MONTH:return[TIME_UNIT.year,TIME_UNIT.month];case FORMATS_MAP.YEAR_MONTH_DATE:default:return[TIME_UNIT.year,TIME_UNIT.quarter,TIME_UNIT.month,TIME_UNIT.week,TIME_UNIT.date,TIME_UNIT.workday]}}var WeakMap$2=_WeakMap,metaMap$2=WeakMap$2&&new WeakMap$2,_metaMap=metaMap$2,identity$3=identity_1$1,metaMap$1=_metaMap,baseSetData$2=metaMap$1?function(e,t){return metaMap$1.set(e,t),e}:identity$3,_baseSetData=baseSetData$2,baseCreate$3=_baseCreate,isObject$4=isObject_1$1;function createCtor$4(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=baseCreate$3(e.prototype),n=e.apply(r,t);return isObject$4(n)?n:r}}var _createCtor=createCtor$4,createCtor$3=_createCtor,root$5=_root$1,WRAP_BIND_FLAG$6=1;function createBind$1(e,t,r){var n=t&WRAP_BIND_FLAG$6,o=createCtor$3(e);return function t(){return(this&&this!==root$5&&this instanceof t?o:e).apply(n?r:this,arguments)}}var _createBind=createBind$1,nativeMax$6=Math.max;function composeArgs$2(e,t,r,n){for(var o=-1,i=e.length,a=r.length,s=-1,l=t.length,c=nativeMax$6(i-a,0),u=Array(l+c),d=!n;++s<l;)u[s]=t[s];for(;++o<a;)(d||o<i)&&(u[r[o]]=e[o]);for(;c--;)u[s++]=e[o++];return u}var _composeArgs=composeArgs$2,nativeMax$5=Math.max;function composeArgsRight$2(e,t,r,n){for(var o=-1,i=e.length,a=-1,s=r.length,l=-1,c=t.length,u=nativeMax$5(i-s,0),d=Array(u+c),h=!n;++o<u;)d[o]=e[o];for(var p=o;++l<c;)d[p+l]=t[l];for(;++a<s;)(h||o<i)&&(d[p+r[a]]=e[o++]);return d}var _composeArgsRight=composeArgsRight$2;function countHolders$1(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n}var _countHolders=countHolders$1;function baseLodash$3(){}var _baseLodash=baseLodash$3,baseCreate$2=_baseCreate,baseLodash$2=_baseLodash,MAX_ARRAY_LENGTH=4294967295;function LazyWrapper$3(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=MAX_ARRAY_LENGTH,this.__views__=[]}LazyWrapper$3.prototype=baseCreate$2(baseLodash$2.prototype),LazyWrapper$3.prototype.constructor=LazyWrapper$3;var _LazyWrapper=LazyWrapper$3,metaMap=_metaMap,noop$2=noop_1,getData$2=metaMap?function(e){return metaMap.get(e)}:noop$2,_getData=getData$2,realNames$1={},_realNames=realNames$1,realNames=_realNames,objectProto$i=Object.prototype,hasOwnProperty$f=objectProto$i.hasOwnProperty;function getFuncName$1(e){for(var t=e.name+"",r=realNames[t],n=hasOwnProperty$f.call(realNames,t)?r.length:0;n--;){var o=r[n],i=o.func;if(null==i||i==e)return o.name}return t}var _getFuncName=getFuncName$1,baseCreate$1=_baseCreate,baseLodash$1=_baseLodash;function LodashWrapper$2(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}LodashWrapper$2.prototype=baseCreate$1(baseLodash$1.prototype),LodashWrapper$2.prototype.constructor=LodashWrapper$2;var _LodashWrapper=LodashWrapper$2,LazyWrapper$2=_LazyWrapper,LodashWrapper$1=_LodashWrapper,copyArray$2=_copyArray;function wrapperClone$1(e){if(e instanceof LazyWrapper$2)return e.clone();var t=new LodashWrapper$1(e.__wrapped__,e.__chain__);return t.__actions__=copyArray$2(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var _wrapperClone=wrapperClone$1,LazyWrapper$1=_LazyWrapper,LodashWrapper=_LodashWrapper,baseLodash=_baseLodash,isArray$2=isArray_1$1,isObjectLike$1=isObjectLike_1$1,wrapperClone=_wrapperClone,objectProto$h=Object.prototype,hasOwnProperty$e=objectProto$h.hasOwnProperty;function lodash$1(e){if(isObjectLike$1(e)&&!isArray$2(e)&&!(e instanceof LazyWrapper$1)){if(e instanceof LodashWrapper)return e;if(hasOwnProperty$e.call(e,"__wrapped__"))return wrapperClone(e)}return new LodashWrapper(e)}lodash$1.prototype=baseLodash.prototype,lodash$1.prototype.constructor=lodash$1;var wrapperLodash=lodash$1,LazyWrapper=_LazyWrapper,getData$1=_getData,getFuncName=_getFuncName,lodash=wrapperLodash;function isLaziable$1(e){var t=getFuncName(e),r=lodash[t];if("function"!=typeof r||!(t in LazyWrapper.prototype))return!1;if(e===r)return!0;var n=getData$1(r);return!!n&&e===n[0]}var _isLaziable=isLaziable$1,baseSetData$1=_baseSetData,shortOut=_shortOut$1,setData$2=shortOut(baseSetData$1),_setData=setData$2,reWrapDetails=/\{\n\/\* \[wrapped with (.+)\] \*/,reSplitDetails=/,? & /;function getWrapDetails$1(e){var t=e.match(reWrapDetails);return t?t[1].split(reSplitDetails):[]}var _getWrapDetails=getWrapDetails$1,reWrapComment=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function insertWrapDetails$1(e,t){var r=t.length;if(!r)return e;var n=r-1;return t[n]=(r>1?"& ":"")+t[n],t=t.join(r>2?", ":" "),e.replace(reWrapComment,"{\n/* [wrapped with "+t+"] */\n")}var _insertWrapDetails=insertWrapDetails$1,arrayEach$1=_arrayEach$1,arrayIncludes=_arrayIncludes,WRAP_BIND_FLAG$5=1,WRAP_BIND_KEY_FLAG$4=2,WRAP_CURRY_FLAG$4=8,WRAP_CURRY_RIGHT_FLAG$2=16,WRAP_PARTIAL_FLAG$3=32,WRAP_PARTIAL_RIGHT_FLAG$2=64,WRAP_ARY_FLAG$2=128,WRAP_REARG_FLAG$1=256,WRAP_FLIP_FLAG$1=512,wrapFlags=[["ary",WRAP_ARY_FLAG$2],["bind",WRAP_BIND_FLAG$5],["bindKey",WRAP_BIND_KEY_FLAG$4],["curry",WRAP_CURRY_FLAG$4],["curryRight",WRAP_CURRY_RIGHT_FLAG$2],["flip",WRAP_FLIP_FLAG$1],["partial",WRAP_PARTIAL_FLAG$3],["partialRight",WRAP_PARTIAL_RIGHT_FLAG$2],["rearg",WRAP_REARG_FLAG$1]];function updateWrapDetails$1(e,t){return arrayEach$1(wrapFlags,(function(r){var n="_."+r[0];t&r[1]&&!arrayIncludes(e,n)&&e.push(n)})),e.sort()}var _updateWrapDetails=updateWrapDetails$1,getWrapDetails=_getWrapDetails,insertWrapDetails=_insertWrapDetails,setToString=_setToString$1,updateWrapDetails=_updateWrapDetails;function setWrapToString$2(e,t,r){var n=t+"";return setToString(e,insertWrapDetails(n,updateWrapDetails(getWrapDetails(n),r)))}var _setWrapToString=setWrapToString$2,isLaziable=_isLaziable,setData$1=_setData,setWrapToString$1=_setWrapToString,WRAP_BIND_FLAG$4=1,WRAP_BIND_KEY_FLAG$3=2,WRAP_CURRY_BOUND_FLAG$1=4,WRAP_CURRY_FLAG$3=8,WRAP_PARTIAL_FLAG$2=32,WRAP_PARTIAL_RIGHT_FLAG$1=64;function createRecurry$2(e,t,r,n,o,i,a,s,l,c){var u=t&WRAP_CURRY_FLAG$3;t|=u?WRAP_PARTIAL_FLAG$2:WRAP_PARTIAL_RIGHT_FLAG$1,(t&=~(u?WRAP_PARTIAL_RIGHT_FLAG$1:WRAP_PARTIAL_FLAG$2))&WRAP_CURRY_BOUND_FLAG$1||(t&=~(WRAP_BIND_FLAG$4|WRAP_BIND_KEY_FLAG$3));var d=[e,t,o,u?i:void 0,u?a:void 0,u?void 0:i,u?void 0:a,s,l,c],h=r.apply(void 0,d);return isLaziable(e)&&setData$1(h,d),h.placeholder=n,setWrapToString$1(h,e,t)}var _createRecurry=createRecurry$2;function getHolder$3(e){return e.placeholder}var _getHolder=getHolder$3,copyArray$1=_copyArray,isIndex$1=_isIndex$1,nativeMin$3=Math.min;function reorder$1(e,t){for(var r=e.length,n=nativeMin$3(t.length,r),o=copyArray$1(e);n--;){var i=t[n];e[n]=isIndex$1(i,r)?o[i]:void 0}return e}var _reorder=reorder$1,PLACEHOLDER$1="__lodash_placeholder__";function replaceHolders$4(e,t){for(var r=-1,n=e.length,o=0,i=[];++r<n;){var a=e[r];a!==t&&a!==PLACEHOLDER$1||(e[r]=PLACEHOLDER$1,i[o++]=r)}return i}var _replaceHolders=replaceHolders$4,composeArgs$1=_composeArgs,composeArgsRight$1=_composeArgsRight,countHolders=_countHolders,createCtor$2=_createCtor,createRecurry$1=_createRecurry,getHolder$2=_getHolder,reorder=_reorder,replaceHolders$3=_replaceHolders,root$4=_root$1,WRAP_BIND_FLAG$3=1,WRAP_BIND_KEY_FLAG$2=2,WRAP_CURRY_FLAG$2=8,WRAP_CURRY_RIGHT_FLAG$1=16,WRAP_ARY_FLAG$1=128,WRAP_FLIP_FLAG=512;function createHybrid$2(e,t,r,n,o,i,a,s,l,c){var u=t&WRAP_ARY_FLAG$1,d=t&WRAP_BIND_FLAG$3,h=t&WRAP_BIND_KEY_FLAG$2,p=t&(WRAP_CURRY_FLAG$2|WRAP_CURRY_RIGHT_FLAG$1),f=t&WRAP_FLIP_FLAG,g=h?void 0:createCtor$2(e);return function m(){for(var y=arguments.length,v=Array(y),_=y;_--;)v[_]=arguments[_];if(p)var b=getHolder$2(m),C=countHolders(v,b);if(n&&(v=composeArgs$1(v,n,o,p)),i&&(v=composeArgsRight$1(v,i,a,p)),y-=C,p&&y<c){var E=replaceHolders$3(v,b);return createRecurry$1(e,t,createHybrid$2,m.placeholder,r,v,E,s,l,c-y)}var T=d?r:this,S=h?T[e]:e;return y=v.length,s?v=reorder(v,s):f&&y>1&&v.reverse(),u&&l<y&&(v.length=l),this&&this!==root$4&&this instanceof m&&(S=g||createCtor$2(S)),S.apply(T,v)}}var _createHybrid=createHybrid$2,apply$3=_apply$1,createCtor$1=_createCtor,createHybrid$1=_createHybrid,createRecurry=_createRecurry,getHolder$1=_getHolder,replaceHolders$2=_replaceHolders,root$3=_root$1;function createCurry$1(e,t,r){var n=createCtor$1(e);return function o(){for(var i=arguments.length,a=Array(i),s=i,l=getHolder$1(o);s--;)a[s]=arguments[s];var c=i<3&&a[0]!==l&&a[i-1]!==l?[]:replaceHolders$2(a,l);return(i-=c.length)<r?createRecurry(e,t,createHybrid$1,o.placeholder,void 0,a,c,void 0,void 0,r-i):apply$3(this&&this!==root$3&&this instanceof o?n:e,this,a)}}var _createCurry=createCurry$1,apply$2=_apply$1,createCtor=_createCtor,root$2=_root$1,WRAP_BIND_FLAG$2=1;function createPartial$1(e,t,r,n){var o=t&WRAP_BIND_FLAG$2,i=createCtor(e);return function t(){for(var a=-1,s=arguments.length,l=-1,c=n.length,u=Array(c+s),d=this&&this!==root$2&&this instanceof t?i:e;++l<c;)u[l]=n[l];for(;s--;)u[l++]=arguments[++a];return apply$2(d,o?r:this,u)}}var _createPartial=createPartial$1,composeArgs=_composeArgs,composeArgsRight=_composeArgsRight,replaceHolders$1=_replaceHolders,PLACEHOLDER="__lodash_placeholder__",WRAP_BIND_FLAG$1=1,WRAP_BIND_KEY_FLAG$1=2,WRAP_CURRY_BOUND_FLAG=4,WRAP_CURRY_FLAG$1=8,WRAP_ARY_FLAG=128,WRAP_REARG_FLAG=256,nativeMin$2=Math.min;function mergeData$1(e,t){var r=e[1],n=t[1],o=r|n,i=o<(WRAP_BIND_FLAG$1|WRAP_BIND_KEY_FLAG$1|WRAP_ARY_FLAG),a=n==WRAP_ARY_FLAG&&r==WRAP_CURRY_FLAG$1||n==WRAP_ARY_FLAG&&r==WRAP_REARG_FLAG&&e[7].length<=t[8]||n==(WRAP_ARY_FLAG|WRAP_REARG_FLAG)&&t[7].length<=t[8]&&r==WRAP_CURRY_FLAG$1;if(!i&&!a)return e;n&WRAP_BIND_FLAG$1&&(e[2]=t[2],o|=r&WRAP_BIND_FLAG$1?0:WRAP_CURRY_BOUND_FLAG);var s=t[3];if(s){var l=e[3];e[3]=l?composeArgs(l,s,t[4]):s,e[4]=l?replaceHolders$1(e[3],PLACEHOLDER):t[4]}return(s=t[5])&&(l=e[5],e[5]=l?composeArgsRight(l,s,t[6]):s,e[6]=l?replaceHolders$1(e[5],PLACEHOLDER):t[6]),(s=t[7])&&(e[7]=s),n&WRAP_ARY_FLAG&&(e[8]=null==e[8]?t[8]:nativeMin$2(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=o,e}var _mergeData=mergeData$1,baseSetData=_baseSetData,createBind=_createBind,createCurry=_createCurry,createHybrid=_createHybrid,createPartial=_createPartial,getData=_getData,mergeData=_mergeData,setData=_setData,setWrapToString=_setWrapToString,toInteger$2=toInteger_1,FUNC_ERROR_TEXT$3="Expected a function",WRAP_BIND_FLAG=1,WRAP_BIND_KEY_FLAG=2,WRAP_CURRY_FLAG=8,WRAP_CURRY_RIGHT_FLAG=16,WRAP_PARTIAL_FLAG$1=32,WRAP_PARTIAL_RIGHT_FLAG=64,nativeMax$4=Math.max;function createWrap$1(e,t,r,n,o,i,a,s){var l=t&WRAP_BIND_KEY_FLAG;if(!l&&"function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$3);var c=n?n.length:0;if(c||(t&=~(WRAP_PARTIAL_FLAG$1|WRAP_PARTIAL_RIGHT_FLAG),n=o=void 0),a=void 0===a?a:nativeMax$4(toInteger$2(a),0),s=void 0===s?s:toInteger$2(s),c-=o?o.length:0,t&WRAP_PARTIAL_RIGHT_FLAG){var u=n,d=o;n=o=void 0}var h=l?void 0:getData(e),p=[e,t,r,n,o,u,d,i,a,s];if(h&&mergeData(p,h),e=p[0],t=p[1],r=p[2],n=p[3],o=p[4],!(s=p[9]=void 0===p[9]?l?0:e.length:nativeMax$4(p[9]-c,0))&&t&(WRAP_CURRY_FLAG|WRAP_CURRY_RIGHT_FLAG)&&(t&=~(WRAP_CURRY_FLAG|WRAP_CURRY_RIGHT_FLAG)),t&&t!=WRAP_BIND_FLAG)f=t==WRAP_CURRY_FLAG||t==WRAP_CURRY_RIGHT_FLAG?createCurry(e,t,s):t!=WRAP_PARTIAL_FLAG$1&&t!=(WRAP_BIND_FLAG|WRAP_PARTIAL_FLAG$1)||o.length?createHybrid.apply(void 0,p):createPartial(e,t,r,n);else var f=createBind(e,t,r);return setWrapToString((h?baseSetData:setData)(f,p),e,t)}var _createWrap=createWrap$1,baseRest$2=_baseRest$1,createWrap=_createWrap,getHolder=_getHolder,replaceHolders=_replaceHolders,WRAP_PARTIAL_FLAG=32,partial=baseRest$2((function(e,t){var r=replaceHolders(t,getHolder(partial));return createWrap(e,WRAP_PARTIAL_FLAG,void 0,t,r)}));partial.placeholder={};var partial_1=partial;const partial$1=getDefaultExportFromCjs$1(partial_1),CSS_PREFIX="fdm-date-offset-picker";function OffsetUnitEdit(e){var t,r;const{value:n,onChange:o}=e,{i18nUnits:i,i18nUnitsPlural:a,i18nBefore:s,i18nAfter:l}=useI18nOffsetPicker(),c=[{value:"before",text:s},{value:"after",text:l}];const u=n.value>=2?a[e.value.unit]:i[e.value.unit];return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(TextInput,{preventIosAutoScrollOnFocus:!1,type:"number",min:0,defaultValue:null!==(r=null===(t=n.value)||void 0===t?void 0:t.toString())&&void 0!==r?r:"0",onChange:function(e){const t=Number.parseInt(e);Number.isNaN(t)||o(Object.assign(Object.assign({},n),{value:t}))}}),jsxRuntimeExports.jsx("span",{children:u}),jsxRuntimeExports.jsx(OpDropMenu,{items:c,value:n.beforeOrAfter?c[0]:c[1],onItemSelect:function(e){const t="before"===e.value;o(Object.assign(Object.assign({},n),{beforeOrAfter:t}))}})]})}function isSaturdayOrSunday(e){const t=hooks(e).day();return 0===t||6===t}function helperConvertAndBubbleUp(e,t,r,n,o){if(void 0===n)return;const i=t(e(hooks(),o));n(i.format(r),i.toDate())}function OffsetPicker(e){var t;const[r,n,o]=useEffectiveUnitsLogic(e.opPersistentState,e.format,null!==(t=e.includeWorkdayAsTimeUnit)&&void 0!==t&&t);function i(t){const r=o(t);helperConvertAndBubbleUp(c.applyOffsets,c.applyAdjustment,c.format,e.onDateChange,r)}const a=r.map((e=>e.unit)),[s,l]=useHeadTailLogic(e.opPersistentState,e.format,a,(function(t){helperConvertAndBubbleUp(c.applyOffsets,t,c.format,e.onDateChange,r)}));let c;c=a.some((e=>e===TIME_UNIT.workday))?{applyOffsets:partial$1(applyOffsetWorkday,e.isWorkdayPredicate),applyAdjustment:s,format:e.format}:{applyOffsets:applyOffset,applyAdjustment:s,format:e.format};const{i18nIntro:u}=useI18nOffsetPicker(),d={"op-shrink-height":useIsOnScreenKeyboardActive()};return jsxRuntimeExports.jsxs("div",Object.assign({className:classNames$1(CSS_PREFIX,d)},{children:[jsxRuntimeExports.jsx("span",{children:u}),n,jsxRuntimeExports.jsx("div",Object.assign({className:CSS_PREFIX+"-unit-edit-list"},{children:r.map((e=>jsxRuntimeExports.jsx(OffsetUnitEdit,{value:e,onChange:i},e.unit)))})),l]}))}const DEFAULT_OP_OPTIONS={enable:!1,includeWorkday:!1,isWorkdayPredicate:negate$2(isSaturdayOrSunday)};function OffsetPickerWithTab(e){const{defaultValue:t,format:r,onChangeInner:n,onChangeOuter:o,originalPicker:i}=e,[a,s]=reactExports.useState(t),[l,c]=reactExports.useState({}),u=useGetOrCreatePersistentState(r),{toggleOffsetPicker:d,absoluteOrOffsetPicker:h,unitValues:p,setUnitValues:f,effectiveUnits:g,setEffectiveUnits:m,pickerBeforeConfirm:y,resetToZeroValue:v}=u;useMount((()=>{y.current!==h&&d(),c({unitValues:cloneDeep$2(p),effectiveUnits:cloneDeep$2(g),submittingState:t})})),reactExports.useEffect((()=>{y.current||t===a||(f(l.unitValues),m(l.effectiveUnits),s(l.submittingState))}),[t,a,l,y]);const _=merge$1(DEFAULT_OP_OPTIONS,e.offsetPickerOptions);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",Object.assign({className:CSS_PREFIX+"-toggle_tab"},{children:jsxRuntimeExports.jsx(AbsoluteOrOffsetPickerToggle,{format:r,absoluteOrOffsetPicker:h,toggleAbsoluteOrOffsetPicker:function(e){d(),n(a),e&&o(a),e||(y.current?(v(),s(hooks().format(r))):s(l.submittingState))}})})),h?i:jsxRuntimeExports.jsx(OffsetPicker,{includeWorkdayAsTimeUnit:_.includeWorkday,isWorkdayPredicate:_.isWorkdayPredicate,opPersistentState:u,format:r,onDateChange:function(e){s(e),n(e)}})]})}const MASK_BG="rgba(0, 0, 0, 0.6)",useButtonAnimate$1=e=>{const{activeIndex:t,containerRef:r,activeLineRef:n,activeLineMode:o}=e,[i,a]=useSpring$1((()=>({x:0,y:0,width:0,height:0,config:{tension:300,clamp:!0}}))),[s,l]=useSpring$1((()=>({scrollLeft:0,scrollTop:0,config:{tension:300,clamp:!0}})));return{activeLineOptions:i,scrollOptions:s,animateX:function(e=!1){const i=r.current;if(!i)return;if(void 0===t)return void a.start({x:0,width:0,immediate:!0});const s=n.current;if(!s)return;const c=i.children.item(t+1);if(!c)return;const u=c.children.item(0),d=u.offsetLeft,h=u.offsetWidth,p=c.offsetLeft,f=c.offsetWidth,g=i.offsetWidth,m=i.scrollWidth,y=i.scrollLeft,v=s.offsetWidth;let _=0,b=0;if("auto"===o?(_=d,b=h):"full"===o?(_=p,b=f):_=d+(h-v)/2,a.start({x:_,width:b,immediate:e}),m-g<=0)return;const C=bound(p-(g-f)/2,0,m-g);l.start({scrollLeft:C,from:{scrollLeft:y},immediate:e})},animateY:function(e=!1){const i=r.current;if(!i)return;if(void 0===t)return void a.start({y:0,height:0,immediate:!0});const s=n.current;if(!s)return;const c=i.children.item(t+1);if(!c)return;const u=c.children.item(0),d=u.offsetTop,h=u.offsetHeight,p=c.offsetTop,f=c.offsetHeight,g=i.offsetHeight,m=i.scrollHeight,y=i.scrollTop,v=s.offsetHeight;let _=0,b=0;if("auto"===o?(_=d,b=h):"full"===o?(_=p,b=f):_=d+(h-v)/2,a.start({y:_,height:b,immediate:e}),m-g<=0)return;const C=bound(p-(g-f)/2,0,m-g);l.start({scrollTop:C,from:{scrollTop:y},immediate:e})}}},BUTTON_TYPE={UNDERLINE:"underline",SOLID_BUTTON:"solid-button",SCIENCE:"science",CAPSULE:"capsule",IMAGE_TEXT:"image-text"},defaultProps$f={type:BUTTON_TYPE.SOLID_BUTTON,disabled:!1,vertical:!1,active:!1},classPrefix$h="fdm-button-item",ButtonItem$1=e=>{const t=mergeProps(defaultProps$f,e),{type:r,disabled:n,onClick:o,vertical:i,active:a,image:s,children:l}=t;return withNativeProps(t,jsxRuntimeExports.jsxs("div",Object.assign({className:classNames$1("".concat(classPrefix$h),"".concat(classPrefix$h,"-").concat(r),{["".concat(classPrefix$h,"-disabled")]:n,["".concat(classPrefix$h,"-active")]:a,vertical:i}),onClick:e=>{n||null==o||o(e)}},{children:[r===BUTTON_TYPE.IMAGE_TEXT&&jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$h,"-image")},{children:(null==s?void 0:s.src)&&jsxRuntimeExports.jsx("div",{style:{width:s.width,height:s.height,background:'url("'.concat(s.src,'") center center / contain no-repeat')}})})),jsxRuntimeExports.jsx("div",Object.assign({className:classNames$1("".concat(classPrefix$h,"-content"))},{children:l}))]})))},classPrefix$g="fdm-button-group",Button$1=()=>null,defaultProps$e={activeLineMode:"full",buttonType:"solid-button",layout:"default",vertical:!1,defaultValue:null,cols:1,animated:!0},ButtonGroup$2=e=>{const t=mergeProps(defaultProps$e,e),{buttonType:r,layout:n,cols:o,activeLineMode:i,vertical:a,multiple:s,disabled:l}=t,c=reactExports.useRef(null),u=reactExports.useRef(null),{buttons:d,record:h}=reactExports.useMemo((()=>{const e=[],r={};return reactExports.Children.map(t.children,(t=>{if(!reactExports.isValidElement(t))return;const{value:n}=t.props,o=e.push(t);r[n]=o-1})),{buttons:e,record:r}}),[t.children]),p=e=>{if(!isUndefined$3(e))return isNull$1(e)?[]:isArray$c(e)?e:[e]},[f,g]=usePropsValue({value:p(t.value),defaultValue:p(t.defaultValue)||[],onChange:e=>{var r;null!==e&&(null===(r=t.onChange)||void 0===r||r.call(t,s?e:e[0]))}}),m=reactExports.useMemo((()=>h[f[0]]||0),[f,h]),{activeLineOptions:y,scrollOptions:v,animateX:_,animateY:b}=useButtonAnimate$1({activeIndex:m,containerRef:c,activeLineRef:u,activeLineMode:i}),{x:C,y:E,width:T,height:S}=y,{scrollLeft:P,scrollTop:w}=v,x=(e=!1)=>{s||(a?b(e):_(e))};useMount((()=>{x(!0)})),useUpdateLayoutEffect((()=>{x(!t.animated)}),[f]),useResizeEffect((()=>{x()}),c);return withNativeProps(t,jsxRuntimeExports.jsx("div",Object.assign({className:classNames$1(classPrefix$g,{vertical:a,"equal-layout":"equal"===n,"auto-fill":"auto"===n,"fixed-cols":"fixed"===n})},{children:jsxRuntimeExports.jsxs("div",Object.assign({className:"".concat(classPrefix$g,"-container")},{children:["underline"===r&&jsxRuntimeExports.jsx("div",{className:"".concat(classPrefix$g,"-tab-line")}),jsxRuntimeExports.jsxs(animated$1.div,Object.assign({className:"".concat(classPrefix$g,"-button-list"),ref:c,scrollLeft:P,scrollTop:w},{children:[jsxRuntimeExports.jsx(animated$1.div,{ref:u,className:"".concat(classPrefix$g,"-active-line"),style:(()=>{if("underline"!==t.buttonType)return{display:"none"};const e={x:0,y:0};return a?(e.height="fixed"===i?"var(--fixed-active-line-width, 30px)":S,e.y=E):(e.width="fixed"===i?"var(--fixed-active-line-width, 30px)":T,e.x=C),e})()}),d.map(((e,t)=>{const{type:i,value:c,disabled:u,image:h,children:p,onClick:m}=e.props;return jsxRuntimeExports.jsx("div",Object.assign({className:classNames$1("".concat(classPrefix$g,"-button-wrapper"),{"button-wrapper-active":f.includes(c)}),style:{flex:"fixed"===n?"0 1 ".concat(100/o,"%"):void 0}},{children:withNativeProps(e.props,jsxRuntimeExports.jsx(ButtonItem$1,Object.assign({className:classNames$1({"fdm-button-item-first":0===t,"fdm-button-item-last":t===d.length-1}),type:i||r,vertical:a,active:f.includes(c),disabled:isUndefined$3(u)?u:l,image:h,onClick:e=>{null==m||m(e),(e=>{let t=[];t=s?f.includes(e)?f.filter((t=>t!==e)):f.concat(e):[e],g(t)})(c)}},{children:p})))}),c)}))]}))]}))})))},ButtonGroup$1=attachPropertiesToComponent(ButtonGroup$2,{Button:Button$1}),Tab=()=>null,defaultProps$d={activeLineMode:"full",type:"underline",layout:"default",position:"top"},Tabs$1=e=>{const t=mergeProps(defaultProps$d,e),{position:r,className:n,style:o,type:i,layout:a,activeLineMode:s,children:l,animated:c}=t,u=reactExports.useMemo((()=>reactExports.Children.map(l,(e=>{if(reactExports.isValidElement(e)&&e.key)return jsxRuntimeExports.jsx(ButtonGroup$1.Button,Object.assign({value:e.key},e.props),e.key)}))),[l]),[d,h]=usePropsValue({value:t.activeKey,defaultValue:t.defaultActiveKey||(()=>{let e;return reactExports.Children.forEach(l,(t=>{reactExports.isValidElement(t)&&null!=t.key&&(e=t.key)})),null!=e?e:""})(),onChange:e=>{var r;null!==e&&(null===(r=t.onChange)||void 0===r||r.call(t,e))}});return jsxRuntimeExports.jsx(ButtonGroup$1,Object.assign({className:classNames$1("fdm-tabs",n,r),buttonType:i,layout:a,activeLineMode:s,value:d,defaultValue:d,onChange:e=>h(e),vertical:"left"===r||"right"===r,style:o,animated:c},{children:u}))},Tabs=attachPropertiesToComponent(Tabs$1,{Tab:Tab});function OpCheckboxGroup(e){return jsxRuntimeExports.jsx("div",Object.assign({className:"op-checkbox-group"},{children:e.availableCheckboxes.map((t=>{const r=includes(e.value,t.value);return jsxRuntimeExports.jsxs("span",Object.assign({className:"op-checkbox",onClick:()=>function(t){const r=includes(e.value,t),n=pull(e.value,t);r||n.push(t),e.onChange(n)}(t.value)},{children:[r?jsxRuntimeExports.jsx("div",Object.assign({className:"op-checkbox-icon op-checkbox-select"},{children:jsxRuntimeExports.jsx(Icon$1,{name:"fdm-checkbox-select"})})):jsxRuntimeExports.jsx("div",Object.assign({className:"op-checkbox-icon op-checkbox-unselect"},{children:jsxRuntimeExports.jsx(Icon$1,{name:"fdm-checkbox-unselect"})})),jsxRuntimeExports.jsx("span",{children:t.display})]}),t.value)}))}))}function OpDropMenu(e){var t,r;const[n,{setRight:o,setLeft:i}]=useToggle(!1);return jsxRuntimeExports.jsxs("div",Object.assign({className:"fdm-drop-menu fdm-widget-default",onClick:o},{children:[jsxRuntimeExports.jsx("span",Object.assign({className:classNames$1("fdm-text-ellipsis","text")},{children:null!==(r=null===(t=e.items.find((t=>isEqual$4(t,e.value))))||void 0===t?void 0:t.text)&&void 0!==r?r:""})),jsxRuntimeExports.jsx("div",Object.assign({className:"icon-wrap"},{children:jsxRuntimeExports.jsx(Icon$1,{name:"fdm-drop-down",className:"icon-normal"})})),jsxRuntimeExports.jsxs(Popup,Object.assign({destroyOnClose:!0,visible:n,onMaskClick:i,maskStyle:{background:MASK_BG},getContainer:()=>getRootPortalContainer("offset-picker"),className:CSS_PREFIX+"-before-after-popup"},{children:[jsxRuntimeExports.jsx("header",{children:jsxRuntimeExports.jsx("div",Object.assign({onClick:i},{children:jsxRuntimeExports.jsx(Icon$1,{name:"fdm-close",className:"icon-normal"})}))}),jsxRuntimeExports.jsx("main",{children:e.items.map((t=>jsxRuntimeExports.jsxs("p",Object.assign({onClick:()=>{return r=t,e.onItemSelect(r),void i();var r}},{children:[t.text,isEqual$4(t,e.value)&&jsxRuntimeExports.jsx(Icon$1,{name:"fdm-select",className:"icon-normal"})]}),t.text)))})]}))]}))}function getTabTitleByFormat(e,t){switch(t){case FORMATS_MAP.YEAR:return e.i18nTabYear;case FORMATS_MAP.MONTH:return e.i18nTabMonth;case FORMATS_MAP.QUARTER:return e.i18nTabQuarter;case FORMATS_MAP.YEAR_QUARTER:return e.i18nTabYearQuarter;case FORMATS_MAP.YEAR_MONTH:return e.i18nTabYearMonth;default:case FORMATS_MAP.YEAR_MONTH_DATE:return e.i18nTabDate}}function AbsoluteOrOffsetPickerToggle({format:e,absoluteOrOffsetPicker:t,toggleAbsoluteOrOffsetPicker:r}){const n=useI18nOffsetPicker(),o=[{key:"input-absolute",label:getTabTitleByFormat(n,e)},{key:"input-offset",label:n.i18nOffsetPicker}];return jsxRuntimeExports.jsx(Tabs,Object.assign({layout:"equal",activeLineMode:"fixed",className:CSS_PREFIX+"-toggle",type:"underline",activeKey:t?"input-absolute":"input-offset",onChange:e=>r("input-absolute"===e)},{children:o.map((({key:e,label:t})=>jsxRuntimeExports.jsx(Tabs.Tab,{children:t},e)))}))}const MULTI_DAY_UNIT_ASCENDING=[TIME_UNIT.week,TIME_UNIT.month,TIME_UNIT.quarter,TIME_UNIT.year];function helperMakeDoAdjust(e,t){const r=e===TIME_UNIT.week?"isoWeek":TIME_UNIT[e];return e=>t===HEAD_TAIL_ADJUSTMENT.HEAD?e.clone().startOf(r):t===HEAD_TAIL_ADJUSTMENT.TAIL?e.clone().endOf(r):e.clone().date((new Date).getDate())}var HEAD_TAIL_ADJUSTMENT,HEAD_TAIL_ADJUSTMENT2;function useHeadTailLogic(e,t,r,n){var o,i,a;const s=null!==(o=MULTI_DAY_UNIT_ASCENDING.find((e=>includes(r,e))))&&void 0!==o?o:-1,{i18nHeadTail:l}=useI18nOffsetPicker(),[c,u,d]=null!==(i=l[s])&&void 0!==i?i:[],h=[{text:c,value:HEAD_TAIL_ADJUSTMENT.THAT_DAY},{text:u,value:HEAD_TAIL_ADJUSTMENT.HEAD},{text:d,value:HEAD_TAIL_ADJUSTMENT.TAIL}],{adjustment:p,setAdjustment:f}=e,g=null!==(a=find$2(h,["value",p]))&&void 0!==a?a:h[0],m=t===FORMATS_MAP.YEAR_MONTH_DATE,y=r.every((e=>e!==TIME_UNIT.workday&&e!==TIME_UNIT.date)),v=!isEmpty$3(r)&&y&&m;return reactExports.useEffect((()=>{v&&n(helperMakeDoAdjust(s,g.value))}),[s,v]),v?[helperMakeDoAdjust(s,g.value),jsxRuntimeExports.jsx(OpDropMenu,{items:h,value:g,onItemSelect:e=>{f(e.value),n(helperMakeDoAdjust(s,e.value))}},void 0)]:[identity$a,null]}function useI18nOffsetPicker(){const{locale:e}=useConfig(),t=TIME_UNIT;return{i18nOffsetPicker:e.fine.OFFSET_PICKER_TAB,i18nIntro:e.fine.OFFSET_PICKER_INTRO,i18nTabYear:e.fine.TAB_YEAR,i18nTabQuarter:e.fine.TAB_QUARTER,i18nTabMonth:e.fine.TAB_MONTH,i18nTabYearQuarter:e.fine.TAB_YEAR_QUARTER,i18nTabYearMonth:e.fine.TAB_YEAR_MONTH,i18nTabDate:e.fine.TAB_DATE,i18nBefore:e.fine.BEFORE,i18nAfter:e.fine.AFTER,i18nUnits:{[t.year]:e.fine.YEAR_AS_UNIT,[t.quarter]:e.fine.QUARTER_AS_UNIT,[t.month]:e.fine.MONTH_AS_UNIT,[t.week]:e.fine.WEEK_AS_UNIT,[t.date]:e.fine.DATE_AS_UNIT,[t.workday]:e.fine.WORKDAY_AS_UNIT},i18nUnitsPlural:{[t.year]:e.fine.YEAR_AS_UNIT_PLURAL,[t.quarter]:e.fine.QUARTER_AS_UNIT_PLURAL,[t.month]:e.fine.MONTH_AS_UNIT_PLURAL,[t.week]:e.fine.WEEK_AS_UNIT_PLURAL,[t.date]:e.fine.DATE_AS_UNIT_PLURAL,[t.workday]:e.fine.WORKDAY_AS_UNIT_PLURAL},i18nHeadTail:{[t.year]:[e.fine.THAT_DAY,e.fine.HEAD_YEAR,e.fine.TAIL_YEAR],[t.quarter]:[e.fine.THAT_DAY,e.fine.HEAD_QUARTER,e.fine.TAIL_QUARTER],[t.month]:[e.fine.THAT_DAY,e.fine.HEAD_MONTH,e.fine.TAIL_MONTH],[t.week]:[e.fine.THAT_DAY,e.fine.HEAD_WEEK,e.fine.TAIL_WEEK]}}}HEAD_TAIL_ADJUSTMENT2=HEAD_TAIL_ADJUSTMENT||(HEAD_TAIL_ADJUSTMENT={}),HEAD_TAIL_ADJUSTMENT2[HEAD_TAIL_ADJUSTMENT2.THAT_DAY=1e3]="THAT_DAY",HEAD_TAIL_ADJUSTMENT2[HEAD_TAIL_ADJUSTMENT2.HEAD=1001]="HEAD",HEAD_TAIL_ADJUSTMENT2[HEAD_TAIL_ADJUSTMENT2.TAIL=1002]="TAIL";const OffsetPickerPersistentState=reactExports.createContext({isFake:!0,pickerBeforeConfirm:{current:!0},toggleOffsetPicker:noop$6,absoluteOrOffsetPicker:!0,onLastConfirm:noop$6,setLastConfirmToAbsolute:noop$6,effectiveUnits:[],setEffectiveUnits:noop$6,unitValues:[],setUnitValues:noop$6,resetToZeroValue:noop$6,adjustment:HEAD_TAIL_ADJUSTMENT.THAT_DAY,setAdjustment:noop$6});function useGetOrMockPersistentState(){return reactExports.useContext(OffsetPickerPersistentState)}function useGetOrCreatePersistentState(e){const t=usePersistentStateOfOffsetPicker(e),r=reactExports.useContext(OffsetPickerPersistentState);return r.isFake?t:r}function persistentStateZeroValue(e){const t=e===FORMATS_MAP.YEAR_MONTH_DATE?[TIME_UNIT.year]:UNITS_BY_FORMAT(e),r=[];return t.forEach((e=>{r[e]={beforeOrAfter:!0,value:0}})),[t,r]}function usePersistentStateOfOffsetPicker(e){const[t,r]=persistentStateZeroValue(e),[n,o]=reactExports.useState(t),[i,a]=reactExports.useState(r),[s,{toggle:l}]=useToggle(!0),c=reactExports.useRef(!0),[u,d]=reactExports.useState(HEAD_TAIL_ADJUSTMENT.THAT_DAY);return{adjustment:u,setAdjustment:d,resetToZeroValue:()=>{const[t,r]=persistentStateZeroValue(e);a(r),o(t)},pickerBeforeConfirm:c,toggleOffsetPicker:l,absoluteOrOffsetPicker:s,onLastConfirm:function(){c.current=s},setLastConfirmToAbsolute:function(){c.current=!0},effectiveUnits:n,setEffectiveUnits:o,unitValues:i,setUnitValues:a,isFake:!1}}function EffectiveUnitCheckbox({items:e,value:t,onChange:r}){const{i18nUnits:n}=useI18nOffsetPicker();return jsxRuntimeExports.jsx(OpCheckboxGroup,{value:t,onChange:r,availableCheckboxes:e.map((e=>({value:e,display:n[e]})))})}function useEffectiveUnitsLogic(e,t,r){const{effectiveUnits:n,setEffectiveUnits:o,unitValues:i,setUnitValues:a}=e,s=n.map((e=>Object.assign({unit:e},i[e]))),l=t===FORMATS_MAP.YEAR_MONTH_DATE,c=r?UNITS_BY_FORMAT(t):UNITS_BY_FORMAT(t).filter((e=>e!==TIME_UNIT.workday));return[s,l?jsxRuntimeExports.jsx(EffectiveUnitCheckbox,{items:c,value:n,onChange:function(e){var t;e.sort();let r=e;e.some((e=>e===TIME_UNIT.workday))&&!n.some((e=>e===TIME_UNIT.workday))&&(r=[TIME_UNIT.workday]);!e.some((e=>e===TIME_UNIT.workday))&&n.some((e=>e===TIME_UNIT.workday))&&(r=e);e.some((e=>e!==TIME_UNIT.workday))&&n.some((e=>e===TIME_UNIT.workday))&&(r=e.filter((e=>e!==TIME_UNIT.workday)));o(r);const s=[];for(const n of r)s[n]=null!==(t=i[n])&&void 0!==t?t:{beforeOrAfter:!0,value:0};a(s)}}):null,function(e){const t=cloneDeep$2(i);return t[e.unit]={beforeOrAfter:e.beforeOrAfter,value:e.value},a(t),n.map((e=>Object.assign({unit:e},t[e])))}]}const SWIPE_BUTTON_TYPE={NONE:"",NAVIGATOR:"navigator",TAB:"tab"},POSITION_TYPE={TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right"},LazyLoadWrapper=e=>{const{visible:t,children:r}=e,n=reactExports.useRef(t);return t&&(n.current=!0),n.current?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:r}):null},defaultProps$c={swipeButtonType:SWIPE_BUTTON_TYPE.NONE,showPoint:!0,defaultIndex:0,autoplay:!1,animated:!0},Swiper$1=e=>{const t=mergeProps(defaultProps$c,e),{swipeButtonType:r,showPoint:n,className:o,navigatorIcon:i,tabsProps:a,containerStyle:s,onIndexChange:l,children:c,lazyLoadCount:u,animated:d,trackOffset:h,tabsWrapperProps:p,navigatorWrapperClassName:f,navigatorWrapperStyle:g}=t,m=__rest$p(t,["swipeButtonType","showPoint","className","navigatorIcon","tabsProps","containerStyle","onIndexChange","children","lazyLoadCount","animated","trackOffset","tabsWrapperProps","navigatorWrapperClassName","navigatorWrapperStyle"]),y=reactExports.useRef(null),v=reactExports.useRef(null),[_,b,C]=useGetState(t.defaultIndex||0),[E,T]=reactExports.useState(t.autoplay),[S,P]=reactExports.useState(d),w=reactExports.useRef(!d),x=()=>reactExports.Children.toArray(c).length;reactExports.useEffect((()=>{y.current&&(v.current={swipeTo(e,r){var n;w.current=null!=r?r:!t.animated,null===(n=y.current)||void 0===n||n.swipeTo(e,w.current)},swipeNext(e){this.swipeTo((C()+1)%x(),e)},swipePrev(e){this.swipeTo((C()+x()-1)%x(),e)}},t.swiperRef&&(t.swiperRef.current=v.current))}),[y.current]);const{tabItems:O,keyToIndexArr:$}=reactExports.useMemo((()=>{const e=reactExports.Children.map(c,((e,t)=>{if(!reactExports.isValidElement(e))return null;const{label:r,tabProps:n}=e.props;return jsxRuntimeExports.jsx(Tabs.Tab,Object.assign({},n,{children:r}),t.toString())})),t=null==e?void 0:e.reduce(((e,t)=>{var r,n;return t&&e.push(null!==(n=null===(r=t.key)||void 0===r?void 0:r.toString())&&void 0!==n?n:""),e}),[]);return{tabItems:e,keyToIndexArr:t}}),[c]),I=useDebounceFn((()=>{T(!0)})),R=e=>{if(isUndefined$3(u))return!0;let r=Math.abs(e-_);return t.loop&&(r=Math.min(r,e+x()-_,_+x()-e)),r<=u},A=r===SWIPE_BUTTON_TYPE.NAVIGATOR&&n;return jsxRuntimeExports.jsxs("div",Object.assign({className:"fdm-swiper-container",style:Object.assign({flexDirection:(()=>{if(r!==SWIPE_BUTTON_TYPE.TAB)return"row";switch(null==a?void 0:a.position){case POSITION_TYPE.LEFT:return"row";case POSITION_TYPE.RIGHT:return"row-reverse";case POSITION_TYPE.TOP:return"column";case POSITION_TYPE.BOTTOM:return"column-reverse";default:return"column"}})()},s),onTouchStartCapture:()=>{E&&T(!1)},onTouchEndCapture:()=>{t.autoplay&&I.run()}},{children:[r===SWIPE_BUTTON_TYPE.TAB&&jsxRuntimeExports.jsx("div",Object.assign({},p,{children:jsxRuntimeExports.jsx(Tabs,Object.assign({activeKey:null==$?void 0:$[_],animated:S},a,{onChange:e=>{var t,r;null===(t=null==a?void 0:a.onChange)||void 0===t||t.call(a,e);const n=null==$?void 0:$.findIndex((t=>t===e.toString()));isNil$3(n)||null===(r=v.current)||void 0===r||r.swipeTo(n)}},{children:O}))})),withNativeProps(t,jsxRuntimeExports.jsx(AntdSwiper,Object.assign({indicator:A?void 0:()=>null},m,{className:classNames$1("fdm-swiper",o,{"no-track-offset":!h}),ref:y,autoplay:E,onIndexChange:e=>{null==l||l(e),P(!w.current),w.current=!t.animated,b(e)}},{children:reactExports.Children.map(c,((e,t)=>jsxRuntimeExports.jsx(AntdSwiper.Item,Object.assign({},null==e?void 0:e.props,{children:jsxRuntimeExports.jsx(LazyLoadWrapper,Object.assign({visible:R(t)},{children:e}))}),t)))}))),r===SWIPE_BUTTON_TYPE.NAVIGATOR&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",Object.assign({className:classNames$1("fdm-navigator-button left",f),style:g,onClick:()=>{var e;return null===(e=v.current)||void 0===e?void 0:e.swipePrev()}},{children:i||jsxRuntimeExports.jsx(Icon$1,{name:"fdm-next-page"})})),jsxRuntimeExports.jsx("div",Object.assign({className:classNames$1("fdm-navigator-button right",f),style:g,onClick:()=>{var e;return null===(e=v.current)||void 0===e?void 0:e.swipeNext()}},{children:i||jsxRuntimeExports.jsx(Icon$1,{name:"fdm-next-page"})}))]})]}))},SwiperItem$1=e=>jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:e.children}),Swiper=attachPropertiesToComponent(Swiper$1,{Item:SwiperItem$1}),classPrefix$f="adm-picker-view",Wheel=reactExports.memo((e=>{const{value:t,column:r,renderLabel:n}=e;function o(t){e.onSelect(t,e.index)}const[{y:i},a]=useSpring$1((()=>({from:{y:0},config:{tension:400,mass:.8}}))),s=reactExports.useRef(!1),l=reactExports.useRef(null),c=reactExports.useRef(null),u=reactExports.useRef(34);function d(e){const t=e*-u.current;a.start({y:t});const n=r[e];n&&o(n.value)}useIsomorphicLayoutEffect$2((()=>{const e=c.current;e&&(u.current=measureCSSLength(window.getComputedStyle(e).getPropertyValue("height")))})),useIsomorphicLayoutEffect$2((()=>{if(s.current)return;if(null===t)return;const e=r.findIndex((e=>e.value===t));if(e<0)return;const n=e*-u.current;a.start({y:n,immediate:i.goal!==n})}),[t,r]),useIsomorphicLayoutEffect$2((()=>{if(0===r.length)null!==t&&o(null);else if(!r.some((e=>e.value===t))){o(r[0].value)}}),[r,t]);const h=e=>{s.current=!0;const t=-(r.length-1)*u.current;if(e.last){s.current=!1;const r=e.offset[1]+e.velocity[1]*e.direction[1]*50;d(t<0?-Math.round(bound(r,t,0)/u.current):0)}else{const r=e.offset[1];a.start({y:rubberbandIfOutOfBounds(r,t,0,50*u.current,.2)})}};useDrag((e=>{e.event.stopPropagation(),h(e)}),{axis:"y",from:()=>[0,i.get()],filterTaps:!0,pointer:{touch:!0},target:l,eventOptions:{capture:!0},window:e.window||window}),useWheel((e=>{e.event.stopPropagation(),h(e)}),{axis:"y",from:()=>[0,i.get()],preventDefault:!0,target:e.mouseWheel?l:void 0,eventOptions:!!supportsPassive&&{passive:!1}});let p=null;return jsxRuntimeExports.jsxs("div",Object.assign({className:"".concat(classPrefix$f,"-column")},{children:[jsxRuntimeExports.jsx("div",{className:"".concat(classPrefix$f,"-item-height-measure"),ref:c}),jsxRuntimeExports.jsx(animated$1.div,Object.assign({ref:l,style:{translateY:i},className:"".concat(classPrefix$f,"-column-wheel"),"aria-hidden":!0},{children:r.map(((r,o)=>{var i;const a=e.value===r.value;return a&&(p=o),jsxRuntimeExports.jsx("div",Object.assign({"data-selected":r.value===t,className:"".concat(classPrefix$f,"-column-item"),onClick:function(){s.current=!1,d(o)},"aria-hidden":!a,"aria-label":a?"active":""},{children:jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$f,"-column-item-label")},{children:n(r)}))}),null!==(i=r.key)&&void 0!==i?i:r.value)}))})),function(){if(null===p)return null;const e=r[p],t=p-1,n=p+1,o=r[t],i=r[n];return jsxRuntimeExports.jsxs("div",Object.assign({className:"adm-picker-view-column-accessible"},{children:[jsxRuntimeExports.jsx("div",Object.assign({className:"adm-picker-view-column-accessible-current",role:"button","aria-label":e?"当前选择的是：".concat(e.label):"当前未选择"},{children:"-"})),jsxRuntimeExports.jsx("div",Object.assign({className:"adm-picker-view-column-accessible-button",onClick:()=>{o&&d(t)},role:o?"button":"text","aria-label":o?"选择上一项：".concat(o.label):"没有上一项"},{children:"-"})),jsxRuntimeExports.jsx("div",Object.assign({className:"adm-picker-view-column-accessible-button",onClick:()=>{i&&d(n)},role:i?"button":"text","aria-label":i?"选择下一项：".concat(i.label):"没有下一项"},{children:"-"}))]}))}()]}))}),((e,t)=>e.index===t.index&&(e.value===t.value&&(e.onSelect===t.onSelect&&(e.renderLabel===t.renderLabel&&(e.mouseWheel===t.mouseWheel&&!!isEqual$4(e.column,t.column)))))));function generateColumnsExtend(e,t){const r=withCache((()=>("function"==typeof e?e(t):e).map((e=>e.map((e=>"string"==typeof e?{label:e,value:e}:e)))))),n=withCache((()=>t.map(((e,t)=>{var n;const o=r()[t];return o&&null!==(n=o.find((t=>t.value===e)))&&void 0!==n?n:null}))));return{get columns(){return r()},get items(){return n()}}}function useColumnsExtend(e,t){return reactExports.useMemo((()=>generateColumnsExtend(e,t)),[e,t])}Wheel.displayName="Wheel";const classPrefix$e="adm-picker-view",defaultProps$b={defaultValue:[],renderLabel:defaultRenderLabel,mouseWheel:!1,window:window,loadingContent:jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$e,"-loading-content")},{children:jsxRuntimeExports.jsx(SpinLoading,{})}))},PickerView=reactExports.memo((e=>{const t=mergeProps(defaultProps$b,e),[r,n]=reactExports.useState(void 0===t.value?t.defaultValue:t.value);reactExports.useEffect((()=>{void 0!==t.value&&t.value!==r&&n(t.value)}),[t.value]),reactExports.useEffect((()=>{if(t.value===r)return;const e=window.setTimeout((()=>{void 0!==t.value&&t.value!==r&&n(t.value)}),1e3);return()=>{window.clearTimeout(e)}}),[t.value,r]);const o=useColumnsExtend(t.columns,r),i=o.columns;useDebounceEffect((()=>{var e;t.value!==r&&(null===(e=t.onChange)||void 0===e||e.call(t,r,o))}),[r],{wait:0,leading:!1,trailing:!0});const a=reactExports.useCallback(((e,t)=>{n((r=>{const n=[...r];return n[t]=e,n}))}),[]);return withNativeProps(t,jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$e)},{children:t.loading?t.loadingContent:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[i.map(((e,n)=>jsxRuntimeExports.jsx(Wheel,{index:n,column:e,value:r[n],onSelect:a,renderLabel:t.renderLabel,mouseWheel:t.mouseWheel,window:t.window},n))),jsxRuntimeExports.jsxs("div",Object.assign({className:"".concat(classPrefix$e,"-mask")},{children:[jsxRuntimeExports.jsx("div",{className:"".concat(classPrefix$e,"-mask-top")}),jsxRuntimeExports.jsx("div",{className:"".concat(classPrefix$e,"-mask-middle")}),jsxRuntimeExports.jsx("div",{className:"".concat(classPrefix$e,"-mask-bottom")})]}))]})})))}));PickerView.displayName="PickerView";const constants$2={YEARS_AFTER_TODAY:200},MODE$1={YEAR_MONTH_DATE:"YYYY-MM-DD",YEAR_MONTH:"YYYY-MM",YEAR:"YYYY"},defaultProps$a={date:hooks().toDate()},DatePicker=e=>{const t=mergeProps(defaultProps$a,e),r=()=>{const e=R.current.year(),t=I.current.year(),r=R.current.month(),o=I.current.month(),i=R.current.date(),l=I.current.date(),d=n(e,t);let h=n(0,11),p=n(1,u(Number(s()),c()));return e==t?(h=n(r,o),r==o?p=n(i,l):+s()===r?p=n(i,u(r,c())):(+s()===o||+a()>t)&&(p=n(1,l))):+a()===e?(h=n(r,11),+s()==r&&(p=n(i,u(r,c())))):+a()===t&&(h=n(0,o),+s()===o&&(p=n(1,l))),{yearArr:d,monthArr:h,dateArr:p}},n=(e,t)=>e>t?[]:range$1(e,t+1),o=()=>$.current.isBefore(R.current,"day")?($.current=hooks(R.current),!0):!!$.current.isAfter(hooks(I.current,"day"))&&($.current=hooks(I.current),!0),i=()=>$.current,a=()=>i().year().toString(),s=()=>i().month().toString(),l=()=>i().date().toString(),c=()=>i().isLeapYear(),u=(e,t)=>[31,t?29:28,31,30,31,30,31,31,30,31,30,31][e],d=e=>{var t;t=e,$.current.year(+t),o();const n=r();D(e),N(s()),k(l()),B(n.yearArr),V(n.monthArr),G(n.dateArr)},h=e=>{var t;t=e,$.current.month(t),o();const n=r();N(e),k(l()),B(n.yearArr),V(n.monthArr),G(n.dateArr)},p=e=>{var t;t=e,$.current.date(+t),o(),k(e)},f=()=>{var e;null===(e=t.onDateChange)||void 0===e||e.call(t,i().format(y()),i().toDate())},g=()=>E.current===MODE$1.YEAR_MONTH_DATE||E.current===MODE$1.YEAR_MONTH,m=()=>E.current===MODE$1.YEAR_MONTH_DATE,y=()=>E.current,{date:v,maxDate:_,minDate:b,mode:C}=t,E=reactExports.useRef(C),T=(S=v,P=b,{maxMoment:null!==(w=getMomentKeepNil(_,"YYYY-Q"))&&void 0!==w?w:hooks().add(constants$2.YEARS_AFTER_TODAY,"year"),minMoment:null!==(x=getMomentKeepNil(P,"YYYY-Q"))&&void 0!==x?x:hooks("1900","YYYY"),moment:null!==(O=getMomentKeepNil(S))&&void 0!==O?O:hooks()});var S,P,w,x,O;const $=reactExports.useRef(T.moment),I=reactExports.useRef(T.maxMoment),R=reactExports.useRef(T.minMoment),[A,D]=reactExports.useState(a()),[L,N]=reactExports.useState(s()),[M,k]=reactExports.useState(l()),F=r(),[j,B]=reactExports.useState(F.yearArr),[W,V]=reactExports.useState(F.monthArr),[H,G]=reactExports.useState(F.dateArr);return reactExports.useEffect((()=>{f()}),[A,L,M]),useMount((()=>{o()&&f()})),jsxRuntimeExports.jsx(PickerView,{columns:(()=>{const{locale:e}=useConfig(),t=[j.map((t=>({label:t+e.fine.YEAR,value:t.toString()})))];return g()&&t.push(W.map((t=>({label:t+1+e.fine.MONTH,value:t.toString()})))),m()&&t.push(H.map((t=>({label:t+e.fine.DATE,value:t.toString()})))),t})(),onChange:e=>{e[0]&&e[0]!==A&&d(e[0]),g()&&e[1]&&e[1]!==L&&h(e[1]),m()&&e[2]&&e[2]!==M&&(null==p||p(e[2]))},value:(()=>{const e=[A];return g()&&e.push(L),m()&&e.push(M),e})(),window:t.window})},FORMAT={HMS:"HH:mm:ss",HM:"HH:mm"},defaultProps$9={format:FORMAT.HMS,onTimeChange:()=>{}},TimePicker=e=>{const t=mergeProps(defaultProps$9,e),r=e=>{const{format:r}=t,n=getMoment(e,r);return n.isValid()?n:hooks()},n=e=>{c.current=r(e)},o=()=>c.current,i=()=>{const{format:e}=t;return o().format(e)},a=range$1(0,24),s=range$1(0,60),l=range$1(0,60),c=reactExports.useRef(r(t.time)),[u,d]=reactExports.useState(o().hour().toString()),[h,p]=reactExports.useState(o().minute().toString()),[f,g]=reactExports.useState(o().seconds().toString());return reactExports.useEffect((()=>{(()=>{const{onTimeChange:e}=t;n("".concat(u,":").concat(h,":").concat(f)),e&&e(i())})()}),[u,h,f]),jsxRuntimeExports.jsx(PickerView,{columns:(()=>{const{locale:e}=useConfig(),{format:r}=t,n=[a.map((t=>({label:t+e.fine.HOUR,value:t.toString()}))),s.map((t=>({label:t+e.fine.MINUTE,value:t.toString()})))];return r===FORMAT.HMS&&n.push(l.map((t=>({label:t+e.fine.SECONDS,value:t.toString()})))),n})(),onChange:e=>{e[0]&&u!==e[0]&&d(e[0]),e[1]&&h!==e[1]&&p(e[1]),e[2]&&t.format===FORMAT.HMS&&f!==e[2]&&g(e[2])},value:(()=>{const{format:e}=t,r=[u,h];return e===FORMAT.HMS&&r.push(f),r})(),window:t.window})},defaultProps$8={date:hooks().toDate(),onDateChange:()=>{}},YearQuarterPicker=e=>{const t=()=>{const e=v.current.year(),t=y.current.year(),n=v.current.quarter(),o=y.current.quarter(),a=r(e,t);let s=r(1,4);return e==t?s=r(n,o):+i()===e?s=r(n,4):+i()===t&&(s=r(1,o)),{yearArr:a,quarterArr:s}},r=(e,t)=>e>t?[]:range$1(e,t+1),n=()=>{m.current.isBefore(v.current)?m.current=hooks(v.current):m.current.isAfter(hooks(y.current).add(1,"day"))&&(m.current=hooks(y.current))},o=()=>m.current,i=()=>o().year().toString(),a=()=>o().quarter().toString(),s=e=>{var r;r=e,m.current.year(+r),n();const o=t();b(e),P(o.yearArr),E(a()),x(o.quarterArr)},l=e=>{var r;r=e,m.current.quarter(+r),n();const o=t();E(e),x(o.quarterArr),P(o.yearArr)},c=()=>{var e;null===(e=d.onDateChange)||void 0===e||e.call(d,o().format("YYYY-Q"),o().toDate())},u=e=>{const{locale:t}=useConfig();switch(e){case 1:return t.fine.QUARTER_ONE;case 2:return t.fine.QUARTER_TWO;case 3:return t.fine.QUARTER_THREE;case 4:return t.fine.QUARTER_FOUR;default:return""}},d=mergeProps(defaultProps$8,e),{date:h,maxDate:p,minDate:f}=d,g=((e,t,r)=>{var n,o,i;const a=getMomentKeepNil,s=null!==(n=a(t,"YYYY-Q"))&&void 0!==n?n:hooks().add(200,"year"),l=null!==(o=a(r,"YYYY-Q"))&&void 0!==o?o:hooks("1900","YYYY");let c=null!==(i=a(e,"YYYY-Q"))&&void 0!==i?i:hooks();return c.isBefore(l)?c=hooks(l):c.isAfter(hooks(s).add(1,"day"))&&(c=hooks(s)),{maxMoment:s,minMoment:l,moment:c}})(h,p,f),m=reactExports.useRef(g.moment),y=reactExports.useRef(g.maxMoment),v=reactExports.useRef(g.minMoment),[_,b]=reactExports.useState(i()),[C,E]=reactExports.useState(a()),T=t(),[S,P]=reactExports.useState(T.yearArr),[w,x]=reactExports.useState(T.quarterArr);return reactExports.useEffect((()=>{c()}),[_,C]),jsxRuntimeExports.jsx(PickerView,{columns:(()=>{const{locale:e}=useConfig();return[S.map((t=>({label:t+e.fine.YEAR,value:t.toString()}))),w.map((e=>({label:u(e),value:e.toString()})))]})(),onChange:e=>{e[0]&&e[0]!==_&&s(e[0]),e[1]&&e[1]!==C&&l(e[1])},value:[_,C],window:d.window})},classPrefix$d="fdm-date-time-picker";var MODE,MODE2;MODE2=MODE||(MODE={}),MODE2[MODE2.DATE=1]="DATE",MODE2[MODE2.TIME=2]="TIME",MODE2[MODE2.QUARTER=3]="QUARTER",MODE2[MODE2.DATE_WITHOUT_TIME=4]="DATE_WITHOUT_TIME";const HEADER_POSITION={TOP:"top",BOTTOM:"bottom"},defaultProps$7={format:FORMATS_MAP.DATETIME,headerSite:HEADER_POSITION.TOP,window:window},DateTimePicker=e=>{var t;const r=mergeProps(defaultProps$7,e),{locale:n}=useConfig(),o=e=>{const{format:t}=r,n=hooks(e,t);return n.isValid()?n:hooks()},i=reactExports.useRef(o(r.date)),a=e=>{i.current=o(e)},s=()=>{var e;return null===(e=r.format)||void 0===e?void 0:e.split(" ")[0]},l=()=>i.current.format(r.format)||"",c=()=>r.headerSite===HEADER_POSITION.TOP,u=()=>r.format===FORMATS_MAP.DATETIME,d=()=>{const{onDateTimeChange:e}=r;if(u()){const e="".concat(h," ").concat(f);y(e),a(e)}else a(m);null==e||e(l(),T())},[h,p]=reactExports.useState(i.current.format(s())),[f,g]=reactExports.useState(i.current.format(FORMATS_MAP.TIME)),[m,y]=reactExports.useState(l()),[v,_]=reactExports.useState((e=>{switch(e){case FORMATS_MAP.YEAR_QUARTER:return MODE.QUARTER;case FORMATS_MAP.TIME:return MODE.TIME;case FORMATS_MAP.YEAR:case FORMATS_MAP.YEAR_MONTH:case FORMATS_MAP.YEAR_MONTH_DATE:return MODE.DATE_WITHOUT_TIME;case FORMATS_MAP.DATETIME:default:return MODE.DATE}})(r.format));useUpdateEffect((()=>{null==d||d()}),[h,f]);const b=e=>{g(e),y(e)},C=e=>{p(e),y(e)},E=e=>{const{onDateTimeChange:t}=r;a(e),y(e),null==t||t(l(),T())},T=()=>i.current.toDate(),{maxDate:S,minDate:P}=r,w=()=>jsxRuntimeExports.jsxs("div",Object.assign({className:"date-time-switch"},{children:[jsxRuntimeExports.jsx(Button$2,Object.assign({fill:"none",onClick:()=>_(MODE.DATE)},{children:jsxRuntimeExports.jsx("span",Object.assign({className:classNames$1("text",{"select-header-text":v===MODE.DATE})},{children:h}))})),jsxRuntimeExports.jsx("div",{className:"vertical-line"}),jsxRuntimeExports.jsx(Button$2,Object.assign({fill:"none",onClick:()=>_(MODE.TIME)},{children:jsxRuntimeExports.jsx("span",Object.assign({className:classNames$1("text",{"select-header-text":v===MODE.TIME})},{children:f}))}))]})),x=()=>{let e="";r.format===FORMATS_MAP.YEAR_MONTH_DATE&&(e=n.fine.TODAY),r.format!==FORMATS_MAP.YEAR_MONTH&&r.format!==FORMATS_MAP.MONTH||(e=n.fine.CURRENT_MONTH),r.format!==FORMATS_MAP.DATETIME&&r.format!==FORMATS_MAP.TIME||(e=n.fine.CURRENT_TIME),r.format===FORMATS_MAP.YEAR&&(e=n.fine.CURRENT_YEAR),r.format!==FORMATS_MAP.YEAR_QUARTER&&r.format!==FORMATS_MAP.QUARTER||(e=n.fine.CURRENT_QUARTER);const t=hooks(),o=Boolean(r.maxDate&&t.isAfter(hooks(r.maxDate).format(r.format))||r.minDate&&t.isBefore(hooks(r.minDate).format(r.format)));return e?jsxRuntimeExports.jsx(Button$2,Object.assign({disabled:o,fill:"none",onClick:()=>{var e;const t=new Date,n=hooks(t).format(r.format);$(),null===(e=r.onConfirm)||void 0===e||e.call(r,n,t)}},{children:jsxRuntimeExports.jsx("span",Object.assign({className:"current-text"},{children:e}))})):null},{onLastConfirm:O,setLastConfirmToAbsolute:$}=useGetOrMockPersistentState(),I=()=>{const{cancelText:e=n.fine.CLEAR,isRequired:t,onCancel:o,confirmText:i=n.fine.CONFIRM,onConfirm:a}=r;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[u()&&!c()&&w(),!r.hideHeader&&jsxRuntimeExports.jsxs("div",Object.assign({className:"header","data-id":"".concat(c()?"top":"bottom","-header")},{children:[jsxRuntimeExports.jsx(Button$2,Object.assign({fill:"none",onClick:()=>o&&o(),style:{visibility:t?"hidden":"visible"}},{children:jsxRuntimeExports.jsx("span",Object.assign({"data-id":"cancel-text",className:classNames$1("clear-text")},{children:e}))})),x(),jsxRuntimeExports.jsx(Button$2,Object.assign({fill:"none",onClick:()=>{O(),a&&a(m,T())}},{children:jsxRuntimeExports.jsx("span",Object.assign({"data-id":"confirm-text",className:"confirm-text"},{children:i}))}))]})),u()&&c()&&w()]})};return jsxRuntimeExports.jsxs("div",Object.assign({style:transformStyle(r.style),className:classNames$1("flex-box-default",classPrefix$d,r.className)},{children:[c()?I():null,r.enableOffsetPicker||(null===(t=r.offsetPickerOptions)||void 0===t?void 0:t.enable)?(()=>{switch(v){case MODE.QUARTER:return jsxRuntimeExports.jsx(OffsetPickerWithTab,{offsetPickerOptions:r.offsetPickerOptions,format:s(),defaultValue:h,onChangeInner:(...e)=>{E(...e),C(...e)},onChangeOuter:C,originalPicker:jsxRuntimeExports.jsx(YearQuarterPicker,{date:h,onDateChange:E,maxDate:S,minDate:P,window:r.window})});case MODE.DATE_WITHOUT_TIME:return jsxRuntimeExports.jsx(OffsetPickerWithTab,{offsetPickerOptions:r.offsetPickerOptions,format:s(),defaultValue:h,onChangeInner:C,onChangeOuter:C,originalPicker:jsxRuntimeExports.jsx(DatePicker,{date:h,onDateChange:C,mode:s(),maxDate:S,minDate:P,window:r.window})});case MODE.DATE:return jsxRuntimeExports.jsx(DatePicker,{date:h,onDateChange:C,mode:s(),maxDate:S,minDate:P,window:r.window});case MODE.TIME:return jsxRuntimeExports.jsx(TimePicker,{time:f,onTimeChange:b,window:r.window});default:return null}})():jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[v===MODE.QUARTER?jsxRuntimeExports.jsx(YearQuarterPicker,{date:h,onDateChange:E,maxDate:S,minDate:P,window:r.window}):null,v===MODE.DATE_WITHOUT_TIME||v===MODE.DATE?jsxRuntimeExports.jsx(DatePicker,{date:h,onDateChange:C,mode:s(),maxDate:S,minDate:P,window:r.window}):null,v===MODE.TIME?jsxRuntimeExports.jsx(TimePicker,{time:f,onTimeChange:b,window:r.window}):null]}),c()?null:I()]}))};function getWeekOfMonth(e){const t=hooks(e),r=hooks([t.year(),t.month()]);return Math.ceil((t.date()+r.weekday())/7)}const getPrevWeek=(e,t,r)=>{const n={year:e,month:t,week:r};return n.week>1?n.week--:(n.week=getWeekOfMonth(hooks({year:e,date:1}).month(t-1).subtract(1,"day")),n.month--,n.month<1&&(n.month+=12,n.year--)),n},getNextWeek=(e,t,r)=>{const n={year:e,month:t,week:r},o=getWeekOfMonth(hooks({year:e,date:1}).month(t).subtract(1,"day"));return n.week+1<=o?n.week++:(n.week=1,n.month++,n.month>12&&(n.month-=12,n.year++)),n};function getThemeColor(e){const t=document.createElement("div");t.style.backgroundColor="var(--fdm-color-theme)",t.style.display="none",e.appendChild(t);const r=getComputedStyle(t).getPropertyValue("background-color");return e.removeChild(t),r}const classPrefix$c="fdm-calendar",defaultProps$6={mode:"month",showHeader:!0,showSwitchButton:!1},Calendar=e=>{const t=mergeProps(defaultProps$6,e),{className:r,style:n,mode:o}=t,i=__rest$p(t,["className","style","mode"]),{locale:a}=useConfig(),[s,l]=usePropsValue({value:t.value,defaultValue:t.defaultValue||null,onChange:t.onChange}),c=reactExports.useRef(null),u=[reactExports.useRef(null),reactExports.useRef(null),reactExports.useRef(null)],[d,h]=reactExports.useState(!1),[p,f]=reactExports.useState(0),[g,m]=reactExports.useState((()=>{const e=hooks(t.value||t.defaultValue||new Date);return{year:e.year(),month:e.month()+1}})),[y,v]=reactExports.useState(getWeekOfMonth(s)),[_,b]=reactExports.useState(!1),[C,E]=reactExports.useState({year:0,month:0}),T=useLatest(p);useMount((()=>{const e=c.current;if(e){const t=getThemeColor(e);t&&isLightColor(t)&&h(!0)}})),reactExports.useEffect((()=>{var e,t;if(S()&&(null===(e=R())||void 0===e||e.jumpTo({year:g.year,month:g.month-1}),null===(t=I())||void 0===t||t.jumpTo({year:g.year,month:g.month+1})),P()){const e=hooks(s);let t=1;e.year()===g.year&&e.month()+1===g.month&&(t=getWeekOfMonth(e)),v(t)}}),[o]),reactExports.useEffect((()=>{var e,t;if(!P())return;const{month:r,year:n}=g,o=getPrevWeek(n,r,y);null===(e=R())||void 0===e||e.jumpTo({year:o.year,month:o.month});const i=getNextWeek(n,r,y);null===(t=I())||void 0===t||t.jumpTo({year:i.year,month:i.month})}),[o,g.year,g.month,y]),useUpdateEffect((()=>{var e;s&&(null===(e=$())||void 0===e||e.jumpTo({year:hooks(s).year(),month:hooks(s).month()+1}),P()&&v(getWeekOfMonth(s)))}),[null==s?void 0:s.toString()]);const S=()=>"month"===o,P=()=>"week"===o,w=e=>{let{month:t,year:r}=g,n=y;if(O(e)){const e=getPrevWeek(r,t,n);r=e.year,t=e.month,n=e.week}if(x(e)){const e=getNextWeek(r,t,n);r=e.year,t=e.month,n=e.week}return 0===hooks({year:r,date:1}).month(t-1).weekday()&&n++,n},x=e=>e===(p+1)%3,O=e=>e===(p+2)%3,$=()=>u[p].current,I=()=>u[(p+1)%3].current,R=()=>u[(p+2)%3].current,A=e=>{let t=g.year;e>12&&(e-=12,t++),e<1&&(e+=12,t--),m({year:t,month:e}),v(1)},D=e=>{let t=g.month;return x(e)?t++:O(e)&&t--,(t+11)%12+1},L=jsxRuntimeExports.jsxs("div",Object.assign({className:"".concat(classPrefix$c,"-header"),style:{visibility:_?"hidden":"visible"}},{children:[jsxRuntimeExports.jsxs("div",Object.assign({className:"".concat(classPrefix$c,"-page-text"),onClick:()=>{b(!_),E({year:g.year,month:g.month-1})}},{children:[jsxRuntimeExports.jsx("span",{children:"".concat(g.year).concat(a.fine.YEAR).concat(g.month).concat(a.fine.MONTH)}),jsxRuntimeExports.jsx(Icon$1,{name:"fdm-right"})]})),jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$c,"-today-button"),onClick:()=>{var e;const t=new Date;l(t),null===(e=$())||void 0===e||e.jumpToToday(),P()&&v(getWeekOfMonth(t))}},{children:a.fine.TODAY}))]})),N=jsxRuntimeExports.jsxs("div",Object.assign({className:"".concat(classPrefix$c,"-picker")},{children:[jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$c,"-picker-header")},{children:jsxRuntimeExports.jsxs("div",Object.assign({className:"".concat(classPrefix$c,"-page-text"),onClick:()=>{var e;b(!1),C.year===g.year&&C.month+1===g.month||(null===(e=$())||void 0===e||e.jumpTo({year:C.year,month:C.month+1}),v(1))}},{children:[jsxRuntimeExports.jsx("span",{children:"".concat(C.year).concat(a.fine.YEAR).concat(C.month+1).concat(a.fine.MONTH)}),jsxRuntimeExports.jsx(Icon$1,{name:"fdm-down"})]}))})),jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$c,"-picker-wrapper")},{children:jsxRuntimeExports.jsx(DatePicker,{date:"".concat(C.year,"-").concat(C.month+1),onDateChange:(e,t)=>{E({year:hooks(t).year(),month:hooks(t).month()})},mode:"YYYY-MM",maxDate:t.max,minDate:t.min})}))]}));return withNativeProps(t,jsxRuntimeExports.jsxs("div",Object.assign({className:classNames$1(classPrefix$c,{["".concat(classPrefix$c,"-week")]:P()&&!_,["".concat(classPrefix$c,"-light")]:d}),ref:c},{children:[t.showHeader&&L,jsxRuntimeExports.jsx(Swiper,Object.assign({loop:!0,onIndexChange:e=>{var t,r;if(f(e),P()){if(x(e)){const{year:e,month:t,week:r}=getNextWeek(g.year,g.month,y);m({year:e,month:t}),v(r)}if(O(e)){const{year:e,month:t,week:r}=getPrevWeek(g.year,g.month,y);m({year:e,month:t}),v(r)}}if(S()){const{year:n,month:o}=g;x(e)?(null===(t=R())||void 0===t||t.jumpTo({year:n,month:o+2}),A(o+1)):O(e)&&(null===(r=I())||void 0===r||r.jumpTo({year:n,month:o-2}),A(o-1))}}},{children:range$1(0,3).map((e=>jsxRuntimeExports.jsx(Swiper.Item,{children:jsxRuntimeExports.jsxs("div",Object.assign({className:"".concat(classPrefix$c,"-wrapper")},{children:[jsxRuntimeExports.jsx(Calendar$1,Object.assign({ref:u[e]},i,{className:P()?"week-".concat(w(e)):"",value:s,onChange:e=>{l(e),e&&P()&&v(getWeekOfMonth(e))},selectionMode:"single",onPageChange:(t,r)=>{T.current===e&&((e,t)=>{var r,n;S()&&(null===(r=R())||void 0===r||r.jumpTo({year:e,month:t-1}),null===(n=I())||void 0===n||n.jumpTo({year:e,month:t+1})),m({year:e,month:t})})(t,r)}})),S()&&jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$c,"-month-background")},{children:D(e)}))]}))},e)))})),t.showSwitchButton&&jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$c,"-fold-button")},{children:jsxRuntimeExports.jsx("span",Object.assign({onClick:()=>{var e;const r=S()?"week":"month";null===(e=t.onClickSwitchButton)||void 0===e||e.call(t,r)}},{children:jsxRuntimeExports.jsx(Icon$1,{name:S()?"fdm-fold":"fdm-unfold"})}))})),_&&N]})))},classPrefix$b="fdm-date-time",DateTimeEditor=e=>{const{type:t,maxDate:r,minDate:n,headerSite:o,format:i,isRequired:a,editorShow:s,setEditorShow:l,autoFold:c}=e,u=new Date,d=getMoment(r,i),h=getMoment(n,i),p=e.date||(d.isBefore(u)?d:h.isAfter(u)?h:u);return"calendar"!==t||s?"calendar"===t||"week-calendar"===t?jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$b,"-calendar")},{children:jsxRuntimeExports.jsx(Calendar,{allowClear:!1,mode:"week-calendar"!==t||s?"month":"week",showSwitchButton:!0,onClickSwitchButton:()=>l(!s),value:hooks(p).toDate(),showHeader:e.showCalendarHeader,onChange:t=>{t&&(e.onDateChange(t),c&&l(!1))},max:e.maxDate?hooks(e.maxDate).toDate():void 0,min:e.minDate?hooks(e.minDate).toDate():void 0})})):jsxRuntimeExports.jsx(Popup,Object.assign({className:e.popupClassName,position:"bottom",visible:s,destroyOnClose:!0,maskStyle:{background:MASK_BG},onMaskClick:()=>e.setEditorShow(!1),afterClose:e.afterEditorClose,bodyStyle:{borderRadius:"4px 4px 0 0",overflow:"hidden"},style:transformStyle(e.popupStyle),getContainer:e.getPopupContainer||document.body},{children:jsxRuntimeExports.jsx(DateTimePicker,{style:e.editorStyle,headerSite:o,date:p,format:i,maxDate:r,minDate:n,onCancel:()=>{var t;null===(t=e.onCancel)||void 0===t||t.call(e),l(!1)},onConfirm:(t,r)=>{var n;null===(n=e.onConfirm)||void 0===n||n.call(e,t,r),l(!1)},onDateTimeChange:e.onDateTimeChange,isRequired:a,window:e.window,enableOffsetPicker:e.enableOffsetPicker})})):null},classPrefix$a="fdm-date-time",defaultProps$5={hideBorder:!1,hideIcon:!1,invisible:!1,disabled:!1,invalid:!1,showHeader:!1,autoFold:!1,type:"picker",getPopupContainer:()=>getRootPortalContainer("data-time"),window:getRootWindow()},DateTime$1=e=>{const t=mergeProps(defaultProps$5,e),{watermark:r,invisible:n,disabled:o,invalid:i,text:a="",format:s,date:l,minDate:c,maxDate:u,style:d,hideBorder:h,hideIcon:p,type:f}=t,[g,m]=reactExports.useState(t.autoEditorShow||!1),[y,v]=reactExports.useState(!1),{locale:_}=useConfig(),b=getValidPickerFormat(s),C=e=>{const t=getMoment(e,b);return getDateStringFromMoment(t.isValid()?t:hooks(),b)},E=e=>{var r;const n=hooks(e);null===(r=t.onConfirm)||void 0===r||r.call(t,getDateStringFromMoment(n,b),n.toDate())},T=(()=>{let e="",r="";switch(t.fastButtonType){case"day":e=_.fine.PREV_DAY,r=_.fine.NEXT_DAY;break;case"week":e=_.fine.PREV_WEEK,r=_.fine.NEXT_WEEK;break;case"month":e=_.fine.PREV_MONTH,r=_.fine.NEXT_MONTH;break;case"year":e=_.fine.PREV_YEAR,r=_.fine.NEXT_YEAR}if(!e)return null;const n=e=>{const r=hooks(l).add(e,t.fastButtonType);E(r)};return{prev:jsxRuntimeExports.jsx("span",Object.assign({className:"prev-text",style:t.fastButtonStyle,onClick:()=>n(-1)},{children:e})),next:jsxRuntimeExports.jsx("span",Object.assign({className:"next-text",style:t.fastButtonStyle,onClick:()=>n(1)},{children:r}))}})(),S=a||((P=l)&&t.renderTextWithDate?t.renderTextWithDate(P):"");var P;const w=usePersistentStateOfOffsetPicker(b);return n?null:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",Object.assign({className:classNames$1(classPrefix$a,{"fdm-border-hide":h,"fdm-border-error":i,"fdm-border-theme":y&&!g,"fdm-widget-disable":o}),style:transformStyle(d),onTouchStart:()=>v(!0),onTouchEnd:()=>v(!1),onTouchCancel:()=>v(!1)},{children:["week-calendar"!==f&&jsxRuntimeExports.jsxs("div",Object.assign({className:classNames$1("".concat(classPrefix$a,"-content"),"fdm-widget-default")},{children:[null==T?void 0:T.prev,jsxRuntimeExports.jsx("div",Object.assign({className:"date-button",onClick:()=>{g?m(!1):!t.disabled&&m(!0)}},{children:jsxRuntimeExports.jsxs("div",Object.assign({className:classNames$1("flex-box-default","content"),style:T?{justifyContent:"center"}:{}},{children:[S.length?jsxRuntimeExports.jsx("span",Object.assign({className:"text"},{children:S})):jsxRuntimeExports.jsx("span",Object.assign({className:"watermark"},{children:r})),!p&&jsxRuntimeExports.jsx(Icon$1,{name:"fdm-date",className:classNames$1("icon",{"icon-normal":!i,"fdm-color-error":i})})]}))})),null==T?void 0:T.next]})),jsxRuntimeExports.jsx(OffsetPickerPersistentState.Provider,Object.assign({value:w},{children:jsxRuntimeExports.jsx(DateTimeEditor,Object.assign({},t,{format:b,date:(e=>e?C(e):"")(l||a),minDate:c,maxDate:u,onDateChange:E,editorShow:g,setEditorShow:m}))}))]}))})},DateTime=attachShowProperty(DateTime$1),classPrefix$9="fdm-drop-menu-editor-item",DropMenuItem=e=>{const{text:t,searchText:r}=e,{locale:n}=useConfig(),o=new RegExp("(".concat(strUtils.escapeSpecialChar(r),")"),"i");return jsxRuntimeExports.jsxs("div",Object.assign({className:classNames$1(classPrefix$9,{selected:e.isSelected})},{children:[jsxRuntimeExports.jsx("div",Object.assign({className:"text"},{children:r?jsxRuntimeExports.jsx("span",{dangerouslySetInnerHTML:{__html:t.toString().replace(o,'<span class="fdm-color-theme">$1</span>')}}):t})),e.isCustom?jsxRuntimeExports.jsx("span",Object.assign({className:"custom"},{children:n.fine.CUSTOM_VALUE})):jsxRuntimeExports.jsx("span",{}),jsxRuntimeExports.jsx(Icon$1,{size:16,name:e.iconName,className:"icon-".concat(e.isSelected?"select":"unselect")})]}))};function calculateSizeAndPositionDataAndUpdateScrollOffset(e){var t=e.cellCount,r=e.cellSize,n=e.computeMetadataCallback,o=e.computeMetadataCallbackProps,i=e.nextCellsCount,a=e.nextCellSize,s=e.nextScrollToIndex,l=e.scrollToIndex,c=e.updateScrollOffsetForScrollToIndex;t===i&&("number"!=typeof r&&"number"!=typeof a||r===a)||(n(o),l>=0&&l===s&&c())}var CellSizeAndPositionManager=function(){function e(t){var r=t.cellCount,n=t.cellSizeGetter,o=t.estimatedCellSize;_classCallCheck$2D(this,e),_defineProperty$D(this,"_cellSizeAndPositionData",{}),_defineProperty$D(this,"_lastMeasuredIndex",-1),_defineProperty$D(this,"_lastBatchedIndex",-1),_defineProperty$D(this,"_cellCount",void 0),_defineProperty$D(this,"_cellSizeGetter",void 0),_defineProperty$D(this,"_estimatedCellSize",void 0),this._cellSizeGetter=n,this._cellCount=r,this._estimatedCellSize=o}return _createClass$2D(e,[{key:"areOffsetsAdjusted",value:function(){return!1}},{key:"configure",value:function(e){var t=e.cellCount,r=e.estimatedCellSize,n=e.cellSizeGetter;this._cellCount=t,this._estimatedCellSize=r,this._cellSizeGetter=n}},{key:"getCellCount",value:function(){return this._cellCount}},{key:"getEstimatedCellSize",value:function(){return this._estimatedCellSize}},{key:"getLastMeasuredIndex",value:function(){return this._lastMeasuredIndex}},{key:"getOffsetAdjustment",value:function(){return 0}},{key:"getSizeAndPositionOfCell",value:function(e){if(e<0||e>=this._cellCount)throw Error("Requested index ".concat(e," is outside of range 0..").concat(this._cellCount));if(e>this._lastMeasuredIndex)for(var t=this.getSizeAndPositionOfLastMeasuredCell(),r=t.offset+t.size,n=this._lastMeasuredIndex+1;n<=e;n++){var o=this._cellSizeGetter({index:n});if(void 0===o||isNaN(o))throw Error("Invalid size returned for cell ".concat(n," of value ").concat(o));null===o?(this._cellSizeAndPositionData[n]={offset:r,size:0},this._lastBatchedIndex=e):(this._cellSizeAndPositionData[n]={offset:r,size:o},r+=o,this._lastMeasuredIndex=e)}return this._cellSizeAndPositionData[e]}},{key:"getSizeAndPositionOfLastMeasuredCell",value:function(){return this._lastMeasuredIndex>=0?this._cellSizeAndPositionData[this._lastMeasuredIndex]:{offset:0,size:0}}},{key:"getTotalSize",value:function(){var e=this.getSizeAndPositionOfLastMeasuredCell();return e.offset+e.size+(this._cellCount-this._lastMeasuredIndex-1)*this._estimatedCellSize}},{key:"getUpdatedOffsetForIndex",value:function(e){var t=e.align,r=void 0===t?"auto":t,n=e.containerSize,o=e.currentOffset,i=e.targetIndex;if(n<=0)return 0;var a,s=this.getSizeAndPositionOfCell(i),l=s.offset,c=l-n+s.size;switch(r){case"start":a=l;break;case"end":a=c;break;case"center":a=l-(n-s.size)/2;break;default:a=Math.max(c,Math.min(l,o))}var u=this.getTotalSize();return Math.max(0,Math.min(u-n,a))}},{key:"getVisibleCellRange",value:function(e){var t=e.containerSize,r=e.offset;if(0===this.getTotalSize())return{};var n=r+t,o=this._findNearestCell(r),i=this.getSizeAndPositionOfCell(o);r=i.offset+i.size;for(var a=o;r<n&&a<this._cellCount-1;)a++,r+=this.getSizeAndPositionOfCell(a).size;return{start:o,stop:a}}},{key:"resetCell",value:function(e){this._lastMeasuredIndex=Math.min(this._lastMeasuredIndex,e-1)}},{key:"_binarySearch",value:function(e,t,r){for(;t<=e;){var n=t+Math.floor((e-t)/2),o=this.getSizeAndPositionOfCell(n).offset;if(o===r)return n;o<r?t=n+1:o>r&&(e=n-1)}return t>0?t-1:0}},{key:"_exponentialSearch",value:function(e,t){for(var r=1;e<this._cellCount&&this.getSizeAndPositionOfCell(e).offset<t;)e+=r,r*=2;return this._binarySearch(Math.min(e,this._cellCount-1),Math.floor(e/2),t)}},{key:"_findNearestCell",value:function(e){if(isNaN(e))throw Error("Invalid offset ".concat(e," specified"));e=Math.max(0,e);var t=this.getSizeAndPositionOfLastMeasuredCell(),r=Math.max(0,this._lastMeasuredIndex);return t.offset>=e?this._binarySearch(r,0,e):this._exponentialSearch(r,e)}}]),e}(),DEFAULT_MAX_ELEMENT_SIZE=15e5,CHROME_MAX_ELEMENT_SIZE=16777100,isBrowser$1=function(){return"undefined"!=typeof window},isChrome=function(){return!!window.chrome},getMaxElementSize=function(){return isBrowser$1()&&isChrome()?CHROME_MAX_ELEMENT_SIZE:DEFAULT_MAX_ELEMENT_SIZE},ScalingCellSizeAndPositionManager=function(){function e(t){var r=t.maxScrollSize,n=void 0===r?getMaxElementSize():r,o=_objectWithoutProperties(t,["maxScrollSize"]);_classCallCheck$2D(this,e),_defineProperty$D(this,"_cellSizeAndPositionManager",void 0),_defineProperty$D(this,"_maxScrollSize",void 0),this._cellSizeAndPositionManager=new CellSizeAndPositionManager(o),this._maxScrollSize=n}return _createClass$2D(e,[{key:"areOffsetsAdjusted",value:function(){return this._cellSizeAndPositionManager.getTotalSize()>this._maxScrollSize}},{key:"configure",value:function(e){this._cellSizeAndPositionManager.configure(e)}},{key:"getCellCount",value:function(){return this._cellSizeAndPositionManager.getCellCount()}},{key:"getEstimatedCellSize",value:function(){return this._cellSizeAndPositionManager.getEstimatedCellSize()}},{key:"getLastMeasuredIndex",value:function(){return this._cellSizeAndPositionManager.getLastMeasuredIndex()}},{key:"getOffsetAdjustment",value:function(e){var t=e.containerSize,r=e.offset,n=this._cellSizeAndPositionManager.getTotalSize(),o=this.getTotalSize(),i=this._getOffsetPercentage({containerSize:t,offset:r,totalSize:o});return Math.round(i*(o-n))}},{key:"getSizeAndPositionOfCell",value:function(e){return this._cellSizeAndPositionManager.getSizeAndPositionOfCell(e)}},{key:"getSizeAndPositionOfLastMeasuredCell",value:function(){return this._cellSizeAndPositionManager.getSizeAndPositionOfLastMeasuredCell()}},{key:"getTotalSize",value:function(){return Math.min(this._maxScrollSize,this._cellSizeAndPositionManager.getTotalSize())}},{key:"getUpdatedOffsetForIndex",value:function(e){var t=e.align,r=void 0===t?"auto":t,n=e.containerSize,o=e.currentOffset,i=e.targetIndex;o=this._safeOffsetToOffset({containerSize:n,offset:o});var a=this._cellSizeAndPositionManager.getUpdatedOffsetForIndex({align:r,containerSize:n,currentOffset:o,targetIndex:i});return this._offsetToSafeOffset({containerSize:n,offset:a})}},{key:"getVisibleCellRange",value:function(e){var t=e.containerSize,r=e.offset;return r=this._safeOffsetToOffset({containerSize:t,offset:r}),this._cellSizeAndPositionManager.getVisibleCellRange({containerSize:t,offset:r})}},{key:"resetCell",value:function(e){this._cellSizeAndPositionManager.resetCell(e)}},{key:"_getOffsetPercentage",value:function(e){var t=e.containerSize,r=e.offset,n=e.totalSize;return n<=t?0:r/(n-t)}},{key:"_offsetToSafeOffset",value:function(e){var t=e.containerSize,r=e.offset,n=this._cellSizeAndPositionManager.getTotalSize(),o=this.getTotalSize();if(n===o)return r;var i=this._getOffsetPercentage({containerSize:t,offset:r,totalSize:n});return Math.round(i*(o-t))}},{key:"_safeOffsetToOffset",value:function(e){var t=e.containerSize,r=e.offset,n=this._cellSizeAndPositionManager.getTotalSize(),o=this.getTotalSize();if(n===o)return r;var i=this._getOffsetPercentage({containerSize:t,offset:r,totalSize:o});return Math.round(i*(n-t))}}]),e}();function createCallbackMemoizer(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t={};return function(r){var n=r.callback,o=r.indices,i=Object.keys(o),a=!e||i.every((function(e){var t=o[e];return Array.isArray(t)?t.length>0:t>=0})),s=i.length!==Object.keys(t).length||i.some((function(e){var r=t[e],n=o[e];return Array.isArray(n)?r.join(",")!==n.join(","):r!==n}));t=o,a&&s&&n(o)}}var SCROLL_DIRECTION_BACKWARD=-1,SCROLL_DIRECTION_FORWARD$1=1;function defaultOverscanIndicesGetter$1(e){var t=e.cellCount,r=e.overscanCellsCount,n=e.scrollDirection,o=e.startIndex,i=e.stopIndex;return n===SCROLL_DIRECTION_FORWARD$1?{overscanStartIndex:Math.max(0,o),overscanStopIndex:Math.min(t-1,i+r)}:{overscanStartIndex:Math.max(0,o-r),overscanStopIndex:Math.min(t-1,i)}}function updateScrollIndexHelper(e){var t=e.cellSize,r=e.cellSizeAndPositionManager,n=e.previousCellsCount,o=e.previousCellSize,i=e.previousScrollToAlignment,a=e.previousScrollToIndex,s=e.previousSize,l=e.scrollOffset,c=e.scrollToAlignment,u=e.scrollToIndex,d=e.size,h=e.sizeJustIncreasedFromZero,p=e.updateScrollIndexCallback,f=r.getCellCount(),g=u>=0&&u<f;g&&(d!==s||h||!o||"number"==typeof t&&t!==o||c!==i||u!==a)?p(u):!g&&f>0&&(d<s||f<n)&&l>r.getTotalSize()-d&&p(f-1)}function defaultCellRangeRenderer(e){for(var t=e.cellCache,r=e.cellRenderer,n=e.columnSizeAndPositionManager,o=e.columnStartIndex,i=e.columnStopIndex,a=e.deferredMeasurementCache,s=e.horizontalOffsetAdjustment,l=e.isScrolling,c=e.isScrollingOptOut,u=e.parent,d=e.rowSizeAndPositionManager,h=e.rowStartIndex,p=e.rowStopIndex,f=e.styleCache,g=e.verticalOffsetAdjustment,m=e.visibleColumnIndices,y=e.visibleRowIndices,v=[],_=n.areOffsetsAdjusted()||d.areOffsetsAdjusted(),b=!l&&!_,C=h;C<=p;C++)for(var E=d.getSizeAndPositionOfCell(C),T=o;T<=i;T++){var S=n.getSizeAndPositionOfCell(T),P=T>=m.start&&T<=m.stop&&C>=y.start&&C<=y.stop,w="".concat(C,"-").concat(T),x=void 0;b&&f[w]?x=f[w]:a&&!a.has(C,T)?x={height:"auto",left:0,position:"absolute",top:0,width:"auto"}:(x={height:E.size,left:S.offset+s,position:"absolute",top:E.offset+g,width:S.size},f[w]=x);var O={columnIndex:T,isScrolling:l,isVisible:P,key:w,parent:u,rowIndex:C,style:x},$=void 0;!c&&!l||s||g?$=r(O):(t[w]||(t[w]=r(O)),$=t[w]),null!=$&&!1!==$&&v.push($)}return v}const canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement);var size,win;function scrollbarSize(e){if((!size&&0!==size||e)&&canUseDOM){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),size=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return size}win="undefined"!=typeof window?window:"undefined"!=typeof self?self:{};var request$1=win.requestAnimationFrame||win.webkitRequestAnimationFrame||win.mozRequestAnimationFrame||win.oRequestAnimationFrame||win.msRequestAnimationFrame||function(e){return win.setTimeout(e,1e3/60)},cancel=win.cancelAnimationFrame||win.webkitCancelAnimationFrame||win.mozCancelAnimationFrame||win.oCancelAnimationFrame||win.msCancelAnimationFrame||function(e){win.clearTimeout(e)},raf$1=request$1,caf=cancel,cancelAnimationTimeout=function(e){return caf(e.id)},requestAnimationTimeout=function(e,t){var r;Promise.resolve().then((function(){r=Date.now()}));var n={id:raf$1((function o(){Date.now()-r>=t?e.call():n.id=raf$1(o)}))};return n},_class$6,_temp$6;function ownKeys$7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$7(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$7(r,!0).forEach((function(t){_defineProperty$D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$7(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var DEFAULT_SCROLLING_RESET_TIME_INTERVAL$1=150,SCROLL_POSITION_CHANGE_REASONS$1={OBSERVED:"observed",REQUESTED:"requested"},renderNull=function(){return null},Grid$1=(_temp$6=_class$6=function(e){function t(e){var r;_classCallCheck$2D(this,t),r=_possibleConstructorReturn$27(this,_getPrototypeOf$27(t).call(this,e)),_defineProperty$D(_assertThisInitialized$27(r),"_onGridRenderedMemoizer",createCallbackMemoizer()),_defineProperty$D(_assertThisInitialized$27(r),"_onScrollMemoizer",createCallbackMemoizer(!1)),_defineProperty$D(_assertThisInitialized$27(r),"_deferredInvalidateColumnIndex",null),_defineProperty$D(_assertThisInitialized$27(r),"_deferredInvalidateRowIndex",null),_defineProperty$D(_assertThisInitialized$27(r),"_recomputeScrollLeftFlag",!1),_defineProperty$D(_assertThisInitialized$27(r),"_recomputeScrollTopFlag",!1),_defineProperty$D(_assertThisInitialized$27(r),"_horizontalScrollBarSize",0),_defineProperty$D(_assertThisInitialized$27(r),"_verticalScrollBarSize",0),_defineProperty$D(_assertThisInitialized$27(r),"_scrollbarPresenceChanged",!1),_defineProperty$D(_assertThisInitialized$27(r),"_scrollingContainer",void 0),_defineProperty$D(_assertThisInitialized$27(r),"_childrenToDisplay",void 0),_defineProperty$D(_assertThisInitialized$27(r),"_columnStartIndex",void 0),_defineProperty$D(_assertThisInitialized$27(r),"_columnStopIndex",void 0),_defineProperty$D(_assertThisInitialized$27(r),"_rowStartIndex",void 0),_defineProperty$D(_assertThisInitialized$27(r),"_rowStopIndex",void 0),_defineProperty$D(_assertThisInitialized$27(r),"_renderedColumnStartIndex",0),_defineProperty$D(_assertThisInitialized$27(r),"_renderedColumnStopIndex",0),_defineProperty$D(_assertThisInitialized$27(r),"_renderedRowStartIndex",0),_defineProperty$D(_assertThisInitialized$27(r),"_renderedRowStopIndex",0),_defineProperty$D(_assertThisInitialized$27(r),"_initialScrollTop",void 0),_defineProperty$D(_assertThisInitialized$27(r),"_initialScrollLeft",void 0),_defineProperty$D(_assertThisInitialized$27(r),"_disablePointerEventsTimeoutId",void 0),_defineProperty$D(_assertThisInitialized$27(r),"_styleCache",{}),_defineProperty$D(_assertThisInitialized$27(r),"_cellCache",{}),_defineProperty$D(_assertThisInitialized$27(r),"_debounceScrollEndedCallback",(function(){r._disablePointerEventsTimeoutId=null,r.setState({isScrolling:!1,needToResetStyleCache:!1})})),_defineProperty$D(_assertThisInitialized$27(r),"_invokeOnGridRenderedHelper",(function(){var e=r.props.onSectionRendered;r._onGridRenderedMemoizer({callback:e,indices:{columnOverscanStartIndex:r._columnStartIndex,columnOverscanStopIndex:r._columnStopIndex,columnStartIndex:r._renderedColumnStartIndex,columnStopIndex:r._renderedColumnStopIndex,rowOverscanStartIndex:r._rowStartIndex,rowOverscanStopIndex:r._rowStopIndex,rowStartIndex:r._renderedRowStartIndex,rowStopIndex:r._renderedRowStopIndex}})})),_defineProperty$D(_assertThisInitialized$27(r),"_setScrollingContainerRef",(function(e){r._scrollingContainer=e})),_defineProperty$D(_assertThisInitialized$27(r),"_onScroll",(function(e){e.target===r._scrollingContainer&&r.handleScrollEvent(e.target)}));var n=new ScalingCellSizeAndPositionManager({cellCount:e.columnCount,cellSizeGetter:function(r){return t._wrapSizeGetter(e.columnWidth)(r)},estimatedCellSize:t._getEstimatedColumnSize(e)}),o=new ScalingCellSizeAndPositionManager({cellCount:e.rowCount,cellSizeGetter:function(r){return t._wrapSizeGetter(e.rowHeight)(r)},estimatedCellSize:t._getEstimatedRowSize(e)});return r.state={instanceProps:{columnSizeAndPositionManager:n,rowSizeAndPositionManager:o,prevColumnWidth:e.columnWidth,prevRowHeight:e.rowHeight,prevColumnCount:e.columnCount,prevRowCount:e.rowCount,prevIsScrolling:!0===e.isScrolling,prevScrollToColumn:e.scrollToColumn,prevScrollToRow:e.scrollToRow,scrollbarSize:0,scrollbarSizeMeasured:!1},isScrolling:!1,scrollDirectionHorizontal:SCROLL_DIRECTION_FORWARD$1,scrollDirectionVertical:SCROLL_DIRECTION_FORWARD$1,scrollLeft:0,scrollTop:0,scrollPositionChangeReason:null,needToResetStyleCache:!1},e.scrollToRow>0&&(r._initialScrollTop=r._getCalculatedScrollTop(e,r.state)),e.scrollToColumn>0&&(r._initialScrollLeft=r._getCalculatedScrollLeft(e,r.state)),r}return _inherits$27(t,e),_createClass$2D(t,[{key:"getOffsetForCell",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.alignment,r=void 0===t?this.props.scrollToAlignment:t,n=e.columnIndex,o=void 0===n?this.props.scrollToColumn:n,i=e.rowIndex,a=void 0===i?this.props.scrollToRow:i,s=_objectSpread$7({},this.props,{scrollToAlignment:r,scrollToColumn:o,scrollToRow:a});return{scrollLeft:this._getCalculatedScrollLeft(s),scrollTop:this._getCalculatedScrollTop(s)}}},{key:"getTotalRowsHeight",value:function(){return this.state.instanceProps.rowSizeAndPositionManager.getTotalSize()}},{key:"getTotalColumnsWidth",value:function(){return this.state.instanceProps.columnSizeAndPositionManager.getTotalSize()}},{key:"handleScrollEvent",value:function(e){var t=e.scrollLeft,r=void 0===t?0:t,n=e.scrollTop,o=void 0===n?0:n;if(!(o<0)){this._debounceScrollEnded();var i=this.props,a=i.autoHeight,s=i.autoWidth,l=i.height,c=i.width,u=this.state.instanceProps,d=u.scrollbarSize,h=u.rowSizeAndPositionManager.getTotalSize(),p=u.columnSizeAndPositionManager.getTotalSize(),f=Math.min(Math.max(0,p-c+d),r),g=Math.min(Math.max(0,h-l+d),o);if(this.state.scrollLeft!==f||this.state.scrollTop!==g){var m={isScrolling:!0,scrollDirectionHorizontal:f!==this.state.scrollLeft?f>this.state.scrollLeft?SCROLL_DIRECTION_FORWARD$1:SCROLL_DIRECTION_BACKWARD:this.state.scrollDirectionHorizontal,scrollDirectionVertical:g!==this.state.scrollTop?g>this.state.scrollTop?SCROLL_DIRECTION_FORWARD$1:SCROLL_DIRECTION_BACKWARD:this.state.scrollDirectionVertical,scrollPositionChangeReason:SCROLL_POSITION_CHANGE_REASONS$1.OBSERVED};a||(m.scrollTop=g),s||(m.scrollLeft=f),m.needToResetStyleCache=!1,this.setState(m)}this._invokeOnScrollMemoizer({scrollLeft:f,scrollTop:g,totalColumnsWidth:p,totalRowsHeight:h})}}},{key:"invalidateCellSizeAfterRender",value:function(e){var t=e.columnIndex,r=e.rowIndex;this._deferredInvalidateColumnIndex="number"==typeof this._deferredInvalidateColumnIndex?Math.min(this._deferredInvalidateColumnIndex,t):t,this._deferredInvalidateRowIndex="number"==typeof this._deferredInvalidateRowIndex?Math.min(this._deferredInvalidateRowIndex,r):r}},{key:"measureAllCells",value:function(){var e=this.props,t=e.columnCount,r=e.rowCount,n=this.state.instanceProps;n.columnSizeAndPositionManager.getSizeAndPositionOfCell(t-1),n.rowSizeAndPositionManager.getSizeAndPositionOfCell(r-1)}},{key:"recomputeGridSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.columnIndex,r=void 0===t?0:t,n=e.rowIndex,o=void 0===n?0:n,i=this.props,a=i.scrollToColumn,s=i.scrollToRow,l=this.state.instanceProps;l.columnSizeAndPositionManager.resetCell(r),l.rowSizeAndPositionManager.resetCell(o),this._recomputeScrollLeftFlag=a>=0&&(this.state.scrollDirectionHorizontal===SCROLL_DIRECTION_FORWARD$1?r<=a:r>=a),this._recomputeScrollTopFlag=s>=0&&(this.state.scrollDirectionVertical===SCROLL_DIRECTION_FORWARD$1?o<=s:o>=s),this._styleCache={},this._cellCache={},this.forceUpdate()}},{key:"scrollToCell",value:function(e){var t=e.columnIndex,r=e.rowIndex,n=this.props.columnCount,o=this.props;n>1&&void 0!==t&&this._updateScrollLeftForScrollToColumn(_objectSpread$7({},o,{scrollToColumn:t})),void 0!==r&&this._updateScrollTopForScrollToRow(_objectSpread$7({},o,{scrollToRow:r}))}},{key:"componentDidMount",value:function(){var e=this.props,r=e.getScrollbarSize,n=e.height,o=e.scrollLeft,i=e.scrollToColumn,a=e.scrollTop,s=e.scrollToRow,l=e.width,c=this.state.instanceProps;if(this._initialScrollTop=0,this._initialScrollLeft=0,this._handleInvalidatedGridSize(),c.scrollbarSizeMeasured||this.setState((function(e){var t=_objectSpread$7({},e,{needToResetStyleCache:!1});return t.instanceProps.scrollbarSize=r(),t.instanceProps.scrollbarSizeMeasured=!0,t})),"number"==typeof o&&o>=0||"number"==typeof a&&a>=0){var u=t._getScrollToPositionStateUpdate({prevState:this.state,scrollLeft:o,scrollTop:a});u&&(u.needToResetStyleCache=!1,this.setState(u))}this._scrollingContainer&&(this._scrollingContainer.scrollLeft!==this.state.scrollLeft&&(this._scrollingContainer.scrollLeft=this.state.scrollLeft),this._scrollingContainer.scrollTop!==this.state.scrollTop&&(this._scrollingContainer.scrollTop=this.state.scrollTop));var d=n>0&&l>0;i>=0&&d&&this._updateScrollLeftForScrollToColumn(),s>=0&&d&&this._updateScrollTopForScrollToRow(),this._invokeOnGridRenderedHelper(),this._invokeOnScrollMemoizer({scrollLeft:o||0,scrollTop:a||0,totalColumnsWidth:c.columnSizeAndPositionManager.getTotalSize(),totalRowsHeight:c.rowSizeAndPositionManager.getTotalSize()}),this._maybeCallOnScrollbarPresenceChange()}},{key:"componentDidUpdate",value:function(e,t){var r=this,n=this.props,o=n.autoHeight,i=n.autoWidth,a=n.columnCount,s=n.height,l=n.rowCount,c=n.scrollToAlignment,u=n.scrollToColumn,d=n.scrollToRow,h=n.width,p=this.state,f=p.scrollLeft,g=p.scrollPositionChangeReason,m=p.scrollTop,y=p.instanceProps;this._handleInvalidatedGridSize();var v=a>0&&0===e.columnCount||l>0&&0===e.rowCount;g===SCROLL_POSITION_CHANGE_REASONS$1.REQUESTED&&(!i&&f>=0&&(f!==this._scrollingContainer.scrollLeft||v)&&(this._scrollingContainer.scrollLeft=f),!o&&m>=0&&(m!==this._scrollingContainer.scrollTop||v)&&(this._scrollingContainer.scrollTop=m));var _=(0===e.width||0===e.height)&&s>0&&h>0;if(this._recomputeScrollLeftFlag?(this._recomputeScrollLeftFlag=!1,this._updateScrollLeftForScrollToColumn(this.props)):updateScrollIndexHelper({cellSizeAndPositionManager:y.columnSizeAndPositionManager,previousCellsCount:e.columnCount,previousCellSize:e.columnWidth,previousScrollToAlignment:e.scrollToAlignment,previousScrollToIndex:e.scrollToColumn,previousSize:e.width,scrollOffset:f,scrollToAlignment:c,scrollToIndex:u,size:h,sizeJustIncreasedFromZero:_,updateScrollIndexCallback:function(){return r._updateScrollLeftForScrollToColumn(r.props)}}),this._recomputeScrollTopFlag?(this._recomputeScrollTopFlag=!1,this._updateScrollTopForScrollToRow(this.props)):updateScrollIndexHelper({cellSizeAndPositionManager:y.rowSizeAndPositionManager,previousCellsCount:e.rowCount,previousCellSize:e.rowHeight,previousScrollToAlignment:e.scrollToAlignment,previousScrollToIndex:e.scrollToRow,previousSize:e.height,scrollOffset:m,scrollToAlignment:c,scrollToIndex:d,size:s,sizeJustIncreasedFromZero:_,updateScrollIndexCallback:function(){return r._updateScrollTopForScrollToRow(r.props)}}),this._invokeOnGridRenderedHelper(),f!==t.scrollLeft||m!==t.scrollTop){var b=y.rowSizeAndPositionManager.getTotalSize(),C=y.columnSizeAndPositionManager.getTotalSize();this._invokeOnScrollMemoizer({scrollLeft:f,scrollTop:m,totalColumnsWidth:C,totalRowsHeight:b})}this._maybeCallOnScrollbarPresenceChange()}},{key:"componentWillUnmount",value:function(){this._disablePointerEventsTimeoutId&&cancelAnimationTimeout(this._disablePointerEventsTimeoutId)}},{key:"render",value:function(){var e=this.props,t=e.autoContainerWidth,r=e.autoHeight,n=e.autoWidth,o=e.className,i=e.containerProps,a=e.containerRole,s=e.containerStyle,l=e.height,c=e.id,u=e.noContentRenderer,d=e.role,h=e.style,p=e.tabIndex,f=e.width,g=this.state,m=g.instanceProps,y=g.needToResetStyleCache,v=this._isScrolling(),_={boxSizing:"border-box",direction:"ltr",height:r?"auto":l,position:"relative",width:n?"auto":f,WebkitOverflowScrolling:"touch",willChange:"transform"};y&&(this._styleCache={}),this.state.isScrolling||this._resetStyleCache(),this._calculateChildrenToRender(this.props,this.state);var b=m.columnSizeAndPositionManager.getTotalSize(),C=m.rowSizeAndPositionManager.getTotalSize(),E=C>l?m.scrollbarSize:0,T=b>f?m.scrollbarSize:0;T===this._horizontalScrollBarSize&&E===this._verticalScrollBarSize||(this._horizontalScrollBarSize=T,this._verticalScrollBarSize=E,this._scrollbarPresenceChanged=!0),_.overflowX=b+E<=f?"hidden":"auto",_.overflowY=C+T<=l?"hidden":"auto";var S=this._childrenToDisplay,P=0===S.length&&l>0&&f>0;return reactExports.createElement("div",_extends$4({ref:this._setScrollingContainerRef},i,{"aria-label":this.props["aria-label"],"aria-readonly":this.props["aria-readonly"],className:clsx$1("ReactVirtualized__Grid",o),id:c,onScroll:this._onScroll,role:d,style:_objectSpread$7({},_,{},h),tabIndex:p}),S.length>0&&reactExports.createElement("div",{className:"ReactVirtualized__Grid__innerScrollContainer",role:a,style:_objectSpread$7({width:t?"auto":b,height:C,maxWidth:b,maxHeight:C,overflow:"hidden",pointerEvents:v?"none":"",position:"relative"},s)},S),P&&u())}},{key:"_calculateChildrenToRender",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state,r=e.cellRenderer,n=e.cellRangeRenderer,o=e.columnCount,i=e.deferredMeasurementCache,a=e.height,s=e.overscanColumnCount,l=e.overscanIndicesGetter,c=e.overscanRowCount,u=e.rowCount,d=e.width,h=e.isScrollingOptOut,p=t.scrollDirectionHorizontal,f=t.scrollDirectionVertical,g=t.instanceProps,m=this._initialScrollTop>0?this._initialScrollTop:t.scrollTop,y=this._initialScrollLeft>0?this._initialScrollLeft:t.scrollLeft,v=this._isScrolling(e,t);if(this._childrenToDisplay=[],a>0&&d>0){var _=g.columnSizeAndPositionManager.getVisibleCellRange({containerSize:d,offset:y}),b=g.rowSizeAndPositionManager.getVisibleCellRange({containerSize:a,offset:m}),C=g.columnSizeAndPositionManager.getOffsetAdjustment({containerSize:d,offset:y}),E=g.rowSizeAndPositionManager.getOffsetAdjustment({containerSize:a,offset:m});this._renderedColumnStartIndex=_.start,this._renderedColumnStopIndex=_.stop,this._renderedRowStartIndex=b.start,this._renderedRowStopIndex=b.stop;var T=l({direction:"horizontal",cellCount:o,overscanCellsCount:s,scrollDirection:p,startIndex:"number"==typeof _.start?_.start:0,stopIndex:"number"==typeof _.stop?_.stop:-1}),S=l({direction:"vertical",cellCount:u,overscanCellsCount:c,scrollDirection:f,startIndex:"number"==typeof b.start?b.start:0,stopIndex:"number"==typeof b.stop?b.stop:-1}),P=T.overscanStartIndex,w=T.overscanStopIndex,x=S.overscanStartIndex,O=S.overscanStopIndex;if(i){if(!i.hasFixedHeight())for(var $=x;$<=O;$++)if(!i.has($,0)){P=0,w=o-1;break}if(!i.hasFixedWidth())for(var I=P;I<=w;I++)if(!i.has(0,I)){x=0,O=u-1;break}}this._childrenToDisplay=n({cellCache:this._cellCache,cellRenderer:r,columnSizeAndPositionManager:g.columnSizeAndPositionManager,columnStartIndex:P,columnStopIndex:w,deferredMeasurementCache:i,horizontalOffsetAdjustment:C,isScrolling:v,isScrollingOptOut:h,parent:this,rowSizeAndPositionManager:g.rowSizeAndPositionManager,rowStartIndex:x,rowStopIndex:O,scrollLeft:y,scrollTop:m,styleCache:this._styleCache,verticalOffsetAdjustment:E,visibleColumnIndices:_,visibleRowIndices:b}),this._columnStartIndex=P,this._columnStopIndex=w,this._rowStartIndex=x,this._rowStopIndex=O}}},{key:"_debounceScrollEnded",value:function(){var e=this.props.scrollingResetTimeInterval;this._disablePointerEventsTimeoutId&&cancelAnimationTimeout(this._disablePointerEventsTimeoutId),this._disablePointerEventsTimeoutId=requestAnimationTimeout(this._debounceScrollEndedCallback,e)}},{key:"_handleInvalidatedGridSize",value:function(){if("number"==typeof this._deferredInvalidateColumnIndex&&"number"==typeof this._deferredInvalidateRowIndex){var e=this._deferredInvalidateColumnIndex,t=this._deferredInvalidateRowIndex;this._deferredInvalidateColumnIndex=null,this._deferredInvalidateRowIndex=null,this.recomputeGridSize({columnIndex:e,rowIndex:t})}}},{key:"_invokeOnScrollMemoizer",value:function(e){var t=this,r=e.scrollLeft,n=e.scrollTop,o=e.totalColumnsWidth,i=e.totalRowsHeight;this._onScrollMemoizer({callback:function(e){var r=e.scrollLeft,n=e.scrollTop,a=t.props,s=a.height;(0,a.onScroll)({clientHeight:s,clientWidth:a.width,scrollHeight:i,scrollLeft:r,scrollTop:n,scrollWidth:o})},indices:{scrollLeft:r,scrollTop:n}})}},{key:"_isScrolling",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state;return Object.hasOwnProperty.call(e,"isScrolling")?Boolean(e.isScrolling):Boolean(t.isScrolling)}},{key:"_maybeCallOnScrollbarPresenceChange",value:function(){if(this._scrollbarPresenceChanged){var e=this.props.onScrollbarPresenceChange;this._scrollbarPresenceChanged=!1,e({horizontal:this._horizontalScrollBarSize>0,size:this.state.instanceProps.scrollbarSize,vertical:this._verticalScrollBarSize>0})}}},{key:"scrollToPosition",value:function(e){var r=e.scrollLeft,n=e.scrollTop,o=t._getScrollToPositionStateUpdate({prevState:this.state,scrollLeft:r,scrollTop:n});o&&(o.needToResetStyleCache=!1,this.setState(o))}},{key:"_getCalculatedScrollLeft",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state;return t._getCalculatedScrollLeft(e,r)}},{key:"_updateScrollLeftForScrollToColumn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state,n=t._getScrollLeftForScrollToColumnStateUpdate(e,r);n&&(n.needToResetStyleCache=!1,this.setState(n))}},{key:"_getCalculatedScrollTop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state;return t._getCalculatedScrollTop(e,r)}},{key:"_resetStyleCache",value:function(){var e=this._styleCache,t=this._cellCache,r=this.props.isScrollingOptOut;this._cellCache={},this._styleCache={};for(var n=this._rowStartIndex;n<=this._rowStopIndex;n++)for(var o=this._columnStartIndex;o<=this._columnStopIndex;o++){var i="".concat(n,"-").concat(o);this._styleCache[i]=e[i],r&&(this._cellCache[i]=t[i])}}},{key:"_updateScrollTopForScrollToRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state,n=t._getScrollTopForScrollToRowStateUpdate(e,r);n&&(n.needToResetStyleCache=!1,this.setState(n))}}],[{key:"getDerivedStateFromProps",value:function(e,r){var n={};0===e.columnCount&&0!==r.scrollLeft||0===e.rowCount&&0!==r.scrollTop?(n.scrollLeft=0,n.scrollTop=0):(e.scrollLeft!==r.scrollLeft&&e.scrollToColumn<0||e.scrollTop!==r.scrollTop&&e.scrollToRow<0)&&Object.assign(n,t._getScrollToPositionStateUpdate({prevState:r,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}));var o,i,a=r.instanceProps;return n.needToResetStyleCache=!1,e.columnWidth===a.prevColumnWidth&&e.rowHeight===a.prevRowHeight||(n.needToResetStyleCache=!0),a.columnSizeAndPositionManager.configure({cellCount:e.columnCount,estimatedCellSize:t._getEstimatedColumnSize(e),cellSizeGetter:t._wrapSizeGetter(e.columnWidth)}),a.rowSizeAndPositionManager.configure({cellCount:e.rowCount,estimatedCellSize:t._getEstimatedRowSize(e),cellSizeGetter:t._wrapSizeGetter(e.rowHeight)}),0!==a.prevColumnCount&&0!==a.prevRowCount||(a.prevColumnCount=0,a.prevRowCount=0),e.autoHeight&&!1===e.isScrolling&&!0===a.prevIsScrolling&&Object.assign(n,{isScrolling:!1}),calculateSizeAndPositionDataAndUpdateScrollOffset({cellCount:a.prevColumnCount,cellSize:"number"==typeof a.prevColumnWidth?a.prevColumnWidth:null,computeMetadataCallback:function(){return a.columnSizeAndPositionManager.resetCell(0)},computeMetadataCallbackProps:e,nextCellsCount:e.columnCount,nextCellSize:"number"==typeof e.columnWidth?e.columnWidth:null,nextScrollToIndex:e.scrollToColumn,scrollToIndex:a.prevScrollToColumn,updateScrollOffsetForScrollToIndex:function(){o=t._getScrollLeftForScrollToColumnStateUpdate(e,r)}}),calculateSizeAndPositionDataAndUpdateScrollOffset({cellCount:a.prevRowCount,cellSize:"number"==typeof a.prevRowHeight?a.prevRowHeight:null,computeMetadataCallback:function(){return a.rowSizeAndPositionManager.resetCell(0)},computeMetadataCallbackProps:e,nextCellsCount:e.rowCount,nextCellSize:"number"==typeof e.rowHeight?e.rowHeight:null,nextScrollToIndex:e.scrollToRow,scrollToIndex:a.prevScrollToRow,updateScrollOffsetForScrollToIndex:function(){i=t._getScrollTopForScrollToRowStateUpdate(e,r)}}),a.prevColumnCount=e.columnCount,a.prevColumnWidth=e.columnWidth,a.prevIsScrolling=!0===e.isScrolling,a.prevRowCount=e.rowCount,a.prevRowHeight=e.rowHeight,a.prevScrollToColumn=e.scrollToColumn,a.prevScrollToRow=e.scrollToRow,a.scrollbarSize=e.getScrollbarSize(),void 0===a.scrollbarSize?(a.scrollbarSizeMeasured=!1,a.scrollbarSize=0):a.scrollbarSizeMeasured=!0,n.instanceProps=a,_objectSpread$7({},n,{},o,{},i)}},{key:"_getEstimatedColumnSize",value:function(e){return"number"==typeof e.columnWidth?e.columnWidth:e.estimatedColumnSize}},{key:"_getEstimatedRowSize",value:function(e){return"number"==typeof e.rowHeight?e.rowHeight:e.estimatedRowSize}},{key:"_getScrollToPositionStateUpdate",value:function(e){var t=e.prevState,r=e.scrollLeft,n=e.scrollTop,o={scrollPositionChangeReason:SCROLL_POSITION_CHANGE_REASONS$1.REQUESTED};return"number"==typeof r&&r>=0&&(o.scrollDirectionHorizontal=r>t.scrollLeft?SCROLL_DIRECTION_FORWARD$1:SCROLL_DIRECTION_BACKWARD,o.scrollLeft=r),"number"==typeof n&&n>=0&&(o.scrollDirectionVertical=n>t.scrollTop?SCROLL_DIRECTION_FORWARD$1:SCROLL_DIRECTION_BACKWARD,o.scrollTop=n),"number"==typeof r&&r>=0&&r!==t.scrollLeft||"number"==typeof n&&n>=0&&n!==t.scrollTop?o:{}}},{key:"_wrapSizeGetter",value:function(e){return"function"==typeof e?e:function(){return e}}},{key:"_getCalculatedScrollLeft",value:function(e,t){var r=e.columnCount,n=e.height,o=e.scrollToAlignment,i=e.scrollToColumn,a=e.width,s=t.scrollLeft,l=t.instanceProps;if(r>0){var c=r-1,u=i<0?c:Math.min(c,i),d=l.rowSizeAndPositionManager.getTotalSize(),h=l.scrollbarSizeMeasured&&d>n?l.scrollbarSize:0;return l.columnSizeAndPositionManager.getUpdatedOffsetForIndex({align:o,containerSize:a-h,currentOffset:s,targetIndex:u})}return 0}},{key:"_getScrollLeftForScrollToColumnStateUpdate",value:function(e,r){var n=r.scrollLeft,o=t._getCalculatedScrollLeft(e,r);return"number"==typeof o&&o>=0&&n!==o?t._getScrollToPositionStateUpdate({prevState:r,scrollLeft:o,scrollTop:-1}):{}}},{key:"_getCalculatedScrollTop",value:function(e,t){var r=e.height,n=e.rowCount,o=e.scrollToAlignment,i=e.scrollToRow,a=e.width,s=t.scrollTop,l=t.instanceProps;if(n>0){var c=n-1,u=i<0?c:Math.min(c,i),d=l.columnSizeAndPositionManager.getTotalSize(),h=l.scrollbarSizeMeasured&&d>a?l.scrollbarSize:0;return l.rowSizeAndPositionManager.getUpdatedOffsetForIndex({align:o,containerSize:r-h,currentOffset:s,targetIndex:u})}return 0}},{key:"_getScrollTopForScrollToRowStateUpdate",value:function(e,r){var n=r.scrollTop,o=t._getCalculatedScrollTop(e,r);return"number"==typeof o&&o>=0&&n!==o?t._getScrollToPositionStateUpdate({prevState:r,scrollLeft:-1,scrollTop:o}):{}}}]),t}(reactExports.PureComponent),_defineProperty$D(_class$6,"propTypes",null),_temp$6);_defineProperty$D(Grid$1,"defaultProps",{"aria-label":"grid","aria-readonly":!0,autoContainerWidth:!1,autoHeight:!1,autoWidth:!1,cellRangeRenderer:defaultCellRangeRenderer,containerRole:"rowgroup",containerStyle:{},estimatedColumnSize:100,estimatedRowSize:30,getScrollbarSize:scrollbarSize,noContentRenderer:renderNull,onScroll:function(){},onScrollbarPresenceChange:function(){},onSectionRendered:function(){},overscanColumnCount:0,overscanIndicesGetter:defaultOverscanIndicesGetter$1,overscanRowCount:10,role:"grid",scrollingResetTimeInterval:DEFAULT_SCROLLING_RESET_TIME_INTERVAL$1,scrollToAlignment:"auto",scrollToColumn:-1,scrollToRow:-1,style:{},tabIndex:0,isScrollingOptOut:!1}),polyfill(Grid$1);var SCROLL_DIRECTION_FORWARD=1,_class$5,_temp$5;function defaultOverscanIndicesGetter(e){var t=e.cellCount,r=e.overscanCellsCount,n=e.scrollDirection,o=e.startIndex,i=e.stopIndex;return r=Math.max(1,r),n===SCROLL_DIRECTION_FORWARD?{overscanStartIndex:Math.max(0,o-1),overscanStopIndex:Math.min(t-1,i+r)}:{overscanStartIndex:Math.max(0,o-r),overscanStopIndex:Math.min(t-1,i+1)}}function ownKeys$6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$6(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$6(r,!0).forEach((function(t){_defineProperty$D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$6(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ArrowKeyStepper=(_temp$5=_class$5=function(e){function t(){var e,r;_classCallCheck$2D(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return r=_possibleConstructorReturn$27(this,(e=_getPrototypeOf$27(t)).call.apply(e,[this].concat(o))),_defineProperty$D(_assertThisInitialized$27(r),"state",{scrollToColumn:0,scrollToRow:0,instanceProps:{prevScrollToColumn:0,prevScrollToRow:0}}),_defineProperty$D(_assertThisInitialized$27(r),"_columnStartIndex",0),_defineProperty$D(_assertThisInitialized$27(r),"_columnStopIndex",0),_defineProperty$D(_assertThisInitialized$27(r),"_rowStartIndex",0),_defineProperty$D(_assertThisInitialized$27(r),"_rowStopIndex",0),_defineProperty$D(_assertThisInitialized$27(r),"_onKeyDown",(function(e){var t=r.props,n=t.columnCount,o=t.disabled,i=t.mode,a=t.rowCount;if(!o){var s=r._getScrollState(),l=s.scrollToColumn,c=s.scrollToRow,u=r._getScrollState(),d=u.scrollToColumn,h=u.scrollToRow;switch(e.key){case"ArrowDown":h="cells"===i?Math.min(h+1,a-1):Math.min(r._rowStopIndex+1,a-1);break;case"ArrowLeft":d="cells"===i?Math.max(d-1,0):Math.max(r._columnStartIndex-1,0);break;case"ArrowRight":d="cells"===i?Math.min(d+1,n-1):Math.min(r._columnStopIndex+1,n-1);break;case"ArrowUp":h="cells"===i?Math.max(h-1,0):Math.max(r._rowStartIndex-1,0)}d===l&&h===c||(e.preventDefault(),r._updateScrollState({scrollToColumn:d,scrollToRow:h}))}})),_defineProperty$D(_assertThisInitialized$27(r),"_onSectionRendered",(function(e){var t=e.columnStartIndex,n=e.columnStopIndex,o=e.rowStartIndex,i=e.rowStopIndex;r._columnStartIndex=t,r._columnStopIndex=n,r._rowStartIndex=o,r._rowStopIndex=i})),r}return _inherits$27(t,e),_createClass$2D(t,[{key:"setScrollIndexes",value:function(e){var t=e.scrollToColumn,r=e.scrollToRow;this.setState({scrollToRow:r,scrollToColumn:t})}},{key:"render",value:function(){var e=this.props,t=e.className,r=e.children,n=this._getScrollState(),o=n.scrollToColumn,i=n.scrollToRow;return reactExports.createElement("div",{className:t,onKeyDown:this._onKeyDown},r({onSectionRendered:this._onSectionRendered,scrollToColumn:o,scrollToRow:i}))}},{key:"_getScrollState",value:function(){return this.props.isControlled?this.props:this.state}},{key:"_updateScrollState",value:function(e){var t=e.scrollToColumn,r=e.scrollToRow,n=this.props,o=n.isControlled,i=n.onScrollToChange;"function"==typeof i&&i({scrollToColumn:t,scrollToRow:r}),o||this.setState({scrollToColumn:t,scrollToRow:r})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.isControlled?{}:e.scrollToColumn!==t.instanceProps.prevScrollToColumn||e.scrollToRow!==t.instanceProps.prevScrollToRow?_objectSpread$6({},t,{scrollToColumn:e.scrollToColumn,scrollToRow:e.scrollToRow,instanceProps:{prevScrollToColumn:e.scrollToColumn,prevScrollToRow:e.scrollToRow}}):{}}}]),t}(reactExports.PureComponent),_defineProperty$D(_class$5,"propTypes",null),_temp$5),_class$4,_temp$4;function createDetectElementResize(e,t){var r,n,o,i=void 0!==(r=void 0!==t?t:"undefined"!=typeof window?window:"undefined"!=typeof self?self:global).document&&r.document.attachEvent;if(!i){var a=(o=r.requestAnimationFrame||r.mozRequestAnimationFrame||r.webkitRequestAnimationFrame||function(e){return r.setTimeout(e,20)},function(e){return o(e)}),s=(n=r.cancelAnimationFrame||r.mozCancelAnimationFrame||r.webkitCancelAnimationFrame||r.clearTimeout,function(e){return n(e)}),l=function(e){var t=e.__resizeTriggers__,r=t.firstElementChild,n=t.lastElementChild,o=r.firstElementChild;n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight,o.style.width=r.offsetWidth+1+"px",o.style.height=r.offsetHeight+1+"px",r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight},c=function(e){if(!(e.target.className&&"function"==typeof e.target.className.indexOf&&e.target.className.indexOf("contract-trigger")<0&&e.target.className.indexOf("expand-trigger")<0)){var t=this;l(this),this.__resizeRAF__&&s(this.__resizeRAF__),this.__resizeRAF__=a((function(){(function(e){return e.offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height})(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach((function(r){r.call(t,e)})))}))}},u=!1,d="",h="animationstart",p="Webkit Moz O ms".split(" "),f="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),g=r.document.createElement("fakeelement");if(void 0!==g.style.animationName&&(u=!0),!1===u)for(var m=0;m<p.length;m++)if(void 0!==g.style[p[m]+"AnimationName"]){d="-"+p[m].toLowerCase()+"-",h=f[m],u=!0;break}var y="resizeanim",v="@"+d+"keyframes "+y+" { from { opacity: 0; } to { opacity: 0; } } ",_=d+"animation: 1ms "+y+"; "}return{addResizeListener:function(t,n){if(i)t.attachEvent("onresize",n);else{if(!t.__resizeTriggers__){var o=t.ownerDocument,a=r.getComputedStyle(t);a&&"static"==a.position&&(t.style.position="relative"),function(t){if(!t.getElementById("detectElementResize")){var r=(v||"")+".resize-triggers { "+(_||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',n=t.head||t.getElementsByTagName("head")[0],o=t.createElement("style");o.id="detectElementResize",o.type="text/css",null!=e&&o.setAttribute("nonce",e),o.styleSheet?o.styleSheet.cssText=r:o.appendChild(t.createTextNode(r)),n.appendChild(o)}}(o),t.__resizeLast__={},t.__resizeListeners__=[],(t.__resizeTriggers__=o.createElement("div")).className="resize-triggers";var s='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>';if(window.trustedTypes){var u=trustedTypes.createPolicy("react-virtualized-auto-sizer",{createHTML:function(){return s}});t.__resizeTriggers__.innerHTML=u.createHTML("")}else t.__resizeTriggers__.innerHTML=s;t.appendChild(t.__resizeTriggers__),l(t),t.addEventListener("scroll",c,!0),h&&(t.__resizeTriggers__.__animationListener__=function(e){e.animationName==y&&l(t)},t.__resizeTriggers__.addEventListener(h,t.__resizeTriggers__.__animationListener__))}t.__resizeListeners__.push(n)}},removeResizeListener:function(e,t){if(i)e.detachEvent("onresize",t);else if(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),!e.__resizeListeners__.length){e.removeEventListener("scroll",c,!0),e.__resizeTriggers__.__animationListener__&&(e.__resizeTriggers__.removeEventListener(h,e.__resizeTriggers__.__animationListener__),e.__resizeTriggers__.__animationListener__=null);try{e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)}catch(e3){}}}}}function ownKeys$5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$5(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$5(r,!0).forEach((function(t){_defineProperty$D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$5(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}_defineProperty$D(ArrowKeyStepper,"defaultProps",{disabled:!1,isControlled:!1,mode:"edges",scrollToColumn:0,scrollToRow:0}),polyfill(ArrowKeyStepper);var AutoSizer=(_temp$4=_class$4=function(e){function t(){var e,r;_classCallCheck$2D(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return r=_possibleConstructorReturn$27(this,(e=_getPrototypeOf$27(t)).call.apply(e,[this].concat(o))),_defineProperty$D(_assertThisInitialized$27(r),"state",{height:r.props.defaultHeight||0,width:r.props.defaultWidth||0}),_defineProperty$D(_assertThisInitialized$27(r),"_parentNode",void 0),_defineProperty$D(_assertThisInitialized$27(r),"_autoSizer",void 0),_defineProperty$D(_assertThisInitialized$27(r),"_window",void 0),_defineProperty$D(_assertThisInitialized$27(r),"_detectElementResize",void 0),_defineProperty$D(_assertThisInitialized$27(r),"_onResize",(function(){var e=r.props,t=e.disableHeight,n=e.disableWidth,o=e.onResize;if(r._parentNode){var i=r._parentNode.offsetHeight||0,a=r._parentNode.offsetWidth||0,s=(r._window||window).getComputedStyle(r._parentNode)||{},l=parseInt(s.paddingLeft,10)||0,c=parseInt(s.paddingRight,10)||0,u=parseInt(s.paddingTop,10)||0,d=parseInt(s.paddingBottom,10)||0,h=i-u-d,p=a-l-c;(!t&&r.state.height!==h||!n&&r.state.width!==p)&&(r.setState({height:i-u-d,width:a-l-c}),o({height:i,width:a}))}})),_defineProperty$D(_assertThisInitialized$27(r),"_setRef",(function(e){r._autoSizer=e})),r}return _inherits$27(t,e),_createClass$2D(t,[{key:"componentDidMount",value:function(){var e=this.props.nonce;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,this._window=this._autoSizer.parentNode.ownerDocument.defaultView,this._detectElementResize=createDetectElementResize(e,this._window),this._detectElementResize.addResizeListener(this._parentNode,this._onResize),this._onResize())}},{key:"componentWillUnmount",value:function(){this._detectElementResize&&this._parentNode&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize)}},{key:"render",value:function(){var e=this.props,t=e.children,r=e.className,n=e.disableHeight,o=e.disableWidth,i=e.style,a=this.state,s=a.height,l=a.width,c={overflow:"visible"},u={};return n||(c.height=0,u.height=s),o||(c.width=0,u.width=l),reactExports.createElement("div",{className:r,ref:this._setRef,style:_objectSpread$5({},c,{},i)},t(u))}}]),t}(reactExports.Component),_defineProperty$D(_class$4,"propTypes",null),_temp$4),_class$3,_temp$3;_defineProperty$D(AutoSizer,"defaultProps",{onResize:function(){},disableHeight:!1,disableWidth:!1,style:{}});var CellMeasurer=(_temp$3=_class$3=function(e){function t(){var e,r;_classCallCheck$2D(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return r=_possibleConstructorReturn$27(this,(e=_getPrototypeOf$27(t)).call.apply(e,[this].concat(o))),_defineProperty$D(_assertThisInitialized$27(r),"_child",void 0),_defineProperty$D(_assertThisInitialized$27(r),"_measure",(function(){var e=r.props,t=e.cache,n=e.columnIndex,o=void 0===n?0:n,i=e.parent,a=e.rowIndex,s=void 0===a?r.props.index||0:a,l=r._getCellMeasurements(),c=l.height,u=l.width;c===t.getHeight(s,o)&&u===t.getWidth(s,o)||(t.set(s,o,u,c),i&&"function"==typeof i.recomputeGridSize&&i.recomputeGridSize({columnIndex:o,rowIndex:s}))})),_defineProperty$D(_assertThisInitialized$27(r),"_registerChild",(function(e){e&&Element,r._child=e,e&&r._maybeMeasureCell()})),r}return _inherits$27(t,e),_createClass$2D(t,[{key:"componentDidMount",value:function(){this._maybeMeasureCell()}},{key:"componentDidUpdate",value:function(){this._maybeMeasureCell()}},{key:"render",value:function(){var e=this.props.children;return"function"==typeof e?e({measure:this._measure,registerChild:this._registerChild}):e}},{key:"_getCellMeasurements",value:function(){var e=this.props.cache,t=this._child||reactDomExports.findDOMNode(this);if(t&&t.ownerDocument&&t.ownerDocument.defaultView&&t instanceof t.ownerDocument.defaultView.HTMLElement){var r=t.style.width,n=t.style.height;e.hasFixedWidth()||(t.style.width="auto"),e.hasFixedHeight()||(t.style.height="auto");var o=Math.ceil(t.offsetHeight),i=Math.ceil(t.offsetWidth);return r&&(t.style.width=r),n&&(t.style.height=n),{height:o,width:i}}return{height:0,width:0}}},{key:"_maybeMeasureCell",value:function(){var e=this.props,t=e.cache,r=e.columnIndex,n=void 0===r?0:r,o=e.parent,i=e.rowIndex,a=void 0===i?this.props.index||0:i;if(!t.has(a,n)){var s=this._getCellMeasurements(),l=s.height,c=s.width;t.set(a,n,c,l),o&&"function"==typeof o.invalidateCellSizeAfterRender&&o.invalidateCellSizeAfterRender({columnIndex:n,rowIndex:a})}}}]),t}(reactExports.PureComponent),_defineProperty$D(_class$3,"propTypes",null),_temp$3);_defineProperty$D(CellMeasurer,"__internalCellMeasurerFlag",!1);var DEFAULT_HEIGHT=30,DEFAULT_WIDTH=100;function defaultKeyMapper(e,t){return"".concat(e,"-").concat(t)}function ownKeys$4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$4(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$4(r,!0).forEach((function(t){_defineProperty$D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$4(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck$2D(this,e),_defineProperty$D(this,"_cellHeightCache",{}),_defineProperty$D(this,"_cellWidthCache",{}),_defineProperty$D(this,"_columnWidthCache",{}),_defineProperty$D(this,"_rowHeightCache",{}),_defineProperty$D(this,"_defaultHeight",void 0),_defineProperty$D(this,"_defaultWidth",void 0),_defineProperty$D(this,"_minHeight",void 0),_defineProperty$D(this,"_minWidth",void 0),_defineProperty$D(this,"_keyMapper",void 0),_defineProperty$D(this,"_hasFixedHeight",void 0),_defineProperty$D(this,"_hasFixedWidth",void 0),_defineProperty$D(this,"_columnCount",0),_defineProperty$D(this,"_rowCount",0),_defineProperty$D(this,"columnWidth",(function(e){var r=e.index,n=t._keyMapper(0,r);return void 0!==t._columnWidthCache[n]?t._columnWidthCache[n]:t._defaultWidth})),_defineProperty$D(this,"rowHeight",(function(e){var r=e.index,n=t._keyMapper(r,0);return void 0!==t._rowHeightCache[n]?t._rowHeightCache[n]:t._defaultHeight}));var n=r.defaultHeight,o=r.defaultWidth,i=r.fixedHeight,a=r.fixedWidth,s=r.keyMapper,l=r.minHeight,c=r.minWidth;this._hasFixedHeight=!0===i,this._hasFixedWidth=!0===a,this._minHeight=l||0,this._minWidth=c||0,this._keyMapper=s||defaultKeyMapper,this._defaultHeight=Math.max(this._minHeight,"number"==typeof n?n:DEFAULT_HEIGHT),this._defaultWidth=Math.max(this._minWidth,"number"==typeof o?o:DEFAULT_WIDTH)}_createClass$2D(e,[{key:"clear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this._keyMapper(e,t);delete this._cellHeightCache[r],delete this._cellWidthCache[r],this._updateCachedColumnAndRowSizes(e,t)}},{key:"clearAll",value:function(){this._cellHeightCache={},this._cellWidthCache={},this._columnWidthCache={},this._rowHeightCache={},this._rowCount=0,this._columnCount=0}},{key:"hasFixedHeight",value:function(){return this._hasFixedHeight}},{key:"hasFixedWidth",value:function(){return this._hasFixedWidth}},{key:"getHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this._hasFixedHeight)return this._defaultHeight;var r=this._keyMapper(e,t);return void 0!==this._cellHeightCache[r]?Math.max(this._minHeight,this._cellHeightCache[r]):this._defaultHeight}},{key:"getWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this._hasFixedWidth)return this._defaultWidth;var r=this._keyMapper(e,t);return void 0!==this._cellWidthCache[r]?Math.max(this._minWidth,this._cellWidthCache[r]):this._defaultWidth}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this._keyMapper(e,t);return void 0!==this._cellHeightCache[r]}},{key:"set",value:function(e,t,r,n){var o=this._keyMapper(e,t);t>=this._columnCount&&(this._columnCount=t+1),e>=this._rowCount&&(this._rowCount=e+1),this._cellHeightCache[o]=n,this._cellWidthCache[o]=r,this._updateCachedColumnAndRowSizes(e,t)}},{key:"_updateCachedColumnAndRowSizes",value:function(e,t){if(!this._hasFixedWidth){for(var r=0,n=0;n<this._rowCount;n++)r=Math.max(r,this.getWidth(n,t));var o=this._keyMapper(0,t);this._columnWidthCache[o]=r}if(!this._hasFixedHeight){for(var i=0,a=0;a<this._columnCount;a++)i=Math.max(i,this.getHeight(e,a));var s=this._keyMapper(e,0);this._rowHeightCache[s]=i}}},{key:"defaultHeight",get:function(){return this._defaultHeight}},{key:"defaultWidth",get:function(){return this._defaultWidth}}])}();var IS_SCROLLING_TIMEOUT$1=150,SCROLL_POSITION_CHANGE_REASONS={OBSERVED:"observed",REQUESTED:"requested"},CollectionView=function(e){function t(){var e,r;_classCallCheck$2D(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return r=_possibleConstructorReturn$27(this,(e=_getPrototypeOf$27(t)).call.apply(e,[this].concat(o))),_defineProperty$D(_assertThisInitialized$27(r),"state",{isScrolling:!1,scrollLeft:0,scrollTop:0}),_defineProperty$D(_assertThisInitialized$27(r),"_calculateSizeAndPositionDataOnNextUpdate",!1),_defineProperty$D(_assertThisInitialized$27(r),"_onSectionRenderedMemoizer",createCallbackMemoizer()),_defineProperty$D(_assertThisInitialized$27(r),"_onScrollMemoizer",createCallbackMemoizer(!1)),_defineProperty$D(_assertThisInitialized$27(r),"_invokeOnSectionRenderedHelper",(function(){var e=r.props,t=e.cellLayoutManager,n=e.onSectionRendered;r._onSectionRenderedMemoizer({callback:n,indices:{indices:t.getLastRenderedIndices()}})})),_defineProperty$D(_assertThisInitialized$27(r),"_setScrollingContainerRef",(function(e){r._scrollingContainer=e})),_defineProperty$D(_assertThisInitialized$27(r),"_updateScrollPositionForScrollToCell",(function(){var e=r.props,t=e.cellLayoutManager,n=e.height,o=e.scrollToAlignment,i=e.scrollToCell,a=e.width,s=r.state,l=s.scrollLeft,c=s.scrollTop;if(i>=0){var u=t.getScrollPositionForCell({align:o,cellIndex:i,height:n,scrollLeft:l,scrollTop:c,width:a});u.scrollLeft===l&&u.scrollTop===c||r._setScrollPosition(u)}})),_defineProperty$D(_assertThisInitialized$27(r),"_onScroll",(function(e){if(e.target===r._scrollingContainer){r._enablePointerEventsAfterDelay();var t=r.props,n=t.cellLayoutManager,o=t.height,i=t.isScrollingChange,a=t.width,s=r._scrollbarSize,l=n.getTotalSize(),c=l.height,u=l.width,d=Math.max(0,Math.min(u-a+s,e.target.scrollLeft)),h=Math.max(0,Math.min(c-o+s,e.target.scrollTop));if(r.state.scrollLeft!==d||r.state.scrollTop!==h){var p=e.cancelable?SCROLL_POSITION_CHANGE_REASONS.OBSERVED:SCROLL_POSITION_CHANGE_REASONS.REQUESTED;r.state.isScrolling||i(!0),r.setState({isScrolling:!0,scrollLeft:d,scrollPositionChangeReason:p,scrollTop:h})}r._invokeOnScrollMemoizer({scrollLeft:d,scrollTop:h,totalWidth:u,totalHeight:c})}})),r._scrollbarSize=scrollbarSize(),void 0===r._scrollbarSize?(r._scrollbarSizeMeasured=!1,r._scrollbarSize=0):r._scrollbarSizeMeasured=!0,r}return _inherits$27(t,e),_createClass$2D(t,[{key:"recomputeCellSizesAndPositions",value:function(){this._calculateSizeAndPositionDataOnNextUpdate=!0,this.forceUpdate()}},{key:"componentDidMount",value:function(){var e=this.props,t=e.cellLayoutManager,r=e.scrollLeft,n=e.scrollToCell,o=e.scrollTop;this._scrollbarSizeMeasured||(this._scrollbarSize=scrollbarSize(),this._scrollbarSizeMeasured=!0,this.setState({})),n>=0?this._updateScrollPositionForScrollToCell():(r>=0||o>=0)&&this._setScrollPosition({scrollLeft:r,scrollTop:o}),this._invokeOnSectionRenderedHelper();var i=t.getTotalSize(),a=i.height,s=i.width;this._invokeOnScrollMemoizer({scrollLeft:r||0,scrollTop:o||0,totalHeight:a,totalWidth:s})}},{key:"componentDidUpdate",value:function(e,t){var r=this.props,n=r.height,o=r.scrollToAlignment,i=r.scrollToCell,a=r.width,s=this.state,l=s.scrollLeft,c=s.scrollPositionChangeReason,u=s.scrollTop;c===SCROLL_POSITION_CHANGE_REASONS.REQUESTED&&(l>=0&&l!==t.scrollLeft&&l!==this._scrollingContainer.scrollLeft&&(this._scrollingContainer.scrollLeft=l),u>=0&&u!==t.scrollTop&&u!==this._scrollingContainer.scrollTop&&(this._scrollingContainer.scrollTop=u)),n===e.height&&o===e.scrollToAlignment&&i===e.scrollToCell&&a===e.width||this._updateScrollPositionForScrollToCell(),this._invokeOnSectionRenderedHelper()}},{key:"componentWillUnmount",value:function(){this._disablePointerEventsTimeoutId&&clearTimeout(this._disablePointerEventsTimeoutId)}},{key:"render",value:function(){var e=this.props,t=e.autoHeight,r=e.cellCount,n=e.cellLayoutManager,o=e.className,i=e.height,a=e.horizontalOverscanSize,s=e.id,l=e.noContentRenderer,c=e.style,u=e.verticalOverscanSize,d=e.width,h=this.state,p=h.isScrolling,f=h.scrollLeft,g=h.scrollTop;(this._lastRenderedCellCount!==r||this._lastRenderedCellLayoutManager!==n||this._calculateSizeAndPositionDataOnNextUpdate)&&(this._lastRenderedCellCount=r,this._lastRenderedCellLayoutManager=n,this._calculateSizeAndPositionDataOnNextUpdate=!1,n.calculateSizeAndPositionData());var m=n.getTotalSize(),y=m.height,v=m.width,_=Math.max(0,f-a),b=Math.max(0,g-u),C=Math.min(v,f+d+a),E=Math.min(y,g+i+u),T=i>0&&d>0?n.cellRenderers({height:E-b,isScrolling:p,width:C-_,x:_,y:b}):[],S={boxSizing:"border-box",direction:"ltr",height:t?"auto":i,position:"relative",WebkitOverflowScrolling:"touch",width:d,willChange:"transform"},P=y>i?this._scrollbarSize:0,w=v>d?this._scrollbarSize:0;return S.overflowX=v+P<=d?"hidden":"auto",S.overflowY=y+w<=i?"hidden":"auto",reactExports.createElement("div",{ref:this._setScrollingContainerRef,"aria-label":this.props["aria-label"],className:clsx$1("ReactVirtualized__Collection",o),id:s,onScroll:this._onScroll,role:"grid",style:_objectSpread$4({},S,{},c),tabIndex:0},r>0&&reactExports.createElement("div",{className:"ReactVirtualized__Collection__innerScrollContainer",style:{height:y,maxHeight:y,maxWidth:v,overflow:"hidden",pointerEvents:p?"none":"",width:v}},T),0===r&&l())}},{key:"_enablePointerEventsAfterDelay",value:function(){var e=this;this._disablePointerEventsTimeoutId&&clearTimeout(this._disablePointerEventsTimeoutId),this._disablePointerEventsTimeoutId=setTimeout((function(){(0,e.props.isScrollingChange)(!1),e._disablePointerEventsTimeoutId=null,e.setState({isScrolling:!1})}),IS_SCROLLING_TIMEOUT$1)}},{key:"_invokeOnScrollMemoizer",value:function(e){var t=this,r=e.scrollLeft,n=e.scrollTop,o=e.totalHeight,i=e.totalWidth;this._onScrollMemoizer({callback:function(e){var r=e.scrollLeft,n=e.scrollTop,a=t.props,s=a.height;(0,a.onScroll)({clientHeight:s,clientWidth:a.width,scrollHeight:o,scrollLeft:r,scrollTop:n,scrollWidth:i})},indices:{scrollLeft:r,scrollTop:n}})}},{key:"_setScrollPosition",value:function(e){var t=e.scrollLeft,r=e.scrollTop,n={scrollPositionChangeReason:SCROLL_POSITION_CHANGE_REASONS.REQUESTED};t>=0&&(n.scrollLeft=t),r>=0&&(n.scrollTop=r),(t>=0&&t!==this.state.scrollLeft||r>=0&&r!==this.state.scrollTop)&&this.setState(n)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return 0!==e.cellCount||0===t.scrollLeft&&0===t.scrollTop?e.scrollLeft!==t.scrollLeft||e.scrollTop!==t.scrollTop?{scrollLeft:null!=e.scrollLeft?e.scrollLeft:t.scrollLeft,scrollTop:null!=e.scrollTop?e.scrollTop:t.scrollTop,scrollPositionChangeReason:SCROLL_POSITION_CHANGE_REASONS.REQUESTED}:null:{scrollLeft:0,scrollTop:0,scrollPositionChangeReason:SCROLL_POSITION_CHANGE_REASONS.REQUESTED}}}]),t}(reactExports.PureComponent);_defineProperty$D(CollectionView,"defaultProps",{"aria-label":"grid",horizontalOverscanSize:0,noContentRenderer:function(){return null},onScroll:function(){return null},onSectionRendered:function(){return null},scrollToAlignment:"auto",scrollToCell:-1,style:{},verticalOverscanSize:0}),CollectionView.propTypes={},polyfill(CollectionView);var Section=function(){function e(t){var r=t.height,n=t.width,o=t.x,i=t.y;_classCallCheck$2D(this,e),this.height=r,this.width=n,this.x=o,this.y=i,this._indexMap={},this._indices=[]}return _createClass$2D(e,[{key:"addCellIndex",value:function(e){var t=e.index;this._indexMap[t]||(this._indexMap[t]=!0,this._indices.push(t))}},{key:"getCellIndices",value:function(){return this._indices}},{key:"toString",value:function(){return"".concat(this.x,",").concat(this.y," ").concat(this.width,"x").concat(this.height)}}]),e}(),SECTION_SIZE=100,SectionManager=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SECTION_SIZE;_classCallCheck$2D(this,e),this._sectionSize=t,this._cellMetadata=[],this._sections={}}return _createClass$2D(e,[{key:"getCellIndices",value:function(e){var t=e.height,r=e.width,n=e.x,o=e.y,i={};return this.getSections({height:t,width:r,x:n,y:o}).forEach((function(e){return e.getCellIndices().forEach((function(e){i[e]=e}))})),Object.keys(i).map((function(e){return i[e]}))}},{key:"getCellMetadata",value:function(e){var t=e.index;return this._cellMetadata[t]}},{key:"getSections",value:function(e){for(var t=e.height,r=e.width,n=e.x,o=e.y,i=Math.floor(n/this._sectionSize),a=Math.floor((n+r-1)/this._sectionSize),s=Math.floor(o/this._sectionSize),l=Math.floor((o+t-1)/this._sectionSize),c=[],u=i;u<=a;u++)for(var d=s;d<=l;d++){var h="".concat(u,".").concat(d);this._sections[h]||(this._sections[h]=new Section({height:this._sectionSize,width:this._sectionSize,x:u*this._sectionSize,y:d*this._sectionSize})),c.push(this._sections[h])}return c}},{key:"getTotalSectionCount",value:function(){return Object.keys(this._sections).length}},{key:"toString",value:function(){var e=this;return Object.keys(this._sections).map((function(t){return e._sections[t].toString()}))}},{key:"registerCell",value:function(e){var t=e.cellMetadatum,r=e.index;this._cellMetadata[r]=t,this.getSections(t).forEach((function(e){return e.addCellIndex({index:r})}))}}]),e}();function calculateSizeAndPositionData(e){for(var t=e.cellCount,r=e.cellSizeAndPositionGetter,n=e.sectionSize,o=[],i=new SectionManager(n),a=0,s=0,l=0;l<t;l++){var c=r({index:l});if(null==c.height||isNaN(c.height)||null==c.width||isNaN(c.width)||null==c.x||isNaN(c.x)||null==c.y||isNaN(c.y))throw Error("Invalid metadata returned for cell ".concat(l,":\n        x:").concat(c.x,", y:").concat(c.y,", width:").concat(c.width,", height:").concat(c.height));a=Math.max(a,c.y+c.height),s=Math.max(s,c.x+c.width),o[l]=c,i.registerCell({cellMetadatum:c,index:l})}return{cellMetadata:o,height:a,sectionManager:i,width:s}}function getUpdatedOffsetForIndex(e){var t=e.align,r=void 0===t?"auto":t,n=e.cellOffset,o=e.cellSize,i=e.containerSize,a=e.currentOffset,s=n,l=s-i+o;switch(r){case"start":return s;case"end":return l;case"center":return s-(i-o)/2;default:return Math.max(l,Math.min(s,a))}}var Collection=function(e){function t(e,r){var n;return _classCallCheck$2D(this,t),(n=_possibleConstructorReturn$27(this,_getPrototypeOf$27(t).call(this,e,r)))._cellMetadata=[],n._lastRenderedCellIndices=[],n._cellCache=[],n._isScrollingChange=n._isScrollingChange.bind(_assertThisInitialized$27(n)),n._setCollectionViewRef=n._setCollectionViewRef.bind(_assertThisInitialized$27(n)),n}return _inherits$27(t,e),_createClass$2D(t,[{key:"forceUpdate",value:function(){void 0!==this._collectionView&&this._collectionView.forceUpdate()}},{key:"recomputeCellSizesAndPositions",value:function(){this._cellCache=[],this._collectionView.recomputeCellSizesAndPositions()}},{key:"render",value:function(){var e=_extends$4({},this.props);return reactExports.createElement(CollectionView,_extends$4({cellLayoutManager:this,isScrollingChange:this._isScrollingChange,ref:this._setCollectionViewRef},e))}},{key:"calculateSizeAndPositionData",value:function(){var e=this.props,t=calculateSizeAndPositionData({cellCount:e.cellCount,cellSizeAndPositionGetter:e.cellSizeAndPositionGetter,sectionSize:e.sectionSize});this._cellMetadata=t.cellMetadata,this._sectionManager=t.sectionManager,this._height=t.height,this._width=t.width}},{key:"getLastRenderedIndices",value:function(){return this._lastRenderedCellIndices}},{key:"getScrollPositionForCell",value:function(e){var t=e.align,r=e.cellIndex,n=e.height,o=e.scrollLeft,i=e.scrollTop,a=e.width,s=this.props.cellCount;if(r>=0&&r<s){var l=this._cellMetadata[r];o=getUpdatedOffsetForIndex({align:t,cellOffset:l.x,cellSize:l.width,containerSize:a,currentOffset:o,targetIndex:r}),i=getUpdatedOffsetForIndex({align:t,cellOffset:l.y,cellSize:l.height,containerSize:n,currentOffset:i,targetIndex:r})}return{scrollLeft:o,scrollTop:i}}},{key:"getTotalSize",value:function(){return{height:this._height,width:this._width}}},{key:"cellRenderers",value:function(e){var t=this,r=e.height,n=e.isScrolling,o=e.width,i=e.x,a=e.y,s=this.props,l=s.cellGroupRenderer,c=s.cellRenderer;return this._lastRenderedCellIndices=this._sectionManager.getCellIndices({height:r,width:o,x:i,y:a}),l({cellCache:this._cellCache,cellRenderer:c,cellSizeAndPositionGetter:function(e){var r=e.index;return t._sectionManager.getCellMetadata({index:r})},indices:this._lastRenderedCellIndices,isScrolling:n})}},{key:"_isScrollingChange",value:function(e){e||(this._cellCache=[])}},{key:"_setCollectionViewRef",value:function(e){this._collectionView=e}}]),t}(reactExports.PureComponent);function defaultCellGroupRenderer(e){var t=e.cellCache,r=e.cellRenderer,n=e.cellSizeAndPositionGetter,o=e.indices,i=e.isScrolling;return o.map((function(e){var o=n({index:e}),a={index:e,isScrolling:i,key:e,style:{height:o.height,left:o.x,position:"absolute",top:o.y,width:o.width}};return i?(e in t||(t[e]=r(a)),t[e]):r(a)})).filter((function(e){return!!e}))}_defineProperty$D(Collection,"defaultProps",{"aria-label":"grid",cellGroupRenderer:defaultCellGroupRenderer}),Collection.propTypes={};var ColumnSizer=function(e){function t(e,r){var n;return _classCallCheck$2D(this,t),(n=_possibleConstructorReturn$27(this,_getPrototypeOf$27(t).call(this,e,r)))._registerChild=n._registerChild.bind(_assertThisInitialized$27(n)),n}return _inherits$27(t,e),_createClass$2D(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.columnMaxWidth,n=t.columnMinWidth,o=t.columnCount,i=t.width;r===e.columnMaxWidth&&n===e.columnMinWidth&&o===e.columnCount&&i===e.width||this._registeredChild&&this._registeredChild.recomputeGridSize()}},{key:"render",value:function(){var e=this.props,t=e.children,r=e.columnMaxWidth,n=e.columnMinWidth,o=e.columnCount,i=e.width,a=n||1,s=r?Math.min(r,i):i,l=i/o;return l=Math.max(a,l),l=Math.min(s,l),l=Math.floor(l),t({adjustedWidth:Math.min(i,l*o),columnWidth:l,getColumnWidth:function(){return l},registerChild:this._registerChild})}},{key:"_registerChild",value:function(e){if(e&&"function"!=typeof e.recomputeGridSize)throw Error("Unexpected child type registered; only Grid/MultiGrid children are supported.");this._registeredChild=e,this._registeredChild&&this._registeredChild.recomputeGridSize()}}]),t}(reactExports.PureComponent);ColumnSizer.propTypes={};var InfiniteLoader=function(e){function t(e,r){var n;return _classCallCheck$2D(this,t),(n=_possibleConstructorReturn$27(this,_getPrototypeOf$27(t).call(this,e,r)))._loadMoreRowsMemoizer=createCallbackMemoizer(),n._onRowsRendered=n._onRowsRendered.bind(_assertThisInitialized$27(n)),n._registerChild=n._registerChild.bind(_assertThisInitialized$27(n)),n}return _inherits$27(t,e),_createClass$2D(t,[{key:"resetLoadMoreRowsCache",value:function(e){this._loadMoreRowsMemoizer=createCallbackMemoizer(),e&&this._doStuff(this._lastRenderedStartIndex,this._lastRenderedStopIndex)}},{key:"render",value:function(){return(0,this.props.children)({onRowsRendered:this._onRowsRendered,registerChild:this._registerChild})}},{key:"_loadUnloadedRanges",value:function(e){var t=this,r=this.props.loadMoreRows;e.forEach((function(e){var n=r(e);n&&n.then((function(){isRangeVisible({lastRenderedStartIndex:t._lastRenderedStartIndex,lastRenderedStopIndex:t._lastRenderedStopIndex,startIndex:e.startIndex,stopIndex:e.stopIndex})&&t._registeredChild&&forceUpdateReactVirtualizedComponent(t._registeredChild,t._lastRenderedStartIndex)}))}))}},{key:"_onRowsRendered",value:function(e){var t=e.startIndex,r=e.stopIndex;this._lastRenderedStartIndex=t,this._lastRenderedStopIndex=r,this._doStuff(t,r)}},{key:"_doStuff",value:function(e,t){var r,n=this,o=this.props,i=o.isRowLoaded,a=o.minimumBatchSize,s=o.rowCount,l=o.threshold,c=scanForUnloadedRanges({isRowLoaded:i,minimumBatchSize:a,rowCount:s,startIndex:Math.max(0,e-l),stopIndex:Math.min(s-1,t+l)}),u=(r=[]).concat.apply(r,_toConsumableArray(c.map((function(e){return[e.startIndex,e.stopIndex]}))));this._loadMoreRowsMemoizer({callback:function(){n._loadUnloadedRanges(c)},indices:{squashedUnloadedRanges:u}})}},{key:"_registerChild",value:function(e){this._registeredChild=e}}]),t}(reactExports.PureComponent),_class$2,_temp$2;function isRangeVisible(e){var t=e.lastRenderedStartIndex,r=e.lastRenderedStopIndex,n=e.startIndex,o=e.stopIndex;return!(n>r||o<t)}function scanForUnloadedRanges(e){for(var t=e.isRowLoaded,r=e.minimumBatchSize,n=e.rowCount,o=e.startIndex,i=e.stopIndex,a=[],s=null,l=null,c=o;c<=i;c++){t({index:c})?null!==l&&(a.push({startIndex:s,stopIndex:l}),s=l=null):(l=c,null===s&&(s=c))}if(null!==l){for(var u=Math.min(Math.max(l,s+r-1),n-1),d=l+1;d<=u&&!t({index:d});d++)l=d;a.push({startIndex:s,stopIndex:l})}if(a.length)for(var h=a[0];h.stopIndex-h.startIndex+1<r&&h.startIndex>0;){var p=h.startIndex-1;if(t({index:p}))break;h.startIndex=p}return a}function forceUpdateReactVirtualizedComponent(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r="function"==typeof e.recomputeGridSize?e.recomputeGridSize:e.recomputeRowHeights;r?r.call(e,t):e.forceUpdate()}_defineProperty$D(InfiniteLoader,"defaultProps",{minimumBatchSize:10,rowCount:0,threshold:15}),InfiniteLoader.propTypes={};var List=(_temp$2=_class$2=function(e){function t(){var e,r;_classCallCheck$2D(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return r=_possibleConstructorReturn$27(this,(e=_getPrototypeOf$27(t)).call.apply(e,[this].concat(o))),_defineProperty$D(_assertThisInitialized$27(r),"Grid",void 0),_defineProperty$D(_assertThisInitialized$27(r),"_cellRenderer",(function(e){var t=e.parent,n=e.rowIndex,o=e.style,i=e.isScrolling,a=e.isVisible,s=e.key,l=r.props.rowRenderer,c=Object.getOwnPropertyDescriptor(o,"width");return c&&c.writable&&(o.width="100%"),l({index:n,style:o,isScrolling:i,isVisible:a,key:s,parent:t})})),_defineProperty$D(_assertThisInitialized$27(r),"_setRef",(function(e){r.Grid=e})),_defineProperty$D(_assertThisInitialized$27(r),"_onScroll",(function(e){var t=e.clientHeight,n=e.scrollHeight,o=e.scrollTop;(0,r.props.onScroll)({clientHeight:t,scrollHeight:n,scrollTop:o})})),_defineProperty$D(_assertThisInitialized$27(r),"_onSectionRendered",(function(e){var t=e.rowOverscanStartIndex,n=e.rowOverscanStopIndex,o=e.rowStartIndex,i=e.rowStopIndex;(0,r.props.onRowsRendered)({overscanStartIndex:t,overscanStopIndex:n,startIndex:o,stopIndex:i})})),r}return _inherits$27(t,e),_createClass$2D(t,[{key:"forceUpdateGrid",value:function(){this.Grid&&this.Grid.forceUpdate()}},{key:"getOffsetForRow",value:function(e){var t=e.alignment,r=e.index;return this.Grid?this.Grid.getOffsetForCell({alignment:t,rowIndex:r,columnIndex:0}).scrollTop:0}},{key:"invalidateCellSizeAfterRender",value:function(e){var t=e.columnIndex,r=e.rowIndex;this.Grid&&this.Grid.invalidateCellSizeAfterRender({rowIndex:r,columnIndex:t})}},{key:"measureAllRows",value:function(){this.Grid&&this.Grid.measureAllCells()}},{key:"recomputeGridSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.columnIndex,r=void 0===t?0:t,n=e.rowIndex,o=void 0===n?0:n;this.Grid&&this.Grid.recomputeGridSize({rowIndex:o,columnIndex:r})}},{key:"recomputeRowHeights",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.recomputeGridSize({rowIndex:e,columnIndex:0})}},{key:"scrollToPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.scrollToPosition({scrollTop:e})}},{key:"scrollToRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.scrollToCell({columnIndex:0,rowIndex:e})}},{key:"render",value:function(){var e=this.props,t=e.className,r=e.noRowsRenderer,n=e.scrollToIndex,o=e.width,i=clsx$1("ReactVirtualized__List",t);return reactExports.createElement(Grid$1,_extends$4({},this.props,{autoContainerWidth:!0,cellRenderer:this._cellRenderer,className:i,columnWidth:o,columnCount:1,noContentRenderer:r,onScroll:this._onScroll,onSectionRendered:this._onSectionRendered,ref:this._setRef,scrollToRow:n}))}}]),t}(reactExports.PureComponent),_defineProperty$D(_class$2,"propTypes",null),_temp$2);function _GEA(e,t,r,n){for(var o=r+1;t<=r;){var i=t+r>>>1;e[i]>=n?(o=i,r=i-1):t=i+1}return o}function _GEP(e,t,r,n,o){for(var i=r+1;t<=r;){var a=t+r>>>1;o(e[a],n)>=0?(i=a,r=a-1):t=a+1}return i}function dispatchBsearchGE(e,t,r,n,o){return"function"==typeof r?_GEP(e,void 0===n?0:0|n,void 0===o?e.length-1:0|o,t,r):_GEA(e,void 0===r?0:0|r,void 0===n?e.length-1:0|n,t)}function _GTA(e,t,r,n){for(var o=r+1;t<=r;){var i=t+r>>>1;e[i]>n?(o=i,r=i-1):t=i+1}return o}function _GTP(e,t,r,n,o){for(var i=r+1;t<=r;){var a=t+r>>>1;o(e[a],n)>0?(i=a,r=a-1):t=a+1}return i}function dispatchBsearchGT(e,t,r,n,o){return"function"==typeof r?_GTP(e,void 0===n?0:0|n,void 0===o?e.length-1:0|o,t,r):_GTA(e,void 0===r?0:0|r,void 0===n?e.length-1:0|n,t)}function _LTA(e,t,r,n){for(var o=t-1;t<=r;){var i=t+r>>>1;e[i]<n?(o=i,t=i+1):r=i-1}return o}function _LTP(e,t,r,n,o){for(var i=t-1;t<=r;){var a=t+r>>>1;o(e[a],n)<0?(i=a,t=a+1):r=a-1}return i}function dispatchBsearchLT(e,t,r,n,o){return"function"==typeof r?_LTP(e,void 0===n?0:0|n,void 0===o?e.length-1:0|o,t,r):_LTA(e,void 0===r?0:0|r,void 0===n?e.length-1:0|n,t)}function _LEA(e,t,r,n){for(var o=t-1;t<=r;){var i=t+r>>>1;e[i]<=n?(o=i,t=i+1):r=i-1}return o}function _LEP(e,t,r,n,o){for(var i=t-1;t<=r;){var a=t+r>>>1;o(e[a],n)<=0?(i=a,t=a+1):r=a-1}return i}function dispatchBsearchLE(e,t,r,n,o){return"function"==typeof r?_LEP(e,void 0===n?0:0|n,void 0===o?e.length-1:0|o,t,r):_LEA(e,void 0===r?0:0|r,void 0===n?e.length-1:0|n,t)}function _EQA(e,t,r,n){for(;t<=r;){var o=t+r>>>1,i=e[o];if(i===n)return o;i<=n?t=o+1:r=o-1}return-1}function _EQP(e,t,r,n,o){for(;t<=r;){var i=t+r>>>1,a=o(e[i],n);if(0===a)return i;a<=0?t=i+1:r=i-1}return-1}function dispatchBsearchEQ(e,t,r,n,o){return"function"==typeof r?_EQP(e,void 0===n?0:0|n,void 0===o?e.length-1:0|o,t,r):_EQA(e,void 0===r?0:0|r,void 0===n?e.length-1:0|n,t)}_defineProperty$D(List,"defaultProps",{autoHeight:!1,estimatedRowSize:30,onScroll:function(){},noRowsRenderer:function(){return null},onRowsRendered:function(){},overscanIndicesGetter:defaultOverscanIndicesGetter,overscanRowCount:10,scrollToAlignment:"auto",scrollToIndex:-1,style:{}});const bounds={ge:dispatchBsearchGE,gt:dispatchBsearchGT,lt:dispatchBsearchLT,le:dispatchBsearchLE,eq:dispatchBsearchEQ};var NOT_FOUND=0,SUCCESS=1,EMPTY=2;function IntervalTreeNode(e,t,r,n,o){this.mid=e,this.left=t,this.right=r,this.leftPoints=n,this.rightPoints=o,this.count=(t?t.count:0)+(r?r.count:0)+n.length}var proto=IntervalTreeNode.prototype;function copy(e,t){e.mid=t.mid,e.left=t.left,e.right=t.right,e.leftPoints=t.leftPoints,e.rightPoints=t.rightPoints,e.count=t.count}function rebuild(e,t){var r=createIntervalTree(t);e.mid=r.mid,e.left=r.left,e.right=r.right,e.leftPoints=r.leftPoints,e.rightPoints=r.rightPoints,e.count=r.count}function rebuildWithInterval(e,t){var r=e.intervals([]);r.push(t),rebuild(e,r)}function rebuildWithoutInterval(e,t){var r=e.intervals([]),n=r.indexOf(t);return n<0?NOT_FOUND:(r.splice(n,1),rebuild(e,r),SUCCESS)}function reportLeftRange(e,t,r){for(var n=0;n<e.length&&e[n][0]<=t;++n){var o=r(e[n]);if(o)return o}}function reportRightRange(e,t,r){for(var n=e.length-1;n>=0&&e[n][1]>=t;--n){var o=r(e[n]);if(o)return o}}function reportRange(e,t){for(var r=0;r<e.length;++r){var n=t(e[r]);if(n)return n}}function compareNumbers(e,t){return e-t}function compareBegin(e,t){var r=e[0]-t[0];return r||e[1]-t[1]}function compareEnd(e,t){var r=e[1]-t[1];return r||e[0]-t[0]}function createIntervalTree(e){if(0===e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e[r][0],e[r][1]);t.sort(compareNumbers);var n=t[t.length>>1],o=[],i=[],a=[];for(r=0;r<e.length;++r){var s=e[r];s[1]<n?o.push(s):n<s[0]?i.push(s):a.push(s)}var l=a,c=a.slice();return l.sort(compareBegin),c.sort(compareEnd),new IntervalTreeNode(n,createIntervalTree(o),createIntervalTree(i),l,c)}function IntervalTree(e){this.root=e}proto.intervals=function(e){return e.push.apply(e,this.leftPoints),this.left&&this.left.intervals(e),this.right&&this.right.intervals(e),e},proto.insert=function(e){var t=this.count-this.leftPoints.length;if(this.count+=1,e[1]<this.mid)this.left?4*(this.left.count+1)>3*(t+1)?rebuildWithInterval(this,e):this.left.insert(e):this.left=createIntervalTree([e]);else if(e[0]>this.mid)this.right?4*(this.right.count+1)>3*(t+1)?rebuildWithInterval(this,e):this.right.insert(e):this.right=createIntervalTree([e]);else{var r=bounds.ge(this.leftPoints,e,compareBegin),n=bounds.ge(this.rightPoints,e,compareEnd);this.leftPoints.splice(r,0,e),this.rightPoints.splice(n,0,e)}},proto.remove=function(e){var t=this.count-this.leftPoints;if(e[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(t-1)?rebuildWithoutInterval(this,e):(i=this.left.remove(e))===EMPTY?(this.left=null,this.count-=1,SUCCESS):(i===SUCCESS&&(this.count-=1),i):NOT_FOUND;if(e[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(t-1)?rebuildWithoutInterval(this,e):(i=this.right.remove(e))===EMPTY?(this.right=null,this.count-=1,SUCCESS):(i===SUCCESS&&(this.count-=1),i):NOT_FOUND;if(1===this.count)return this.leftPoints[0]===e?EMPTY:NOT_FOUND;if(1===this.leftPoints.length&&this.leftPoints[0]===e){if(this.left&&this.right){for(var r=this,n=this.left;n.right;)r=n,n=n.right;if(r===this)n.right=this.right;else{var o=this.left,i=this.right;r.count-=n.count,r.right=n.left,n.left=o,n.right=i}copy(this,n),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?copy(this,this.left):copy(this,this.right);return SUCCESS}for(o=bounds.ge(this.leftPoints,e,compareBegin);o<this.leftPoints.length&&this.leftPoints[o][0]===e[0];++o)if(this.leftPoints[o]===e){this.count-=1,this.leftPoints.splice(o,1);for(i=bounds.ge(this.rightPoints,e,compareEnd);i<this.rightPoints.length&&this.rightPoints[i][1]===e[1];++i)if(this.rightPoints[i]===e)return this.rightPoints.splice(i,1),SUCCESS}return NOT_FOUND},proto.queryPoint=function(e,t){if(e<this.mid){if(this.left)if(r=this.left.queryPoint(e,t))return r;return reportLeftRange(this.leftPoints,e,t)}if(e>this.mid){var r;if(this.right)if(r=this.right.queryPoint(e,t))return r;return reportRightRange(this.rightPoints,e,t)}return reportRange(this.leftPoints,t)},proto.queryInterval=function(e,t,r){var n;if(e<this.mid&&this.left&&(n=this.left.queryInterval(e,t,r)))return n;if(t>this.mid&&this.right&&(n=this.right.queryInterval(e,t,r)))return n;return t<this.mid?reportLeftRange(this.leftPoints,t,r):e>this.mid?reportRightRange(this.rightPoints,e,r):reportRange(this.leftPoints,r)};var tproto=IntervalTree.prototype;function createWrapper(e){return new IntervalTree(null)}tproto.insert=function(e){this.root?this.root.insert(e):this.root=new IntervalTreeNode(e[0],null,null,[e],[e])},tproto.remove=function(e){if(this.root){var t=this.root.remove(e);return t===EMPTY&&(this.root=null),t!==NOT_FOUND}return!1},tproto.queryPoint=function(e,t){if(this.root)return this.root.queryPoint(e,t)},tproto.queryInterval=function(e,t,r){if(e<=t&&this.root)return this.root.queryInterval(e,t,r)},Object.defineProperty(tproto,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(tproto,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});var PositionCache=function(){function e(){_classCallCheck$2D(this,e),_defineProperty$D(this,"_columnSizeMap",{}),_defineProperty$D(this,"_intervalTree",createWrapper()),_defineProperty$D(this,"_leftMap",{})}return _createClass$2D(e,[{key:"estimateTotalHeight",value:function(e,t,r){var n=e-this.count;return this.tallestColumnSize+Math.ceil(n/t)*r}},{key:"range",value:function(e,t,r){var n=this;this._intervalTree.queryInterval(e,e+t,(function(e){var t=_slicedToArray$1(e,3),o=t[0];t[1];var i=t[2];return r(i,n._leftMap[i],o)}))}},{key:"setPosition",value:function(e,t,r,n){this._intervalTree.insert([r,r+n,e]),this._leftMap[e]=t;var o=this._columnSizeMap,i=o[t];o[t]=void 0===i?r+n:Math.max(i,r+n)}},{key:"count",get:function(){return this._intervalTree.count}},{key:"shortestColumnSize",get:function(){var e=this._columnSizeMap,t=0;for(var r in e){var n=e[r];t=0===t?n:Math.min(t,n)}return t}},{key:"tallestColumnSize",get:function(){var e=this._columnSizeMap,t=0;for(var r in e){var n=e[r];t=Math.max(t,n)}return t}}]),e}(),_class$1,_temp$1;function ownKeys$3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$3(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$3(r,!0).forEach((function(t){_defineProperty$D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$3(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var emptyObject={},DEFAULT_SCROLLING_RESET_TIME_INTERVAL=150,Masonry=(_temp$1=_class$1=function(e){function t(){var e,r;_classCallCheck$2D(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return r=_possibleConstructorReturn$27(this,(e=_getPrototypeOf$27(t)).call.apply(e,[this].concat(o))),_defineProperty$D(_assertThisInitialized$27(r),"state",{isScrolling:!1,scrollTop:0}),_defineProperty$D(_assertThisInitialized$27(r),"_debounceResetIsScrollingId",void 0),_defineProperty$D(_assertThisInitialized$27(r),"_invalidateOnUpdateStartIndex",null),_defineProperty$D(_assertThisInitialized$27(r),"_invalidateOnUpdateStopIndex",null),_defineProperty$D(_assertThisInitialized$27(r),"_positionCache",new PositionCache),_defineProperty$D(_assertThisInitialized$27(r),"_startIndex",null),_defineProperty$D(_assertThisInitialized$27(r),"_startIndexMemoized",null),_defineProperty$D(_assertThisInitialized$27(r),"_stopIndex",null),_defineProperty$D(_assertThisInitialized$27(r),"_stopIndexMemoized",null),_defineProperty$D(_assertThisInitialized$27(r),"_debounceResetIsScrollingCallback",(function(){r.setState({isScrolling:!1})})),_defineProperty$D(_assertThisInitialized$27(r),"_setScrollingContainerRef",(function(e){r._scrollingContainer=e})),_defineProperty$D(_assertThisInitialized$27(r),"_onScroll",(function(e){var t=r.props.height,n=e.currentTarget.scrollTop,o=Math.min(Math.max(0,r._getEstimatedTotalHeight()-t),n);n===o&&(r._debounceResetIsScrolling(),r.state.scrollTop!==o&&r.setState({isScrolling:!0,scrollTop:o}))})),r}return _inherits$27(t,e),_createClass$2D(t,[{key:"clearCellPositions",value:function(){this._positionCache=new PositionCache,this.forceUpdate()}},{key:"invalidateCellSizeAfterRender",value:function(e){var t=e.rowIndex;null===this._invalidateOnUpdateStartIndex?(this._invalidateOnUpdateStartIndex=t,this._invalidateOnUpdateStopIndex=t):(this._invalidateOnUpdateStartIndex=Math.min(this._invalidateOnUpdateStartIndex,t),this._invalidateOnUpdateStopIndex=Math.max(this._invalidateOnUpdateStopIndex,t))}},{key:"recomputeCellPositions",value:function(){var e=this._positionCache.count-1;this._positionCache=new PositionCache,this._populatePositionCache(0,e),this.forceUpdate()}},{key:"componentDidMount",value:function(){this._checkInvalidateOnUpdate(),this._invokeOnScrollCallback(),this._invokeOnCellsRenderedCallback()}},{key:"componentDidUpdate",value:function(e,t){this._checkInvalidateOnUpdate(),this._invokeOnScrollCallback(),this._invokeOnCellsRenderedCallback(),this.props.scrollTop!==e.scrollTop&&this._debounceResetIsScrolling()}},{key:"componentWillUnmount",value:function(){this._debounceResetIsScrollingId&&cancelAnimationTimeout(this._debounceResetIsScrollingId)}},{key:"render",value:function(){var e,t=this,r=this.props,n=r.autoHeight,o=r.cellCount,i=r.cellMeasurerCache,a=r.cellRenderer,s=r.className,l=r.height,c=r.id,u=r.keyMapper,d=r.overscanByPixels,h=r.role,p=r.style,f=r.tabIndex,g=r.width,m=r.rowDirection,y=this.state,v=y.isScrolling,_=y.scrollTop,b=[],C=this._getEstimatedTotalHeight(),E=this._positionCache.shortestColumnSize,T=this._positionCache.count,S=0;if(this._positionCache.range(Math.max(0,_-d),l+2*d,(function(r,n,o){var s;void 0===e?(S=r,e=r):(S=Math.min(S,r),e=Math.max(e,r)),b.push(a({index:r,isScrolling:v,key:u(r),parent:t,style:(s={height:i.getHeight(r)},_defineProperty$D(s,"ltr"===m?"left":"right",n),_defineProperty$D(s,"position","absolute"),_defineProperty$D(s,"top",o),_defineProperty$D(s,"width",i.getWidth(r)),s)}))})),E<_+l+d&&T<o)for(var P=Math.min(o-T,Math.ceil((_+l+d-E)/i.defaultHeight*g/i.defaultWidth)),w=T;w<T+P;w++)e=w,b.push(a({index:w,isScrolling:v,key:u(w),parent:this,style:{width:i.getWidth(w)}}));return this._startIndex=S,this._stopIndex=e,reactExports.createElement("div",{ref:this._setScrollingContainerRef,"aria-label":this.props["aria-label"],className:clsx$1("ReactVirtualized__Masonry",s),id:c,onScroll:this._onScroll,role:h,style:_objectSpread$3({boxSizing:"border-box",direction:"ltr",height:n?"auto":l,overflowX:"hidden",overflowY:C<l?"hidden":"auto",position:"relative",width:g,WebkitOverflowScrolling:"touch",willChange:"transform"},p),tabIndex:f},reactExports.createElement("div",{className:"ReactVirtualized__Masonry__innerScrollContainer",style:{width:"100%",height:C,maxWidth:"100%",maxHeight:C,overflow:"hidden",pointerEvents:v?"none":"",position:"relative"}},b))}},{key:"_checkInvalidateOnUpdate",value:function(){if("number"==typeof this._invalidateOnUpdateStartIndex){var e=this._invalidateOnUpdateStartIndex,t=this._invalidateOnUpdateStopIndex;this._invalidateOnUpdateStartIndex=null,this._invalidateOnUpdateStopIndex=null,this._populatePositionCache(e,t),this.forceUpdate()}}},{key:"_debounceResetIsScrolling",value:function(){var e=this.props.scrollingResetTimeInterval;this._debounceResetIsScrollingId&&cancelAnimationTimeout(this._debounceResetIsScrollingId),this._debounceResetIsScrollingId=requestAnimationTimeout(this._debounceResetIsScrollingCallback,e)}},{key:"_getEstimatedTotalHeight",value:function(){var e=this.props,t=e.cellCount,r=e.cellMeasurerCache,n=e.width,o=Math.max(1,Math.floor(n/r.defaultWidth));return this._positionCache.estimateTotalHeight(t,o,r.defaultHeight)}},{key:"_invokeOnScrollCallback",value:function(){var e=this.props,t=e.height,r=e.onScroll,n=this.state.scrollTop;this._onScrollMemoized!==n&&(r({clientHeight:t,scrollHeight:this._getEstimatedTotalHeight(),scrollTop:n}),this._onScrollMemoized=n)}},{key:"_invokeOnCellsRenderedCallback",value:function(){this._startIndexMemoized===this._startIndex&&this._stopIndexMemoized===this._stopIndex||((0,this.props.onCellsRendered)({startIndex:this._startIndex,stopIndex:this._stopIndex}),this._startIndexMemoized=this._startIndex,this._stopIndexMemoized=this._stopIndex)}},{key:"_populatePositionCache",value:function(e,t){for(var r=this.props,n=r.cellMeasurerCache,o=r.cellPositioner,i=e;i<=t;i++){var a=o(i),s=a.left,l=a.top;this._positionCache.setPosition(i,s,l,n.getHeight(i))}}}],[{key:"getDerivedStateFromProps",value:function(e,t){return void 0!==e.scrollTop&&t.scrollTop!==e.scrollTop?{isScrolling:!0,scrollTop:e.scrollTop}:null}}]),t}(reactExports.PureComponent),_defineProperty$D(_class$1,"propTypes",null),_temp$1);function identity$2(e){return e}function noop$1(){}_defineProperty$D(Masonry,"defaultProps",{autoHeight:!1,keyMapper:identity$2,onCellsRendered:noop$1,onScroll:noop$1,overscanByPixels:20,role:"grid",scrollingResetTimeInterval:DEFAULT_SCROLLING_RESET_TIME_INTERVAL,style:emptyObject,tabIndex:0,rowDirection:"ltr"}),polyfill(Masonry);var CellMeasurerCacheDecorator=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck$2D(this,e),_defineProperty$D(this,"_cellMeasurerCache",void 0),_defineProperty$D(this,"_columnIndexOffset",void 0),_defineProperty$D(this,"_rowIndexOffset",void 0),_defineProperty$D(this,"columnWidth",(function(e){var r=e.index;t._cellMeasurerCache.columnWidth({index:r+t._columnIndexOffset})})),_defineProperty$D(this,"rowHeight",(function(e){var r=e.index;t._cellMeasurerCache.rowHeight({index:r+t._rowIndexOffset})}));var n=r.cellMeasurerCache,o=r.columnIndexOffset,i=void 0===o?0:o,a=r.rowIndexOffset,s=void 0===a?0:a;this._cellMeasurerCache=n,this._columnIndexOffset=i,this._rowIndexOffset=s}return _createClass$2D(e,[{key:"clear",value:function(e,t){this._cellMeasurerCache.clear(e+this._rowIndexOffset,t+this._columnIndexOffset)}},{key:"clearAll",value:function(){this._cellMeasurerCache.clearAll()}},{key:"hasFixedHeight",value:function(){return this._cellMeasurerCache.hasFixedHeight()}},{key:"hasFixedWidth",value:function(){return this._cellMeasurerCache.hasFixedWidth()}},{key:"getHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._cellMeasurerCache.getHeight(e+this._rowIndexOffset,t+this._columnIndexOffset)}},{key:"getWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._cellMeasurerCache.getWidth(e+this._rowIndexOffset,t+this._columnIndexOffset)}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._cellMeasurerCache.has(e+this._rowIndexOffset,t+this._columnIndexOffset)}},{key:"set",value:function(e,t,r,n){this._cellMeasurerCache.set(e+this._rowIndexOffset,t+this._columnIndexOffset,r,n)}},{key:"defaultHeight",get:function(){return this._cellMeasurerCache.defaultHeight}},{key:"defaultWidth",get:function(){return this._cellMeasurerCache.defaultWidth}}]),e}();function ownKeys$2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$2(r,!0).forEach((function(t){_defineProperty$D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$2(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var SCROLLBAR_SIZE_BUFFER=20,MultiGrid=function(e){function t(e,r){var n;_classCallCheck$2D(this,t),n=_possibleConstructorReturn$27(this,_getPrototypeOf$27(t).call(this,e,r)),_defineProperty$D(_assertThisInitialized$27(n),"state",{scrollLeft:0,scrollTop:0,scrollbarSize:0,showHorizontalScrollbar:!1,showVerticalScrollbar:!1}),_defineProperty$D(_assertThisInitialized$27(n),"_deferredInvalidateColumnIndex",null),_defineProperty$D(_assertThisInitialized$27(n),"_deferredInvalidateRowIndex",null),_defineProperty$D(_assertThisInitialized$27(n),"_bottomLeftGridRef",(function(e){n._bottomLeftGrid=e})),_defineProperty$D(_assertThisInitialized$27(n),"_bottomRightGridRef",(function(e){n._bottomRightGrid=e})),_defineProperty$D(_assertThisInitialized$27(n),"_cellRendererBottomLeftGrid",(function(e){var t=e.rowIndex,r=_objectWithoutProperties(e,["rowIndex"]),o=n.props,i=o.cellRenderer,a=o.fixedRowCount;return t===o.rowCount-a?reactExports.createElement("div",{key:r.key,style:_objectSpread$2({},r.style,{height:SCROLLBAR_SIZE_BUFFER})}):i(_objectSpread$2({},r,{parent:_assertThisInitialized$27(n),rowIndex:t+a}))})),_defineProperty$D(_assertThisInitialized$27(n),"_cellRendererBottomRightGrid",(function(e){var t=e.columnIndex,r=e.rowIndex,o=_objectWithoutProperties(e,["columnIndex","rowIndex"]),i=n.props,a=i.cellRenderer,s=i.fixedColumnCount,l=i.fixedRowCount;return a(_objectSpread$2({},o,{columnIndex:t+s,parent:_assertThisInitialized$27(n),rowIndex:r+l}))})),_defineProperty$D(_assertThisInitialized$27(n),"_cellRendererTopRightGrid",(function(e){var t=e.columnIndex,r=_objectWithoutProperties(e,["columnIndex"]),o=n.props,i=o.cellRenderer,a=o.columnCount,s=o.fixedColumnCount;return t===a-s?reactExports.createElement("div",{key:r.key,style:_objectSpread$2({},r.style,{width:SCROLLBAR_SIZE_BUFFER})}):i(_objectSpread$2({},r,{columnIndex:t+s,parent:_assertThisInitialized$27(n)}))})),_defineProperty$D(_assertThisInitialized$27(n),"_columnWidthRightGrid",(function(e){var t=e.index,r=n.props,o=r.columnCount,i=r.fixedColumnCount,a=r.columnWidth,s=n.state,l=s.scrollbarSize;return s.showHorizontalScrollbar&&t===o-i?l:"function"==typeof a?a({index:t+i}):a})),_defineProperty$D(_assertThisInitialized$27(n),"_onScroll",(function(e){var t=e.scrollLeft,r=e.scrollTop;n.setState({scrollLeft:t,scrollTop:r});var o=n.props.onScroll;o&&o(e)})),_defineProperty$D(_assertThisInitialized$27(n),"_onScrollbarPresenceChange",(function(e){var t=e.horizontal,r=e.size,o=e.vertical,i=n.state,a=i.showHorizontalScrollbar,s=i.showVerticalScrollbar;if(t!==a||o!==s){n.setState({scrollbarSize:r,showHorizontalScrollbar:t,showVerticalScrollbar:o});var l=n.props.onScrollbarPresenceChange;"function"==typeof l&&l({horizontal:t,size:r,vertical:o})}})),_defineProperty$D(_assertThisInitialized$27(n),"_onScrollLeft",(function(e){var t=e.scrollLeft;n._onScroll({scrollLeft:t,scrollTop:n.state.scrollTop})})),_defineProperty$D(_assertThisInitialized$27(n),"_onScrollTop",(function(e){var t=e.scrollTop;n._onScroll({scrollTop:t,scrollLeft:n.state.scrollLeft})})),_defineProperty$D(_assertThisInitialized$27(n),"_rowHeightBottomGrid",(function(e){var t=e.index,r=n.props,o=r.fixedRowCount,i=r.rowCount,a=r.rowHeight,s=n.state,l=s.scrollbarSize;return s.showVerticalScrollbar&&t===i-o?l:"function"==typeof a?a({index:t+o}):a})),_defineProperty$D(_assertThisInitialized$27(n),"_topLeftGridRef",(function(e){n._topLeftGrid=e})),_defineProperty$D(_assertThisInitialized$27(n),"_topRightGridRef",(function(e){n._topRightGrid=e}));var o=e.deferredMeasurementCache,i=e.fixedColumnCount,a=e.fixedRowCount;return n._maybeCalculateCachedStyles(!0),o&&(n._deferredMeasurementCacheBottomLeftGrid=a>0?new CellMeasurerCacheDecorator({cellMeasurerCache:o,columnIndexOffset:0,rowIndexOffset:a}):o,n._deferredMeasurementCacheBottomRightGrid=i>0||a>0?new CellMeasurerCacheDecorator({cellMeasurerCache:o,columnIndexOffset:i,rowIndexOffset:a}):o,n._deferredMeasurementCacheTopRightGrid=i>0?new CellMeasurerCacheDecorator({cellMeasurerCache:o,columnIndexOffset:i,rowIndexOffset:0}):o),n}return _inherits$27(t,e),_createClass$2D(t,[{key:"forceUpdateGrids",value:function(){this._bottomLeftGrid&&this._bottomLeftGrid.forceUpdate(),this._bottomRightGrid&&this._bottomRightGrid.forceUpdate(),this._topLeftGrid&&this._topLeftGrid.forceUpdate(),this._topRightGrid&&this._topRightGrid.forceUpdate()}},{key:"invalidateCellSizeAfterRender",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.columnIndex,r=void 0===t?0:t,n=e.rowIndex,o=void 0===n?0:n;this._deferredInvalidateColumnIndex="number"==typeof this._deferredInvalidateColumnIndex?Math.min(this._deferredInvalidateColumnIndex,r):r,this._deferredInvalidateRowIndex="number"==typeof this._deferredInvalidateRowIndex?Math.min(this._deferredInvalidateRowIndex,o):o}},{key:"measureAllCells",value:function(){this._bottomLeftGrid&&this._bottomLeftGrid.measureAllCells(),this._bottomRightGrid&&this._bottomRightGrid.measureAllCells(),this._topLeftGrid&&this._topLeftGrid.measureAllCells(),this._topRightGrid&&this._topRightGrid.measureAllCells()}},{key:"recomputeGridSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.columnIndex,r=void 0===t?0:t,n=e.rowIndex,o=void 0===n?0:n,i=this.props,a=i.fixedColumnCount,s=i.fixedRowCount,l=Math.max(0,r-a),c=Math.max(0,o-s);this._bottomLeftGrid&&this._bottomLeftGrid.recomputeGridSize({columnIndex:r,rowIndex:c}),this._bottomRightGrid&&this._bottomRightGrid.recomputeGridSize({columnIndex:l,rowIndex:c}),this._topLeftGrid&&this._topLeftGrid.recomputeGridSize({columnIndex:r,rowIndex:o}),this._topRightGrid&&this._topRightGrid.recomputeGridSize({columnIndex:l,rowIndex:o}),this._leftGridWidth=null,this._topGridHeight=null,this._maybeCalculateCachedStyles(!0)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.scrollLeft,r=e.scrollTop;if(t>0||r>0){var n={};t>0&&(n.scrollLeft=t),r>0&&(n.scrollTop=r),this.setState(n)}this._handleInvalidatedGridSize()}},{key:"componentDidUpdate",value:function(){this._handleInvalidatedGridSize()}},{key:"render",value:function(){var e=this.props,t=e.onScroll,r=e.onSectionRendered;e.onScrollbarPresenceChange,e.scrollLeft;var n=e.scrollToColumn;e.scrollTop;var o=e.scrollToRow,i=_objectWithoutProperties(e,["onScroll","onSectionRendered","onScrollbarPresenceChange","scrollLeft","scrollToColumn","scrollTop","scrollToRow"]);if(this._prepareForRender(),0===this.props.width||0===this.props.height)return null;var a=this.state,s=a.scrollLeft,l=a.scrollTop;return reactExports.createElement("div",{style:this._containerOuterStyle},reactExports.createElement("div",{style:this._containerTopStyle},this._renderTopLeftGrid(i),this._renderTopRightGrid(_objectSpread$2({},i,{onScroll:t,scrollLeft:s}))),reactExports.createElement("div",{style:this._containerBottomStyle},this._renderBottomLeftGrid(_objectSpread$2({},i,{onScroll:t,scrollTop:l})),this._renderBottomRightGrid(_objectSpread$2({},i,{onScroll:t,onSectionRendered:r,scrollLeft:s,scrollToColumn:n,scrollToRow:o,scrollTop:l}))))}},{key:"_getBottomGridHeight",value:function(e){return e.height-this._getTopGridHeight(e)}},{key:"_getLeftGridWidth",value:function(e){var t=e.fixedColumnCount,r=e.columnWidth;if(null==this._leftGridWidth)if("function"==typeof r){for(var n=0,o=0;o<t;o++)n+=r({index:o});this._leftGridWidth=n}else this._leftGridWidth=r*t;return this._leftGridWidth}},{key:"_getRightGridWidth",value:function(e){return e.width-this._getLeftGridWidth(e)}},{key:"_getTopGridHeight",value:function(e){var t=e.fixedRowCount,r=e.rowHeight;if(null==this._topGridHeight)if("function"==typeof r){for(var n=0,o=0;o<t;o++)n+=r({index:o});this._topGridHeight=n}else this._topGridHeight=r*t;return this._topGridHeight}},{key:"_handleInvalidatedGridSize",value:function(){if("number"==typeof this._deferredInvalidateColumnIndex){var e=this._deferredInvalidateColumnIndex,t=this._deferredInvalidateRowIndex;this._deferredInvalidateColumnIndex=null,this._deferredInvalidateRowIndex=null,this.recomputeGridSize({columnIndex:e,rowIndex:t}),this.forceUpdate()}}},{key:"_maybeCalculateCachedStyles",value:function(e){var t=this.props,r=t.columnWidth,n=t.enableFixedColumnScroll,o=t.enableFixedRowScroll,i=t.height,a=t.fixedColumnCount,s=t.fixedRowCount,l=t.rowHeight,c=t.style,u=t.styleBottomLeftGrid,d=t.styleBottomRightGrid,h=t.styleTopLeftGrid,p=t.styleTopRightGrid,f=t.width,g=e||i!==this._lastRenderedHeight||f!==this._lastRenderedWidth,m=e||r!==this._lastRenderedColumnWidth||a!==this._lastRenderedFixedColumnCount,y=e||s!==this._lastRenderedFixedRowCount||l!==this._lastRenderedRowHeight;(e||g||c!==this._lastRenderedStyle)&&(this._containerOuterStyle=_objectSpread$2({height:i,overflow:"visible",width:f},c)),(e||g||y)&&(this._containerTopStyle={height:this._getTopGridHeight(this.props),position:"relative",width:f},this._containerBottomStyle={height:i-this._getTopGridHeight(this.props),overflow:"visible",position:"relative",width:f}),(e||u!==this._lastRenderedStyleBottomLeftGrid)&&(this._bottomLeftGridStyle=_objectSpread$2({left:0,overflowX:"hidden",overflowY:n?"auto":"hidden",position:"absolute"},u)),(e||m||d!==this._lastRenderedStyleBottomRightGrid)&&(this._bottomRightGridStyle=_objectSpread$2({left:this._getLeftGridWidth(this.props),position:"absolute"},d)),(e||h!==this._lastRenderedStyleTopLeftGrid)&&(this._topLeftGridStyle=_objectSpread$2({left:0,overflowX:"hidden",overflowY:"hidden",position:"absolute",top:0},h)),(e||m||p!==this._lastRenderedStyleTopRightGrid)&&(this._topRightGridStyle=_objectSpread$2({left:this._getLeftGridWidth(this.props),overflowX:o?"auto":"hidden",overflowY:"hidden",position:"absolute",top:0},p)),this._lastRenderedColumnWidth=r,this._lastRenderedFixedColumnCount=a,this._lastRenderedFixedRowCount=s,this._lastRenderedHeight=i,this._lastRenderedRowHeight=l,this._lastRenderedStyle=c,this._lastRenderedStyleBottomLeftGrid=u,this._lastRenderedStyleBottomRightGrid=d,this._lastRenderedStyleTopLeftGrid=h,this._lastRenderedStyleTopRightGrid=p,this._lastRenderedWidth=f}},{key:"_prepareForRender",value:function(){this._lastRenderedColumnWidth===this.props.columnWidth&&this._lastRenderedFixedColumnCount===this.props.fixedColumnCount||(this._leftGridWidth=null),this._lastRenderedFixedRowCount===this.props.fixedRowCount&&this._lastRenderedRowHeight===this.props.rowHeight||(this._topGridHeight=null),this._maybeCalculateCachedStyles(),this._lastRenderedColumnWidth=this.props.columnWidth,this._lastRenderedFixedColumnCount=this.props.fixedColumnCount,this._lastRenderedFixedRowCount=this.props.fixedRowCount,this._lastRenderedRowHeight=this.props.rowHeight}},{key:"_renderBottomLeftGrid",value:function(e){var t=e.enableFixedColumnScroll,r=e.fixedColumnCount,n=e.fixedRowCount,o=e.rowCount,i=e.hideBottomLeftGridScrollbar,a=this.state.showVerticalScrollbar;if(!r)return null;var s=a?1:0,l=this._getBottomGridHeight(e),c=this._getLeftGridWidth(e),u=this.state.showVerticalScrollbar?this.state.scrollbarSize:0,d=i?c+u:c,h=reactExports.createElement(Grid$1,_extends$4({},e,{cellRenderer:this._cellRendererBottomLeftGrid,className:this.props.classNameBottomLeftGrid,columnCount:r,deferredMeasurementCache:this._deferredMeasurementCacheBottomLeftGrid,height:l,onScroll:t?this._onScrollTop:void 0,ref:this._bottomLeftGridRef,rowCount:Math.max(0,o-n)+s,rowHeight:this._rowHeightBottomGrid,style:this._bottomLeftGridStyle,tabIndex:null,width:d}));return i?reactExports.createElement("div",{className:"BottomLeftGrid_ScrollWrapper",style:_objectSpread$2({},this._bottomLeftGridStyle,{height:l,width:c,overflowY:"hidden"})},h):h}},{key:"_renderBottomRightGrid",value:function(e){var t=e.columnCount,r=e.fixedColumnCount,n=e.fixedRowCount,o=e.rowCount,i=e.scrollToColumn,a=e.scrollToRow;return reactExports.createElement(Grid$1,_extends$4({},e,{cellRenderer:this._cellRendererBottomRightGrid,className:this.props.classNameBottomRightGrid,columnCount:Math.max(0,t-r),columnWidth:this._columnWidthRightGrid,deferredMeasurementCache:this._deferredMeasurementCacheBottomRightGrid,height:this._getBottomGridHeight(e),onScroll:this._onScroll,onScrollbarPresenceChange:this._onScrollbarPresenceChange,ref:this._bottomRightGridRef,rowCount:Math.max(0,o-n),rowHeight:this._rowHeightBottomGrid,scrollToColumn:i-r,scrollToRow:a-n,style:this._bottomRightGridStyle,width:this._getRightGridWidth(e)}))}},{key:"_renderTopLeftGrid",value:function(e){var t=e.fixedColumnCount,r=e.fixedRowCount;return t&&r?reactExports.createElement(Grid$1,_extends$4({},e,{className:this.props.classNameTopLeftGrid,columnCount:t,height:this._getTopGridHeight(e),ref:this._topLeftGridRef,rowCount:r,style:this._topLeftGridStyle,tabIndex:null,width:this._getLeftGridWidth(e)})):null}},{key:"_renderTopRightGrid",value:function(e){var t=e.columnCount,r=e.enableFixedRowScroll,n=e.fixedColumnCount,o=e.fixedRowCount,i=e.scrollLeft,a=e.hideTopRightGridScrollbar,s=this.state,l=s.showHorizontalScrollbar,c=s.scrollbarSize;if(!o)return null;var u=l?1:0,d=this._getTopGridHeight(e),h=this._getRightGridWidth(e),p=l?c:0,f=d,g=this._topRightGridStyle;a&&(f=d+p,g=_objectSpread$2({},this._topRightGridStyle,{left:0}));var m=reactExports.createElement(Grid$1,_extends$4({},e,{cellRenderer:this._cellRendererTopRightGrid,className:this.props.classNameTopRightGrid,columnCount:Math.max(0,t-n)+u,columnWidth:this._columnWidthRightGrid,deferredMeasurementCache:this._deferredMeasurementCacheTopRightGrid,height:f,onScroll:r?this._onScrollLeft:void 0,ref:this._topRightGridRef,rowCount:o,scrollLeft:i,style:g,tabIndex:null,width:h}));return a?reactExports.createElement("div",{className:"TopRightGrid_ScrollWrapper",style:_objectSpread$2({},this._topRightGridStyle,{height:d,width:h,overflowX:"hidden"})},m):m}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.scrollLeft!==t.scrollLeft||e.scrollTop!==t.scrollTop?{scrollLeft:null!=e.scrollLeft&&e.scrollLeft>=0?e.scrollLeft:t.scrollLeft,scrollTop:null!=e.scrollTop&&e.scrollTop>=0?e.scrollTop:t.scrollTop}:null}}]),t}(reactExports.PureComponent);_defineProperty$D(MultiGrid,"defaultProps",{classNameBottomLeftGrid:"",classNameBottomRightGrid:"",classNameTopLeftGrid:"",classNameTopRightGrid:"",enableFixedColumnScroll:!1,enableFixedRowScroll:!1,fixedColumnCount:0,fixedRowCount:0,scrollToColumn:-1,scrollToRow:-1,style:{},styleBottomLeftGrid:{},styleBottomRightGrid:{},styleTopLeftGrid:{},styleTopRightGrid:{},hideTopRightGridScrollbar:!1,hideBottomLeftGridScrollbar:!1}),MultiGrid.propTypes={},polyfill(MultiGrid);var ScrollSync=function(e){function t(e,r){var n;return _classCallCheck$2D(this,t),(n=_possibleConstructorReturn$27(this,_getPrototypeOf$27(t).call(this,e,r))).state={clientHeight:0,clientWidth:0,scrollHeight:0,scrollLeft:0,scrollTop:0,scrollWidth:0},n._onScroll=n._onScroll.bind(_assertThisInitialized$27(n)),n}return _inherits$27(t,e),_createClass$2D(t,[{key:"render",value:function(){var e=this.props.children,t=this.state,r=t.clientHeight,n=t.clientWidth,o=t.scrollHeight,i=t.scrollLeft,a=t.scrollTop,s=t.scrollWidth;return e({clientHeight:r,clientWidth:n,onScroll:this._onScroll,scrollHeight:o,scrollLeft:i,scrollTop:a,scrollWidth:s})}},{key:"_onScroll",value:function(e){var t=e.clientHeight,r=e.clientWidth,n=e.scrollHeight,o=e.scrollLeft,i=e.scrollTop,a=e.scrollWidth;this.setState({clientHeight:t,clientWidth:r,scrollHeight:n,scrollLeft:o,scrollTop:i,scrollWidth:a})}}]),t}(reactExports.PureComponent);function defaultCellDataGetter(e){var t=e.dataKey,r=e.rowData;return"function"==typeof r.get?r.get(t):r[t]}function defaultCellRenderer(e){var t=e.cellData;return null==t?"":String(t)}function defaultHeaderRowRenderer(e){var t=e.className,r=e.columns,n=e.style;return reactExports.createElement("div",{className:t,role:"row",style:n},r)}ScrollSync.propTypes={},defaultHeaderRowRenderer.propTypes=null;var SortDirection={ASC:"ASC",DESC:"DESC"};function SortIndicator(e){var t=e.sortDirection,r=clsx$1("ReactVirtualized__Table__sortableHeaderIcon",{"ReactVirtualized__Table__sortableHeaderIcon--ASC":t===SortDirection.ASC,"ReactVirtualized__Table__sortableHeaderIcon--DESC":t===SortDirection.DESC});return reactExports.createElement("svg",{className:r,width:18,height:18,viewBox:"0 0 24 24"},t===SortDirection.ASC?reactExports.createElement("path",{d:"M7 14l5-5 5 5z"}):reactExports.createElement("path",{d:"M7 10l5 5 5-5z"}),reactExports.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))}function defaultHeaderRenderer(e){var t=e.dataKey,r=e.label,n=e.sortBy,o=e.sortDirection,i=n===t,a=[reactExports.createElement("span",{className:"ReactVirtualized__Table__headerTruncatedText",key:"label",title:"string"==typeof r?r:null},r)];return i&&a.push(reactExports.createElement(SortIndicator,{key:"SortIndicator",sortDirection:o})),a}function defaultRowRenderer(e){var t=e.className,r=e.columns,n=e.index,o=e.key,i=e.onRowClick,a=e.onRowDoubleClick,s=e.onRowMouseOut,l=e.onRowMouseOver,c=e.onRowRightClick,u=e.rowData,d=e.style,h={"aria-rowindex":n+1};return(i||a||s||l||c)&&(h["aria-label"]="row",h.tabIndex=0,i&&(h.onClick=function(e){return i({event:e,index:n,rowData:u})}),a&&(h.onDoubleClick=function(e){return a({event:e,index:n,rowData:u})}),s&&(h.onMouseOut=function(e){return s({event:e,index:n,rowData:u})}),l&&(h.onMouseOver=function(e){return l({event:e,index:n,rowData:u})}),c&&(h.onContextMenu=function(e){return c({event:e,index:n,rowData:u})})),reactExports.createElement("div",_extends$4({},h,{className:t,key:o,role:"row",style:d}),r)}SortIndicator.propTypes={},defaultHeaderRenderer.propTypes=null,defaultRowRenderer.propTypes=null;var Column=function(e){function t(){return _classCallCheck$2D(this,t),_possibleConstructorReturn$27(this,_getPrototypeOf$27(t).apply(this,arguments))}return _inherits$27(t,e),t}(reactExports.Component);function ownKeys$1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$1(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$1(r,!0).forEach((function(t){_defineProperty$D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$1(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}_defineProperty$D(Column,"defaultProps",{cellDataGetter:defaultCellDataGetter,cellRenderer:defaultCellRenderer,defaultSortDirection:SortDirection.ASC,flexGrow:0,flexShrink:1,headerRenderer:defaultHeaderRenderer,style:{}}),Column.propTypes={};var Table$1=function(e){function t(e){var r;return _classCallCheck$2D(this,t),(r=_possibleConstructorReturn$27(this,_getPrototypeOf$27(t).call(this,e))).state={scrollbarWidth:0},r._createColumn=r._createColumn.bind(_assertThisInitialized$27(r)),r._createRow=r._createRow.bind(_assertThisInitialized$27(r)),r._onScroll=r._onScroll.bind(_assertThisInitialized$27(r)),r._onSectionRendered=r._onSectionRendered.bind(_assertThisInitialized$27(r)),r._setRef=r._setRef.bind(_assertThisInitialized$27(r)),r}return _inherits$27(t,e),_createClass$2D(t,[{key:"forceUpdateGrid",value:function(){this.Grid&&this.Grid.forceUpdate()}},{key:"getOffsetForRow",value:function(e){var t=e.alignment,r=e.index;return this.Grid?this.Grid.getOffsetForCell({alignment:t,rowIndex:r}).scrollTop:0}},{key:"invalidateCellSizeAfterRender",value:function(e){var t=e.columnIndex,r=e.rowIndex;this.Grid&&this.Grid.invalidateCellSizeAfterRender({rowIndex:r,columnIndex:t})}},{key:"measureAllRows",value:function(){this.Grid&&this.Grid.measureAllCells()}},{key:"recomputeGridSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.columnIndex,r=void 0===t?0:t,n=e.rowIndex,o=void 0===n?0:n;this.Grid&&this.Grid.recomputeGridSize({rowIndex:o,columnIndex:r})}},{key:"recomputeRowHeights",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.recomputeGridSize({rowIndex:e})}},{key:"scrollToPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.scrollToPosition({scrollTop:e})}},{key:"scrollToRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.scrollToCell({columnIndex:0,rowIndex:e})}},{key:"getScrollbarWidth",value:function(){if(this.Grid){var e=reactDomExports.findDOMNode(this.Grid),t=e.clientWidth||0;return(e.offsetWidth||0)-t}return 0}},{key:"componentDidMount",value:function(){this._setScrollbarWidth()}},{key:"componentDidUpdate",value:function(){this._setScrollbarWidth()}},{key:"render",value:function(){var e=this,t=this.props,r=t.children,n=t.className,o=t.disableHeader,i=t.gridClassName,a=t.gridStyle,s=t.headerHeight,l=t.headerRowRenderer,c=t.height,u=t.id,d=t.noRowsRenderer,h=t.rowClassName,p=t.rowStyle,f=t.scrollToIndex,g=t.style,m=t.width,y=this.state.scrollbarWidth,v=o?c:c-s,_="function"==typeof h?h({index:-1}):h,b="function"==typeof p?p({index:-1}):p;return this._cachedColumnStyles=[],reactExports.Children.toArray(r).forEach((function(t,r){var n=e._getFlexStyleForColumn(t,t.props.style);e._cachedColumnStyles[r]=_objectSpread$1({overflow:"hidden"},n)})),reactExports.createElement("div",{"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-colcount":reactExports.Children.toArray(r).length,"aria-rowcount":this.props.rowCount,className:clsx$1("ReactVirtualized__Table",n),id:u,role:"grid",style:g},!o&&l({className:clsx$1("ReactVirtualized__Table__headerRow",_),columns:this._getHeaderColumns(),style:_objectSpread$1({height:s,overflow:"hidden",paddingRight:y,width:m},b)}),reactExports.createElement(Grid$1,_extends$4({},this.props,{"aria-readonly":null,autoContainerWidth:!0,className:clsx$1("ReactVirtualized__Table__Grid",i),cellRenderer:this._createRow,columnWidth:m,columnCount:1,height:v,id:void 0,noContentRenderer:d,onScroll:this._onScroll,onSectionRendered:this._onSectionRendered,ref:this._setRef,role:"rowgroup",scrollbarWidth:y,scrollToRow:f,style:_objectSpread$1({},a,{overflowX:"hidden"})})))}},{key:"_createColumn",value:function(e){var t=e.column,r=e.columnIndex,n=e.isScrolling,o=e.parent,i=e.rowData,a=e.rowIndex,s=this.props.onColumnClick,l=t.props,c=l.cellDataGetter,u=l.cellRenderer,d=l.className,h=l.columnData,p=l.dataKey,f=l.id,g=u({cellData:c({columnData:h,dataKey:p,rowData:i}),columnData:h,columnIndex:r,dataKey:p,isScrolling:n,parent:o,rowData:i,rowIndex:a}),m=this._cachedColumnStyles[r],y="string"==typeof g?g:null;return reactExports.createElement("div",{"aria-colindex":r+1,"aria-describedby":f,className:clsx$1("ReactVirtualized__Table__rowColumn",d),key:"Row"+a+"-Col"+r,onClick:function(e){s&&s({columnData:h,dataKey:p,event:e})},role:"gridcell",style:m,title:y},g)}},{key:"_createHeader",value:function(e){var t,r,n,o,i,a=e.column,s=e.index,l=this.props,c=l.headerClassName,u=l.headerStyle,d=l.onHeaderClick,h=l.sort,p=l.sortBy,f=l.sortDirection,g=a.props,m=g.columnData,y=g.dataKey,v=g.defaultSortDirection,_=g.disableSort,b=g.headerRenderer,C=g.id,E=g.label,T=!_&&h,S=clsx$1("ReactVirtualized__Table__headerColumn",c,a.props.headerClassName,{ReactVirtualized__Table__sortableHeaderColumn:T}),P=this._getFlexStyleForColumn(a,_objectSpread$1({},u,{},a.props.headerStyle)),w=b({columnData:m,dataKey:y,disableSort:_,label:E,sortBy:p,sortDirection:f});if(T||d){var x=p!==y?v:f===SortDirection.DESC?SortDirection.ASC:SortDirection.DESC,O=function(e){T&&h({defaultSortDirection:v,event:e,sortBy:y,sortDirection:x}),d&&d({columnData:m,dataKey:y,event:e})};i=a.props["aria-label"]||E||y,o="none",n=0,t=O,r=function(e){"Enter"!==e.key&&" "!==e.key||O(e)}}return p===y&&(o=f===SortDirection.ASC?"ascending":"descending"),reactExports.createElement("div",{"aria-label":i,"aria-sort":o,className:S,id:C,key:"Header-Col"+s,onClick:t,onKeyDown:r,role:"columnheader",style:P,tabIndex:n},w)}},{key:"_createRow",value:function(e){var t=this,r=e.rowIndex,n=e.isScrolling,o=e.key,i=e.parent,a=e.style,s=this.props,l=s.children,c=s.onRowClick,u=s.onRowDoubleClick,d=s.onRowRightClick,h=s.onRowMouseOver,p=s.onRowMouseOut,f=s.rowClassName,g=s.rowGetter,m=s.rowRenderer,y=s.rowStyle,v=this.state.scrollbarWidth,_="function"==typeof f?f({index:r}):f,b="function"==typeof y?y({index:r}):y,C=g({index:r}),E=reactExports.Children.toArray(l).map((function(e,o){return t._createColumn({column:e,columnIndex:o,isScrolling:n,parent:i,rowData:C,rowIndex:r,scrollbarWidth:v})})),T=clsx$1("ReactVirtualized__Table__row",_),S=_objectSpread$1({},a,{height:this._getRowHeight(r),overflow:"hidden",paddingRight:v},b);return m({className:T,columns:E,index:r,isScrolling:n,key:o,onRowClick:c,onRowDoubleClick:u,onRowRightClick:d,onRowMouseOver:h,onRowMouseOut:p,rowData:C,style:S})}},{key:"_getFlexStyleForColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="".concat(e.props.flexGrow," ").concat(e.props.flexShrink," ").concat(e.props.width,"px"),n=_objectSpread$1({},t,{flex:r,msFlex:r,WebkitFlex:r});return e.props.maxWidth&&(n.maxWidth=e.props.maxWidth),e.props.minWidth&&(n.minWidth=e.props.minWidth),n}},{key:"_getHeaderColumns",value:function(){var e=this,t=this.props,r=t.children;return(t.disableHeader?[]:reactExports.Children.toArray(r)).map((function(t,r){return e._createHeader({column:t,index:r})}))}},{key:"_getRowHeight",value:function(e){var t=this.props.rowHeight;return"function"==typeof t?t({index:e}):t}},{key:"_onScroll",value:function(e){var t=e.clientHeight,r=e.scrollHeight,n=e.scrollTop;(0,this.props.onScroll)({clientHeight:t,scrollHeight:r,scrollTop:n})}},{key:"_onSectionRendered",value:function(e){var t=e.rowOverscanStartIndex,r=e.rowOverscanStopIndex,n=e.rowStartIndex,o=e.rowStopIndex;(0,this.props.onRowsRendered)({overscanStartIndex:t,overscanStopIndex:r,startIndex:n,stopIndex:o})}},{key:"_setRef",value:function(e){this.Grid=e}},{key:"_setScrollbarWidth",value:function(){var e=this.getScrollbarWidth();this.setState({scrollbarWidth:e})}}]),t}(reactExports.PureComponent);_defineProperty$D(Table$1,"defaultProps",{disableHeader:!1,estimatedRowSize:30,headerHeight:0,headerStyle:{},noRowsRenderer:function(){return null},onRowsRendered:function(){return null},onScroll:function(){return null},overscanIndicesGetter:defaultOverscanIndicesGetter,overscanRowCount:10,rowRenderer:defaultRowRenderer,headerRowRenderer:defaultHeaderRowRenderer,rowStyle:{},scrollToAlignment:"auto",scrollToIndex:-1,style:{}}),Table$1.propTypes={};var mountedInstances=[],originalBodyPointerEvents=null,disablePointerEventsTimeoutId=null;function enablePointerEventsIfDisabled(){disablePointerEventsTimeoutId&&(disablePointerEventsTimeoutId=null,document.body&&null!=originalBodyPointerEvents&&(document.body.style.pointerEvents=originalBodyPointerEvents),originalBodyPointerEvents=null)}function enablePointerEventsAfterDelayCallback(){enablePointerEventsIfDisabled(),mountedInstances.forEach((function(e){return e.__resetIsScrolling()}))}function enablePointerEventsAfterDelay(){disablePointerEventsTimeoutId&&cancelAnimationTimeout(disablePointerEventsTimeoutId);var e=0;mountedInstances.forEach((function(t){e=Math.max(e,t.props.scrollingResetTimeInterval)})),disablePointerEventsTimeoutId=requestAnimationTimeout(enablePointerEventsAfterDelayCallback,e)}function onScrollWindow(e){e.currentTarget===window&&null==originalBodyPointerEvents&&document.body&&(originalBodyPointerEvents=document.body.style.pointerEvents,document.body.style.pointerEvents="none"),enablePointerEventsAfterDelay(),mountedInstances.forEach((function(t){t.props.scrollElement===e.currentTarget&&t.__handleWindowScrollEvent()}))}function registerScrollListener(e,t){mountedInstances.some((function(e){return e.props.scrollElement===t}))||t.addEventListener("scroll",onScrollWindow),mountedInstances.push(e)}function unregisterScrollListener(e,t){(mountedInstances=mountedInstances.filter((function(t){return t!==e}))).length||(t.removeEventListener("scroll",onScrollWindow),disablePointerEventsTimeoutId&&(cancelAnimationTimeout(disablePointerEventsTimeoutId),enablePointerEventsIfDisabled()))}var isWindow=function(e){return e===window},getBoundingBox=function(e){return e.getBoundingClientRect()},_class,_temp;function getDimensions(e,t){if(e){if(isWindow(e)){var r=window,n=r.innerHeight,o=r.innerWidth;return{height:"number"==typeof n?n:0,width:"number"==typeof o?o:0}}return getBoundingBox(e)}return{height:t.serverHeight,width:t.serverWidth}}function getPositionOffset(e,t){if(isWindow(t)&&document.documentElement){var r=document.documentElement,n=getBoundingBox(e),o=getBoundingBox(r);return{top:n.top-o.top,left:n.left-o.left}}var i=getScrollOffset(t),a=getBoundingBox(e),s=getBoundingBox(t);return{top:a.top+i.top-s.top,left:a.left+i.left-s.left}}function getScrollOffset(e){return isWindow(e)&&document.documentElement?{top:"scrollY"in window?window.scrollY:document.documentElement.scrollTop,left:"scrollX"in window?window.scrollX:document.documentElement.scrollLeft}:{top:e.scrollTop,left:e.scrollLeft}}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(r,!0).forEach((function(t){_defineProperty$D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var IS_SCROLLING_TIMEOUT=150,getWindow=function(){return"undefined"!=typeof window?window:void 0},WindowScroller=(_temp=_class=function(e){function t(){var e,r;_classCallCheck$2D(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return r=_possibleConstructorReturn$27(this,(e=_getPrototypeOf$27(t)).call.apply(e,[this].concat(o))),_defineProperty$D(_assertThisInitialized$27(r),"_window",getWindow()),_defineProperty$D(_assertThisInitialized$27(r),"_isMounted",!1),_defineProperty$D(_assertThisInitialized$27(r),"_positionFromTop",0),_defineProperty$D(_assertThisInitialized$27(r),"_positionFromLeft",0),_defineProperty$D(_assertThisInitialized$27(r),"_detectElementResize",void 0),_defineProperty$D(_assertThisInitialized$27(r),"_child",void 0),_defineProperty$D(_assertThisInitialized$27(r),"state",_objectSpread({},getDimensions(r.props.scrollElement,r.props),{isScrolling:!1,scrollLeft:0,scrollTop:0})),_defineProperty$D(_assertThisInitialized$27(r),"_registerChild",(function(e){e&&Element,r._child=e,r.updatePosition()})),_defineProperty$D(_assertThisInitialized$27(r),"_onChildScroll",(function(e){var t=e.scrollTop;if(r.state.scrollTop!==t){var n=r.props.scrollElement;n&&("function"==typeof n.scrollTo?n.scrollTo(0,t+r._positionFromTop):n.scrollTop=t+r._positionFromTop)}})),_defineProperty$D(_assertThisInitialized$27(r),"_registerResizeListener",(function(e){e===window?window.addEventListener("resize",r._onResize,!1):r._detectElementResize.addResizeListener(e,r._onResize)})),_defineProperty$D(_assertThisInitialized$27(r),"_unregisterResizeListener",(function(e){e===window?window.removeEventListener("resize",r._onResize,!1):e&&r._detectElementResize.removeResizeListener(e,r._onResize)})),_defineProperty$D(_assertThisInitialized$27(r),"_onResize",(function(){r.updatePosition()})),_defineProperty$D(_assertThisInitialized$27(r),"__handleWindowScrollEvent",(function(){if(r._isMounted){var e=r.props.onScroll,t=r.props.scrollElement;if(t){var n=getScrollOffset(t),o=Math.max(0,n.left-r._positionFromLeft),i=Math.max(0,n.top-r._positionFromTop);r.setState({isScrolling:!0,scrollLeft:o,scrollTop:i}),e({scrollLeft:o,scrollTop:i})}}})),_defineProperty$D(_assertThisInitialized$27(r),"__resetIsScrolling",(function(){r.setState({isScrolling:!1})})),r}return _inherits$27(t,e),_createClass$2D(t,[{key:"updatePosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.scrollElement,t=this.props.onResize,r=this.state,n=r.height,o=r.width,i=this._child||reactDomExports.findDOMNode(this);if(i instanceof Element&&e){var a=getPositionOffset(i,e);this._positionFromTop=a.top,this._positionFromLeft=a.left}var s=getDimensions(e,this.props);n===s.height&&o===s.width||(this.setState({height:s.height,width:s.width}),t({height:s.height,width:s.width}))}},{key:"componentDidMount",value:function(){var e=this.props.scrollElement;this._detectElementResize=createDetectElementResize(),this.updatePosition(e),e&&(registerScrollListener(this,e),this._registerResizeListener(e)),this._isMounted=!0}},{key:"componentDidUpdate",value:function(e,t){var r=this.props.scrollElement,n=e.scrollElement;n!==r&&null!=n&&null!=r&&(this.updatePosition(r),unregisterScrollListener(this,n),registerScrollListener(this,r),this._unregisterResizeListener(n),this._registerResizeListener(r))}},{key:"componentWillUnmount",value:function(){var e=this.props.scrollElement;e&&(unregisterScrollListener(this,e),this._unregisterResizeListener(e)),this._isMounted=!1}},{key:"render",value:function(){var e=this.props.children,t=this.state,r=t.isScrolling,n=t.scrollTop,o=t.scrollLeft,i=t.height,a=t.width;return e({onChildScroll:this._onChildScroll,registerChild:this._registerChild,height:i,isScrolling:r,scrollLeft:o,scrollTop:n,width:a})}}]),t}(reactExports.PureComponent),_defineProperty$D(_class,"propTypes",null),_temp);_defineProperty$D(WindowScroller,"defaultProps",{onResize:function(){},onScroll:function(){},scrollingResetTimeInterval:IS_SCROLLING_TIMEOUT,scrollElement:getWindow(),serverHeight:0,serverWidth:0});const classPrefix$8="fdm-search-bar",SearchBar=reactExports.forwardRef(((e,t)=>{const{locale:r}=useConfig(),{isSearch:n}=e,o=__rest$p(e,["isSearch"]);return jsxRuntimeExports.jsx(SearchBar$1,Object.assign({ref:t,className:classNames$1(classPrefix$8,{"search-inactive":!n}),showCancelButton:()=>n,placeholder:n?r.fine.SEARCH:"",icon:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(SearchOutline,{}),jsxRuntimeExports.jsx("span",{children:n?"":r.fine.SEARCH})]})},o))})),classPrefix$7="fdm-dot-loading",DotLoading=e=>withNativeProps(e,jsxRuntimeExports.jsx("div",Object.assign({className:classPrefix$7},{children:jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$7,"-container")},{children:[0,1,2].map((e=>jsxRuntimeExports.jsx("div",{className:"".concat(classPrefix$7,"-dot"),style:{animationDelay:"".concat(.2*e,"s")}},e)))}))}))),classPrefix$6="fdm-drop-menu-editor",ITEM_VIEW_HEIGHT$1=44,ITEM_SEPARATOR_HEIGHT$1=1,DropMenuEditor=reactExports.forwardRef(((e,t)=>{const[r,n]=reactExports.useState(e.selectedItems),o=reactExports.useRef(""),i=()=>{n([])};reactExports.useImperativeHandle(t,(()=>({getCurrentSelectedItems:()=>r,clear:i})));const a=debounce$4((t=>{var r;o.current=t,null===(r=e.onSearchChange)||void 0===r||r.call(e,t)}),300),s=(e,t)=>e.text===t.text&&e.value===t.value;useUpdateEffect((()=>{var t;e.multiple||(null===(t=e.onItemSelect)||void 0===t||t.call(e,r[0],!0),e.onConfirm(r))}),[r]);const{locale:l}=useConfig(),c=t=>{var o;const i=e.items,a=t?d(r,i):h(r,i);n(a),null===(o=e.onAllSelect)||void 0===o||o.call(e,t,i)},u=e=>e.text+"-"+e.value,d=(e,t)=>{const r=f(e),n=t.filter((e=>!r.has(u(e))));return e.concat(n)},h=(e,t)=>{const r=f(t);return e.filter((e=>!r.has(u(e))))},p=(e,t)=>{const r=f(t);return e.every((e=>r.has(u(e))))},f=e=>{const t=new Map;return e.forEach((e=>{t.set(u(e),e)})),t},g=t=>(e.multiple?"fdm-checkbox":"fdm-radio")+(t?"-select":"-unselect"),m=({index:t,key:i,style:a})=>{const l=e.items,c=l[t],u=(d=c,r.some((e=>s(e,d))));var d;return jsxRuntimeExports.jsxs("div",Object.assign({style:a,onClick:()=>(t=>{var o,i;let a=r.concat();e.multiple?a.some((e=>s(e,t)))?(a=a.filter((e=>!s(e,t))),null===(o=e.onItemSelect)||void 0===o||o.call(e,t,!1)):(a.push(t),null===(i=e.onItemSelect)||void 0===i||i.call(e,t,!0)):a=[t];n(a)})(c)},{children:[jsxRuntimeExports.jsx(DropMenuItem,{text:c.text,searchText:o.current,isCustom:!!c.custom,iconName:g(u),isSelected:u},"item"+t),t<l.length-1&&jsxRuntimeExports.jsx("div",{className:"separator"})]}),"item"+t)};return jsxRuntimeExports.jsxs("div",Object.assign({className:classPrefix$6},{children:[!(e.hideHeader||e.simple||e.isSearch||e.isRequired)&&jsxRuntimeExports.jsx("div",Object.assign({className:"header"},{children:jsxRuntimeExports.jsx(Button$2,Object.assign({onClick:i},{children:l.fine.CLEAR}))})),!e.simple&&jsxRuntimeExports.jsx(SearchBar,{style:{marginTop:10},isSearch:e.isSearch,onChange:a,onFocus:e.onSearchFocus,onBlur:e.onSearchBlur,onCancel:e.onSearchCancel}),e.showSelectAll&&e.multiple&&!isEmpty$3(e.items)&&(()=>{const t=(()=>{const t=r,n=e.items;return 0!==n.length&&p(n,t)})();return jsxRuntimeExports.jsxs("div",Object.assign({className:classNames$1("select-all",{selected:t})},{children:[jsxRuntimeExports.jsxs("div",Object.assign({className:"text",onClick:()=>c(!t)},{children:[jsxRuntimeExports.jsx("span",Object.assign({className:"select-all-text"},{children:l.fine.SELECT_ALL})),jsxRuntimeExports.jsx(Icon$1,{size:16,name:g(t),className:"icon-".concat(t?"select":"unselect")})]})),jsxRuntimeExports.jsx("div",{className:"separator"})]}))})(),e.simple&&!e.multiple&&!e.isRequired&&!isEmpty$3(e.items)&&(()=>{const e=0===r.length;return jsxRuntimeExports.jsxs("div",Object.assign({className:"not-select"},{children:[jsxRuntimeExports.jsxs("div",Object.assign({className:"text",onClick:()=>n([])},{children:[jsxRuntimeExports.jsxs("span",{children:[" ",l.fine.NOT_SELECT]}),jsxRuntimeExports.jsx(Icon$1,{size:16,name:g(e),className:"icon-".concat(e?"select":"unselect")})]})),jsxRuntimeExports.jsx("div",{className:"separator"})]}))})(),jsxRuntimeExports.jsx("div",Object.assign({className:classNames$1("list-wrap",{hidden:e.isLoading})},{children:jsxRuntimeExports.jsx(AutoSizer,{children:({width:t,height:r})=>jsxRuntimeExports.jsx(List,{rowCount:e.items.length,width:t,height:r,overscanRowCount:10,rowHeight:ITEM_VIEW_HEIGHT$1+ITEM_SEPARATOR_HEIGHT$1,rowRenderer:e=>m(Object.assign(Object.assign({},e),{style:Object.assign(Object.assign({},e.style),{width:t})}))})})})),e.isLoading&&jsxRuntimeExports.jsx(DotLoading,{className:"".concat(classPrefix$6,"-loading")})]}))})),NODE_LEVEL_OFFSET=22,classPrefix$5="fdm-drop-tree-editor-item",DropTreeItem=e=>{let t=e.rowNode,r=null;const{locale:n}=useConfig();if(t.showCheck){let n=e.multiple?"fdm-checkbox":"fdm-radio";n+=t.selected?"-select":"-unselect",r=jsxRuntimeExports.jsx("div",Object.assign({onClick:t=>{t.stopPropagation(),e.onPressSelector()},className:"icon-wrap"},{children:jsxRuntimeExports.jsx(Icon$1,{size:16,name:n,className:"icon-".concat(t.selected?"select":"unselect")})}))}const{searchText:o}=e,i=new RegExp("(".concat(strUtils.escapeSpecialChar(o),")"),"i");return jsxRuntimeExports.jsxs("div",Object.assign({className:classNames$1(classPrefix$5,{selected:t.selected}),onClick:()=>{e.onPressItem()}},{children:[jsxRuntimeExports.jsxs("div",Object.assign({className:"body",style:{marginLeft:(t.deep-1)*NODE_LEVEL_OFFSET}},{children:[t.hasChildren&&jsxRuntimeExports.jsx(Icon$1,{className:"icon",name:t.expand?"fdm-tree-close":"fdm-tree-open",size:16}),jsxRuntimeExports.jsx("div",Object.assign({className:"text"},{children:o?jsxRuntimeExports.jsx("span",{dangerouslySetInnerHTML:{__html:t.text.toString().replace(i,'<span class="fdm-color-theme">$1</span>')}}):t.text.toString()}))]})),jsxRuntimeExports.jsxs("div",Object.assign({className:"tail"},{children:[t.isCustom()&&jsxRuntimeExports.jsx("span",Object.assign({className:"custom"},{children:n.fine.CUSTOM_VALUE})),r]}))]}))},ITEM_VIEW_HEIGHT=44,ITEM_SEPARATOR_HEIGHT=1,classPrefix$4="fdm-drop-tree-editor",DropTreeEditor=reactExports.forwardRef(((e,t)=>{const[r,n]=reactExports.useState(e.selectedNodes),[o,i]=reactExports.useState(0),a=reactExports.useRef(""),{locale:s}=useConfig(),l=debounce$4((t=>{var r;a.current=t,null===(r=e.onSearchChange)||void 0===r||r.call(e,t)}),300),c=e.getNodes();reactExports.useImperativeHandle(t,(()=>({getCurrentSelectedNodes:()=>r,clear:d})));const u=e=>{e.getNodePath().forEach(((e,t)=>{var r;0!==t&&(e.selected=!!(null===(r=e.childNodes)||void 0===r?void 0:r.every((e=>e.selected))))}))},d=()=>{a.current?(()=>{let t=e.getNodes().map((e=>y(e,!1)));Promise.all(t).then((()=>{null==r||r.forEach((t=>{t.selected=!1,e.multiple&&e.isSelectLeafOnly&&u(t)})),n([])}))})():(null==r||r.forEach((t=>{t.selected=!1,e.multiple&&e.isSelectLeafOnly&&u(t)})),n([]))},h=({index:t,key:r,style:n})=>{let o=c[t];return jsxRuntimeExports.jsxs("div",Object.assign({style:n},{children:[jsxRuntimeExports.jsx(DropTreeItem,{rowNode:o,searchText:a.current,multiple:e.multiple,onPressItem:()=>p(o),onPressSelector:()=>m(o)}),t<c.length-1&&jsxRuntimeExports.jsx("div",{className:"separator"})]}),"item"+t)},p=t=>{if(t.hasChildren)if(t.expand=!t.expand,t.expand&&!t.childNodes){const r=!!a.current;e.loadChildNodes(t,r).then((()=>{i(o+1)}))}else i(o+1);else m(t)},f=e=>{var t;if(!e.hasChildren)return[e];let r=[];return null===(t=e.childNodes)||void 0===t||t.forEach((e=>{if(e.hasChildren){let t=f(e);r=r.concat(t)}else r.push(e)})),r},g=e=>{var t;let r=[e];return e.hasChildren&&(null===(t=e.childNodes)||void 0===t||t.forEach((e=>{r=r.concat(g(e))}))),r};useUpdateEffect((()=>{var t;e.multiple||null===(t=e.onConfirm)||void 0===t||t.call(e)}),[r]);const m=t=>{var o;e.multiple?e.isSelectLeafOnly?(t=>{y(t,!t.selected).then((()=>{u(t);const o=e.isLinkRootWhenLeafOnly;let i=o?g(t):f(t);a.current&&i.forEach((e=>{e.getRelatedNode().selected=e.selected,u(e.getRelatedNode())}));let s=r.concat();const l=t.getNodePath();if(t.selected)(o?[...i,...l.filter((e=>e.selected))]:i).forEach((e=>{let t=a.current?e.getRelatedNode():e;s.every((e=>e!==t))&&s.push(t)}));else{const e=o?[...i,...l.filter((e=>!e.selected))]:i;s=r.filter((t=>(a.current?e.map((e=>e.getRelatedNode())):e).every((e=>e!==t))))}n(s)}))})(t):(e=>{if(e.selected){e.selected=!1,a.current&&(e.getRelatedNode().selected=!1);let t=a.current?e.getRelatedNode():e;n(r.filter((e=>e!==t)))}else{e.selected=!0,a.current&&(e.getRelatedNode().selected=!0);let t=r.concat(),o=a.current?e.getRelatedNode():e;t.push(o),n(t)}})(t):(t=>{var r;t.selected?null===(r=e.onConfirm)||void 0===r||r.call(e):(t.selected=!0,a.current?(t.getRelatedNode().selected=!0,n([t.getRelatedNode()])):n([t]))})(t),null===(o=e.onNodeSelect)||void 0===o||o.call(e,t)},y=(t,r)=>(t.selected=r,t.hasChildren?e.loadChildNodes(t).then((()=>{var e;let n=(null===(e=t.childNodes)||void 0===e?void 0:e.map((e=>y(e,r))))||[];return Promise.all(n)})):Promise.resolve()),v=!e.isSearch&&!e.isRequired&&!e.hideHeader;return jsxRuntimeExports.jsxs("div",Object.assign({className:classPrefix$4},{children:[v&&jsxRuntimeExports.jsx("div",Object.assign({className:"header"},{children:jsxRuntimeExports.jsx(Button$2,Object.assign({onClick:d},{children:s.fine.CLEAR}))})),jsxRuntimeExports.jsx(SearchBar,{style:{marginTop:10},isSearch:e.isSearch,onFocus:e.onSearchFocus,onCancel:e.onSearchCancel,onBlur:e.onSearchBlur,onChange:l}),jsxRuntimeExports.jsx("div",Object.assign({className:classNames$1("list-wrap",{hidden:e.isLoading})},{children:jsxRuntimeExports.jsx(AutoSizer,{children:({width:e,height:t})=>jsxRuntimeExports.jsx(List,{rowCount:c.length,width:e,height:t,overscanColumnCount:10,rowHeight:ITEM_VIEW_HEIGHT+ITEM_SEPARATOR_HEIGHT,rowRenderer:h})})})),e.isLoading&&jsxRuntimeExports.jsx(DotLoading,{className:"".concat(classPrefix$4,"-loading")})]}))})),PopupEditor=e=>{const[t,r]=reactExports.useState(!1),n=reactExports.useRef(null),{locale:o}=useConfig();return jsxRuntimeExports.jsx(Popup,Object.assign({destroyOnClose:!0,visible:e.editorShow,className:e.className,onMaskClick:()=>e.setEditorShow(!1),maskStyle:{background:MASK_BG},bodyStyle:{height:t?"100%":522,maxHeight:t?"none":"80%",borderTopLeftRadius:t?0:4,borderTopRightRadius:t?0:4},style:transformStyle(e.popupStyle),afterShow:e.afterEditorShow,afterClose:e.afterEditorClose,getContainer:e.getPopupContainer||document.body},{children:jsxRuntimeExports.jsxs("div",Object.assign({className:"editor-wrap",style:transformStyle(e.editorStyle)},{children:[jsxRuntimeExports.jsx(DropMenuEditor,{ref:n,isSearch:t,onConfirm:e.onConfirm,onSearchFocus:t=>{var n;null===(n=e.onSearchFocus)||void 0===n||n.call(e,t),r(!0),setTimeout((()=>{window.scrollTo(0,1)}),300)},onSearchCancel:()=>{var t;null===(t=e.onSearchCancel)||void 0===t||t.call(e),r(!1)},multiple:e.multiple,onItemSelect:(t,n)=>{var o;null===(o=e.onItemSelect)||void 0===o||o.call(e,t,n),!e.multiple&&r(!1)},onAllSelect:e.onAllSelect,selectedItems:e.selectedItems,onSearchChange:e.onSearchChange,items:e.items,isRequired:e.isRequired,showSelectAll:e.showSelectAll,isLoading:e.isLoading}),e.multiple&&jsxRuntimeExports.jsx("div",Object.assign({className:"confirm"},{children:jsxRuntimeExports.jsx(Button$2,Object.assign({block:!0,onClick:()=>{var t,o;o=null===(t=n.current)||void 0===t?void 0:t.getCurrentSelectedItems(),e.onConfirm(o||[]),r(!1)}},{children:o.fine.CONFIRM}))}))]}))}))},MAX_EDITOR_HEIGHT=350,MIN_EDITOR_HEIGHT=88,MIN_EDITOR_WIDTH=140,DropEditor=e=>{const t=reactExports.useRef(null);return jsxRuntimeExports.jsx(Mask,Object.assign({visible:e.editorShow,className:e.className,onMaskClick:()=>{var r;e.setEditorShow(!1),e.onConfirm(null===(r=t.current)||void 0===r?void 0:r.getCurrentSelectedItems())},afterClose:e.afterEditorClose,afterShow:e.afterEditorShow,style:Object.assign({background:"transparent"},transformStyle(e.popupStyle)),getContainer:document.body,destroyOnClose:!0},{children:jsxRuntimeExports.jsx("div",Object.assign({className:"editor-wrap simple",style:Object.assign(Object.assign({},transformStyle(e.editorStyle)),(()=>{var t;const r=null===(t=e.inputRef.current)||void 0===t?void 0:t.getBoundingClientRect();if(!r)return{};const{left:n,top:o,height:i,width:a}=r,s=e.multiple&&e.showSelectAll||!e.multiple&&!e.isRequired;let l=(e.items.length+(s?1:0))*(ITEM_VIEW_HEIGHT$1+ITEM_SEPARATOR_HEIGHT$1);l=Math.min(Math.max(l,MIN_EDITOR_HEIGHT),MAX_EDITOR_HEIGHT);const c={height:l,width:a,left:n,top:o+i};return o+i+l>window.innerHeight&&(o<window.innerHeight-o-i?c.height=window.innerHeight-o-i:o<l?(c.height=o,c.top=0):c.top=o-l),a<MIN_EDITOR_WIDTH&&(c.width=MIN_EDITOR_WIDTH,n+MIN_EDITOR_WIDTH>window.innerWidth&&(c.left=n+a-MIN_EDITOR_WIDTH)),c})())},{children:jsxRuntimeExports.jsx(DropMenuEditor,{ref:t,isSearch:!1,onConfirm:e.onConfirm,multiple:e.multiple,onItemSelect:e.onItemSelect,onAllSelect:e.onAllSelect,selectedItems:e.selectedItems,items:e.items,isRequired:e.isRequired,showSelectAll:e.showSelectAll,isLoading:e.isLoading,simple:!0})}))}))},classPrefix$3="fdm-drop-menu",defaultProps$4={multiple:!1,simple:!1,invalid:!1,disabled:!1,invisible:!1,isRequired:!1,autoEditorShow:!1,showSelectAll:!0,text:"",isLoading:!1,getPopupContainer:()=>getRootPortalContainer("drop-menu")},DropMenu$1=e=>{const t=mergeProps(defaultProps$4,e),[r,n]=reactExports.useState(!1),[o,i]=reactExports.useState(!1),a=reactExports.useRef(null);useUpdateEffect((()=>{var e;o&&(null===(e=t.beforeEditorShow)||void 0===e||e.call(t))}),[o]),useMount((()=>{t.autoEditorShow&&i(!0)}));if(t.invisible)return jsxRuntimeExports.jsx("div",{});let{text:s}=t;const l=!s&&t.watermark;l&&(s=t.watermark||"");const c=Object.assign(Object.assign({},t),{className:classNames$1("".concat(classPrefix$3,"-popup"),t.popupClassName),editorShow:o,setEditorShow:i,selectedItems:(()=>{const e=t.value;return isNil$3(e)?[]:isArray$c(e)?e:[e]})(),onConfirm:e=>{var r;null===(r=t.onConfirm)||void 0===r||r.call(t,e||[]),i(!1)}});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",Object.assign({style:transformStyle(t.style),className:classNames$1(classPrefix$3,"fdm-widget-default",{"fdm-border-theme":r,"fdm-border-hide":t.hideBorder,"fdm-border-error":t.invalid,"fdm-color-error":t.invalid,"fdm-widget-disable":t.disabled}),ref:a,onClick:()=>i(!0),onTouchStart:()=>n(!0),onTouchEnd:()=>n(!1),onTouchCancel:()=>n(!1)},{children:[jsxRuntimeExports.jsx("span",Object.assign({className:classNames$1("fdm-text-ellipsis","text",{"fdm-watermark":l})},{children:s.toString().substring(0,400)})),jsxRuntimeExports.jsx("div",Object.assign({className:"icon-wrap"},{children:jsxRuntimeExports.jsx(Icon$1,{className:classNames$1({"icon-normal":!t.invalid,"fdm-color-error":t.invalid}),name:"fdm-drop-down"})}))]})),t.simple?jsxRuntimeExports.jsx(DropEditor,Object.assign({},c,{inputRef:a})):jsxRuntimeExports.jsx(PopupEditor,Object.assign({},c))]})},DropMenu=attachShowProperty(DropMenu$1),classPrefix$2="fdm-drop-tree",defaultProps$3={multiple:!1,invalid:!1,disabled:!1,invisible:!1,isRequired:!1,autoEditorShow:!1,text:"",getPopupContainer:getRootPortalContainer},DropTree$1=e=>{const t=mergeProps(defaultProps$3,e),[r,n]=reactExports.useState(!1),[o,i]=reactExports.useState(!1),[a,s]=reactExports.useState(!1),l=reactExports.useRef(null);if(useUpdateEffect((()=>{var e;r&&(null===(e=t.beforeEditorShow)||void 0===e||e.call(t))}),[r]),useMount((()=>{t.autoEditorShow&&n(!0)})),t.invisible)return jsxRuntimeExports.jsx("div",{});let{text:c}=t;const u=!c&&t.watermark;u&&(c=t.watermark||"");const{locale:d}=useConfig(),h=()=>{var e,r;const o=null===(e=l.current)||void 0===e?void 0:e.getCurrentSelectedNodes();o&&(null===(r=t.onConfirm)||void 0===r||r.call(t,o)),n(!1),s(!1)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",Object.assign({style:transformStyle(t.style),className:classNames$1(classPrefix$2,"fdm-widget-default",{"fdm-border-theme":o,"fdm-border-hide":t.hideBorder,"fdm-border-error":t.invalid,"fdm-color-error":t.invalid,"fdm-widget-disable":t.disabled}),onClick:()=>n(!0),onTouchStart:()=>i(!0),onTouchEnd:()=>i(!1),onTouchCancel:()=>i(!1)},{children:[jsxRuntimeExports.jsx("span",Object.assign({className:classNames$1("fdm-text-ellipsis","text",{"fdm-watermark":u}),style:t.textStyle},{children:c.toString().substring(0,400)})),jsxRuntimeExports.jsx("div",Object.assign({className:"icon-wrap"},{children:jsxRuntimeExports.jsx(Icon$1,{className:classNames$1({"icon-normal":!t.invalid,"fdm-color-error":t.invalid}),name:"fdm-drop-down"})}))]})),jsxRuntimeExports.jsx(Popup,Object.assign({destroyOnClose:!0,visible:r,className:classNames$1("".concat(classPrefix$2,"-popup"),t.popupClassName),onMaskClick:()=>n(!1),maskStyle:{background:MASK_BG},bodyStyle:{height:a?"100%":522,maxHeight:a?"none":"80%",borderTopLeftRadius:a?0:4,borderTopRightRadius:a?0:4},afterShow:t.afterEditorShow,afterClose:t.afterEditorClose,style:transformStyle(t.popupStyle),getContainer:t.getPopupContainer||document.body},{children:jsxRuntimeExports.jsxs("div",Object.assign({className:"editor-wrap",style:transformStyle(t.editorStyle)},{children:[jsxRuntimeExports.jsx(DropTreeEditor,{isSearch:a,onConfirm:h,ref:l,onSearchFocus:e=>{var r;null===(r=t.onSearchFocus)||void 0===r||r.call(t,e),s(!0),setTimeout((()=>{window.scrollTo(0,1)}),300)},onSearchCancel:()=>{var e;null===(e=t.onSearchCancel)||void 0===e||e.call(t),s(!1)},onSearchChange:t.onSearchChange,getNodes:t.getNodes,selectedNodes:t.selectedNodes,multiple:t.multiple,isRequired:t.isRequired,isSelectLeafOnly:t.isSelectLeafOnly,isLinkRootWhenLeafOnly:t.isLinkRootWhenLeafOnly,loadChildNodes:t.loadChildNodes,onNodeSelect:e=>{var r;null===(r=t.onNodeSelect)||void 0===r||r.call(t,e),!t.multiple&&s(!1)},isLoading:t.isLoading}),t.multiple&&jsxRuntimeExports.jsx("div",Object.assign({className:"confirm"},{children:jsxRuntimeExports.jsx(Button$2,Object.assign({block:!0,onClick:h},{children:d.fine.CONFIRM}))}))]}))}))]})},DropTree=attachShowProperty(DropTree$1),CSS_CLASS_PREFIX$1="fdm-range-date-quick-range";function QuickRangeButtonGroup(e){var t,r;const{disabled:n,ranges:o,activeValue:i,onClick:a}=e,s=null===(r=null===(t=useConfig())||void 0===t?void 0:t.locale)||void 0===r?void 0:r.fine,l=o.map((e=>({value:e,label:s[QUICK_RANGE[e]]})));return withNativeProps(e,jsxRuntimeExports.jsx("section",Object.assign({className:CSS_CLASS_PREFIX$1},{children:l.map((t=>jsxRuntimeExports.jsx(Button$3,Object.assign({style:e.style,disabled:n,className:classNames$1("".concat(CSS_CLASS_PREFIX$1,"-btn"),{["".concat(CSS_CLASS_PREFIX$1,"-btn-active")]:i===t.value}),onClick:()=>a(t.value),fill:"solid"},{children:t.label}),t.value)))})))}var ENDPOINT,ENDPOINT2,QUICK_RANGE,QUICK_RANGE2,RANGE_DATE_ERROR,RANGE_DATE_ERROR2;ENDPOINT2=ENDPOINT||(ENDPOINT={}),ENDPOINT2[ENDPOINT2.MIN=0]="MIN",ENDPOINT2[ENDPOINT2.MAX=1]="MAX",QUICK_RANGE2=QUICK_RANGE||(QUICK_RANGE={}),QUICK_RANGE2[QUICK_RANGE2.YESTERDAY=0]="YESTERDAY",QUICK_RANGE2[QUICK_RANGE2.THIS_DAY=1]="THIS_DAY",QUICK_RANGE2[QUICK_RANGE2.TOMORROW=2]="TOMORROW",QUICK_RANGE2[QUICK_RANGE2.LAST_7_DAYS=3]="LAST_7_DAYS",QUICK_RANGE2[QUICK_RANGE2.LAST_15_DAYS=4]="LAST_15_DAYS",QUICK_RANGE2[QUICK_RANGE2.LAST_MONTH=5]="LAST_MONTH",QUICK_RANGE2[QUICK_RANGE2.LAST_YEAR=6]="LAST_YEAR",QUICK_RANGE2[QUICK_RANGE2.SINCE_START_OF_MONTH=7]="SINCE_START_OF_MONTH",QUICK_RANGE2[QUICK_RANGE2.SINCE_START_OF_QUARTER=8]="SINCE_START_OF_QUARTER",QUICK_RANGE2[QUICK_RANGE2.SINCE_START_OF_YEAR=9]="SINCE_START_OF_YEAR",RANGE_DATE_ERROR2=RANGE_DATE_ERROR||(RANGE_DATE_ERROR={}),RANGE_DATE_ERROR2[RANGE_DATE_ERROR2.MIN_GREATER_THAN_MAX=0]="MIN_GREATER_THAN_MAX",RANGE_DATE_ERROR2[RANGE_DATE_ERROR2.MIN_IS_EMPTY=1]="MIN_IS_EMPTY",RANGE_DATE_ERROR2[RANGE_DATE_ERROR2.MAX_IS_EMPTY=2]="MAX_IS_EMPTY",RANGE_DATE_ERROR2[RANGE_DATE_ERROR2.BOTH_ARE_EMPTY=3]="BOTH_ARE_EMPTY";const getErrorMessage=e=>{const{locale:t}=useConfig();switch(e){case RANGE_DATE_ERROR.BOTH_ARE_EMPTY:case RANGE_DATE_ERROR.MAX_IS_EMPTY:case RANGE_DATE_ERROR.MIN_IS_EMPTY:return t.fine.REQUIRED;case RANGE_DATE_ERROR.MIN_GREATER_THAN_MAX:return t.fine.ERROR_MIN_GT_MAX}},getSmallestUnitFromFormat=e=>{switch(e){case FORMATS_MAP.YEAR:return"year";case FORMATS_MAP.YEAR_MONTH:case FORMATS_MAP.MONTH:return"month";case FORMATS_MAP.YEAR_QUARTER:case FORMATS_MAP.QUARTER:return"quarter";case FORMATS_MAP.YEAR_MONTH_DATE:return"day";case FORMATS_MAP.TIME:case FORMATS_MAP.DATETIME:default:return"second"}},findError=(e,t)=>{const[r,n]=e;return null===r&&null===n&&t.isRequiredMin&&t.isRequiredMax?RANGE_DATE_ERROR.BOTH_ARE_EMPTY:r&&n&&dateGt(r,n,getSmallestUnitFromFormat(t.format))?RANGE_DATE_ERROR.MIN_GREATER_THAN_MAX:null};function showErrorIfAny(e){null!==e&&Toast.showWarning({position:"top",content:jsxRuntimeExports.jsx("div",Object.assign({style:{paddingTop:"20px"}},{children:getErrorMessage(e)}))})}function getWhichInputShouldUseInvalidStyle(e){if(null===e)return{min:!1,max:!1};switch(e){case RANGE_DATE_ERROR.MIN_GREATER_THAN_MAX:return{min:!0,max:!0};case RANGE_DATE_ERROR.MIN_IS_EMPTY:return{min:!0,max:!1};case RANGE_DATE_ERROR.MAX_IS_EMPTY:return{min:!1,max:!0};case RANGE_DATE_ERROR.BOTH_ARE_EMPTY:return{min:!0,max:!0}}}const getEndpointsFromQuickRange=e=>{const t=hooks().startOf("day"),r=hooks().subtract(1,"day").endOf("day"),n={[QUICK_RANGE.TOMORROW]:()=>[addDays(t,1),addDays(r,2)],[QUICK_RANGE.YESTERDAY]:()=>[subtractDays(t,1),r],[QUICK_RANGE.THIS_DAY]:()=>[t,endOfDay(t)],[QUICK_RANGE.LAST_7_DAYS]:()=>[subtractDays(t,7),r],[QUICK_RANGE.LAST_15_DAYS]:()=>[subtractDays(t,15),r],[QUICK_RANGE.LAST_MONTH]:()=>[subtractMonths(t,1),r],[QUICK_RANGE.LAST_YEAR]:()=>[subtractYears(t,1),r],[QUICK_RANGE.SINCE_START_OF_MONTH]:()=>[startOfMonth(t),addDays(r,1)],[QUICK_RANGE.SINCE_START_OF_QUARTER]:()=>[startOfQuarter(t),addDays(r,1)],[QUICK_RANGE.SINCE_START_OF_YEAR]:()=>[startOfYear(t),addDays(r,1)]}[e];if(!n)throw new Error("ValueError: Unknown quick range ".concat(e));return n()},defaultProps$2={showErrorToast:!0,disabled:!1,defaultValue:["",""],defaultQuickRange:null,watermarkMin:"",watermarkMax:"",isRequiredMin:!1,isRequiredMax:!1,onChange:()=>{},onError:()=>{},rangeMin:"1900-01-01",rangeMax:"2100-01-01",format:FORMATS_MAP.YEAR_MONTH_DATE,quickRangeOptions:[QUICK_RANGE.YESTERDAY,QUICK_RANGE.THIS_DAY,QUICK_RANGE.TOMORROW,QUICK_RANGE.LAST_7_DAYS,QUICK_RANGE.LAST_15_DAYS,QUICK_RANGE.LAST_MONTH,QUICK_RANGE.LAST_YEAR,QUICK_RANGE.SINCE_START_OF_MONTH,QUICK_RANGE.SINCE_START_OF_QUARTER,QUICK_RANGE.SINCE_START_OF_YEAR],showQuickRangeButtons:!0},CSS_CLASS_PREFIX="fdm-range-date",dateGt=(e,t,r="s")=>null!==e&&null!==t&&hooks(e).isAfter(t,r),dateEq=(e,t)=>null===e||null===t?null===e&&null===t:hooks(e).isSame(t,"seconds"),rangeDateEq=(e,t)=>dateEq(e[0],t[0])&&dateEq(e[1],t[1]),naivelyUpdateEndpoints=(e,t,r)=>{if(t===ENDPOINT.MIN)return[r,e[1]];if(t===ENDPOINT.MAX)return[e[0],r];throw new Error("ValueError: src must be ENDPOINT.min or ENDPOINT.max")},RangeDate=e=>{var t,r,n,o;const i=mergeProps(defaultProps$2,e),{format:a,quickRangeOptions:s,onChange:l,onError:c,value:u=i.defaultValue,disabled:d}=i,h={min:null!==u[0]?hooks(u[0]).toDate():null,max:null!==u[1]?hooks(u[1]).toDate():null},[p,f]=reactExports.useState(i.defaultQuickRange);reactExports.useEffect((()=>g(i.defaultQuickRange)),[]);const g=e=>{if(f(e),null===e)return;const t=getEndpointsFromQuickRange(e);v(t),rangeDateEq(t,[h.min,h.max])||l(t)},[m,y]=reactExports.useState(null),v=e=>{const t=findError(e,{format:i.format,isRequiredMin:i.isRequiredMin,isRequiredMax:i.isRequiredMax});y(t),i.showErrorToast&&showErrorIfAny(t),null!==t&&c(t,e)};reactExports.useEffect((()=>v(u)),[...u]);const _=(e,t)=>{const r=naivelyUpdateEndpoints([h.min,h.max],e,t);v(r),rangeDateEq(r,[h.min,h.max])||(f(null),l(r))},b=getWhichInputShouldUseInvalidStyle(m),C=i.format===FORMATS_MAP.YEAR_MONTH_DATE&&i.showQuickRangeButtons&&!isEmpty$3(s),E={min:{minDate:i.rangeMin,maxDate:null!==(t=h.max)&&void 0!==t?t:i.rangeMax},max:{minDate:null!==(r=h.min)&&void 0!==r?r:i.rangeMin,maxDate:i.rangeMax}};return withNativeProps(i,jsxRuntimeExports.jsxs("div",{children:[C&&jsxRuntimeExports.jsx(QuickRangeButtonGroup,{style:{"--font-size":null===(n=null==i?void 0:i.style)||void 0===n?void 0:n["--font-size"],"--text-color":null===(o=null==i?void 0:i.style)||void 0===o?void 0:o["--text-color"]},disabled:d,activeValue:p,onClick:g,ranges:s}),jsxRuntimeExports.jsxs("section",Object.assign({className:CSS_CLASS_PREFIX},{children:[jsxRuntimeExports.jsx(DateTime,Object.assign({isRequired:i.isRequiredMin,invalid:b.min,style:b.min&&{"--text-color":"var(--fdm-color-warning)"},watermark:i.watermarkMin,date:h.min},E.min,{format:a,disabled:d,onCancel:()=>_(ENDPOINT.MIN,null),onConfirm:(e,t)=>_(ENDPOINT.MIN,t)},i.propsBoth,i.propsMin)),jsxRuntimeExports.jsx("span",{children:"-"}),jsxRuntimeExports.jsx(DateTime,Object.assign({isRequired:i.isRequiredMax,invalid:b.max,style:b.max&&{"--text-color":"var(--fdm-color-warning)"},watermark:i.watermarkMax,date:h.max},E.max,{format:a,disabled:d,onCancel:()=>_(ENDPOINT.MAX,null),onConfirm:(e,t)=>_(ENDPOINT.MAX,t)},i.propsBoth,i.propsMax))]}))]}))},PaginationContext=React.createContext({open:()=>{}}),usePagination=()=>reactExports.useContext(PaginationContext),PORTRAIT_REMAIN_WIDTH=130,DRAWER_SCALE=.9,Pagination=({children:e})=>{const[t,r]=reactExports.useState(0),[n,o]=reactExports.useState(0),i=reactExports.useRef({onPage:()=>{}}),a=reactExports.useRef(null),s=useSpringValue(0),l=useSpringValue(1),c=useSpringValue(0),[u,d]=reactExports.useState(),h=reactExports.useMemo((()=>[...Array(t)].map(((e,t)=>t+1))),[t]),p=()=>{var e,t;return Promise.all([s.start(0),l.start(1),c.start(null!==(t=null===(e=a.current)||void 0===e?void 0:e.clientHeight)&&void 0!==t?t:0)]).finally((()=>{d(!1)}))},f=()=>{o(0),r(0),i.current.onPage=void 0};return jsxRuntimeExports.jsx(PaginationContext.Provider,Object.assign({value:{open:({page:e,total:t,onPage:n})=>{var u,h;o(e),r(t),i.current.onPage=n,d(!0),c.set(null!==(h=null===(u=a.current)||void 0===u?void 0:u.clientHeight)&&void 0!==h?h:0),s.start(PORTRAIT_REMAIN_WIDTH),l.start(DRAWER_SCALE),c.start(0)}}},{children:jsxRuntimeExports.jsxs("div",Object.assign({className:classNames$1("fdm-pagination",{active:u}),ref:a},{children:[jsxRuntimeExports.jsx(animated$1.div,Object.assign({className:"fdm-pagination-side",style:{translateY:c}},{children:jsxRuntimeExports.jsx("div",Object.assign({className:"page-wrapper"},{children:h.map((e=>jsxRuntimeExports.jsx("div",Object.assign({className:classNames$1("page-item",{selected:e===n}),onClick:()=>__awaiter(void 0,void 0,void 0,(function*(){var t,r;o(e),yield p(),null===(r=(t=i.current).onPage)||void 0===r||r.call(t,e),f()}))},{children:e}),e)))}))})),jsxRuntimeExports.jsxs(animated$1.div,Object.assign({className:"fdm-pagination-content",style:{translateX:s,scale:l}},{children:[e,n>0&&jsxRuntimeExports.jsx("div",{className:"fdm-pagination-modal",onClick:e=>__awaiter(void 0,void 0,void 0,(function*(){e.stopPropagation(),yield p(),f()}))})]}))]}))}))},Pagination$1=attachPropertiesToComponent(Pagination,{usePagination:usePagination}),defaultProps$1={src:"",method:"GET",parameters:{},onMessage:()=>{}},Iframe$1=reactExports.forwardRef(((e,t)=>{const r=Object.assign(Object.assign({},defaultProps$1),e),{src:n,method:o,name:i,parameters:a,onMessage:s}=r,l=__rest$p(r,["src","method","name","parameters","onMessage"]),c=reactExports.useRef(null);reactExports.useEffect((()=>{var e;"POST"===o&&(null===(e=c.current)||void 0===e||e.submit())}),[n,o,i,a]),reactExports.useEffect((()=>(window.addEventListener("message",s),()=>{window.removeEventListener("message",s)})),[s]);const[u,d]=n.split("?"),h=Object.assign(Object.assign({},(e=>{if(!e)return{};const t=new URLSearchParams(e),r={};return t.forEach(((e,t)=>{r[t]=e})),r})(d)),a),p=new URLSearchParams(h).toString();return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["POST"===o&&jsxRuntimeExports.jsx("form",Object.assign({ref:c,target:i,method:o,action:n},{children:map$3(a,((e,t)=>jsxRuntimeExports.jsx("input",{type:"hidden",name:encodeURIComponent(t),value:encodeURIComponent(e)},t)))})),jsxRuntimeExports.jsx("iframe",Object.assign({ref:t,src:"GET"===o?"".concat(u).concat(p?"?".concat(p):""):void 0,"data-src":n,name:i},l))]})}));class Wrapper extends React.Component{constructor(){super(...arguments),this.element=null}componentDidMount(){this._setElement()}componentDidUpdate(){this._setElement()}render(){return React.Children.only(this.props.children)}_setElement(){const e=reactDomExports.findDOMNode(this);e instanceof Element?this.element=e:this.element=null}}const record={topLeft:"top-start",topRight:"top-end",bottomLeft:"bottom-start",bottomRight:"bottom-end",leftTop:"left-start",leftBottom:"left-end",rightTop:"right-start",rightBottom:"right-end"};function normalizePlacement(e){var t;return null!==(t=record[e])&&void 0!==t?t:e}const classPrefix$1="fdm-popover",defaultProps={placement:"top",defaultVisible:!1,stopPropagation:["click"],getContainer:()=>getRootPortalContainer("popover")},Popover$1=reactExports.forwardRef(((e,t)=>{const r=mergeProps(defaultProps,e),n=normalizePlacement(r.placement),[o,i]=usePropsValue({value:r.visible,defaultValue:r.defaultVisible,onChange:r.onVisibleChange});reactExports.useImperativeHandle(t,(()=>({show:()=>i(!0),hide:()=>i(!1),visible:o})),[o]);const a=reactExports.useRef(null),s=reactExports.useRef(null),l=reactExports.useRef(null),c=reactExports.useRef(null),u=reactExports.useRef(null),d=withStopPropagation(r.stopPropagation,withNativeProps(r,jsxRuntimeExports.jsxs("div",Object.assign({className:classNames$1(classPrefix$1,!o&&"".concat(classPrefix$1,"-hidden")),ref:s},{children:[jsxRuntimeExports.jsxs("div",Object.assign({className:"".concat(classPrefix$1,"-arrow-container"),ref:l},{children:[jsxRuntimeExports.jsx("div",{className:"".concat(classPrefix$1,"-arrow-border"),ref:u}),jsxRuntimeExports.jsx("div",{className:"".concat(classPrefix$1,"-arrow-inner"),ref:c})]})),jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$1,"-inner")},{children:jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix$1,"-inner-content")},{children:r.content}))}))]})))),[h,p]=reactExports.useState(null);function f(){var e,t,r,o;return __awaiter(this,void 0,void 0,(function*(){const i=null!==(t=null===(e=a.current)||void 0===e?void 0:e.element)&&void 0!==t?t:null,d=s.current,h=l.current,f=c.current,g=u.current;if(p(i),!(i&&d&&h&&f&&g))return;const{x:m,y:y,placement:v,middlewareData:_}=yield computePosition(i,d,{placement:n,middleware:[offset$1(convertPx(12)),shift({padding:convertPx(4),crossAxis:!1,limiter:limitShift()}),flip(),hide(),arrow({element:h,padding:convertPx(12)})]});Object.assign(d.style,{left:"".concat(m,"px"),top:"".concat(y,"px")});const b=v.split("-")[0],C={top:"bottom",right:"left",bottom:"top",left:"right"}[b],{x:E,y:T}=null!==(r=_.arrow)&&void 0!==r?r:{},S={left:null!=E?"".concat(E,"px"):"",top:null!=T?"".concat(T,"px"):"",right:"",bottom:"",[C]:"calc(var(--arrow-size) * -1)"};Object.assign(h.style,S);const P={"border-left-width":null,"border-right-width":null,"border-top-width":null,"border-bottom-width":null,"border-left-color":null,"border-right-color":null,"border-top-color":null,"border-bottom-color":null};Object.assign(f.style,Object.assign(Object.assign({},P),{["border-".concat(C,"-width")]:"0",["border-".concat(b,"-color")]:"var(--triangle-color, var(--background-color))"})),Object.assign(null===(o=u.current)||void 0===o?void 0:o.style,Object.assign(Object.assign({},P),{["border-".concat(C,"-width")]:"0",["border-".concat(b,"-color")]:"var(--border-color)",["".concat(b)]:"calc(var(--border-width))"}))}))}useIsomorphicLayoutEffect$2((()=>{f()})),reactExports.useEffect((()=>{if(h&&r.trigger)return h.addEventListener("click",e),()=>{h.removeEventListener("click",e)};function e(){i((e=>!e))}}),[h,r.trigger]),reactExports.useEffect((()=>{const e=s.current;if(h&&e)return autoUpdate(h,e,f,{elementResize:"undefined"!=typeof ResizeObserver})}),[h]),useClickAway((()=>{r.trigger&&i(!1)}),[()=>{var e;return null===(e=a.current)||void 0===e?void 0:e.element},s],["click","touchmove"]);const g=useShouldRender(o,!1,r.destroyOnHide);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Wrapper,Object.assign({ref:a},{children:r.children})),g&&renderToContainer(r.getContainer,d)]})})),classPrefix="fdm-popover-menu",itemHeight=50,PopoverMenu=reactExports.forwardRef(((e,t)=>{const r=reactExports.useRef(null);reactExports.useImperativeHandle(t,(()=>r.current),[]);const n=reactExports.useCallback((t=>{var n;const{onAction:o}=e;o&&o(t),null===(n=r.current)||void 0===n||n.hide()}),[e.onAction]),o=reactExports.useMemo((()=>{let t;return e.showCount&&(t=Math.min(e.showCount,e.actions.length)*itemHeight),jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix,"-list"),style:{height:t}},{children:jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix,"-list-inner")},{children:e.actions.map(((e,t)=>{var r;return jsxRuntimeExports.jsxs("a",Object.assign({className:classNames$1("".concat(classPrefix,"-item"),"adm-plain-anchor",e.disabled&&"".concat(classPrefix,"-item-disabled")),onClick:()=>{var t;e.disabled||(n(e),null===(t=e.onClick)||void 0===t||t.call(e))},style:{color:e.color}},{children:[e.icon&&jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix,"-item-icon")},{children:e.icon})),jsxRuntimeExports.jsx("div",Object.assign({className:"".concat(classPrefix,"-item-text")},{children:e.text}))]}),null!==(r=e.key)&&void 0!==r?r:t)}))}))}))}),[e.actions,n]);return jsxRuntimeExports.jsx(Popover$1,Object.assign({ref:r},e,{className:classNames$1(classPrefix,e.className),content:o},{children:e.children}))})),Popover=attachPropertiesToComponent(Popover$1,{Menu:PopoverMenu}),closeFnSet=new Set;function show(e){const t=renderImperatively(jsxRuntimeExports.jsx(CenterPopup$1,Object.assign({},e,{afterClose:()=>{var r;closeFnSet.delete(t.close),null===(r=e.afterClose)||void 0===r||r.call(e)}},{children:e.content})));return closeFnSet.add(t.close),t}const CenterPopup=attachPropertiesToComponent(CenterPopup$1,{show:show});window.FDM={version:"1.0.0-release.20250827174026"};const Icon=({size:e=24,name:t,disabled:r,visible:n=!0,className:o,onClick:i,...a})=>jsx(Fragment,{children:n&&jsx("div",{className:classNames$1("duchamp-mobile-icon",o,{disabled:r}),onClick:()=>{!r&&(null==i||i())},...a,children:jsx(Icon$1,{name:t,size:e,color:"currentColor"})})}),PaginationTool=({value:e,total:t,preDisabled:r,nextDisabled:n,onPre:o,onNext:i,onPage:a,preIcon:s="fdm-previous-page",nextIcon:l="fdm-next-page",size:c,className:u,preClassName:d,nextClassName:h,pageClassName:p})=>jsxs("div",{className:classNames$1("pagination-buttons",u),children:[jsx(Icon,{className:classNames$1("toolbar-button",d),name:s,disabled:r,onClick:o,size:c}),jsx("div",{className:classNames$1("toolbar-button","duchamp-mobile-icon",p),onClick:a,children:"".concat(e,"/").concat(t)}),jsx(Icon,{className:classNames$1("toolbar-button",h),name:l,disabled:n,onClick:i,size:c})]}),MOBILE_UNIQUE_PARAMS={HYPERLINK_DEPTH:"__hyperlink_depth__",FINE_ORIENTATION:"fine_orientation",DD_ORIENTATION:"dd_orientation",FINE_WEBVIEW:"fine_webView",FINE_DIGITAL_SIGNATURE:"fine_digital_signature",DISPLAY_PHONE:"display_phone",PI:"__pi__",OP:"op",VIEWLET:"viewlet",FINE_TOOLBAR:"fine_toolbar",FORCE_WEB:"force_web",BY_PAGE_SIZE:"__bypagesize__",FINE_TOOLBAR_TYPE:"fine_tool_button_type",DEVICE_TYPE:"deviceType",FINE_POPUP_METHOD:"_method",JS_API_PATH:"js_api_path",APP_ID:"sb",FINE_AUTO_HEIGHT:"fine_auto_height"};function isNotEmptyObject(e){return!isEmpty$3(e)&&isObject$e(e)}function isSameViewlet$1(e,t){const r=getSearchParamFromUrl(e,"viewlet"),n=getSearchParamFromUrl(t,"viewlet");return!!r&&!!n&&r===n}function appendQueryParams(e,t,r=!0){if(!t)return e;const n=convertParamsArrayToObject(t);if(!isNotEmptyObject(n))return e;const[o,i]=e.split("?")||[],a=new URLSearchParams(i||"");for(const[s,l]of Object.entries(n))a.set(r?encodeURIComponent(s):s,r?encodeURIComponent("object"==typeof l?JSON.stringify(l):String(l)):String(l));return"".concat(o,"?").concat(a.toString())}function filterParamsWithUniqueKeys$1(e,t=MOBILE_UNIQUE_PARAMS){const r=Array.isArray(e)?mapValues$1(keyBy$1(e,"name"),"value"):e,n=Object.values(t),o=pickBy$3(r,((e,t)=>n.some((e=>e===t)))),i=omitBy$1(r,((e,t)=>t in o));return[o,i]}function removeKeysFromObject(e,t){if(!isPlainObject$1(e))return e;const r={},n=t.map((e=>e.toLowerCase()));for(const[o,i]of Object.entries(e))n.includes(o.toLowerCase())||(r[o]=removeKeysFromObject(i,t));return r}function processLinkParams(e,t){let r={};const{format:n=[],remove:o=[],add:i={}}=t;return Object.entries(e).forEach((([e,t])=>{o.includes(e)||(n.length?n.forEach((({condition:n,handler:o})=>{r[e]=n(t)?o(t):t})):r[e]=t)})),o.length>0&&(r=removeKeysFromObject(r,o)),Object.assign(r,i)}const processParams=e=>processLinkParams(e||{},{format:[{condition:e=>e instanceof Date,handler:e=>dayjs(e).format("YYYY-MM-DD HH:mm:ss")}]});function convertParamsArrayToObject(e){return Array.isArray(e)?mapValues$1(keyBy$1(e,"name"),"value"):e}function convertParamsMapToObject(e){if(!e)return{};const t={};return e.forEach(((e,r)=>{t[r]=String(e)})),t}function openUrlByPost$1({url:e,target:t,parameters:r}){const n=document.createElement("div");n.style.display="none",n.style.position="absolute";const o=document.createElement("form");if(o.method="post",o.target=t,o.action=e,r){const e=convertParamsArrayToObject(r);isNotEmptyObject(e)&&Object.entries(e).forEach((([e,t])=>{const r=document.createElement("input");r.type="hidden",r.name=e,r.value=encodeURIComponent("object"==typeof t?JSON.stringify(t):String(t)),o.appendChild(r)}))}n.appendChild(o),document.body.appendChild(n),window.setTimeout((()=>{o.submit(),o.remove()}),20)}function openUrlByGet$1({url:e,target:t,parameters:r}){const n=appendQueryParams(e,r),o=document.createElement("a");o.href=n,o.target=TARGET_TYPE_MAP[t],o.click()}function isBlankTarget(e){return e===TARGET_TYPE.BLANK||e===TARGET_TYPE.BLANK_FS}const handleDecisionOpenByTab=({url:e,target:t,title:r="",byPost:n,parameters:o,tabPane:i})=>{const a=n?e:appendQueryParams(e,o),s=isBlankTarget(t),l=s?uuid$1():i.getShowingTab();s?i.addItem({id:l,cardType:{src:a},text:r}):window.open(a,t),n&&openUrlByPost$1({url:e,target:l,parameters:o})},DYNAMIC_VALUE_FORMULA_FIELD_CONFIG_KEY="value";function getDynamicValueResult(e,t,r=!1){if(t&&isDynamicDatasetSource(t.source)){const n=!isNil$3(t.source.summary)&&!r;if(isArray$c(e)){if(n)return["".concat(e[0])];if(isArray$c(e[0]))return e[0].map((e=>"".concat(e)))}return[]}return["".concat(e)]}function getThemeStyle$1(e){return{color:((e.styleConfig.widget["d-text"]||{}).content||{}).color||getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.TEXT)}}const DialogPreview=({iframeCustomConfig:e,contentSource:t,byPost:r,params:n,id:o=uuid$1(),title:i,isMobile:a,store:s,...l})=>{const c=useFrameParentDuchamp(s.duchampServer.duchampApi,[t,n]),u=e?"":i,d={...null!=e?e:{},innerContentStyle:{gap:a?"12px":"16px"}};let h;if(reactExports.useEffect((()=>{r&&isString$3(t)&&openUrlByPost$1({url:t,target:o,parameters:n})}),[r,t,o,n]),isString$3(t)){const a=jsx("iframe",{ref:c,title:o,src:r?void 0:appendQueryParams(t,n),name:o,width:"100%",height:"100%",style:{border:"none",verticalAlign:"top"}});h=e?jsx(PopoverContent$1,{title:i,styleConfig:d,content:a}):a}else h=jsx(PopoverContent$1,{title:i,styleConfig:d,content:jsx(DialogRichText,{value:t,style:getThemeStyle$1(s)})});return jsx(PreviewDialogWrapper,{...l,title:u,borderRadius:null==e?void 0:e.borderRadius,children:h})};function useControlFrMask(e){reactExports.useEffect((()=>{if(e)return fvsService.openMask(),window.addEventListener("pagehide",fvsService.closeMask),()=>{fvsService.closeMask(),window.removeEventListener("pagehide",fvsService.closeMask)}}),[e])}function FVSDialog(e){const{props4Cancel:t,props4Ok:r,testIdPrefix:n,...o}=e;return useControlFrMask(e.visible),jsx(Dialog$1,{props4Ok:{...n&&{},...r},props4Cancel:{...n&&{},...t},...o})}const modalDestroyMap=new Map;function cacheModalDestroy(e){const t=v4$1();return modalDestroyMap.set(t,e),t}const createCacheModal=e=>{const t=document.createElement("div"),r=createRoot$1(t);document.body.appendChild(t),r.render(e);return cacheModalDestroy((()=>{r.unmount(),t.parentNode&&t.parentNode.removeChild(t)}))};function openPreviewDialog(e){const t=createCacheModal(reactExports.cloneElement(e,{...e.props,closable:!0,onClose:()=>{var r,n;null==(n=(r=e.props).onClose)||n.call(r),closeFVSDialogById(t)}}));return t}function DialogWithState(e){const{view:t,onFinish:r,onOk:n,defaultValue:o,className:i,...a}=e,[s,l]=reactExports.useState(o),c=reactExports.useCallback((e=>{l(e)}),[]),u=getLanguage();return jsx(ConfigProvider,{locale:locale$1(u),children:jsx(DuchampProvider,{locale:u,children:jsx(FVSDialog,{className:classNames$1("fvs-dialog",i),onOk:e=>{null==n||n(e),null==r||r(s)},...a,children:jsx(t,{value:s,onChange:c})})})})}function openFVSDialogWithState({onCancel:e,onOk:t,...r}){const n=createCacheModal(jsx(DialogWithState,{visible:!0,onCancel:(t,r)=>{null==e||e(t,r),closeFVSDialogById(n)},onOk:e=>{null==t||t(e),closeFVSDialogById(n)},...r}));return n}function closeFVSDialogById(e){var t;null==(t=modalDestroyMap.get(e))||t(),modalDestroyMap.delete(e)}function closeFVSDialog(){modalDestroyMap.forEach((e=>{e()})),modalDestroyMap.clear()}function createDialog(e,t){const r=document.createElement("div"),n=createRoot$1(r);function o(){var e;n.unmount(),null==(e=r.parentNode)||e.removeChild(r)}function i(t){n.render(jsx(Dialog$1,{className:"duchamp-dialog",contentPadding:!1,...e,visible:!0,onCancel:(t,r)=>{var n;null==(n=e.onCancel)||n.call(e,t,r),o()},children:t}))}return document.body.appendChild(r),setTimeout((()=>{i(t)})),{close:o,update:function(e){i(e)}}}function createConfirmDialog({content:e,icon:t,footer:r,type:n="confirm",...o}){return createDialog({...o,title:"",footer:""},jsxs("div",{className:"confirm-body-wrapper",children:[jsxs("div",{className:classNames$1("confirm-body",n),children:[t,jsxs("div",{className:"body-right",children:[o.title?jsx("span",{className:"title",children:o.title}):null,jsx("div",{className:"content",children:e})]})]}),r?jsx("div",{className:"confirm-footer",children:r}):null]}))}function createIframeDialog(e){return openPreviewDialog(jsx(DialogPreview,{...e}))}const handleHyperlinkClick=({url:e,target:t=TARGET_TYPE.BLANK,title:r="",parameters:n={},byPost:o=!1})=>{if(!e)return;if(isDecision()){const i=getTabPaneService();return i&&handleDecisionOpenByTab({url:e,target:t,title:r,parameters:n,byPost:o,tabPane:i})}(o?openUrlByPost$1:openUrlByGet$1)({url:e,target:t,parameters:n})};function handleHyperlink$1({parameters:e,url:t,title:r,target:n,byPost:o,modalProps:i,extendParameters:a,duchampServer:s}){const l=convertParamsArrayToObject(e);a?s.getTemplateParameters(l).then((e=>{openHyperlinkPage({parameters:{__parameters__:processParams(e)},url:t,title:r,target:n,byPost:o,modalProps:i,store:s.store})})):openHyperlinkPage({parameters:processParams(l),url:t,title:r,target:n,byPost:o,modalProps:i,store:s.store})}function openHyperlinkPage({parameters:e,url:t,title:r,target:n,byPost:o,modalProps:i,store:a}){const s=e;n!==TARGET_TYPE.DIALOG?handleHyperlinkClick({parameters:s,url:t,title:r,target:TARGET_TYPE_MAP[n],byPost:o}):createIframeDialog({contentSource:t,title:r,params:s,byPost:o,store:a,...i})}function getUrlAndParamsFromPath(e){const t=[".cpt",".frm",".fvs"].map((t=>e.indexOf(t))).find((e=>e>0));return!t||t<0?[e,""]:[e.substring(0,t+4),e.substring(t+4)]}async function executePathInput2Url(e){const[t,r]=getUrlAndParamsFromPath(e),n=await fvsService.executeIframeTplURL(t),o=new URLSearchParams(r).toString();return"".concat(n).concat(r?"&".concat(o):"")}const PopoverBody=observer((({config:e,body:t,top:r,left:n,contentSource:o,resourceCenter:i,isMobile:a,baseUrl:s,store:l,parameters:c})=>{const u=useFrameParentDuchamp(l.duchampServer.duchampApi,[o]),{id:d,name:h}=e,{width:p,height:f,requestType:g}=t,m=getIframeCustomConfig(t,i,s);reactExports.useEffect((()=>{"POST"===g&&isString$3(o)&&openUrlByPost$1({url:o,target:d,parameters:convertParamsMapToObject(c)})}),[g,o,c,d]);const y=isString$3(o)?jsx("iframe",{title:d,onLoad:()=>{const e=getTargetElement$2(u);e&&(e.style.visibility="visible")},ref:u,src:"POST"===g?void 0:appendQueryParams(o,convertParamsMapToObject(c)),name:d,height:"100%",width:"100%",style:{border:"none",visibility:"hidden"}}):jsx(DialogRichText,{value:o,style:getThemeStyle$1(l)});return jsx(PopoverWrapper,{title:h,top:r,left:n,width:p,height:f,styleConfig:{...m,innerContentStyle:{gap:a?"12px":"16px"}},content:y})})),BubblePreview=({config:e,body:t,options:r,store:n,parameters:o})=>{const{width:i,height:a,contentSource:s,triangleArrow:l}=t,c=getPopoverContentBorderRadiusStyle(t.borderRadius),u=_isNumber(a)&&a>window.innerHeight?clamp$5(a,0,window.innerHeight):a;return jsx(Popover$3,{visible:!0,arrow:{pointAtCenter:!0},hasPadding:!1,placement:"top",autoAdjustOverflow:!0,trigger:"click",style:{borderRadius:c,background:"none",boxShadow:"none"},overlayInnerStyle:{width:i,height:u,background:"none"},color:null==l?void 0:l.value.color,content:jsx(PopoverBody,{config:e,body:t,contentSource:s,resourceCenter:n.resourceCenter,isMobile:n.platform.isMobile,baseUrl:n.duchampServer.resourceBaseUrl,store:n,parameters:o}),...r,overlayClassName:classNames$1("duchamp-popover",null==r?void 0:r.overlayClassName),children:jsx("div",{style:{pointerEvents:"none"}})})},renderComponent$1=({x:e,y:t,width:r,height:n,component:o,onDestroy:i,store:a,triggerEl:s})=>{const l=document.createElement("div"),c=createRoot$1(l);l.style.width=_isNumber(r)?"".concat(r,"px"):"0px",l.style.height=_isNumber(n)?"".concat(n,"px"):"0px",l.style.position="fixed",l.style.left=_isNumber(e)?"".concat(e,"px"):"inherit",l.style.top=_isNumber(t)?"".concat(t,"px"):"inherit";const u=a.duchampServer.isSingleton?document.body:a.target;function d(){c.unmount(),l.parentNode&&(l.parentNode.removeChild(l),null==i||i(),u.removeEventListener("pointerdown",h,!0),u.removeEventListener("scroll",h,!0),a.eventEmitter.off(DUCHAMP_EVENTS.STORY_CHANGE,h),window.removeEventListener("resize",d,!0))}function h(e){(function(e){return!(!e.target||("scroll"===e.type?!s||!e.target.contains(s):l.contains(e.target)))})(e)&&d()}u.appendChild(l),a.eventEmitter.on(DUCHAMP_EVENTS.STORY_CHANGE,h),u.addEventListener("pointerdown",h,!0),u.addEventListener("scroll",h,!0),window.addEventListener("resize",d,!0);const p=reactExports.cloneElement(o,{getContainer:()=>l,getPopupContainer:()=>l});return setTimeout((()=>{c.render(p)})),cacheModalDestroy(d)},createBubbleAction=({config:e,store:t,body:r,options:n,widget:o,parameters:i})=>{const{mouseEvent:a=t.mouseEvent}=n||{};if(!a)return;const{clientX:s,clientY:l}=a;renderComponent$1({store:t,x:s,y:l,component:jsx(BubblePreview,{config:e,body:r,baseUrl:t.duchampServer.resourceBaseUrl,store:t,parameters:i}),triggerEl:o.target})};class DialogRegistry{constructor(e){__publicField(this,"handlers",new Map),e.forEach((e=>{this.register(e.name,e.execute)}))}register(e,t){this.handlers.set(e,t)}getHandler(e){return this.handlers.get(e)}execute(e){const t=this.handlers.get(e.body.dialogType);t&&t(e)}}const getDialogPreviewProps=({store:e,config:{name:t,id:r},body:n,parameters:o})=>{const{contentSource:i,width:a,height:s,requestType:l}=n;return{id:r,width:a,height:s,title:t,contentSource:i,className:"duchamp-centered-dialog",iframeCustomConfig:getIframeCustomConfig(n,e.resourceCenter,e.duchampServer.resourceBaseUrl),styles:{wrapper:{background:"none",boxShadow:"none"}},store:e,..."POST"===l&&{byPost:!0,params:convertParamsMapToObject(o)}}};function createMiddleDialogAction(e){createIframeDialog(getDialogPreviewProps(e))}const popoverDestroyMap=new Map;function cachePopoverDestroy(e){const t=uuid$2();return popoverDestroyMap.set(t,e),t}function closePopoverById(e){var t;null==(t=popoverDestroyMap.get(e))||t(),popoverDestroyMap.delete(e)}function closePopover(){popoverDestroyMap.forEach((e=>{e()})),popoverDestroyMap.clear()}const PopoverPreview=reactExports.forwardRef((({width:e,height:t,container:r,coordinate:n,...o},i)=>{const[a,s]=useUpdateValue$1({width:e,height:t,container:r,coordinate:n},[]);return reactExports.useImperativeHandle(i,(()=>({updatePosition:e=>s((t=>({...t,...e})))}))),jsx(PopoverPreview$1,{...a,...o,pointStyle:{id:"duchamp-popover-point",src:createAbsoluteUrl("/assets/system/popover_action_point.svg")}})}));PopoverPreview.displayName="PopoverPreview";const createPopover$1=e=>{const{store:t,onHidden:r,onShow:n,children:o,ref:i,...a}=e;n();const s=document.createElement("div"),l=createRoot$1(s);function c(){u()}function u(){l.unmount(),s.parentNode&&(s.parentNode.removeChild(s),r(),document.removeEventListener("pointerdown",c,!0),t.eventEmitter.off(DUCHAMP_EVENTS.STORY_CHANGE,c))}return s.style.width="0",s.style.height="0",document.body.appendChild(s),t.eventEmitter.on(DUCHAMP_EVENTS.STORY_CHANGE,c),document.addEventListener("pointerdown",c,!0),setTimeout((()=>{l.render(jsx(PopoverPreview,{...a,container:t.target.querySelector("#preview .".concat(ELEMENT_SYMBOL.ADAPTIVE_CONTENT)),options:{onVisibleChange:e=>{!1===e&&u()}},ref:i,children:o}))})),cachePopoverDestroy(u)},createPopoverAction=({store:e,config:t,body:r,options:n,widget:o,parameters:i})=>{var a;const s=(null==n?void 0:n.mouseEvent)||e.mouseEvent;if(!s)return;const l=reactExports.createRef(),{mouseEvent:c}=n||{},{offsetX:u,offsetY:d}=getEventOffset(c),{clientX:h,clientY:p}=s,{width:f,height:g,contentSource:m}=r,y=null==(a=null==n?void 0:n.onTargetMove)?void 0:a.call(n,(({x:e,y:t})=>{var r;if(null==n?void 0:n.mouseEvent){const n=e-u+h,o=t-d+p;null==(r=l.current)||r.updatePosition({width:f,height:g,coordinate:[n,o]})}}));createPopover$1({store:e,ref:l,onShow:()=>{e.setIsPlay(!1),o.getInstance().onPopover(!0)},onHidden:()=>{e.setIsPlay(!0),o.getInstance().onPopover(!1),null==y||y()},width:f,height:g,line:r.line,coordinate:[h,p],children:({left:n,top:o})=>jsx(PopoverBody,{config:t,body:r,top:o,left:n,contentSource:m,resourceCenter:e.resourceCenter,isMobile:e.platform.isMobile,baseUrl:e.duchampServer.resourceBaseUrl,store:e,parameters:i})})},executeDynamicDialogAction=e=>{createPopoverAction(e)},executeMiddleDialogAction=e=>{createMiddleDialogAction(e)},executeBubbleAction=e=>{createBubbleAction(e)},MiddleDialogAction={name:DIALOG_TYPE.CENTER,execute:executeMiddleDialogAction},DynamicDialogAction={name:DIALOG_TYPE.DYNAMIC,execute:executeDynamicDialogAction},BubbleAction={name:DIALOG_TYPE.BUBBLE,execute:executeBubbleAction},allActions$1=[MiddleDialogAction,DynamicDialogAction,BubbleAction],dialogRegistry=new DialogRegistry(allActions$1);function executeWebPage({props:e,parsedContent:t}){const{config:r,parameters:n}=e,{name:o,body:i}=r,{actionType:a,requestType:s}=i;a&&a!==TARGET_TYPE.DIALOG&&isString$3(t)?handleHyperlinkClick({url:t,target:a,title:o,..."POST"===s&&{byPost:!0,parameters:convertParamsMapToObject(n)}}):dialogRegistry.execute({...e,body:{...i,contentSource:t}})}const DYNAMIC_VALUE_EMBED_KEY="dynamic-value",FORMULA_EMBED_KEY="fr-formula";function collectDynamicValueFieldConfig({dynamicValues:e,originalKey:t,isExpanding:r=!1}){const n=configKit$1.multiDynamicValue.getComputeConfig({config:e,options:{key:t}});return r?removeSummaryConfig(n):n}function handleOffScreenEvent(e,t){var r;const{offScreenConfig:n}=e;let o=n.events.find((e=>e.id===t.eventId));isNil$3(o)||(o=toJS(o),o.parameters=concat(null==o?void 0:o.parameters,null==(r=null==t?void 0:t.eventData)?void 0:r.parameters).filter((e=>!isNil$3(e))),triggerEvent(o,e))}const triggerEvent=(e,t)=>{var r;const n=null==(r=e.parameters)?void 0:r.filter((e=>e.type===PARAMETER_TYPE.FORMULA&&e.value)).map((e=>e.value));!isNil$3(n)&&n.length>0?calculateParameters(e,t.calculateCenter).then((r=>{var n;let o=0;isArray$c(r)&&(null==(n=e.parameters)||n.filter((e=>e.type===PARAMETER_TYPE.FORMULA)).forEach((e=>{e.value=r[o++]}))),executeJs(e,t)})):executeJs(e,t)};function collectionComputesFromOffScreenEvent(e){var t;const r=new Map,n="".concat(e.id,".parameters"),o=(null!=(t=e.parameters)?t:[]).map((e=>"formula"===e.type?e.value:null)).filter(Boolean);return o.length>0&&r.set(n,{type:"formula",columns:o.map((e=>({formula:e})))}),r}function calculateParameters(e,t){const r="".concat(e.id,".parameters");return t.calculateFieldConfigs(collectionComputesFromOffScreenEvent(e)).then((e=>e.get(r)))}const executeJs=(e,t)=>{var r,n;const o=(null==(r=e.parameters)?void 0:r.map((e=>e.name)))||[],i=(null==(n=e.parameters)?void 0:n.map((e=>e.value)))||[];runJavascriptCode({code:e.code,args:o,values:i,duchampApi:t.duchampServer.duchampApi})};function collectionStoreInfo(e){const t={},r={},n={};return[...e.totalStories,e.controllerPanel].forEach((e=>{e.widgets.forEach((e=>{const o=collectionComputesFromWidget(e);o.size>0&&(o.forEach(((e,r)=>t[r]=e)),r[e.id]=Array.from(o.keys()));const i=e.getInstance().getTemplateDependencies();i.length>0&&(n[e.id]=i)}))})),e.offScreenConfig.events.forEach((e=>{collectionComputesFromOffScreenEvent(e).forEach(((e,r)=>t[r]=e))})),e.totalStories.forEach((n=>{const{backgroundLayer:o}=n,{backgroundStories:i}=e;if(isStoryBackground(o)){const{value:e}=o,n=i.find((t=>t.id===(null==e?void 0:e.id)));null==n||n.widgets.forEach((n=>{var o;const i=collectionComputesFromStoryBackgroundLayerWidget(n,e);i.size>0&&(i.forEach(((e,r)=>t[r]=e)),r[n.id]=[...i.keys(),...null!=(o=r[n.id])?o:[]])}))}})),{computes:t,consanguinity:{templateComputes:[],widgetComputesMap:r,widgetTemplatesMap:n}}}function collectionComputesFromWidget(e){const t=new Map;collectionEventsComputes(e.getEvents(),actionRegistry).forEach(((r,n)=>{t.set("".concat(e.id,"-").concat(n),r)}));return getWidgetComputeConfigs(e).forEach(((e,r)=>{const{payload:n,computeConfig:o,...i}=e;t.set(r,i)})),t}function getWidgetComputeConfigs(e){const t=new Map,r=e.getInstance(),{fieldConfigs:n,extraFieldConfigs:o}=r,i=["static"];return n.forEach(((e,n)=>{!i.includes(e.type)&&t.set("".concat(r.id,".").concat(n),e)})),o.forEach(((e,r)=>{!i.includes(e.type)&&t.set(r,e)})),t}function collectionCalculateRelatedInfo(e){const t=new Map,r=[],n=[];return e.totalStories.forEach((n=>{n.widgets.forEach((n=>{const o=getWidgetComputeConfigs(n),i=n.getInstance();o.forEach(((r,n)=>{const{payload:o,computeConfig:a,...s}=r,l=Object.fromEntries(e.calculateCenter.getParameterFromComputable(i)),c=e.calculateCenter.getDepParametersByKey(n).filter((e=>!l[e])),u=e.calculateCenter.getDepForwardComputedNames(n),d={...s,payload:getComputePayload(i.fieldPayload,o),params:l,storyIndex:i.widget.storyIndex,paramsNotFound:c,depReports:u};t.set(n,d)})),widgetIsController(n)&&r.push({id:n.id,relatedParams:i.props.relatedParams,fieldConfigs:Object.fromEntries(i.fieldConfigs)})}))})),e.controllerPanel.widgets.forEach((e=>{const t=e.getInstance();n.push({id:e.id,relatedParams:t.props.relatedParams,fieldConfigs:Object.fromEntries(t.fieldConfigs)})})),{computes:Object.fromEntries(t),storiesControllerWidgets:r,controllerPanelWidgets:n}}function collectionComputesFromStoryBackgroundLayerWidget(e,t){var r;const n=new Map,o=e.getInstance(),i=null!=(r=null==t?void 0:t.widgets[e.id])?r:null;return i&&"options"in i&&o.getFieldConfigsFromConfig(i.options).forEach(((e,t)=>{n.set(t,e)})),n}function generatorFormulaConfig(e){return{type:"formula",columns:e.map((e=>({formula:e})))}}const formatContent=(e,t)=>e?parseUrl(e,t&&t.size>0?Array.from(t.entries()).map((([e,t])=>({name:e,value:"".concat(t)}))):void 0):"",calculateUrl=async(e,t,r,n,o)=>{const{url:i,requestType:a}=t.body,{value:s,pathType:l}=i,c="".concat(e,"-").concat(t.id,".").concat(l);if("textPrompt"===l){const t=s.value.map((t=>{if(isDynamicValueOp(t)){const{source:n,id:o}=t.insert[DYNAMIC_VALUE_EMBED_KEY].fx,i=r.get(isDynamicDatasetSource(n)?"".concat(e,"-").concat(o):c);return Array.isArray(i)?i[0]:i}return t.insert}));return{ops:getResultOps(s.value,t,o),verticalAlign:s.verticalAlign}}let u;if("template"===l)u=await executePathInput2Url(s);else{const t=handleFormulaValueToDynamicValue(s);u=isStringArray(t)?t.join(""):getFormatResult(groupDynamicComputeValuesWithOriginalKey(r,t,c,e),t,o)}return"POST"===a?u:formatContent(u,n)};function getResultOps(e,t,r){return e.map(((e,n)=>isDynamicValueOp(e)?{...e,insert:calculateFormatterResult(t[n],e.insert[DYNAMIC_VALUE_EMBED_KEY].fx.formatter,r)}:e))}const getActionFieldConfig=e=>{var t;const{body:r,id:n}=e;if(!("url"in r)||!isObject$e(r.url))return null;const{pathType:o,value:i}=r.url,a="".concat(n,".").concat(o);let s=[];if("url"===o){const e=handleFormulaValueToDynamicValue(i);if(isStringArray(e)){const t=new Map;return t.set(a,generatorFormulaConfig([e.join("")])),t}s=e.filter(isDynamicValue)}else"textPrompt"===o&&(s=(null!=(t=i.value)?t:[]).reduce(((e,t)=>(isDynamicValueOp(t)&&e.push(t.insert[DYNAMIC_VALUE_EMBED_KEY].fx),e)),[]));return s.length>0?collectDynamicValueFieldConfig({dynamicValues:s,originalKey:a,isExpanding:!0}):null},collectionComputesFromWebPage=e=>{const t=collectionComputesFromActionParameters(e),r=getActionFieldConfig(e);return r&&r.forEach(((e,r)=>t.set(r,e))),t},executeWebPagePopoverAction=async e=>{const{config:t,widget:r,parameters:n,computableResult:o,expandIndex:i=0}=e;executeWebPage({props:e,parsedContent:await calculateUrl(r.id,t,o,n,i)})},replaceWebPageData=(e,t)=>{var r;let n=replaceActionData(e,t);const{body:o}=n;if("url"in o&&isObject$e(o.url)){const{pathType:e}=o.url;let i=null;if("url"===e)i={...o.url,value:o.url.value.map((e=>isDynamicValue(e)?replaceDynamicValueDataset(e,t):e))};else if("textPrompt"===e){const e=(null!=(r=o.url.value.value)?r:[]).map((e=>{var r,n;if(isFormulaOp(e)){const{fx:o}=e.insert[FORMULA_EMBED_KEY];return{...e,insert:{...e.insert,[FORMULA_EMBED_KEY]:{...e.insert[FORMULA_EMBED_KEY],fx:null!=(n=null==(r=null==t?void 0:t.formula)?void 0:r[o])?n:o}}}}return e}));i={...o.url,value:{...o.url.value,value:e}}}null!==i&&(n={...n,body:{...o,url:i}})}return n},CreateTemplateStoreContext=reactExports.createContext(null);function useCreateTemplateStore(){const e=reactExports.useContext(CreateTemplateStoreContext);if(null===e)throw new Error("Store cannot be null, please add a context provider");return e}function ErrorBlock(e){const{children:t="",className:r,ellipsis:n,useHtml:o}=e;return jsx("div",{className:classNames$1("error-view-block-content",{"error-view-block-ellipsis":n},r),children:o?jsx("div",{dangerouslySetInnerHTML:{__html:t},className:"error-view-block-content-html"}):t})}const ErrorViewDetail=e=>{const{errorCode:t,exception:r}=e;return jsx("div",{className:"error-view-content-detail-container",children:jsxs("div",{className:"error-view-content-detail",children:[jsx(ErrorBlock,{children:duchampIntl.get("Duchamp-Error_Code_With_Colon",t)}),r&&jsx(ErrorBlock,{children:duchampIntl.get("Duchamp-Error_Detail_With_Colon",r)})]})})},ErrorViewMore=({errorCode:e,exception:t})=>{const[r,n]=reactExports.useState(!0);return jsxs(Fragment,{children:[jsxs("div",{className:"error-view-content-more",onClick:()=>n(!r),children:[jsx(Icon$2,{type:r?"icon-fold":"icon-unfold",svgContent:r?SvgIconFold:SvgIconUnfold,className:"error-view-content-more-icon"}),jsx("div",{className:"error-view-content-more-text",children:r?duchampIntl.get("Duchamp-Expand_Details"):duchampIntl.get("Duchamp-Collapse_Details")})]}),!r&&jsx(ErrorViewDetail,{errorCode:e,exception:t})]})};function useErrorMessageCopy(e,t=""){const[,r]=useCopyToClipboard();return{handleCopy:()=>{const{errorCode:n,errorMsg:o,solution:i,exception:a}=e,s=i?extractTextFromHtml(i):"",l=[t,duchampIntl.get("Duchamp-Error_Info_With_Colon",o),duchampIntl.get("Duchamp-Error_Solution_With_Colon",s),duchampIntl.get("Duchamp-Error_Code_With_Colon",n),...a?[a]:[]].join("\n");r(l)}}}const extractTextFromHtml=e=>{const t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""},WINDOW_MAX_NESTING_DEPTH=10,TEMPLATE_SESSION_TIMEOUT_CODES=["12400005","12400006","12400007"],DEFAULT_ERROR_INFO={errorCode:"",errorMsg:"",solution:"",exception:""},DEFAULT_JAVASCRIPT_ERROR_INFO={...DEFAULT_ERROR_INFO,errorCode:"71310003"},WINDOW_NESTING_DEPTH_EXCEEDED_ERROR_INFO={errorCode:"72210004",errorMsg:duchampIntl.get("Duchamp-Preview_Failed_Iframe_Depth_Out_limit"),solution:duchampIntl.get("Duchamp-Try_With_Check_Iframe_Link"),exception:""},LACK_PREVIEW_STORY_ERROR_INFO={errorCode:"72210005",errorMsg:duchampIntl.get("Duchamp-Preview_Failed_Without_Preview_Story_Tip"),solution:duchampIntl.get("Duchamp-Try_With_Add_Preview_Story"),exception:""};function getErrorTitle(e){return"error"===e?duchampIntl.get("Duchamp-Error_Widget_Failure"):duchampIntl.get("Duchamp-Error_Widget")}function isIframeNestingDepthExceeded(){let e=1,t=window;for(;t!==window.top&&(e++,t=t.parent,!(e>WINDOW_MAX_NESTING_DEPTH)&&t););return e>WINDOW_MAX_NESTING_DEPTH}function getCalculatePreviewSessionTimeoutError(e){return TEMPLATE_SESSION_TIMEOUT_CODES.includes(e.errorCode)?e:null}function getLackFunctionPoint(e){return e.checkFunctionPoint("fvsBigScreenReport")?e.checkFunctionPoint("fvsStory")?"":FUNCTION_POINTS.fvsStory:FUNCTION_POINTS.fvsBigScreenReport}function getMobileLackFunctionPoint(e){return e.checkMobileFunctionPoint()?getLackFunctionPoint(e):duchampIntl.get("Duchamp-Fvs_Mobile")}function getFunctionLackErrorInfo(e,t){const r=e.platform.isMobile?getMobileLackFunctionPoint(e):getLackFunctionPoint(e);return r?{errorCode:t,errorMsg:duchampIntl.get("Duchamp-Preview_Failed_Without_Function_Point_Tip",r),solution:duchampIntl.get("Duchamp-Try_With_Function_Point_For_Preview",r),exception:""}:{errorCode:t,errorMsg:duchampIntl.get("Duchamp-Error_Unknown"),solution:duchampIntl.get("Duchamp-Error_Fine_Failure_Tip"),exception:""}}function WidgetErrorContent(e){const{widgetError:t,mode:r="error",className:n}=e,o=getErrorTitle(r),{handleCopy:i}=useErrorMessageCopy(t,o),{errorCode:a,errorMsg:s,solution:l,exception:c}=t;return jsxs("div",{className:classNames$1("error-view-container",n),children:[jsxs("div",{className:"error-view-header",children:[jsx(Icon$2,{type:"icon-close-circle-fill",svgContent:SvgIconCloseCircleFill,className:"error-view-head-left"}),jsx("div",{className:"error-view-head-title",children:o}),jsx(Icon$2,{className:"error-view-head-right",type:"icon-copy",svgContent:SvgIconCopy,title:duchampIntl.get("Duchamp-Copy_Error_Message"),onClick:i})]}),jsxs("div",{className:"error-view-body",children:[jsxs("div",{children:[jsx(ErrorBlock,{ellipsis:!0,children:duchampIntl.get("Duchamp-Error_Info_With_Colon",s)}),jsx(ErrorBlock,{className:"error-view-solution",useHtml:!0,children:duchampIntl.get("Duchamp-Error_Solution_With_Colon",l)})]}),jsx(ErrorViewMore,{errorCode:a,exception:c})]})]})}function ErrorViewIndicator(e){const{widgetError:t,errorViewMode:r}=e;return jsx(IconPopover,{trigger:"click",icon:SvgIconCloseCircleFill,placement:"top-left",className:"warning-view",overlayInnerStyle:{width:352,maxHeight:276},content:jsx(WidgetErrorContent,{widgetError:t,mode:r,className:"error-view-container-widget"})})}const ErrorViewImage=e=>{const{height:t}=e;return jsx("div",{className:"widget-error-view-image",style:{backgroundImage:"url(".concat(createAbsoluteUrl("/assets/system/preview_error.png"),")"),height:t}})},ErrorImageDisplay=({error:e,height:t})=>jsxs(Fragment,{children:[jsx(ErrorViewImage,{height:t}),jsx(ErrorViewIndicator,{widgetError:e,errorViewMode:"error"})]}),StoreContext=reactExports.createContext(null);function useStore(){const e=reactExports.useContext(StoreContext);if(null===e)throw new Error("Store cannot be null, please add a context provider");return e}function createRootStore(e="edit",t=!1){const r=new Store({});return r.setMode(e),r.setIsThemeEdit(t),withoutUndo((()=>{registerRootStore(r)})),r}async function initEditorStore({data:e,error:t,store:r,el:n}){if(t){const e=JSON.parse(t);r.setErrorInfo({...DEFAULT_ERROR_INFO,...e})}else try{r.setTarget(n),await r.init(e)}catch(o){o instanceof Error&&r.setErrorInfo({...DEFAULT_JAVASCRIPT_ERROR_INFO,exception:o.stack||""}),"string"==typeof o&&r.setErrorInfo({...DEFAULT_JAVASCRIPT_ERROR_INFO,exception:o})}return r}function useService(){const e=reactExports.useContext(StoreContext),t=reactExports.useContext(CreateTemplateStoreContext),r=null!=e?e:t;if(null===r)throw new Error("Store cannot be null, please add a context provider");return{crudService:r.crudService,reuseService:r.reuseService}}const PathInput=observer((e=>{const{crudService:t}=useService();return jsx(PathInput$1,{...e,openFileSelector:e=>{fvsService.openFileSelector(e)},fetcher:{getTableInfo:t.getTableInfo,getTableNodeList:t.getTables,searchTable:t.searchTable},showFormulaDialog:settingCenter.supportAppService(DUCHAMP_APP_SERVICE.FORMULA)?fvsService.openFormulaEditor:void 0})})),PathInputButton=observer((e=>{const{crudService:t}=useService();return jsx(PathInputButton$1,{...e,openFileSelector:e=>{fvsService.openFileSelector(e)},fetcher:{getTableInfo:t.getTableInfo,getTableNodeList:t.getTables,searchTable:t.searchTable},showFormulaDialog:settingCenter.supportAppService(DUCHAMP_APP_SERVICE.FORMULA)?fvsService.openFormulaEditor:void 0})})),FORMAT_PAINTER_KEY="format-painter",FONT_SIZE_COLOR_TOOLBAR_GROUP={style:{justifyContent:"space-between",width:"100%",gap:"0px"},items:[{key:RICH_TEXT_FORMAT_TYPE.FONT,style:{width:"138px"}},{key:RICH_TEXT_FORMAT_TYPE.SIZE,style:{width:"68px"}},RICH_TEXT_FORMAT_TYPE.COLOR]},BOLD_ITALIC_UNDERLINE_TOOLBAR_GROUP={items:[RICH_TEXT_FORMAT_TYPE.BOLD,RICH_TEXT_FORMAT_TYPE.ITALIC,RICH_TEXT_FORMAT_TYPE.UNDERLINE]},DYNAMIC_VALUE_AND_FORMAT_PAINTER_TOOLBAR_GROUP={items:[DYNAMIC_VALUE_EMBED_KEY,FORMAT_PAINTER_KEY]},DYNAMIC_VALUE_TOOLBAR_GROUP={items:[DYNAMIC_VALUE_EMBED_KEY]},ALIGN_LINE_HEIGHT_TOOLBAR_GROUP={items:[RICH_TEXT_FORMAT_TYPE.ALIGN,RICH_TEXT_FORMAT_TYPE.LINE_HEIGHT]},VERTICAL_ALIGN_TOOLBAR_GROUP={items:[RICH_TEXT_FORMAT_TYPE.VERTICAL_ALIGN]};function getDynamicValueIconStyles$1(e,t){return(null==e?void 0:e.enabled)?t?{...getFilterStyle(e.filter),...getMarginStyles$1(e.position),...getBackgroundStyles$1(t,e.fillType,e.resource.type)}:getMarginStyles$1(e.position):{}}function getMarginStyles$1(e){const t=e===DYNAMIC_VALUE_ICON_POSITION.FRONT;return{marginLeft:e===DYNAMIC_VALUE_ICON_POSITION.BACK?"2px":"0",marginRight:t?"2px":"0"}}function getBackgroundStyles$1(e,t,r){const n=r===DYNAMIC_VALUE_ICON_TYPE.ENUMABLE_ICON?createAbsoluteUrl:createResourceURL;return convertBackgroundStyle({imageSource:e,backgroundFillType:t,urlParser:n})}function ColorItem({value:e="",style:t,instance:r}){return jsx(ThemeColorPickerTrigger,{value:e,disableAlpha:!0,onChange:e=>{null==r||r.updateFormat(RICH_TEXT_FORMAT_TYPE.COLOR,e)},popStyle:t,children:jsxs("div",{className:"toolbar-color-item",children:[jsx(Icon$2,{className:"color-selector",type:"icon-font-color-a"}),jsx(Icon$2,{className:"sub",type:"icon-unfold"}),e&&jsx("div",{className:"selected-color",style:{borderColor:e}})]})})}function DynamicValueItem({onInsert:e,onEdit:t,value:r}){return jsx(Icon$2,{type:"icon-dynamic-value",onClick:()=>{const n=createDefaultDynamicValue(r.ops);t(n),null==e||e({id:n.id,key:DYNAMIC_VALUE_EMBED_KEY,value:n})},title:duchampIntl.get("Duchamp-Insert_Dynamic_Value")})}const FontSelect=e=>jsx(FontSelect$1,{...e,queryFontFamily:fvsService.queryFontFamily});function FontItem({value:e="",style:t,instance:r}){return jsx(FontSelect,{value:e,style:t,onChange:e=>{null==r||r.updateFormat(RICH_TEXT_FORMAT_TYPE.FONT,e)}})}const FormatPainterItem=observer((({instance:e,defaultFormat:t})=>{const r=useStore(),n=r.formatPainter,o=e=>{r.setFormatPainter({...r.formatPainter,...e})},[i,a]=reactExports.useState(!1);reactExports.useEffect((()=>{if(!e||!n)return;const t=t=>{if(t){for(const t in n.rangeFormat)e.updateFormat(t,n.rangeFormat[t]);n.isFormatterLock||(a(!1),null==o||o({rangeFormat:{},isFormatterLock:!1,isFormatting:!1}))}},{isFormatting:r,rangeFormat:i}=n;return r&&!isEmpty$3(i)&&e.addSelectionChangeListen(t),()=>{e.removeSelectionChangeListen(t)}}),[n,e]);return jsx(Icon$2,{type:"icon-format-painter",title:(null==n?void 0:n.isFormatterLock)?duchampIntl.get("Duchamp-Exit_Format_Painter"):duchampIntl.get("Duchamp-Format_Painter"),className:classNames$1({"rich-text-format-painter-item-active":null==n?void 0:n.isFormatting}),onClick:()=>{const r=null==e?void 0:e.getSelection(),s=(null==n?void 0:n.isFormatting)&&!i,l=(null==n?void 0:n.isFormatting)&&i;if(!r||(null==n?void 0:n.isFormatterLock)||s)a(!1),null==o||o({rangeFormat:{},isFormatterLock:!1,isFormatting:!1});else if(l)null==o||o({isFormatterLock:!0});else{a(!0);const n=merge$1({},DEFAULT_RICH_TEXT_FORMAT,t,null==e?void 0:e.getFormats(r.index,r.length>0?1:0));null==o||o({rangeFormat:n,isFormatting:!0}),setTimeout((()=>{a(!1)}),200)}}})}));class BaseScrollAction{constructor(e){__publicField(this,"config"),this.config=e}setConfig(e){this.config={...this.config,...e}}start(){var e;(null==(e=this.config)?void 0:e.enable)&&this.startInternal(this.createOption())}stop(){this.stopInternal()}createOption(){return this.config}}class DomScrollAction extends BaseScrollAction{constructor(e,t,r){super(e),__publicField(this,"timer",null),__publicField(this,"marqueeRef"),__publicField(this,"marqueeContentRef"),__publicField(this,"onMouseEnter"),__publicField(this,"onMouseLeave"),this.config=e,this.marqueeRef=t,this.marqueeContentRef=r}startInternal(){(isNil$3(this.config.stopOnHover)||this.config.stopOnHover)&&this.addEventListener(),this.run()}stopInternal(){this.pause(),this.removeEventListener()}addEventListener(){const e=getTargetElement$2(this.marqueeRef);this.onMouseEnter=()=>{this.pause()},this.onMouseLeave=()=>{this.run()},null==e||e.addEventListener("mouseenter",this.onMouseEnter),null==e||e.addEventListener("mouseleave",this.onMouseLeave)}removeEventListener(){const e=getTargetElement$2(this.marqueeRef);!isNil$3(this.onMouseEnter)&&(null==e||e.removeEventListener("mouseenter",this.onMouseEnter)),!isNil$3(this.onMouseLeave)&&(null==e||e.removeEventListener("mouseleave",this.onMouseLeave))}pause(){this.timer&&window.cancelAnimationFrame(this.timer)}run(){const e=this.getContentDoms(this.marqueeContentRef),t=getTargetElement$2(this.marqueeRef);if(!isNil$3(t)&&e.length>0){const r=this.config.direction===MARQUEE_DIRECTION$1.LEFT||this.config.direction===MARQUEE_DIRECTION$1.RIGHT,n=()=>r?{boxLength:t.offsetWidth,contentLength:this.getContentRect(e).width}:{boxLength:t.offsetHeight,contentLength:this.getContentRect(e).height},o=()=>r?this.getContentRect(e).x:this.getContentRect(e).y,i=()=>r?this.getCurrentPosition(e[0].style.transform,"translateX"):this.getCurrentPosition(e[0].style.transform,"translateY"),a=t=>{e.forEach((e=>{e.style.transform=r?"translateX(".concat(t,"px) translateZ(0)"):"translateY(".concat(t,"px) translateZ(0)"),e.style.backfaceVisibility="hidden",e.style.willChange="transform"}))},s=this.config.direction===(r?MARQUEE_DIRECTION$1.RIGHT:MARQUEE_DIRECTION$1.BOTTOM);this.runInternal(n,o,i,a,s)}}runInternal(e,t,r,n,o){let i=null,a=0,s=0,l=0;const c=u=>{const d=i?u-i:0,{contentLength:h,boxLength:p}=e();let f=null;if(h>0&&p>0&&d>=a){const e=r();let c=p-t(),g=-h-t(),m=-this.config.speed*(d-a)/1e3;o&&([c,g]=[g,c],m=-m),f=this.getPosition(m,c,e,g,o);const y=Math.round(f+s);s+=f-y,n(y),i=u,a=0!==d&&0===y&&0!==l?timeUnitToMillisecond(this.config.stay):0,l=y}this.timer=window.requestAnimationFrame(c)};this.timer=window.requestAnimationFrame(c)}getPosition(e,t,r,n,o){let i=r+e;return(!o&&i<n||o&&i>n)&&(i=t),Math.abs(i)<Math.abs(e)&&(i=0),i}getCurrentPosition(e,t){var r;const n=RegExp("".concat(t,"\\((.+)\\)")),o=null==(r=e.match(n))?void 0:r[1];return o?parseFloat(o):0}getContentDoms(e){const t=[];return(isArray$c(e)?e:[e]).forEach((e=>{const r=getTargetElement$2(e);isNil$3(r)||t.push(r)})),t}getContentRect(e){let t=Number.MAX_VALUE,r=Number.MAX_VALUE,n=Number.MIN_VALUE,o=Number.MIN_VALUE;for(const i of e)t=Math.min(t,i.offsetLeft),r=Math.min(r,i.offsetTop),n=Math.max(n,i.offsetLeft+i.offsetWidth),o=Math.max(o,i.offsetTop+i.offsetHeight);return{x:t,y:r,width:n-t,height:o-r}}}function getToolbarWithEmbed(e=!0){return[[FONT_SIZE_COLOR_TOOLBAR_GROUP],[BOLD_ITALIC_UNDERLINE_TOOLBAR_GROUP,e?DYNAMIC_VALUE_AND_FORMAT_PAINTER_TOOLBAR_GROUP:DYNAMIC_VALUE_TOOLBAR_GROUP],[ALIGN_LINE_HEIGHT_TOOLBAR_GROUP,VERTICAL_ALIGN_TOOLBAR_GROUP]]}function createDomScrollAction(e){const{marquee:t,editorElement:r,contentList:n}=e;return new DomScrollAction({...t,enable:t.enable},r,Array.from(n))}function findDynamicValueOp(e,t){return null==t?void 0:t.reduce(((t,r)=>{if(isDynamicValueOp(r)){const{fx:n}=r.insert[DYNAMIC_VALUE_EMBED_KEY];n.id===e&&(t=r)}return t}),null)}function getDefaultDynamicValueStyle(e,t){var r,n,o,i;const a=null==(r=findDynamicValueOp(e,t))?void 0:r.attributes;return{fontFamily:null!=(n=null==a?void 0:a.font)?n:TEXT.FONT_FAMILY,fontStyle:{fontSize:null!=(o=null==a?void 0:a.size)?o:TEXT.FONT_SIZE,textDecoration:(null==a?void 0:a.underline)?"underline":void 0,fontWeight:(null==a?void 0:a.bold)?"bold":void 0,fontStyle:(null==a?void 0:a.italic)?"italic":void 0},fontColor:null!=(i=null==a?void 0:a.color)?i:TEXT.COLOR,textShadow:{enabled:!1,boxShadow:[]},lineHeight:null==a?void 0:a.lineHeight}}function replaceOpsData(e,t){return e.map((e=>{var r,n;if(isDynamicValueOp(e)){const{insert:r}=e,n=r[DYNAMIC_VALUE_EMBED_KEY];return{...e,insert:{...r,[DYNAMIC_VALUE_EMBED_KEY]:{...n,fx:replaceDynamicValueDataset(n.fx,t)}}}}if(isFormulaOp(e)){const{insert:o}=e,i=o[FORMULA_EMBED_KEY],a=i.fx;return{...e,insert:{...o,[FORMULA_EMBED_KEY]:{...i,fx:null!=(n=null==(r=t.formula)?void 0:r[a])?n:a}}}}return e}))}function useFocusPointTarget(){const e=useStore();if(!e)return[];const{story:{currentWidgets:t}}=e;return t.map((e=>e.id))}function ConditionEditor({visible:e,defaultValue:t,onOk:r,onCancel:n}){const{crudService:o}=useService(),[i,a]=reactExports.useState(t),s=useFocusPointTarget();return reactExports.useEffect((()=>{e&&a(t)}),[t,e]),jsx(FVSDialog,{visible:e,onCancel:n,onOk:()=>r(i),title:duchampIntl.get("Duchamp-Condition_Config"),"data-focus-point":{id:"S97",trigger:"onOk",getTarget:()=>s},children:jsx(ConditionPanel,{value:i,onChange:a,config:{showFormulaDialog:fvsService.openFormulaEditor,getDatasetList:async()=>(await o.getTables()).map((e=>e.name)),getFieldList:async e=>{if(!e)return[];return(await o.getTableInfo(e)).fields.map((e=>e.name))}}})})}function ConditionPanel({value:e,onChange:t,config:r}){const n=useFocusPointTarget(),o=reactExports.useMemo((()=>null!==e?getTreeDataByCondition(e):null),[e]);return jsx("div",{className:"condition-editor-panel",children:jsx(LogicTree,{value:o,onChange:e=>{t(null!==e?getConditionByTreeData(e):null)},createLeafValue:e=>"condition"===e?{id:uuid$1(),left:{id:uuid$1(),type:CONDITION_OPERAND_TYPE.VALUE},right:{id:uuid$1(),type:CONDITION_OPERAND_TYPE.TEXT},operator:BINARY_CONDITION_OPERATOR_OPTIONS[0].value}:{id:uuid$1(),operand:{id:uuid$1(),type:CONDITION_OPERAND_TYPE.FORMULA}},leafStyles:[{type:"condition",label:duchampIntl.get("Duchamp-Add_Condition"),focusPoint:{id:"S95",target:n}},{type:"formula",label:duchampIntl.get("Duchamp-Add_Formula"),focusPoint:{id:"S96",target:n}}],leafRender:(e,t)=>{var n,o,i,a;if(isBinaryCondition(e)){const{operator:i,right:a}=e;return jsxs("div",{className:"condition-item",children:[jsx("div",{className:"item-label",children:duchampIntl.get("Duchamp-Value")}),jsx(OperatorSelector,{className:"item-selector",value:i,onChange:r=>{t({...e,operator:r})}}),jsx(OperandTypeSelector,{value:a.type,className:"item-selector",options:[CONDITION_OPERAND_TYPE.TEXT,CONDITION_OPERAND_TYPE.INTEGER,CONDITION_OPERAND_TYPE.DOUBLE,CONDITION_OPERAND_TYPE.DATE,CONDITION_OPERAND_TYPE.BOOLEAN,CONDITION_OPERAND_TYPE.FORMULA,CONDITION_OPERAND_TYPE.PARAMETER,CONDITION_OPERAND_TYPE.DATASET_FIELD],onChange:r=>{t({...e,right:{id:a.id,type:r}})}}),jsx("div",{className:"item-content",children:null==(o=null==(n=operandManager.getOperand(a.type))?void 0:n.createPanel)?void 0:o.call(n,a.value,(r=>t({...e,right:{...a,value:r}})),r)})]})}return isUnaryCondition(e)?jsxs("div",{className:"formula-item",children:[jsx("div",{className:"item-label",children:duchampIntl.get("Duchamp-Meet")}),jsx("div",{className:"item-content",children:null==(a=null==(i=operandManager.getOperand(e.operand.type))?void 0:i.createPanel)?void 0:a.call(i,e.operand.value,(r=>t({...e,operand:{...e.operand,value:r}})),r)})]}):jsx(Fragment,{})}})})}function OperatorSelector({value:e,onChange:t,className:r}){return jsx("div",{className:classNames$1("operator-selector",r),children:jsx(Select$1,{style:{width:"100%"},className:r,onChange:t,value:e,options:BINARY_CONDITION_OPERATOR_OPTIONS.map((e=>({label:e.text,value:e.value})))})})}function OperandTypeSelector({value:e,onChange:t,options:r,className:n}){const o=r.reduce(((e,t)=>{const r=operandManager.getOperand(t);return r&&e.push(r),e}),[]);return jsx("div",{className:classNames$1("operand-type-selector",n),children:jsx(Select$1,{style:{width:"100%"},onChange:t,value:e,options:o.map((e=>({label:e.name,value:e.type})))})})}function DuchampCustomImageResource({canEdit:e,value:t,onChange:r,mask:n=!0,container:o,tag:i="default",defaultResource:a,imgStyle:s}){const{resourceCenter:l,target:c}=useStore();return jsx(CustomImageResource,{value:t,tag:i,imgStyle:s,onChange:r,canEdit:e,defaultResource:a,resourceCenter:l,drawerContainer:o||c,getResourceUrl:createResourceURL,placeholderIcon:createAbsoluteUrl("/assets/system/empty_image_thumb.svg"),emptyIcon:createAbsoluteUrl("/assets/system/empty_border.svg"),onVisibleChange:e=>{e?fvsService.openMask():fvsService.closeMask()},mask:n})}function ResourceSelector$1(e){var t;const{children:r,value:n,onChange:o,...i}=e,a=compact(Array.isArray(r)?r:[r]);let s=null==(t=a.find((e=>e.props.value===n.type)))?void 0:t.props.children;if(s&&s.props){const e=n.type===RESOURCE_TYPE.INTERNAL||n.type===RESOURCE_TYPE.CUSTOM;s=reactExports.cloneElement(s,{...s.props,onChange:t=>{const r=e?t.id:t;o({value:r,type:n.type})},value:n.value})}return jsx("div",{...i,children:jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,children:[jsx(Select$1,{style:{width:"100%"},onChange:e=>{var t,r;o({type:e,value:null==(r=null==(t=a.find((t=>t.props.value===e)))?void 0:t.props.children)?void 0:r.props.defaultValue})},value:n.type,children:a.map((e=>jsx(Select$1.Option,{text:e.props.text,value:e.props.value,children:e.props.text},e.props.value)))}),s]})})}function ResourceSelectorOption(e){return jsx(Fragment,{})}const InternalIconResource=({value:e,onChange:t,internalIconList:r})=>jsx("div",{className:"internal-icon-resource",children:r.map((r=>jsx("div",{className:classNames$1("internal-icon-wrapper",{selected:e===r}),onClick:()=>{return e=r,void(null==t||t(e));var e},children:jsx("div",{className:"internal-icon",style:{background:"url(".concat(createAbsoluteUrl(r),") center / contain no-repeat")}})},r)))}),ProcessReusePane=reactExports.lazy((async()=>{(await __vitePreload((()=>import("./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/index-hash-rjZQGsq7.js")),__vite__mapDeps([0,1]),import.meta.url)).reuseIntl.init(getLanguage());return{default:(await __vitePreload((()=>import("./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/index-hash-DS2Z-Cll.js")),__vite__mapDeps([2,3,4,1,5,6,7,8,9]),import.meta.url)).ProcessReusePane}})),SuspenseProcessReusePaneWrapper=e=>jsx(reactExports.Suspense,{fallback:jsx("div",{style:{width:"480px",height:"100%"}}),children:jsx(ProcessReusePane,{...e,language:getLanguage()})}),getBlockOnlineEntry=()=>!1;function DuchampInternalImageResource({imageScopes:e,value:t,onChange:r,mask:n=!0,container:o,defaultResource:i,showOnlineMode:a,imgStyle:s}){const{resourceCenter:l,imageReuse:c,target:u,reuseService:d}=useStore(),h=d.isAppReuseMode()?{customResourcePane:jsx(SuspenseProcessReusePaneWrapper,{manager:c}),drawerWidth:480}:{};return jsx(InternalResource,{value:t,imgStyle:s,imageScopes:e,defaultResource:i,getResourceUrl:createResourceURL,resourceCenter:l,readResource:useService().reuseService.readReuseResource,imageReuse:c,onChange:r,drawerContainer:o||u,mask:n,showOnlineMode:a,showPackageNames:!0,isBlockOnlineEntry:getBlockOnlineEntry(),...h})}function ShadowDialog(e){const{value:t,shadowList:r,hideSetting:n}=e,[o,i]=reactExports.useState(t),a="".concat(14/24*100,"%");return jsx(FVSDialog,{styles:{body:{padding:24}},visible:!0,title:duchampIntl.get("Duchamp-Set_Box_Shadow"),onCancel:()=>{e.onCancel(!1)},onOk:()=>{e.onOk({...o})},props4Ok:{disabled:!o.name||(e=>{let t=!1;return t=r.some((t=>t.name===e)),t})(o.name)},children:jsxs(Form,{className:"shadow-form",initialValues:o,onValuesChange:(e,t)=>{i({...o,...t})},children:[jsx(Form.Item,{name:"name",label:duchampIntl.get("Duchamp-Box_Shadow_Name"),rules:{required:duchampIntl.get("Duchamp-Box_Shadow_Empty_Name"),validate:e=>!r.some((t=>t.name===e))||duchampIntl.get("Duchamp-Box_Shadow_Repeat_Name")},children:jsx(Input$2,{})}),!n&&jsx(Form.Item,{name:"style",label:duchampIntl.get("Duchamp-Box_Shadow_Style"),className:"shadow-style",children:jsx(RadioGroup$1,{optionType:"default",block:!1,direction:"horizontal",options:[{label:duchampIntl.get("Duchamp-Box_Shadow_Outset"),value:""},{label:duchampIntl.get("Duchamp-Box_Shadow_Inset"),value:"inset"}]})}),jsx(Form.Item,{label:duchampIntl.get("Duchamp-Box_Shadow_Offset"),children:jsxs(Row$1,{align:"middle",children:[jsx(Col,{span:1,children:jsx("div",{className:"secondary-title",children:"X"})}),jsx(Col,{span:6,children:jsx(NumberInput$1,{value:o.offsetX,suffix:"px",width:"90%",onChange:e=>i({...o,offsetX:e})})}),jsx(Col,{span:1,children:jsx("div",{className:"secondary-title",children:"Y"})}),jsx(Col,{span:6,children:jsx(NumberInput$1,{value:o.offsetY,suffix:"px",onChange:e=>i({...o,offsetY:e})})})]})}),jsx(Form.Item,{name:"blur",label:duchampIntl.get("Duchamp-Box_Shadow_Blur"),children:jsx(NumberInput$1,{min:0,suffix:"px",width:a})}),n?void 0:jsx(Form.Item,{name:"spread",label:duchampIntl.get("Duchamp-Box_Shadow_Spread"),children:jsx(NumberInput$1,{suffix:"px",width:a})}),jsx(Form.Item,{label:duchampIntl.get("Duchamp-Box_Shadow_Color"),children:jsx(Row$1,{children:jsx(Col,{span:8,children:jsx(ThemeColorPicker,{value:o.color,onChange:e=>i({...o,color:e})})})})})]})})}const DraggableBodyRow=({index:e,moveRow:t,shadow:r,shadowList:n,onChange:o,onDelete:i,hideSetting:a,...s})=>{const l=reactExports.useRef(null),[c,u]=reactExports.useState(!1),[{isOver:d,dropClassName:h},p]=useDrop({accept:DRAG.TYPE.SHADOW_ITEM,collect:t=>{const{index:r}=t.getItem()||{};return r===e?{}:{isOver:t.isOver(),dropClassName:r<e?"drop-over-downward":"drop-over-upward"}},drop:r=>{t(r.index,e)}}),[,f]=useDrag$2({type:DRAG.TYPE.SHADOW_ITEM,item:{index:e},collect:e=>({isDragging:e.isDragging()})}),g=n.filter((e=>e.name!==r.name));return p(f(l)),jsxs(Fragment,{children:[jsx("div",{className:"shadow-list",children:jsxs(Row$1,{ref:l,className:"".concat(d?h:""),style:{cursor:"move",alignItems:"center",height:32,flexWrap:"nowrap"},...s,children:[jsx(Icon$2,{className:"shadow-icon",type:"inset"===r.style?"icon-inner":"icon-outer",title:"inset"===r.style?duchampIntl.get("Duchamp-Box_Shadow_Inset"):duchampIntl.get("Duchamp-Box_Shadow_Outset")}),jsx("div",{className:"shadow-list-text",children:r.name}),jsxs("div",{className:"suffix-icon-group",children:[jsx(Icon$2,{type:"icon-edit",onClick:()=>u(!0)}),jsx(Icon$2,{type:"icon-delete",onClick:()=>i(r.id)})]})]})}),c?jsx(ShadowDialog,{value:r,onOk:e=>{o(e),u(!1)},onCancel:()=>u(!1),onValueChange:e=>o(e),shadowList:g,hideSetting:a}):void 0]})};function ShadowBox(e){const{value:t,hideSetting:r}=e,n=0===t.length,o=(r,n)=>{e.onChange(arrayMove(t.slice(),r,n))};return jsx("div",{className:"shadow-box",children:n?jsx("div",{className:"tip",children:duchampIntl.get("Duchamp-There_Are_Currently_No_Box_Shadows")}):t.map(((n,i)=>jsx(DraggableBodyRow,{index:i,moveRow:o,shadow:n,onChange:r=>{const n=[...t];n[i]=r,e.onChange([...n])},onDelete:r=>{const n=t.filter((e=>e.id!==r));e.onChange([...n])},shadowList:t,hideSetting:r},n.id)))})}function ShadowInput(e){const{value:t,hideSetting:r=!1}=e,[n,o]=reactExports.useState(!1),i=createUniqueName(t.boxShadow.map((e=>e.name)),duchampIntl.get("Duchamp-Box_Shadow_Without_Name")),a={id:v4$1(),name:i,style:"",offsetX:2,offsetY:2,blur:6,spread:0,color:"#FFFFFF73"};return jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,children:[jsx(Checkbox$4,{value:t.enabled,onChange:r=>e.onChange({...t,enabled:r}),text:duchampIntl.get("Duchamp-Box_Shadow_Effect")}),t.enabled?jsxs(Fragment,{children:[jsx(IconTextButton,{style:{paddingLeft:0,width:"fit-content"},icon:"icon-add",text:duchampIntl.get("Duchamp-Add_Box_Shadow"),onClick:()=>{o(!0)}}),n?jsx(ShadowDialog,{hideSetting:r,value:a,onOk:r=>{e.onChange({...t,boxShadow:[...t.boxShadow,r]}),o(!1)},onCancel:()=>{o(!1)},shadowList:t.boxShadow}):void 0,jsx(ShadowBox,{value:t.boxShadow,onChange:r=>e.onChange({...t,boxShadow:r}),hideSetting:r})]}):void 0]})}const PlatformPopoverIcon=observer((({mouseEnterDelay:e=1,placement:t="top-left",overlayStyle:r={maxWidth:250},trigger:n="hover",arrow:o={pointAtCenter:!0},...i})=>{const a=useStore();return jsx(IconPopover,{className:"platform-popover-icon",icon:a.platform.isMobile?"icon-mobile":"icon-pc",text:a.platform.isMobile?duchampIntl.get("Duchamp-Config_Item_Icon_Mobile_Tip"):duchampIntl.get("Duchamp-Config_Item_Icon_PC_Tip"),trigger:n,mouseEnterDelay:e,placement:t,overlayStyle:r,arrow:o,...i})})),BATCH_MODE={NONE:"none",MOVE:"move",DELETE:"delete"},IMAGE_SCOPE={BACKGROUND:"background",ICON:"icon",DECORATOR:"decorator",OTHER:"other"},IMAGE_SCOPE_BACKGROUND={PAGE:"background-1"},REUSE_RESOURCE_NAME={[REUSE_TYPE.TEMPLATE]:duchampIntl.get("Duchamp-Resource_Template"),[REUSE_TYPE.WIDGET]:duchampIntl.get("Duchamp-Resource_Widget"),[REUSE_TYPE.IMAGE]:duchampIntl.get("Duchamp-Resource_Image"),[REUSE_TYPE.VIDEO]:duchampIntl.get("Duchamp-Resource_Video"),[REUSE_TYPE.PACKAGE_APP]:duchampIntl.get("Duchamp-Reuse_Packaged_App")},REUSE_TYPE_PACKAGE_NAME={[REUSE_TYPE.TEMPLATE]:duchampIntl.get("Duchamp-Reuse_Template_Package"),[REUSE_TYPE.WIDGET]:duchampIntl.get("Duchamp-Reuse_Widget_Package"),[REUSE_TYPE.IMAGE]:duchampIntl.get("Duchamp-Reuse_Material_Package")},REUSE_RENAME_STATE={CANCEL:1,KEEP_BOTH:2,KEEP_NEW:3},REUSE_FILTER_DEFAULT={WIDGET_TYPE:"FVS_other-0",IMAGE_PURPOSE:"background-31",DEVICE_TYPE:"pc"},REUSE_FILE_MAX_SIZE={[REUSE_TYPE.TEMPLATE]:1/0,[REUSE_TYPE.WIDGET]:100,[REUSE_TYPE.IMAGE]:20,[REUSE_TYPE.VIDEO]:50,[REUSE_TYPE.PACKAGE_APP]:100},REUSE_ERROR_CODE={UPLOAD_NO_GROUP:"52300004"};function ConditionStyleItem({value:e,onChange:t,checkName:r,config:n={supportGradient:!0,supportShadow:!0}}){const{condition:o,style:i,icon:a}=e,s=useFocusPointTarget(),[l,c]=reactExports.useState(!1),u=r=>{t({...e,style:{...e.style,...r}})},d=r=>{t({...e,icon:{...DEFAULT_DYNAMIC_VALUE_ICON,...a,...r}})};return jsxs("div",{className:"condition-style-item-config",children:[jsxs(GridItem,{children:[jsx(LineItem,{label:duchampIntl.get("Duchamp-Name"),children:jsx(ValidationInput,{value:e.name,rules:[{required:!0,message:duchampIntl.get("Duchamp-Content_Cannot_Be_Empty")},{validate:r,message:duchampIntl.get("Duchamp-Duplicate_Name_Exists_Tip")}],onChange:r=>t({...e,name:r}),placeholder:duchampIntl.get("Duchamp-Please_Enter")})}),jsxs(LineItem,{label:duchampIntl.get("Duchamp-Condition"),children:[jsx(Button$4,{onClick:()=>c(!0),style:{width:"100%"},"data-focus-point":{id:"S94",getTarget:()=>s},children:duchampIntl.get("Duchamp-Condition_Config")}),o&&jsx(ConditionDescribePanel,{value:o})]}),jsxs(LineItem,{label:duchampIntl.get("Duchamp-Style"),children:[jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Font_Style"),children:jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,children:[jsx(FontSelect,{value:i.fontFamily,onChange:e=>u({fontFamily:e})}),jsx(FontStyleConfig,{value:i.fontStyle,showTypes:{bold:!0,italic:!0,underline:!0},prefixIcon:jsx(PlatformPopoverIcon,{}),onChange:e=>u({fontStyle:e})}),n.supportGradient?jsx(CompositeColorSelector,{value:i.fontColor,onChange:e=>u({fontColor:e})}):jsx(ThemeColorPicker,{value:i.fontColor,onChange:e=>u({fontColor:e})})]})}),n.supportShadow&&jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Text_Shadow"),children:jsx(ShadowInput,{value:i.textShadow,onChange:e=>u({textShadow:e})})})]}),n.supportIcon&&jsxs(LineItem,{label:duchampIntl.get("Duchamp-Icon"),children:[jsx(VerticalItem$1,{children:jsx(Checkbox$4,{value:null==a?void 0:a.enabled,onChange:e=>d({enabled:e}),children:duchampIntl.get("Duchamp-Icon_Enable")})}),(null==a?void 0:a.enabled)&&jsx(IconDescribePanel,{icon:a,updateIcon:d})]})]}),jsx(ConditionEditor,{visible:l,defaultValue:o,onOk:r=>{t({...e,condition:r}),c(!1)},onCancel:()=>c(!1)})]})}const IconDescribePanel=observer((({icon:e,updateIcon:t})=>{const{position:r,resource:n,fillType:o,filter:i}=e,{hue:a,saturation:s,brightness:l,contrast:c,opacity:u}=i;return jsxs(Fragment,{children:[jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Icon_Position"),children:jsx(RadioGroup$1,{value:r,onChange:e=>t({position:e}),options:[{label:duchampIntl.get("Duchamp-Icon_Position_Front"),value:DYNAMIC_VALUE_ICON_POSITION.FRONT},{label:duchampIntl.get("Duchamp-Icon_Position_Back"),value:DYNAMIC_VALUE_ICON_POSITION.BACK}]})}),jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Icon_Style"),children:jsxs(ResourceSelector$1,{value:n,onChange:e=>{return(r=e).type!==DYNAMIC_VALUE_ICON_TYPE.ENUMABLE_ICON||r.value||(r.value=DYNAMIC_VALUE_ICON_RESOURCE_CENTER[0]),void t({resource:r,fillType:DEFAULT_DYNAMIC_VALUE_ICON.fillType,filter:DEFAULT_DYNAMIC_VALUE_ICON.filter});var r},children:[jsx(ResourceSelectorOption,{text:duchampIntl.get("Duchamp-Resource_Internal"),value:DYNAMIC_VALUE_ICON_TYPE.ENUMABLE_ICON,children:jsx(InternalIconResource,{internalIconList:DYNAMIC_VALUE_ICON_RESOURCE_CENTER})}),settingCenter.supportAppService(DUCHAMP_APP_SERVICE.REUSE)?jsx(ResourceSelectorOption,{text:duchampIntl.get("Duchamp-Resource_Center"),value:DYNAMIC_VALUE_ICON_TYPE.INTERNAL,children:jsx(DuchampInternalImageResource,{imageScopes:[IMAGE_SCOPE.ICON,IMAGE_SCOPE.OTHER]})}):null,jsx(ResourceSelectorOption,{text:duchampIntl.get("Duchamp-Custom_Upload"),value:DYNAMIC_VALUE_ICON_TYPE.CUSTOM,children:jsx(DuchampCustomImageResource,{tag:"",canEdit:!1})})]})}),n.type!==DYNAMIC_VALUE_ICON_TYPE.ENUMABLE_ICON&&jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Filling_Method"),children:jsx(RadioGroup$1,{value:o,onChange:e=>t({fillType:e}),options:BACKGROUND_FILL_TYPE_ITEMS})}),jsx(FilterProcessPanel,{components:["hue","opacity",["saturation","brightness","contrast"]],hue:a,opacity:u,brightness:l,saturation:s,contrast:c,onChange:e=>t({filter:{...i,...e}}),layout:"vertical",gapSize:GAP_SIZE.SMALL})]})})),ConditionDescribePanel=observer((({value:e})=>jsx(DescribePanel,{condition:e,className:"condition-describe-panel",renders:{binary:e=>{const{operator:t,right:r}=e;return jsxs(Fragment,{children:[duchampIntl.get("Duchamp-Value"),jsx(OperatorPanel,{value:t}),jsx(OperandPanel,{value:r})]})},unary:e=>{const{operand:t}=e;return jsxs(Fragment,{children:[duchampIntl.get("Duchamp-Meet"),jsx(OperandPanel,{value:t})]})}}}))),{createElement:createElement}=React;var updateQueue=makeQueue(),raf=e=>schedule(e,updateQueue),writeQueue=makeQueue();raf.write=e=>schedule(e,writeQueue);var onStartQueue=makeQueue();raf.onStart=e=>schedule(e,onStartQueue);var onFrameQueue=makeQueue();raf.onFrame=e=>schedule(e,onFrameQueue);var onFinishQueue=makeQueue();raf.onFinish=e=>schedule(e,onFinishQueue);var timeouts=[];raf.setTimeout=(e,t)=>{const r=raf.now()+t,n=()=>{const e=timeouts.findIndex((e=>e.cancel==n));~e&&timeouts.splice(e,1),pendingCount-=~e?1:0},o={time:r,handler:e,cancel:n};return timeouts.splice(findTimeout(r),0,o),pendingCount+=1,start(),o};var findTimeout=e=>~(~timeouts.findIndex((t=>t.time>e))||~timeouts.length);raf.cancel=e=>{onStartQueue.delete(e),onFrameQueue.delete(e),onFinishQueue.delete(e),updateQueue.delete(e),writeQueue.delete(e)},raf.sync=e=>{sync=!0,raf.batchedUpdates(e),sync=!1},raf.throttle=e=>{let t;function r(){try{e(...t)}finally{t=null}}function n(...e){t=e,raf.onStart(r)}return n.handler=e,n.cancel=()=>{onStartQueue.delete(r),t=null},n};var nativeRaf="undefined"!=typeof window?window.requestAnimationFrame:()=>{};raf.use=e=>nativeRaf=e,raf.now="undefined"!=typeof performance?()=>performance.now():Date.now,raf.batchedUpdates=e=>e(),raf.catch=console.error,raf.frameLoop="always",raf.advance=()=>{"demand"!==raf.frameLoop||update()};var ts=-1,pendingCount=0,sync=!1;function schedule(e,t){sync?(t.delete(e),e(0)):(t.add(e),start())}function start(){ts<0&&(ts=0,"demand"!==raf.frameLoop&&nativeRaf(loop))}function stop(){ts=-1}function loop(){~ts&&(nativeRaf(loop),raf.batchedUpdates(update))}function update(){const e=ts;ts=raf.now();const t=findTimeout(ts);t&&(eachSafely(timeouts.splice(0,t),(e=>e.handler())),pendingCount-=t),pendingCount?(onStartQueue.flush(),updateQueue.flush(e?Math.min(64,ts-e):16.667),onFrameQueue.flush(),writeQueue.flush(),onFinishQueue.flush()):stop()}function makeQueue(){let e=new Set,t=e;return{add(r){pendingCount+=t!=e||e.has(r)?0:1,e.add(r)},delete:r=>(pendingCount-=t==e&&e.has(r)?1:0,e.delete(r)),flush(r){t.size&&(e=new Set,pendingCount-=t.size,eachSafely(t,(t=>t(r)&&e.add(t))),pendingCount+=e.size,t=e)}}}function eachSafely(e,t){e.forEach((e=>{try{t(e)}catch(e3){raf.catch(e3)}}))}var __defProp$X=Object.defineProperty,__export=(e,t)=>{for(var r in t)__defProp$X(e,r,{get:t[r],enumerable:!0})},globals_exports={};function noop(){}__export(globals_exports,{assign:()=>assign,colors:()=>colors,createStringInterpolator:()=>createStringInterpolator,skipAnimation:()=>skipAnimation,to:()=>to,willAdvance:()=>willAdvance});var defineHidden=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,configurable:!0}),is={arr:Array.isArray,obj:e=>!!e&&"Object"===e.constructor.name,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,und:e=>void 0===e};function isEqual$1(e,t){if(is.arr(e)){if(!is.arr(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return e===t}var each=(e,t)=>e.forEach(t);function eachProp(e,t,r){if(is.arr(e))for(let n=0;n<e.length;n++)t.call(r,e[n],"".concat(n));else for(const n in e)e.hasOwnProperty(n)&&t.call(r,e[n],n)}var toArray=e=>is.und(e)?[]:is.arr(e)?e:[e];function flush(e,t){if(e.size){const r=Array.from(e);e.clear(),each(r,t)}}var flushCalls=(e,...t)=>flush(e,(e=>e(...t))),isSSR=()=>"undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),createStringInterpolator,to,colors=null,skipAnimation=!1,willAdvance=noop,assign=e=>{e.to&&(to=e.to),e.now&&(raf.now=e.now),void 0!==e.colors&&(colors=e.colors),null!=e.skipAnimation&&(skipAnimation=e.skipAnimation),e.createStringInterpolator&&(createStringInterpolator=e.createStringInterpolator),e.requestAnimationFrame&&raf.use(e.requestAnimationFrame),e.batchedUpdates&&(raf.batchedUpdates=e.batchedUpdates),e.willAdvance&&(willAdvance=e.willAdvance),e.frameLoop&&(raf.frameLoop=e.frameLoop)},startQueue=new Set,currentFrame=[],prevFrame=[],priority=0,frameLoop={get idle(){return!startQueue.size&&!currentFrame.length},start(e){priority>e.priority?(startQueue.add(e),raf.onStart(flushStartQueue)):(startSafely(e),raf(advance))},advance:advance,sort(e){if(priority)raf.onFrame((()=>frameLoop.sort(e)));else{const t=currentFrame.indexOf(e);~t&&(currentFrame.splice(t,1),startUnsafely(e))}},clear(){currentFrame=[],startQueue.clear()}};function flushStartQueue(){startQueue.forEach(startSafely),startQueue.clear(),raf(advance)}function startSafely(e){currentFrame.includes(e)||startUnsafely(e)}function startUnsafely(e){currentFrame.splice(findIndex$1(currentFrame,(t=>t.priority>e.priority)),0,e)}function advance(e){const t=prevFrame;for(let r=0;r<currentFrame.length;r++){const n=currentFrame[r];priority=n.priority,n.idle||(willAdvance(n),n.advance(e),n.idle||t.push(n))}return priority=0,(prevFrame=currentFrame).length=0,(currentFrame=t).length>0}function findIndex$1(e,t){const r=e.findIndex(t);return r<0?e.length:r}var clamp$1=(e,t,r)=>Math.min(Math.max(r,e),t),colors2={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},NUMBER="[-+]?\\d*\\.?\\d+",PERCENTAGE=NUMBER+"%";function call(...e){return"\\(\\s*("+e.join(")\\s*,\\s*(")+")\\s*\\)"}var rgb$1=new RegExp("rgb"+call(NUMBER,NUMBER,NUMBER)),rgba$1=new RegExp("rgba"+call(NUMBER,NUMBER,NUMBER,NUMBER)),hsl=new RegExp("hsl"+call(NUMBER,PERCENTAGE,PERCENTAGE)),hsla=new RegExp("hsla"+call(NUMBER,PERCENTAGE,PERCENTAGE,NUMBER)),hex3$1=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex4=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6$1=/^#([0-9a-fA-F]{6})$/,hex8=/^#([0-9a-fA-F]{8})$/;function normalizeColor(e){let t;return"number"==typeof e?e>>>0===e&&e>=0&&e<=4294967295?e:null:(t=hex6$1.exec(e))?parseInt(t[1]+"ff",16)>>>0:colors&&void 0!==colors[e]?colors[e]:(t=rgb$1.exec(e))?(parse255(t[1])<<24|parse255(t[2])<<16|parse255(t[3])<<8|255)>>>0:(t=rgba$1.exec(e))?(parse255(t[1])<<24|parse255(t[2])<<16|parse255(t[3])<<8|parse1(t[4]))>>>0:(t=hex3$1.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+"ff",16)>>>0:(t=hex8.exec(e))?parseInt(t[1],16)>>>0:(t=hex4.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+t[4]+t[4],16)>>>0:(t=hsl.exec(e))?(255|hslToRgb(parse360(t[1]),parsePercentage(t[2]),parsePercentage(t[3])))>>>0:(t=hsla.exec(e))?(hslToRgb(parse360(t[1]),parsePercentage(t[2]),parsePercentage(t[3]))|parse1(t[4]))>>>0:null}function hue2rgb(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function hslToRgb(e,t,r){const n=r<.5?r*(1+t):r+t-r*t,o=2*r-n,i=hue2rgb(o,n,e+1/3),a=hue2rgb(o,n,e),s=hue2rgb(o,n,e-1/3);return Math.round(255*i)<<24|Math.round(255*a)<<16|Math.round(255*s)<<8}function parse255(e){const t=parseInt(e,10);return t<0?0:t>255?255:t}function parse360(e){return(parseFloat(e)%360+360)%360/360}function parse1(e){const t=parseFloat(e);return t<0?0:t>1?255:Math.round(255*t)}function parsePercentage(e){const t=parseFloat(e);return t<0?0:t>100?1:t/100}function colorToRgba(e){let t=normalizeColor(e);if(null===t)return e;t=t||0;const r=(16711680&t)>>>16,n=(65280&t)>>>8,o=(255&t)/255;return"rgba(".concat((4278190080&t)>>>24,", ").concat(r,", ").concat(n,", ").concat(o,")")}var createInterpolator=(e,t,r)=>{if(is.fun(e))return e;if(is.arr(e))return createInterpolator({range:e,output:t,extrapolate:r});if(is.str(e.output[0]))return createStringInterpolator(e);const n=e,o=n.output,i=n.range||[0,1],a=n.extrapolateLeft||n.extrapolate||"extend",s=n.extrapolateRight||n.extrapolate||"extend",l=n.easing||(e=>e);return e=>{const t=findRange(e,i);return interpolate(e,i[t],i[t+1],o[t],o[t+1],l,a,s,n.map)}};function interpolate(e,t,r,n,o,i,a,s,l){let c=l?l(e):e;if(c<t){if("identity"===a)return c;"clamp"===a&&(c=t)}if(c>r){if("identity"===s)return c;"clamp"===s&&(c=r)}return n===o?n:t===r?e<=t?n:o:(t===-1/0?c=-c:r===1/0?c-=t:c=(c-t)/(r-t),c=i(c),n===-1/0?c=-c:o===1/0?c+=n:c=c*(o-n)+n,c)}function findRange(e,t){for(var r=1;r<t.length-1&&!(t[r]>=e);++r);return r-1}var steps=(e,t="end")=>r=>{const n=(r="end"===t?Math.min(r,.999):Math.max(r,.001))*e,o="end"===t?Math.floor(n):Math.ceil(n);return clamp$1(0,1,o/e)},c1=1.70158,c2=1.525*c1,c3=c1+1,c4=2*Math.PI/3,c5=2*Math.PI/4.5,bounceOut=e=>{const t=7.5625,r=2.75;return e<1/r?t*e*e:e<2/r?t*(e-=1.5/r)*e+.75:e<2.5/r?t*(e-=2.25/r)*e+.9375:t*(e-=2.625/r)*e+.984375},easings={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>1-(1-e)*(1-e),easeInOutQuad:e=>e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2,easeInCubic:e=>e*e*e,easeOutCubic:e=>1-Math.pow(1-e,3),easeInOutCubic:e=>e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1-Math.pow(1-e,4),easeInOutQuart:e=>e<.5?8*e*e*e*e:1-Math.pow(-2*e+2,4)/2,easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1-Math.pow(1-e,5),easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1-Math.pow(-2*e+2,5)/2,easeInSine:e=>1-Math.cos(e*Math.PI/2),easeOutSine:e=>Math.sin(e*Math.PI/2),easeInOutSine:e=>-(Math.cos(Math.PI*e)-1)/2,easeInExpo:e=>0===e?0:Math.pow(2,10*e-10),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>0===e?0:1===e?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2,easeInCirc:e=>1-Math.sqrt(1-Math.pow(e,2)),easeOutCirc:e=>Math.sqrt(1-Math.pow(e-1,2)),easeInOutCirc:e=>e<.5?(1-Math.sqrt(1-Math.pow(2*e,2)))/2:(Math.sqrt(1-Math.pow(-2*e+2,2))+1)/2,easeInBack:e=>c3*e*e*e-c1*e*e,easeOutBack:e=>1+c3*Math.pow(e-1,3)+c1*Math.pow(e-1,2),easeInOutBack:e=>e<.5?Math.pow(2*e,2)*(2*(c2+1)*e-c2)/2:(Math.pow(2*e-2,2)*((c2+1)*(2*e-2)+c2)+2)/2,easeInElastic:e=>0===e?0:1===e?1:-Math.pow(2,10*e-10)*Math.sin((10*e-10.75)*c4),easeOutElastic:e=>0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin((10*e-.75)*c4)+1,easeInOutElastic:e=>0===e?0:1===e?1:e<.5?-Math.pow(2,20*e-10)*Math.sin((20*e-11.125)*c5)/2:Math.pow(2,-20*e+10)*Math.sin((20*e-11.125)*c5)/2+1,easeInBounce:e=>1-bounceOut(1-e),easeOutBounce:bounceOut,easeInOutBounce:e=>e<.5?(1-bounceOut(1-2*e))/2:(1+bounceOut(2*e-1))/2,steps:steps},$get=Symbol.for("FluidValue.get"),$observers=Symbol.for("FluidValue.observers"),hasFluidValue=e=>Boolean(e&&e[$get]),getFluidValue=e=>e&&e[$get]?e[$get]():e,getFluidObservers=e=>e[$observers]||null;function callFluidObserver(e,t){e.eventObserved?e.eventObserved(t):e(t)}function callFluidObservers(e,t){const r=e[$observers];r&&r.forEach((e=>{callFluidObserver(e,t)}))}var FluidValue=class{constructor(e){if(!e&&!(e=this.get))throw Error("Unknown getter");setFluidGetter(this,e)}},setFluidGetter=(e,t)=>setHidden(e,$get,t);function addFluidObserver(e,t){if(e[$get]){let r=e[$observers];r||setHidden(e,$observers,r=new Set),r.has(t)||(r.add(t),e.observerAdded&&e.observerAdded(r.size,t))}return t}function removeFluidObserver(e,t){const r=e[$observers];if(r&&r.has(t)){const n=r.size-1;n?r.delete(t):e[$observers]=null,e.observerRemoved&&e.observerRemoved(n,t)}}var setHidden=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,configurable:!0}),numberRegex=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,colorRegex=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,unitRegex=new RegExp("(".concat(numberRegex.source,")(%|[a-z]+)"),"i"),rgbaRegex$2=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,cssVariableRegex=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,variableToRgba=e=>{const[t,r]=parseCSSVariable(e);if(!t||isSSR())return e;const n=window.getComputedStyle(document.documentElement).getPropertyValue(t);if(n)return n.trim();if(r&&r.startsWith("--")){const t=window.getComputedStyle(document.documentElement).getPropertyValue(r);return t||e}return r&&cssVariableRegex.test(r)?variableToRgba(r):r||e},parseCSSVariable=e=>{const t=cssVariableRegex.exec(e);if(!t)return[,];const[,r,n]=t;return[r,n]},namedColorRegex,rgbaRound=(e,t,r,n,o)=>"rgba(".concat(Math.round(t),", ").concat(Math.round(r),", ").concat(Math.round(n),", ").concat(o,")"),createStringInterpolator2=e=>{namedColorRegex||(namedColorRegex=colors?new RegExp("(".concat(Object.keys(colors).join("|"),")(?!\\w)"),"g"):/^\b$/);const t=e.output.map((e=>getFluidValue(e).replace(cssVariableRegex,variableToRgba).replace(colorRegex,colorToRgba).replace(namedColorRegex,colorToRgba))),r=t.map((e=>e.match(numberRegex).map(Number))),n=r[0].map(((e,t)=>r.map((e=>{if(!(t in e))throw Error('The arity of each "output" value must be equal');return e[t]})))),o=n.map((t=>createInterpolator({...e,output:t})));return e=>{var r;const n=!unitRegex.test(t[0])&&(null==(r=t.find((e=>unitRegex.test(e))))?void 0:r.replace(numberRegex,""));let i=0;return t[0].replace(numberRegex,(()=>"".concat(o[i++](e)).concat(n||""))).replace(rgbaRegex$2,rgbaRound)}},prefix="react-spring: ",once$2=e=>{const t=e;let r=!1;if("function"!=typeof t)throw new TypeError("".concat(prefix,"once requires a function parameter"));return(...e)=>{r||(t(...e),r=!0)}},warnInterpolate=once$2(console.warn);function deprecateInterpolate(){warnInterpolate("".concat(prefix,'The "interpolate" function is deprecated in v9 (use "to" instead)'))}var warnDirectCall=once$2(console.warn);function deprecateDirectCall(){warnDirectCall("".concat(prefix,'Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions'))}function isAnimatedString(e){return is.str(e)&&("#"==e[0]||/\d/.test(e)||!isSSR()&&cssVariableRegex.test(e)||e in(colors||{}))}var useIsomorphicLayoutEffect=isSSR()?reactExports.useEffect:reactExports.useLayoutEffect,useIsMounted=()=>{const e=reactExports.useRef(!1);return useIsomorphicLayoutEffect((()=>(e.current=!0,()=>{e.current=!1})),[]),e};function useForceUpdate(){const e=reactExports.useState()[1],t=useIsMounted();return()=>{t.current&&e(Math.random())}}function useMemoOne(e,t){const[r]=reactExports.useState((()=>({inputs:t,result:e()}))),n=reactExports.useRef(),o=n.current;let i=o;if(i){Boolean(t&&i.inputs&&areInputsEqual(t,i.inputs))||(i={inputs:t,result:e()})}else i=r;return reactExports.useEffect((()=>{n.current=i,o==r&&(r.inputs=r.result=void 0)}),[i]),i.result}function areInputsEqual(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}var useOnce=e=>reactExports.useEffect(e,emptyDeps),emptyDeps=[];function usePrev(e){const t=reactExports.useRef();return reactExports.useEffect((()=>{t.current=e})),t.current}var $node=Symbol.for("Animated:node"),isAnimated=e=>!!e&&e[$node]===e,getAnimated=e=>e&&e[$node],setAnimated=(e,t)=>defineHidden(e,$node,t),getPayload=e=>e&&e[$node]&&e[$node].getPayload(),Animated=class{constructor(){setAnimated(this,this)}getPayload(){return this.payload||[]}},AnimatedValue=class extends Animated{constructor(e){super(),this._value=e,this.done=!0,this.durationProgress=0,is.num(this._value)&&(this.lastPosition=this._value)}static create(e){return new AnimatedValue(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,t){return is.num(e)&&(this.lastPosition=e,t&&(e=Math.round(e/t)*t,this.done&&(this.lastPosition=e))),this._value!==e&&(this._value=e,!0)}reset(){const{done:e}=this;this.done=!1,is.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}},AnimatedString=class extends AnimatedValue{constructor(e){super(0),this._string=null,this._toString=createInterpolator({output:[e,e]})}static create(e){return new AnimatedString(e)}getValue(){const e=this._string;return null==e?this._string=this._toString(this._value):e}setValue(e){if(is.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else{if(!super.setValue(e))return!1;this._string=null}return!0}reset(e){e&&(this._toString=createInterpolator({output:[this.getValue(),e]})),this._value=0,super.reset()}},TreeContext={dependencies:null},AnimatedObject=class extends Animated{constructor(e){super(),this.source=e,this.setValue(e)}getValue(e){const t={};return eachProp(this.source,((r,n)=>{isAnimated(r)?t[n]=r.getValue(e):hasFluidValue(r)?t[n]=getFluidValue(r):e||(t[n]=r)})),t}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&each(this.payload,(e=>e.reset()))}_makePayload(e){if(e){const t=new Set;return eachProp(e,this._addToPayload,t),Array.from(t)}}_addToPayload(e){TreeContext.dependencies&&hasFluidValue(e)&&TreeContext.dependencies.add(e);const t=getPayload(e);t&&each(t,(e=>this.add(e)))}},AnimatedArray=class extends AnimatedObject{constructor(e){super(e)}static create(e){return new AnimatedArray(e)}getValue(){return this.source.map((e=>e.getValue()))}setValue(e){const t=this.getPayload();return e.length==t.length?t.map(((t,r)=>t.setValue(e[r]))).some(Boolean):(super.setValue(e.map(makeAnimated)),!0)}};function makeAnimated(e){return(isAnimatedString(e)?AnimatedString:AnimatedValue).create(e)}function getAnimatedType(e){const t=getAnimated(e);return t?t.constructor:is.arr(e)?AnimatedArray:isAnimatedString(e)?AnimatedString:AnimatedValue}var withAnimated=(e,t)=>{const r=!is.fun(e)||e.prototype&&e.prototype.isReactComponent;return reactExports.forwardRef(((n,o)=>{const i=reactExports.useRef(null),a=r&&reactExports.useCallback((e=>{i.current=updateRef(o,e)}),[o]),[s,l]=getAnimatedState(n,t),c=useForceUpdate(),u=()=>{const e=i.current;if(r&&!e)return;!1===(!!e&&t.applyAnimatedValues(e,s.getValue(!0)))&&c()},d=new PropsObserver(u,l),h=reactExports.useRef();useIsomorphicLayoutEffect((()=>(h.current=d,each(l,(e=>addFluidObserver(e,d))),()=>{h.current&&(each(h.current.deps,(e=>removeFluidObserver(e,h.current))),raf.cancel(h.current.update))}))),reactExports.useEffect(u,[]),useOnce((()=>()=>{const e=h.current;each(e.deps,(t=>removeFluidObserver(t,e)))}));const p=t.getComponentProps(s.getValue());return reactExports.createElement(e,{...p,ref:a})}))},PropsObserver=class{constructor(e,t){this.update=e,this.deps=t}eventObserved(e){"change"==e.type&&raf.write(this.update)}};function getAnimatedState(e,t){const r=new Set;return TreeContext.dependencies=r,e.style&&(e={...e,style:t.createAnimatedStyle(e.style)}),e=new AnimatedObject(e),TreeContext.dependencies=null,[e,r]}function updateRef(e,t){return e&&(is.fun(e)?e(t):e.current=t),t}var cacheKey=Symbol.for("AnimatedComponent"),createHost=(e,{applyAnimatedValues:t=()=>!1,createAnimatedStyle:r=e=>new AnimatedObject(e),getComponentProps:n=e=>e}={})=>{const o={applyAnimatedValues:t,createAnimatedStyle:r,getComponentProps:n},i=e=>{const t=getDisplayName(e)||"Anonymous";return(e=is.str(e)?i[e]||(i[e]=withAnimated(e,o)):e[cacheKey]||(e[cacheKey]=withAnimated(e,o))).displayName="Animated(".concat(t,")"),e};return eachProp(e,((t,r)=>{is.arr(e)&&(r=getDisplayName(t)),i[r]=i(t)})),{animated:i}},getDisplayName=e=>is.str(e)?e:e&&is.str(e.displayName)?e.displayName:is.fun(e)&&e.name||null;function callProp(e,...t){return is.fun(e)?e(...t):e}var matchProp=(e,t)=>!0===e||!!(t&&e&&(is.fun(e)?e(t):toArray(e).includes(t))),resolveProp=(e,t)=>is.obj(e)?t&&e[t]:e,getDefaultProp=(e,t)=>!0===e.default?e[t]:e.default?e.default[t]:void 0,noopTransform=e=>e,getDefaultProps=(e,t=noopTransform)=>{let r=DEFAULT_PROPS;e.default&&!0!==e.default&&(e=e.default,r=Object.keys(e));const n={};for(const o of r){const r=t(e[o],o);is.und(r)||(n[o]=r)}return n},DEFAULT_PROPS=["config","onProps","onStart","onChange","onPause","onResume","onRest"],RESERVED_PROPS={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function getForwardProps(e){const t={};let r=0;if(eachProp(e,((e,n)=>{RESERVED_PROPS[n]||(t[n]=e,r++)})),r)return t}function inferTo(e){const t=getForwardProps(e);if(t){const r={to:t};return eachProp(e,((e,n)=>n in t||(r[n]=e))),r}return{...e}}function computeGoal(e){return e=getFluidValue(e),is.arr(e)?e.map(computeGoal):isAnimatedString(e)?globals_exports.createStringInterpolator({range:[0,1],output:[e,e]})(1):e}function hasProps(e){for(const t in e)return!0;return!1}function isAsyncTo(e){return is.fun(e)||is.arr(e)&&is.obj(e[0])}function detachRefs(e,t){var r;null==(r=e.ref)||r.delete(e),null==t||t.delete(e)}function replaceRef$1(e,t){var r;t&&e.ref!==t&&(null==(r=e.ref)||r.delete(e),t.add(e),e.ref=t)}var config={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},defaults$4={...config.default,mass:1,damping:1,easing:easings.linear,clamp:!1},AnimationConfig$1=class{constructor(){this.velocity=0,Object.assign(this,defaults$4)}};function mergeConfig(e,t,r){r&&(sanitizeConfig(r={...r},t),t={...r,...t}),sanitizeConfig(e,t),Object.assign(e,t);for(const a in defaults$4)null==e[a]&&(e[a]=defaults$4[a]);let{frequency:n,damping:o}=e;const{mass:i}=e;return is.und(n)||(n<.01&&(n=.01),o<0&&(o=0),e.tension=Math.pow(2*Math.PI/n,2)*i,e.friction=4*Math.PI*o*i/n),e}function sanitizeConfig(e,t){if(is.und(t.decay)){const r=!is.und(t.tension)||!is.und(t.friction);!r&&is.und(t.frequency)&&is.und(t.damping)&&is.und(t.mass)||(e.duration=void 0,e.decay=void 0),r&&(e.frequency=void 0)}else e.duration=void 0}var emptyArray=[],Animation=class{constructor(){this.changed=!1,this.values=emptyArray,this.toValues=null,this.fromValues=emptyArray,this.config=new AnimationConfig$1,this.immediate=!1}};function scheduleProps(e,{key:t,props:r,defaultProps:n,state:o,actions:i}){return new Promise(((a,s)=>{var l;let c,u,d=matchProp(null!=(l=r.cancel)?l:null==n?void 0:n.cancel,t);if(d)f();else{is.und(r.pause)||(o.paused=matchProp(r.pause,t));let e=null==n?void 0:n.pause;!0!==e&&(e=o.paused||matchProp(e,t)),c=callProp(r.delay||0,t),e?(o.resumeQueue.add(p),i.pause()):(i.resume(),p())}function h(){o.resumeQueue.add(p),o.timeouts.delete(u),u.cancel(),c=u.time-raf.now()}function p(){c>0&&!globals_exports.skipAnimation?(o.delayed=!0,u=raf.setTimeout(f,c),o.pauseQueue.add(h),o.timeouts.add(u)):f()}function f(){o.delayed&&(o.delayed=!1),o.pauseQueue.delete(h),o.timeouts.delete(u),e<=(o.cancelId||0)&&(d=!0);try{i.start({...r,callId:e,cancel:d},a)}catch(t){s(t)}}}))}var getCombinedResult=(e,t)=>1==t.length?t[0]:t.some((e=>e.cancelled))?getCancelledResult(e.get()):t.every((e=>e.noop))?getNoopResult(e.get()):getFinishedResult(e.get(),t.every((e=>e.finished))),getNoopResult=e=>({value:e,noop:!0,finished:!0,cancelled:!1}),getFinishedResult=(e,t,r=!1)=>({value:e,finished:t,cancelled:r}),getCancelledResult=e=>({value:e,cancelled:!0,finished:!1});function runAsync(e,t,r,n){const{callId:o,parentId:i,onRest:a}=t,{asyncTo:s,promise:l}=r;return i||e!==s||t.reset?r.promise=(async()=>{r.asyncId=o,r.asyncTo=e;const c=getDefaultProps(t,((e,t)=>"onRest"===t?void 0:e));let u,d;const h=new Promise(((e,t)=>(u=e,d=t))),p=e=>{const t=o<=(r.cancelId||0)&&getCancelledResult(n)||o!==r.asyncId&&getFinishedResult(n,!1);if(t)throw e.result=t,d(e),e},f=(e,t)=>{const i=new BailSignal,a=new SkipAnimationSignal;return(async()=>{if(globals_exports.skipAnimation)throw stopAsync(r),a.result=getFinishedResult(n,!1),d(a),a;p(i);const s=is.obj(e)?{...e}:{...t,to:e};s.parentId=o,eachProp(c,((e,t)=>{is.und(s[t])&&(s[t]=e)}));const l=await n.start(s);return p(i),r.paused&&await new Promise((e=>{r.resumeQueue.add(e)})),l})()};let g;if(globals_exports.skipAnimation)return stopAsync(r),getFinishedResult(n,!1);try{let t;t=is.arr(e)?(async e=>{for(const t of e)await f(t)})(e):Promise.resolve(e(f,n.stop.bind(n))),await Promise.all([t.then(u),h]),g=getFinishedResult(n.get(),!0,!1)}catch(m){if(m instanceof BailSignal)g=m.result;else{if(!(m instanceof SkipAnimationSignal))throw m;g=m.result}}finally{o==r.asyncId&&(r.asyncId=i,r.asyncTo=i?s:void 0,r.promise=i?l:void 0)}return is.fun(a)&&raf.batchedUpdates((()=>{a(g,n,n.item)})),g})():l}function stopAsync(e,t){flush(e.timeouts,(e=>e.cancel())),e.pauseQueue.clear(),e.resumeQueue.clear(),e.asyncId=e.asyncTo=e.promise=void 0,t&&(e.cancelId=t)}var BailSignal=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},SkipAnimationSignal=class extends Error{constructor(){super("SkipAnimationSignal")}},isFrameValue=e=>e instanceof FrameValue,nextId=1,FrameValue=class extends FluidValue{constructor(){super(...arguments),this.id=nextId++,this._priority=0}get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){const e=getAnimated(this);return e&&e.getValue()}to(...e){return globals_exports.to(this,e)}interpolate(...e){return deprecateInterpolate(),globals_exports.to(this,e)}toJSON(){return this.get()}observerAdded(e){1==e&&this._attach()}observerRemoved(e){0==e&&this._detach()}_attach(){}_detach(){}_onChange(e,t=!1){callFluidObservers(this,{type:"change",parent:this,value:e,idle:t})}_onPriorityChange(e){this.idle||frameLoop.sort(this),callFluidObservers(this,{type:"priority",parent:this,priority:e})}},$P=Symbol.for("SpringPhase"),HAS_ANIMATED=1,IS_ANIMATING=2,IS_PAUSED=4,hasAnimated=e=>(e[$P]&HAS_ANIMATED)>0,isAnimating=e=>(e[$P]&IS_ANIMATING)>0,isPaused=e=>(e[$P]&IS_PAUSED)>0,setActiveBit=(e,t)=>t?e[$P]|=IS_ANIMATING|HAS_ANIMATED:e[$P]&=~IS_ANIMATING,setPausedBit=(e,t)=>t?e[$P]|=IS_PAUSED:e[$P]&=~IS_PAUSED,SpringValue=class extends FrameValue{constructor(e,t){if(super(),this.animation=new Animation,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!is.und(e)||!is.und(t)){const r=is.obj(e)?{...e}:{...t,from:e};is.und(r.default)&&(r.default=!0),this.start(r)}}get idle(){return!(isAnimating(this)||this._state.asyncTo)||isPaused(this)}get goal(){return getFluidValue(this.animation.to)}get velocity(){const e=getAnimated(this);return e instanceof AnimatedValue?e.lastVelocity||0:e.getPayload().map((e=>e.lastVelocity||0))}get hasAnimated(){return hasAnimated(this)}get isAnimating(){return isAnimating(this)}get isPaused(){return isPaused(this)}get isDelayed(){return this._state.delayed}advance(e){let t=!0,r=!1;const n=this.animation;let{toValues:o}=n;const{config:i}=n,a=getPayload(n.to);!a&&hasFluidValue(n.to)&&(o=toArray(getFluidValue(n.to))),n.values.forEach(((s,l)=>{if(s.done)return;const c=s.constructor==AnimatedString?1:a?a[l].lastPosition:o[l];let u=n.immediate,d=c;if(!u){if(d=s.lastPosition,i.tension<=0)return void(s.done=!0);let t=s.elapsedTime+=e;const r=n.fromValues[l],o=null!=s.v0?s.v0:s.v0=is.arr(i.velocity)?i.velocity[l]:i.velocity;let a;const h=i.precision||(r==c?.005:Math.min(1,.001*Math.abs(c-r)));if(is.und(i.duration))if(i.decay){const e=!0===i.decay?.998:i.decay,n=Math.exp(-(1-e)*t);d=r+o/(1-e)*(1-n),u=Math.abs(s.lastPosition-d)<=h,a=o*n}else{a=null==s.lastVelocity?o:s.lastVelocity;const t=i.restVelocity||h/10,n=i.clamp?0:i.bounce,l=!is.und(n),p=r==c?s.v0>0:r<c;let f,g=!1;const m=1,y=Math.ceil(e/m);for(let e=0;e<y&&(f=Math.abs(a)>t,f||(u=Math.abs(c-d)<=h,!u));++e){l&&(g=d==c||d>c==p,g&&(a=-a*n,d=c));a+=(1e-6*-i.tension*(d-c)+.001*-i.friction*a)/i.mass*m,d+=a*m}}else{let n=1;i.duration>0&&(this._memoizedDuration!==i.duration&&(this._memoizedDuration=i.duration,s.durationProgress>0&&(s.elapsedTime=i.duration*s.durationProgress,t=s.elapsedTime+=e)),n=(i.progress||0)+t/this._memoizedDuration,n=n>1?1:n<0?0:n,s.durationProgress=n),d=r+i.easing(n)*(c-r),a=(d-s.lastPosition)/e,u=1==n}s.lastVelocity=a,Number.isNaN(d)&&(u=!0)}a&&!a[l].done&&(u=!1),u?s.done=!0:t=!1,s.setValue(d,i.round)&&(r=!0)}));const s=getAnimated(this),l=s.getValue();if(t){const e=getFluidValue(n.to);l===e&&!r||i.decay?r&&i.decay&&this._onChange(l):(s.setValue(e),this._onChange(e)),this._stop()}else r&&this._onChange(l)}set(e){return raf.batchedUpdates((()=>{this._stop(),this._focus(e),this._set(e)})),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(isAnimating(this)){const{to:e,config:t}=this.animation;raf.batchedUpdates((()=>{this._onStart(),t.decay||this._set(e,!1),this._stop()}))}return this}update(e){return(this.queue||(this.queue=[])).push(e),this}start(e,t){let r;return is.und(e)?(r=this.queue||[],this.queue=[]):r=[is.obj(e)?e:{...t,to:e}],Promise.all(r.map((e=>this._update(e)))).then((e=>getCombinedResult(this,e)))}stop(e){const{to:t}=this.animation;return this._focus(this.get()),stopAsync(this._state,e&&this._lastCallId),raf.batchedUpdates((()=>this._stop(t,e))),this}reset(){this._update({reset:!0})}eventObserved(e){"change"==e.type?this._start():"priority"==e.type&&(this.priority=e.priority+1)}_prepareNode(e){const t=this.key||"";let{to:r,from:n}=e;r=is.obj(r)?r[t]:r,(null==r||isAsyncTo(r))&&(r=void 0),n=is.obj(n)?n[t]:n,null==n&&(n=void 0);const o={to:r,from:n};return hasAnimated(this)||(e.reverse&&([r,n]=[n,r]),n=getFluidValue(n),is.und(n)?getAnimated(this)||this._set(r):this._set(n)),o}_update({...e},t){const{key:r,defaultProps:n}=this;e.default&&Object.assign(n,getDefaultProps(e,((e,t)=>/^on/.test(t)?resolveProp(e,r):e))),mergeActiveFn(this,e,"onProps"),sendEvent(this,"onProps",e,this);const o=this._prepareNode(e);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const i=this._state;return scheduleProps(++this._lastCallId,{key:r,props:e,defaultProps:n,state:i,actions:{pause:()=>{isPaused(this)||(setPausedBit(this,!0),flushCalls(i.pauseQueue),sendEvent(this,"onPause",getFinishedResult(this,checkFinished(this,this.animation.to)),this))},resume:()=>{isPaused(this)&&(setPausedBit(this,!1),isAnimating(this)&&this._resume(),flushCalls(i.resumeQueue),sendEvent(this,"onResume",getFinishedResult(this,checkFinished(this,this.animation.to)),this))},start:this._merge.bind(this,o)}}).then((r=>{if(e.loop&&r.finished&&(!t||!r.noop)){const t=createLoopUpdate(e);if(t)return this._update(t,!0)}return r}))}_merge(e,t,r){if(t.cancel)return this.stop(!0),r(getCancelledResult(this));const n=!is.und(e.to),o=!is.und(e.from);if(n||o){if(!(t.callId>this._lastToId))return r(getCancelledResult(this));this._lastToId=t.callId}const{key:i,defaultProps:a,animation:s}=this,{to:l,from:c}=s;let{to:u=l,from:d=c}=e;!o||n||t.default&&!is.und(u)||(u=d),t.reverse&&([u,d]=[d,u]);const h=!isEqual$1(d,c);h&&(s.from=d),d=getFluidValue(d);const p=!isEqual$1(u,l);p&&this._focus(u);const f=isAsyncTo(t.to),{config:g}=s,{decay:m,velocity:y}=g;(n||o)&&(g.velocity=0),t.config&&!f&&mergeConfig(g,callProp(t.config,i),t.config!==a.config?callProp(a.config,i):void 0);let v=getAnimated(this);if(!v||is.und(u))return r(getFinishedResult(this,!0));const _=is.und(t.reset)?o&&!t.default:!is.und(d)&&matchProp(t.reset,i),b=_?d:this.get(),C=computeGoal(u),E=is.num(C)||is.arr(C)||isAnimatedString(C),T=!f&&(!E||matchProp(a.immediate||t.immediate,i));if(p){const e=getAnimatedType(u);if(e!==v.constructor){if(!T)throw Error("Cannot animate between ".concat(v.constructor.name," and ").concat(e.name,', as the "to" prop suggests'));v=this._set(C)}}const S=v.constructor;let P=hasFluidValue(u),w=!1;if(!P){const e=_||!hasAnimated(this)&&h;(p||e)&&(w=isEqual$1(computeGoal(b),C),P=!w),(isEqual$1(s.immediate,T)||T)&&isEqual$1(g.decay,m)&&isEqual$1(g.velocity,y)||(P=!0)}if(w&&isAnimating(this)&&(s.changed&&!_?P=!0:P||this._stop(l)),!f&&((P||hasFluidValue(l))&&(s.values=v.getPayload(),s.toValues=hasFluidValue(u)?null:S==AnimatedString?[1]:toArray(C)),s.immediate!=T&&(s.immediate=T,T||_||this._set(l)),P)){const{onRest:e}=s;each(ACTIVE_EVENTS,(e=>mergeActiveFn(this,t,e)));const n=getFinishedResult(this,checkFinished(this,l));flushCalls(this._pendingCalls,n),this._pendingCalls.add(r),s.changed&&raf.batchedUpdates((()=>{var t;s.changed=!_,null==e||e(n,this),_?callProp(a.onRest,n):null==(t=s.onStart)||t.call(s,n,this)}))}_&&this._set(b),f?r(runAsync(t.to,t,this._state,this)):P?this._start():isAnimating(this)&&!p?this._pendingCalls.add(r):r(getNoopResult(b))}_focus(e){const t=this.animation;e!==t.to&&(getFluidObservers(this)&&this._detach(),t.to=e,getFluidObservers(this)&&this._attach())}_attach(){let e=0;const{to:t}=this.animation;hasFluidValue(t)&&(addFluidObserver(t,this),isFrameValue(t)&&(e=t.priority+1)),this.priority=e}_detach(){const{to:e}=this.animation;hasFluidValue(e)&&removeFluidObserver(e,this)}_set(e,t=!0){const r=getFluidValue(e);if(!is.und(r)){const e=getAnimated(this);if(!e||!isEqual$1(r,e.getValue())){const n=getAnimatedType(r);e&&e.constructor==n?e.setValue(r):setAnimated(this,n.create(r)),e&&raf.batchedUpdates((()=>{this._onChange(r,t)}))}}return getAnimated(this)}_onStart(){const e=this.animation;e.changed||(e.changed=!0,sendEvent(this,"onStart",getFinishedResult(this,checkFinished(this,e.to)),this))}_onChange(e,t){t||(this._onStart(),callProp(this.animation.onChange,e,this)),callProp(this.defaultProps.onChange,e,this),super._onChange(e,t)}_start(){const e=this.animation;getAnimated(this).reset(getFluidValue(e.to)),e.immediate||(e.fromValues=e.values.map((e=>e.lastPosition))),isAnimating(this)||(setActiveBit(this,!0),isPaused(this)||this._resume())}_resume(){globals_exports.skipAnimation?this.finish():frameLoop.start(this)}_stop(e,t){if(isAnimating(this)){setActiveBit(this,!1);const r=this.animation;each(r.values,(e=>{e.done=!0})),r.toValues&&(r.onChange=r.onPause=r.onResume=void 0),callFluidObservers(this,{type:"idle",parent:this});const n=t?getCancelledResult(this.get()):getFinishedResult(this.get(),checkFinished(this,null!=e?e:r.to));flushCalls(this._pendingCalls,n),r.changed&&(r.changed=!1,sendEvent(this,"onRest",n,this))}}};function checkFinished(e,t){const r=computeGoal(t);return isEqual$1(computeGoal(e.get()),r)}function createLoopUpdate(e,t=e.loop,r=e.to){const n=callProp(t);if(n){const o=!0!==n&&inferTo(n),i=(o||e).reverse,a=!o||o.reset;return createUpdate({...e,loop:t,default:!1,pause:void 0,to:!i||isAsyncTo(r)?r:void 0,from:a?e.from:void 0,reset:a,...o})}}function createUpdate(e){const{to:t,from:r}=e=inferTo(e),n=new Set;return is.obj(t)&&findDefined(t,n),is.obj(r)&&findDefined(r,n),e.keys=n.size?Array.from(n):null,e}function declareUpdate(e){const t=createUpdate(e);return is.und(t.default)&&(t.default=getDefaultProps(t)),t}function findDefined(e,t){eachProp(e,((e,r)=>null!=e&&t.add(r)))}var ACTIVE_EVENTS=["onStart","onRest","onChange","onPause","onResume"];function mergeActiveFn(e,t,r){e.animation[r]=t[r]!==getDefaultProp(t,r)?resolveProp(t[r],e.key):void 0}function sendEvent(e,t,...r){var n,o,i,a;null==(o=(n=e.animation)[t])||o.call(n,...r),null==(a=(i=e.defaultProps)[t])||a.call(i,...r)}var BATCHED_EVENTS=["onStart","onChange","onRest"],nextId2=1,Controller=class{constructor(e,t){this.id=nextId2++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),t&&(this._flush=t),e&&this.start({default:!0,...e})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every((e=>e.idle&&!e.isDelayed&&!e.isPaused))}get item(){return this._item}set item(e){this._item=e}get(){const e={};return this.each(((t,r)=>e[r]=t.get())),e}set(e){for(const t in e){const r=e[t];is.und(r)||this.springs[t].set(r)}}update(e){return e&&this.queue.push(createUpdate(e)),this}start(e){let{queue:t}=this;return e?t=toArray(e).map(createUpdate):this.queue=[],this._flush?this._flush(this,t):(prepareKeys(this,t),flushUpdateQueue(this,t))}stop(e,t){if(e!==!!e&&(t=e),t){const r=this.springs;each(toArray(t),(t=>r[t].stop(!!e)))}else stopAsync(this._state,this._lastAsyncId),this.each((t=>t.stop(!!e)));return this}pause(e){if(is.und(e))this.start({pause:!0});else{const t=this.springs;each(toArray(e),(e=>t[e].pause()))}return this}resume(e){if(is.und(e))this.start({pause:!1});else{const t=this.springs;each(toArray(e),(e=>t[e].resume()))}return this}each(e){eachProp(this.springs,e)}_onFrame(){const{onStart:e,onChange:t,onRest:r}=this._events,n=this._active.size>0,o=this._changed.size>0;(n&&!this._started||o&&!this._started)&&(this._started=!0,flush(e,(([e,t])=>{t.value=this.get(),e(t,this,this._item)})));const i=!n&&this._started,a=o||i&&r.size?this.get():null;o&&t.size&&flush(t,(([e,t])=>{t.value=a,e(t,this,this._item)})),i&&(this._started=!1,flush(r,(([e,t])=>{t.value=a,e(t,this,this._item)})))}eventObserved(e){if("change"==e.type)this._changed.add(e.parent),e.idle||this._active.add(e.parent);else{if("idle"!=e.type)return;this._active.delete(e.parent)}raf.onFrame(this._onFrame)}};function flushUpdateQueue(e,t){return Promise.all(t.map((t=>flushUpdate(e,t)))).then((t=>getCombinedResult(e,t)))}async function flushUpdate(e,t,r){const{keys:n,to:o,from:i,loop:a,onRest:s,onResolve:l}=t,c=is.obj(t.default)&&t.default;a&&(t.loop=!1),!1===o&&(t.to=null),!1===i&&(t.from=null);const u=is.arr(o)||is.fun(o)?o:void 0;u?(t.to=void 0,t.onRest=void 0,c&&(c.onRest=void 0)):each(BATCHED_EVENTS,(r=>{const n=t[r];if(is.fun(n)){const o=e._events[r];t[r]=({finished:e,cancelled:t})=>{const r=o.get(n);r?(e||(r.finished=!1),t&&(r.cancelled=!0)):o.set(n,{value:null,finished:e||!1,cancelled:t||!1})},c&&(c[r]=t[r])}}));const d=e._state;t.pause===!d.paused?(d.paused=t.pause,flushCalls(t.pause?d.pauseQueue:d.resumeQueue)):d.paused&&(t.pause=!0);const h=(n||Object.keys(e.springs)).map((r=>e.springs[r].start(t))),p=!0===t.cancel||!0===getDefaultProp(t,"cancel");(u||p&&d.asyncId)&&h.push(scheduleProps(++e._lastAsyncId,{props:t,state:d,actions:{pause:noop,resume:noop,start(t,r){p?(stopAsync(d,e._lastAsyncId),r(getCancelledResult(e))):(t.onRest=s,r(runAsync(u,t,d,e)))}}})),d.paused&&await new Promise((e=>{d.resumeQueue.add(e)}));const f=getCombinedResult(e,await Promise.all(h));if(a&&f.finished&&(!r||!f.noop)){const r=createLoopUpdate(t,a,o);if(r)return prepareKeys(e,[r]),flushUpdate(e,r,!0)}return l&&raf.batchedUpdates((()=>l(f,e,e.item))),f}function getSprings(e,t){const r={...e.springs};return t&&each(toArray(t),(e=>{is.und(e.keys)&&(e=createUpdate(e)),is.obj(e.to)||(e={...e,to:void 0}),prepareSprings(r,e,(e=>createSpring(e)))})),setSprings(e,r),r}function setSprings(e,t){eachProp(t,((t,r)=>{e.springs[r]||(e.springs[r]=t,addFluidObserver(t,e))}))}function createSpring(e,t){const r=new SpringValue;return r.key=e,t&&addFluidObserver(r,t),r}function prepareSprings(e,t,r){t.keys&&each(t.keys,(n=>{(e[n]||(e[n]=r(n)))._prepareNode(t)}))}function prepareKeys(e,t){each(t,(t=>{prepareSprings(e.springs,t,(t=>createSpring(t,e)))}))}var SpringContext=({children:e,...t})=>{const r=reactExports.useContext(ctx),n=t.pause||!!r.pause,o=t.immediate||!!r.immediate;t=useMemoOne((()=>({pause:n,immediate:o})),[n,o]);const{Provider:i}=ctx;return reactExports.createElement(i,{value:t},e)},ctx=makeContext(SpringContext,{});function makeContext(e,t){return Object.assign(e,reactExports.createContext(t)),e.Provider._context=e,e.Consumer._context=e,e}SpringContext.Provider=ctx.Provider,SpringContext.Consumer=ctx.Consumer;var SpringRef=()=>{const e=[],t=function(t){deprecateDirectCall();const n=[];return each(e,((e,o)=>{if(is.und(t))n.push(e.start());else{const i=r(t,e,o);i&&n.push(e.start(i))}})),n};t.current=e,t.add=function(t){e.includes(t)||e.push(t)},t.delete=function(t){const r=e.indexOf(t);~r&&e.splice(r,1)},t.pause=function(){return each(e,(e=>e.pause(...arguments))),this},t.resume=function(){return each(e,(e=>e.resume(...arguments))),this},t.set=function(t){each(e,((e,r)=>{const n=is.fun(t)?t(r,e):t;n&&e.set(n)}))},t.start=function(t){const r=[];return each(e,((e,n)=>{if(is.und(t))r.push(e.start());else{const o=this._getProps(t,e,n);o&&r.push(e.start(o))}})),r},t.stop=function(){return each(e,(e=>e.stop(...arguments))),this},t.update=function(t){return each(e,((e,r)=>e.update(this._getProps(t,e,r)))),this};const r=function(e,t,r){return is.fun(e)?e(r,t):e};return t._getProps=r,t};function useSprings(e,t,r){const n=is.fun(t)&&t;n&&!r&&(r=[]);const o=reactExports.useMemo((()=>n||3==arguments.length?SpringRef():void 0),[]),i=reactExports.useRef(0),a=useForceUpdate(),s=reactExports.useMemo((()=>({ctrls:[],queue:[],flush(e,t){const r=getSprings(e,t);return i.current>0&&!s.queue.length&&!Object.keys(r).some((t=>!e.springs[t]))?flushUpdateQueue(e,t):new Promise((n=>{setSprings(e,r),s.queue.push((()=>{n(flushUpdateQueue(e,t))})),a()}))}})),[]),l=reactExports.useRef([...s.ctrls]),c=[],u=usePrev(e)||0;function d(e,r){for(let o=e;o<r;o++){const e=l.current[o]||(l.current[o]=new Controller(null,s.flush)),r=n?n(o,e):t[o];r&&(c[o]=declareUpdate(r))}}reactExports.useMemo((()=>{each(l.current.slice(e,u),(e=>{detachRefs(e,o),e.stop(!0)})),l.current.length=e,d(u,e)}),[e]),reactExports.useMemo((()=>{d(0,Math.min(u,e))}),r);const h=l.current.map(((e,t)=>getSprings(e,c[t]))),p=reactExports.useContext(SpringContext),f=usePrev(p),g=p!==f&&hasProps(p);useIsomorphicLayoutEffect((()=>{i.current++,s.ctrls=l.current;const{queue:e}=s;e.length&&(s.queue=[],each(e,(e=>e()))),each(l.current,((e,t)=>{null==o||o.add(e),g&&e.start({default:p});const r=c[t];r&&(replaceRef$1(e,r.ref),e.ref?e.queue.push(r):e.start(r))}))})),useOnce((()=>()=>{each(s.ctrls,(e=>e.stop(!0)))}));const m=h.map((e=>({...e})));return o?[m,o]:m}function useSpring(e,t){const r=is.fun(e),[[n],o]=useSprings(1,r?e:[e],r?[]:t);return r||2==arguments.length?[n,o]:n}var Interpolation=class extends FrameValue{constructor(e,t){super(),this.source=e,this.idle=!0,this._active=new Set,this.calc=createInterpolator(...t);const r=this._get(),n=getAnimatedType(r);setAnimated(this,n.create(r))}advance(e){const t=this._get();isEqual$1(t,this.get())||(getAnimated(this).setValue(t),this._onChange(t,this.idle)),!this.idle&&checkIdle(this._active)&&becomeIdle(this)}_get(){const e=is.arr(this.source)?this.source.map(getFluidValue):toArray(getFluidValue(this.source));return this.calc(...e)}_start(){this.idle&&!checkIdle(this._active)&&(this.idle=!1,each(getPayload(this),(e=>{e.done=!1})),globals_exports.skipAnimation?(raf.batchedUpdates((()=>this.advance())),becomeIdle(this)):frameLoop.start(this))}_attach(){let e=1;each(toArray(this.source),(t=>{hasFluidValue(t)&&addFluidObserver(t,this),isFrameValue(t)&&(t.idle||this._active.add(t),e=Math.max(e,t.priority+1))})),this.priority=e,this._start()}_detach(){each(toArray(this.source),(e=>{hasFluidValue(e)&&removeFluidObserver(e,this)})),this._active.clear(),becomeIdle(this)}eventObserved(e){"change"==e.type?e.idle?this.advance():(this._active.add(e.parent),this._start()):"idle"==e.type?this._active.delete(e.parent):"priority"==e.type&&(this.priority=toArray(this.source).reduce(((e,t)=>Math.max(e,(isFrameValue(t)?t.priority:0)+1)),0))}};function isIdle(e){return!1!==e.idle}function checkIdle(e){return!e.size||Array.from(e).every(isIdle)}function becomeIdle(e){e.idle||(e.idle=!0,each(getPayload(e),(e=>{e.done=!0})),callFluidObservers(e,{type:"idle",parent:e}))}globals_exports.assign({createStringInterpolator:createStringInterpolator2,to:(e,t)=>new Interpolation(e,t)});var isCustomPropRE=/^--/;function dangerousStyleValue(e,t){return null==t||"boolean"==typeof t||""===t?"":"number"!=typeof t||0===t||isCustomPropRE.test(e)||isUnitlessNumber.hasOwnProperty(e)&&isUnitlessNumber[e]?(""+t).trim():t+"px"}var attributeCache={};function applyAnimatedValues(e,t){if(!e.nodeType||!e.setAttribute)return!1;const r="filter"===e.nodeName||e.parentNode&&"filter"===e.parentNode.nodeName,{className:n,style:o,children:i,scrollTop:a,scrollLeft:s,viewBox:l,...c}=t,u=Object.values(c),d=Object.keys(c).map((t=>r||e.hasAttribute(t)?t:attributeCache[t]||(attributeCache[t]=t.replace(/([A-Z])/g,(e=>"-"+e.toLowerCase())))));void 0!==i&&(e.textContent=i);for(const h in o)if(o.hasOwnProperty(h)){const t=dangerousStyleValue(h,o[h]);isCustomPropRE.test(h)?e.style.setProperty(h,t):e.style[h]=t}d.forEach(((t,r)=>{e.setAttribute(t,u[r])})),void 0!==n&&(e.className=n),void 0!==a&&(e.scrollTop=a),void 0!==s&&(e.scrollLeft=s),void 0!==l&&e.setAttribute("viewBox",l)}var isUnitlessNumber={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},prefixKey=(e,t)=>e+t.charAt(0).toUpperCase()+t.substring(1),prefixes=["Webkit","Ms","Moz","O"];isUnitlessNumber=Object.keys(isUnitlessNumber).reduce(((e,t)=>(prefixes.forEach((r=>e[prefixKey(r,t)]=e[t])),e)),isUnitlessNumber);var domTransforms=/^(matrix|translate|scale|rotate|skew)/,pxTransforms=/^(translate)/,degTransforms=/^(rotate|skew)/,addUnit=(e,t)=>is.num(e)&&0!==e?e+t:e,isValueIdentity=(e,t)=>is.arr(e)?e.every((e=>isValueIdentity(e,t))):is.num(e)?e===t:parseFloat(e)===t,AnimatedStyle=class extends AnimatedObject{constructor({x:e,y:t,z:r,...n}){const o=[],i=[];(e||t||r)&&(o.push([e||0,t||0,r||0]),i.push((e=>["translate3d(".concat(e.map((e=>addUnit(e,"px"))).join(","),")"),isValueIdentity(e,0)]))),eachProp(n,((e,t)=>{if("transform"===t)o.push([e||""]),i.push((e=>[e,""===e]));else if(domTransforms.test(t)){if(delete n[t],is.und(e))return;const r=pxTransforms.test(t)?"px":degTransforms.test(t)?"deg":"";o.push(toArray(e)),i.push("rotate3d"===t?([e,t,n,o])=>["rotate3d(".concat(e,",").concat(t,",").concat(n,",").concat(addUnit(o,r),")"),isValueIdentity(o,0)]:e=>["".concat(t,"(").concat(e.map((e=>addUnit(e,r))).join(","),")"),isValueIdentity(e,t.startsWith("scale")?1:0)])}})),o.length&&(n.transform=new FluidTransform(o,i)),super(n)}},FluidTransform=class extends FluidValue{constructor(e,t){super(),this.inputs=e,this.transforms=t,this._value=null}get(){return this._value||(this._value=this._get())}_get(){let e="",t=!0;return each(this.inputs,((r,n)=>{const o=getFluidValue(r[0]),[i,a]=this.transforms[n](is.arr(o)?o:r.map(getFluidValue));e+=" "+i,t=t&&a})),t?"none":e}observerAdded(e){1==e&&each(this.inputs,(e=>each(e,(e=>hasFluidValue(e)&&addFluidObserver(e,this)))))}observerRemoved(e){0==e&&each(this.inputs,(e=>each(e,(e=>hasFluidValue(e)&&removeFluidObserver(e,this)))))}eventObserved(e){"change"==e.type&&(this._value=null),callFluidObservers(this,e)}},primitives=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"];globals_exports.assign({batchedUpdates:reactDomExports.unstable_batchedUpdates,createStringInterpolator:createStringInterpolator2,colors:colors2});var host=createHost(primitives,{applyAnimatedValues:applyAnimatedValues,createAnimatedStyle:e=>new AnimatedStyle(e),getComponentProps:({scrollTop:e,scrollLeft:t,...r})=>r}),animated=host.animated,dist={};const require$$1=getAugmentedNamespace(ResizeObserver_es);Object.defineProperty(dist,"__esModule",{value:!0});var useSize_1=dist.useSize=useSize$1,_react=reactExports;function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(l){o=!0,i=l}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}function _arrayWithHoles(e){if(Array.isArray(e))return e}function useSize$1(e){var t=(0,_react.useRef)(),r=_slicedToArray((0,_react.useState)(0),2);r[0];var n=r[1],o=_slicedToArray((0,_react.useState)({width:null,height:null}),2),i=o[0],a=o[1];return(0,_react.useEffect)((function(){var e=window.ResizeObserver||require$$1.default;return t.current=new e((function(e){var t=e[0].contentRect,r=t.width,n=t.height;a((function(e){return e.width!==r||e.height!==n?{width:r,height:n}:e}))})),function(){return t.current.disconnect()}}),[]),(0,_react.useEffect)((function(){var r=e.current;return r&&(t.current.observe(r),window.setTimeout((function(){return n((function(e){return e+1}))}),0)),function(){return r&&t.current.unobserve(r)}}),[t,e]),i}const ButtonItem=e=>{const{className:t,disabled:r=!1,vertical:n=!1,active:o=!1,image:i,value:a,type:s,style:l,wrapperStyle:c,children:u,onClick:d,...h}=e;return jsx("div",{className:classNames$1("duchamp-button-wrapper",{"button-wrapper-active":o}),style:c,...h,children:jsxs("div",{className:classNames$1("duchamp-button-item",t,{vertical:n,active:o,disabled:r}),style:l,onClick:()=>{r||d&&d(a)},children:[s===BUTTON_GROUP_TYPE.IMAGE_TEXT&&jsx("div",{className:"duchamp-button-item-image",style:i?{height:i.height,width:i.width}:{flex:1},children:i&&i.src?jsx("img",{src:i.src,height:i.height,width:i.width,alt:"",style:{objectFit:"contain"}}):jsx("div",{})}),jsx("div",{className:"duchamp-button-item-content",children:u})]})})},useArrowProps=e=>{const{vertical:t,listWrapperRef:r,animateVerticalScroll:n,animateHorizontalScroll:o}=e,{x:i,y:a}=useScroll(r),s=getTargetElement$2(r);return{leftIconDisabled:t?0===a:0===i,rightIconDisabled:!!s&&(t?a+s.clientHeight>=s.scrollHeight:i+s.clientWidth>=s.scrollWidth),onLeftIconClick:t?n:o,onRightIconClick:t?n:o}},useButtonAnimate=e=>{const{activeIndex:t,listWrapperRef:r,activeLineRef:n,activeLineMode:o}=e,i=getTargetElement$2(r),a=getTargetElement$2(n),[s,l]=useSpring((()=>({x:0,y:0,width:0,height:0,config:{tension:300,clamp:!0}}))),[c,u]=useSpring((()=>({scrollLeft:0,scrollTop:0,config:{tension:300,clamp:!0}})));return{activeLineOptions:s,scrollOptions:c,activeLineAnimateX:function(e=!1){if(!i)return;if(isNil$4(t))return void l.start({x:0,width:0,immediate:!0});if(!a)return;const r=i.children.item(t+1);if(!r)return;const n=r.children.item(0),s=n.offsetLeft,c=n.offsetWidth,u=r.offsetLeft,d=r.offsetWidth,h=a.offsetWidth;let p=0,f=0;"auto"===o?(p=s,f=c):"full"===o?(p=u,f=d):p=s+(c-h)/2,l.start({x:p,width:f,immediate:e})},activeLineAnimateY:function(e=!1){if(!i)return;if(isNil$4(t))return void l.start({y:0,height:0,immediate:!0});if(!a)return;const r=i.children.item(t+1);if(!r)return;const n=r.children.item(0),s=n.offsetTop,c=n.offsetHeight,u=r.offsetTop,d=r.offsetHeight,h=a.offsetHeight;let p=0,f=0;"auto"===o?(p=s,f=c):"full"===o?(p=u,f=d):p=s+(c-h)/2,l.start({y:p,height:f,immediate:e})},animateHorizontalScroll:function(e,t=!1){if(!i)return;const r=i.offsetWidth,n=i.scrollLeft;if(i.scrollWidth-r<=0)return;let o;o="left"===e?n-r:n+r,u.start({scrollLeft:o,from:{scrollLeft:n},immediate:t})},animateVerticalScroll:function(e,t=!1){if(!i)return;const r=i.offsetHeight,n=i.scrollTop;if(i.scrollHeight-r<=0)return;let o;o="up"===e?n-r:n+r,u.start({scrollTop:o,from:{scrollTop:n},immediate:t})}}},TAB_CARD_SIZE_MULTIPLE$1=2.5,TEXT_ALIGN_ITEM_MAP={[BUTTON_GROUP_TEXT_ALIGN.LEFT]:"left",[BUTTON_GROUP_TEXT_ALIGN.CENTER]:"center",[BUTTON_GROUP_TEXT_ALIGN.RIGHT]:"right"};function isFragment(e){return reactExports.isValidElement(e)&&e.type===reactExports.Fragment}function getValues(e){return isNil$4(e)?[]:isArray$d(e)?e:[e]}function traverseReactNode(e,t){let r=0;!function e(n){reactExports.Children.forEach(n,(n=>{isFragment(n)?e(n.props.children):(t(n,r),r+=1)}))}(e)}function computedFixedLayoutStyle(e,t){return t<=0||e===BUTTON_GROUP_LAYOUT.INITIAL?{}:{flex:"0 1 ".concat(100/t,"%")}}function getCommonStyle({color:e,selectedColor:t,alignItem:r,fontSize:n,extendsCommonStyle:o,buttonHeight:i}){return{"--active-text-color":t,"--text-color":e,"--font-align-item":r,"--font-size":"".concat(n,"px"),"--button-height":"".concat(null!=i?i:TAB_CARD_SIZE_MULTIPLE$1*n,"px"),...o}}function getButtonGroupCssVariables({type:e,alignItem:t,fontSize:r,buttonHeight:n,borderRadius:o,color:i,selectedColor:a,border:s,selectedBorder:l,background:c,selectedBackground:u,extendsCommonStyle:d}){const{borderWidth:h,borderStyle:p,borderColor:f}=l,g=getCommonStyle({color:i,selectedColor:a,fontSize:r,alignItem:t,extendsCommonStyle:d,buttonHeight:n});switch(e){case BUTTON_GROUP_TYPE.UNDERLINE:return{...g,"--active-line-height":"".concat(h,"px"),"--active-line-style":p,"--active-line-color":hexToRgba(f),"--tab-line-height":"".concat(s.borderWidth,"px"),"--tab-line-style":s.borderStyle,"--tab-line-color":hexToRgba(s.borderColor),"--group-arrow-color":hexToRgba(f)};case BUTTON_GROUP_TYPE.BUTTON:case BUTTON_GROUP_TYPE.CAPSULE:return{...g,"--border-radius":"".concat(null==o?void 0:o.value).concat(null==o?void 0:o.type),"--group-arrow-color":hexToRgba(u),"--background":hexToRgba(c),"--active-background":hexToRgba(u),"--theme-color":hexToRgba(f),"--border-width":"".concat(s.borderWidth,"px"),"--border-style":s.borderStyle,"--border-color":hexToRgba(s.borderColor),"--active-border-width":"".concat(h,"px"),"--active-border-style":p,"--active-border-color":hexToRgba(f)};default:return g}}function Button(e){return null}const BUTTON_ITEM_CLASS="duchamp-button-item",ButtonGroupWidget=reactExports.forwardRef(((e,t)=>{const{type:r=BUTTON_GROUP_TYPE.SCIENCE,vertical:n=!1,layout:o=BUTTON_GROUP_LAYOUT.INITIAL,value:i,activeLineMode:a="full",num:s=1,multiple:l=!1,disabled:c,leftIcon:u,rightIcon:d,position:h,horizontalScroll:p=!1,children:f,className:g,style:m,allowDeselect:y=!1,onChange:v,onButtonOverflow:_}=e,b=reactExports.useRef(null),C=reactExports.useRef(null),E=reactExports.useRef(null),T=getTargetElement$2(b),S=getTargetElement$2(C),P=useSize_1(b),[w,x]=useUpdateValue$1(getValues(i),[i]),O={},$=[];traverseReactNode(e.children,(e=>{if(!reactExports.isValidElement(e))return;const{value:t}=e.props,r=$.push(e);O[t]=r-1}));const I=O[null==w?void 0:w[0]]||0,{activeLineOptions:R,scrollOptions:A,activeLineAnimateX:D,activeLineAnimateY:L,animateHorizontalScroll:N,animateVerticalScroll:M}=useButtonAnimate({activeIndex:I,listWrapperRef:C,activeLineRef:E,activeLineMode:a}),{leftIconDisabled:k,rightIconDisabled:F,onLeftIconClick:j,onRightIconClick:B}=useArrowProps({vertical:n,listWrapperRef:C,animateHorizontalScroll:N,animateVerticalScroll:M}),{x:W,y:V,width:H,height:G}=R,{scrollLeft:U,scrollTop:Y}=A;reactExports.useEffect((()=>{T&&S&&_&&(o===BUTTON_GROUP_LAYOUT.INITIAL?_(n?T.clientHeight<S.scrollHeight:T.clientWidth<S.scrollWidth):_(!1))}),[o,n,f,T,S,r,P,_]),reactExports.useEffect((()=>{l||(n?L():D())}),[P,w,r,o,f]);const z=u?reactExports.cloneElement(u,{disabled:k,onClick:()=>j(n?"up":"left")}):jsx(Fragment,{}),K=d?reactExports.cloneElement(d,{disabled:F,onClick:()=>B(n?"down":"right")}):jsx(Fragment,{}),Z=reactExports.useCallback((e=>{e.preventDefault();const{deltaY:t,deltaX:r}=e;S&&(Math.abs(t)>Math.abs(r)?S.scrollLeft+=e.deltaY:S.scrollLeft+=e.deltaX)}),[S]);return reactExports.useEffect((()=>{if(!n&&p)return S&&S.addEventListener("wheel",Z),()=>{S&&S.removeEventListener("wheel",Z)}}),[Z,p,S,r,n]),reactExports.useImperativeHandle(t,(()=>({scrollToNodeByIndex:(e,t)=>{const r=null==S?void 0:S.querySelector(".".concat(BUTTON_ITEM_CLASS,"-").concat(e));if(!r||!S)return;const{alignTop:o=!1}=t||{};if(n){const e=r.offsetTop,t=r.offsetHeight,n=S.clientHeight,{scrollTop:i}=S;if(e>=i&&e+t<=i+n)return;const a=o||t>n?e:e+t-n;S.scrollTo({top:a})}else{const e=r.offsetLeft,t=r.offsetWidth,n=S.clientWidth,{scrollLeft:i}=S;if(e>=i&&e+t<=i+n)return;const a=o||t>n?e:e+t-n;S.scrollTo({left:a})}}}))),jsxs("div",{className:classNames$1("duchamp-button-group",g,r,"duchamp-button-group-layout-".concat(o),h,{vertical:n}),style:m,ref:b,children:[z,jsxs("div",{className:"duchamp-button-group-container",children:["underline"===r&&jsx("div",{className:"duchamp-button-group-inactive-tab-line"}),jsxs(animated.div,{className:"duchamp-button-group-button-list",ref:C,scrollLeft:U,scrollTop:Y,children:[jsx(animated.div,{ref:E,className:classNames$1("duchamp-button-group-tab-line",{vertical:n}),style:(()=>{if("underline"!==r)return{display:"none"};const e={x:0,y:0};return n?(e.height="fixed"===a?"var(--fixed-active-line-width, 30px)":G,e.y=V):(e.width="fixed"===a?"var(--fixed-active-line-width, 30px)":H,e.x=W),e})()}),$.map(((e,t)=>{const{disabled:i,value:a,image:u,activeImage:d,className:h,style:p,children:f,onClick:g,...m}=e.props;return createElement(ButtonItem,{...m,key:"".concat(a,"-").concat(t),className:classNames$1(r,h,{"is-only-one":1===$.length,"is-first":0===t,"is-last":t===$.length-1},"".concat(BUTTON_ITEM_CLASS,"-").concat(t)),type:r,value:a,active:w.includes(a),image:w.includes(a)?d:u,disabled:null!=c?c:i,vertical:n,onClick:e=>{null==g||g(e),(e=>{let t=[];t=l?w.includes(e)?w.filter((t=>t!==e)):w.concat(e):y&&w.includes(e)?w.filter((t=>t!==e)):[e],x(t),null==v||v(l?t:null==t?void 0:t[0])})(a)},style:p,wrapperStyle:computedFixedLayoutStyle(o,s)},f)}))]})]}),K]})}));ButtonGroupWidget.displayName="ButtonGroup";const ButtonGroup=ButtonGroupWidget;function NavigationBar({conditionStyles:e,activeConditionStyle:t,onSwitch:r,onDelete:n}){const o=reactExports.useRef(null),i=reactExports.useMemo((()=>e.findIndex((e=>e.id===t.id))),[t.id,e]),a=usePrevious(i);return useUpdateEffect$2((()=>{var e;i!==a&&(null==(e=o.current)||e.scrollToNodeByIndex(i,{alignTop:i<(a||0)}))}),[i]),jsx(ButtonGroup,{ref:o,className:"navigation-bar",vertical:!1,type:BUTTON_GROUP_TYPE.BUTTON,layout:BUTTON_GROUP_LAYOUT.INITIAL,value:[i],leftIcon:jsx(Icon$2,{className:"arrow-icon",type:"icon-lastPage-s"}),rightIcon:jsx(Icon$2,{className:"arrow-icon",type:"icon-nextPage-s"}),onChange:t=>{_isNumber(t)&&r(e[t])},children:e.map(((e,r)=>jsxs(Button,{value:r,className:classNames$1("navigation-bar-item",{"navigation-bar-active-item":t===e}),children:[jsx("div",{className:"item-label",children:e.name}),jsx(Tooltip$1,{content:duchampIntl.get("Duchamp-Delete"),overlayClassName:"fvs-tooltip-black",children:jsx(Icon$2,{className:"delete-icon",type:"icon-close",onClick:t=>{t.stopPropagation(),n(e)}})})]},e.id)))})}function ConditionStylesConfig({value:e=[],onChange:t,activeId:r,onActiveIdChange:n,defaultStyle:o,styleConfig:i}){const a=useFocusPointTarget(),s=reactExports.useMemo((()=>null==e?void 0:e.find((e=>e.id===r))),[r,e]);return jsxs("div",{className:"condition-styles-config",children:[jsxs("div",{className:"condition-styles-config-header",children:[jsx("div",{children:duchampIntl.get("Duchamp-Condition_Style")}),jsx(IconTextButton,{icon:"icon-add",text:duchampIntl.get("Duchamp-Add_Condition_Style"),onClick:()=>{const r={id:uuid$1(),name:createUniqueName(null==e?void 0:e.map((e=>e.name)),duchampIntl.get("Duchamp-Condition_Style")),condition:null,style:cloneDeep$2(o)};(null==i?void 0:i.supportIcon)&&(r.icon=DEFAULT_DYNAMIC_VALUE_ICON),null==t||t([...e,r]),n(r.id)},"data-focus-point":{id:"S93",getTarget:()=>a}})]}),e.length>0&&s?jsxs("div",{className:"condition-styles-config-body",children:[jsx(NavigationBar,{conditionStyles:e,activeConditionStyle:s,onSwitch:e=>{n(e.id)},onDelete:o=>{var i;const a=e.filter((e=>e.id!==o.id));o.id===r&&n(null==(i=a[0])?void 0:i.id),null==t||t(a)}}),jsx(ConditionStyleItem,{value:s,onChange:r=>{const n=e.map((e=>e.id===r.id?r:e));null==t||t(n)},checkName:t=>!e.some((e=>e.id!==r&&e.name===t)),config:i})]}):null]})}const getValue$2=e=>!settingCenter.supportAppService(DUCHAMP_APP_SERVICE.FORMULA)&&isDynamicFormulaSource(e.source)?{...e,source:{type:"dataset",dataSet:"",field:""}}:e,DynamicValueEditor=({defaultValue:e,onValueChange:t,onConfirm:r,onCancel:n,checkName:o,defaultStyle:i,styleConfig:a})=>{var s;const[l,c]=reactExports.useState(getValue$2(e)),[u,d]=reactExports.useState(null==(s=l.conditionStyles[0])?void 0:s.id),h=useFocusPointTarget(),{target:p}=useStore(),{crudService:f}=useService();useMount$1((()=>{y(l,u)}));const{supportSummary:g,supportConditionStyle:m}=settingCenter.getDynamicValueConfig()||{},y=(e,r)=>{const{conditionStyles:n,...o}=e,i=n.find((e=>e.id===r));t({...o,conditionStyles:i?[{...i,condition:null}]:[]})},v=e=>{const t={...l,...e};c(t),y(t,u)},_=m&&i;return jsx(DynamicValueConfigPanel,{container:p,footer:jsxs("div",{className:"dynamic-value-config-panel-footer",children:[jsx(Button$4,{className:"footer-button",onClick:()=>n(),children:duchampIntl.get("Duchamp-Cancel")}),jsx(Button$4,{className:"footer-button",type:"primary",onClick:()=>{(null==a?void 0:a.supportIcon)&&l.conditionStyles.forEach((e=>{var t;(null==(t=e.icon)?void 0:t.enabled)||(e.icon=DEFAULT_DYNAMIC_VALUE_ICON)})),v(l),r(isNil$3(l.conditionStyles)?{...l,conditionStyles:[]}:l)},"data-focus-point":{id:"S98",getParam:()=>({sourceType:l.source.type,conditionStyleCount:l.conditionStyles.length}),getTarget:()=>h},children:duchampIntl.get("Duchamp-Sure")})]}),value:l,fetcher:{getTableInfo:f.getTableInfo,getTableNodeList:f.getTables,searchTable:f.searchTable,getSummaryInfo:g?f.getFieldSummaryInfo:void 0},onValueChange:v,onConfirm:r,onCancel:n,checkName:o,showFormulaDialog:settingCenter.supportAppService(DUCHAMP_APP_SERVICE.FORMULA)?fvsService.openFormulaEditor:void 0,conditionConfigPanel:_&&jsx(ConditionStylesConfig,{value:l.conditionStyles,onChange:e=>v({conditionStyles:e}),activeId:u,onActiveIdChange:e=>{d(e),y(l,e)},defaultStyle:i,styleConfig:a})})};function useDraft(e,t){const[r,n]=reactExports.useState(e),{undoManager:o}=useStore(),i=reactExports.useRef(!0);reactExports.useEffect((()=>{i.current&&n(e)}),[e]);return{reset:()=>{i.current=!0,o.withoutUndo((()=>{null==t||t(r)}))},commit:e=>{i.current=!0,null==t||t(e)},change:e=>{i.current=!1,o.withoutUndo((()=>{null==t||t(e)}))},value:e,originalValue:r}}function useMarquee$1(e){useMount$1((()=>{null==e||e.start()})),useUpdateEffect$2((()=>(null==e||e.start(),()=>{null==e||e.stop()})),[e]),useUnmount$2((()=>{null==e||e.stop()}))}const useStoryBackgroundCSSVarColor=({targetEl:e})=>{const t=useStore(),{story:r}=t;reactExports.useEffect((()=>{var t;null==e||e.style.setProperty("--story-background-color",null!=(t=r.platform.backgroundLayer.color)?t:null)}),[r.platform.backgroundLayer.color,e])},RichText$1=observer((({value:e,onChange:t,toolbar:r,marquee:n,supportConditionStyle:o=!0,defaultFormats:i,...a})=>{var s;const[l,c]=reactExports.useState(null),[u,d]=reactExports.useState(null);useMarquee$1(u);const h=reactExports.useRef(null);useMount$1((()=>{var e;null==(e=h.current)||e.focus({preventScroll:!0})}));const p=reactExports.useCallback((()=>{if(h.current&&n){const e=h.current.getRoot();e&&d(createDomScrollAction({marquee:n,editorElement:e,contentList:Array.from(e.children)}))}}),[n]);useStoryBackgroundCSSVarColor({targetEl:null==(s=h.current)?void 0:s.getRoot()});const f=useDraft(e,t),g=reactExports.useMemo((()=>r?updateRichTextToolbarItems(r.value,[{key:DYNAMIC_VALUE_EMBED_KEY,View:({instance:t})=>jsx(DynamicValueItem,{onEdit:c,onInsert:e=>null==t?void 0:t.insertEmbed(e),value:e})},{key:FORMAT_PAINTER_KEY,View:({instance:e})=>jsx(FormatPainterItem,{instance:e,defaultFormat:i})},{key:RICH_TEXT_FORMAT_TYPE.COLOR,View:ColorItem},{key:RICH_TEXT_FORMAT_TYPE.FONT,View:FontItem}]):[]),[r,e]),m=reactExports.useMemo((()=>[{key:DYNAMIC_VALUE_EMBED_KEY,render:(e,t)=>{var r;const{value:n,icon:o,iconSource:i}=t;o?createRoot$1(e).render(jsx("span",{className:"dynamic-value-img",style:getDynamicValueIconStyles$1(o,i)})):(createRoot$1(e).render(jsx(TagNode,{name:null!=(r=n.name)?r:"",onEdit:()=>c(n),className:"dynamic-value-tag-node"})),e.onmousedown=t=>{t.stopPropagation(),e.classList.add("active")},e.onclick=t=>{var r;t.stopPropagation(),e.classList.add("active"),null==(r=h.current)||r.addSelectionChangeListenOnce((()=>{e.classList.remove("active")}))})}}]),[]),y=reactExports.useMemo((()=>cloneDeep$2(shiftRichTextValue(e))),[e]);return jsxs(Fragment,{children:[jsx(RichTextCore,{value:y,onChange:r=>{if(!t)return;const n=unShiftRichTextValue(r);isInsertDynamicValueState(e.ops,n.ops)||l?f.change(n):t(n)},toolbar:{...r,value:g},embeds:m,ref:h,...n&&{onInstanceUpdate:()=>{p()}},defaultFormats:i,...a}),l&&jsx(DynamicValueEditor,{defaultValue:l,checkName:t=>checkDynamicValueName(t,l.id,e.ops),onValueChange:e=>{var t;null==(t=h.current)||t.modifyEmbed({id:l.id,key:DYNAMIC_VALUE_EMBED_KEY,value:{...l,...e}})},onCancel:()=>{var e;f.reset(),c(null),null==(e=h.current)||e.focus()},onConfirm:t=>{var r;f.commit({...e,ops:replaceDynamicValue(t,e.ops)}),c(null),null==(r=h.current)||r.focus()},styleConfig:{supportGradient:!1,supportShadow:!1,supportIcon:!0},defaultStyle:!1!==o?getDefaultDynamicValueStyle(l.id,e.ops):void 0})]})}));function ContentEventInput(e){const{value:t={value:[],pathType:CONTENT_TYPE.URL},onChange:r}=e,{pathType:n}=t,o=useStore();return jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8,height:"100%"},children:[jsx(Select$1,{style:{width:"100%"},value:n,onChange:e=>{const t=e===CONTENT_TYPE.TEXT_PROMPT?{pathType:e,value:{value:[],verticalAlign:RICH_TEXT_VERTICAL_ALIGN.START}}:e===CONTENT_TYPE.URL?{pathType:e,value:[]}:{pathType:e,value:""};null==r||r(t)},options:[{label:duchampIntl.get("Duchamp-Web_Links"),value:CONTENT_TYPE.URL},{label:duchampIntl.get("Duchamp-Template_Link"),value:CONTENT_TYPE.TEMPLATE},{label:duchampIntl.get("Duchamp-Text_Prompt"),value:CONTENT_TYPE.TEXT_PROMPT}]}),n===CONTENT_TYPE.TEXT_PROMPT?jsx(RichText$1,{value:{ops:t.value.value,attributes:{verticalAlign:t.value.verticalAlign}},onChange:e=>{null==r||r({...t,value:{value:e.ops,verticalAlign:has$2(e.attributes,"verticalAlign")?e.attributes.verticalAlign:RICH_TEXT_VERTICAL_ALIGN.START}})},placeholder:duchampIntl.get("Duchamp-Please_Enter_Text_Content"),toolbar:{position:RICH_TEXT_TOOLBAR_POSITION.TOP,value:getToolbarWithEmbed(!1)},supportConditionStyle:!1,innerClassName:"text-prompt-config",style:getThemeStyle$1(o),defaultFormats:getThemeStyle$1(o)}):jsx(PathInputButton,{onChange:r,value:t})]})}const ContentEventConfig=observer((({showRichTextEditor:e,form:t,formData:r,fields:n})=>{const o=r.url.pathType===CONTENT_TYPE.TEXT_PROMPT;return jsxs(Fragment,{children:[jsx(Form.Item,{label:duchampIntl.get("Duchamp-Content"),name:"url",style:{...o?{flex:1,marginBottom:0}:{}},children:e?jsx(ContentEventInput,{onChange:e=>{r.url.pathType!==e.pathType&&t.setFieldsValue(e.pathType===CONTENT_TYPE.TEXT_PROMPT?TEXT_PROMPT_DEFAULT_CONFIG:LINK_DEFAULT_CONFIG)}}):jsx(PathInput,{componentType:"select",style:{width:"100%"}})}),jsx(Form.Item,{name:"requestType",label:duchampIntl.get("Duchamp-Request_Method"),hidden:r.url.pathType===CONTENT_TYPE.TEXT_PROMPT,children:jsx(RadioGroup$1,{optionType:"default",options:[{label:duchampIntl.get("Duchamp-Use_Get_To_Pass_Parameters"),value:"GET"},{label:duchampIntl.get("Duchamp-Use_Post_To_Pass_Parameters"),value:"POST"}]})}),jsx(Form.Item,{name:"parameters",hidden:r.url.pathType===CONTENT_TYPE.TEXT_PROMPT,noStyle:!0,children:jsx(ParameterConfig$1,{fields:n,showFormulaDialog:(e,t)=>fvsService.openFormulaEditor(e,t)})})]})})),MobilePopupSizeConfig=e=>{const{value:t=MOBILE_DEFAULT_BUBBLE_SIZE,onChange:r}=e,n=(null==t?void 0:t.type)===SIZE_REGULAR_TYPE.AUTO_HEIGHT;return jsxs(Fragment,{children:[jsx(Select$1,{style:{width:"100%"},value:t.type,onChange:e=>{null==r||r({...t,type:e})},options:MOBILE_POPUP_SIZE_TYPE_OPTIONS}),jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Pop_Up_Screen_Ratio"),style:{marginBottom:0},children:jsxs("div",{className:"flex-center-space-between size-wrapper",children:[jsxs("div",{className:"size-space-between",children:[jsx("span",{className:"size-title",children:"W"}),jsx(NumberInput$1,{value:t.widthPercent,onChange:e=>{null==r||r({...t,widthPercent:e})},suffix:"%",min:0,max:100})]}),!n&&jsxs("div",{className:"size-space-between",children:[jsx("span",{className:"size-title",children:"H"}),jsx(NumberInput$1,{value:t.heightPercent,onChange:e=>{null==r||r({...t,heightPercent:e})},suffix:"%",min:0,max:100})]})]})})]})},MobilePopupSizeSelector=({onModeChange:e})=>{const[t,r]=reactExports.useState(MOBILE_MODE.PHONE);return jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,style:{gridTemplateColumns:"100%"},children:[jsx(RadioGroup$1,{value:t,onChange:t=>{r(t),e(t)},options:MOBILE_POPUP_SIZE_OPTIONS}),jsx(Form.Item,{name:"phoneSize",noStyle:!0,hidden:t===MOBILE_MODE.PAD,children:jsx(MobilePopupSizeConfig,{})}),jsx(Form.Item,{name:"padSize",noStyle:!0,hidden:t===MOBILE_MODE.PHONE,children:jsx(MobilePopupSizeConfig,{})})]})};function ColorResource({value:e,onChange:t}){return jsx(ThemeColorPicker,{value:e||"",onChange:e=>{null==t||t(e)}})}const PlatformLineItem=e=>{const{showPlatform:t=!0,...r}=e;return t&&(r.prefix=jsx(PlatformPopoverIcon,{})),jsx(LineItem,{...r})};function WidgetResourceSelector({value:e={type:RESOURCE_TYPE.EMPTY},title:t,tag:r="widget",className:n,onChange:o,mask:i,container:a,imageScopes:s,showPlatform:l,showOnlineMode:c}){var u;return jsx(l?PlatformLineItem:LineItem,{label:t,children:jsxs(ResourceSelector$1,{value:e,title:t,className:n,onChange:e=>{null==o||o(e)},children:[jsx(ResourceSelectorOption,{text:duchampIntl.get("Duchamp-Without"),value:RESOURCE_TYPE.EMPTY}),jsx(ResourceSelectorOption,{text:duchampIntl.get("Duchamp-Colour"),value:RESOURCE_TYPE.COLOR,children:jsx(ColorResource,{defaultValue:getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.BACKGROUND)})}),settingCenter.supportAppService(DUCHAMP_APP_SERVICE.REUSE)&&(null==(u=settingCenter.getResourceConfig())?void 0:u.resourceEnable)?jsx(ResourceSelectorOption,{text:duchampIntl.get("Duchamp-Resource_Center"),value:RESOURCE_TYPE.INTERNAL,children:jsx(DuchampInternalImageResource,{imageScopes:s,mask:i,container:a,showOnlineMode:c})}):null,jsx(ResourceSelectorOption,{text:duchampIntl.get("Duchamp-Custom_Upload"),value:RESOURCE_TYPE.CUSTOM,children:jsx(DuchampCustomImageResource,{tag:r,mask:i,container:a})})]})})}function hasImageSlice(e,t){const{imageSource:r,imageSlice:n}=getImageResource$1(e,t);return r&&n&&n.length>0}function getPadding(e,t){var r;if(t.type===RESOURCE_TYPE.EMPTY||t.type===RESOURCE_TYPE.COLOR)return;const n=getResourceInfoByID(t.value,e);if(n&&t.type===RESOURCE_TYPE.INTERNAL){const{name:e}=n,t=null==(r=n.payload)?void 0:r.padding;return e&&t&&t.length>0?getPositionByNumbers$1(t):void 0}}const PlatformFormItem=observer((({children:e,...t})=>jsx(Form.Item,{...t,icon:jsx(PlatformPopoverIcon,{}),children:e}))),DomRefsContext=reactExports.createContext(null),DomRefsProvider=({children:e,refs:t})=>{const[r,n]=reactExports.useState(t),o=reactExports.useCallback(((e,t)=>{n((r=>({...r,[e]:t})))}),[]);return jsx(DomRefsContext.Provider,{value:{...r,setRef:o},children:e})};function useDomRefs(){const e=reactExports.useContext(DomRefsContext);if(!e)throw new Error("useDomRefs must be used within a DomRefsProvider");return e}const ResourceSelector=e=>{var t,r;const{portalRef:n}=useDomRefs();return jsx(WidgetResourceSelector,{className:"background-select",mask:!0,container:null!=(r=null==(t=null==n?void 0:n.current)?void 0:t.querySelector(".widget-event-config"))?r:void 0,imageScopes:[IMAGE_SCOPE.BACKGROUND],...e})},StyleConfig$1=observer((({formData:e,form:t,onPreviewChange:r})=>{const n=useStore(),{url:o,dialogType:i,popupStyle:a}=e,{isMobile:s}=n.platform,l=o.pathType===CONTENT_TYPE.TEXT_PROMPT;return jsxs(Fragment,{children:[jsx(WebPagePopoverAttribute.DialogType,{icon:jsx(PlatformPopoverIcon,{}),hidden:s&&!l,onChange:e=>{const r=l?POPUP_STYLE.TRIANGLE_ARROW:POPUP_STYLE.CONNECTION_LINE;t.setFieldsValue({popupStyle:e===DIALOG_TYPE.DYNAMIC?r:void 0})}}),jsx(PlatformFormItem,{name:"popupStyle",hidden:i===DIALOG_TYPE.CENTER||s,label:duchampIntl.get("Duchamp-Display_Mode"),children:jsx(RadioGroup$1,{options:DISPLAY_MODE_OPTIONS})}),jsx(Form.Item,{hidden:a!==POPUP_STYLE.CONNECTION_LINE,name:"line",children:jsx(AssetTypeConfig,{colorPicker:ThemeColorPicker})}),jsx(Form.Item,{hidden:a!==POPUP_STYLE.TRIANGLE_ARROW,name:"triangleArrow",children:jsx(AssetTypeConfig,{colorPicker:ThemeColorPicker})}),jsx(WebPagePopoverAttribute.Size,{icon:jsx(PlatformPopoverIcon,{}),hidden:s}),jsx(Form.Item,{hidden:!s,label:duchampIntl.get("Duchamp-Size"),children:jsx(MobilePopupSizeSelector,{onModeChange:e=>{r({mobileSizeMode:e})}})}),jsx(WebPagePopoverAttribute.Title,{fontStyleIcon:jsx(PlatformPopoverIcon,{}),fontSelectRender:FontSelect,colorPicker:ThemeColorPicker}),jsx(WebPagePopoverAttribute.BorderBackgroundResource,{border:e.border,fillType:e.fillType,icon:jsx(PlatformPopoverIcon,{}),resourceSelector:ResourceSelector,onBorderTypeChange:()=>{t.setFieldsValue({borderStyle:DEFAULT_BORDER_CONFIG})},resourceCenter:n.resourceCenter}),jsx(WebPagePopoverAttribute.Padding,{icon:jsx(PlatformPopoverIcon,{})}),jsx(WebPagePopoverAttribute.BorderRadius,{icon:jsx(PlatformPopoverIcon,{})})]})})),WebPagePopoverConfig=observer((({value:e,target:t,onPreviewChange:r,...n})=>{const o=useStore(),{story:i}=o,{currentWidget:a}=i,s=reactExports.useMemo((()=>({...WEB_PAGE_POPOVER_DEFAULT_CONFIG,...omitBy$1(e,isNull$1)})),[e]),[l]=useForm(),[c,u]=reactExports.useState(initializeData(s,o.platform.isMobile)),d=c.actionType===TARGET_TYPE.DIALOG&&("d-text-title"===(null==a?void 0:a.type)||"d-image"===(null==a?void 0:a.type));return reactExports.useEffect((()=>{r({data:transformWebpageActionData(s,c,o.platform.isMobile)})}),[c,s]),jsx(baseWebPagePopoverAction.configPane,{...n,target:t,value:c,onValuesChange:(e,t)=>{if(e.actionType&&t.url.pathType===CONTENT_TYPE.TEXT_PROMPT){const t={...WEB_PAGE_POPOVER_DEFAULT_CONFIG,actionType:e.actionType};l.setFieldsValue(t),u(t)}else u(t)},onPreviewChange:r,form:l,formatter:e=>transformWebpageActionData(s,e,o.platform.isMobile),contentConfig:jsx(ContentEventConfig,{formData:c,form:l,showRichTextEditor:d,fields:t.fields}),styleConfig:jsx(StyleConfig$1,{formData:c,form:l,onPreviewChange:r})})})),PreviewContent=observer((({widget:e,target:t,container:r,actionData:n,mobileSizeMode:o})=>{var i;const a=useStore(),[s,l]=reactExports.useState(),c=reactExports.useRef(null),{isMobile:u}=a.platform;if(reactExports.useEffect((()=>{const t=collectionComputesFromWebPage(n);return(0!==t.size?e.computeFieldConfigs(t).then((t=>({computableResult:t,parameters:computeActionParameters(e.id,n,t)}))):Promise.resolve({computableResult:new Map,parameters:void 0})).then((({computableResult:t,parameters:r})=>calculateUrl(e.id,n,t,r))).then(l),()=>{l(void 0)}}),[]),isNil$3(s))return null;const d=!isString$3(s),h={...n,body:{...u?{...n.body,...n.body.mobileConfig,...mockMobilePopupSize((null==(i=a.target.querySelector(".".concat(ELEMENT_SYMBOL.DESIGNER)))?void 0:i.clientHeight)||0,o===MOBILE_MODE.PAD?n.body.padSize:n.body.phoneSize,d)}:n.body,contentSource:s}},p=""===h.body.height,{body:f}=h,{dialogType:g}=f,{left:m,top:y,width:v,height:_}=t.getBoundingClientRect(),b=m+v/2,C=y+_/2;switch(g){case DIALOG_TYPE.BUBBLE:return jsx("div",{style:{position:"fixed",left:b,top:C,zIndex:1e3},ref:c,children:jsx(BubblePreview,{store:a,config:h,body:f,options:{getPopupContainer:()=>c.current||document.body,overlayClassName:classNames$1({"auto-height":p})},baseUrl:a.duchampServer.resourceBaseUrl})});case DIALOG_TYPE.CENTER:{const e=getDialogPreviewProps({store:a,config:h,body:f});return jsx(DialogPreview,{...e,...u?{}:{width:300,height:300},className:classNames$1(e.className,{"auto-height":p}),style:{display:"unset",padding:"auto",paddingRight:450},zIndex:1e3,isMobile:u,store:a})}case DIALOG_TYPE.DYNAMIC:return _isNumber(f.height)?jsx("div",{style:{width:0,height:0},ref:c,children:jsx(PopoverPreview,{width:f.width,height:f.height,line:f.line,coordinate:[b,C],container:r,zIndex:1e3,options:{getPopupContainer:()=>c.current||document.body},children:({left:e,top:t})=>jsx(PopoverBody,{resourceCenter:a.resourceCenter,config:h,body:f,top:t,left:e,contentSource:s,isMobile:a.platform.isMobile,baseUrl:a.duchampServer.resourceBaseUrl,store:a})})}):null;default:return null}})),mockMobilePopupSize=(e,t,r)=>{var n;const o=.95*e;return{width:9*o/16*(t.widthPercent/100),height:t.type===SIZE_REGULAR_TYPE.CUSTOM?o*((null!=(n=t.heightPercent)?n:0)/100):r?"":.95*o}},PopupPreview=observer((({action:e,previewProps:{data:t,type:r,mobileSizeMode:n}})=>{const o=useStore(),{currentWidget:i}=o.story,a=null==i?void 0:i.target,s=o.target.querySelector("#".concat(ELEMENT_SYMBOL.MAIN_CANVAS));if(!s||!a||!t||r===WEB_PAGE_TAB_KEYS.CONTENT_EVENT)return null;const l={...e,body:t};return reactDomExports.createPortal(jsx(PreviewContent,{widget:i,target:a,container:s,actionData:l,mobileSizeMode:n},i.id),document.body)})),baseWebPagePopoverActionConfig=baseWebPagePopoverAction,webPagePopoverAction={...baseWebPagePopoverActionConfig,configPane:WebPagePopoverConfig,previewPane:PopupPreview,execute:executeWebPagePopoverAction,computableCollector:collectionComputesFromWebPage,replaceData:replaceWebPageData,hook:{...baseWebPagePopoverActionConfig.hook,onCopy:async({body:e})=>({files:Array.from(new Set(collectBorderResources(e.border).concat(collectBorderResources(e.mobileConfig.border))))}),onRecord:e=>{var t,r;return{...null==(r=null==(t=baseWebPagePopoverActionConfig.hook)?void 0:t.onRecord)?void 0:r.call(t,e),triangleColor:e.body.triangleArrow.value.color,phoneSize:e.body.phoneSize.type,padSize:e.body.padSize.type}}}},WidgetLinkConfig=observer((e=>{const{story:t}=useStore();return jsx(baseWidgetLinkAction.configPane,{...e,stories:[{id:t.id,name:t.name,widgets:t.groupRelateWidgets}],showFormulaDialog:(e,t)=>fvsService.openFormulaEditor(e,t)})})),WidgetLinkPreview=observer((({value:e,previewProps:{active:t,hoveredWidgets:r}})=>jsx(WidgetMask,{selectedWidgetIds:t?e.widgets:[],hoveredWidgetIds:r}))),executeWidgetLinkAction=({config:e,store:t,parameters:r})=>{const{story:n,widgets:o}=e.body;if((t.story.id===n||isNil$3(n))&&r&&r.size>0){const e=Object.fromEntries(r.entries()),n=new Filter("and").updateParameterFilters(e);o&&o.length>0?t.calculateCenter.linkage(n,new Set(t.story.getRelatedWidgetByIds(o).map((e=>e.getInstance())))):t.calculateCenter.linkageGlobal(n)}},widgetLinkAction={...baseWidgetLinkAction,configPane:WidgetLinkConfig,previewPane:WidgetLinkPreview,execute:executeWidgetLinkAction},allActions=[widgetLinkAction,webPagePopoverAction,jsAction,jumpStoryAction,visibleControlAction,playRoamAnimationAction,modelAnimationAction,customPerspectiveAction,envSettingSwitchAction],defaultActions=allActions.map((e=>({action:e.type}))),carouselActions=[DUCHAMP_ACTION_TYPE.WIDGET_LINK,DUCHAMP_ACTION_TYPE.MODEL_ANIMATION,DUCHAMP_ACTION_TYPE.JAVASCRIPT].map((e=>({action:e}))),actionRegistry=new ActionRegistry(allActions),widgetsCtx=createContext([]),storyCtx=createContext();function withMobile({descriptor:e,key:t,property:r,check:n=()=>!0}){const o=e[t];n(o)&&(e[t]=function(...e){var t,n;const{platform:i}=this,{mobile:a,model:s}=null!=i?i:this;if(null==(n=null==(t=getRootStore(s))?void 0:t.platform)?void 0:n.isMobile){const t=null==a?void 0:a[r];if(isFunction$8(t))return t.call(a,...e);if(!isNil$3(t))return t}else{const t=i?o:null==s?void 0:s[r];if(isFunction$8(t))return t.call(s,...e)}return o.call(this,...e)})}function platformComputed(e,t,r){return withMobile({descriptor:r,key:"get",property:t,check:isFunction$8}),computed(e,t),r}function platformAction(e,t,r){return withMobile({descriptor:r,key:"value",property:t,check:isFunction$8}),r}var __defProp$W=Object.defineProperty,__getOwnPropDesc$S=Object.getOwnPropertyDescriptor,__decorateClass$V=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$S(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$W(t,r,i),i};class MobileAdaptor{constructor(e){__publicField(this,"model"),__publicField(this,"disposes",[]),this.model=e,makeObservable(this),this.init()}init(){}get mobile(){return this.model.mobile}update(e){this.model.setMobile({...this.mobile,...e})}}__decorateClass$V([observable],MobileAdaptor.prototype,"model",2),__decorateClass$V([computed],MobileAdaptor.prototype,"mobile",1),__decorateClass$V([action$1],MobileAdaptor.prototype,"update",1);const TOOLBAR_BUTTON_TYPE$1={STORY:"story",TEMPLATE:"template"};var __defProp$V=Object.defineProperty,__getOwnPropDesc$R=Object.getOwnPropertyDescriptor,__decorateClass$U=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$R(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$V(t,r,i),i};const COLLECTED_TAB_TYPE=3;class MobilePlatformConfig{constructor(){__publicField(this,"id",""),__publicField(this,"showCollectedButton",!1),__publicField(this,"modules",null),__publicField(this,"globalConfig",null),__publicField(this,"collections",[]),makeObservable(this)}setShowCollectedButton(e){this.showCollectedButton=e}setGlobalConfig(e){this.globalConfig=e}setCollections(e){this.collections=e}init(){this.getId(),this.fetchGlobalConfig(),this.id&&(this.fetchCollections(),this.fetchModulesConfig().then((()=>{var e,t,r;(null==(e=this.modules)?void 0:e.length)?this.setShowCollectedButton(!(null==(r=null==(t=this.modules)?void 0:t.find((e=>e.tabType===COLLECTED_TAB_TYPE)))?void 0:r.invisible)&&!!this.id):this.setShowCollectedButton(!!this.id)})))}getId(){var e;const t=window.location.href.match(/access\/(.*?)\?/),r=null!=(e=null==t?void 0:t[1])?e:null;r&&(this.id=r)}async fetchCollections(){const e=await otherService.getCollectionList();this.setCollections(isArray$c(e.data)?e.data:[])}async fetchGlobalConfig(){var e;if(this.globalConfig)return;const t=await otherService.getGlobalConfig();this.setGlobalConfig(null!=(e=t.data)?e:null)}async fetchModulesConfig(){if(this.modules)return;const e=await otherService.getModulesConfig();this.modules=isArray$c(e.data)?e.data:[]}get isTemplateCollected(){var e;return!!this.collections&&(null==(e=this.collections)?void 0:e.some((e=>e.id===this.id)))}async addCollection(){const{data:e}=await otherService.addCollection(this.id);"success"===e&&(await this.fetchCollections(),Toast.show({content:duchampIntl.get("Duchamp-Add_Collection_Success")}))}async removeCollection(){const{data:e}=await otherService.removeCollection(this.id);"success"===e&&(await this.fetchCollections(),Toast.show({content:duchampIntl.get("Duchamp-Remove_Collection_Success")}))}handleCollection(){this.isTemplateCollected?this.removeCollection():this.addCollection()}get showRefreshButton(){var e;return null==(e=this.globalConfig)?void 0:e.refreshable}}__decorateClass$U([observable],MobilePlatformConfig.prototype,"showCollectedButton",2),__decorateClass$U([observable],MobilePlatformConfig.prototype,"globalConfig",2),__decorateClass$U([observable],MobilePlatformConfig.prototype,"collections",2),__decorateClass$U([action$1],MobilePlatformConfig.prototype,"setShowCollectedButton",1),__decorateClass$U([action$1],MobilePlatformConfig.prototype,"setGlobalConfig",1),__decorateClass$U([action$1],MobilePlatformConfig.prototype,"setCollections",1),__decorateClass$U([computed],MobilePlatformConfig.prototype,"isTemplateCollected",1),__decorateClass$U([computed],MobilePlatformConfig.prototype,"showRefreshButton",1);const platformConfig=new MobilePlatformConfig;function requireJsBridge(e=!0){return function(t,r,n){const o=n.value;return n.value=function(...t){const[n]=t,i=isPlainObject$1(n)&&null!=n?n:{},a=isFunction$8(n)?n:noop$6;if(this.jsBridge)return e&&this.jsBridge.callHandler(r,i,(e=>{if(a&&isString$3(e))try{a(JSON.parse(e))}catch(t){a(t)}})),o.apply(this,t)},n}}const isFineNativeEnv=()=>!!window.isFineNative;function getTopWindow(){try{return window.top?window.top:window}catch(e3){return window}}function getParentWindowHasWebViewJsBridge(){let e=window;try{for(;isUndefined$3(null==e?void 0:e.WebViewJavascriptBridge)&&e!==e.top;)e=e.parent;return e}catch(e3){return window}}var __defProp$U=Object.defineProperty,__getOwnPropDesc$Q=Object.getOwnPropertyDescriptor,__decorateClass$T=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$Q(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$U(t,r,i),i};class JSBridge{constructor(){__publicField(this,"configChangedListener",null),__publicField(this,"jsBridge",null),__publicField(this,"deviceInfo",null),__publicField(this,"isSharing",!1),__publicField(this,"oemSupportConfig",{supportCollect:!0,supportShare:!0}),__publicField(this,"isWebview",!1),makeObservable(this)}setIsSharing(e){this.isSharing=e}setOemSupportConfig(e){this.oemSupportConfig=e}setIsWebview(e){this.isWebview=e}init(){isFineNativeEnv()&&this.setupWebViewJavascriptBridge((e=>{e&&(this.jsBridge=e,this.setIsWebview(!0),this.setDeviceInfo(),e.registerHandler("onConfigChanged",((e,t)=>{this.configChangedListener&&this.configChangedListener(e,t)})))}))}setupWebViewJavascriptBridge(e){const{WebViewJavascriptBridge:t}=getParentWindowHasWebViewJsBridge();if(t)return e(t);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(e);window.WVJBCallbacks=[e];const r=document.createElement("iframe");r.style.display="none",r.src="wvjbscheme://__BRIDGE_LOADED__",document.documentElement.appendChild(r),setTimeout((()=>{document.documentElement.removeChild(r)}),50)}setDeviceInfo(){this.getDeviceInfo((e=>{this.deviceInfo=e}))}closeActiveTab(){}addItem(e){}logoutApp(){}location(e){}getDeviceInfo(e){}scanCode(e){}share(){var e;this.setIsSharing(!0),null==(e=this.jsBridge)||e.callHandler("share",{},(e=>{this.setIsSharing(!1)}))}async getToolbarConfig(){return new Promise(((e,t)=>{var r;null==(r=this.jsBridge)||r.callHandler("getToolbarConfig",{},(r=>{if(isString$3(r))try{const t=JSON.parse(r);this.setOemSupportConfig(t),e()}catch(n){t(n)}}))}))}}__decorateClass$T([observable],JSBridge.prototype,"isSharing",2),__decorateClass$T([observable],JSBridge.prototype,"oemSupportConfig",2),__decorateClass$T([observable],JSBridge.prototype,"isWebview",2),__decorateClass$T([action$1],JSBridge.prototype,"setIsSharing",1),__decorateClass$T([action$1],JSBridge.prototype,"setOemSupportConfig",1),__decorateClass$T([action$1],JSBridge.prototype,"setIsWebview",1),__decorateClass$T([requireJsBridge()],JSBridge.prototype,"closeActiveTab",1),__decorateClass$T([requireJsBridge()],JSBridge.prototype,"addItem",1),__decorateClass$T([requireJsBridge()],JSBridge.prototype,"logoutApp",1),__decorateClass$T([requireJsBridge()],JSBridge.prototype,"location",1),__decorateClass$T([requireJsBridge()],JSBridge.prototype,"getDeviceInfo",1),__decorateClass$T([requireJsBridge()],JSBridge.prototype,"scanCode",1),__decorateClass$T([requireJsBridge(!1)],JSBridge.prototype,"share",1),__decorateClass$T([requireJsBridge(!1)],JSBridge.prototype,"getToolbarConfig",1);let jsBridge=null;const BASE_BUTTON_WEIGHT=1,TOOLBAR_NAME={PAGE:"page",REFRESH:"refresh",MARK:"mark",FILTER:"filter",COLLECT:"collect",WORKBOOK_PAGE:"workbookPage",NAVIGATOR:"navigator",LINKAGE:"linkage"},LAYOUT_OPTIONS$1=[{label:duchampIntl.get("Duchamp-Mobile_Layout"),value:LAYOUT_TYPE$2.MAGNETIC},{label:duchampIntl.get("Duchamp-PC_Layout"),value:LAYOUT_TYPE$2.RESERVE}],MOBILE_TOOLBAR_OPTIONS=[{label:duchampIntl.get("Duchamp-Toolbar_Bottom"),value:MOBILE_TOOLBAR_TYPE.DEFAULT},{label:duchampIntl.get("Duchamp-Toolbar_Float"),value:MOBILE_TOOLBAR_TYPE.FLOAT}];var __defProp$T=Object.defineProperty,__getOwnPropDesc$P=Object.getOwnPropertyDescriptor,__decorateClass$S=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$P(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$T(t,r,i),i};class CollectButton{get meta(){const{isTemplateCollected:e}=platformConfig;return{name:TOOLBAR_NAME.COLLECT,weight:BASE_BUTTON_WEIGHT,text:duchampIntl.get(e?"Duchamp-Unfavorite":"Duchamp-Favorite"),icon:jsx(Icon$1,{name:e?"fdm-uncollect":"fdm-collect",size:28}),type:TOOLBAR_BUTTON_TYPE$1.TEMPLATE}}constructor(){makeObservable(this)}get visible(){return platformConfig.showCollectedButton}get onClick(){return()=>platformConfig.handleCollection()}}__decorateClass$S([computed],CollectButton.prototype,"meta"),__decorateClass$S([computed],CollectButton.prototype,"visible");const ControllerPopup=e=>{const{visible:t,leftBtn:r,rightBtn:n,position:o="bottom",children:i,className:a,onCancel:s,...l}=e,{portalRef:c}=useDomRefs();return jsxs(Popup,{visible:t,position:o,onMaskClick:s,onClose:s,className:classNames$1("controller-panel-drawer-mobile",a),bodyStyle:{width:"100%"},getContainer:()=>{var e;return null!=(e=null==c?void 0:c.current)?e:document.body},...l,children:[jsx("div",{className:"controller-panel-header",children:duchampIntl.get("Duchamp-Controller_Panel")}),jsx("div",{className:"controller-panel-content",children:jsx("div",{className:"controller-panel-controls",children:i})}),jsxs("div",{className:"controller-panel-footer-mobile",children:[jsx(Button$3,{className:"control-button cancel",block:!0,onClick:r.onClick,fill:"outline",children:r.text}),jsx(Button$3,{className:"control-button confirm",block:!0,onClick:n.onClick,children:n.text})]})]})},DEFAULT_WIDGET_WIDTH=160,displayPhone=getParamInURL(MOBILE_UNIQUE_PARAMS.DISPLAY_PHONE);function isPad(){return!displayPhone&&Device.pad()}function isHTMLFrameElement(e){var t;return e instanceof HTMLIFrameElement||"HTMLIFrameElement"===(null==(t=null==e?void 0:e.constructor)?void 0:t.name)}const convertFrameElementStyle=e=>{e.style.border||(e.style.border="none")};function getDialogChildrenReactNode(e){return isString$3(e)?jsx("div",{children:e}):isHTMLFrameElement(e)?jsx("div",{style:{width:"100%",height:"100%"},dangerouslySetInnerHTML:{__html:e.outerHTML}}):jsx(Fragment,{})}function parseSize(e,t){if("number"==typeof e)return e;const r=/^(\d+(\.\d+)?)(%|vh|vw)$/.exec(e.trim());if(r){const e=parseFloat(r[1]);if(!Number.isNaN(e))return e/100*t}return NaN}function normalizeWidth(e,t=window.innerWidth){return parseSize(e,t)}function normalizeHeight(e,t=window.innerHeight){return clamp$5(parseSize(e,t),0,t)}function openHyperlinkDialog(e,t,r){const n=v4$1();return createIframeDialog({width:e.feature.width,height:e.feature.height,text4Ok:null,text4Cancel:null,title:e.feature.title,contentSource:e.url,params:e.para,id:n,byPost:t,styles:{wrapper:{background:"none"},header:{background:"#fff"}},store:r})}function closeActiveTabByTabPane(){const e=getTabPaneService();e&&e.closeActiveTab()}function addItemByTabPane(e){const t=getTabPaneService();t&&t.addItem({id:e.title,cardType:{src:e.src},text:e.title})}function getFRDoHyperlinkParams(e){if(1===e.length)return isPlainObject$1(e[0])?e[0]:{};const t=e[0];return isPlainObject$1(t)?{url:t.url,para:e[1],target:e[2],feature:void 0}:{url:e[0],para:e[1],target:e[2],feature:e[3]}}function doHyperlink({hyperlinkProps:e,execute:t,byPost:r,store:n}){if(["_self","_blank"].includes(e.target)){const{url:t,target:n,para:o}=e;handleHyperlinkClick({target:TARGET_TYPE_MAP[n]||TARGET_TYPE.BLANK,parameters:o,url:t,title:getSearchParamFromUrl(t,"viewlet",(e=>{const t=e.lastIndexOf(".");return-1!==t?e.slice(0,t):e}))||"",byPost:r})}else{if("_dialog"===e.target)return openHyperlinkDialog(e,r,n);t(e)}}function postMessage(e){window.postMessage(e,"*")}const getCurrentLocation=noop$6,logoutApp=noop$6,getDeviceInfo=noop$6,scanCode=noop$6,convertInnerContent=e=>(isHTMLFrameElement(e)&&convertFrameElementStyle(e),e),openDialog=e=>{const{width:t,height:r,dialogType:n=DIALOG_TYPE.CENTER,coordinate:o=[0,0],line:i={type:"color",value:{color:"#00FFFF"}},innerContent:a,padding:s,title:l,titleStyle:c,backgroundStyle:u={backgroundColor:"#ffffff"},onCancel:d,ref:h,store:p}=e,f={padding:s,titleDisplay:!!l,titleStyle:c,innerContentStyle:{gap:p.platform.isMobile?"12px":"16px"},backgroundStyle:u},g=getDialogChildrenReactNode(convertInnerContent(a));if(n===DIALOG_TYPE.DYNAMIC){const e=normalizeWidth(t),n=normalizeHeight(r);return createPopover$1({store:p,ref:h,onShow:()=>{p.setIsPlay(!1)},onHidden:()=>{p.setIsPlay(!0),null==d||d()},line:i,coordinate:o,width:e,height:n,children:({left:t,top:r})=>jsx(PopoverWrapper,{title:l,top:r,left:t,width:e,height:n,content:g,styleConfig:f})})}const m=jsx(PopoverContent$1,{title:l,styleConfig:f,content:g}),y=normalizeHeight(r);return openPreviewDialog(jsx(DialogWrapper,{className:"duchamp-centered-dialog",width:t,height:Number.isNaN(y)?r:y,styles:{wrapper:{background:"none"}},onCancel:d,children:m}))};function closeActiveTab(){closeActiveTabByTabPane()}function addItem(e){addItemByTabPane(e)}const popupTemplate$1=(e,t,r)=>({close:noop$6}),navigateToWidget$1=(e,t)=>noop$6;function openUrlByGet({url:e,target:t,parameters:r}){const n=appendQueryParams(e,r);if(!REGEX_URL_START_WITH_HTTP_S.test(n)&&!n.startsWith(FR.fineServletURL)){const e=document.createElement("a");return e.href=n,e.target=TARGET_TYPE.BLANK,void e.click()}if(t!==TARGET_TYPE.SELF)if(isFineNativeEnv()){postMessage({fine_message:{url:n,urlParams:{para:{},method:"GET"},type:WEB_MESSAGE_TYPES$1.HYPERLINK}})}else getTopWindow().location.href=n;else window.location.replace(n)}const createTemplateUrlConversion=e=>t=>{const[r,n]=t.split("?");if(!r||!n)return t;const o=new URLSearchParams(n);return"".concat(r,"?").concat(e(o).toString())},convertMobileUrlForOp=createTemplateUrlConversion((e=>{if("true"===e.get(MOBILE_UNIQUE_PARAMS.FORCE_WEB))return e;const t=e.get(MOBILE_UNIQUE_PARAMS.VIEWLET),r=(null==t?void 0:t.endsWith(".cpt"))||(null==t?void 0:t.endsWith(".frm")),n=e.get(MOBILE_UNIQUE_PARAMS.OP),o=e.get(MOBILE_UNIQUE_PARAMS.DISPLAY_PHONE),i=getParamInURL(MOBILE_UNIQUE_PARAMS.OP);"h5"===i&&!n&&e.set(MOBILE_UNIQUE_PARAMS.OP,i);const a=getParamInURL(MOBILE_UNIQUE_PARAMS.DISPLAY_PHONE);return a&&!o&&e.set(MOBILE_UNIQUE_PARAMS.DISPLAY_PHONE,a),r?("view"===n&&e.set(MOBILE_UNIQUE_PARAMS.BY_PAGE_SIZE,"false"),e.set(MOBILE_UNIQUE_PARAMS.OP,"write"===n||"h5_write"===n?"h5_write":"h5"),e):e})),convertMobileUrlForWebview=createTemplateUrlConversion((e=>{const t=getParamInURL(MOBILE_UNIQUE_PARAMS.FINE_WEBVIEW);return"true"===t&&(e.set(MOBILE_UNIQUE_PARAMS.FINE_WEBVIEW,t),e.set(MOBILE_UNIQUE_PARAMS.PI,"false")),e})),getAndProcessURLParams=e=>{const t={};return Object.entries(e).forEach((([e,r])=>{const n=getParamInURL(e);n&&(t[e]=r.needDecode?safeDecodeURIComponent(n):n)})),t},processMobileParams=e=>{const t=getAndProcessURLParams({[MOBILE_UNIQUE_PARAMS.JS_API_PATH]:{needDecode:!0},[MOBILE_UNIQUE_PARAMS.APP_ID]:{}});return processLinkParams(e||{},{format:[{condition:e=>e instanceof Date,handler:e=>dayjs(e).format("YYYY-MM-DD HH:mm:ss")}],remove:[MOBILE_UNIQUE_PARAMS.DEVICE_TYPE],add:t})};function handleHyperlink({url:e,target:t,parameters:r,byPost:n=!1,extendParameters:o,duchampServer:i}){const a=convertParamsArrayToObject(r||{});o?i.getTemplateParameters(a).then((r=>{handleHyperlinkByLocation({url:e,target:t,byPost:n,parameters:{__parameters__:processParams(r)}})})):handleHyperlinkByLocation({url:e,target:t,byPost:n,parameters:processParams(a)})}const handleHyperlinkByLocation=({url:e,target:t,parameters:r,byPost:n=!1})=>{if(!e)return;t===TARGET_TYPE.SELF&&(e=convertMobileUrlForWebview(e)),e=convertMobileUrlForOp(e);const o=processMobileParams(r);if(!n)return void openUrlByGet({url:e,target:t,parameters:o});const[i,a]=filterParamsWithUniqueKeys$1(o),s=appendQueryParams(e,i),l=t===TARGET_TYPE.SELF?TARGET_TYPE.SELF:TARGET_TYPE.TOP;if(isFineNativeEnv()&&l===TARGET_TYPE.TOP){postMessage({fine_message:{url:s,urlParams:{para:a,method:"POST"},type:WEB_MESSAGE_TYPES$1.HYPERLINK}})}else openUrlByPost$1({url:s,target:l,parameters:a})},EXTENSIONS_REGEX=/\.(cpt|frm|fvs)$/;function hasExtension(e){return EXTENSIONS_REGEX.test(e)}const DEFAULT_SIZE$3={heightPercent:95,type:"custom",widthPercent:95},ARROW_SIZE=24;function convertToBorderStyle(e,t=!1){if(!e)return{};const{color:r,type:n,borderRadius:o}=e;return t?{"--border-width":"".concat(n,"px"),"--border-style":"solid","--border-radius":"".concat(o,"px"),...n?{"--border-color":r}:{}}:{borderStyle:"solid",borderRadius:o,borderWidth:n,borderColor:r}}function convertToSize(e=DEFAULT_SIZE$3,t){const r=isPad()&&t?t:e,{heightPercent:n,widthPercent:o,type:i}=r;return"custom"===i?{height:"".concat(n,"vh"),width:"".concat(o,"vw")}:{width:"".concat(o,"vw")}}function isAutoHeight$1(e=DEFAULT_SIZE$3,t){return"auto_height"===(isPad()&&t?t:e).type}function convertToFontStyle(e){if(!e)return{};const{color:t,size:r,fontName:n,ul:o,bold:i,italic:a}=e;return{fontStyle:a?"italic":"normal",fontWeight:i?"bold":"normal",textDecorationLine:o?"underline":"none",color:t,fontSize:r,fontFamily:n}}function handleTemplate2Path(e){return isString$3(e)&&!/^https?:\/\//i.test(e)?{value:e,pathType:PATH_TYPE.TEMPLATE}:e}const generateTemplateHref=async(e,t={})=>{const r=handleTemplate2Path(e),n=isString$3(r)?r:await executePathInput2Url(r.value);return getTemplateUrlInModal(n,t)},getTemplateUrlInModal=(e,t={})=>{const r=getSearchParamFromUrl(e,"viewlet"),n=processMobileParams(t);return hasExtension(r)?convertMobileUrlForOp(appendQueryParams(e,{...n,__pi__:!1,fine_webView:!0})):appendQueryParams(e,n)};function getPopoverMaxHeight(e,t){const{innerHeight:r}=window;return"".concat((e<r/2?r-e-t.allHeight:e)-ARROW_SIZE,"px")}const FVS_MODAL_STYLES={MODAL_CONTENT_WRAPPER:{position:"relative",display:"flex",overflow:"hidden",boxSizing:"border-box"},MODAL_CONTENT_BACKGROUND:{boxSizing:"border-box",position:"absolute",inset:"0"},MODAL_CONTENT:{boxSizing:"border-box",position:"relative",display:"flex",overflow:"hidden",width:"100%",flex:"1",flexDirection:"column",gap:"12px"},MODAL_ICON_CLOSE:{boxSizing:"border-box",position:"absolute",top:"0",right:"0",width:"22px",height:"22px",borderRadius:"50%",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAQAAAC0jZKKAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAACYktHRAD/h4/MvwAAAAd0SU1FB+gHCwQqOv2M1RgAAAOlSURBVEjHtZfNbxNHGIef2Ti2Y6dYdYhtlZqmbIhToUqgIg5BWsmNFA69+A9ArdQTlyLxrzgX1Fsl1AMSEC6gUjWohnJKD1VacFocGkdqbcCOTO1grz+2h9XGG++svUnE77Q7O/vsO+/HzLvwjiQ8zQkQIsg40KFJgxbG0cBjJDiFSpxjBBgDerSoUaZAgZd0DgMOcobzzHIMBfZZKIAeNQo8YQP9IGCFFEvM4cdwXbRA0CTPKnnZHBl4kiU0wvQ8+F+hTo4fqTu9OKg4l1nAPzo8ABj4meUEf9MYDj7JV8x7hPaVYIYiNXdwjC9RPblg0O4pkvxlt9oOnuQynxwCa6KjHOdpP0f6YMEXLBzYCXZ0DNiwCMreg3k0T3XoLoFGyrqxwH4+Z9JhrzFkBYZkdpglgvvBKead3k2F58IuaCMVPh1yjPaY44wd7GPB+pLt1dCdxXuXMnEJ2sjE7126vahOOJ75OW/GzQTHUJ2vCwI+dTqrOdBGJp7VTk1PjCvOmBjMkgArK85ywRmK13qxejGWjF6Mvajk63uBNTLxrJaMblevPX6yIwl3gG2KJliQ5iPJgkW+/qIygN7DXs2tlKVZpFDnNxMcZJGoNEiDaEZiQaCzRmcMiJAmhFw29GZlfnJ5FBagyxpvfUCQAO4SK2VyWS0ZvZ6GRGQkFgIEwQf4bPXngjZy19OJCJRq3+TulkceaOOMQB5BCtCmO3SOkYkva4lIqVaqJSLLmrRk7OrRMcFNWsOxZiZceXjl4XY1Gc2OQrdomulmcI4ptz2hn2B3yxsNR17LfPAvj8x06zLLSSl4sBxkJTMowTN+tUr6PT71gAU8oA1+ZssCdznn3N3mwt+lZ4478nYPfWHqh2JFH0ALatznPyvdSjx3flugdzZfScpBrJSv5gqvdts9yf5CgZfmhanP+Brf4KxUSJBvSD1pnA73jMJbx7jOt6xD/zDd4WMcSVTRX7fdtpqqvuN8pvA7D8yqsCqvyQOctokhxSsks+usWg1A//ivMoHK0fQTj63LPthgmxMkDt1ZKKxzS9awgM4WMy5b/mhsgRvs9Af2924NinzoWt7DsJt8zz/2ocFus8afTBM7QE8kgHVu7MfK+uMGTzH4gIAnuxV2WeWW3QluYNDZYIsJ3md8qKUKbZ5xk19k2677kv2kWEAl4vJz84bnrPEHTXcPuctHDBWVOBECKECXFm8oU2CT0rCTx+sPZJggPqBNk10vP5DvTP8DJnN5gQPT/DUAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjQtMDctMTFUMDQ6NDI6NDcrMDA6MDAGtd02AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDI0LTA3LTExVDA0OjQyOjQ3KzAwOjAwd+hligAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyNC0wNy0xMVQwNDo0Mjo1OCswMDowMBofNCIAAAAASUVORK5CYII=')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"},MODAL_TITLE:{boxSizing:"border-box",overflow:"hidden",width:"100%",flex:"0 0 auto",paddingRight:"22px",textOverflow:"ellipsis",whiteSpace:"nowrap",lineHeight:"2"},MODAL_CONTENT_IFRAME:{boxSizing:"border-box",width:"100%",height:"100%",border:"none"},MODAL_LOADING:{boxSizing:"border-box",position:"absolute",inset:"0",display:"flex",alignItems:"center",justifyContent:"center"}};function getMaxModalHeight(){return.95*getRootWindow().innerHeight}const ModalContent=e=>{const{iframe:t,title:r,autoHeight:n,iframeId:o,parameters:i,method:a="GET",extraHeight:s=0,style:l,titleStyle:c,contentStyle:u,iframeWrapperStyle:d,contentBackgroundStyle:h,showModalWithMaxHeight:p,showModalWithAutoHeight:f,onClose:g,duchampApi:m}=e,y=isString$3(t),[v,_]=reactExports.useState(y),[b,C]=reactExports.useState(!0),E=reactExports.useRef(),T=reactExports.useRef(),S=useFrameParentDuchamp(m,[t],e.window||window),P=reactExports.useRef(null),w=P.current,x=getMaxModalHeight(),O=useUpdate$1();return jsxs(Fragment,{children:[v?jsx(DotLoading$1,{style:FVS_MODAL_STYLES.MODAL_LOADING}):null,jsxs("div",{className:classNames$1("fdm-modal-content-wrapper",{hidden:v}),style:{...FVS_MODAL_STYLES.MODAL_CONTENT_WRAPPER,height:n?T.current:void 0,maxHeight:x,visibility:v?"hidden":"visible",...l},children:[jsx("div",{className:"modal-content-background",style:{...FVS_MODAL_STYLES.MODAL_CONTENT_BACKGROUND,...h}}),jsxs("div",{style:{...FVS_MODAL_STYLES.MODAL_CONTENT,...u},children:[r&&jsx("div",{ref:P,style:{...FVS_MODAL_STYLES.MODAL_TITLE,...c},children:r}),y?jsx("div",{style:{height:n?E.current:"100%",flex:n&&E.current?"none":1,...d},children:jsx(Iframe$1,{name:o,ref:S,style:{...FVS_MODAL_STYLES.MODAL_CONTENT_IFRAME,display:b?"block":"none"},src:appendQueryParams(t,{[MOBILE_UNIQUE_PARAMS.FINE_AUTO_HEIGHT]:n},!1),method:a,parameters:i,onMessage:e=>{if(n&&y)try{const r=JSON.parse(e.data),{src:n="",contentHeight:o,type:i}=r.fine_message;if(null==p?void 0:p(n,t,r))return void(T.current=x);if(0===Number(i)&&o&&(null==f?void 0:f(n,t,r))){const e=x-s-(w?null==w?void 0:w.offsetHeight:0);E.current=clamp$5(o,0,e),T.current=void 0,O(),_(!1)}}catch(e3){return}},onLoad:()=>{n?E.current||delay$1((()=>{E.current||T.current||(T.current=x),_(!1)}),1e3):_(!1)}})}):jsx(Fragment,{children:t}),jsx("div",{style:FVS_MODAL_STYLES.MODAL_ICON_CLOSE,onClick:()=>{C(!1),setTimeout((()=>{null==g||g()}),0)}})]})]})]})},MOBILE_MODAL_Z_INDEX=200,CENTER_POPUP_STYLE={zIndex:0,"--z-index":MOBILE_MODAL_Z_INDEX,"--adm-mask-z-index":MOBILE_MODAL_Z_INDEX,"--background-color":"transparent","--border-radius":0,"--min-width":0,"--max-width":"100vw"};function showModal(e){const{bodyStyle:t,onClose:r,...n}=e,o=uuid$1(),i=CenterPopup.show({content:jsx(ModalContent,{...n,iframeId:o,onClose:()=>i.close()}),closeOnMaskClick:!0,getContainer:()=>getRootPortalContainer("modal"),bodyStyle:t,onClose:()=>{null==r||r()},style:CENTER_POPUP_STYLE});return i}function openConfirm(e){Alert$2.confirm({title:e.title,content:e.message,onOk:()=>{var t;null==(t=e.callback)||t.call(e,!0)},onCancel:()=>{var t;null==(t=e.callback)||t.call(e,!1)}})}function openAlert(e){Alert$2.info({title:e.title,content:e.message,onOk:()=>{var t;null==(t=e.callback)||t.call(e)}})}function openToast(e){const t="warn"===e.type?"warning":e.type||"info";Message[t](e.message)}function PromptContent(e){const[t,r]=reactExports.useState(e.defaultValue);return jsxs(Fragment,{children:[jsx("span",{children:e.message}),jsx(Input$2,{value:t,onChange:t=>{r(t),e.onChange(t)}})]})}function openPrompt(e){let{value:t}=e;Alert$2.confirm({title:e.title,content:jsx(PromptContent,{message:e.message,defaultValue:e.value,onChange:e=>{t=e}}),icon:null,onOk:()=>{var r;null==(r=e.callback)||r.call(e,t)}})}let AbstractHandler$1=class{constructor(){__publicField(this,"id"),this.id=v4$1()}};class CustomHandler extends AbstractHandler$1{constructor(){super(...arguments),__publicField(this,"callbackWraps",[])}execute(e){this.callbackWraps.forEach((t=>{t.callback(e)}))}addCallback(e){const t=v4$1();return this.callbackWraps.push({id:t,callback:e}),t}removeCallback(e){this.callbackWraps=this.callbackWraps.filter((t=>t.id!==e))}accept(){return!0}}class ParameterHandler extends AbstractHandler$1{execute(e){}accept(e){return e===MESSAGE_TYPE$1.PARAMETER}}const MESSAGE_TYPE$1={PARAMETER:"parameter",CLICK:"click"};class PostMessageChannel{constructor(e=[]){__publicField(this,"origins",[]),__publicField(this,"handlers",[]),__publicField(this,"customHandler",null),this.origins=e,this.init()}init(){window.addEventListener("message",(e=>{const{data:t,origin:r}=e;this.getOrigins().some((e=>e===r))&&t&&this.receive(t)}))}getOrigins(){return this.origins}updateOrigins(e){this.origins=e}send(e){document.querySelectorAll("iframe").forEach((t=>{this.getOrigins().forEach((r=>{var n;null==(n=t.contentWindow)||n.postMessage(e,r)}))}))}receive(e){const t=this.handlers.find((t=>t.accept(e.type)));null==t||t.execute(e)}addHandler(e){return this.handlers.push(e),e.id}addCustomHandler(){const e=new CustomHandler;return this.addHandler(e),this.customHandler=e,e.id}removeHandler(e){this.handlers=this.handlers.filter((t=>t.id!==e))}addCustomCallback(e){var t;return null==(t=this.customHandler)?void 0:t.addCallback(e)}removeCustomCallback(e){var t;null==(t=this.customHandler)||t.removeCallback(e)}}function createMessageChannel(){const e=new PostMessageChannel;return e.addHandler(new ParameterHandler),e.addCustomHandler(),e}const postMessageChannel=createMessageChannel();function jsApi(e){return function(t,r){var n,o;const{alias:i=r,travel:a=!1,flatten:s=!1}=null!=(n=isString$3(e)?{alias:e}:e)?n:{},l={name:i,key:r,travel:a,flatten:s};t.apiList=[...null!=(o=t.apiList)?o:[],l]}}var FileSaver_min={exports:{}};!function(e,t){!function(){function t(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function r(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){s(n.response,t,r)},n.onerror=function(){console.error("could not download file")},n.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(r){}return 200<=t.status&&299>=t.status}function o(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof commonjsGlobal$1&&commonjsGlobal$1.global===commonjsGlobal$1?commonjsGlobal$1:void 0,a=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(e,t,a){var s=i.URL||i.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?o(l):n(l.href)?r(e,t,a):o(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){o(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,i,a){if(i=i||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,a),i);else if(n(e))r(e,i,a);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){o(s)}))}}:function(e,t,n,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof e)return r(e,t,n);var s="application/octet-stream"===e.type,l=/constructor/i.test(i.HTMLElement)||i.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&l||a)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=e:location=e,o=null},u.readAsDataURL(e)}else{var d=i.URL||i.webkitURL,h=d.createObjectURL(e);o?o.location=h:location.href=h,o=null,setTimeout((function(){d.revokeObjectURL(h)}),4e4)}});i.saveAs=s.saveAs=s,e.exports=s}()}(FileSaver_min);var FileSaver_minExports=FileSaver_min.exports;const saveAs=getDefaultExportFromCjs$1(FileSaver_minExports),PERFORMANCE_MARK={DUCHAMP_INIT:"DUCHAMP_INIT",DATA_INIT:"DATA_INIT",DATA_INIT_START:"DATA_INIT_START",DATA_INIT_END:"DATA_INIT_END",STORY_CALCULATE_INIT:"STORY_CALCULATE_INIT",WIDGETS_LOADED:"WIDGETS_LOADED"};function getMarkStartTime(e){var t,r;return null!=(r=null==(t=performance.getEntriesByName(e).at(0))?void 0:t.startTime)?r:-1}function getNowMeasure(e){try{const t=performance.getEntriesByName(e).at(0);return t?performance.now()-t.startTime:-1}catch(e3){return-2}}function getNavigationInfo(e){try{return e?{...pick(e.toJSON(),["startTime","duration","workerStart","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","firstInterimResponseStart","responseEnd","transferSize","encodedBodySize","decodedBodySize","unloadEventStart","unloadEventEnd","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd","type","redirectCount","activationStart"]),protocol:e.nextHopProtocol}:{}}catch(e3){return{}}}function getInfoByResource(e){var t;try{const r=performance.getEntriesByType("resource");let n={duration:-1,transferSize:-1,decodedBodySize:-1};return r.forEach((e=>{e.name.includes("duchamp/compute")&&e.duration>n.duration&&(n=e)})),{resourcesCount:r.length,deliveryType:(null==(t=r.at(0))?void 0:t.deliveryType)||"",MCDuration:e?-2:n.duration,MCDecodedBodySize:n.decodedBodySize,MCTransferSize:n.transferSize}}catch(e3){return{}}}const TIME_OUT=1e3,TIME_OUT_PAGE=6e4,calculateMaxAnimationDelay=(e,t)=>{let r=0;return e.forEach((e=>{var n,o;const i=timeUnitToMillisecond(oldTime2TimeSecond((null==(n=e.model.states.animation[t])?void 0:n.delay)||0))+timeUnitToMillisecond(oldTime2TimeMillisecond((null==(o=e.model.states.animation[t])?void 0:o.duration)||0));r=Math.max(i,r)})),r},widgetAnimationDelay=e=>{const t=e.currentPreviewStoryIndex,r=t>0?e.stories[t-1]:null,n=e.stories[t];return(r?calculateMaxAnimationDelay(r.widgets,"out"):0)+calculateMaxAnimationDelay(n.widgets,"in")},emitCurrentStoryLoaded=async e=>{const t=uuid$2(),r=Math.max(widgetAnimationDelay(e),getTransitionTime(e)),{loadedManager:n}=e;n.removeAllListeners(),n.setCurrentLoadId(t);const o=getNeedWaitWidgets(e.story.relatedWidgets.filter((e=>""===e.parent)));let i=!1;if(0===e.story.relatedWidgets.length)return void(await new Promise((t=>setTimeout((()=>{n.updateLastEmitId(),e.eventEmitter.emit(DUCHAMP_EVENTS.PAGE_LOADED,e.currentPreviewStoryIndex,i),t()}),TIME_OUT+r))));n.initNeedLoadList(o);const a=n.getStoryIdentifyId(),s=Promise.all([...0===n.getNeedLoadListSize()?[]:[new Promise((e=>n.addListener(STORY_LOADED_EVENT.WIDGET_LOAD_FINISHED,((t,r=!1)=>{var o,i;r?e(!0):(n.addLoadedId(t),0===n.getNeedLoadListSize()&&(null==(i=(o=window.performance).mark)||i.call(o,PERFORMANCE_MARK.WIDGETS_LOADED),n.removeAllListeners(STORY_LOADED_EVENT.WIDGET_LOAD_FINISHED),e(!0)))}))))],new Promise((e=>n.addListener(STORY_LOADED_EVENT.STORY_INIT_CALCULATE_FINISHED,(t=>{var r,o;t===n.getStoryIdentifyId()&&(null==(o=(r=window.performance).mark)||o.call(r,PERFORMANCE_MARK.STORY_CALCULATE_INIT),n.removeAllListeners(STORY_LOADED_EVENT.STORY_INIT_CALCULATE_FINISHED),e(!0))}))))]);let l;const c=new Promise((e=>l=setTimeout((()=>{n.getCurrentLoadId()===t&&(i=!0,n.emit(STORY_LOADED_EVENT.WIDGET_LOAD_FINISHED,"",!0),n.emit(STORY_LOADED_EVENT.STORY_INIT_CALCULATE_FINISHED,a)),e(!0)}),TIME_OUT_PAGE,!0)));await new Promise((e=>setTimeout((()=>{e()}),TIME_OUT+r))),await Promise.race([s,c]).finally((()=>{window.clearTimeout(l)})),n.getCurrentLoadId()===t&&(n.updateLastEmitId(),e.eventEmitter.emit(DUCHAMP_EVENTS.PAGE_LOADED,e.currentPreviewStoryIndex,i))},getTransitionTime=e=>{if(-1===e.prevStory)return 0;const t=e.mainStory;if(!t.transition.open)return 0;return timeUnitToMillisecond(oldTime2TimeMillisecond(t.transition.duration))},getNeedWaitWidgets=e=>{const t=new Set,r=e=>{e.forEach((e=>{t.add(e),r(e.availableChildWidgets)}))};return r(e),Array.from(t).filter((e=>{const t=e.getInstance();return"loadedEmit"in t&&t.isVisible})).map((e=>e.id))},IMAGE_TYPE="image/png",IMG_MAX_WIDTH=10,IMG_MAX_HEIGHT=5.625,MAX_PDF_HEIGHT=9600,EXPORT_TARGET_CLASS=".adaptive-wrapper";function getTemplateRect(e,t){const r=e.target.querySelector(EXPORT_TARGET_CLASS);if(!r)return{width:0,height:0};const n=isUndefined$3(t)?1:Math.min(t/r.offsetWidth,t/r.offsetHeight,1);return{width:r.offsetWidth*n,height:r.offsetHeight*n}}const exportPresentationFile=async({store:e,format:t,merge:r=!0,delay:n,scale:o,name:i=document.title})=>{if(e.isExporting)return;e.setExporting(!0);const a={delay:n||0,name:i,scale:o},s=null==t?void 0:t.toUpperCase();"IMAGE"!==s&&t?"PDF"===s?r?await exportPdf(e,a):await exportPdfsWithZip(e,a):"PPT"===s&&await exportPPT(e,a):r?await exportImage(e,a):await exportImagesWithZip(e,a),e.setExporting(!1)},getSingleImage=async(e,t)=>{const{watermarkData:r,story:n}=e,{background:o}=n,i=isStoryBackground(o),a=e.target.querySelector(EXPORT_TARGET_CLASS);if(!a)return"";const s=await __vitePreload((()=>import("./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/html2canvas.esm-hash-Cssr678X.js")),[],import.meta.url),l=await s.default(a,{useCORS:!0,height:a.offsetHeight,width:a.offsetWidth,scale:t,onclone:async t=>{const r=t.querySelector(EXPORT_TARGET_CLASS);r&&e.exportAdapterManager.adapterStyles(i,r)}}),c=document.createElement("canvas");r&&paintWaterMark(l,c,r);return l.toDataURL(IMAGE_TYPE,1)},fetchStoryImages=async(e,t)=>{const r=[],{delay:n=0,scale:o}=t,i=Math.min(1e3*n,TIME_OUT_PAGE);e.exportAdapterManager.cancelExportAnimation();for(let s=e.currentPreviewStoryIndex;s<e.previewStories.length;s++)try{e.previewSwitchStory(s),await new Promise((e=>setTimeout(e,i))),e.loadedManager.getCurrentPageIsEmit()||await new Promise((t=>{e.eventEmitter.once(DUCHAMP_EVENTS.PAGE_LOADED,t)}));const t=await getSingleImage(e,o);r.push(t)}catch(a){console.error(a)}return e.exportAdapterManager.restoreAnimations(),r},createAndSaveZip=async(e,t)=>{const r=new((await __vitePreload((()=>import("./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/jszip.min-hash-Sbtucb23.js").then((e=>e.j))),__vite__mapDeps([10,3,4]),import.meta.url)).default);e.forEach((({data:e,name:t,options:n={}})=>{r.file(t,e,n)}));const n=await r.generateAsync({type:"blob"});saveAs(n,"".concat(t,".zip"))},exportImagesWithZip=async(e,t)=>{const r=e.currentPreviewStoryIndex,n=(await fetchStoryImages(e,t)).map(((t,n)=>({data:t.split("base64,")[1],name:"".concat(e.previewStories[n+r].name,".png"),options:{base64:!0}})));await createAndSaveZip(n,t.name||document.title)},exportImage=async(e,t)=>{const r=await fetchStoryImages(e,t),n=await combineImages(r);n&&saveAs(n,"".concat(t.name||document.title,".png"))},createAndSavePPT=async(e=document.title,t,r,n)=>{const o=new((await __vitePreload((()=>import("./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/pptxgen.es-hash-uNjpWiE5.js")),__vite__mapDeps([11,3,4]),import.meta.url)).default);t.forEach((e=>{const t=r/n;let i,a;t>IMG_MAX_WIDTH/IMG_MAX_HEIGHT?(i=IMG_MAX_WIDTH,a=IMG_MAX_WIDTH/t):(a=IMG_MAX_HEIGHT,i=IMG_MAX_HEIGHT*t);const s=(IMG_MAX_WIDTH-i)/2,l=(IMG_MAX_HEIGHT-a)/2;o.addSlide().addImage({data:e,x:s,y:l,w:i,h:a})})),o.writeFile({fileName:"".concat(e,".pptx")})},exportPPT=async(e,t)=>{const r=await fetchStoryImages(e,t),{width:n,height:o}=getTemplateRect(e);await createAndSavePPT(t.name,r,n,o)},createAndSavePdf=async(e=document.title,t,r)=>{const{width:n,height:o}=getTemplateRect(r,MAX_PDF_HEIGHT),i=Math.min(MAX_PDF_HEIGHT/n,MAX_PDF_HEIGHT/o,1),a=n*i,s=o*i,l=n>o?"l":"p",c=new((await __vitePreload((()=>import("./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/jspdf.es.min-hash-BTRMtdGT.js")),__vite__mapDeps([12,3,4,6,7,8]),import.meta.url)).default)(l,"px",[a,s]);t.forEach(((e,t)=>{0!==t&&c.addPage(),e&&c.addImage(e,"PNG",0,0,a,s,void 0,"FAST")})),c.save("".concat(e,".pdf"))},exportPdf=async(e,t)=>{const r=await fetchStoryImages(e,t);await createAndSavePdf(t.name,r,e)},createPdfsFromImages=async(e,t,r)=>{const{width:n,height:o}=getTemplateRect(e,MAX_PDF_HEIGHT),i=Math.min(MAX_PDF_HEIGHT/n,MAX_PDF_HEIGHT/o,1),a=n*i,s=o*i;return await Promise.all(t.map(((t,i)=>(async(t,i)=>{const l=n>o?"l":"p";let c=new Blob;if(t){const e=new((await __vitePreload((()=>import("./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/jspdf.es.min-hash-BTRMtdGT.js")),__vite__mapDeps([12,3,4,6,7,8]),import.meta.url)).default)(l,"px",[a,s]);e.addImage(t,"PNG",0,0,a,s,void 0,"FAST"),c=e.output("blob")}return{data:c,name:"".concat(e.previewStories[i+r].name,".pdf")}})(t,i))))},exportPdfsWithZip=async(e,t)=>{const r=e.currentPreviewStoryIndex,n=await fetchStoryImages(e,t),o=await createPdfsFromImages(e,n,r);await createAndSaveZip(o,t.name||document.title)};async function combineImages(e){const t=e.map((e=>{const t=new Image;return t.src=e,t}));await Promise.all(t.map((e=>new Promise((t=>e.onload=t)))));const r=document.createElement("canvas"),n=r.getContext("2d");r.width=Math.max(...t.map((e=>e.width))),r.height=t.reduce(((e,t)=>e+t.height),0);let o=0;for(const i of t)null==n||n.drawImage(i,0,o),o+=i.height;return new Promise((e=>r.toBlob(e,IMAGE_TYPE,1)))}const exportPresentationFileWithUrl=e=>{const t=getParamInURL("op"),r=getParamInURL("format")||"",n=getParamInURL("merge")||"true",o=Number(getParamInURL("delay")||""),i=Number(getParamInURL("scale")||""),a=isNaN(o)?0:o,s=isNaN(i)||0===i?void 0:i,l=getParamInURL("disableAutoplay")||"",c=getParamInURL("disableAnimation")||"";"true"===l&&e.exportAdapterManager.disableAutoPlay(),"true"===c&&e.exportAdapterManager.disableAnimation(),"export"===t&&exportPresentationFile({store:e,format:r,merge:"true"===n,delay:a,scale:s})};var __defProp$S=Object.defineProperty,__getOwnPropDesc$O=Object.getOwnPropertyDescriptor,__decorateClass$R=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$O(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$S(t,r,i),i};const ORIGIN_FR_KEY={GET:"doHyperlinkByGet",POST:"doHyperlinkByPost"};class Duchamp{constructor(e,t,r){__publicField(this,"_store"),__publicField(this,"config"),__publicField(this,"__window__",{}),__publicField(this,"mode"),__publicField(this,"originFRFunctions",new Map),this.mode=e,this._store=t,this.config=r,this.init()}get env(){return this.store.duchampServer.getEnvInfo()}get store(){if(!this._store)throw new Error("store is not defined");return this._store}setStore(e){this._store=e}setConfig(e){this.config=e}init(){window.addEventListener("load",(()=>{this.originFRFunctions.set(ORIGIN_FR_KEY.GET,FR.doHyperlinkByGet),this.originFRFunctions.set(ORIGIN_FR_KEY.POST,FR.doHyperlinkByPost),FR.Msg.toast=e=>{"string"==typeof e&&(e={message:e}),this.Msg.toast(e)},FR.showIframeDialog=e=>{const t=document.createElement("iframe");t.width="100%",t.height="100%",t.scrolling="no",t.style.border="0";const r={title:" ",width:350,height:480,innerContent:t,store:this.store};let n="";if(isString$3(e))n=e;else{const{title:t,width:o,height:i,url:a}=e;n=a,r.title=t||" ",r.width=parseInt(o),r.height=parseInt(i)}t.src="".concat(n+(n.includes("?")?"&":"?"),"timestamp=").concat(Date.now()),this.showDialog(r)},FR.doHyperlinkByGet=(...e)=>{if(e.length<1)return;const t=getFRDoHyperlinkParams(e);return t.target===TARGET_TYPE.DIALOG?this.doHyperlinkByGet(t):this.originFRFunctions.get(ORIGIN_FR_KEY.GET).call(FR,t)},FR.doHyperlinkByPost=(...e)=>{if(e.length<1)return;const t=getFRDoHyperlinkParams(e);return t.target===TARGET_TYPE.DIALOG?this.doHyperlinkByPost(t):this.originFRFunctions.get(ORIGIN_FR_KEY.POST).call(FR,t)},window.FS={tabPane:{closeActiveTab:closeActiveTab,addItem:addItem},popupTemplate:popupTemplate$1}}))}get buildInfo(){return fvsService.getBuildInfo()}registerWidget(e){return widgetManager.register(e)}on(e,t){this.store.eventEmitter.on(e,t)}once(e,t){this.store.eventEmitter.once(e,t)}off(e,t){this.store.eventEmitter.off(e,t)}emit(e,...t){this.store.eventEmitter.emit(e,...t)}reload(){window.location.reload()}requestFullscreen(){document.documentElement.requestFullscreen()}exitFullscreen(){document.exitFullscreen()}exportTemplate(e={}){exportPresentationFile({store:this.store,...e})}isCurrentStory(e){return this.store.mainStory.name===e}switchStory(e,t){const r=this.store.previewStories.findIndex((t=>t.name===e));this.store.previewSwitchStory(r,t)}previousStory(e){this.store.previewPreviousStory(e)}nextStory(e){this.store.previewNextStory(e)}getCurrentStoryIndex(){return this.store.currentPreviewStoryIndex}hideStory(e){const{store:t}=this,r=t.stories.findIndex((t=>t.name===e));t.switchStoryPreviewHidden(r,!0)}showStory(e){const{store:t}=this,r=t.stories.findIndex((t=>t.name===e));t.switchStoryPreviewHidden(r,!1)}setPageButtonDisplayPolicy(e){this.store.setPageButtonDisplayPolicy(e)}getWidgetById(e){const{store:t}=this,r=t.allWidgets.find((t=>t.id===e));return null==r?void 0:r.getInstance()}getWidgetByName(e){const t=this.store.story.relatedWidgets.find((t=>t.name===e));return null==t?void 0:t.getInstance()}getAllWidgets(){const e=this.store.story.relatedWidgets;return null==e?void 0:e.map((e=>null==e?void 0:e.getInstance()))}pauseRollPlay(){this.store.setIsPlay(!1)}continueRollPlay(){this.store.setIsPlay(!0)}isCurrentStoryWidget(e){return!!this.getWidgetById(e)}get servletURL(){var e,t;return null!=(t=null==(e=this.config)?void 0:e.servletURL)?t:FR.servletURL}get serverURL(){var e,t;return null!=(t=null==(e=this.config)?void 0:e.serverURL)?t:FR.serverURL}get server(){var e,t;return null!=(t=null==(e=this.config)?void 0:e.server)?t:FR.server}get fineServletURL(){var e,t;return null!=(t=null==(e=this.config)?void 0:e.fineServletURL)?t:FR.fineServletURL}get SessionMgr(){return{getSessionID:()=>{var e,t;return null!=(t=null==(e=this.config)?void 0:e.sessionId)?t:FR.SessionMgr.getSessionID()}}}linkageGlobal(e){return this.store.calculateCenter.linkageGlobal(new Filter("and").updateParameterFilters(e))}showDialog(e){return openDialog({...e,store:this.store})}showGuideLineDialog(e){return openDialog({...e,store:this.store,dialogType:DIALOG_TYPE.DYNAMIC})}closeDialog(e){var t,r,n;e?(closeFVSDialogById(e),closePopoverById(e)):(closePopover(),closeFVSDialog(),null==(n=null==(r=null==(t=window.BI)?void 0:t.Popovers)?void 0:r.removeAll)||n.call(r))}doHyperlinkByGet(e){return doHyperlink({hyperlinkProps:e,execute:e=>{this.originFRFunctions.get(ORIGIN_FR_KEY.GET).call(FR,e)},byPost:!1,store:this.store})}doHyperlinkByPost(e){return doHyperlink({hyperlinkProps:e,execute:e=>{this.originFRFunctions.get(ORIGIN_FR_KEY.POST).call(FR,e)},byPost:!0,store:this.store})}get Msg(){return{alert(e){openAlert(e)},toast(e){openToast(e)},confirm(e){openConfirm(e)},prompt(e){openPrompt(e)}}}jsonEncode(e){return FR.jsonEncode(e)}jsonDecode(e){return FR.jsonDecode(e)}ajax(e){return FR.ajax(e)}isEmpty(e){return FR.isEmpty(e)}isArray(e){return FR.isArray(e)}cellStr2ColumnRow(e){return FR.cellStr2ColumnRow(e)}columnRow2CellStr(e){return FR.columnRow2CellStr(e)}postMessage(e){postMessageChannel.send(e)}onlyCommunicateWithOrigins(e){postMessageChannel.updateOrigins(e)}addPostMessageListener(e){return postMessageChannel.addCustomCallback(e)}removePostMessageListener(e){postMessageChannel.removeCustomCallback(e)}remoteEvaluate(e){var t,r;const n=null!=(r=null==(t=otherService.remoteGetDepsSync([e]).result)?void 0:t.parameter)?r:[],{parameterCenter:o}=this.store.calculateCenter,i=n.reduce(((e,t)=>{const r=o.getValue(t);return!isNil$3(r)&&(e[t]=r),e}),{});return otherService.remoteComputeSync(e,i)}location(e){getCurrentLocation(e)}clearExpiredIndexedDBCache(e){clearExpiredCache(e)}logoutApp(){logoutApp()}getDeviceInfo(){return getDeviceInfo()}scanCode(e){return scanCode(e)}getRootStore(){return this.store}jumpToMark(e){e&&navigateToWidget$1(e,this.store)}}function createApi(e){return(null==e?void 0:e.apiList)?createInternal(e,e.apiList):null}function createInternal(e,t){const r={get(r,n){if("__window__"===n)return e[n];const o=t.find((e=>e.name===n));if(isNil$3(o))return;const{key:i,travel:a}=o,s=e[i],l=isFunction$8(s);return a?l?function(...t){return createTravelApi(s.bind(e)(...t))}:createTravelApi(s):l?s.bind(e):s}};return handleFlatten(new Proxy(Object.create(null),r),t)}function createTravelApi(e){return isArray$c(e)?e.map((e=>createApi(e))):createApi(e)}__decorateClass$R([jsApi()],Duchamp.prototype,"mode",2),__decorateClass$R([jsApi()],Duchamp.prototype,"env",1),__decorateClass$R([jsApi()],Duchamp.prototype,"buildInfo",1),__decorateClass$R([jsApi()],Duchamp.prototype,"registerWidget",1),__decorateClass$R([jsApi()],Duchamp.prototype,"on",1),__decorateClass$R([jsApi()],Duchamp.prototype,"once",1),__decorateClass$R([jsApi()],Duchamp.prototype,"off",1),__decorateClass$R([jsApi()],Duchamp.prototype,"reload",1),__decorateClass$R([jsApi()],Duchamp.prototype,"requestFullscreen",1),__decorateClass$R([jsApi()],Duchamp.prototype,"exitFullscreen",1),__decorateClass$R([jsApi()],Duchamp.prototype,"exportTemplate",1),__decorateClass$R([jsApi()],Duchamp.prototype,"isCurrentStory",1),__decorateClass$R([jsApi()],Duchamp.prototype,"switchStory",1),__decorateClass$R([jsApi()],Duchamp.prototype,"previousStory",1),__decorateClass$R([jsApi()],Duchamp.prototype,"nextStory",1),__decorateClass$R([jsApi()],Duchamp.prototype,"getCurrentStoryIndex",1),__decorateClass$R([jsApi()],Duchamp.prototype,"hideStory",1),__decorateClass$R([jsApi()],Duchamp.prototype,"showStory",1),__decorateClass$R([jsApi()],Duchamp.prototype,"setPageButtonDisplayPolicy",1),__decorateClass$R([jsApi({travel:!0})],Duchamp.prototype,"getWidgetById",1),__decorateClass$R([jsApi({travel:!0})],Duchamp.prototype,"getWidgetByName",1),__decorateClass$R([jsApi({travel:!0})],Duchamp.prototype,"getAllWidgets",1),__decorateClass$R([jsApi()],Duchamp.prototype,"pauseRollPlay",1),__decorateClass$R([jsApi()],Duchamp.prototype,"continueRollPlay",1),__decorateClass$R([jsApi()],Duchamp.prototype,"isCurrentStoryWidget",1),__decorateClass$R([jsApi()],Duchamp.prototype,"servletURL",1),__decorateClass$R([jsApi()],Duchamp.prototype,"serverURL",1),__decorateClass$R([jsApi()],Duchamp.prototype,"server",1),__decorateClass$R([jsApi()],Duchamp.prototype,"fineServletURL",1),__decorateClass$R([jsApi()],Duchamp.prototype,"SessionMgr",1),__decorateClass$R([jsApi()],Duchamp.prototype,"linkageGlobal",1),__decorateClass$R([jsApi()],Duchamp.prototype,"showDialog",1),__decorateClass$R([jsApi()],Duchamp.prototype,"showGuideLineDialog",1),__decorateClass$R([jsApi()],Duchamp.prototype,"closeDialog",1),__decorateClass$R([jsApi()],Duchamp.prototype,"doHyperlinkByGet",1),__decorateClass$R([jsApi()],Duchamp.prototype,"doHyperlinkByPost",1),__decorateClass$R([jsApi()],Duchamp.prototype,"Msg",1),__decorateClass$R([jsApi()],Duchamp.prototype,"jsonEncode",1),__decorateClass$R([jsApi()],Duchamp.prototype,"jsonDecode",1),__decorateClass$R([jsApi()],Duchamp.prototype,"ajax",1),__decorateClass$R([jsApi()],Duchamp.prototype,"isEmpty",1),__decorateClass$R([jsApi()],Duchamp.prototype,"isArray",1),__decorateClass$R([jsApi()],Duchamp.prototype,"cellStr2ColumnRow",1),__decorateClass$R([jsApi()],Duchamp.prototype,"columnRow2CellStr",1),__decorateClass$R([jsApi()],Duchamp.prototype,"postMessage",1),__decorateClass$R([jsApi()],Duchamp.prototype,"onlyCommunicateWithOrigins",1),__decorateClass$R([jsApi()],Duchamp.prototype,"addPostMessageListener",1),__decorateClass$R([jsApi()],Duchamp.prototype,"removePostMessageListener",1),__decorateClass$R([jsApi()],Duchamp.prototype,"remoteEvaluate",1),__decorateClass$R([jsApi()],Duchamp.prototype,"location",1),__decorateClass$R([jsApi()],Duchamp.prototype,"clearExpiredIndexedDBCache",1),__decorateClass$R([jsApi()],Duchamp.prototype,"logoutApp",1),__decorateClass$R([jsApi()],Duchamp.prototype,"getDeviceInfo",1),__decorateClass$R([jsApi()],Duchamp.prototype,"scanCode",1),__decorateClass$R([jsApi({travel:!0,flatten:!0})],Duchamp.prototype,"getRootStore",1),__decorateClass$R([jsApi()],Duchamp.prototype,"jumpToMark",1);const BLACK_API_LIST=["constructor"];function handleFlatten(e,t){const r=t.filter((e=>e.flatten)).map((e=>e.key)),n={get(t,n){if(BLACK_API_LIST.includes(n))return;const o=e[n];if(isUndefined$3(o)||r.includes(n))for(const i of r){const t=e[i],r=(isFunction$8(t)?t():t)[n];if(!isUndefined$3(r))return r}return o}};return new Proxy(Object.create(null),n)}let duchamp;function createEditorAPI(e,t,r){const{injectToWindow:n=!0,...o}={};return duchamp=new Duchamp(e,t,o),n&&(window.duchamp=createApi(duchamp)),duchamp}async function getUrl(e,t={}){if("templatePath"in e&&e.templatePath){return await generateTemplateHref(e.templatePath,t)}if("url"in e&&e.url)return appendQueryParams(e.url,t)}function showModalWithMaxHeight(e,t,r){const n=get$5(r,"duchamp_message.adaptiveMode");return!!n&&n!==ADAPTIVE_MODE.WIDTH_FILL}function showModalWithAutoHeight(e,t,r){return isSameViewlet$1(e,t)}const DEFAULT_MODAL_PADDING=10;async function popupTemplate(e,t,r,n){const[o,i]=filterParamsWithUniqueKeys$1(t),a="POST"===get$5(o,MOBILE_UNIQUE_PARAMS.FINE_POPUP_METHOD)||r.byPost,s=await getUrl(e,a?o:t);if(!s)return{close:noop$6};const{background:l,border:c,mobileRegular:u,padRegular:d,opacity:h,store:p}=r,f={"--background-color":"transparent","--border-radius":"".concat((null==c?void 0:c.borderRadius)||0,"px")};return showModal({iframe:s,autoHeight:isAutoHeight$1(u,d),extraHeight:2*(((null==c?void 0:c.type)||0)+DEFAULT_MODAL_PADDING),bodyStyle:f,method:a?"POST":"GET",parameters:a?i:{},style:{padding:DEFAULT_MODAL_PADDING,...convertToBorderStyle(c),...convertToSize(u,d)},contentBackgroundStyle:{backgroundColor:null==l?void 0:l.color,opacity:h},showModalWithAutoHeight:showModalWithAutoHeight,showModalWithMaxHeight:showModalWithMaxHeight,window:n,duchampApi:(null!=p?p:duchamp.store).duchampServer.duchampApi})}const PopoverContent=({text:e,title:t,style:r,titleStyle:n,contentStyle:o,backgroundStyle:i})=>jsxs("div",{className:"duchamp-popover-content",style:{...r,perspective:null==i?void 0:i.perspective},children:[jsx("div",{className:"background",style:i}),jsxs("div",{className:"content",style:o,children:[t&&jsx("div",{className:"title ellipsis-text",style:n,children:t}),e]})]}),createPopover=({x:e=0,y:t=0,arrowColor:r,popoverStyle:n,contentSize:o,store:i,triggerEl:a,...s})=>{const l={"--content-padding":0,"--triangle-color":r,boxShadow:"0px 0px 15px 0px #00000026",...n},c=jsx(Popover,{visible:!0,style:l,className:"duchamp-mobile-popover",content:jsx(PopoverContent,{...s}),children:jsx("div",{style:{...o}})});renderComponent$1({store:i,x:e,y:t,component:c,...o,triggerEl:a})},DEFAULT_POPOVER_PADDING=12,showTemplatePopup=async e=>{const{templatePath:t,parameters:r={},...n}=e;return cacheModalDestroy((await popupTemplate({templatePath:t},r,n,window)).close)},showTextPopover=e=>{if(!e.value)return;const{store:t,value:r,border:n,font:o,opacity:i,position:a,background:s,mobileRegular:l,padRegular:c,triggerEl:u}=e,d=convertToSize(l,c);createPopover({store:t,text:jsx("div",{className:"mobile-popover-text-wrapper",children:r}),x:(null==a?void 0:a.left)||0,y:(null==a?void 0:a.top)||0,arrowColor:rgbToRgba(null==s?void 0:s.color,i),style:{borderRadius:((null==n?void 0:n.borderRadius)||0)-((null==n?void 0:n.type)||0)},contentStyle:{...convertToFontStyle(o),padding:DEFAULT_POPOVER_PADDING,height:d.height},popoverStyle:{...convertToBorderStyle(n,!0),width:d.width,"--popover-max-height":getPopoverMaxHeight((null==a?void 0:a.top)||0,t.platform.mobile.toolHeightManager)},backgroundStyle:{backgroundColor:rgbToRgba(null==s?void 0:s.color,i)},triggerEl:u})},MOBILE_POPUP$1={TEMPLATE:showTemplatePopup,TEXT:showTextPopover},showMobilePopup=({target:e,duchampServer:t,...r})=>{if(!e)return;const n=MOBILE_POPUP$1[e.toUpperCase()]||MOBILE_POPUP$1.TEXT,{parameters:o}=r;r.extendParameters?t.getTemplateParameters(o).then((e=>{n({...r,store:t.store,parameters:e})})):n({...r,store:t.store,parameters:o})};function isMagneticWidget(e){const t=e;return!isNil$3(null==t?void 0:t.magneticOptions)&&!isNil$3(null==t?void 0:t.magneticGap)&&!isNil$3(null==t?void 0:t.magneticPadding)}function isInstanceofOutsideEditable(e){return void 0!==(null==e?void 0:e.openEditor)}function getImageSlice(e){return e&&isResourceInfo(e)&&getPayload$2(e,"imgSlice")||[]}const getResourceIds=e=>e&&(e.type===RESOURCE_TYPE.INTERNAL||e.type===RESOURCE_TYPE.CUSTOM)&&e.value?[e.value]:[],FOCUS_POINT_WIDGET_TYPE_ID_MAP={[WIDGET_TYPE.TITLE]:"S7",[WIDGET_TYPE.RICH_TEXT]:"S8",[WIDGET_TYPE.CALDER]:"S1",[WIDGET_TYPE.CALDER_CUSTOM]:"S3",[WIDGET_TYPE.UNITY]:"S5",[WIDGET_TYPE.WORKBOOK]:"S9",[WIDGET_TYPE.TIME]:"S10",[WIDGET_TYPE.LIVE_VIDEO]:"S12",[WIDGET_TYPE.LOCAL_VIDEO]:"S11",[WIDGET_TYPE.IMAGE]:"S13",[WIDGET_TYPE.IFRAME]:"S14",[WIDGET_TYPE.TABS]:"S15",[WIDGET_TYPE.RESERVE_CANVAS]:"S16",[WIDGET_TYPE.EXPAND]:"S17",[WIDGET_TYPE.CONTROLLER_INPUT]:"S18",[WIDGET_TYPE.CONTROLLER_DATETIME]:"S19",[WIDGET_TYPE.CONTROLLER_COMBO]:"S20",[WIDGET_TYPE.CONTROLLER_MULTI_COMBO]:"S21",[WIDGET_TYPE.CONTROLLER_RADIO_GROUP]:"S22",[WIDGET_TYPE.CONTROLLER_CHECKBOX_GROUP]:"S23",[WIDGET_TYPE.CONTROLLER_TREE_COMBO]:"S24",[WIDGET_TYPE.CONTROLLER_TREE_VIEW]:"S25",[WIDGET_TYPE.QUERY_BUTTON]:"S26",[WIDGET_TYPE.CONTROLLER_DATE_INTERVAL]:"S31"},FOCUS_POINT_EDITOR_TYPE_ID_MAP={[WIDGET_TYPE.CALDER]:"S2",[WIDGET_TYPE.CALDER_CUSTOM]:"S4",[WIDGET_TYPE.UNITY]:"S6"};function getEnterZenModePoint(e){return e?{id:"S129"}:null}function getPasteWidgetType(e){const t=this.store.story.currents,r=new Set(e.keys());return{id:"S123",param:{pasteWidgetType:Array.from(e.values()).flat().reduce(((e,t)=>(r.has(t.id)&&e.push(t.type),e)),[]),pasteFromSelf:t.size===r.size&&[...t].every((e=>r.has(e)))?1:2}}}function getPasteCurrentWidgetType(e){return{id:"S123",param:{currentSelectWidget:Array.from(this.currentWidgets.values()).flat().map((e=>e.type)),useClipboard:e}}}function getDeleteWidgetType(){return{id:"S121",param:{deleteWidgetType:this.currentWidgets.map((e=>e.type))}}}function getCopyWidgetType(){return{id:"S122",param:{copyWidgetType:this.currentWidgets.map((e=>e.type))}}}function getInteractiveConfigPoint(){return{id:"S201",param:{open:this.interactive.autoLink}}}function focusPoint(e,t="before"){return function(r,n,o){const i=o.value;o.value=function(...r){const n=()=>{const t=e.apply(this,r);t&&sendFocusPoint(t)};if("before"===t)return n(),i.apply(this,r);const o=i.apply(this,r);return n(),o}}}function getMethodFocusPoint(e,t){return function(...r){if(isFunction$8(t)){const e=null==t?void 0:t(...r);sendFocusPoint(e)}else sendFocusPoint(t);return e(...r)}}function getOpenEditorFocusPointId(e){return FOCUS_POINT_EDITOR_TYPE_ID_MAP[e]}function responseIsError(e){return null!==e&&"object"==typeof e&&"errorCode"in e}const TEMPLATE_WIDGET_TYPE_KEY={CHART:"chart",CONTROLLER:"controller",RELATION:"relation"},TEMPLATE_STYLE_TYPE={PRESET:"preset",CUSTOM:"custom"},TEMPLATE_THEME_TYPE={DARK:"dark-blue",LIGHT:"blue"};var __defProp$R=Object.defineProperty,__getOwnPropDesc$N=Object.getOwnPropertyDescriptor,__decorateClass$Q=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$N(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$R(t,r,i),i};class BaseWidgetModel{constructor(e,t){__publicField(this,"disposes",[]),__publicField(this,"widget"),__publicField(this,"needRecalculate",!1),__publicField(this,"duchampServer"),__publicField(this,"eventsEmitter",new EventEmitter),__publicField(this,"calculateCenter"),__publicField(this,"cacheable",!0),__publicField(this,"showHoverTip",!1),__publicField(this,"renderMode"),__publicField(this,"emitCurrentLoaded",(()=>{this.isPreview&&this.store.loadedManager.emit(STORY_LOADED_EVENT.WIDGET_LOAD_FINISHED,this.id)})),__publicField(this,"toolbarMap",new Map),__publicField(this,"computedParameters",new Map),__publicField(this,"canResizedByChildren",!1),__publicField(this,"tempState",null),__publicField(this,"calculatePayload",{}),this.widget=e,this.duchampServer=t,this.calculateCenter=t.calculateCenter,this.initStateChangeListeners(e)}initStateChangeListeners(e){this.disposes.forEach((e=>e())),this.disposes=[],this.widget=e,this.disposes.push(reaction((()=>cloneDeep$2(this.props)),((e,t)=>{this.store.replaceInfo.running?this.store.replaceInfo.refreshWidgets.add(this.widget):this.widget.initializing||(this.onPropsChange(e,t),this.eventsEmitter.emit(WIDGET_PROPS_CHANGE_EVENT,e,t))}),{equals:comparer.structural}))}setShowHoverTip(e){this.showHoverTip=e}get parentWidgetModel(){var e;return null==(e=this.widget.parentWidget)?void 0:e.getInstance()}get parentWidgetModels(){return this.widget.parentWidgets.map((e=>e.getInstance()))}get duchampApi(){return this.duchampServer.duchampApi}get env(){return{resourceBaseUrl:this.duchampServer.resourceBaseUrl,assetBaseUrl:this.duchampServer.assetBaseUrl,servletURL:FR.servletURL}}collectResourceIDs(){const{border:e,widgetEvents:t,mobile:r}=this.widget;let n=getResourceIds(e);return n=n.concat(getResourceIds(r.border)),t.flatMap((e=>e.events)).flatMap((e=>e.actions)).forEach((e=>{"webPagePopover"===e.type&&(n=n.concat(getResourceIds(e.body.border)).concat(getResourceIds(e.body.mobileConfig.border)))})),n}collectResourceDetails(){var e;return[{type:"widget",widgetName:this.name,storyName:null==(e=this.widget.story)?void 0:e.name,allResource:this.collectResourceIDs()}]}updateResourceIDs(e){}get id(){return this.widget.id}get name(){return this.widget.name}get type(){return this.widget.type}get width(){return this.widget.width}get height(){return this.widget.height}get carousel(){return this.widget.platform.carousel}get isMobile(){return this.store.platform.isMobile}get mobile(){return this.widget.platform.mobile}get props(){return this.isMobile?this.mobileProps:this.widget.props}get mobileProps(){return isEmpty$3(this.widget.platform.mobile.props)?this.widget.props:this.mergeProps(this.widget.props,this.widget.platform.mobile.props)}get isInCurrentStory(){return this.story===this.store.story||this.story===this.store.story.backgroundStory}get isPreview(){return this.duchampServer.isPreview}get warning(){return this.widget.warning}get storyIndex(){return this.widget.storyIndex}get story(){return this.widget.story}get store(){return this.duchampServer.store}get transitionStatus(){return this.widget.transitionStatus}get states(){return this.widget.platform.states}get padding(){return this.widget.platform.padding}get borderLine(){return this.widget.platform.borderLine}get borderRadius(){return this.widget.platform.borderRadius}get rect(){return this.widget.rect}get limitRect(){var e;return null==(e=this.parentWidgetModel)?void 0:e.childrenLimitRect}get visibleBindingClientRect(){const{target:e}=this.widget;if(e)return calculateIntersectionRect(e.getBoundingClientRect(),this.parentWidgetModel?this.parentWidgetModel.childrenLimitBoundingClientRect:getCanvasContainerRect(e))}get visibleRect(){var e;const t=null==(e=this.parentWidgetModel)?void 0:e.childrenLimitVisibleRect;return t?calculateIntersectionRect(this.rect,t):this.rect}get listToolbar(){return[]}get widgetType(){return this.widget.type}get eventTargets(){var e;const t=null==(e=this.widget.meta.configure)?void 0:e.eventTargets;return t?isFunction$8(t)?t(this.props):t:null}get centerCoordinate(){if(!this.widget.target)return;const e=this.widget.target.getBoundingClientRect();return[e.left+e.width/2,e.top+e.height/2]}get busying(){return this.widget.busying}get visible(){return this.widget.visible}get visibleInStory(){return this.widget.visibleInStory}setRenderMode(e){this.renderMode=e}get widgetIsRenderWithoutScale(){return this.renderMode?"fitSize"===this.renderMode:!1===this.widget.meta.scale}setProps(e){return this.widget.setValue(e)}setMobileProps(e){return this.widget.platform.mobile.setValue(e)}setPlatformProps(e){return this.isMobile?this.setMobileProps(e):this.setProps(e)}setWarning(e){this.widget.setWarning(e)}setCalculateCenter(e){this.calculateCenter=e}clearWarning(){this.widget.clearWarning()}async onInit(){}async onThemeChange(e){}replaceData(e){const{replacement:t,actionRegistry:r}=e;if(isNil$3(r))return;const{widgetEvents:n}=this.widget,o=n.map((e=>{const n=replaceEventsData(e.events,r,t);return{...e,events:n}}));this.widget.setWidgetEvents(o)}refresh(e){return this.store.calculateCenter.calculate(new Set([this]),this.duchampServer.isPreview?"refresh":"init",{},e,!this.isPreview)}emitValueChange(){return isFilterable(this)?this.calculateCenter.linkageGlobal(this.getFilter(),[this.id],!1):Promise.resolve()}getCoordinate(){return this.centerCoordinate}refreshData(){return this.refresh()}onCreated(e){}onPropsChange(e,t){}onReferenceResourceChange(e){}mergeProps(e,t){return merge$1({},e,t)}computeAndLinkage(e){const t=new Filter("and").updateParameterFilters(null!=e?e:{});return this.calculateCenter.linkage(t,new Set([this]))}setToolbar(e){this.toolbarMap.set(e.value,e)}removeToolbar(e){this.toolbarMap.delete(e)}get toolbars(){return isInstanceofOutsideEditable(this)?[{label:duchampIntl.get("Duchamp-Edit_Component"),value:"edit",icon:"icon-edit",hide:this.disableEdit,onClick:()=>{this.openEditor()},focusPoint:getOpenEditorFocusPointId(this.type)},...this.toolbarMap.values()]:[...this.toolbarMap.values()]}get isInHost(){return this.widget.story!==this.store.story}get isHostFloatTop(){return this.isInHost&&this.isFloatTop}get isFloatTop(){var e;return(null==(e=this.widget.story)?void 0:e.widgetFloatTop)===this.id}get referenceInfo(){const e=[];return this.fieldConfigs.forEach((t=>{isDatasetFieldConfig(t)&&e.push(t.datasetName)})),{tableIds:uniq(e)}}get fieldConfigs(){return new Map([])}get extraFieldConfigs(){return new Map([])}getFieldConfigsFromConfig(e){return new Map([])}getSpecialPayload(){return{}}get fieldPayload(){return merge$1({},{depGroupId:this.widget.storyIndex,outsidePayload:{depWidgets:getStoryWorkbookNamedIdentifierWithIndex(this.widget.storyIndex,this.widget.story)}},this.getSpecialPayload())}renderField(e,t){const r=new Map,n=new Map;return e.forEach(((e,t)=>{r.set(t,e.result),e.filter.getParameterFilters().forEach((e=>{n.set(e.name,e.value)}))})),this.computedParameters=n,this.setFieldValues(r,t,n)}setNeedRecalculate(e){e!==this.needRecalculate&&(this.needRecalculate=e)}setFieldValues(e,t,r){this.calculatePayload={...t};for(const n of e.values())if(this.preprocessWidgetError(n),this.widget.widgetError)break}preprocessWidgetError(e){if(responseIsError(e)){const t=convertErrorResultToError(e);return this.setWidgetError({...t,errorType:"error"}),null}return this.clearWidgetError(),e}setWidgetError(e){this.widget.setWidgetError(e)}clearWidgetError(){this.widget.clearWidgetError()}processWidgetError(e){responseIsError(e)?this.setWidgetError(e):this.clearWidgetError()}setFloatTop(e){var t;null==(t=this.widget.story)||t.setWidgetFloatTop(this.id,e)}onPopover(e){}fireEvent(e,...t){this.eventsEmitter.emit(e,...t)}addEventListener(e,t){this.eventsEmitter.addListener(e,t)}removeEventListener(e,t){this.eventsEmitter.removeListener(e,t)}on(e,t){this.isPreview&&this.addEventListener(e,t)}off(e,t){this.isPreview&&this.removeEventListener(e,t)}async getResources(){return[]}get magneticBounds(){var e;const t=e=>{const{padding:t,width:r,offset:n={left:0,top:0}}=e;return{top:n.top+t.top,left:n.left+t.left,width:r-t.left-t.right}};if(this.parentWidgetModel){const{parentWidgetModel:r}=this,[n,o]=r.parentWidgetModels.reduce(((e,t)=>{var r,n,o,i;return[e[0]+(null!=(n=null==(r=t.scroll)?void 0:r.x)?n:0),e[1]+(null!=(i=null==(o=t.scroll)?void 0:o.y)?i:0)]}),[0,0]);if(isMagneticWidget(r)){const{left:i,top:a}=null!=(e=r.magneticOptions.offset)?e:{left:0,top:0};return t({...r.magneticOptions,offset:{left:i-n,top:a-o}})}const{top:i,left:a}=r.layoutRect;return r.canResizedByChildren?r.magneticBounds:{top:i-o,left:a-n}}if(this.story)return t(this.story.platform.mobile.magneticOptions)}isVisible(){return this.widget.visible}setVisible(e){this.widget.setVisible(e)}getParameters(e){if(isUndefined$3(e))return null;return this.calculateCenter.getParameterFromComputable(this).get(e)}setConfigurationConfig(e){const{contentProperties:t}=Object.getPrototypeOf(this);this.store.undoManager.withGroup((()=>{Object.keys(e).forEach((r=>{var n;const o=null==(n=t[r])?void 0:n.set;o&&!isEqual$4(e[r],t[r].get.call(this))&&o.call(this,e[r])}))}))}getConfigurationConfig(){const{contentProperties:e}=Object.getPrototypeOf(this);if(!e)return{};const t={};return Object.keys(e).forEach((r=>{var n;t[r]=null==(n=e[r])?void 0:n.get.call(this)})),t}setTransform3d(e){this.widget.setTransform3d(e)}getTemplateDependencies(){const e=[];return this.widget.getActions().forEach((t=>{if(t.type===CLICK_ACTION_TYPE.WEB_PAGE_POPOVER){const{url:r}=t.body;r.pathType===CONTENT_TYPE.TEMPLATE&&e.push(r.value)}})),e}get platformSupport(){const{platforms:e}=this.widget.meta;return!e||e.includes(this.store.platform.platformType)}getPerformanceMeasureInfo(){}canExportReuse(){return!this.busying}get isFullWidthInControllerPanel(){return!1}get isHoverPointer(){return this.widget.isHoverPointer}getWidgetTransitionInfo(){return"start"===this.transitionStatus?{duration:timeUnitToMillisecond(oldTime2TimeMillisecond(this.store.mainStory.transition.duration))}:void 0}setTempState(e){this.tempState=e}getTempState(){return this.tempState}get theme(){var e,t;return{colors:this.store.styleConfig.theme_config.groupColor.colors,scheme:this.store.styleConfig.theme===TEMPLATE_THEME_TYPE.DARK?THEME_SCHEME.DARK:THEME_SCHEME.LIGHT,textColor:(null==(t=null==(e=this.store.styleConfig.widget["d-text"])?void 0:e.content)?void 0:t.color)||getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.TEXT)}}addPropsChangeListener(e){this.eventsEmitter.on(WIDGET_PROPS_CHANGE_EVENT,e)}removePropsChangeListener(e){this.eventsEmitter.off(WIDGET_PROPS_CHANGE_EVENT,e)}get refreshStatus(){const e=this.calculatePayload.extPayload;return e&&isObject$f(e)&&"refreshStatus"in e&&isRefreshStatus(e.refreshStatus)?e.refreshStatus:"linkage"}recalculate(e,t){this.widget.setLoading(!0);const r=isFunction$8(e)?e(this.calculatePayload):e;return this.calculatePayload=r,this.store.calculateCenter.calculate(new Set([this]),"refresh",r,t).finally((()=>{this.widget.setLoading(!1)}))}calculate(e,t){return Promise.resolve(ok(null))}get fetch(){return getFetchInfo(this.store)}emitEvent(e,t){if(isParameterLinkageEvent(e)){const e=new Filter("and").updateParameterFilters(t.parameters);t.target?this.store.calculateCenter.linkage(e,new Set(this.store.story.getRelatedWidgetByIds(t.target).map((e=>e.getInstance())))):this.store.calculateCenter.linkageGlobal(e)}else if(isHyperlinkEvent(e)){const[e,r]=filterParamsWithUniqueKeys$1(t.parameters),n=appendQueryParams(t.url,{...e}),o={...t,url:n,parameters:r,duchampServer:this.duchampServer};this.isMobile?handleHyperlink(o):handleHyperlink$1(o)}else if(isJavascriptEvent(e)){const e=Object.keys(t.params),r=Object.values(t.params);return runJavascriptCode({code:t.code,args:e,values:r,skipDocumentVerify:t.skipDocumentVerify,duchampApi:this.duchampServer.duchampApi})}}getComputedParams(){return this.computedParameters}get root(){return this.store.target}showMobilePopup(e){const[t,r]=getUrlAndParamsFromPath(e.templatePath||""),n={};new URLSearchParams(r).forEach(((e,t)=>{n[t]=e}));const{mouseEvent:o}=this.duchampServer.store,i=(null==o?void 0:o.target)?o.target:void 0;showMobilePopup({...e,parameters:{...e.parameters,...n},templatePath:t,position:o?{left:null==o?void 0:o.clientX,top:null==o?void 0:o.clientY}:void 0,triggerEl:i,duchampServer:this.duchampServer,store:this.duchampServer.store})}get singletonManager(){return this.store.singletonManager}get simpleJson(){return this.store.simpleJson}get currentStory(){var e,t;return{main:{id:this.store.story.id},background:{id:null!=(t=null==(e=this.store.story.backgroundStory)?void 0:e.id)?t:""}}}get widgetStory(){var e,t;return{id:null!=(t=null==(e=this.story)?void 0:e.id)?t:""}}}__decorateClass$Q([observable],BaseWidgetModel.prototype,"widget",2),__decorateClass$Q([observable],BaseWidgetModel.prototype,"needRecalculate",2),__decorateClass$Q([action$1],BaseWidgetModel.prototype,"initStateChangeListeners",1),__decorateClass$Q([observable],BaseWidgetModel.prototype,"showHoverTip",2),__decorateClass$Q([action$1],BaseWidgetModel.prototype,"setShowHoverTip",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"parentWidgetModel",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"parentWidgetModels",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"carousel",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"isMobile",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"mobile",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"props",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"mobileProps",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"isInCurrentStory",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"limitRect",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"visibleBindingClientRect",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"visibleRect",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"eventTargets",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"centerCoordinate",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"busying",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"visible",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"visibleInStory",1),__decorateClass$Q([observable],BaseWidgetModel.prototype,"renderMode",2),__decorateClass$Q([jsApi(),action$1],BaseWidgetModel.prototype,"setRenderMode",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"widgetIsRenderWithoutScale",1),__decorateClass$Q([jsApi()],BaseWidgetModel.prototype,"refresh",1),__decorateClass$Q([jsApi()],BaseWidgetModel.prototype,"getCoordinate",1),__decorateClass$Q([jsApi()],BaseWidgetModel.prototype,"refreshData",1),__decorateClass$Q([observable],BaseWidgetModel.prototype,"toolbarMap",2),__decorateClass$Q([action$1],BaseWidgetModel.prototype,"setToolbar",1),__decorateClass$Q([action$1],BaseWidgetModel.prototype,"removeToolbar",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"isInHost",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"isHostFloatTop",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"isFloatTop",1),__decorateClass$Q([jsApi()],BaseWidgetModel.prototype,"on",1),__decorateClass$Q([jsApi()],BaseWidgetModel.prototype,"off",1),__decorateClass$Q([computed],BaseWidgetModel.prototype,"magneticBounds",1),__decorateClass$Q([jsApi()],BaseWidgetModel.prototype,"isVisible",1),__decorateClass$Q([jsApi()],BaseWidgetModel.prototype,"setVisible",1),__decorateClass$Q([jsApi()],BaseWidgetModel.prototype,"getParameters",1);const WIDGET_PROPS_CHANGE_EVENT=Symbol("widgetPropsChange");function isRefreshStatus(e){return["jsApi","linkage","observe"].includes(e)}function getDependencyItemUrl(e){return isFunction$8(e)?e():e}function getLoadUrl(e){return isRemoteURL(e)?e:"".concat(fvsService.getEnvInfo().remoteServletUrl).concat(e)}function getDependencyUrl(e,t){if(!e)return"";if(isFunction$8(e)||isString$3(e)){const r=getLoadUrl(getDependencyItemUrl(e));return t?completionTag(r):r}if("relative"in e){const r=getDependencyItemUrl(e.relative);return t?completionTag(r):r}return getLoadUrl(t?completionTag(getDependencyItemUrl(e.preview)):getDependencyItemUrl(e.edit))}class WidgetDependencyManager{constructor(){__publicField(this,"dependencies",new Map),__publicField(this,"loaded",new Set)}register(e,t){t&&this.dependencies.set(e,t)}load(e=[],t){const r=compact(Array.from(new Set(flatten$1(e.map((e=>this.dependencies.get(e)))))).map((e=>getDependencyUrl(e,t)))).filter((e=>!isEmpty$3(e)&&!this.loaded.has(e)));return r&&r.length>0?loadjs(r,"dependencies-".concat((new Date).getTime()),{async:!1,returnPromise:!0}).then((()=>{r.forEach((e=>this.loaded.add(e)))})):Promise.resolve()}}const widgetDependencyManager=new WidgetDependencyManager,WIDGET_STATES={width:200,height:50,matrix:[1,0,0,1,0,0],animation:{},keepRatio:!1};let WidgetManager$1=(_a=class{constructor(e){__publicField(this,"widgetDict",new Map),__publicField(this,"styleDict",new Map),__publicField(this,"configurationDict",new Map),__publicField(this,"widgetDependencyManager"),this.widgetDependencyManager=e}get widgets(){return Array.from(this.widgetDict.values())}register(e){this.widgetDict.set(e.type,e),this.widgetDependencyManager.register(e.type,e.dependencies)}hasRegisterWidget(e){return this.widgetDict.has(e)}registerExtendStyle(e,t){const r=this.styleDict.get(e)||new Map;r.set(t.type,t),this.styleDict.set(e,r)}registerConfigurationSchema(e,t){this.configurationDict.set(e,t)}getConfigurationSchema(e){return this.configurationDict.get(e)}getWidgetByName(e){const t=this.widgetDict.get(e)||{type:"d-empty",displayName:"",version:"0.0.1",icon:"",component:()=>reactExports.createElement(FvsImage,{src:createAbsoluteUrl("/assets/system/widget_default.png"),height:"100%",width:"100%"}),model:BaseWidgetModel,states:{}};return t.states={...WIDGET_STATES,...t.states},t}getExtendStyles(e){const t=this.styleDict.get(e);return t?Array.from(t.values()):[]}getExtendStyle(e,t="default"){return this.getExtendStyles(e).find((e=>e.type===t))}},__publicField(_a,"instance",new _a(widgetDependencyManager)),_a);const widgetManager=new WidgetManager$1(widgetDependencyManager);function getWidgetRenderComponent(e){var t,r,n,o,i,a;const s=widgetManager.getWidgetByName(e.type),{styleType:l="default"}=null!=(r=null==(t=e.getInstance())?void 0:t.props)?r:{},c=widgetManager.getExtendStyle(e.type,l),u=null!=(i=null==(n=null==c?void 0:c.mobile)?void 0:n.component)?i:null==(o=s.mobileConfig)?void 0:o.component,d=null!=(a=null==c?void 0:c.component)?a:s.component;return e.model.isMobile&&u||d}const WidgetView=observer((({widget:e,width:t,height:r,adaptiveScale:n,expandIndex:o})=>{const i=getWidgetRenderComponent(e),a=isFunction$9(i)?i:void 0;return a&&jsx(a,{widget:e,width:t,height:r,adaptiveScale:n,expandIndex:o})})),WidgetWarning=observer((({widget:e,adaptiveScale:t})=>{const[r,n]=reactExports.useState({}),o=reactExports.useRef(null),i=useStore(),a=reactExports.useMemo((()=>{var r;return getTransformOrigin(e.model.states,{origin:null==(r=e.parentWidget)?void 0:r.model.states,adaptiveScale:t})}),[e,t]);return reactExports.useLayoutEffect((()=>{var t,r;const a=(null==(t=e.getInstance().parentWidgetModel)?void 0:t.scrollAreaRect)||{top:0,height:(null==(r=i.target.querySelector(".".concat(ELEMENT_SYMBOL.ADAPTIVE_CONTENT)))?void 0:r.clientHeight)||0};if(!o.current||!a)return;const s=o.current.clientHeight,l=e.rect.top-a.top,c=e.rect.height,u=a.height;n(l+c+s<u?{top:c}:l-s>0?{top:-s}:{top:0})}),[i.target,e,e.warning]),jsx(Fragment,{children:e.warning&&jsx(Transform3dEffect,{className:"widget-warning-wrapper",transform3d:e.transform3d,transformOrigin:a,scale:t?convertAdaptiveScaleToTransformScale(t):void 0,children:jsx("div",{style:t?calculateAdaptiveScaleStyle({adaptiveScale:t,style:{width:"100%",height:"100%"}}):void 0,children:jsx("div",{ref:o,className:"duchamp-widget-warning",style:r,children:e.warning.message})})})})}));class ErrorBoundary extends reactExports.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}render(){return this.state.hasError?this.props.errorRender(ERROR_JAVASCRIPT_PANIC):this.props.children}}const ChartConfig=observer((({model:e})=>(reactExports.useEffect((()=>{otherService.populateChartEditPane(e.chartFileName,e.widgetType.replace("d-chart-",""))}),[e]),jsx(Fragment,{})))),getChartMeta=e=>({type:"d-chart-".concat(e),displayName:"",widgetType:"chart",groupName:"",icon:"/assets/widget/".concat(e,".svg"),props:{},states:{width:400,height:260},version:""}),LINK_PARAS={COLUMN:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],STACK_COLUMN:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],PERCENT_STACK_COLUMN:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],CUSTOM_COLUMN:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],ARC_COLUMN:[{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["category"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],SHAPE_COLUMN:[{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["category"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["series"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],BAR:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],STACK_BAR:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],PERCENT_STACK_BAR:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],CUSTOM_BAR:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],CAROUSEL_BAR:[],PIE:[{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],PIE_SAME_ARC:[{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],PIE_DIFFERENT_ARC:[{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],MULTI_PIE:[{key:"SERIES",text:i18n.t("Duchamp-Index_Name"),props:["seriesName"]},{key:"NAME",text:i18n.t("Duchamp-Level_Name"),props:["name"]},{key:"LEVEL",text:i18n.t("Duchamp-Level_Number"),props:["level"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],CAROUSEL_PIE:[{key:"SERIESNAME",text:i18n.t("Duchamp-Series_Name"),props:["seriesName"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],LINE:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],STACK_LINE:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],CUSTOM_LINE:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],AREA:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],STACK_AREA:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],PERCENT_STACK_AREA:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],CUSTOM_AREA:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],RADAR:[{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],STACK_RADAR:[{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],GAUGE_POINTER:[{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],GAUGE_POINTER_SEMI:[{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],GAUGE_RING:[{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],GAUGE_SLOT:[{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],GAUGE_THERMOMETER:[{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],CAROUSEL_GAUGE:[{key:"METER_NAME",text:i18n.t("Duchamp-Play_Dimension"),props:["carouselKey"]},{key:"INDEX_VALUE",text:i18n.t("Duchamp-Index_Value"),props:["indicatorValue"]}],FLUID:[{key:"INDEX_VALUE",text:i18n.t("Duchamp-Index_Value"),props:["index"]}],PIXEL_GRID:[{key:"INDEX_VALUE",text:i18n.t("Duchamp-Index_Value"),props:["index"]}],KPI1:[{key:"NAME",text:i18n.t("Duchamp-Play_Dimension"),props:["name"]},{key:"VALUE",text:i18n.t("Duchamp-Index_Value"),props:["value"]}],KPI2:[{key:"NAME",text:i18n.t("Duchamp-Play_Dimension"),props:["name"]},{key:"VALUE",text:i18n.t("Duchamp-Index_Value"),props:["value"]}],PARTICLE:[{key:"TITLE",text:i18n.t("Duchamp-Title"),props:["name"]},{key:"COUNT",text:i18n.t("Duchamp-Count_Value"),props:["value"]}],CAROUSEL_CATALOG:[{key:"NODE_NAME",text:i18n.t("Duchamp-Node_Name"),props:["name"]},{key:"NODE_VALUE",text:i18n.t("Duchamp-Node_Content"),props:["value"]}],WISDOM_TREE_ELECTRON:[{key:"NODE_NAME",text:i18n.t("Duchamp-Node_Name"),props:["name"]},{key:"NODE_VALUE",text:i18n.t("Duchamp-Node_Content"),props:["value"]}],WISDOM_TREE_MODEL:[{key:"NODE_NAME",text:i18n.t("Duchamp-Node_Name"),props:["name"]},{key:"NODE_VALUE",text:i18n.t("Duchamp-Node_Content"),props:["value"]}],AREA_MAP:[{key:"AREA_NAME",text:i18n.t("Duchamp-Area_Name"),props:["name"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["seriesName"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],POINT_MAP:[{key:"AREA_NAME",text:i18n.t("Duchamp-Area_Name"),props:["name"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["seriesName"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],LINE_MAP:[{key:"START_AREA_NAME",text:i18n.t("Duchamp-Starting_Point"),props:["from","name"]},{key:"END_AREA_NAME",text:i18n.t("Duchamp-Arrival_Point"),props:["to","name"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["seriesName"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],CUSTOM_MAP:[{key:"AREA_NAME",text:i18n.t("Duchamp-Area_Name"),props:["name"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["seriesName"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],HEAT_MAP:[{key:"AREA_NAME",text:i18n.t("Duchamp-Area_Name"),props:["name"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["seriesName"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],DRILL_AREA_MAP:[{key:"AREA_NAME",text:i18n.t("Duchamp-Area_Name"),props:["name"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["seriesName"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],DRILL_AREA_MAPdTools:[{key:"AREA_NAME",text:i18n.t("Duchamp-Area_Name"),props:["name"]}],DRILL_POINT_MAP:[{key:"AREA_NAME",text:i18n.t("Duchamp-Area_Name"),props:["name"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["seriesName"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],DRILL_POINT_MAPdTools:[{key:"AREA_NAME",text:i18n.t("Duchamp-Area_Name"),props:["name"]}],DRILL_CUSTOM_MAP:[{key:"AREA_NAME",text:i18n.t("Duchamp-Area_Name"),props:["name"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["seriesName"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],DRILL_CUSTOM_MAPdTools:[{key:"AREA_NAME",text:i18n.t("Duchamp-Area_Name"),props:["name"]}],SLIDE_SHOW_MAP:[{key:"AREANAME",text:i18n.t("Duchamp-Area_Name"),props:["nextItem","areaName"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["nextItem","value","0"]}],GROUP_MAP:[{key:"TITLE",text:i18n.t("Duchamp-Title"),props:["nextItem","title"]}],BAR_3D_ON_GLOBE:[{key:"LONGITUDE",text:i18n.t("Duchamp-Longitude"),props:["value","0"]},{key:"LATITUDE",text:i18n.t("Duchamp-Latitude"),props:["value","1"]},{key:"NAME",text:i18n.t("Duchamp-Name"),props:["name"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value","2"]}],SCATTER_3D_ON_GLOBE:[{key:"LONGITUDE",text:i18n.t("Duchamp-Longitude"),props:["value","0"]},{key:"LATITUDE",text:i18n.t("Duchamp-Latitude"),props:["value","1"]},{key:"NAME",text:i18n.t("Duchamp-Name"),props:["name"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value","2"]}],LINES_3D_ON_GLOBE:[{key:"FROM_LONGITUDE",text:i18n.t("Duchamp-Longitude_Of_Origin"),props:["value","0","0"]},{key:"FROM_LATITUDE",text:i18n.t("Duchamp-Latitude_Of_Origin"),props:["value","0","1"]},{key:"TO_LONGITUDE",text:i18n.t("Duchamp-End_Longitude"),props:["value","1","0"]},{key:"TO_LATITUDE",text:i18n.t("Duchamp-End_Latitude"),props:["value","1","1"]},{key:"NAME",text:i18n.t("Duchamp-Name"),props:["name"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],SCATTER:[{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"X",text:"X",props:["x"]},{key:"Y",text:"Y",props:["y"]},{key:"SIZE",text:"SIZE",props:["size"]}],BUBBLE:[{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"X",text:"X",props:["x"]},{key:"Y",text:"Y",props:["y"]},{key:"SIZE",text:"SIZE",props:["size"]}],TREE_MAP:[{key:"SERIES",text:i18n.t("Duchamp-Index_Name"),props:["seriesName"]},{key:"NAME",text:i18n.t("Duchamp-Level_Name"),props:["name"]},{key:"LEVEL",text:i18n.t("Duchamp-Level_Number"),props:["level"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],WORD_CLOUD:[{key:"SERIES",text:i18n.t("Duchamp-Index_Name"),props:["category"]},{key:"WORD_NAME",text:i18n.t("Duchamp-Word_Name"),props:["name"]},{key:"WORD_VALUE",text:i18n.t("Duchamp-Word_Frequency"),props:["value"]}],FORCE_BUBBLE:[{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],FUNNEL:[{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalName"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],COLUMN_LINE:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],COLUMN_AREA:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],STACK_COLUMN_LINE:[{key:"CATEGORYARRAY",text:i18n.t("Duchamp-Categorical_Array"),props:["options","originalCategoryArray"]},{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],CUSTOM:[{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],TIME_GEAR:[],GANTT:[{key:"PROJECT",text:i18n.t("Duchamp-Project_Name"),props:["options","processesId"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["seriesName"]},{key:"START_TIME",text:i18n.t("Duchamp-Starting_Time"),props:["options","startTime"]},{key:"END_TIME",text:i18n.t("Duchamp-End_Time"),props:["options","finishTime"]},{key:"PROGRESS",text:i18n.t("Duchamp-Schedule"),props:["progress"]}],STRUCTURE_VERTICAL:[{key:"NAME",text:i18n.t("Duchamp-Node_Name"),props:["name"]},{key:"SERIES",text:i18n.t("Duchamp-Index_Name"),props:["seriesName"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],STRUCTURE_HORIZONTAL:[{key:"NAME",text:i18n.t("Duchamp-Node_Name"),props:["name"]},{key:"SERIES",text:i18n.t("Duchamp-Index_Name"),props:["seriesName"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],STRUCTURE_RADIAL:[{key:"NAME",text:i18n.t("Duchamp-Node_Name"),props:["name"]},{key:"SERIES",text:i18n.t("Duchamp-Index_Name"),props:["seriesName"]},{key:"VALUE",text:i18n.t("Duchamp-Value"),props:["value"]}],BOX:[{key:"CATEGORY",text:i18n.t("Duchamp-Category_Name"),props:["options","originalCategory"]},{key:"SERIES",text:i18n.t("Duchamp-Series_Name"),props:["options","originalSeries"]},{key:"OUTLIER",text:i18n.t("Duchamp-Outliers"),props:["outlierData","outlier"]}],GEO_LANDpoint:[{key:"AREA_NAME",text:i18n.t("Duchamp-Area_Name"),props:["linkAreaName"]}],GEO_LANDline:[{key:"FROM_AREA_NAME",text:i18n.t("Duchamp-Starting_Point"),props:["linkFromAreaName"]},{key:"TO_AREA_NAME",text:i18n.t("Duchamp-Arrival_Point"),props:["linkToAreaName"]}],GEO_LANDarea:[{key:"AREA_NAME",text:i18n.t("Duchamp-Area_Name"),props:["linkAreaName"]}],GEO_LANDcylinder:[{key:"AREA_NAME",text:i18n.t("Duchamp-Area_Name"),props:["linkAreaName"]}],GEO_LANDdrillLink:[{key:"AREA_NAME",text:i18n.t("Duchamp-Area_Name"),props:["linkAreaName"]}]};function loadWidgetResource(e){const t=e.filter((e=>e.source.includes("spare"))),r=e.filter((e=>!e.source.includes("spare"))),n=e=>Promise.all(e.map((e=>loadFont(e.fontName,e.source))));return n(r).catch((e=>(console.error("Failed to load regularResources:",e),n(t).catch((e=>{console.error("Failed to load spareResources:",e)})))))}function generateTrigger$1(e,t,r){return{text:e,value:t,fields:LINK_PARAS[r].map((e=>({text:e.text,value:e.key})))}}async function preprocessOptions(e){return e&&await loadWidgetResource(e.fontDependency||[]),e}const REFRESH_TYPE_KEY=Symbol("calculateType"),REFRESH_TYPE_VALUE={JS_API:"jsApi",LINKAGE:"linkage",OBSERVE:"observe"};function getRefreshByObserveConfig(){return{[REFRESH_TYPE_KEY]:REFRESH_TYPE_VALUE.OBSERVE}}function isRefreshedByObserve(e){return!!e&&e[REFRESH_TYPE_KEY]===REFRESH_TYPE_VALUE.OBSERVE}var __defProp$Q=Object.defineProperty,__getOwnPropDesc$M=Object.getOwnPropertyDescriptor,__decorateClass$P=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$M(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$Q(t,r,i),i};function mergeChartOptions(e,t){if(e)return{...e,chartAttr:{...e.chartAttr,...t}}}class ChartModel extends BaseWidgetModel{constructor(e,t){super(e,t),__publicField(this,"instance"),__publicField(this,"loadedEmit",(()=>{this.emitCurrentLoaded()})),__publicField(this,"chartOptions"),__publicField(this,"isZoomed",!1)}setChartOptions(e){this.chartOptions=e}toggleZoom(e=!this.isZoomed){this.isZoomed=e}get chartInstance(){var e;return null==(e=this.instance)?void 0:e.getChart()}get chartType(){return this.widget.type.replace("d-chart-","")}get fieldConfigs(){return configKit$1.configFile.getComputeConfig({config:this.id,options:{type:"chart",payload:{chartType:this.chartType}}})}async setFieldValues(e,t){super.setFieldValues(e,t);let r=await preprocessOptions(configKit$1.configFile.transform({config:this.id,compute:{computedResult:e,index:0},options:{type:"chart",payload:{chartType:this.chartType}}}));"refresh"===t.type&&(r=mergeChartOptions(r,isRefreshedByObserve(t.extPayload)?{refreshType:"tip_increment"}:{})),this.setChartOptions(r),"init"===t.type&&this.loadedEmit()}collectResourceIDs(){const e=super.collectResourceIDs(),{configFile:t}=this.widget.props;return t&&e.push(t),e}updateResourceIDs(e){const{configFile:t}=this.props,r=e.get(t);r&&this.setProps({...this.props,configFile:r})}getSeries(){const e=this.chartInstance,t=null==e?void 0:e.series;return null==t?void 0:t.map((e=>{const{name:t,type:r,points:n}=e;return{name:t,type:r,points:n.map((t=>{const{name:r,seriesName:n,category:o,categoryArray:i,value:a}=t;return{name:r,seriesName:n,category:o,categoryArray:i,value:a,series:e}}))}}))}setSeriesVisible(e){var t;const r=this.chartInstance;return null==(t=null==r?void 0:r.setSeriesVisible)?void 0:t.call(r,e)}sortChart(e){var t;const r=this.chartInstance;return null==(t=null==r?void 0:r.sortChart)?void 0:t.call(r,e)}setMapZoom(e){var t;const r=this.chartInstance;return null==(t=null==r?void 0:r.setMapZoom)?void 0:t.call(r,e)}getZoom(){var e;const t=this.chartInstance;return null==(e=null==t?void 0:t.getZoom)?void 0:e.call(t)}getCenter(){var e;const t=this.chartInstance;return null==(e=null==t?void 0:t.getCenter)?void 0:e.call(t)}panTo(e){var t;const r=this.chartInstance;return null==(t=null==r?void 0:r.panTo)?void 0:t.call(r,e)}drillDown(e){return new Promise((t=>{var r,n;const o=this.chartInstance,i=null==o?void 0:o.series,a=null==(r=null==i?void 0:i.find((t=>t.name===e.series.name)))?void 0:r.points.find((t=>t.name===e.name));o&&t(null==(n=null==o?void 0:o.drillDown)?void 0:n.call(o,a))}))}drillUp(e){var t;const r=this.chartInstance;return null==(t=null==r?void 0:r.drillUp)?void 0:t.call(r,e)}getLayerIndex(){var e;const t=this.chartInstance;return null==(e=null==t?void 0:t.getLayerIndex)?void 0:e.call(t)}getLayerNames(){var e;const t=this.chartInstance;return null==(e=null==t?void 0:t.getLayerNames)?void 0:e.call(t)}trigger(e="",t){this.widget.trigger({target:e,fields:t})}openAutoTooltip(e,t){return new Promise(((e,t)=>{if(this.instance)e(this.instance);else{const r=reaction((()=>this.instance),(n=>{n?e(n):t(),r()}))}})).then((r=>{r.openAutoTooltip(e,t)}))}stopAutoTooltip(){var e,t;null==(t=null==(e=this.instance)?void 0:e.stop)||t.call(e)}moveOnAutoTooltip(){var e,t;null==(t=null==(e=this.instance)?void 0:e.moveOn)||t.call(e)}getInstance(){return this.chartInstance}get chartFileName(){var e;return(null==(e=this.store.resourceCenter.getInfoByID(this.props.configFile))?void 0:e.name)||""}getSpecialPayload(){return{widgetFilePath:this.chartFileName}}loadFinished(){this.loadedEmit()}setTempState(e){super.setTempState(e),this.instance=e}}__decorateClass$P([observable.ref],ChartModel.prototype,"instance",2),__decorateClass$P([observable.ref],ChartModel.prototype,"chartOptions",2),__decorateClass$P([action$1],ChartModel.prototype,"setChartOptions",1),__decorateClass$P([observable],ChartModel.prototype,"isZoomed",2),__decorateClass$P([action$1],ChartModel.prototype,"toggleZoom",1),__decorateClass$P([jsApi()],ChartModel.prototype,"getSeries",1),__decorateClass$P([jsApi()],ChartModel.prototype,"setSeriesVisible",1),__decorateClass$P([jsApi()],ChartModel.prototype,"sortChart",1),__decorateClass$P([jsApi()],ChartModel.prototype,"setMapZoom",1),__decorateClass$P([jsApi()],ChartModel.prototype,"getZoom",1),__decorateClass$P([jsApi()],ChartModel.prototype,"getCenter",1),__decorateClass$P([jsApi()],ChartModel.prototype,"panTo",1),__decorateClass$P([jsApi()],ChartModel.prototype,"drillDown",1),__decorateClass$P([jsApi()],ChartModel.prototype,"drillUp",1),__decorateClass$P([jsApi()],ChartModel.prototype,"getLayerIndex",1),__decorateClass$P([jsApi()],ChartModel.prototype,"getLayerNames",1),__decorateClass$P([jsApi()],ChartModel.prototype,"trigger",1),__decorateClass$P([jsApi()],ChartModel.prototype,"openAutoTooltip",1),__decorateClass$P([jsApi()],ChartModel.prototype,"stopAutoTooltip",1),__decorateClass$P([jsApi()],ChartModel.prototype,"moveOnAutoTooltip",1),__decorateClass$P([jsApi()],ChartModel.prototype,"getInstance",1);const ChartInstance={get VanCharts(){return window.VanCharts},get Echarts(){return window.echarts},get ColorUtils(){return window.ColorUtils},get Van(){return window.Van}};function clearChartInstance(e,t){var r,n,o;const i=Array.from(e.getElementsByTagName("canvas"));null==(r=null==t?void 0:t.clear)||r.call(t),null==(n=null==t?void 0:t.remove)||n.call(t),null==(o=null==t?void 0:t.dispose)||o.call(t),setTimeout((()=>{i.forEach((e=>{var t,r;null==(r=null==(t=getWebglContext(e))?void 0:t.getExtension("WEBGL_lose_context"))||r.loseContext()}))}),1e3)}function renderEmptyChartTip(e,t,r){return ChartInstance.VanCharts.showEmptyDataTip({dom:e,emptyDataTip:t.emptyDataTip,chartWidth:r.width,chartHeight:r.height,language:t.language})}function isEmptyChart(e){if(!e||0===e.length)return!0;for(let r=0,n=e.length;r<n;r++)if(""!==(t=e[r])&&null!=t)return!1;var t;return!0}function attachEmitter(e){e&&(e.on||(e.on=(t,r)=>{e._events_=e._events_||{};const n=e._events_[t]||[];n.push(r),e._events_[t]=n}),e.fire||(e.fire=(t,r)=>{e._events_=e._events_||{};(e._events_[t]||[]).forEach((t=>{t&&t.call(e,r)}))}),e.off||(e.off=t=>{e._events_=e._events_||{},e._events_[t]=[]}))}function createChartInSandbox(e){const{getContext:t}=HTMLCanvasElement.prototype;HTMLCanvasElement.prototype.getContext=function(e){return function(t,r){return"webgl"===t&&(r=Object.assign({},r,{preserveDrawingBuffer:!0})),e.call(this,t,r)}}(HTMLCanvasElement.prototype.getContext);const r=e();return HTMLCanvasElement.prototype.getContext=t,r}function openAutoTooltip(e){var t;const{instance:r,delay:n,initPoints:o}=e,i=r.series,a=null==o?void 0:o.flatMap((e=>{const t=null==i?void 0:i.find((t=>t.name===e.seriesName));return(null==t?void 0:t.points.find((t=>t.name===e.name)))||[]}));return null==(t=r.openAutoTooltip)?void 0:t.call(r,n,a)}function waitForChartRender(e,t,r=500){const n=e();if(n)return t(n),()=>{};const o=window.setInterval((()=>{const r=e();r&&(t(r),window.clearInterval(o))}),r);return()=>{window.clearInterval(o)}}class ExtendedChartWidget{constructor(e){__publicField(this,"instance"),__publicField(this,"emptyChart"),this.fvs=e}setSize(e,t){e.style.width="".concat(t.width,"px"),e.style.height="".concat(t.height,"px")}reset(e){clearChartInstance(e,this.instance),this.instance=void 0,e.innerHTML=""}renderEmptyChart({container:e,options:t,state:r}){var n,o;null==(o=null==(n=this.emptyChart)?void 0:n.remove)||o.call(n),this.emptyChart=renderEmptyChartTip(e,t,{width:r.width,height:r.height})}save(){return{pauseRollPlay:()=>{var e,t;null==(t=null==(e=this.instance)?void 0:e.pauseRollPlay)||t.call(e)},continueRollPlay:()=>{var e,t;null==(t=null==(e=this.instance)?void 0:e.continueRollPlay)||t.call(e)}}}}class ArcColumnWidget extends ExtendedChartWidget{constructor(){super(...arguments),__publicField(this,"disposers",[])}mount({el:e,state:t}){return this.setSize(e,t),this.disposers.push(createVisibilityMonitor(e,(e=>{var t;e&&(null==(t=this.instance)||t.resize())}))),{container:e}}async render({container:e,config:t,state:r}){this.reset(e);const n=t.configFile.chartAttr;if(this.isEmptyChart(n))return void this.renderEmptyChart({container:e,options:n,state:r});const o=window.structuredClone(n),i=new ChartInstance.Van.ArcColumn(e,this.checkOptions(o));return attachEmitter(i),this.instance=i,new Promise((e=>{i.on("finished",(()=>{i.off("finished"),e()}))}))}resize({container:e,config:t,state:r}){var n;this.setSize(e,r);const o=t.configFile.chartAttr;this.isEmptyChart(o)?this.renderEmptyChart({container:e,options:o,state:r}):null==(n=this.instance)||n.resize()}unmount({container:e}){this.reset(e),this.disposers.forEach((e=>e())),this.disposers=[]}isEmptyChart(e){return isEmptyChart(e.value)}checkOptions(e){var t,r,n,o,i;if(e.valueAxis.customizeLog){const t=e.valueAxis.customizeLog.split("");"="===t[0]&&(e.valueAxis.customizeLog=t.slice(1).join(""))}const a={adjustedCategory:[],adjustedValue:[],adjustedTooltipText:[]};a.value=e.value,a.sortType=e.sortType,null!=e.label.category&&(e.category.forEach((t=>{a.adjustedCategory.push(this.fvs.fetch.contentFormat(t,e.label.category))})),e.label.category=!0),null!=e.label.value&&(null==(t=e.value)||t.forEach((t=>{a.adjustedValue.push(this.fvs.fetch.contentFormat(t,e.label.value))})),e.label.value=!0);const s={},l={};e.tooltip.itemsFormat&&e.tooltip.itemsFormat.forEach((e=>{s[e.props[0]]=e.format,l[e.props[0]]=!0}));const c=Math.max(e.category.length,null!=(n=null==(r=e.value)?void 0:r.length)?n:0);for(let u=0;u<c;u++){let t="",r="";l.category&&(t+=this.fvs.fetch.contentFormat(e.category[u],s.category),r=" "),l.value&&(t=t+r+this.fvs.fetch.contentFormat(null!=(i=null==(o=e.value)?void 0:o[u])?i:"",s.value)),a.adjustedTooltipText.push(t)}return e.data=a,e}}function generateLinkParas(e,t){const r={};return t.forEach((t=>{const n=t.props||[],o=get$6(e,n.join("."),void 0),{key:i}=t;i&&void 0!==o&&(r[i]=o)})),r}class ChartHyperlinkGenerator{constructor(e){__publicField(this,"type"),this.type=e}generate(e){const t=e.options||{},{originalCategory:r,originalCategoryArray:n}=t;r&&!n&&(t.originalCategoryArray=[r]);const o=LINK_PARAS[this.type];return this.generateHyperlink(e,o)}}class ColumnCombinationChartHyperlinkGenerator extends ChartHyperlinkGenerator{generateHyperlink(e,t){return{name:e.series.type,fields:generateLinkParas(e,t)}}}class CustomChartHyperlinkGenerator extends ChartHyperlinkGenerator{generateHyperlink(e){var t,r;const n="gauge"===e.series.type?"GAUGE_POINTER":e.series.type.toUpperCase();return{name:null!=(r=null==(t=e.options)?void 0:t.plotIndex)?r:"",fields:generateLinkParas(e,LINK_PARAS[n])}}}class CustomMapChartHyperlinkGenerator extends ChartHyperlinkGenerator{generateHyperlink(e,t){return{name:"areaMap"!==e.series.type&&"lineMap"!==e.series.type?"pointMap":e.series.type,fields:generateLinkParas(e,"lineMap"===e.series.type?LINK_PARAS.LINE_MAP:t)}}}class DefaultChartHyperlinkGenerator extends ChartHyperlinkGenerator{generateHyperlink(e,t){return{name:"",fields:generateLinkParas(e,t)}}}class DrillChartHyperlinkGenerator extends ChartHyperlinkGenerator{generateHyperlink(e,t){return{name:"dTools"===e.linkKey?"dTools":e.series.type,fields:generateLinkParas(e,t)}}}class DrillCustomChartHyperlinkGenerator extends ChartHyperlinkGenerator{generateHyperlink(e,t){return{name:"dTools"===e.linkKey?"dTools":"customMap",fields:generateLinkParas(e,t)}}}class ChartHyperlinkFactory{create(e){switch(e){case"CUSTOM_MAP":return new CustomMapChartHyperlinkGenerator(e);case"COLUMN_LINE":case"COLUMN_AREA":case"STACK_COLUMN_LINE":return new ColumnCombinationChartHyperlinkGenerator(e);case"DRILL_AREA_MAP":case"DRILL_POINT_MAP":return new DrillChartHyperlinkGenerator(e);case"DRILL_CUSTOM_MAP":return new DrillCustomChartHyperlinkGenerator(e);case"CUSTOM":return new CustomChartHyperlinkGenerator(e);default:return new DefaultChartHyperlinkGenerator(e)}}}const chartHyperlinkFactory=new ChartHyperlinkFactory;class ShapeColumnWidget{constructor(){__publicField(this,"instance"),__publicField(this,"disposers",[]),__publicField(this,"autoTooltipControl")}mount({el:e,state:t}){return this.setSize(e,t),{container:e}}async render({config:e,runtime:t,container:r}){var n;this.reset(r);const o=ChartInstance.Van.MaxCharts.init(r);return attachEmitter(o),this.instance=o,o.setOptions(this.formatChartOptions(window.structuredClone(e.configFile.chartAttr),null==(n=t.events)?void 0:n.onClick)),new Promise((e=>{o.on("finished",(()=>{o.off("finished"),e()}))}))}resize({el:e,state:t,runtime:r}){var n,o;this.setSize(e,t),r.transition?null==(n=this.instance)||n.staticResize():null==(o=this.instance)||o.resize()}refresh({config:e,runtime:t}){var r,n;null==(n=this.instance)||n.setOptions(this.formatChartOptions(window.structuredClone(e.configFile.chartAttr),null==(r=t.events)?void 0:r.onClick))}unmount({container:e}){var t;this.reset(e),this.disposers.forEach((e=>e())),null==(t=this.autoTooltipControl)||t.stop(),this.disposers=[],this.autoTooltipControl=void 0}reset(e){clearChartInstance(e,this.instance),this.instance=void 0,e.innerHTML=""}save(){return{openAutoTooltip:(e,t)=>{const r=waitForChartRender((()=>{var e;return null==(e=this.instance)?void 0:e.getChart(0)}),(r=>{this.autoTooltipControl=openAutoTooltip({instance:r,delay:e,initPoints:t})}));this.disposers.push(r)},stop:()=>{var e;null==(e=this.autoTooltipControl)||e.stop()},moveOn:()=>{var e;null==(e=this.autoTooltipControl)||e.moveOn()}}}setSize(e,t){e.style.width="".concat(t.width,"px"),e.style.height="".concat(t.height,"px")}formatChartOptions(e,t){const r=this.getSeries(e,t),{plotOptions:n}=e;return n.shape={TRIANGLE:"triangle",TRIANGLE_3D:"triangle-3d",COLUMN_3D:"interval-3d",CHORD:"chord",CHORD_3D:"chord-3d"}[n.shapeType],{...e,hyperLink:t?{}:null,plotOptions:n,series:r,interactive:!0}}getSeries(e,t){const{data:r}=e,{fieldID:n}=e,{condition:o}=e;if(!r||!n)return[];const i=n.CATEGORY,a=n.SERIES,s=n.VALUE;let l=[],c=[],u=[];const d=[];r.forEach((e=>{const{id:t}=e,{values:r}=e;t===a?c=r:t===s?u=r:t===i&&(l=r)}));const h=[],p={};return r[0].values.forEach(((e,r)=>{const n=c[r],o=+u[r],i=l[r],a={originCategory:i,originSeries:n,x:i,y:isNaN(o)?"-":o,onClick:t?()=>{const e=generateLinkParas({category:i,series:n,value:o},LINK_PARAS.SHAPE_COLUMN);t({params:e})}:null};d.push(a),p[n]?p[n].data.push(a):(p[n]={name:n,type:"column",columnType:!1,data:[a]},h.push(p[n]))})),o.forEach((e=>{const t=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&"dataIndex"!==r&&"seriesIndex"!==r&&t.push([r,e[r]]);t.forEach((t=>{if(e.dataIndex)e.dataIndex.forEach((e=>{const r=d[e];r&&(r[t[0]]=t[1])}));else{const r=h[e.seriesIndex];r&&(r[t[0]]=t[1])}}))})),h}}class CarouselBarWidget extends ExtendedChartWidget{constructor(){super(...arguments),__publicField(this,"disposers",[])}mount({el:e,state:t}){return this.setSize(e,t),this.disposers.push(createVisibilityMonitor(e,(e=>{var t;e&&(null==(t=this.instance)||t.resize())}))),{container:e}}async render({container:e,config:t,state:r,interaction:n}){this.reset(e);const o=t.configFile.chartAttr;if(this.isEmptyChart(o))return void this.renderEmptyChart({container:e,options:o,state:r});const i=window.structuredClone(o),a=new ChartInstance.Van.CarouselBar(e,this.processOption({...i,carouselDelay:n.carousel.interval,carouselType:n.carousel.type}));return attachEmitter(a),this.instance=a,new Promise((e=>{a.on("finished",(()=>{a.off("finished"),e()}))}))}resize({container:e,config:t,state:r}){var n;this.setSize(e,r);const o=t.configFile.chartAttr;this.isEmptyChart(o)?this.renderEmptyChart({container:e,options:o,state:r}):null==(n=this.instance)||n.resize()}unmount({container:e}){this.reset(e),this.disposers.forEach((e=>e())),this.disposers=[]}isEmptyChart(e){return isEmptyChart(e.data)}processOption(e){function t(e){return 0===e.target?0:e.value/e.target}return e.labels.forEach((e=>{const{formatter:t}=e;t&&(e.formatter=e=>(t.match(/^D/)&&!isNaN(+e)&&(e=+e),this.fvs.fetch.contentFormat(e,t)))})),"original"!==e.sort&&e.data.sort(((r,n)=>(t(r)-t(n))*("reverse"===e.sort?1:-1))),e}}class CarouselPieWidget extends ExtendedChartWidget{constructor(){super(...arguments),__publicField(this,"disposers",[])}mount({el:e,state:t}){return this.setSize(e,t),this.disposers.push(createVisibilityMonitor(e,(e=>{var t;e&&(null==(t=this.instance)||t.resize())}))),{container:e}}async render({container:e,config:t,state:r,runtime:n,interaction:o}){this.reset(e);const i=t.configFile.chartAttr;if(this.isEmptyChart(i))return void this.renderEmptyChart({container:e,options:i,state:r});const a=window.structuredClone(i),s=new ChartInstance.Van.CarouselPie(e,this.processOption({...a,carouselInterval:o.carousel.interval}));return attachEmitter(s),this.instance=s,s.on("exitEnd",(e=>{var t,r;const o=LINK_PARAS.CAROUSEL_PIE;null==(r=null==(t=null==n?void 0:n.events)?void 0:t.onCarousel)||r.call(t,{params:generateLinkParas(e,o)})})),new Promise((e=>{s.on("finished",(()=>{s.off("finished"),e()}))}))}resize({container:e,config:t,state:r}){var n;this.setSize(e,r);const o=t.configFile.chartAttr;this.isEmptyChart(o)?this.renderEmptyChart({container:e,options:o,state:r}):null==(n=this.instance)||n.resize()}unmount({container:e}){this.reset(e),this.disposers.forEach((e=>e())),this.disposers=[]}isEmptyChart(e){return isEmptyChart(e.data)}processOption(e){return e.labels.forEach((e=>{const{formatter:t}=e;t&&(e.formatter=e=>(t.match(/^D/)&&!isNaN(+e)&&(e=+e),this.fvs.fetch.contentFormat(e,t)))})),e}}class FluidWidget extends ExtendedChartWidget{constructor(){super(...arguments),__publicField(this,"disposers",[])}mount({el:e,state:t}){return this.setSize(e,t),this.disposers.push(createVisibilityMonitor(e,(e=>{var t;e&&(null==(t=this.instance)||t.resize())}))),{container:e}}async render({container:e,config:t,state:r,interaction:n,runtime:o}){this.reset(e);const i=t.configFile.chartAttr;if(this.isEmptyChart(i))return void this.renderEmptyChart({container:e,options:i,state:r});const a=window.structuredClone(i),s=new ChartInstance.Van.WaterFlow(e,{...a,dataSheet:{...i.dataSheet,timeWait:millisecondToSecond(n.carousel.interval)}});return attachEmitter(s),this.instance=s,s.on("exitEnd",(e=>{var t,r;const n=LINK_PARAS.FLUID;null==(r=null==(t=null==o?void 0:o.events)?void 0:t.onCarousel)||r.call(t,{params:generateLinkParas(e,n)})})),new Promise((e=>{s.on("finished",(()=>{s.off("finished"),e()}))}))}resize({container:e,config:t,state:r}){var n;this.setSize(e,r);const o=t.configFile.chartAttr;this.isEmptyChart(o)?this.renderEmptyChart({container:e,options:o,state:r}):null==(n=this.instance)||n.resize()}unmount({container:e}){this.reset(e),this.disposers.forEach((e=>e())),this.disposers=[]}isEmptyChart(e){var t;const r=(null==(t=null==e?void 0:e.dataSheet)?void 0:t.index)||[];return 0===r.length||1===r.length&&""===r[0]}}class PixelGridWidget extends ExtendedChartWidget{constructor(){super(...arguments),__publicField(this,"disposers",[]),__publicField(this,"context")}mount({el:e,state:t}){return this.setSize(e,t),this.disposers.push(createVisibilityMonitor(e,(e=>{e&&this.context&&this.resize(this.context)}))),{container:e}}async render(e){const{container:t,config:r,state:n,interaction:o,runtime:i}=e;this.reset(t),this.context=e;const a=r.configFile.chartAttr;if(this.isEmptyChart(a))return void this.renderEmptyChart({container:t,options:a,state:n});const s=window.structuredClone(a),l=new ChartInstance.Van.PixelGrid(t,{...s,dataSheet:{...a.dataSheet,timeWait:millisecondToSecond(o.carousel.interval)}});attachEmitter(l),this.instance=l,l.on("exitEnd",(e=>{var t,r;const n=LINK_PARAS.PIXEL_GRID;null==(r=null==(t=null==i?void 0:i.events)?void 0:t.onCarousel)||r.call(t,{params:generateLinkParas(e,n)})}))}resize(e){this.setSize(e.container,e.state),this.render(e)}unmount({container:e}){this.reset(e),this.disposers.forEach((e=>e())),this.disposers=[]}isEmptyChart(e){var t;const r=(null==(t=null==e?void 0:e.dataSheet)?void 0:t.index)||[];return 0===r.length||1===r.length&&""===r[0]}}class KpiWidget extends ExtendedChartWidget{constructor(){super(...arguments),__publicField(this,"disposers",[])}mount({el:e,state:t}){return this.setSize(e,t),this.disposers.push(createVisibilityMonitor(e,(e=>{var t;e&&(null==(t=this.instance)||t._refresh())}))),{container:e}}async render({container:e,config:t,state:r,interaction:n,runtime:o}){this.reset(e);const i=t.configFile.chartAttr;if(this.isEmptyChart(i))return void this.renderEmptyChart({container:e,options:i,state:r});const a=this.createChartContainer();e.appendChild(a);const s=window.structuredClone(i),l=new ChartInstance.Van.kpi(a,this.dealOption({...s,interval:millisecondToSecond(n.carousel.interval)}));return attachEmitter(l),this.instance=l,l.on("exitEnd",(e=>{var t,r;const n=LINK_PARAS.KPI1;null==(r=null==(t=null==o?void 0:o.events)?void 0:t.onCarousel)||r.call(t,{params:generateLinkParas(e,n)})})),new Promise((e=>{l.on("finished",(()=>{l.off("finished"),e()}))}))}createChartContainer(){const e=document.createElement("div");return e.classList.add("kpi-widget-container"),e.style.width="100%",e.style.height="100%",e}resize({container:e,config:t,state:r}){var n;this.setSize(e,r);const o=t.configFile.chartAttr;this.isEmptyChart(o)?this.renderEmptyChart({container:e,options:o,state:r}):null==(n=this.instance)||n._refresh()}unmount({container:e}){this.reset(e),this.disposers.forEach((e=>e())),this.disposers=[]}isEmptyChart(e){const t=(null==e?void 0:e.value)||[],r=(null==e?void 0:e.names)||[];return 0===t.length&&0===r.length}dealOption(e){const t={...e},r=[],n=t.valueColor.values,o=t.valueColor.colors,{values:i}=t,a=n.length;for(let u=0,d=i.length;u<d;u++){const e=i[u];if(e<=n[0])r[u]=o[0];else if(e>=n[a-1])r[u]=o[o.length-1];else for(let t=0;t<a;t++)e>=n[t]&&e<=n[t+1]&&(r[u]=o[t])}t.colors=r;const s=[],l=t.formatter,c=i.length;for(let u=0;u<c;u++)s[u]=this.fvs.fetch.contentFormat(i[u],l);return t.values=s,t}}class CarouselGaugeWidget extends ExtendedChartWidget{constructor(){super(...arguments),__publicField(this,"disposers",[])}mount({el:e,state:t}){return this.setSize(e,t),this.disposers.push(createVisibilityMonitor(e,(e=>{var t;e&&(null==(t=this.instance)||t.resize())}))),{container:e}}async render({container:e,config:t,state:r,interaction:n,runtime:o}){this.reset(e);const i=t.configFile.chartAttr;if(this.isEmptyChart(i))return void this.renderEmptyChart({container:e,options:i,state:r});const a=window.structuredClone(i),s=new ChartInstance.Van.SliderDashboard({...a,container:e,timeInterval:millisecondToSecond(n.carousel.interval)});return attachEmitter(s),this.instance=s,s.on("exitEnd",(e=>{var t,r;const n=LINK_PARAS.CAROUSEL_GAUGE;null==(r=null==(t=null==o?void 0:o.events)?void 0:t.onCarousel)||r.call(t,{params:generateLinkParas(e,n)})})),new Promise((e=>{s.on("finished",(()=>{s.off("finished"),e()}))}))}resize({container:e,state:t,config:r}){var n;this.setSize(e,t);const o=r.configFile.chartAttr;this.isEmptyChart(o)?this.renderEmptyChart({container:e,options:o,state:t}):null==(n=this.instance)||n.resize()}unmount({container:e}){this.reset(e),this.disposers.forEach((e=>e())),this.disposers=[]}isEmptyChart(e){return(e.dataSet||[]).length<2}}class TimeGearWidget extends ExtendedChartWidget{constructor(){super(...arguments),__publicField(this,"disposers",[])}mount({el:e,state:t}){return this.setSize(e,t),this.disposers.push(createVisibilityMonitor(e,(e=>{var t;e&&(null==(t=this.instance)||t.resize())}))),{container:e}}async render({container:e,config:t}){this.reset(e);const r=window.structuredClone(t.configFile.chartAttr),n="".concat(this.fvs.env.servletURL,"/resource?resource=com/fr/plugin/wysiwyg/chart/requiredFile"),o={tickSvgUrl:"/timegear/ticks.svg",spriteSvgUrl:"/timegear/sprite.svg",tickMaskSvgUrl:"/timegear/tickMask.svg"};for(const a in o)r[a]=n+o[a];const i=new ChartInstance.Van.DigitalClock({...r,container:e,themeColor:ChartInstance.ColorUtils.colorToHex(r.themeColor)});this.instance=i}resize({container:e,state:t}){var r;this.setSize(e,t),null==(r=this.instance)||r.resize()}unmount({container:e}){this.reset(e),this.disposers.forEach((e=>e())),this.disposers=[]}}class WisdomTreeWidget extends ExtendedChartWidget{constructor(){super(...arguments),__publicField(this,"disposers",[])}mount({el:e,state:t}){return this.setSize(e,t),this.disposers.push(createVisibilityMonitor(e,(e=>{var t;e&&(null==(t=this.instance)||t.resize())}))),{container:e}}async render({container:e,config:t,interaction:r,runtime:n}){this.reset(e);const o=window.structuredClone(t.configFile.chartAttr),i=new ChartInstance.Van.WisdomTree(e,this.processChartOption({...o,duration:r.carousel.interval}));return attachEmitter(i),this.instance=i,i.on("pointSelected",(e=>{var t,r;const o=LINK_PARAS.WISDOM_TREE_ELECTRON;null==(r=null==(t=null==n?void 0:n.events)?void 0:t.onCarousel)||r.call(t,{params:generateLinkParas(this.getHyperLinkParams(e),o)})})),i.on("click",(e=>{var t,r;const o=LINK_PARAS.WISDOM_TREE_ELECTRON;null==(r=null==(t=null==n?void 0:n.events)?void 0:t.onClick)||r.call(t,{params:generateLinkParas(this.getHyperLinkParams(e),o)})})),new Promise((e=>{i.on("finished",(()=>{i.off("finished"),e()}))}))}resize({container:e,state:t}){var r;this.setSize(e,t),null==(r=this.instance)||r.resize()}unmount({container:e}){this.reset(e),this.disposers.forEach((e=>e())),this.disposers=[]}getHyperLinkParams(e){const{item:t}=e;return{name:t.title,value:t.content,event:e.event}}processChartOption(e){const{servletURL:t}=this.fvs.env;return e.title=this.dealFormatFunc(e.title),e.content=this.dealFormatFunc(e.content),e.bubble.url="".concat(t).concat(e.bubble.url),e.video.url="".concat(t).concat(e.video.url),e.video.flowLightUrl="".concat(t).concat(e.video.flowLightUrl),e.video.gearUrl="".concat(t).concat(e.video.gearUrl),e.video.wholeUrl="".concat(t).concat(e.video.wholeUrl),e}dealFormatFunc(e){const{format:t}=e;return null==t||"function"==typeof t||(e.format=e=>(t.match(/^D/)&&!isNaN(+e)&&(e=+e),this.fvs.fetch.contentFormat(e,t))),e}}class CarouselCatalogWidget extends ExtendedChartWidget{mount({el:e,state:t}){return this.setSize(e,t),{container:e,instance:{current:null}}}async render({container:e,instance:t,config:r,state:n,runtime:o,interaction:i}){this.reset(e);const a=r.configFile.chartAttr;if(this.isEmptyChart(a))return t.current=null,void this.renderEmptyChart({container:e,options:a,state:n});const s=window.structuredClone(a),l=new ChartInstance.Van.VanGeer({...s,duration:i.carousel.interval},e);return attachEmitter(l),t.current=l,this.instance=l,l.on("exitEnd",(e=>{var t,r;const n=LINK_PARAS.CAROUSEL_CATALOG;null==(r=null==(t=null==o?void 0:o.events)?void 0:t.onCarousel)||r.call(t,{params:generateLinkParas(e,n)})})),new Promise((e=>{l.on("finished",(()=>{l.off("finished"),e()}))}))}resize(e){this.setSize(e.container,e.state),this.render(e)}unmount({container:e}){this.reset(e)}isEmptyChart(e){var t;return 0===(null==(t=e.nodes)?void 0:t.length)}}function getMapOption(e){return"blue"===e?{backgroundColor:"rgb(0, 0, 16)",series:[{type:"map",map:"world",itemStyle:{areaColor:"rgb(8, 15, 27)",borderColor:"rgb(108,118,255)"},emphasis:{label:{show:!1},itemStyle:{areaColor:"rgb(8, 15, 27)"}},top:0,left:0,right:0,bottom:0,boundingCoords:[[-180,90],[180,-90]]}]}:"black"===e?{backgroundColor:"rgb(0, 0, 0)",series:[{type:"map",map:"world",itemStyle:{areaColor:"rgb(0, 0, 0)",borderColor:"rgb(118,118,118)"},emphasis:{label:{show:!1},itemStyle:{areaColor:"rgb(0, 0, 0)"}},top:0,left:0,right:0,bottom:0,boundingCoords:[[-180,90],[180,-90]]}]}:"red"===e?{backgroundColor:"rgb(6, 3, 9)",series:[{type:"map",map:"world",itemStyle:{areaColor:"rgb(18, 5, 5)",borderColor:"rgb(255, 0, 0)"},emphasis:{label:{show:!1},itemStyle:{areaColor:"rgb(18, 5, 5)"}},top:0,left:0,right:0,bottom:0,boundingCoords:[[-180,90],[180,-90]]}]}:{backgroundColor:"rgb(0, 9, 10)",series:[{type:"map",map:"world",itemStyle:{areaColor:"rgb(0, 31, 33)",borderColor:"rgb(0, 252, 252)"},emphasis:{label:{show:!1},itemStyle:{areaColor:"rgb(0, 31, 33)"}},top:0,left:0,right:0,bottom:0,boundingCoords:[[-180,90],[180,-90]]}]}}const texTureMap=new Map;function createTexture(e){if(texTureMap.has(e))return texTureMap.get(e);const t=document.createElement("canvas"),r=ChartInstance.Echarts.init(t,null,{width:4096,height:2048});return r.setOption(getMapOption(e)),texTureMap.set(e,r),r}function tooltipFormatter(e,t){if(e.tooltip.show&&e.tooltip.itemsFormat){const{itemsFormat:r}=e.tooltip;e.tooltip.formatter=e=>{let n="";return r.forEach((r=>{const{format:o}=r,i=r.props||[];let a=e;i.forEach((e=>{a&&(a=a[e])})),n+="".concat(r.name,":").concat(t(a,o),"<br>")})),n}}}function formatterOption(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const r=e[t];"object"==typeof r?formatterOption(r):"formatter"===t&&(e.formatter=new Function("return ".concat(e.formatter))())}}function createGlobeClass(e){return class{constructor(e){__publicField(this,"emptyChart"),this.fvs=e}mount({el:e,state:t}){return this.setSize(e,t),{container:e,instance:{current:null}}}async render({container:t,instance:r,config:n,state:o,runtime:i}){var a;this.reset(t,r.current);const s=n.configFile.chartAttr;if(this.isEmptyChart(s))return r.current=null,void this.renderEmptyChart({container:t,options:s,state:o});const l=window.structuredClone(s),c=ChartInstance.Echarts.init(t),u=null==(a=i.events)?void 0:a.onClick;return u&&c.on("click",(t=>{u({params:generateLinkParas(t,LINK_PARAS[e])})})),r.current=c,new Promise((e=>{c.on("rendered",(()=>{c.off("rendered"),window.setTimeout((()=>{e()}),1e3)})),c.setOption(this.getCompleteOption(l),!0)}))}resize({container:e,state:t,instance:r,config:n}){var o;this.setSize(e,t);const i=n.configFile.chartAttr;if(this.isEmptyChart(i))return r.current=null,void this.renderEmptyChart({container:e,options:i,state:t});null==(o=r.current)||o.resize()}unmount({container:e,instance:t}){this.reset(e,t.current)}isEmptyChart(e){var t,r;return 0===(null==(r=null==(t=e.series)?void 0:t.data)?void 0:r.length)}setSize(e,t){e.style.width="".concat(t.width,"px"),e.style.height="".concat(t.height,"px")}reset(e,t){clearChartInstance(e,t),e.innerHTML=""}renderEmptyChart({container:e,options:t,state:r}){var n,o;null==(o=null==(n=this.emptyChart)?void 0:n.remove)||o.call(n),this.emptyChart=renderEmptyChartTip(e,t,{width:r.width,height:r.height})}getCompleteOption(e){return formatterOption(e),tooltipFormatter(e,this.fvs.fetch.contentFormat),this.completeGlobe(e),e}completeGlobe(e){if(e&&e.globe){const{globe:t}=e;t.heightTexture&&(t.heightTexture="".concat(this.fvs.env.servletURL,"?op=resource&resource=").concat(t.heightTexture)),t.realisticMaterial={roughness:1,metalness:1},t.postEffect={enable:!0};const r=t.light=t.light||{};r.ambient={intensity:1},r.ambientCubemap={texture:"".concat(this.fvs.env.servletURL,"/resource?resource=com/fr/plugin/wysiwyg/chart/requiredFile/Mans_Outside_2k.hdr"),exposure:1,diffuseIntensity:5,specularIntensity:20},t.baseTexture=createTexture(t.baseTexture)}}}}const BarGlobeWidget=createGlobeClass("BAR_3D_ON_GLOBE"),ScatterGlobeWidget=createGlobeClass("SCATTER_3D_ON_GLOBE"),LinesGlobeWidget=createGlobeClass("LINES_3D_ON_GLOBE");class ParticleWidget{constructor(){__publicField(this,"emptyChart")}mount({el:e,state:t}){return this.setSize(e,t),{container:e,instance:{current:null}}}async render({container:e,instance:t,config:r,state:n}){this.reset(e,t.current);const o=r.configFile.chartAttr;if(this.isEmptyChart(o))return t.current=null,void this.renderEmptyChart({container:e,options:o,state:n});const i=window.structuredClone(o),a=new ChartInstance.Van.ParticleCounter(e,i);return t.current=a,new Promise((e=>{a.on("finished",(()=>{e()}))}))}resize({container:e,state:t,instance:r,config:n}){var o;this.setSize(e,t);const i=n.configFile.chartAttr;if(this.isEmptyChart(i))return r.current=null,void this.renderEmptyChart({container:e,options:i,state:t});null==(o=r.current)||o.resize()}isEmptyChart(e){return!e.content}renderEmptyChart({container:e,options:t,state:r}){var n,o;null==(o=null==(n=this.emptyChart)?void 0:n.remove)||o.call(n),this.emptyChart=renderEmptyChartTip(e,t,{width:r.width,height:r.height})}setSize(e,t){e.style.width="".concat(t.width,"px"),e.style.height="".concat(t.height,"px")}reset(e,t){clearChartInstance(e,t),e.innerHTML=""}unmount({container:e,instance:t}){this.reset(e,t.current)}}class GroupMapWidget extends ExtendedChartWidget{mount({el:e,state:t}){return this.setSize(e,t),{container:e,instance:{current:null}}}async render({container:e,instance:t,config:r,runtime:n,interaction:o}){this.reset(e);const i=window.structuredClone(r.configFile.chartAttr),a=createChartInSandbox((()=>new ChartInstance.Van.Combined3DMap({...i,container:e,interval:o.carousel.interval,geoUrl:"".concat(this.fvs.env.servletURL,"?op=get_json_data&resourcepath=").concat(i.mapUrl)})));return this.instance=a,t.current=a,a.on("exitEnd",(e=>{var t,r;const o=LINK_PARAS.GROUP_MAP;null==(r=null==(t=null==n?void 0:n.events)?void 0:t.onCarousel)||r.call(t,{params:generateLinkParas(e,o)})})),new Promise((e=>{a.on("finished",(()=>{a.off("finished"),e()}))}))}resize(e){this.setSize(e.container,e.state),this.render(e)}unmount({container:e}){this.reset(e)}save(){return{pauseRollPlay:()=>{},continueRollPlay:()=>{}}}}class GeoLandWidget{constructor(e){__publicField(this,"disposers",[]),__publicField(this,"instance",null),__publicField(this,"container",null),this.fvs=e}mount({el:e,state:t}){return this.setSize(e,t),this.container=e,{container:e,instance:{current:null}}}render(e){const t=e.instance.current;if(t)return this.instance=e.instance,this.addWidgetEventListener(t,e.runtime),this.refresh(e),Promise.resolve();const{container:r,instance:n,config:o,interaction:i,runtime:a,state:s}=e;this.setSize(r,s),this.reset(r,n.current);const l=this.createChartContainer();r.appendChild(l);const c=o.configFile.chartAttr,u=ChartInstance.Van.GeoLandWidget.init({container:l,options:{...window.structuredClone(c),interval:i.carousel.interval},baseUrl:c.baseUrl});n.current=u,this.addWidgetEventListener(n.current,a);const d=new RenderProgress(!1);return n.current.on("loadingProgress",(e=>{d.update(e)})),n.current.on("finished",(()=>{d.finish()})),this.instance=n,d}createChartContainer(){const e=document.createElement("div");return e.classList.add("geoland-widget-container"),e.style.width="100%",e.style.height="100%",e}addWidgetEventListener(e,t){e.on("click",(e=>{var r,n;const o=getTriggerType(e.type),i=LINK_PARAS["GEO_LAND".concat(o)];null==(n=null==(r=null==t?void 0:t.events)?void 0:r.onClick)||n.call(r,{target:o,params:generateLinkParas(e,i)})})),e.on("drillUp",(e=>{var r,n;const o=LINK_PARAS.GEO_LANDdrillLink;null==(n=null==(r=null==t?void 0:t.events)?void 0:r.onDrillUp)||n.call(r,{target:"drillLink",params:generateLinkParas({linkAreaName:e},o)})})),e.on("carouselLink",(e=>{var r,n;const o=getTriggerType(e.type),i=LINK_PARAS["GEO_LAND".concat(o)];null==(n=null==(r=null==t?void 0:t.events)?void 0:r.onCarousel)||n.call(r,{params:generateLinkParas(e,i)})})),e.on("markermouseenter",(r=>{var n,o;const i=null==(n=e.dom)?void 0:n.querySelector("canvas");if(i){const n=null==(o=null==t?void 0:t.events)?void 0:o.onClick,a=e.canDrillDown(r);i.style.cursor=n||a?"pointer":"default"}})),e.on("markermouseexit",(()=>{var t;const r=null==(t=e.dom)?void 0:t.querySelector("canvas");r&&(r.style.cursor="default")}))}setSize(e,t){e.style.width="".concat(t.width,"px"),e.style.height="".concat(t.height,"px")}reset(e,t){clearChartInstance(e,t),e.innerHTML=""}refresh(e){var t;const{instance:r,config:n,interaction:o}=e;null==(t=r.current)||t.updateOptions({...window.structuredClone(n.configFile.chartAttr),interval:o.carousel.interval}),this.resize(e)}resize(e){var t;const{container:r,instance:n,state:o}=e;this.setSize(r,o),null==(t=n.current)||t.resize()}dispose(){this.disposers.forEach((e=>e())),this.disposers=[]}unmount({container:e,instance:t}){this.reset(e,t.current),this.dispose()}save(){return{getCameraState:()=>{var e,t,r;return null==(r=null==(t=null==(e=this.instance)?void 0:e.current)?void 0:t.chart)?void 0:r.getCameraState()},clear:()=>{var e,t,r,n,o,i,a,s;this.container&&(this.container.style.width="0px",this.container.style.height="0px"),null==(t=null==(e=this.instance)?void 0:e.current)||t.resize(),null==(o=null==(n=null==(r=this.instance)?void 0:r.current)?void 0:n.chart)||o._callMethod("SetQualityLevel",0),null==(s=null==(a=null==(i=this.instance)?void 0:i.current)?void 0:a.chart)||s.reset()},pauseRollPlay:()=>{var e,t,r;null==(r=null==(t=null==(e=this.instance)?void 0:e.current)?void 0:t.pauseRollPlay)||r.call(t)},continueRollPlay:()=>{var e,t,r;null==(r=null==(t=null==(e=this.instance)?void 0:e.current)?void 0:t.continueRollPlay)||r.call(t)}}}}function getTriggerType(e){return e=-1!==["pyramid4","pyramid3","diamondPyramid","lightSpot"].indexOf(e)?"point":e}class SlideShowMapWidget extends ExtendedChartWidget{constructor(){super(...arguments),__publicField(this,"disposers",[])}mount({el:e,state:t}){return this.setSize(e,t),this.disposers.push(createVisibilityMonitor(e,(e=>{var t;e&&(null==(t=this.instance)||t.resize())}))),{container:e,instance:{current:null}}}async render({container:e,instance:t,config:r,state:n,interaction:o,runtime:i}){this.reset(e);const a=r.configFile.chartAttr;if(this.isEmptyChart(a))return t.current=null,void this.renderEmptyChart({container:e,options:a,state:n});const s=window.structuredClone(a),l=createChartInSandbox((()=>new ChartInstance.Van.SlideshowMap(this.fillOptions({...s,container:e,interval:o.carousel.interval}))));return t.current=l,this.instance=l,l.on("exitEnd",(e=>{var t,r;const n=LINK_PARAS.SLIDE_SHOW_MAP;null==(r=null==(t=null==i?void 0:i.events)?void 0:t.onCarousel)||r.call(t,{params:generateLinkParas(e,n)})})),new Promise((e=>{l.on("finished",(()=>{l.off("finished"),e()}))}))}resize({container:e,state:t,instance:r,config:n}){var o;this.setSize(e,t);const i=n.configFile.chartAttr;this.isEmptyChart(i)?this.renderEmptyChart({container:e,options:i,state:t}):null==(o=r.current)||o.resize()}unmount({container:e}){this.reset(e)}save(){return{pauseRollPlay:()=>{},continueRollPlay:()=>{}}}isEmptyChart(e){return 0===((null==e?void 0:e.locations)||[]).length}fillOptions(e){if((e={...e,effectCircleUrl:"".concat(this.fvs.env.servletURL,"/resource?resource=com/fr/plugin/wysiwyg/chart/requiredFile/circle.webm"),globalUrl:"".concat(this.fvs.env.servletURL,"/resource?resource=com/fr/plugin/wysiwyg/chart/requiredFile/global.webm"),pitch:60,interactive:!1}).locations){const{locations:t}=e,{tooltip:r}=e;t.forEach(((t,n)=>{t.zoom=e.playZoom,t.pitch=45,t.size=e.size,t.showCard=r.showCard,t.fixed=r.fixed,t.type=e.type,t.opacity=e.opacity,t.index=n+1,t.color=e.color,t.labelScale=e.labelScale,t.fontFamily=e.fontFamily,["areaName","description"].forEach((e=>{t[e]=null!=r[e]?this.fvs.fetch.contentFormat(t[e],r[e]):""}));const o=[];for(let e=0,i=Math.min(t.seriesName.length,t.value.length);e<i;e++){const n=null!=r.seriesName?this.fvs.fetch.contentFormat(t.seriesName[e],r.seriesName):"";let i=null!=r.value?this.fvs.fetch.contentFormat(t.value[e],r.value):"";r.value&&r.value.match(/^D/)&&i===t.value[e]&&"".concat(parseInt(t.value[e]))===t.value[e]&&(i=null!=r.value?this.fvs.fetch.contentFormat(parseInt(t.value[e]),r.value):"");const a=n+(n&&i?":":"")+i;o.push(a)}t.contents=o}))}return e}}const createVanChartWidget$1=(e,t)=>class{constructor(){__publicField(this,"instance"),__publicField(this,"autoTooltipControl"),__publicField(this,"disposers",[]),__publicField(this,"hyperlink",chartHyperlinkFactory.create(e))}mount({el:e,state:t}){this.setSize(e,t);const r=ChartInstance.VanCharts.init(e);return this.instance=r,{chartInstance:r}}render({chartInstance:e,config:r,theme:n,runtime:{transition:o,events:i}}){this.dispose();const a=null==i?void 0:i.onClick;e.doHyperlink=a?e=>{Promise.resolve().then((()=>{const{name:t,fields:r}=this.hyperlink.generate(e);a({target:t,params:r})}))}:()=>{};const{chartAttr:s}=r.configFile;return e.setOptions(window.structuredClone({...s,...o&&{__resizeRenderer:"areaMap"!==s.chartType,refreshType:"tip_increment",incrementRefreshCondition:"optionsChange"},hyperLink:a?{}:s.hyperLink,theme:n.scheme,interactive:t})),new Promise((e=>{const t=setTimeout((()=>{e()}),1500);this.disposers.push((()=>window.clearTimeout(t)))}))}refresh({config:e,...t}){this.render({config:{configFile:"observe"===t.runtime.refreshStatus?{...e.configFile,chartAttr:{...e.configFile.chartAttr,refreshType:"tip_increment"}}:e.configFile},...t})}resize({el:e,state:t,chartInstance:r,runtime:n}){this.setSize(e,t),n.transition?r.staticResize():r.resize()}dispose(){this.disposers.forEach((e=>e())),this.disposers=[]}setSize(e,t){e.style.width="".concat(t.width,"px"),e.style.height="".concat(t.height,"px")}unmount({chartInstance:e}){var t;try{this.dispose(),null==(t=this.autoTooltipControl)||t.stop(),e.clear(),this.instance=void 0,this.autoTooltipControl=void 0}catch(r){console.error(r)}}save(){return{getChart:()=>{var e;return null==(e=this.instance)?void 0:e.getChart(0)},openAutoTooltip:(e,t)=>{const r=waitForChartRender((()=>{var e;return null==(e=this.instance)?void 0:e.getChart(0)}),(r=>{this.autoTooltipControl=openAutoTooltip({instance:r,delay:e,initPoints:t})}));this.disposers.push(r)},stop:()=>{var e;return null==(e=this.autoTooltipControl)?void 0:e.stop()},moveOn:()=>{var e;return null==(e=this.autoTooltipControl)?void 0:e.moveOn()}}}},createVanChartWidgetInPreview$1=e=>createVanChartWidget$1(e,!0),createVanChartWidgetInEdit$1=e=>createVanChartWidget$1(e,!1);function useChartConfig({chartOptions:e,width:t,height:r}){return{computed:reactExports.useMemo((()=>e?{configFile:e}:null),[e]),state:reactExports.useMemo((()=>({width:t,height:null!=r?r:0})),[t,r])}}const ChartView$1=observer((({model:e,width:t,height:r})=>{const{computed:n,state:o}=useChartConfig({chartOptions:e.chartOptions,width:t,height:r}),i=useClassWidget({widgetClass:reactExports.useMemo((()=>e.isPreview?createVanChartWidgetInPreview$1(e.chartType):createVanChartWidgetInEdit$1(e.chartType)),[e.chartType,e.isPreview]),model:e,computed:n,state:o,runtime:{transition:e.getWidgetTransitionInfo(),events:{onClick:e.isHoverPointer?t=>{e.trigger(null==t?void 0:t.target,null==t?void 0:t.params)}:void 0}}});return jsxs(Fragment,{children:[jsx("div",{className:"inner-widget-container",ref:i}),!e.isPreview&&jsx("div",{className:"widget-masker"})]})}));function generateTrigger(e,t,r){return{text:e,value:t,fields:LINK_PARAS[r].map((e=>({text:e.text,value:e.key})))}}class ChartTriggersGenerator{constructor(e){__publicField(this,"type"),this.type=e}generate(){return generateTrigger("","",this.type)}}class ColumnAreaTriggersGenerator extends ChartTriggersGenerator{generate(){return[generateTrigger(duchampIntl.get("Duchamp-Column_Chart"),"column","COLUMN"),generateTrigger(duchampIntl.get("Duchamp-Area_Chart"),"area","AREA")]}}class ColumnLineTriggersGenerator extends ChartTriggersGenerator{generate(){return[generateTrigger(duchampIntl.get("Duchamp-Column_Chart"),"column","COLUMN"),generateTrigger(duchampIntl.get("Duchamp-Line_Chart"),"line","LINE")]}}class CustomMapTriggersGenerator extends ChartTriggersGenerator{generate(){return[generateTrigger(duchampIntl.get("Duchamp-Area_Map"),"areaMap","AREA_MAP"),generateTrigger(duchampIntl.get("Duchamp-Point_Map"),"pointMap","POINT_MAP"),generateTrigger(duchampIntl.get("Duchamp-Flow_Map"),"lineMap","LINE_MAP")]}}class DrillAreaMapTriggersGenerator extends ChartTriggersGenerator{generate(){return[generateTrigger(duchampIntl.get("Duchamp-Graphics"),"areaMap","DRILL_AREA_MAP"),generateTrigger(duchampIntl.get("Duchamp-Drill_Directory"),"dTools","DRILL_AREA_MAPdTools")]}}class DrillCustomMapTriggersGenerator extends ChartTriggersGenerator{generate(){return[generateTrigger(duchampIntl.get("Duchamp-Graphics"),"customMap","DRILL_CUSTOM_MAP"),generateTrigger(duchampIntl.get("Duchamp-Drill_Directory"),"dTools","DRILL_CUSTOM_MAPdTools")]}}class DrillPointMapTriggersGenerator extends ChartTriggersGenerator{generate(){return[generateTrigger(duchampIntl.get("Duchamp-Graphics"),"pointMap","DRILL_POINT_MAP"),generateTrigger(duchampIntl.get("Duchamp-Drill_Directory"),"dTools","DRILL_POINT_MAPdTools")]}}class StackColumnLineTriggersGenerator extends ChartTriggersGenerator{generate(){return[generateTrigger(duchampIntl.get("Duchamp-Stacked_Column_Chart"),"column","COLUMN"),generateTrigger(duchampIntl.get("Duchamp-Line_Chart"),"line","LINE")]}}class ChartTriggersGeneratorFactory{create(e){switch(e){case"CUSTOM_MAP":return new CustomMapTriggersGenerator(e);case"DRILL_AREA_MAP":return new DrillAreaMapTriggersGenerator(e);case"DRILL_POINT_MAP":return new DrillPointMapTriggersGenerator(e);case"DRILL_CUSTOM_MAP":return new DrillCustomMapTriggersGenerator(e);case"COLUMN_LINE":return new ColumnLineTriggersGenerator(e);case"COLUMN_AREA":return new ColumnAreaTriggersGenerator(e);case"STACK_COLUMN_LINE":return new StackColumnLineTriggersGenerator(e);default:return new ChartTriggersGenerator(e)}}}const chartTriggersGeneratorFactory=new ChartTriggersGeneratorFactory,FLUID_LINE_PARTS=2,FLUID_BLOCK_PARTS=8,SORT_MODE={NULL:0,DESCENDING:-1,ASCENDING:1},CHART_ICON_SIZE=18,ChartTools=({isZoomed:e,sortable:t,zoomable:r,sortMode:n,onSort:o,onZoom:i})=>jsxs("div",{className:"chart-tools",children:[t&&jsxs(Fragment,{children:[jsx(Icon,{className:"chart-icon",name:"fdm-chart-reset",size:CHART_ICON_SIZE,visible:n!==SORT_MODE.NULL,onClick:()=>{o(SORT_MODE.NULL)}}),jsx(Icon,{className:"chart-icon",name:"fdm-chart-descending",size:CHART_ICON_SIZE,visible:n===SORT_MODE.DESCENDING,onClick:()=>{null==o||o(SORT_MODE.DESCENDING)}}),jsx(Icon,{className:"chart-icon",name:"fdm-chart-ascending",size:CHART_ICON_SIZE,visible:n!==SORT_MODE.DESCENDING,onClick:()=>{null==o||o(SORT_MODE.ASCENDING)}})]}),jsx(Icon,{className:"chart-icon",name:e?"fdm-zoom-out":"fdm-zoom-in",size:CHART_ICON_SIZE,visible:r,onClick:()=>i(!e)})]}),TOOLS_SORT_MAP={[SORT_MODE.NULL]:SORT_MODE.NULL,[SORT_MODE.DESCENDING]:SORT_MODE.ASCENDING,[SORT_MODE.ASCENDING]:SORT_MODE.DESCENDING},ChartComponent=reactExports.forwardRef((({width:e,height:t,options:r,isZoomed:n,blockGestures:o,onClick:i,isClickAwayAllowed:a,toggleZoom:s},l)=>{var c,u;const d=reactExports.useRef(null),[h,p]=reactExports.useState(SORT_MODE.NULL),f=null==(c=null==r?void 0:r.tools.sort)?void 0:c.enabled,g=null==(u=null==r?void 0:r.tools.fullScreen)?void 0:u.enabled;reactExports.useEffect((()=>{f&&p(SORT_MODE.NULL)}),[f,n,e,t]),reactExports.useImperativeHandle(l,(()=>({getChart:e=>{var t,r,n;return null==(n=null==(r=null==(t=d.current)?void 0:t.instance)?void 0:r.getChart)?void 0:n.call(r,e)}}))),reactExports.useEffect((()=>{const e=d.current;return()=>{var t;try{null==(t=null==e?void 0:e.clearChart)||t.call(e)}catch(e3){}}}),[]);return jsxs(Fragment,{children:[jsx(Chart,{nativeHandleEnable:!0,options:r,width:e,height:t,onClick:i,vanchartRef:d,blockGestures:o,isClickAwayAllowed:a,toolTipClassName:"fvs-mobile-chart-tooltip"}),jsx(ChartTools,{sortMode:h,isZoomed:n,sortable:f,zoomable:null!=g&&g,onZoom:s,onSort:e=>{var t,r;p(TOOLS_SORT_MAP[e]),null==(r=null==(t=d.current)?void 0:t.triggerChartEvent)||r.call(t,"sort",{order:e})}})]})}));ChartComponent.displayName="ChartComponent";const MAP_TYPE=["AREA_MAP","POINT_MAP","LINE_MAP","CUSTOM_MAP","HEAT_MAP","DRILL_AREA_MAP","DRILL_POINT_MAP","DRILL_CUSTOM_MAP"],createVanChartWidget=(e,t)=>function(r){const n=reactExports.useRef(null),{config:o,theme:i,events:a}=r,s=reactExports.useRef(),l=reactExports.useRef([]),c=reactExports.useRef(null),{width:u,height:d}=useSize_1(n),h=chartHyperlinkFactory.create(e),p=useFVS(),f=!p.special.isZoomed&&MAP_TYPE.includes(e);useTempStorage({getChart:()=>{var e;return null==(e=c.current)?void 0:e.getChart(0)},openAutoTooltip:(e,t)=>{const r=waitForChartRender((()=>{var e;return null==(e=c.current)?void 0:e.getChart(0)}),(r=>{s.current=openAutoTooltip({instance:r,delay:e,initPoints:t})}));l.current.push(r)},stop:()=>{var e;return null==(e=s.current)?void 0:e.stop()},moveOn:()=>{var e;return null==(e=s.current)?void 0:e.moveOn()}}),useUnmount$2((()=>{s.current=void 0,l.current.forEach((e=>e())),l.current=[]}));const g=o.configFile?window.structuredClone({...o.configFile.chartAttr,mobile:!0,reportType:"flow",isMobileFlowFollowPC:!0,theme:i.scheme,hyperLink:a.onClick?{}:o.configFile.chartAttr.hyperLink,interactive:t}):null;return jsx("div",{className:"fvs-mobile-chart-widget",ref:n,children:u&&d&&jsx(ChartComponent,{ref:c,options:g,width:u,height:d,blockGestures:f,isClickAwayAllowed:e=>{var t;return!(null==e?void 0:e.target)||!p.special.root||(null==(t=p.special.root)?void 0:t.contains(e.target))},isZoomed:p.special.isZoomed,toggleZoom:()=>{var e,t;return null==(t=(e=p.special).toggleZoom)?void 0:t.call(e)},onClick:e=>{var t;const{name:r,fields:n}=h.generate(e.dataPoint);null==(t=a.onClick)||t.call(a,{target:r,params:n})}})})},createVanChartWidgetInPreview=e=>createVanChartWidget(e,!0),createVanChartWidgetInEdit=e=>createVanChartWidget(e,!1),FVSWidgetProvider=observer((({children:e,model:t})=>{const r=useFvsKit(t),n=reactExports.useMemo((()=>({get:e=>{const r=t.getTempState();if(isKeyInObject(e,r))return r[e]},set:(e,r)=>{var n;const o=null!=(n=t.getTempState())?n:{};t.setTempState({...o,[e]:r})}})),[t]);return jsx(FVSContext.Provider,{value:r,children:jsx(TempStorageContext.Provider,{value:n,children:e})})}));function isKeyInObject(e,t){return isObject$f(t)&&e in t}const ChartView=observer((({model:e})=>{const t={config:{configFile:e.chartOptions},events:{onClick:e.isHoverPointer?t=>{e.trigger(null==t?void 0:t.target,null==t?void 0:t.params)}:void 0},theme:e.theme},r=reactExports.useMemo((()=>e.isPreview?createVanChartWidgetInPreview(e.chartType):createVanChartWidgetInEdit(e.chartType)),[e.chartType,e.isPreview]);return jsx(FVSWidgetProvider,{model:e,children:jsx(r,{...t})})})),DEGRADE_TOOLBAR={REFRESH:"degrade-refresh",COMPLETE:"degrade-complete"};function useDegradeAble(e){var t,r;const n=useStore(),{enableDegradeRender:o}=n.storyRenderConfig,i=reactExports.useRef(!1),[a,s]=reactExports.useState(o&&null!=(r=null==(t=e.canDegradeWhenInit)?void 0:t.call(e))&&r),l=reactExports.useCallback((t=>{const{snapshot:r,resolve:o}=null!=t?t:{};n.storyRenderConfig.enableDegradeRender?e.degrade(r).then((()=>{null==o||o(),i.current||s(!0)})).catch((()=>{null==o||o()})):null==o||o()}),[e,n]),c=reactExports.useCallback((()=>{n.storyRenderConfig.enableDegradeRender&&s(!1)}),[n]);reactExports.useEffect((()=>(i.current=!1,()=>{i.current=!0})),[]),useUpdateEffect$2((()=>{c()}),[e.width,e.height,e.props,c]);const u=reactExports.useCallback((e=>{!e&&!a&&l()}),[a,l]),d=reactExports.useCallback((e=>{a?e():l({resolve:e})}),[a,l]);return reactExports.useEffect((()=>(null==e||e.addEventListener("save",d),()=>{null==e||e.removeEventListener("save",d)})),[d,e]),reactExports.useEffect((()=>(null==e||e.addEventListener("select",u),()=>{null==e||e.removeEventListener("select",u)})),[u,e]),reactExports.useEffect((()=>(e.addEventListener("enableDegrade",l),()=>{e.removeEventListener("enableDegrade",l)})),[e,l]),reactExports.useEffect((()=>(e.addEventListener("disableDegrade",c),()=>{e.removeEventListener("disableDegrade",c)})),[e,c]),reactExports.useEffect((()=>{if(e.hideDegradeToolbar||!o)return e.removeToolbar(DEGRADE_TOOLBAR.COMPLETE),void e.removeToolbar(DEGRADE_TOOLBAR.REFRESH);a?(e.setToolbar({icon:"icon-whirl",label:duchampIntl.get("Duchamp-Refresh"),value:DEGRADE_TOOLBAR.REFRESH,onClick:()=>{c()}}),e.removeToolbar(DEGRADE_TOOLBAR.COMPLETE)):(e.setToolbar({icon:"icon-check",label:duchampIntl.get("Duchamp-Finish"),value:DEGRADE_TOOLBAR.COMPLETE,onClick:()=>{l()}}),e.removeToolbar(DEGRADE_TOOLBAR.REFRESH))}),[l,c,a,o,e]),useUpdateEffect$2((()=>{e.isFloatTop||(o?l():s(!1))}),[o,l]),a}function useHostDegradeAble(e){const[t,r]=reactExports.useState(!0);return reactExports.useEffect((()=>{const t=()=>r(!0),n=()=>r(!1);return e.addEventListener("enableHostDegrade",t),e.addEventListener("disableHostDegrade",n),()=>{e.removeEventListener("enableHostDegrade",t),e.removeEventListener("disableHostDegrade",n)}}),[e]),t}const DegradeAbleContainer=observer((({model:e,children:t})=>{if(useDegradeAble(e)){const t=e.degradeRender();return jsx(t,{})}return jsx(Fragment,{children:t})})),HostDegradeAbleContainer=observer((({model:e,children:t})=>{var r,n;const o=useStore(),i=useHostDegradeAble(e);if(o.storyRenderConfig.enableDegradeRender&&!e.isHostFloatTop&&null!=(n=null==(r=e.canHostDegrade)?void 0:r.call(e))&&n&&i){const t=e.hostDegradeRender();return jsx(t,{})}return jsx(Fragment,{children:t})})),renderReactView=e=>function(t){const{widget:r}=t;return jsx(e,{model:r.getInstance()})},registerDuchampWidgetView=(e,t,r,n,o={})=>{const{isPanel:i,configView:a}=o;a&&(i?e.configure={...e.configure,configPanel:a}:e.configuration=renderReactView(a)),registerWidget({options:{...merge$1(e,settingCenter.getComponentConfigMeta(e.type)),model:t},view:r,mobileView:n})},WidgetViewContent=observer((e=>{const{widget:t,view:r,adaptiveScale:n,width:o,height:i,expandIndex:a}=e,s=t.getInstance(),l=jsx(r,{adaptiveScale:n,model:s,width:o,height:i,expandIndex:a});return s.isPreview||!isInstanceofDegradeable(s)||s.isInHost?!s.isPreview&&isInstanceofHostDegradeable(s)&&s.isInHost?jsx(HostDegradeAbleContainer,{model:s,children:l}):l:jsx(DegradeAbleContainer,{model:s,children:l})}));function renderWidgetView(e){return function(t){return jsx(WidgetViewContent,{...t,view:e})}}function registerWidget({options:e,view:t,mobileView:r,configView:n}){var o;const i=settingCenter.getWidgetResultOptions(e),a=null!=(o=i.mainGroupName)?o:i.widgetType;widgetManager.register({...i,mainGroupName:a,component:t?renderWidgetView(t):void 0,mobileConfig:r?{...i.mobileConfig,component:renderWidgetView(r)}:void 0,configuration:n?renderReactView(n):i.configuration})}function registerChart({type:e,meta:t,view:r=ChartView$1,mobileView:n,configView:o=ChartConfig}){const i=otherService.isInFR(),a=getChartMeta(e);registerWidget({options:{...merge$1(a,settingCenter.getComponentConfigMeta(a.type)),configuration:i?void 0:[{name:"devProp",displayName:"json file name",type:"textArea",value:e},{name:"devPropData",displayName:"props",type:"textArea",value:""}],...t,async initialization(e){const{widget:t,parent:r,...n}=e,o={widgetId:t.id,widgetType:t.type,payload:{snapshot:JSON.stringify(getSnapshot(t)),storyIndex:t.storyIndex}};let i=!0;if("create"===e.type){const{resourceCenter:e}=t.store,r=uuid$1();t.model.setProps({configFile:r});const n=(await otherService.createWidget({...o,mainResourceId:r})).map((e=>({...e,payload:{isPrivate:"true",...e.payload}})));e.addResourceInfo(n),n.length>0?o.payload.snapshot=JSON.stringify(getSnapshot(t)):i=!1}return i&&(i=await otherService.initWidget({...o,...n,payload:{...o.payload,...t.getInstance().fieldPayload}})),i}},view:r,mobileView:n,configView:i?o:void 0})}function createBaseChartEventTargets(e){const t=[{trigger:WIDGET_EVENT.CLICK,text:WIDGET_EVENT_MAP.CLICK,actions:defaultActions}];return isArray$c(e)?e.map((e=>({...e,events:t}))):{...e,events:t}}function registerVanChart(e,t,r,n="interactiveChart"){registerChart({type:e,meta:{displayName:t,groupName:r,functionPoint:n,model:ChartModel,configure:{mobile:{fluidHeightGrid:FLUID_BLOCK_PARTS},eventTargets:createBaseChartEventTargets(chartTriggersGeneratorFactory.create(e).generate())}},view:ChartView$1,mobileView:ChartView})}var __defProp$P=Object.defineProperty,__getOwnPropDesc$L=Object.getOwnPropertyDescriptor,__decorateClass$O=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$L(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$P(t,r,i),i};function getCustomTargets(e){return e?e.map(((e,t)=>({text:widgetManager.getWidgetByName("d-chart-".concat(e)).displayName,value:e,triggerValue:t,fields:LINK_PARAS[e].map((e=>({text:e.text,value:e.key})))}))):[{text:duchampIntl.get("Duchamp-Column_Chart"),value:"COLUMN",triggerValue:0,fields:LINK_PARAS.COLUMN.map((e=>({text:e.text,value:e.key})))},{text:duchampIntl.get("Duchamp-Line_Chart"),value:"LINE",triggerValue:1,fields:LINK_PARAS.LINE.map((e=>({text:e.text,value:e.key})))}]}class CustomModel extends ChartModel{constructor(){super(...arguments),__publicField(this,"targets",[])}async onInit(){this.setTargets(getCustomTargets(this.props.charts))}setTargets(e){this.targets=e}get eventTargets(){return createBaseChartEventTargets(this.targets)}setCharts(e){this.widget.setValueWidthOutUndo({charts:e}),this.setTargets(getCustomTargets(e))}trigger(e="",t){var r;const n=(null==(r=this.targets.find((t=>t.triggerValue===e)))?void 0:r.value)||e;this.widget.trigger({target:n,fields:t})}}function registerCustom(){registerChart({type:"CUSTOM",meta:{displayName:duchampIntl.get("Duchamp-Custom_Combo_Chart"),groupName:duchampIntl.get("Duchamp-Combination_Diagram_Class"),model:CustomModel,configure:{eventTargets:e=>createBaseChartEventTargets(getCustomTargets(e.charts))}},view:ChartView$1})}__decorateClass$O([observable],CustomModel.prototype,"targets",2),__decorateClass$O([action$1],CustomModel.prototype,"setTargets",1),__decorateClass$O([override],CustomModel.prototype,"eventTargets",1);const ExtendedChartView=reactExports.forwardRef(((e,t)=>jsx("div",{style:{width:"100%",height:"100%"},ref:t})));ExtendedChartView.displayName="ExtendedChartView";const ArcColumnView=observer((({model:e,width:t,height:r})=>{const{computed:n,state:o}=useChartConfig({chartOptions:e.chartOptions,width:t,height:r}),i=useClassWidget({widgetClass:ArcColumnWidget,model:e,computed:n,state:o});return jsx(ExtendedChartView,{ref:i})})),defaultInteractionConfig={carousel:{interval:0}};function getInteractionConfig(e){var t,r,n;return{carousel:configKit$1.carousel.transform({interval:null!=(r=null==(t=e.widget.carousel)?void 0:t.autoplaySpeed)?r:0,type:null==(n=e.widget.carousel)?void 0:n.type})}}const CarouselBarView=observer((({model:e,width:t,height:r})=>{const{computed:n,state:o}=useChartConfig({chartOptions:e.chartOptions,width:t,height:r}),i=useClassWidget({widgetClass:CarouselBarWidget,model:e,computed:n,state:o,interaction:getInteractionConfig(e)});return jsx(ExtendedChartView,{ref:i})})),CarouselGaugeView=observer((({model:e,width:t,height:r})=>{const{computed:n,state:o}=useChartConfig({chartOptions:e.chartOptions,width:t,height:r}),i=useClassWidget({widgetClass:CarouselGaugeWidget,model:e,computed:n,state:o,runtime:{events:{onCarousel:t=>{e.widget.trigger({trigger:WIDGET_EVENT.CAROUSEL,fields:null==t?void 0:t.params})}}},interaction:getInteractionConfig(e)});return jsx(ExtendedChartView,{ref:i})})),CarouselPieView=observer((({model:e,width:t,height:r})=>{const{computed:n,state:o}=useChartConfig({chartOptions:e.chartOptions,width:t,height:r}),i=useClassWidget({widgetClass:CarouselPieWidget,model:e,computed:n,state:o,runtime:{events:{onCarousel:t=>{e.widget.trigger({trigger:WIDGET_EVENT.CAROUSEL,fields:null==t?void 0:t.params})}}},interaction:getInteractionConfig(e)});return jsx(ExtendedChartView,{ref:i})})),FluidView=observer((({model:e,width:t,height:r})=>{var n,o;const{computed:i,state:a}=useChartConfig({chartOptions:e.chartOptions,width:t,height:r}),s=useClassWidget({widgetClass:FluidWidget,model:e,computed:i,state:a,runtime:{events:{onCarousel:t=>{e.widget.trigger({trigger:WIDGET_EVENT.CAROUSEL,fields:null==t?void 0:t.params})}}},interaction:{carousel:configKit$1.carousel.transform({interval:null!=(o=null==(n=e.widget.carousel)?void 0:n.autoplaySpeed)?o:0})}});return jsx(ExtendedChartView,{ref:s})})),KpiView=observer((({model:e,width:t,height:r})=>{const{computed:n,state:o}=useChartConfig({chartOptions:e.chartOptions,width:t,height:r}),i=useClassWidget({widgetClass:KpiWidget,model:e,computed:n,state:o,interaction:getInteractionConfig(e),runtime:{events:{onCarousel:t=>{e.widget.trigger({trigger:WIDGET_EVENT.CAROUSEL,fields:null==t?void 0:t.params})}}}});return jsx(ExtendedChartView,{ref:i})}));var __defProp$O=Object.defineProperty,__getOwnPropDesc$K=Object.getOwnPropertyDescriptor,__decorateClass$N=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$K(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$O(t,r,i),i};class ExtendedChartModel extends BaseWidgetModel{constructor(){super(...arguments),__publicField(this,"cacheable",!1),__publicField(this,"chartInstance"),__publicField(this,"chartOptions"),__publicField(this,"stopOnHover",!0)}setTempState(e){super.setTempState(e),this.chartInstance=e}setChartOptions(e){this.chartOptions=e}get chartType(){return this.widget.type.replace("d-chart-","")}get chartFileName(){var e;return(null==(e=this.store.resourceCenter.getInfoByID(this.props.configFile))?void 0:e.name)||""}get fieldConfigs(){return configKit$1.configFile.getComputeConfig({config:this.widget.id,options:{type:"chart",payload:{chartType:this.chartType}}})}async setFieldValues(e,t){super.setFieldValues(e,t);let r=await preprocessOptions(configKit$1.configFile.transform({config:this.id,compute:{computedResult:e,index:0},options:{type:"chart",payload:{chartType:this.chartType}}}));"refresh"===t.type&&(r=mergeChartOptions(r,isRefreshedByObserve(t.extPayload)?{refreshType:"tip_increment"}:{})),this.setChartOptions(r)}setStopOnHover(e){this.stopOnHover=e}openHoverPauseRollPlay(){this.setStopOnHover(!0)}closeHoverPauseRollPlay(){this.setStopOnHover(!1)}pauseRollPlay(){var e,t;null==(t=null==(e=this.chartInstance)?void 0:e.pauseRollPlay)||t.call(e)}continueRollPlay(){var e,t;null==(t=null==(e=this.chartInstance)?void 0:e.continueRollPlay)||t.call(e)}collectResourceIDs(){const e=super.collectResourceIDs(),{configFile:t}=this.widget.props;return t&&e.push(t),e}updateResourceIDs(e){const{configFile:t}=this.props,r=e.get(t);r&&this.setProps({...this.props,configFile:r})}getSpecialPayload(){return{widgetFilePath:this.chartFileName}}loadedEmit(){this.emitCurrentLoaded()}loadFinished(){this.emitCurrentLoaded()}}__decorateClass$N([observable.ref],ExtendedChartModel.prototype,"chartOptions",2),__decorateClass$N([action$1],ExtendedChartModel.prototype,"setChartOptions",1),__decorateClass$N([observable],ExtendedChartModel.prototype,"stopOnHover",2),__decorateClass$N([action$1],ExtendedChartModel.prototype,"setStopOnHover",1),__decorateClass$N([jsApi()],ExtendedChartModel.prototype,"openHoverPauseRollPlay",1),__decorateClass$N([jsApi()],ExtendedChartModel.prototype,"closeHoverPauseRollPlay",1);const PixelGridView=observer((({model:e,width:t,height:r})=>{const{computed:n,state:o}=useChartConfig({chartOptions:e.chartOptions,width:t,height:r}),i=useClassWidget({widgetClass:PixelGridWidget,model:e,computed:n,state:o,interaction:getInteractionConfig(e),runtime:{events:{onCarousel:t=>{e.widget.trigger({trigger:WIDGET_EVENT.CAROUSEL,fields:null==t?void 0:t.params})}}}});return jsx(ExtendedChartView,{ref:i})}));var __defProp$N=Object.defineProperty,__getOwnPropDesc$J=Object.getOwnPropertyDescriptor,__decorateClass$M=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$J(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$N(t,r,i),i};class ShapeColumnModel extends ExtendedChartModel{constructor(){super(...arguments),__publicField(this,"shapeColumnInstance")}trigger(e="",t){this.widget.trigger({target:e,fields:t})}setTempState(e){super.setTempState(e),this.shapeColumnInstance=e}openAutoTooltip(e,t){return new Promise(((e,t)=>{if(this.shapeColumnInstance)e(this.shapeColumnInstance);else{const r=reaction((()=>this.shapeColumnInstance),(n=>{n?e(n):t(),r()}))}})).then((r=>{r.openAutoTooltip(e,t)}))}stopAutoTooltip(){var e;null==(e=this.shapeColumnInstance)||e.stop()}moveOnAutoTooltip(){var e;null==(e=this.shapeColumnInstance)||e.moveOn()}}__decorateClass$M([observable.ref],ShapeColumnModel.prototype,"shapeColumnInstance",2),__decorateClass$M([jsApi()],ShapeColumnModel.prototype,"openAutoTooltip",1),__decorateClass$M([jsApi()],ShapeColumnModel.prototype,"stopAutoTooltip",1),__decorateClass$M([jsApi()],ShapeColumnModel.prototype,"moveOnAutoTooltip",1);const ShapeColumnView=observer((({model:e,width:t,height:r})=>{const{computed:n,state:o}=useChartConfig({chartOptions:e.chartOptions,width:t,height:r}),i=useClassWidget({widgetClass:ShapeColumnWidget,model:e,computed:n,state:o,runtime:{events:{onClick:e.isHoverPointer?t=>{e.trigger(null==t?void 0:t.target,null==t?void 0:t.params)}:void 0},transition:e.getWidgetTransitionInfo()}});return jsx(ExtendedChartView,{ref:i})})),TimeGearView=observer((({model:e,width:t,height:r})=>{const{computed:n,state:o}=useChartConfig({chartOptions:e.chartOptions,width:t,height:r}),i=useClassWidget({widgetClass:TimeGearWidget,model:e,computed:n,state:o});return jsx(ExtendedChartView,{ref:i})})),WisdomTreeView=observer((({model:e,width:t,height:r})=>{const{computed:n,state:o}=useChartConfig({chartOptions:e.chartOptions,width:t,height:r}),i=useClassWidget({widgetClass:WisdomTreeWidget,model:e,computed:n,state:o,interaction:getInteractionConfig(e),runtime:{events:{onCarousel:t=>{e.widget.trigger({trigger:WIDGET_EVENT.CAROUSEL,fields:null==t?void 0:t.params})},onClick:t=>{e.widget.trigger({fields:null==t?void 0:t.params})}}}});return jsx(ExtendedChartView,{ref:i})}));function registerExtendedChart(e,t,r){registerChart({type:e,meta:{functionPoint:"extendedChart",platforms:["pc"],...t},view:r})}function registerArcColumn(){registerExtendedChart("ARC_COLUMN",{displayName:duchampIntl.get("Duchamp-Arc_Column_Chart"),groupName:duchampIntl.get("Duchamp-Column_Chart_Class"),refresh:{interval:60},dependencies:["?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/arccolumn.min.js","?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/arccolumnWrapper.js"],model:ExtendedChartModel},ArcColumnView)}function registerShapeColumn(){const e="SHAPE_COLUMN";registerExtendedChart(e,{displayName:duchampIntl.get("Duchamp-Special_Shape_Column_Chart"),groupName:duchampIntl.get("Duchamp-Column_Chart_Class"),dependencies:["?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/ShapeColumnBridge.js","?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/van-maxcharts.js"],model:ShapeColumnModel,configure:{eventTargets:{fields:generateTrigger$1("","",e).fields,events:[{trigger:WIDGET_EVENT.CLICK,text:WIDGET_EVENT_MAP.CLICK,actions:defaultActions}]}}},ShapeColumnView)}function registerCarouselPie(){const e="CAROUSEL_PIE";registerExtendedChart(e,{displayName:duchampIntl.get("Duchamp-Carousel_Pie_Chart"),groupName:duchampIntl.get("Duchamp-Pie_Chart_Category"),carousel:{defaultAutoPlay:!0,autoplaySpeed:6e3},refresh:{interval:60},dependencies:["?op=resource&resource=com/fr/plugin/wysiwyg/chart/css/carouselpie.min.css","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/carouselpie.min.js","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/component-title.min.js","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/component-legend.min.js","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/component-background.min.js","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/carouselPieWrapper.js"],model:ExtendedChartModel,configure:{eventTargets:{fields:generateTrigger$1("","",e).fields,events:[{trigger:WIDGET_EVENT.CAROUSEL,text:WIDGET_EVENT_MAP.CAROUSEL,actions:carouselActions}]}}},CarouselPieView)}function registerCarouselBar(){registerExtendedChart("CAROUSEL_BAR",{displayName:duchampIntl.get("Duchamp-Carousel_Bar_Chart"),groupName:duchampIntl.get("Duchamp-Bar_Graph_Category"),refresh:{interval:60},carousel:{defaultAutoPlay:!0,autoplaySpeed:6e3,type:"single"},dependencies:["?op=resource&resource=com/fr/plugin/wysiwyg/chart/css/carouselbar.min.css","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/carouselbar.min.js","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/component-title.min.js","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/carouselBarWrapper.js"],model:ExtendedChartModel},CarouselBarView)}function registerCarouselGauge(){const e="CAROUSEL_GAUGE";registerExtendedChart(e,{displayName:duchampIntl.get("Duchamp-Carousel_Luminous_Dashboard"),groupName:duchampIntl.get("Duchamp-Dashboard"),refresh:{interval:60},carousel:{defaultAutoPlay:!0,autoplaySpeed:6e3},dependencies:["?op=resource&resource=com/fr/plugin/wysiwyg/chart/css/sliderdashboard.min.css","?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/meterWrapper.js","?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/sliderdashboard.min.js"],model:ExtendedChartModel,configure:{eventTargets:{fields:generateTrigger$1("","",e).fields,events:[{trigger:WIDGET_EVENT.CAROUSEL,text:WIDGET_EVENT_MAP.CAROUSEL,actions:carouselActions}]}}},CarouselGaugeView)}function registerFluid(){const e="FLUID";registerExtendedChart(e,{displayName:duchampIntl.get("Duchamp-Water_Polo_Diagram"),groupName:duchampIntl.get("Duchamp-Dashboard"),refresh:{interval:60},carousel:{defaultAutoPlay:!0,autoplaySpeed:6e3},dependencies:["?op=resource&resource=com/fr/plugin/wysiwyg/chart/css/waterflow.css","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/waterflow.min.js","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/waterflowWrapper.js"],model:ExtendedChartModel,configure:{eventTargets:{fields:generateTrigger$1("","",e).fields,events:[{trigger:WIDGET_EVENT.CAROUSEL,text:WIDGET_EVENT_MAP.CAROUSEL,actions:carouselActions}]}}},FluidView)}function registerKPI(e,t){registerExtendedChart(e,{displayName:t,groupName:duchampIntl.get("Duchamp-Indicator_Card_Category"),carousel:{defaultAutoPlay:!0,autoplaySpeed:6e3},refresh:{interval:60},dependencies:["?op=resource&resource=com/fr/plugin/wysiwyg/chart/css/vanKPI.css","?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/kpi.min.js","?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/kpiWrapper.js"],model:ExtendedChartModel,configure:{eventTargets:{fields:generateTrigger$1("","",e).fields,events:[{trigger:WIDGET_EVENT.CAROUSEL,text:WIDGET_EVENT_MAP.CAROUSEL,actions:carouselActions}]}}},KpiView)}function registerPixelGrid(){const e="PIXEL_GRID";registerExtendedChart(e,{displayName:duchampIntl.get("Duchamp-Pixel_Map"),groupName:duchampIntl.get("Duchamp-Dashboard"),refresh:{interval:60},carousel:{defaultAutoPlay:!0,autoplaySpeed:6e3},dependencies:["?op=resource&resource=com/fr/plugin/wysiwyg/chart/css/pixelgrid.min.css","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/component-title.min.js","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/pixelgrid.min.js","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/PixelGridBridge.js"],model:ExtendedChartModel,configure:{eventTargets:{fields:generateTrigger$1("","",e).fields,events:[{trigger:WIDGET_EVENT.CAROUSEL,text:WIDGET_EVENT_MAP.CAROUSEL,actions:carouselActions}]}}},PixelGridView)}function registerTimeGear(){registerExtendedChart("TIME_GEAR",{displayName:duchampIntl.get("Duchamp-Time_Gear_Diagram"),groupName:duchampIntl.get("Duchamp-Time_Class"),refresh:!1,dependencies:["?op=resource&resource=/com/fr/plugin/wysiwyg/chart/css/vantimegear.css","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/vantimegear.js","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/timegearWrapper.js"],model:ExtendedChartModel},TimeGearView)}function registerWisdomTree(e,t){registerExtendedChart(e,{displayName:t,groupName:duchampIntl.get("Duchamp-Tree"),carousel:{defaultAutoPlay:!0,autoplaySpeed:6e3},refresh:{interval:60},dependencies:["?op=resource&resource=com/fr/plugin/wysiwyg/chart/css/wisdomtree.min.css","?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/utils.js","?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/wisdomTreeWrapper.js","?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/wisdomtree.min.js"],model:ExtendedChartModel,configure:{eventTargets:{fields:generateTrigger$1("","",e).fields,events:[{trigger:WIDGET_EVENT.CLICK,text:WIDGET_EVENT_MAP.CLICK,actions:defaultActions},{trigger:WIDGET_EVENT.CAROUSEL,text:WIDGET_EVENT_MAP.CAROUSEL,actions:carouselActions}]}}},WisdomTreeView)}function registerHeavyChart(e,t,r,n){registerChart({type:e,meta:{configuration:otherService.isInFR()?void 0:[{name:"devProp",displayName:"json file name",type:"textArea",value:"BAR_3D_ON_GLOBE"}],functionPoint:"extendedChart",platforms:["pc"],...t},view:r,configView:n})}function getImageDom(e){return new Promise((t=>{const r=new Image;r.src=e,r.onload=()=>{t(r)},r.onerror=()=>{t(void 0)}}))}async function mergeCollection(e,t){const r=e.querySelectorAll("canvas"),n=e.querySelectorAll("svg"),o=Array.from(r).map((e=>e.toDataURL("image/png"))).concat(t?Array.from(n).map((e=>{const t=e.outerHTML;return"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(t.replace("<svg",-1!==t.indexOf("xmlns")?"<svg":'<svg xmlns="http://www.w3.org/2000/svg"')))})):[]);if(!o.length)return;const i=r[0],a=i?i.width:e.clientWidth,s=i?i.height:e.clientHeight,l=document.createElement("canvas");l.width=a,l.height=s,l.style.width=i?i.style.width:"".concat(a,"px"),l.style.height=i?i.style.height:"".concat(s,"px");const c=l.getContext("2d");for(const u of o){const e=await getImageDom(u);e&&(null==c||c.drawImage(e,0,0,a,s))}return l}async function createCanvasByImage({src:e,width:t,height:r}){const n=document.createElement("canvas");n.width=t,n.height=r;const o=n.getContext("2d"),i=await getImageDom(e);return i&&(null==o||o.drawImage(i,0,0,t,r)),n}async function createSnapshot(e,t,r,n,o=!0){const i=await(e instanceof HTMLElement?mergeCollection(e,o):createCanvasByImage(e));return i?(n&&r.delete(n),["".concat(i.toDataURL("image/png")),new Promise(((e,n)=>{requestAnimationFrame((()=>{i.toBlob((async o=>{if(o){const i=await r.upload({contents:[{content:new File([o],"".concat(t,".png"),{type:"image/png"}),tags:["widget_cover"],payload:{isPrivate:!0}}],extraPayloads:{fileName:t}});i.length>0?e(i[0]):n()}}))}))}))]):Promise.reject()}function renderSnapshot(e,t){return function(){return jsx(SnapshotImage,{src:e,onError:t})}}function SnapshotImage({src:e,onError:t}){const{value:r}=useAsync((()=>new Promise((t=>{if(!e)return void t("");const r=new Image;r.onload=()=>{t(e)},r.onerror=()=>{t("")},r.src=e})).then((e=>(e||null==t||t(),e)))));return r?jsx("div",{draggable:!1,style:{width:"100%",height:"100%",backgroundImage:"url(".concat(e,")"),backgroundSize:"contain",backgroundPosition:"center center",backgroundRepeat:"no-repeat"}}):null}class HeavyChartModel extends ExtendedChartModel{constructor(){super(...arguments),__publicField(this,"ref",reactExports.createRef()),__publicField(this,"snapshotImage",""),__publicField(this,"hideDegradeToolbar",!1)}get instanceSymbol(){var e;return(null==(e=this.widget.story)?void 0:e.$modelType)+this.widget.type+this.widget.name}get clearWhenIdle(){return!0}get el(){return this.ref.current}get imageSource(){const e=getResourceInfoByID(this.widget.extras.degradeSource,this.store.resourceCenter);return e?e.name:""}degradeRender(){return renderSnapshot(this.snapshotImage||createResourceURL(this.imageSource,this.duchampServer.resourceBaseUrl),(()=>this.fireEvent("disableDegrade")))}collectResourceIDs(){const e=super.collectResourceIDs(),{degradeSource:t}=this.widget.extras;return t&&e.push(t),e}updateResourceIDs(e){super.updateResourceIDs(e);const{degradeSource:t}=this.widget.extras,r=e.get(t);r&&this.widget.setExtrasValue({degradeSource:r})}isEmptyData(e){return!1}async degrade(e=!0){var t,r;return this.el?createSnapshot(this.isEmptyData(null==(t=this.chartOptions)?void 0:t.chartAttr)&&(null==(r=this.chartOptions)?void 0:r.chartAttr.emptyDataTip)?this.chartOptions.chartAttr.emptyDataTip.emptyDataImage:this.el,this.widget.id,this.store.resourceCenter,this.widget.extras.degradeSource,e).then((async e=>{const[t,r]=e;this.snapshotImage=t;const n=await r;this.widget.setExtrasValue({degradeSource:n.id})})):Promise.reject()}canDegradeWhenInit(){return!!this.imageSource}}var __defProp$M=Object.defineProperty,__getOwnPropDesc$I=Object.getOwnPropertyDescriptor,__decorateClass$L=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$I(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$M(t,r,i),i};class GeoLandWidgetModel extends HeavyChartModel{constructor(){super(...arguments),__publicField(this,"loadProgress",0),__publicField(this,"geoLandChart",null),__publicField(this,"hideDegradeToolbar",!0)}get instanceSymbol(){var e;return(null==(e=this.widget.story)?void 0:e.$modelType)+this.widget.type}get clearWhenIdle(){return!1}setLoadProgress(e){0===e&&this.setLoading(!0),1===e&&this.setLoading(!1),this.loadProgress=100*e}setLoading(e){this.widget.setLoading(e)}get floatEditToolbar(){const{parentWidget:e}=this.widget;return{label:duchampIntl.get("Duchamp-Angle_Adjustment"),icon:"icon-view",hide:!isNil$3(e)&&isStructureWidget(e)}}setTempState(e){super.setTempState(e),this.geoLandChart=e}onFloatEditEnd(){var e,t;null==(t=null==(e=this.geoLandChart)?void 0:e.getCameraState())||t.then((e=>{this.store.crudService.updateGeoLandCameraState(this.chartFileName,JSON.stringify(e.position),JSON.stringify(e.rotation))}))}openEditor(){this.store.crudService.openGeoLandEdit(this.chartFileName),this.store.setModified(!0)}loadFinished(){this.emitCurrentLoaded(),this.setLoading(!1),this.isPreview||this.isFloatTop||this.fireEvent("enableDegrade")}async degrade(){return super.degrade().then((()=>{var e,t;null==(t=null==(e=this.geoLandChart)?void 0:e.clear)||t.call(e)}))}}__decorateClass$L([observable],GeoLandWidgetModel.prototype,"loadProgress",2),__decorateClass$L([action$1],GeoLandWidgetModel.prototype,"setLoadProgress",1),__decorateClass$L([computed],GeoLandWidgetModel.prototype,"floatEditToolbar",1);const HeavyChartView=reactExports.forwardRef(((e,t)=>{const{model:r,width:n,height:o}=e,i=useMergedRefs(t,r.ref);return jsx("div",{style:{width:n,height:o,pointerEvents:r.isPreview||r.isFloatTop?"auto":"none"},ref:i})}));HeavyChartView.displayName="HeavyChartView";const GeolandView=observer((({model:e,width:t,height:r})=>{var n;const o=reactExports.useMemo((()=>{if(e.chartOptions)return{...e.chartOptions,chartAttr:{...e.chartOptions.chartAttr,baseUrl:otherService.isInFR()?void 0:"http://localhost:3000/third/u3d/Build.json"}}}),[e.chartOptions]),{state:i,computed:a}=useChartConfig({chartOptions:o,width:t,height:r}),s=useClassWidget({widgetClass:GeoLandWidget,model:e,computed:a,state:i,instanceSymbol:e.instanceSymbol,clearWhenIdle:e.clearWhenIdle,interaction:(null==(n=e.widget.carousel)?void 0:n.autoplay)?getInteractionConfig(e):defaultInteractionConfig,runtime:{events:{onCarousel:t=>{e.widget.story===e.store.story&&e.widget.trigger({trigger:WIDGET_EVENT.CAROUSEL,fields:null==t?void 0:t.params})},onClick:t=>{e.widget.trigger({target:null==t?void 0:t.target,fields:null==t?void 0:t.params})},onDrillUp:t=>{e.widget.trigger({target:"drillLink",fields:null==t?void 0:t.params})}}}});return jsx(HeavyChartView,{ref:s,model:e,width:i.width,height:i.height})})),ClickEditConfig=({onClick:e,disable:t=!1})=>jsx("div",{style:{paddingTop:18},children:t?jsx(Empty$1,{image:"/assets/system/widget_disable_edit.svg",description:duchampIntl.get("Duchamp-Widget_Disable_Edit_Tip")}):jsxs(Fragment,{children:[jsx(Empty$1,{image:"/assets/system/widget_click_tip.svg",description:duchampIntl.get("Duchamp-Please_Click_Edit_Component_To_Set")}),jsx("div",{className:"duchamp-edit-button",children:jsx(Button$4,{type:"primary",onClick:e,children:duchampIntl.get("Duchamp-Edit_Component")})})]})}),OutSideEditConfig=({model:e})=>jsx("div",{"data-focus-point":getOpenEditorFocusPointId(e.type),children:jsx(ClickEditConfig,{onClick:()=>{e.openEditor()},disable:e.disableEdit})});function registerGeoLand(){const e=[{text:duchampIntl.get("Duchamp-All"),value:"",fields:LINK_PARAS.GEO_LANDdrillLink.map((e=>({text:e.text,value:e.key}))),events:[{trigger:WIDGET_EVENT.CAROUSEL,text:WIDGET_EVENT_MAP.CAROUSEL,actions:carouselActions}]}];registerHeavyChart("GEO_LAND",{groupName:duchampIntl.get("Duchamp-Map_Class"),displayName:duchampIntl.get("Duchamp-Scene_Map"),props:{imageSource:""},carousel:{autoplay:!1,autoplaySpeed:6e3,min:4e3},refresh:{interval:60},states:{width:800,height:500},configuration:void 0,configure:{countLimit:1,eventTargets:e.concat([{text:duchampIntl.get("Duchamp-Point"),value:"point",fields:LINK_PARAS.GEO_LANDpoint.map((e=>({text:e.text,value:e.key})))},{text:duchampIntl.get("Duchamp-Line"),value:"line",fields:LINK_PARAS.GEO_LANDline.map((e=>({text:e.text,value:e.key})))},{text:duchampIntl.get("Duchamp-Pillar"),value:"cylinder",fields:LINK_PARAS.GEO_LANDcylinder.map((e=>({text:e.text,value:e.key})))},{text:duchampIntl.get("Duchamp-Area"),value:"area",fields:LINK_PARAS.GEO_LANDarea.map((e=>({text:e.text,value:e.key})))},{text:duchampIntl.get("Duchamp-Drill_Directory"),value:"drillLink",fields:LINK_PARAS.GEO_LANDdrillLink.map((e=>({text:e.text,value:e.key})))}].map((e=>({...e,events:[{trigger:WIDGET_EVENT.CLICK,text:WIDGET_EVENT_MAP.CLICK,actions:defaultActions}]}))))},dependencies:["?op=resource&resource=com/fr/plugin/wysiwyg/chart/css/switch.min.css","?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/utils.js","?op=resource&resource=com/fr/plugin/wysiwyg/chart/u3d/UnityLoader.js","?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/EventDispatcherBridge.js","?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/UGeoLandBridge.js","?op=resource&resource=com/fr/plugin/wysiwyg/chart/u3d/geolandwidget.js","?op=resource&resource=com/fr/plugin/wysiwyg/chart/u3d/geo-land.min.js","?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/drill.min.js","?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/switch.min.js","?op=resource&resource=com/fr/plugin/wysiwyg/chart/u3d/modules.js","?op=resource&resource=com/fr/plugin/wysiwyg/chart/u3d/mapshaper.js","?op=resource&resource=com/fr/plugin/wysiwyg/chart/u3d/geoland-formatter.js"],model:GeoLandWidgetModel,scale:!1},GeolandView,OutSideEditConfig)}class GlobeChartWidgetModel extends HeavyChartModel{isEmptyData(e){var t,r;return 0===(null==(r=null==(t=null==e?void 0:e.series)?void 0:t.data)?void 0:r.length)}}const GlobeWidget={BAR_3D_ON_GLOBE:BarGlobeWidget,SCATTER_3D_ON_GLOBE:ScatterGlobeWidget,LINES_3D_ON_GLOBE:LinesGlobeWidget};function createGlobeWidget(e){return observer((({model:t,width:r,height:n})=>{const{computed:o,state:i}=useChartConfig({chartOptions:t.chartOptions,width:r,height:n}),a=useClassWidget({widgetClass:GlobeWidget[e],model:t,computed:o,state:i,instanceSymbol:t.instanceSymbol,clearWhenIdle:t.clearWhenIdle,runtime:GlobeWidget[e]===ScatterGlobeWidget||GlobeWidget[e]===BarGlobeWidget?{events:{onClick:e=>{t.widget.trigger({fields:null==e?void 0:e.params})}}}:void 0});return jsx(HeavyChartView,{ref:a,model:t,width:i.width,height:i.height})}))}const BarGlobeView=createGlobeWidget("BAR_3D_ON_GLOBE"),ScatterGlobeView=createGlobeWidget("SCATTER_3D_ON_GLOBE"),LinesGlobeView=createGlobeWidget("LINES_3D_ON_GLOBE"),options={refresh:{interval:60},props:{},states:{width:400,height:260},version:"0.1",dependencies:["?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/echartsWrapper.js","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/echarts.js","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/echarts-gl.js","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/world.js"]};function registerGlobe(){const e=e=>({fields:generateTrigger$1("","",e).fields,events:[{trigger:WIDGET_EVENT.CLICK,text:WIDGET_EVENT_MAP.CLICK,actions:defaultActions}]}),t="BAR_3D_ON_GLOBE";registerHeavyChart(t,{...options,displayName:duchampIntl.get("Duchamp-Three-Dimensional_Cylindrical_Earth"),groupName:duchampIntl.get("Duchamp-Earth_Class"),model:GlobeChartWidgetModel,configure:{eventTargets:e(t)},scale:!1},BarGlobeView);const r="SCATTER_3D_ON_GLOBE";registerHeavyChart(r,{...options,displayName:duchampIntl.get("Duchamp-Three-Dimensional_Point_Earth"),groupName:duchampIntl.get("Duchamp-Earth_Class"),model:GlobeChartWidgetModel,configure:{eventTargets:e(r)},scale:!1},ScatterGlobeView),registerHeavyChart("LINES_3D_ON_GLOBE",{...options,displayName:duchampIntl.get("Duchamp-Three-Dimensional_Flow_To_The_Earth"),groupName:duchampIntl.get("Duchamp-Earth_Class"),model:GlobeChartWidgetModel,configure:{eventTargets:null},scale:!1},LinesGlobeView)}class CarouselCatalogChartWidgetModel extends HeavyChartModel{isEmptyData(e){var t;return 0===(null==(t=null==e?void 0:e.nodes)?void 0:t.length)}}const CarouselCatalogView=observer((({model:e,width:t,height:r})=>{const{computed:n,state:o}=useChartConfig({chartOptions:e.chartOptions,width:t,height:r}),i=useClassWidget({widgetClass:CarouselCatalogWidget,model:e,computed:n,state:o,instanceSymbol:e.instanceSymbol,clearWhenIdle:e.clearWhenIdle,interaction:getInteractionConfig(e),runtime:{events:{onCarousel:t=>{e.widget.trigger({trigger:WIDGET_EVENT.CAROUSEL,fields:null==t?void 0:t.params})}}}});return jsx(HeavyChartView,{ref:i,model:e,width:o.width,height:o.height})}));function registerCarouselCatalog(){const e="CAROUSEL_CATALOG";registerHeavyChart(e,{displayName:duchampIntl.get("Duchamp-Carousel_Catalog_Gear_Diagram"),groupName:duchampIntl.get("Duchamp-Tree"),carousel:{defaultAutoPlay:!0,autoplaySpeed:3e3},refresh:{interval:60},props:{},states:{width:400,height:260},version:"0.1",dependencies:["?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/catalogWrapper.js","?op=resource&resource=com/fr/plugin/wysiwyg/chart/js/van-geer.js"],model:CarouselCatalogChartWidgetModel,configure:{eventTargets:{fields:generateTrigger$1("","",e).fields,events:[{trigger:WIDGET_EVENT.CAROUSEL,text:WIDGET_EVENT_MAP.CAROUSEL,actions:carouselActions}]}},scale:!1},CarouselCatalogView)}class ParticleChartWidgetModel extends HeavyChartModel{isEmptyData(e){return!(null==e?void 0:e.content)}}const ParticleView=observer((({model:e,width:t,height:r})=>{const{computed:n,state:o}=useChartConfig({chartOptions:e.chartOptions,width:t,height:r}),i=useClassWidget({widgetClass:ParticleWidget,model:e,computed:n,state:o,instanceSymbol:e.instanceSymbol,clearWhenIdle:e.clearWhenIdle}),a=useMergedRefs(i,e.ref);return jsx("div",{style:{width:"100%",height:"100%",pointerEvents:e.isPreview||e.isFloatTop?"auto":"none"},ref:a})}));function registerParticle(){registerHeavyChart("PARTICLE",{displayName:duchampIntl.get("Duchamp-Particle_Counter"),groupName:duchampIntl.get("Duchamp-Indicator_Card_Category"),refresh:{interval:6,open:!0},dependencies:["?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/particlecounter.min.js","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/particlecounterWrapper.js"],model:ParticleChartWidgetModel},ParticleView)}class GroupMapModel extends HeavyChartModel{degrade(){return super.degrade(!1)}}const GroupMapView=observer((({model:e,width:t,height:r})=>{const{computed:n,state:o}=useChartConfig({chartOptions:e.chartOptions,width:t,height:r}),i=useClassWidget({widgetClass:GroupMapWidget,model:e,computed:n,state:o,instanceSymbol:e.instanceSymbol,clearWhenIdle:e.clearWhenIdle,interaction:getInteractionConfig(e),runtime:{events:{onCarousel:t=>{e.widget.trigger({trigger:WIDGET_EVENT.CAROUSEL,fields:null==t?void 0:t.params})}}}});return jsx(HeavyChartView,{ref:i,model:e,width:o.width,height:o.height})}));function registerGroupMap(){const e="GROUP_MAP";registerHeavyChart(e,{displayName:duchampIntl.get("Duchamp-Carousel_3d_Combined_Map"),groupName:duchampIntl.get("Duchamp-Map_Class"),refresh:{interval:60},carousel:{defaultAutoPlay:!0,autoplaySpeed:6e3},dependencies:["?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/combined3DMapWrapper.js","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/combined-3d-map.js"],model:GroupMapModel,configure:{eventTargets:{fields:generateTrigger$1("","",e).fields,events:[{trigger:WIDGET_EVENT.CAROUSEL,text:WIDGET_EVENT_MAP.CAROUSEL,actions:carouselActions}]}},scale:!1},GroupMapView)}class SlideShowMapModel extends HeavyChartModel{isEmptyData(e){return 0===((null==e?void 0:e.locations)||[]).length}}const SlideShowMapView=observer((({model:e,width:t,height:r})=>{const{computed:n,state:o}=useChartConfig({chartOptions:e.chartOptions,width:t,height:r}),i=useClassWidget({widgetClass:SlideShowMapWidget,model:e,computed:n,state:o,instanceSymbol:e.instanceSymbol,clearWhenIdle:e.clearWhenIdle,runtime:{events:{onCarousel:t=>{e.widget.trigger({trigger:WIDGET_EVENT.CAROUSEL,fields:null==t?void 0:t.params})}}},interaction:getInteractionConfig(e)});return jsx(HeavyChartView,{ref:i,model:e,width:o.width,height:o.height})}));function registerSlideShowMap(){const e="SLIDE_SHOW_MAP";registerHeavyChart(e,{displayName:duchampIntl.get("Duchamp-Carousel_Gis_Point_Map"),groupName:duchampIntl.get("Duchamp-Map_Class"),refresh:{interval:60},carousel:{defaultAutoPlay:!0,autoplaySpeed:8e3},dependencies:["?op=resource&resource=/com/fr/plugin/wysiwyg/chart/css/mapbox-gl.css","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/vanslideshowmap.js","?op=resource&resource=/com/fr/plugin/wysiwyg/chart/js/slideshowmapWrapper.js"],model:SlideShowMapModel,configure:{eventTargets:{fields:generateTrigger$1("","",e).fields,events:[{trigger:WIDGET_EVENT.CAROUSEL,text:WIDGET_EVENT_MAP.CAROUSEL,actions:carouselActions}]}},scale:!1},SlideShowMapView)}const registerChartComponents=()=>{registerVanChart("COLUMN",duchampIntl.get("Duchamp-Column_Chart"),duchampIntl.get("Duchamp-Column_Chart_Class")),registerVanChart("STACK_COLUMN",duchampIntl.get("Duchamp-Stacked_Column_Chart"),duchampIntl.get("Duchamp-Column_Chart_Class")),registerVanChart("PERCENT_STACK_COLUMN",duchampIntl.get("Duchamp-Percentage_Stacked_Column_Chart"),duchampIntl.get("Duchamp-Column_Chart_Class")),registerVanChart("CUSTOM_COLUMN",duchampIntl.get("Duchamp-Custom_Column_Chart"),duchampIntl.get("Duchamp-Column_Chart_Class")),registerArcColumn(),registerShapeColumn(),registerVanChart("BAR",duchampIntl.get("Duchamp-Bar_Graph"),duchampIntl.get("Duchamp-Bar_Graph_Category")),registerVanChart("STACK_BAR",duchampIntl.get("Duchamp-Stacked_Bar_Chart"),duchampIntl.get("Duchamp-Bar_Graph_Category")),registerVanChart("PERCENT_STACK_BAR",duchampIntl.get("Duchamp-Percentage_Stacked_Bar_Chart"),duchampIntl.get("Duchamp-Bar_Graph_Category")),registerVanChart("CUSTOM_BAR",duchampIntl.get("Duchamp-Custom_Bar_Chart"),duchampIntl.get("Duchamp-Bar_Graph_Category")),registerCarouselBar(),registerVanChart("PIE",duchampIntl.get("Duchamp-Pie_Chart"),duchampIntl.get("Duchamp-Pie_Chart_Category")),registerVanChart("PIE_SAME_ARC",duchampIntl.get("Duchamp-Equal_Arc_Rose_Diagram"),duchampIntl.get("Duchamp-Pie_Chart_Category")),registerVanChart("PIE_DIFFERENT_ARC",duchampIntl.get("Duchamp-Unequal_Radian_Rose_Diagram"),duchampIntl.get("Duchamp-Pie_Chart_Category")),registerVanChart("MULTI_PIE",duchampIntl.get("Duchamp-Multi_Layer_Pie_Chart"),duchampIntl.get("Duchamp-Pie_Chart_Category")),registerCarouselPie(),registerVanChart("LINE",duchampIntl.get("Duchamp-Line_Chart"),duchampIntl.get("Duchamp-Line_Chart_Class")),registerVanChart("STACK_LINE",duchampIntl.get("Duchamp-Stacked_Line_Chart"),duchampIntl.get("Duchamp-Line_Chart_Class")),registerVanChart("CUSTOM_LINE",duchampIntl.get("Duchamp-Custom_Line_Chart"),duchampIntl.get("Duchamp-Line_Chart_Class")),registerVanChart("AREA",duchampIntl.get("Duchamp-Area_Chart"),duchampIntl.get("Duchamp-Line_Chart_Class")),registerVanChart("STACK_AREA",duchampIntl.get("Duchamp-Stacked_Area_Chart"),duchampIntl.get("Duchamp-Line_Chart_Class")),registerVanChart("PERCENT_STACK_AREA",duchampIntl.get("Duchamp-Percentage_Stacked_Area_Chart"),duchampIntl.get("Duchamp-Line_Chart_Class")),registerVanChart("CUSTOM_AREA",duchampIntl.get("Duchamp-Custom_Area_Chart"),duchampIntl.get("Duchamp-Line_Chart_Class")),registerVanChart("RADAR",duchampIntl.get("Duchamp-Radar_Chart"),duchampIntl.get("Duchamp-Line_Chart_Class")),registerVanChart("STACK_RADAR",duchampIntl.get("Duchamp-Stacked_Radar_Chart"),duchampIntl.get("Duchamp-Line_Chart_Class")),registerVanChart("GAUGE_POINTER",duchampIntl.get("Duchamp-360_Multi_Pointer_Dashboard"),duchampIntl.get("Duchamp-Dashboard")),registerVanChart("GAUGE_POINTER_SEMI",duchampIntl.get("Duchamp-180_Multi_Pointer_Instrument_Panel"),duchampIntl.get("Duchamp-Dashboard")),registerVanChart("GAUGE_RING",duchampIntl.get("Duchamp-Percent_Circle_Dashboard"),duchampIntl.get("Duchamp-Dashboard")),registerVanChart("GAUGE_SLOT",duchampIntl.get("Duchamp-Percentage_Scale_Slot_Dashboard"),duchampIntl.get("Duchamp-Dashboard")),registerVanChart("GAUGE_THERMOMETER",duchampIntl.get("Duchamp-Test_Tube_Type_Instrument_Panel"),duchampIntl.get("Duchamp-Dashboard")),registerCarouselGauge(),registerFluid(),registerPixelGrid(),registerKPI("KPI1",duchampIntl.get("Duchamp-Carousel_Blinking_Indicator_Card")),registerKPI("KPI2",duchampIntl.get("Duchamp-Carousel_Electronic_Indicator_Card")),registerParticle(),registerCarouselCatalog(),registerWisdomTree("WISDOM_TREE_ELECTRON",duchampIntl.get("Duchamp-Electronic_Wisdom_Tree_Diagram")),registerWisdomTree("WISDOM_TREE_MODEL",duchampIntl.get("Duchamp-Model_Wisdom_Tree_Diagram")),registerVanChart("AREA_MAP",duchampIntl.get("Duchamp-Area_Map"),duchampIntl.get("Duchamp-Map_Class"),"chartMap"),registerVanChart("POINT_MAP",duchampIntl.get("Duchamp-Point_Map"),duchampIntl.get("Duchamp-Map_Class"),"chartMap"),registerVanChart("LINE_MAP",duchampIntl.get("Duchamp-Flow_Map"),duchampIntl.get("Duchamp-Map_Class"),"chartMap"),registerVanChart("CUSTOM_MAP",duchampIntl.get("Duchamp-Combined_Map"),duchampIntl.get("Duchamp-Map_Class"),"chartMap"),registerVanChart("HEAT_MAP",duchampIntl.get("Duchamp-Heat_Map"),duchampIntl.get("Duchamp-Map_Class"),"chartMap"),registerVanChart("DRILL_AREA_MAP",duchampIntl.get("Duchamp-Drill_Area_Map"),duchampIntl.get("Duchamp-Map_Class"),"chartMap"),registerVanChart("DRILL_POINT_MAP",duchampIntl.get("Duchamp-Drill_Point_Map"),duchampIntl.get("Duchamp-Map_Class"),"chartMap"),registerVanChart("DRILL_CUSTOM_MAP",duchampIntl.get("Duchamp-Custom_Drill_Map"),duchampIntl.get("Duchamp-Map_Class"),"chartMap"),registerGroupMap(),registerSlideShowMap(),registerGlobe(),registerGeoLand(),registerVanChart("SCATTER",duchampIntl.get("Duchamp-Scatter_Plot"),duchampIntl.get("Duchamp-Scatter_Chart_Class")),registerVanChart("BUBBLE",duchampIntl.get("Duchamp-Bubble_Chart"),duchampIntl.get("Duchamp-Scatter_Chart_Class")),registerVanChart("TREE_MAP",duchampIntl.get("Duchamp-Rectangular_Tree_Diagram"),duchampIntl.get("Duchamp-Shape_And_Text")),registerVanChart("WORD_CLOUD",duchampIntl.get("Duchamp-Word_Cloud"),duchampIntl.get("Duchamp-Shape_And_Text")),registerVanChart("FORCE_BUBBLE",duchampIntl.get("Duchamp-Mechanics_Bubble_Chart"),duchampIntl.get("Duchamp-Shape_And_Text")),registerVanChart("FUNNEL",duchampIntl.get("Duchamp-Funnel_Chart"),duchampIntl.get("Duchamp-Shape_And_Text")),registerVanChart("COLUMN_LINE",duchampIntl.get("Duchamp-Column_Chart-Line_Chart"),duchampIntl.get("Duchamp-Combination_Diagram_Class")),registerVanChart("COLUMN_AREA",duchampIntl.get("Duchamp-Column_Chart-Area_Chart"),duchampIntl.get("Duchamp-Combination_Diagram_Class")),registerVanChart("STACK_COLUMN_LINE",duchampIntl.get("Duchamp-Stacked_Column_Chart-Line_Chart"),duchampIntl.get("Duchamp-Combination_Diagram_Class")),registerCustom(),registerTimeGear(),registerVanChart("GANTT",duchampIntl.get("Duchamp-Gantt_Chart"),duchampIntl.get("Duchamp-Other")),registerVanChart("STRUCTURE_VERTICAL",duchampIntl.get("Duchamp-Vertical_Frame"),duchampIntl.get("Duchamp-Other")),registerVanChart("STRUCTURE_HORIZONTAL",duchampIntl.get("Duchamp-Horizontal_Frame_Diagram"),duchampIntl.get("Duchamp-Other")),registerVanChart("STRUCTURE_RADIAL",duchampIntl.get("Duchamp-Divergence_Frame_Diagram"),duchampIntl.get("Duchamp-Other")),registerVanChart("BOX",duchampIntl.get("Duchamp-Box_Plot"),duchampIntl.get("Duchamp-Other"))};async function checkDrillDown(e,t,r,n){var o,i,a;if(null===r&&0===t.length)return!1;if(r===t.length-1)return!1;const s=null===r?e:null==(o=t.at(r))?void 0:o.options.wId,l=null==(i=t.at((null!=r?r:-1)+1))?void 0:i.options.wId;if(isNil$3(s)||isNil$3(l))return!1;if(s===l)return!0;const c=[e,...t.map((e=>{var t;return null!=(t=e.options.wId)?t:""}))];return(null!=(a=(await n.getTableRelations(c,[])).widgetRelations[s])?a:[]).includes(l)}var __defProp$L=Object.defineProperty,__getOwnPropDesc$H=Object.getOwnPropertyDescriptor,__decorateClass$K=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$H(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$L(t,r,i),i};const DRILL_DOWN_NAVIGATION_HEIGHT=28,FIELD_KEY="options";class RelationComponentModel extends BaseWidgetModel{constructor(){super(...arguments),__publicField(this,"componentInstance"),__publicField(this,"componentReferenceInfo"),__publicField(this,"data"),__publicField(this,"isBeLinked",!1),__publicField(this,"linked",!1),__publicField(this,"filter",null),__publicField(this,"computed",!1),__publicField(this,"drillDownNavigation",[]),__publicField(this,"activeDrillDownItemIndex",null),__publicField(this,"loadedEmit",(e=>{this.store.loadedManager.emit(STORY_LOADED_EVENT.WIDGET_LOAD_FINISHED,e)})),__publicField(this,"emitCurrentLoaded",(()=>{this.loadedEmit(this.widget.id)}))}get relationActionConfig(){var e;return null!=(e=this.props.relationActionConfig)?e:{open:!0,blacklist:[]}}get drillDown(){var e;return null!=(e=this.relationActionConfig.drillDown)?e:[]}get styleConfigContent(){return getSnapshot(this.store.styleConfig.widget.relation.content)}setRelationActionConfig(e){this.setProps({relationActionConfig:e})}get referenceInfo(){const{widgetIds:e=[],tableIds:t=[],parameterIds:r=[]}=this.componentReferenceInfo||{},{wId:n,tableId:o}=this.activeDrillDownItemIndex?{wId:this.drillDownNavigation[this.activeDrillDownItemIndex].id,tableId:""}:{wId:this.props.relationMeta.wId,tableId:this.props.relationMeta.tableId};return{widgetIds:uniq([n].concat(e)),tableIds:uniq([o].concat(t)),parameterIds:r}}onReferenceResourceChange(e){var t;(null==(t=this.referenceInfo.widgetIds)?void 0:t.some((t=>{var r;return null==(r=e.widgetIds)?void 0:r.includes(t)})))?this.clearRelationWidgetConfig():this.clearRelationWidgetData()}get fieldConfigs(){const e=new Map;return e.set(FIELD_KEY,{type:"relationWidget",widgetId:this.relationMeta.wId,tableId:this.relationMeta.tableId}),e}renderField(e,t){var r;if("init"===t.type&&this.isBeLinked)return void this.setComputed();const n=e.get(FIELD_KEY);if(n){const{filter:e}=n;"linkage"===t.type&&(null==(r=this.store.relationCalculate)||r.onReCalculate(this.id,this.storyIndex)),this.setFilter(e),this.setComputed()}"init"!==t.type&&this.clearDrillDown()}setComputed(){this.computed=!0}triggerLink(e){this.setFilter(e,!0),this.clearDrillDown()}clearLink(){this.refresh()}setLinked(e){var t;this.linked=e,null==(t=this.componentInstance)||t.setClearLinkageButtonVisible(e)}setFilter(e,t=!1){var r;this.isBeLinked=t,this.filter=e,this.clearRelationWidgetData(),null==(r=this.componentInstance)||r.refresh({...this.relationModelOptions,data:this.data})}get relationMeta(){return this.props.relationMeta}handleClick(e,t){var r;this.relationActionConfig.open&&!this.isDrillDown&&(null==(r=this.store.relationCalculate)||r.linkage(this,e,[this.id,...this.relationActionConfig.blacklist])),this.onDrillDown(e,t),this.isDrillDown||this.widget.trigger()}clearDrillDown(){this.isDrillDown&&(this.activeDrillDownItemIndex=null,this.drillDownNavigation=[])}async onDrillDown(e,t){await checkDrillDown(this.relationMeta.wId,this.drillDown,this.activeDrillDownItemIndex,this.store.crudService)&&this.onDrillDownInternal(e,t)}onDrillDownInternal(e,t){var r;this.clearRelationWidgetConfig(),this.activeDrillDownItemIndex=(null!=(r=this.activeDrillDownItemIndex)?r:-1)+1,this.drillDownNavigation=[...this.drillDownNavigation,{id:uuid$1(),drillInfo:t,filter:e}]}switchDrillDownItem(e){this.clearRelationWidgetConfig(),this.activeDrillDownItemIndex=0===e?null:e-1,this.drillDownNavigation=this.drillDownNavigation.slice(0,e)}get isDrillDown(){return null!==this.activeDrillDownItemIndex}get label(){return{value:this.name,...this.widget.props.label}}get relationType(){return this.widget.type.replace("d-relation-","")}setComponentInstance(e){var t;this.componentInstance=this.isDrillDown?void 0:e,this.componentReferenceInfo=null==(t=this.componentInstance)?void 0:t.referenceInfo}getComponentInstance(){return this.componentInstance}clearLinkage(){var e;null==(e=this.store.relationCalculate)||e.clear(this,[this.id,...this.relationActionConfig.blacklist])}get relationModelOptions(){var e,t;if(null!==this.activeDrillDownItemIndex){const r=this.drillDown[this.activeDrillDownItemIndex];return{id:r.id,wId:null!=(e=r.options.wId)?e:"",tableId:null!=(t=r.options.tableId)?t:"",props:{...this.relationModelProps,filter:this.drillDownNavigation[this.activeDrillDownItemIndex].filter,interval:{top:DRILL_DOWN_NAVIGATION_HEIGHT}},data:this.data}}return{id:this.id,tableId:this.relationMeta.tableId,wId:this.relationMeta.wId,props:this.relationModelProps,data:this.data}}get relationModelProps(){return{filter:this.filter,linked:this.linked,interval:{top:0},border:toJS(this.widget.border)}}setData(e){this.data=e}clearRelationWidgetConfig(){delete this.data}clearRelationWidgetData(){var e;null==(e=this.data)||delete e.widgetData}}function getRelationWidgets(e){return filterRelationWidgets(e.widgets)}function getAllRelationWidgets(e){return filterRelationWidgets(e.allWidgets)}function filterRelationWidgets(e){const t=[];return e.forEach((e=>{const r=e.getInstance();isRelationWidget(r)&&t.push(r)})),t}function getAllRelationTables(e){return uniq(getAllRelationWidgets(e).map((e=>e.relationMeta.tableId)))}function isRelationWidget(e){return e instanceof RelationComponentModel}__decorateClass$K([observable],RelationComponentModel.prototype,"linked",2),__decorateClass$K([observable.ref],RelationComponentModel.prototype,"filter",2),__decorateClass$K([observable],RelationComponentModel.prototype,"computed",2),__decorateClass$K([observable],RelationComponentModel.prototype,"drillDownNavigation",2),__decorateClass$K([observable],RelationComponentModel.prototype,"activeDrillDownItemIndex",2),__decorateClass$K([computed],RelationComponentModel.prototype,"relationActionConfig",1),__decorateClass$K([computed],RelationComponentModel.prototype,"drillDown",1),__decorateClass$K([computed],RelationComponentModel.prototype,"styleConfigContent",1),__decorateClass$K([action$1],RelationComponentModel.prototype,"setRelationActionConfig",1),__decorateClass$K([action$1],RelationComponentModel.prototype,"setComputed",1),__decorateClass$K([action$1],RelationComponentModel.prototype,"setLinked",1),__decorateClass$K([action$1],RelationComponentModel.prototype,"setFilter",1),__decorateClass$K([jsApi("trigger")],RelationComponentModel.prototype,"handleClick",1),__decorateClass$K([action$1],RelationComponentModel.prototype,"onDrillDownInternal",1),__decorateClass$K([action$1],RelationComponentModel.prototype,"switchDrillDownItem",1),__decorateClass$K([computed],RelationComponentModel.prototype,"relationModelOptions",1),__decorateClass$K([computed],RelationComponentModel.prototype,"relationModelProps",1);const AISummaryConfig=observer((({widget:e})=>{const t=useStore(),{crudService:r}=useService();return jsx(ClickEditConfig,{onClick:()=>{r.openAISummaryEdit({value:e.getValue(),widgets:getRelationWidgets(t.story),setValue:t=>{e.setValue(t)}})}})})),AI_SUMMARY_META={type:WIDGET_TYPE.AI_SUMMARY,displayName:duchampIntl.get("Duchamp-AI_Summary"),version:"0.0.1",iconfont:"icon-ai",dragPreviewImage:"/assets/widget/ai_summary.svg",widgetType:"ai",states:{width:400,height:260},configuration:e=>jsx(AISummaryConfig,{...e}),configure:{mobile:{fluidHeightGrid:FLUID_BLOCK_PARTS}}};class AISummaryModel extends BaseWidgetModel{get value(){return this.props.value}}const AISummaryView=({model:e})=>{const{crudService:t}=useService(),r=useStore(),n=reactExports.useRef(null),o=reactExports.useRef();return reactExports.useEffect((()=>{var i;if(n.current)return n.current.innerHTML="",o.current=t.initAISummaryView({dom:n.current,theme:{templateTheme:r.styleConfig.theme,widgetBackground:null==(i=r.story.getWidgetById(e.id))?void 0:i.platform.border},widgets:getRelationWidgets(r.story),value:e.value}),()=>{var e,t;null==(t=null==(e=o.current)?void 0:e.destroy)||t.call(e)}}),[]),jsx("div",{style:{width:"100%",height:"100%"},ref:n})},calderOptions={version:"0.0.1",widgetType:"3D",props:{configFile:"",usedFileIds:[]},states:{width:800,height:500},refresh:{interval:60},configure:{countLimit:1},platforms:["pc"],scale:!1},CALDER_WIDGET_META={...calderOptions,functionPoint:"fvs3DComponentCalder",type:"d-calder",displayName:duchampIntl.get("Duchamp-Three_Dimensional_City"),icon:"/assets/widget/calder.svg",dependencies:["/resource?resource=/com/fr/plugin/wysiwyg/web/calder/Calder.js",{edit:"/resource?resource=/com/fr/plugin/wysiwyg/web/edit/edit-override-calder-lib.js&type=calder",preview:"/resource?resource=/com/fr/plugin/wysiwyg/web/preview/preview-override-calder-lib.js&type=calder"}]},CALDER_CUSTOM_WIDGET_META={...calderOptions,functionPoint:"fvs3DComponentCustomModel",type:"d-calder-custom",displayName:duchampIntl.get("Duchamp-Calder_Custom"),icon:"/assets/widget/CALDER_CUSTOM.svg",dependencies:["/resource?resource=/com/fr/plugin/wysiwyg/web/calder/CalderCustom.js",{edit:"/resource?resource=/com/fr/plugin/wysiwyg/web/edit/edit-override-calder-lib.js&type=calderCustom",preview:"/resource?resource=/com/fr/plugin/wysiwyg/web/preview/preview-override-calder-lib.js&type=calderCustom"}]};class Md5{constructor(){this._dataLength=0,this._bufferLength=0,this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashStr(e,t=!1){return this.onePassHasher.start().appendStr(e).end(t)}static hashAsciiStr(e,t=!1){return this.onePassHasher.start().appendAsciiStr(e).end(t)}static _hex(e){const t=Md5.hexChars,r=Md5.hexOut;let n,o,i,a;for(a=0;a<4;a+=1)for(o=8*a,n=e[a],i=0;i<8;i+=2)r[o+1+i]=t.charAt(15&n),n>>>=4,r[o+0+i]=t.charAt(15&n),n>>>=4;return r.join("")}static _md5cycle(e,t){let r=e[0],n=e[1],o=e[2],i=e[3];r+=(n&o|~n&i)+t[0]-680876936|0,r=(r<<7|r>>>25)+n|0,i+=(r&n|~r&o)+t[1]-389564586|0,i=(i<<12|i>>>20)+r|0,o+=(i&r|~i&n)+t[2]+606105819|0,o=(o<<17|o>>>15)+i|0,n+=(o&i|~o&r)+t[3]-1044525330|0,n=(n<<22|n>>>10)+o|0,r+=(n&o|~n&i)+t[4]-176418897|0,r=(r<<7|r>>>25)+n|0,i+=(r&n|~r&o)+t[5]+1200080426|0,i=(i<<12|i>>>20)+r|0,o+=(i&r|~i&n)+t[6]-1473231341|0,o=(o<<17|o>>>15)+i|0,n+=(o&i|~o&r)+t[7]-45705983|0,n=(n<<22|n>>>10)+o|0,r+=(n&o|~n&i)+t[8]+1770035416|0,r=(r<<7|r>>>25)+n|0,i+=(r&n|~r&o)+t[9]-1958414417|0,i=(i<<12|i>>>20)+r|0,o+=(i&r|~i&n)+t[10]-42063|0,o=(o<<17|o>>>15)+i|0,n+=(o&i|~o&r)+t[11]-1990404162|0,n=(n<<22|n>>>10)+o|0,r+=(n&o|~n&i)+t[12]+1804603682|0,r=(r<<7|r>>>25)+n|0,i+=(r&n|~r&o)+t[13]-40341101|0,i=(i<<12|i>>>20)+r|0,o+=(i&r|~i&n)+t[14]-1502002290|0,o=(o<<17|o>>>15)+i|0,n+=(o&i|~o&r)+t[15]+1236535329|0,n=(n<<22|n>>>10)+o|0,r+=(n&i|o&~i)+t[1]-165796510|0,r=(r<<5|r>>>27)+n|0,i+=(r&o|n&~o)+t[6]-1069501632|0,i=(i<<9|i>>>23)+r|0,o+=(i&n|r&~n)+t[11]+643717713|0,o=(o<<14|o>>>18)+i|0,n+=(o&r|i&~r)+t[0]-373897302|0,n=(n<<20|n>>>12)+o|0,r+=(n&i|o&~i)+t[5]-701558691|0,r=(r<<5|r>>>27)+n|0,i+=(r&o|n&~o)+t[10]+38016083|0,i=(i<<9|i>>>23)+r|0,o+=(i&n|r&~n)+t[15]-660478335|0,o=(o<<14|o>>>18)+i|0,n+=(o&r|i&~r)+t[4]-405537848|0,n=(n<<20|n>>>12)+o|0,r+=(n&i|o&~i)+t[9]+568446438|0,r=(r<<5|r>>>27)+n|0,i+=(r&o|n&~o)+t[14]-1019803690|0,i=(i<<9|i>>>23)+r|0,o+=(i&n|r&~n)+t[3]-187363961|0,o=(o<<14|o>>>18)+i|0,n+=(o&r|i&~r)+t[8]+1163531501|0,n=(n<<20|n>>>12)+o|0,r+=(n&i|o&~i)+t[13]-1444681467|0,r=(r<<5|r>>>27)+n|0,i+=(r&o|n&~o)+t[2]-51403784|0,i=(i<<9|i>>>23)+r|0,o+=(i&n|r&~n)+t[7]+1735328473|0,o=(o<<14|o>>>18)+i|0,n+=(o&r|i&~r)+t[12]-1926607734|0,n=(n<<20|n>>>12)+o|0,r+=(n^o^i)+t[5]-378558|0,r=(r<<4|r>>>28)+n|0,i+=(r^n^o)+t[8]-2022574463|0,i=(i<<11|i>>>21)+r|0,o+=(i^r^n)+t[11]+1839030562|0,o=(o<<16|o>>>16)+i|0,n+=(o^i^r)+t[14]-35309556|0,n=(n<<23|n>>>9)+o|0,r+=(n^o^i)+t[1]-1530992060|0,r=(r<<4|r>>>28)+n|0,i+=(r^n^o)+t[4]+1272893353|0,i=(i<<11|i>>>21)+r|0,o+=(i^r^n)+t[7]-155497632|0,o=(o<<16|o>>>16)+i|0,n+=(o^i^r)+t[10]-1094730640|0,n=(n<<23|n>>>9)+o|0,r+=(n^o^i)+t[13]+681279174|0,r=(r<<4|r>>>28)+n|0,i+=(r^n^o)+t[0]-358537222|0,i=(i<<11|i>>>21)+r|0,o+=(i^r^n)+t[3]-722521979|0,o=(o<<16|o>>>16)+i|0,n+=(o^i^r)+t[6]+76029189|0,n=(n<<23|n>>>9)+o|0,r+=(n^o^i)+t[9]-640364487|0,r=(r<<4|r>>>28)+n|0,i+=(r^n^o)+t[12]-421815835|0,i=(i<<11|i>>>21)+r|0,o+=(i^r^n)+t[15]+530742520|0,o=(o<<16|o>>>16)+i|0,n+=(o^i^r)+t[2]-995338651|0,n=(n<<23|n>>>9)+o|0,r+=(o^(n|~i))+t[0]-198630844|0,r=(r<<6|r>>>26)+n|0,i+=(n^(r|~o))+t[7]+1126891415|0,i=(i<<10|i>>>22)+r|0,o+=(r^(i|~n))+t[14]-1416354905|0,o=(o<<15|o>>>17)+i|0,n+=(i^(o|~r))+t[5]-57434055|0,n=(n<<21|n>>>11)+o|0,r+=(o^(n|~i))+t[12]+1700485571|0,r=(r<<6|r>>>26)+n|0,i+=(n^(r|~o))+t[3]-1894986606|0,i=(i<<10|i>>>22)+r|0,o+=(r^(i|~n))+t[10]-1051523|0,o=(o<<15|o>>>17)+i|0,n+=(i^(o|~r))+t[1]-2054922799|0,n=(n<<21|n>>>11)+o|0,r+=(o^(n|~i))+t[8]+1873313359|0,r=(r<<6|r>>>26)+n|0,i+=(n^(r|~o))+t[15]-30611744|0,i=(i<<10|i>>>22)+r|0,o+=(r^(i|~n))+t[6]-1560198380|0,o=(o<<15|o>>>17)+i|0,n+=(i^(o|~r))+t[13]+1309151649|0,n=(n<<21|n>>>11)+o|0,r+=(o^(n|~i))+t[4]-145523070|0,r=(r<<6|r>>>26)+n|0,i+=(n^(r|~o))+t[11]-1120210379|0,i=(i<<10|i>>>22)+r|0,o+=(r^(i|~n))+t[2]+718787259|0,o=(o<<15|o>>>17)+i|0,n+=(i^(o|~r))+t[9]-343485551|0,n=(n<<21|n>>>11)+o|0,e[0]=r+e[0]|0,e[1]=n+e[1]|0,e[2]=o+e[2]|0,e[3]=i+e[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(Md5.stateIdentity),this}appendStr(e){const t=this._buffer8,r=this._buffer32;let n,o,i=this._bufferLength;for(o=0;o<e.length;o+=1){if(n=e.charCodeAt(o),n<128)t[i++]=n;else if(n<2048)t[i++]=192+(n>>>6),t[i++]=63&n|128;else if(n<55296||n>56319)t[i++]=224+(n>>>12),t[i++]=n>>>6&63|128,t[i++]=63&n|128;else{if(n=1024*(n-55296)+(e.charCodeAt(++o)-56320)+65536,n>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");t[i++]=240+(n>>>18),t[i++]=n>>>12&63|128,t[i++]=n>>>6&63|128,t[i++]=63&n|128}i>=64&&(this._dataLength+=64,Md5._md5cycle(this._state,r),i-=64,r[0]=r[16])}return this._bufferLength=i,this}appendAsciiStr(e){const t=this._buffer8,r=this._buffer32;let n,o=this._bufferLength,i=0;for(;;){for(n=Math.min(e.length-i,64-o);n--;)t[o++]=e.charCodeAt(i++);if(o<64)break;this._dataLength+=64,Md5._md5cycle(this._state,r),o=0}return this._bufferLength=o,this}appendByteArray(e){const t=this._buffer8,r=this._buffer32;let n,o=this._bufferLength,i=0;for(;;){for(n=Math.min(e.length-i,64-o);n--;)t[o++]=e[i++];if(o<64)break;this._dataLength+=64,Md5._md5cycle(this._state,r),o=0}return this._bufferLength=o,this}getState(){const e=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[e[0],e[1],e[2],e[3]]}}setState(e){const t=e.buffer,r=e.state,n=this._state;let o;for(this._dataLength=e.length,this._bufferLength=e.buflen,n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],o=0;o<t.length;o+=1)this._buffer8[o]=t.charCodeAt(o)}end(e=!1){const t=this._bufferLength,r=this._buffer8,n=this._buffer32,o=1+(t>>2);this._dataLength+=t;const i=8*this._dataLength;if(r[t]=128,r[t+1]=r[t+2]=r[t+3]=0,n.set(Md5.buffer32Identity.subarray(o),o),t>55&&(Md5._md5cycle(this._state,n),n.set(Md5.buffer32Identity)),i<=4294967295)n[14]=i;else{const e=i.toString(16).match(/(.*?)(.{0,8})$/);if(null===e)return;const t=parseInt(e[2],16),r=parseInt(e[1],16)||0;n[14]=t,n[15]=r}return Md5._md5cycle(this._state,n),e?this._state:Md5._hex(this._state)}}if(Md5.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]),Md5.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Md5.hexChars="0123456789abcdef",Md5.hexOut=[],Md5.onePassHasher=new Md5,"5d41402abc4b2a76b9719d911017c592"!==Md5.hashStr("hello"))throw new Error("Md5 self test failed.");function convertComputedFields(e){const t=new Map;return e.forEach((e=>{if(isDatasetFieldConfig(e)){const{datasetName:r,columns:n}=e,o=t.get(r)||{type:"dataset",datasetName:r,columns:[]};if(!isDatasetFieldConfig(o))return;n.forEach((e=>{"name"in e&&o.columns.push(e)})),t.set(r,o)}if(isFormulaFieldConfig(e)){const{columns:r}=e;if(!("formula"in r[0])||t.has(r[0].formula))return;t.set(r[0].formula,{type:"formula",columns:[{formula:r[0].formula}]})}})),t}function revertCalculateResultKey(e,t,r){const n=new Map;return e.forEach(((e,o)=>{n.set(o,t.get(r?r(o):o))})),n}function revertCalculateResult(e,t,r){const n=new Map,o=new Map,i=new Map;return t.forEach(((e,t)=>{const n=cloneDeep$2(r.get(t));if(n){if(isDatasetFieldConfig(e)){if(!isArray$c(n))return void o.set(t,n);const r=new Map,{columns:i}=e;i.forEach((e=>{"name"in e&&r.set(e.name,n.shift())})),o.set(t,r)}if(isFormulaFieldConfig(e)){const{columns:t}=e;"formula"in t[0]&&i.set(t[0].formula,isArray$c(n)?[n[0]]:n)}}})),e.forEach(((e,t)=>{if(isDatasetFieldConfig(e)){const{datasetName:r,columns:i}=e,a=o.get(r);if(!a)return;if(isMap$2(a)){const e=[];i.forEach((t=>{"name"in t&&a.has(t.name)&&e.push(a.get(t.name))})),n.set(t,e)}else n.set(t,a)}if(isFormulaFieldConfig(e)){const{columns:r}=e;"formula"in r[0]&&i.has(r[0].formula)&&n.set(t,i.get(r[0].formula))}})),n}const _InstanceRegistry=class e{constructor(){__publicField(this,"instances",new Map)}static getInstance(){return e.instance||(e.instance=new e),e.instance}getOrCreate(e,t){const r=this.instances.get(e);if(r)return r;const n=t();return this.instances.set(e,n),n}get(e){return this.instances.get(e)}remove(e){this.instances.delete(e)}};__publicField(_InstanceRegistry,"instance");let InstanceRegistry=_InstanceRegistry;const proxyMarker=Symbol("Comlink.proxy"),createEndpoint=Symbol("Comlink.endpoint"),releaseProxy=Symbol("Comlink.releaseProxy"),finalizer=Symbol("Comlink.finalizer"),throwMarker=Symbol("Comlink.thrown"),isObject$3=e=>"object"==typeof e&&null!==e||"function"==typeof e,proxyTransferHandler={canHandle:e=>isObject$3(e)&&e[proxyMarker],serialize(e){const{port1:t,port2:r}=new MessageChannel;return expose(e,t),[r,[r]]},deserialize:e=>(e.start(),wrap(e))},throwTransferHandler={canHandle:e=>isObject$3(e)&&throwMarker in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}},transferHandlers=new Map([["proxy",proxyTransferHandler],["throw",throwTransferHandler]]);function isAllowedOrigin(e,t){for(const r of e){if(t===r||"*"===r)return!0;if(r instanceof RegExp&&r.test(t))return!0}return!1}function expose(e,t=globalThis,r=["*"]){t.addEventListener("message",(function n(o){if(!o||!o.data)return;if(!isAllowedOrigin(r,o.origin))return;const{id:i,type:a,path:s}=Object.assign({path:[]},o.data),l=(o.data.argumentList||[]).map(fromWireValue);let c;try{const t=s.slice(0,-1).reduce(((e,t)=>e[t]),e),r=s.reduce(((e,t)=>e[t]),e);switch(a){case"GET":c=r;break;case"SET":t[s.slice(-1)[0]]=fromWireValue(o.data.value),c=!0;break;case"APPLY":c=r.apply(t,l);break;case"CONSTRUCT":c=proxy(new r(...l));break;case"ENDPOINT":{const{port1:t,port2:r}=new MessageChannel;expose(e,r),c=transfer(t,[t])}break;case"RELEASE":c=void 0;break;default:return}}catch(u){c={value:u,[throwMarker]:0}}Promise.resolve(c).catch((e=>({value:e,[throwMarker]:0}))).then((r=>{const[o,s]=toWireValue(r);t.postMessage(Object.assign(Object.assign({},o),{id:i}),s),"RELEASE"===a&&(t.removeEventListener("message",n),closeEndPoint(t),finalizer in e&&"function"==typeof e[finalizer]&&e[finalizer]())})).catch((e=>{const[r,n]=toWireValue({value:new TypeError("Unserializable return value"),[throwMarker]:0});t.postMessage(Object.assign(Object.assign({},r),{id:i}),n)}))})),t.start&&t.start()}function isMessagePort(e){return"MessagePort"===e.constructor.name}function closeEndPoint(e){isMessagePort(e)&&e.close()}function wrap(e,t){const r=new Map;return e.addEventListener("message",(function(e){const{data:t}=e;if(!t||!t.id)return;const n=r.get(t.id);if(n)try{n(t)}finally{r.delete(t.id)}})),createProxy(e,r,[],t)}function throwIfProxyReleased(e){if(e)throw new Error("Proxy has been released and is not useable")}function releaseEndpoint(e){return requestResponseMessage(e,new Map,{type:"RELEASE"}).then((()=>{closeEndPoint(e)}))}const proxyCounter=new WeakMap,proxyFinalizers="FinalizationRegistry"in globalThis&&new FinalizationRegistry((e=>{const t=(proxyCounter.get(e)||0)-1;proxyCounter.set(e,t),0===t&&releaseEndpoint(e)}));function registerProxy(e,t){const r=(proxyCounter.get(t)||0)+1;proxyCounter.set(t,r),proxyFinalizers&&proxyFinalizers.register(e,t,e)}function unregisterProxy(e){proxyFinalizers&&proxyFinalizers.unregister(e)}function createProxy(e,t,r=[],n=function(){}){let o=!1;const i=new Proxy(n,{get(n,a){if(throwIfProxyReleased(o),a===releaseProxy)return()=>{unregisterProxy(i),releaseEndpoint(e),t.clear(),o=!0};if("then"===a){if(0===r.length)return{then:()=>i};const n=requestResponseMessage(e,t,{type:"GET",path:r.map((e=>e.toString()))}).then(fromWireValue);return n.then.bind(n)}return createProxy(e,t,[...r,a])},set(n,i,a){throwIfProxyReleased(o);const[s,l]=toWireValue(a);return requestResponseMessage(e,t,{type:"SET",path:[...r,i].map((e=>e.toString())),value:s},l).then(fromWireValue)},apply(n,i,a){throwIfProxyReleased(o);const s=r[r.length-1];if(s===createEndpoint)return requestResponseMessage(e,t,{type:"ENDPOINT"}).then(fromWireValue);if("bind"===s)return createProxy(e,t,r.slice(0,-1));const[l,c]=processArguments(a);return requestResponseMessage(e,t,{type:"APPLY",path:r.map((e=>e.toString())),argumentList:l},c).then(fromWireValue)},construct(n,i){throwIfProxyReleased(o);const[a,s]=processArguments(i);return requestResponseMessage(e,t,{type:"CONSTRUCT",path:r.map((e=>e.toString())),argumentList:a},s).then(fromWireValue)}});return registerProxy(i,e),i}function myFlat(e){return Array.prototype.concat.apply([],e)}function processArguments(e){const t=e.map(toWireValue);return[t.map((e=>e[0])),myFlat(t.map((e=>e[1])))]}const transferCache=new WeakMap;function transfer(e,t){return transferCache.set(e,t),e}function proxy(e){return Object.assign(e,{[proxyMarker]:!0})}function toWireValue(e){for(const[t,r]of transferHandlers)if(r.canHandle(e)){const[n,o]=r.serialize(e);return[{type:"HANDLER",name:t,value:n},o]}return[{type:"RAW",value:e},transferCache.get(e)||[]]}function fromWireValue(e){switch(e.type){case"HANDLER":return transferHandlers.get(e.name).deserialize(e.value);case"RAW":return e.value}}function requestResponseMessage(e,t,r,n){return new Promise((o=>{const i=generateUUID();t.set(i,o),e.start&&e.start(),e.postMessage(Object.assign({id:i},r),n)}))}function generateUUID(){return new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-")}const MESSAGE_TYPE={WIDGET_LIST:"widgetList",STORY_LIST:"storyList",ADAPTER_INIT:"adapterInit",WIDGETS_WITH_MODEL_ANIMATION:"widgetsWithModelAnimation",WIDGETS_WITH_MODEL_ROAM_ANIMATION:"widgetsWithRoamAnimation"},messageHandleMap={[MESSAGE_TYPE.WIDGET_LIST]:e=>e.story.groupRelateWidgets,[MESSAGE_TYPE.STORY_LIST]:e=>e.stories.map((e=>({...getSnapshot(e),widgets:e.groupRelateWidgets}))),[MESSAGE_TYPE.ADAPTER_INIT]:e=>({story:{type:e.storyType,id:e.story.id},currents:e.story.currentArr,backgroundColor:e.story.platform.backgroundLayer.color}),[MESSAGE_TYPE.WIDGETS_WITH_MODEL_ANIMATION]:e=>getWidgetsAnimations(e.story.relatedWidgets),[MESSAGE_TYPE.WIDGETS_WITH_MODEL_ROAM_ANIMATION]:e=>getRoamAnimation(e.story.relatedWidgets)};class DataProcessor{constructor(e){__publicField(this,"store"),this.store=e}getProject(){var e;const{currentWidget:t}=this.store.story;if(!t||!widgetIsCalderComponent(t.type))return;return{resourceInfoList:t.getInstance().getInitResource(),optionsResId:null==(e=t.props)?void 0:e.configFile}}saveProject(e,t,r){const{currentWidget:n}=this.store.story;if(!n)return!1;return n.getInstance().saveCalderResource(e,t,r),!0}}const _CalderAdapter=class e{constructor(e,t){__publicField(this,"store"),__publicField(this,"channel"),this.store=e,this.channel=new BroadcastChannel(t),this.initListener(),expose(new DataProcessor(this.store),this.channel)}static init(t,r){return e.instance||(e.instance=new e(t,r)),e.instance}initListener(){this.channel.addEventListener("message",(e=>{var t;const{data:r}=e;if(!isTypeMessage(r))return;const n=null==(t=messageHandleMap[r.type])?void 0:t.call(messageHandleMap,this.store);n&&this.replay(r.type,n)}))}replay(e,t){this.channel.postMessage({type:"re:".concat(e),data:t})}};__publicField(_CalderAdapter,"instance");let CalderAdapter=_CalderAdapter;function isTypeMessage(e){return isObject$e(e)&&"type"in e}class CalderPreload{constructor(){__publicField(this,"needPreload",!0)}getNeedPreloadWidgets(e){const{store:t}=e;if(!t.isPreview||!this.needPreload)return;this.needPreload=!1;const{stories:r}=t,n=flatten$1([...r.filter(((e,r)=>r>t.currentStory)).map((e=>e.widgets)),...r.filter(((e,r)=>r<t.currentStory)).map((e=>e.widgets))]);return n.filter((t=>t.type===e.type))}}const calderPreload=new CalderPreload,collectResourceDependence=async(e,t)=>{const r={},n=[],o=t.map((async e=>{r[e.id]={files:[],tables:[]};const t=e.getInstance(),{fieldConfigs:o}=t;if(o.forEach((t=>{isDatasetFieldConfig(t)&&r[e.id].tables.push(t.datasetName)})),widgetIsWorkbook(e.type))n.push({key:e.id,configs:Array.from(o.values())});else if(widgetIsChart(e))n.push({key:e.id,configs:Array.from(o.values())});else if(widgetIsController(e)){const t=e.getValue();if("field"===t.valueConfig.type){const{dataSet:n}=t.valueConfig.payload;r[e.id].tables.push(n)}"d-controller-tree-combo"!==e.type&&"d-controller-tree-view"!==e.type||n.push({key:e.id,configs:Array.from(o.values())})}else if(widgetIsHeavyComponent(e.type)){const t=await e.getInstance().getResources();null==t||t.forEach((t=>{"dataset"===t.type&&r[e.id].tables.push(t.value)}))}}));try{await Promise.all(o);const t=await e.computeFieldDataSet({fields:n});if(!responseIsError(t))for(const e in t){const n=t[e];n.length&&(r[e].tables=Array.from(new Set(r[e].tables.concat(n))))}}finally{for(const e in r)r[e].files.length||r[e].tables.length||delete r[e]}return r},flatResourceDependence=e=>({files:Object.values(e).reduce(((e,t)=>e.concat(t.files.filter((e=>!!e.path)))),[]),tables:Object.values(e).reduce(((e,t)=>Array.from(new Set(e.concat(t.tables.filter((e=>!!e)))))),[])}),getAllWidgetResourceList=e=>Array.from(new Set(e.flatMap((e=>e.model.collectResourceIDs())))),getAllWidgetResourceDetailsList=e=>e.flatMap((e=>e.model.collectResourceDetails()));async function getAllWidgetResourceDependence(e,t){const r=flatWidgets(e),n=await collectResourceDependence(t,r),o=flatResourceDependence(n);return{files:getAllWidgetResourceList(r),tables:o.tables}}const getFrmResource=e=>({files:Array.from(e.values()).map((e=>e[0])).filter((e=>widgetIsWorkbook(e.type))).map((e=>"".concat(e.id,".ec")))||[],tables:[]}),filterResourceIds=(e,t,r)=>{var n;return null==(n=r.filter(e).filter(t))?void 0:n.map((e=>e.id))},getCalderInitResource=(e,t,r=!0)=>{const n=filterResourceIds({},(e=>null==t?void 0:t.includes(e.id)),e);if(!r)return Object.values(e.getInfoWithSubByIDs(n)).flat();const o=filterResourceIds({tags:["3d"]},(e=>{var t;return!(null==(t=e.payload)?void 0:t.isPrivate)}),e),i=filterResourceIds({type:"image"},(e=>{var t;return!!(null==(t=e.payload)?void 0:t.isCustom)}),e),a=[...new Set([...n,...o,...i])];return Object.values(e.getInfoWithSubByIDs(a)).flat()},getAllResource=e=>Object.values(e.getInfos());var __defProp$K=Object.defineProperty,__getOwnPropDesc$G=Object.getOwnPropertyDescriptor,__decorateClass$J=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$G(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$K(t,r,i),i};class CalderWidgetModel extends BaseWidgetModel{constructor(){super(...arguments),__publicField(this,"ref",reactExports.createRef()),__publicField(this,"skipRenderEffect",!1),__publicField(this,"cacheable",!1),__publicField(this,"canOnlyUpdateDataWhenLinkage",!0),__publicField(this,"lastRefreshTime",null),__publicField(this,"loadProgress",0),__publicField(this,"isFirstLoaded",!0),__publicField(this,"withLoading",!0),__publicField(this,"needUpdatedResource",null),__publicField(this,"loadedEmit",(()=>{this.emitCurrentLoaded()})),__publicField(this,"stopOnHover",!0),__publicField(this,"cameraState"),__publicField(this,"config",{options:null,onlyRefreshData:!1}),__publicField(this,"configInHost",null),__publicField(this,"adapterId","duchamp-calder-".concat(this.store.id)),__publicField(this,"calculateResult",new Map),__publicField(this,"hostSnapshotImage",""),__publicField(this,"setHostSnapshotImage",(e=>{this.hostSnapshotImage=e})),__publicField(this,"snapshotImage",""),__publicField(this,"hideDegradeToolbar",!0),__publicField(this,"setCameraState",(e=>{this.cameraState=e}))}get el(){return getTargetElement$2(this.ref)}setLastRefreshTime(e){this.lastRefreshTime=e}setLoadProgress(e){!1!==this.isFirstLoaded&&(this.loadProgress=e)}get dataPushRefreshDataOnly(){return!1}hideLoadingAnimation(){this.setLoadProgress(100)}setStopOnHover(e){this.stopOnHover=e}openHoverPauseRollPlay(){this.setStopOnHover(!0)}closeHoverPauseRollPlay(){this.setStopOnHover(!1)}pauseRollPlay(){var e,t;null==(t=(e=this.calder).pauseCameraRotate)||t.call(e)}continueRollPlay(){var e,t;null==(t=(e=this.calder).continueCameraRotate)||t.call(e)}get options(){return toJS(this.configInHost?mergeOptions(this,this.config.options,this.configInHost.options):this.config.options)}async onInit(){this.applyEnv(duchamp.env),this.updateCalderResource(),this.updateCalderResourceCenterConfig(),this.updateCalderFunctionPoints(),this.hideLoadingAnimation(),this.widget.setLoading(!0);const e=await this.getOptionFromFile();if(this.setCalderOption(!1,e),this.skipRenderEffect=this.fieldConfigs.size>0,this.isPreview){const e=calderPreload.getNeedPreloadWidgets(this.widget);e&&Promise.all(e.reduce(((e,t)=>{var r;const n=null==(r=this.store.resourceCenter.getInfoByID(t.props.configFile))?void 0:r.name;return n&&e.push(this.getOptions(t.id,n)),e}),[])).then((e=>{var t,r;null==(r=null==(t=this.calder)?void 0:t.preload)||r.call(t,e)}))}CalderAdapter.init(this.store,this.adapterId),this.widget.setLoading(!1)}registerService(){var e,t;null==(t=(e=this.staticInstance).Override)||t.call(e,"COMPUTE",(async e=>{const t=new Map(Object.entries(e.configs)),r=this.convertComputedFields(t),n=this.getNotEmptyFieldConfigs(this.options),o=this.convertComputedFields(n),i=new Map;r.forEach(((e,t)=>{const r=o.get(t);r&&i.set(t,r)}));const a=new Map;i.forEach(((e,t)=>{a.set("".concat(this.id,".").concat(Md5.hashStr(t)),e)}));const s=await this.calculateCenter.calculateFieldConfigs(a,void 0,void 0,e.params),l=this.revertCalculateResultKey(i,s,(e=>"".concat(this.id,".").concat(Md5.hashStr(e))));return{result:this.revertCalculateResult(t,i,l)}}))}setWidgetError(e){this.widget.setWidgetError({...e,errorType:"warning"})}async setFieldValues(e,t){if(null===this.options)return;if(super.setFieldValues(e,t),e.forEach(((e,t)=>{e&&this.calculateResult.set(t,e)})),this.calculateResult.size!==this.fieldConfigs.size)return;const r=toJS(this.config.options);if(!r)return;const n=this.getNotEmptyFieldConfigs(this.options),o=this.convertComputedFields(n),i=this.revertCalculateResultKey(o,this.calculateResult,(e=>Md5.hashStr(e))),a=this.revertCalculateResult(n,o,i);r.calculator=a,r.data=this.getDataFormCalculatorResult(r,a),this.skipRenderEffect=!1,this.canOnlyUpdateDataWhenLinkage?this.setCalderOption("linkage"===t.type,r):this.setCalderOption("init"!==t.type&&this.dataPushRefreshDataOnly,r)}get instanceKey(){var e;return(null==(e=this.widget.story)?void 0:e.$modelType)+this.widget.type}get instance(){return InstanceRegistry.getInstance().getOrCreate(this.instanceKey,(()=>{var e;const t=document.createElement("div");t.style.width="100%",t.style.height="100%",null==(e=this.el)||e.appendChild(t);return{widgetInstance:new this.staticInstance(t,{trackResize:!1,preserveDrawingBuffer:!this.isPreview}),element:t}}))}get calder(){return this.instance.widgetInstance}resize(){if(!this.options)return;const{widgetInstance:e}=this.instance;e.resize()}skipRender(){return!!this.skipRenderEffect&&(this.skipRenderEffect=!1,!0)}renderView(e=this.options){var t,r,n,o,i;if(this.skipRender())return;if(null===e||null===this.el)return;this.registerService(),this.isFirstLoaded&&this.setLoadProgress(0),this.withLoading&&this.widget.setLoading(!0);const{widgetInstance:a,element:s}=this.instance;this.el&&!this.el.hasChildNodes()&&this.el.appendChild(s),null==(t=a.resume)||t.call(a),this.resize(),a.setOptionsImmediately({...e,lastRefreshTime:this.lastRefreshTime}),this.addClickEventListeners(),null==(r=this.calder)||r.off("LoadingProgressChange"),null==(n=this.calder)||n.on("loadingProgressChange",(e=>{var t,r,n,o;this.setLoadProgress(100*e),e>=1&&(this.isPreview||this.widget.setExtrasValue({modelAnimations:null==(t=this.calder)?void 0:t.getModelAnimations(),cameraWalkAnimations:null==(r=this.calder)?void 0:r.getCameraWalkAnimations(),perspectives:null==(n=this.calder)?void 0:n.getSharedCameraStateList(),envSettings:null==(o=this.calder)?void 0:o.getEnvSettings()}),this.widget.setLoading(!1),this.withLoading=!0,this.loadedEmit(),this.isFirstLoaded=!1)})),null==(o=this.calder)||o.off("errorInfo"),null==(i=this.calder)||i.on("errorInfo",(e=>{this.widget.setWidgetError(e)}))}addClickEventListeners(){var e,t,r,n;this.isPreview&&(null==(e=this.calder)||e.off("executeEvents"),null==(t=this.calder)||t.on("executeEvents",(e=>{var t;this.widget.executeEvents({...e.context,events:e.events,options:{mouseEvent:e.sourceEvent,onTargetMove:e.onTargetMoveInViewport}}),null==(t=e.stopPropagation)||t.call(e)}))),null==(r=this.calder)||r.off("cameraViewChange"),null==(n=this.calder)||n.on("cameraViewChange",(()=>{this.setCameraState(this.getCameraState())}))}renderData(e=this.options){const{widgetInstance:t}=this.instance;t.setData(e)}renderHostView(e=this.options){var t,r,n,o,i;if(this.skipRender())return;if(null===e||null===this.el)return;this.registerService(),this.isFirstLoaded&&this.setLoadProgress(0),this.withLoading&&this.widget.setLoading(!0);const{widgetInstance:a,element:s}=this.instance;this.el&&!this.el.hasChildNodes()&&this.el.appendChild(s),null==(t=a.resume)||t.call(a),this.resize(),this.isPreview&&-1!==this.store.prevStory?a.setOptions({...e,lastRefreshTime:this.lastRefreshTime}):a.setOptionsImmediately({...e,lastRefreshTime:this.lastRefreshTime}),this.addClickEventListeners(),null==(r=this.calder)||r.off("LoadingProgressChange"),null==(n=this.calder)||n.on("loadingProgressChange",(e=>{this.setLoadProgress(100*e),e>=1&&(this.widget.setLoading(!1),this.withLoading=!1,this.loadedEmit(),this.isFirstLoaded=!1)})),null==(o=this.calder)||o.off("errorInfo"),null==(i=this.calder)||i.on("errorInfo",(e=>{this.widget.setWidgetError(e)}))}onPopover(e){var t,r,n,o;e?null==(r=(t=this.calder).pauseCameraRotate)||r.call(t):null==(o=(n=this.calder).continueCameraRotate)||o.call(n)}getOptionAnimations(e=this.options){return e?this.staticInstance.GetModelAnimationsConfigFromOptions(e):[]}getModelAnimations(){return this.calder.getModelAnimations()}getModels(e=this.options){return e?this.staticInstance.GetModelsConfigFromOptions(e):[]}getModelsTreeData(e=this.options){var t,r;return e?null==(r=(t=this.staticInstance).GetModelsTreeDataFromOptions)?void 0:r.call(t,e):[]}setModelsVisible(e,t){this.calder.setModelVisible(e,t)}getDataLayers(e=this.options){return e?this.staticInstance.GetDataLayersConfigFromOptions(e):[]}getDataLayersApi(){return this.calder.getDataLayers()}getDataLayerByName(e){return this.calder.getDataLayerByName(e)}getMeshByName(e){return this.calder.getMeshByName(e)}get camera(){return this.calder.camera}getRoamAnimations(){return this.calder.getCameraWalkAnimations()}updateRoamAnimationAction(e){this.updateCameraWalkAnimationStatus({playAction:e})}playRoamAnimations(e){const{names:t,playMode:r}=e;this.updateCameraWalkAnimationStatus({names:t,playAction:"play",playMode:r})}animateSceneTime(e){return this.calder.animateSceneTime(e)}getCoordinate(e){var t;return e?null==(t=this.calder.getMeshByName(e))?void 0:t.getScreenSpacePosition(!0):super.getCoordinate()}showDialogByMesh(e){const{meshName:t,width:r,height:n}=e,o=this.calder.getMeshByName(t),i=reactExports.createRef(),a=reaction((()=>this.cameraState),(()=>{var e;const t=o.getScreenSpacePosition(!0),[a,s]=t;null==(e=i.current)||e.updatePosition({width:r,height:n,coordinate:[a,s]})}));return openDialog({...e,ref:i,store:this.store,coordinate:this.getCoordinate(t),dialogType:DIALOG_TYPE.DYNAMIC,onCancel:()=>{a()}})}async updateOption(e=!1,t){const r=await this.getOptions(this.id,this.calderName,t);this.setCalderOption(e,r)}async refresh(e,t=!1){this.withLoading=!1,this.updateOption(t,e)}getCameraPerspectiveByName(e){const t=this.calder.getSharedCameraStateList().find((t=>t.name===e));if(t){const e={position:t.position,target:t.target};return{cameraState:e,focus:t=>{this.calder.camera.setState(e,t)}}}return null}async refreshAll(e){return this.refresh(e,!1)}async refreshData(e){return this.refresh(e,!0)}setCalderOption(e,t){this.config={onlyRefreshData:e,options:t}}openEditor(){this.fireEvent("disableDegrade"),this.store.crudService.registerEditingWidget({onChange:()=>{this.updateOption()}}),this.store.setModified(!0),this.store.crudService.openToEdit(this.calderName,this.widget.name,this.outEditUrl)}saveCalderResource(e,t,r){const n=this.getInitResource().reduce(((t,r)=>(e.some((e=>e.id===r.id))||t.push(r.id),t)),[]);this.store.resourceCenter.delete(n),this.setProps({configFile:t,usedFileIds:r}),this.store.resourceCenter.addResourceInfo(e),this.updateCalderResourceCenterConfig(),setAllCalderRenderResource(this.store,this.widgetType)}updateCalderResourceCenterConfig(){var e,t;null==(t=(e=this.staticInstance).SetResourceConfig)||t.call(e,getAllResource(this.store.resourceCenter))}getInitResource(){var e;return getCalderInitResource(this.store.resourceCenter,null==(e=this.props)?void 0:e.usedFileIds)}get disableEdit(){return!isNil$3(this.widget.widgetError)&&isNil$3(this.options)}get floatEditToolbar(){const{parentWidget:e}=this.widget;return{label:duchampIntl.get("Duchamp-Angle_Adjustment"),icon:"icon-view",hide:!this.options||!isNil$3(e)&&isStructureWidget(e)}}async onFloatEditEnd(){var e;const t=null==(e=this.calder)?void 0:e.getOptions();t&&(this.skipRenderEffect=!0,this.saveOptions(t),this.store.setModified(!0))}setRenderResource(){this.updateCalderResourceCenterConfig()}saveOptions(e){this.options||this.updateCalderResourceCenterConfig(),this.setCalderOption(!1,e);const{calculator:t,data:r,...n}=e;this.store.crudService.saveWidgetOptions(JSON.stringify(n),this.calderName)}transition({status:e,duration:t}){var r,n;const{element:o}=this.instance;this.skipRender()||(this.registerService(),this.el&&!this.el.hasChildNodes()&&this.el.appendChild(o),"start"===e&&o&&(this.resize(),null==(r=this.calder)||r.off("LoadingProgressChange"),null==(n=this.calder)||n.on("loadingProgressChange",(e=>{e>=1&&this.loadedEmit()})),this.calder.setOptions({...this.options,transitionDuration:t,lastRefreshTime:this.lastRefreshTime}),this.addClickEventListeners()))}setConfigInHost(e){this.configInHost={...this.configInHost,...e}}async hostDegrade(){if(this.configInHost&&this.el){this.setCalderPause();const e="".concat(this.configInHost.story,"_").concat(this.id);return createSnapshot(this.el,e,this.store.resourceCenter,this.configInHost.degradeSource).then((e=>{const[t,r]=e;return this.setHostSnapshotImage(t),new Promise((e=>{r.then((t=>{var r;const{id:n}=t;(getPayload$2(t,"fileName")||"").startsWith("".concat(null==(r=this.configInHost)?void 0:r.story,"_").concat(this.id))&&this.setConfigInHost({degradeSource:n}),e(n)}))}))}))}}get hostImageSource(){var e;return this.hostSnapshotImage||((null==(e=this.configInHost)?void 0:e.degradeSource)?parseUrl(createResourceURL(getImageResourceById(this.store.resourceCenter,this.configInHost.degradeSource).imageSource,this.store.duchampServer.resourceBaseUrl),[{name:"t",value:"".concat(Date.now())}]):"")}hostDegradeRender(){return renderSnapshot(this.hostImageSource||(this.imageSource?parseUrl(createResourceURL(this.imageSource,this.duchampServer.resourceBaseUrl),[{name:"t",value:"".concat(Date.now())}]):""),(()=>this.fireEvent("disableHostDegrade")))}canHostDegrade(){return!!this.hostImageSource||!!this.imageSource}async degrade(e=!0){if(!this.el)return Promise.reject();if(this.setCalderPause(),!e)return Promise.resolve();const t=await createSnapshot(this.el,this.widget.id,this.store.resourceCenter,this.widget.extras.degradeSource),[r,n]=t;this.snapshotImage=r;const o=await n;this.widget.setExtrasValue({degradeSource:o.id})}degradeRender(){return renderSnapshot(this.snapshotImage||createResourceURL(this.imageSource,this.duchampServer.resourceBaseUrl),(()=>this.fireEvent("disableDegrade")))}canDegradeWhenInit(){return!!this.imageSource}async getResources(){const e=[];return this.fieldConfigs.forEach((t=>{"dataset"===t.type&&e.push({type:"dataset",value:t.datasetName})})),this.extraFieldConfigs.forEach((t=>{"dataset"===t.type&&e.push({type:"dataset",value:t.datasetName})})),e}reset(){this.skipRenderEffect=!1,this.withLoading=!0,this.widget.setLoading(!1),this.setOnlyRefreshData(!1)}setOnlyRefreshData(e){this.config.onlyRefreshData=e}get fieldConfigs(){if(!this.options){const e=new Map,{computes:t}=this.duchampServer.store;return Object.keys(t).forEach((r=>{const n="".concat(this.id,".");r.startsWith(n)&&e.set(r.replace("".concat(n),""),t[r])})),e}const e=this.getNotEmptyFieldConfigs(this.options),t=this.convertComputedFields(e),r=new Map;return t.forEach(((e,t)=>{r.set(Md5.hashStr(t),e)})),r}getNotEmptyFieldConfigs(e){return new Map([...this.staticInstance.GetComputedPropertiesFromOptions(e)].filter((([,e])=>!("dataset"===e.type&&0===e.datasetName.length))))}get extraFieldConfigs(){if(this.options)return this.getExtraFieldConfigsFromOptions(this.options);const{computes:e}=this.duchampServer.store;return new Map(Object.entries(e).filter((([e])=>e.startsWith(this.id))))}getExtraFieldConfigsFromOptions(e){var t;const r=new Map;return null==(t=e.dataLayers)||t.forEach((e=>{const{events:t=[]}=e;collectionEventsComputes(t,actionRegistry).forEach(((e,t)=>{r.set("".concat(this.id,"-").concat(t),e)}))})),r}getFieldConfigsFromConfig(e){return this.getExtraFieldConfigsFromOptions(e)}get imageSource(){const e=getResourceInfoByID(this.widget.extras.degradeSource,this.store.resourceCenter);return e?e.name:""}playAnimation(e,t,r,n){var o;null==(o=this.calder)||o.emit("playModelAnimation",{id:e,delay:r,loop:t,command:n})}updateCameraWalkAnimationStatus(e){var t;const{names:r,playAction:n,playMode:o}=e;null==(t=this.calder)||t.emit("updateCameraWalkAnimationStatus",{names:r,playAction:n,playMode:o})}collectResourceIDs(){const e=super.collectResourceIDs(),{degradeSource:t}=this.widget.extras;return t&&e.push(t),e.concat(this.props.usedFileIds)}updateResourceIDs(e){const{usedFileIds:t,configFile:r}=this.props,{degradeSource:n}=this.widget.extras,o=e.get(n);if(o&&this.widget.setExtrasValue({degradeSource:o}),t.some((t=>e.has(t)))){const n=t.map((t=>e.get(t)||t));this.skipRenderEffect=!0,this.setProps({usedFileIds:n,configFile:e.get(r)||r})}this.needUpdatedResource=e}async updatePrivateResource(e){if(!e)return;const t=await this.getCurrentOptions();if(!t)return null;const r=this.staticInstance.ReplacePrivateResources(t,Object.fromEntries(e));return this.saveOptions({...toJS(this.config.options),...r})}updateCalderFunctionPoints(){const e=this.store.checkFunctionPoint("fvs3DDataDriven");this.staticInstance.FunctionPoints={dataDriven:e}}updateAddition3dResource(e){const t=Array.from(e.values()),r=this.store.resourceCenter.filter({tags:["3d"]}).filter((e=>{var t;return!(null==(t=e.payload)?void 0:t.isPrivate)})),{pastePublicResources:n,originPublic3dResource:o}=r.reduce(((e,r)=>(t.includes(r.id)?e.pastePublicResources.push(r):e.originPublic3dResource.push(r),e)),{pastePublicResources:[],originPublic3dResource:[]}),i=this.staticInstance.UpdateCalderNewResources(n,o);this.store.resourceCenter.addResourceInfo(i)}async updateCalderResource(){const e=this.needUpdatedResource;e&&0!==e.size&&(await this.updatePrivateResource(e),this.updateAddition3dResource(e),this.needUpdatedResource=null)}get calderName(){var e;return(null==(e=this.store.resourceCenter.getInfoByID(this.props.configFile))?void 0:e.name)||""}get staticInstance(){return Calder}get outEditUrl(){return"/com/fr/plugin/wysiwyg/web/calder/edit.html&adapterId=".concat(this.adapterId)}applyEnv(e){this.staticInstance.AssetBaseURL="".concat(e.assetBaseUrl,"/calder"),this.staticInstance.ResourceBaseURL=e.resourceBaseUrl;const t={languageConfig:e.languageConfig,mapBoxURL:e.mapBoxURL};this.staticInstance.SetEnvInfo(t)}async getOptionFromFile(e=this.calderName){var t,r,n;if(!e)return null;const o=await this.store.crudService.getWidgetOptions({fileName:e});o&&(o.name=e);const i=this.preprocessWidgetError(o);return i?null!=(n=null==(r=(t=this.staticInstance).UpgradeOptionStructure)?void 0:r.call(t,i))?n:i:this.widget.widgetError?null:o}async getOptions(e,t=this.calderName,r){if(!t)return null;const n=await this.getOptionFromFile(t);if(!n)return null;const o=await this.calculateFields(e,n,r),i=await this.getDataFormCalculatorResult(n,o);return n.calculator=o,n.data=i,n}async getCurrentOptions(){if(!this.calderName)return null;if(this.config.options)return this.config.options;const e=await this.getOptionFromFile();return e||null}getDataFormCalculatorResult(e,t){return this.getDataLayers(e).map((({id:e,fields:r})=>{const n=t.get(e);return n&&isArray$c(n)?n:r.map((()=>[]))}))}async calculateFields(e,t,r){const n=this.getNotEmptyFieldConfigs(t),o=t=>"".concat(e,".").concat(Md5.hashStr(t)),i=this.convertComputedFields(n),a=new Map;i.forEach(((e,t)=>{a.set(o(t),e)}));const s=await this.duchampServer.calculateCenter.calculateFieldConfigs(a,!this.isPreview,!1,r),l=this.revertCalculateResultKey(i,s,(e=>o(e)));return this.revertCalculateResult(n,i,l)}getModelsFromOptions(e=this.options){return null==e?void 0:e.customMeshModels}getOptionsWithModels(e,t=this.options){return t?{...t,customMeshModels:e}:null}getCameraState(){var e,t,r,n,o;return null!=(o=null==(t=(e=this.calder).getCameraState)?void 0:t.call(e))?o:null==(n=null==(r=this.calder)?void 0:r.getOptions().camera)?void 0:n.cameraState}getEnvSettingId(){var e,t,r,n;return null!=(n=null==(t=(e=this.calder).getCurrentEnvSettingId)?void 0:t.call(e))?n:null==(r=this.calder)?void 0:r.getOptions().selectedEnvSettingId}restoreDefaultPerspective(){this.changeCalderPerspectiveByDefault(0)}copyCameraState(){this.cameraState&&fvsService.writeTextToClipboard(JSON.stringify({...this.cameraState,source:this.store.isBackgroundStory?"3D-Background-Current-Page-Effect":"2D-Canvas-Perspective-Adjustment"}))}pasteCameraState(){fvsService.readTextFromClipboard().then((e=>{try{const t=JSON.parse(e);t.target[1]=0,this.changeCalderPerspectiveByState(t,0),sendFocusPoint({id:this.store.isBackgroundStory?"S318":"S322",param:{...t}})}catch(e3){Message.error(duchampIntl.get("Duchamp-No_Content_To_Paste"))}}))}waitUntilCalderRendered(){return new Promise((e=>{this.el?e():this.calder.once("sceneUpdateEnd",e)}))}changeCalderPerspectiveByState(e,t){isCalderCameraState(e)&&(this.setCameraState(e),this.waitUntilCalderRendered().then((()=>{var r,n;null==(n=(r=this.calder).setCameraState)||n.call(r,e,t)})))}changeCalderPerspectiveByDefault(e){this.waitUntilCalderRendered().then((()=>{var t,r;null==(r=(t=this.calder).resetCameraState)||r.call(t,e)}))}changeCalderPerspectiveById(e){this.waitUntilCalderRendered().then((()=>{const t=this.calder.getSharedCameraStateList().find((t=>t.id===e));t&&this.changeCalderPerspectiveByState({position:t.position,target:t.target})}))}changeCalderEnvSettingById(e){this.waitUntilCalderRendered().then((()=>{var t;null==(t=this.calder)||t.emit("changeEnvSetting",e)}))}applyConfigInHost(e,t=!0){this.configInHost=e?t?{...this.configInHost,...e}:{...e}:null,this.config.onlyRefreshData=!1,this.hostSnapshotImage=""}async unMountConfigInHost(e){const t=!!this.el,r=this.configInHost?"".concat(this.configInHost.story,"_").concat(this.id):null;let n;if(t&&(n=this.getCameraState()),this.applyConfigInHost(null,!1),!t||this.isPreview)return e;if(r&&this.el){const t=await createSnapshot(this.el,r,this.store.resourceCenter,null==e?void 0:e.degradeSource),[,o]=t,i=await o;return{...e,options:{...null==e?void 0:e.options,cameraState:n},degradeSource:i.id}}return{...e,options:{...null==e?void 0:e.options,cameraState:n}}}async replaceData(e){super.replaceData(e);const t=await this.getCurrentOptions();if(!t)return null;const r=this.staticInstance.ReplaceDatasetConfig(t,e.replacement);this.saveOptions({...toJS(this.config.options),...r}),this.refresh()}setCalderPause(){var e,t;const r=null==(e=InstanceRegistry.getInstance().get(this.instanceKey))?void 0:e.widgetInstance;r&&(null==(t=r.pause)||t.call(r))}getTemplateDependencies(){var e,t,r;if(this.options){const r=super.getTemplateDependencies();return null==(t=(e=this.staticInstance).GetEventsConfigFromOptions)||t.call(e,this.options).forEach((e=>{e.forEach((e=>{e.actions.forEach((e=>{if(e.type===CLICK_ACTION_TYPE.WEB_PAGE_POPOVER){const{url:t}=e.body;t.pathType===CONTENT_TYPE.TEMPLATE&&r.push(t.value)}}))}))})),r}const{consanguinity:n}=this.duchampServer.store;return null!=(r=null==n?void 0:n.widgetTemplatesMap[this.id])?r:[]}upgradeModelAnimationStructure(e){if(isTargetAnimation(e))return e;const t=[],r={},n={},o={},i=this.getModelsFromOptions();return i&&i.forEach((e=>{var t;n[e.id]=e.name,null==(t=e.customAnimations)||t.forEach((e=>{r[e.id]=e.name,"transition"===e.type&&"dissolve"===e.transition.type&&(o[e.id]=!0)}))})),e.forEach((e=>{const[i,a]=e.id.split(":"),s=n[i],l=r[a]||a;t.push({id:e.id,name:e.name,targetId:i,targetName:s,animationId:a,animationName:l,animationType:o[a]?AnimationTypeValues.Wireframe:AnimationTypeValues.GLTF})})),t}convertComputedFields(e){return convertComputedFields(e)}revertCalculateResult(e,t,r){return revertCalculateResult(e,t,r)}revertCalculateResultKey(e,t,r){return revertCalculateResultKey(e,t,r)}getFocusPoint(){var e,t;return this.config.options&&(null==(t=(e=this.staticInstance).GetEventTrackingDataFromOptions)?void 0:t.call(e,this.config.options))||{}}getPerformanceMeasureInfo(){return{id:"FR-P4002",body:this.calder.getPerformanceLog()}}canExportReuse(){return!!this.options}}__decorateClass$J([observable],CalderWidgetModel.prototype,"loadProgress",2),__decorateClass$J([action$1],CalderWidgetModel.prototype,"setLoadProgress",1),__decorateClass$J([observable],CalderWidgetModel.prototype,"stopOnHover",2),__decorateClass$J([action$1],CalderWidgetModel.prototype,"setStopOnHover",1),__decorateClass$J([jsApi()],CalderWidgetModel.prototype,"openHoverPauseRollPlay",1),__decorateClass$J([jsApi()],CalderWidgetModel.prototype,"closeHoverPauseRollPlay",1),__decorateClass$J([observable],CalderWidgetModel.prototype,"cameraState",2),__decorateClass$J([observable],CalderWidgetModel.prototype,"config",2),__decorateClass$J([observable],CalderWidgetModel.prototype,"configInHost",2),__decorateClass$J([computed],CalderWidgetModel.prototype,"options",1),__decorateClass$J([jsApi("getDataLayers")],CalderWidgetModel.prototype,"getDataLayersApi",1),__decorateClass$J([jsApi()],CalderWidgetModel.prototype,"getDataLayerByName",1),__decorateClass$J([jsApi()],CalderWidgetModel.prototype,"getMeshByName",1),__decorateClass$J([jsApi()],CalderWidgetModel.prototype,"camera",1),__decorateClass$J([jsApi()],CalderWidgetModel.prototype,"getRoamAnimations",1),__decorateClass$J([jsApi()],CalderWidgetModel.prototype,"updateRoamAnimationAction",1),__decorateClass$J([jsApi()],CalderWidgetModel.prototype,"playRoamAnimations",1),__decorateClass$J([jsApi()],CalderWidgetModel.prototype,"animateSceneTime",1),__decorateClass$J([jsApi()],CalderWidgetModel.prototype,"getCoordinate",1),__decorateClass$J([jsApi()],CalderWidgetModel.prototype,"showDialogByMesh",1),__decorateClass$J([jsApi()],CalderWidgetModel.prototype,"getCameraPerspectiveByName",1),__decorateClass$J([jsApi("refresh")],CalderWidgetModel.prototype,"refreshAll",1),__decorateClass$J([jsApi()],CalderWidgetModel.prototype,"refreshData",1),__decorateClass$J([action$1],CalderWidgetModel.prototype,"setCalderOption",1),__decorateClass$J([action$1],CalderWidgetModel.prototype,"saveCalderResource",1),__decorateClass$J([computed],CalderWidgetModel.prototype,"disableEdit",1),__decorateClass$J([computed],CalderWidgetModel.prototype,"floatEditToolbar",1),__decorateClass$J([action$1],CalderWidgetModel.prototype,"setConfigInHost",1),__decorateClass$J([observable],CalderWidgetModel.prototype,"hostSnapshotImage",2),__decorateClass$J([action$1],CalderWidgetModel.prototype,"setHostSnapshotImage",2),__decorateClass$J([computed],CalderWidgetModel.prototype,"hostImageSource",1),__decorateClass$J([action$1],CalderWidgetModel.prototype,"setOnlyRefreshData",1),__decorateClass$J([action$1],CalderWidgetModel.prototype,"setCameraState",2),__decorateClass$J([action$1],CalderWidgetModel.prototype,"applyConfigInHost",1),__decorateClass$J([action$1],CalderWidgetModel.prototype,"unMountConfigInHost",1);class CalderCustomWidgetModel extends CalderWidgetModel{get outEditUrl(){return"/com/fr/plugin/wysiwyg/web/calder/edit-custom.html&adapterId=".concat(this.adapterId)}get staticInstance(){return CalderCustom}getModelsFromOptions(e=this.options){return null==e?void 0:e.nodes}getOptionsWithModels(e,t=this.options){return t?{...t,nodes:e}:null}getPerformanceMeasureInfo(){return{id:"FR-P4001",body:this.calder.getPerformanceLog()}}}const CalderView=observer((({model:e,width:t,height:r=0})=>{const n=useStore(),o=reactExports.useMemo((()=>!e.isPreview&&(!e.isFloatTop&&!e.isHostFloatTop)),[e.isFloatTop,e.isHostFloatTop]),i=e=>e.map((e=>e.toFixed(2))).join(", "),a=useFirstMountState$1()&&!e.config.options,s=!e.isPreview&&!o;return reactExports.useEffect((()=>{if(e.isInCurrentStory&&!a&&e.config.options){const t=!e.isFirstLoaded&&e.config.onlyRefreshData&&e.isPreview;"start"===e.transitionStatus?e.transition({status:e.transitionStatus,duration:timeUnitToMillisecond(oldTime2TimeMillisecond(n.mainStory.transition.duration))}):e.isInHost?t?e.renderData():e.renderHostView():t?e.renderData():e.renderView()}}),[e,e.config,e.options,n.story]),reactExports.useEffect((()=>()=>{e.reset()}),[e]),useHotkeys("shift+c",(()=>{s&&e.restoreDefaultPerspective()}),[s]),useUpdateEffect$2((()=>{e.resize()}),[t,r]),jsxs("div",{className:"calder-view",style:{width:t,height:r,pointerEvents:o?"none":"auto"},children:[jsx("div",{className:"calder-view-content",ref:e.ref}),s&&e.cameraState&&jsxs("div",{className:"calder-camera-state",children:[jsxs("div",{className:"row-text title-line",children:[jsxs("div",{className:"info-text",children:[duchampIntl.get("Duchamp-Perspective_Parameter"),jsx(Icon$2,{type:"icon-return",title:jsxs("div",{children:[duchampIntl.get("Duchamp-Restore_Default_Perspective"),jsx("br",{}),jsx("div",{style:{textAlign:"center"},children:"Shift + C"})]}),onClick:()=>{e.restoreDefaultPerspective()}})]}),jsxs("div",{className:"row-text icon-group",children:[jsx(Icon$2,{type:"icon-copy",title:duchampIntl.get("Duchamp-Copy"),onClick:()=>{e.copyCameraState()},"data-focus-point":{id:n.isBackgroundStory?"S317":"S321"}}),jsx(Icon$2,{type:"icon-paste-change",title:duchampIntl.get("Duchamp-Paste_Replace"),onClick:()=>{e.pasteCameraState()}})]})]}),jsxs("div",{className:"row-text",children:[jsx(Icon$2,{type:"icon-camera-coordinates",title:duchampIntl.get("Duchamp-Camera_Coordinates")}),jsx("div",{className:"info-text",children:i(e.cameraState.position)})]}),jsxs("div",{className:"row-text",children:[jsx(Icon$2,{type:"icon-viewpoint-coordinates",title:duchampIntl.get("Duchamp-Viewport_Coordinates")}),jsx("div",{className:"info-text",children:i(e.cameraState.target)})]})]})]})})),UNITY_TARGET_EVENTS=[{trigger:WIDGET_EVENT.CLICK,text:WIDGET_EVENT_MAP.CLICK,actions:defaultActions}],UNITY_WIDGET_META={version:"0.0.1",widgetType:"3D",props:{configFile:"",usedFileIds:[]},states:{width:800,height:500},refresh:{interval:60},functionPoint:"fvs3DComponentUnity",type:"d-unity",displayName:"Unity",icon:"/assets/widget/UNITY.svg",dependencies:["/resource?resource=/com/fr/plugin/wysiwyg/web/unity/FVSUnity.js"],platforms:["pc"],configure:{countLimit:1,eventTargets:[{events:UNITY_TARGET_EVENTS}]},scale:!1};var __defProp$J=Object.defineProperty,__getOwnPropDesc$F=Object.getOwnPropertyDescriptor,__decorateClass$I=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$F(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$J(t,r,i),i};class UnityWidgetModel extends CalderWidgetModel{constructor(){super(...arguments),__publicField(this,"canOnlyUpdateDataWhenLinkage",!1)}get dataPushRefreshDataOnly(){return this.store.dataPushConfig.dataRefreshOnly}get outEditUrl(){return"/com/fr/plugin/wysiwyg/web/unity/edit.html&adapterId=".concat(this.adapterId)}applyEnv(e){this.staticInstance.AssetBaseURL="".concat(e.assetBaseUrl,"/unity"),this.staticInstance.ResourceBaseURL=e.resourceBaseUrl}get unity(){return this.instance.widgetInstance}get staticInstance(){return FVSUnity}getInitResource(){var e;return getCalderInitResource(this.store.resourceCenter,null==(e=this.props)?void 0:e.usedFileIds,!1)}renderView(e=this.options){var t,r;if(this.skipRenderEffect)return void(this.skipRenderEffect=!1);if(this.fieldConfigs.size>0&&!(null==e?void 0:e.data))return;if(null===e||null===this.el)return;this.isFirstLoaded&&this.setLoadProgress(0),this.withLoading&&this.widget.setLoading(!0);const{widgetInstance:n,element:o}=this.instance;this.el&&!this.el.hasChildNodes()&&this.el.appendChild(o),this.resize(),n.setOptions(e),this.addClickEventListeners(),null==(t=this.calder)||t.off("loadingProgress"),null==(r=this.calder)||r.on("loadingProgress",(e=>{this.setLoadProgress(100*e),e>=1&&(this.widget.setLoading(!1),this.withLoading=!0,this.loadedEmit(),this.isFirstLoaded=!1)}))}addClickEventListeners(){this.isPreview&&(this.unity.off("fireUnityEvent"),this.unity.on("fireUnityEvent",(e=>{var t;this.widget.trigger({target:e.name,fields:e.event,options:{mouseEvent:e.sourceEvent,onTargetMove:e.onTargetMoveInViewport}}),null==(t=e.stopPropagation)||t.call(e)})))}get eventTargets(){if(!this.options)return[];return this.staticInstance.getEvents(this.options).map((e=>({text:e.displayName,value:e.name,fields:e.parameters.map((e=>({text:e.displayName,value:e.key}))),events:UNITY_TARGET_EVENTS})))}async onFloatEditEnd(){var e;null==(e=this.unity)||e.getOptions().then((e=>{e&&(this.setCalderOption(!1,e),this.store.crudService.saveWidgetOptions(JSON.stringify(e),this.calderName),this.store.setModified(!0))}))}getDataLayers(e){return(e?this.staticInstance.getTableInfos(e):[]).map((e=>({dataSet:e.name,fields:e.fields.map((e=>({value:e,id:e})))})))}onPopover(e){}convertComputedFields(e){return e}revertCalculateResult(e,t,r){return r}getDataFormCalculatorResult(e,t){return this.getDataLayers(e).map((({dataSet:e,fields:r})=>{const n=t.get(e);return n&&isArray$c(n)?n:r.map((()=>[]))}))}executeAction(e,...t){return this.unity.executeAction(e,...t)}getPerformanceMeasureInfo(){}}__decorateClass$I([override],UnityWidgetModel.prototype,"eventTargets"),__decorateClass$I([jsApi()],UnityWidgetModel.prototype,"executeAction");const Path=e=>jsxs("div",{className:"d-iframe-path",children:[jsx("div",{className:"title",children:duchampIntl.get("Duchamp-Link_Address")}),jsx(PathInput,{...e,type:"textarea"})]});function getFormatsByDateFormatType(e){return(DATE_FORMAT_LISTS.find((t=>t.type===e))||DATE_FORMAT_LISTS[0]).formats}function transformDateFormat2DayjsFormat(e){return e.replaceAll("y","Y").replaceAll("d","D")}const{Option:Option$9}=Select$1,DateFormatConfig=observer((({value:e,onChange:t,dateFormatList:r=DATE_FORMAT_LISTS,supportDateFormatType:n=[DATE_FORMAT_TYPE.YM,DATE_FORMAT_TYPE.YY,DATE_FORMAT_TYPE.YQ,DATE_FORMAT_TYPE.YMD,DATE_FORMAT_TYPE.YMD_HMS,DATE_FORMAT_TYPE.HMS]})=>{const o=e.type||DATE_FORMAT_LISTS[0].type,i=getFormatsByDateFormatType(o),[a,s]=useUpdateValue$1(o,[e.type]),[l,c]=useUpdateValue$1(e.value||i[0],[e.value]),u=i.map((e=>({value:e,label:e})));return jsx("div",{className:"controller-date-format-config",children:jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,children:[jsx(LabelItem$1,{children:jsx(Select$1,{value:o,style:{width:"100%"},onChange:e=>{const r=getFormatsByDateFormatType(e);c(r[0]),s(e),t({type:e,value:r[0]})},children:r.map((e=>jsx(Option$9,{value:e.type,children:e.name},e.type)))})}),includes(n,a)&&jsx(LabelItem$1,{children:jsx(AutoComplete,{options:u.filter((t=>e.value===l||t.value.toUpperCase().includes(l.toUpperCase()))),value:l,onChange:e=>{c(e)},onBlur:()=>{t({type:a,value:l})}})})]})})}));function ToggleDateFormatConfig(e){const{value:t,onChange:r}=e;return jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,children:[jsx(Checkbox$4,{value:t.enabled,onChange:e=>r({...t,enabled:e}),text:duchampIntl.get("Duchamp-Date_Time_Display")}),t.enabled&&jsx(DateFormatConfig,{value:t.dateTimeFormat,onChange:e=>{r({...t,dateTimeFormat:e})}})]})}const FormulaInsertInput=observer((({showFormulaDialog:e,...t})=>{const r=useLatest$3(e||(e=>new Promise((t=>{fvsService.openFormulaEditor(e,(e=>{t(e)}))}))));return jsx(FormulaInsertInput$1,{...t,showFormulaDialog:r.current})})),FormulaInput=e=>jsx(FormulaInput$1,{...e,showFormulaDialog:(e,t)=>fvsService.openFormulaEditor(e,t)});function IconConfigPanel(e){const{value:t,onChange:r}=e;return jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,children:[jsx(Checkbox$4,{value:t.enabled,onChange:e=>r({...t,enabled:e}),text:duchampIntl.get("Duchamp-Time_Icon_Display")}),t.enabled&&jsx(IconConfigContent,{...e})]})}function IconConfigContent(e){const{value:t,onChange:r}=e;return jsxs(Col,{children:[jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Size"),children:jsx(NumberInput$1,{value:t.size,suffix:"px",onChange:e=>{r({...t,size:e})}})}),jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Color"),children:jsx(CompositeColorSelector,{onChange:e=>{r({...t,color:e})},value:t.color})}),jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Icon_Spacing"),children:jsx(NumberInput$1,{value:t.iconSpacing,suffix:"px",onChange:e=>{r({...t,iconSpacing:e})}})})]})}const{Option:Option$8}=Select$1,LINE_STYLE_TYPES=["solid","dotted","dashed"],LineConfig=({value:e,onChange:t,allowNone:r,showPlatform:n})=>{const o=r=>n=>t({...e,[r]:n}),i=reactExports.useMemo((()=>r?["none",...LINE_STYLE_TYPES]:LINE_STYLE_TYPES),[r]),{borderStyle:a="none"}=e,s="none"===a;return jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,children:[jsxs("div",{className:classNames$1("duchamp-line-config","flex-space-between"),children:[jsx(Select$1,{value:a,style:{flex:1,marginRight:8},onChange:o("borderStyle"),children:i.map(((e,t)=>jsx(Option$8,{className:"duchamp-flex-center",value:e,children:jsx("div",{className:classNames$1("line-select-option","duchamp-flex-center"),children:jsx("div","none"===e?{children:duchampIntl.get("Duchamp-Without")}:{className:"line-not-empty",style:{borderTop:"1px ".concat(e)}})})},t)))}),jsx(NumberInput$1,{min:0,suffix:"px",width:56,value:e.borderWidth,disabled:s,onChange:o("borderWidth"),prefix:n&&jsx(PlatformPopoverIcon,{})})]}),jsx(ThemeColorPicker,{value:e.borderColor||"",disabled:s,onChange:o("borderColor")})]})},SliderInputItem=({label:e="",showPlatform:t,...r})=>jsx(t?PlatformLineItem:LineItem,{label:e,children:jsx(SliderInput$1,{...r})});class FormItemManager{constructor(){__publicField(this,"formItems",new Map),this.register("number",NumberInput$1),this.register("input",Input$2),this.register("formulaInput",FormulaInput),this.register("textArea",TextArea),this.register("checkbox",Checkbox$4),this.register("radioGroup",RadioGroup$1),this.register("select",AsyncSelect),this.register("fontSelect",FontSelect),this.register("colorSelect",ThemeColorPicker),this.register("sliderInputItem",SliderInputItem),this.register("compositeColorSelector",CompositeColorSelector),this.register("shadowInput",ShadowInput),this.register("sliderInput",SliderInput$1),this.register("marquee",MarqueeConfig),this.register("formulaInsertInput",FormulaInsertInput),this.register("line",LineConfig),this.register("borderRadius",BorderRadius),this.register("toggleDateFormatConfig",ToggleDateFormatConfig),this.register("weekDayFormat",WeekDayFormatView),this.register("iconConfigPanel",IconConfigPanel)}register(e,t){this.formItems.set(e,t)}getFormItem(e){return this.formItems.get(e)}}const formItemManager=new FormItemManager,DEFAULT_VALUE={name:"",type:PARAMETER_TYPE.FORMULA,value:""};function ParametersConfigModal(e){const{title:t,parameters:r,onOk:n,onCancel:o}=e,[i,a]=reactExports.useState(r.length?r:[DEFAULT_VALUE]);return jsx(FVSDialog,{visible:!0,className:"parameters-model",title:t,onOk:()=>{n(i),o()},onCancel:()=>{o()},styles:{body:{padding:"12px 24px"}},children:jsx(Parameter$1,{value:i,onChange:e=>{a(e)},showFormulaDialog:(e,t)=>fvsService.openFormulaEditor(e,t)})})}const COLUMN_SIZE=[92,136],Row=({name:e,value:t})=>jsxs("div",{className:"row",children:[jsx("div",{className:"row-text",style:{width:COLUMN_SIZE[0],marginRight:"12px"},children:e}),jsx("div",{className:"row-text",style:{width:COLUMN_SIZE[1]},children:t})]}),ParametersConfig=e=>{const[t,r]=reactExports.useState(!1),{value:n,onChange:o}=e,i=toJS(n);return jsxs(Fragment,{children:[jsxs("div",{className:"parameters-config",children:[jsxs("div",{className:"title",children:[duchampIntl.get("Duchamp-Parameter_Setting"),jsx(Button$4,{block:!0,className:"title-button",onClick:()=>r(!0),children:duchampIntl.get("Duchamp-Set_Up")})]}),jsxs("div",{className:"params-table",children:[jsxs("div",{className:"params-table-header",children:[jsx("div",{style:{width:COLUMN_SIZE[0],marginRight:"12px"},children:duchampIntl.get("Duchamp-Parameter_Name")}),jsx("div",{style:{width:COLUMN_SIZE[1]},children:duchampIntl.get("Duchamp-Parameter_Content")})]}),jsx("div",{className:"params-table-body",children:i.length?i.map(((e,t)=>jsx(Row,{name:e.name,value:e.value},t))):jsx("div",{className:"params-table-body-preview",children:duchampIntl.get("Duchamp-No_Parameters")})})]})]}),t&&jsx(ParametersConfigModal,{title:duchampIntl.get("Duchamp-Parameter_Setting"),parameters:n,onCancel:()=>{r(!1)},onOk:o})]})};formItemManager.register("d-iframe-path",Path),formItemManager.register("d-iframe-parameters",ParametersConfig);const IFRAME_WIDGET_CONFIG=[{name:"path",value:{pathType:PATH_TYPE.URL,value:[]},type:"d-iframe-path"},{name:"parameters",value:[],type:"d-iframe-parameters"},{name:"requestType",displayName:duchampIntl.get("Duchamp-Request_Method"),value:"GET",type:"radioGroup",optionType:"default",options:[{label:duchampIntl.get("Duchamp-Use_Get_To_Pass_Parameters"),value:"GET"},{label:duchampIntl.get("Duchamp-Use_Post_To_Pass_Parameters"),value:"POST"}]},{name:"scrolling",displayName:duchampIntl.get("Duchamp-Web_Frame_Settings"),value:!1,type:"checkbox",text:duchampIntl.get("Duchamp-Show_Webpage_Scroll_Bar")},{name:"autoHeight",displayName:"",value:!0,type:"autoHeight",platforms:["mobile"],"data-focus-point":{id:"S263",trigger:"onChange",getParam:e=>({value:e?"1":"2"})}}],IFRAME_WIDGET_META={type:WIDGET_TYPE.IFRAME,displayName:duchampIntl.get("Duchamp-Web_Frame"),version:"0.0.2",widgetType:"container",iconfont:"icon-web-frame-components",dragPreviewImage:"/assets/widget/iframe.svg",scale:!1,states:{width:380,height:210},configuration:IFRAME_WIDGET_CONFIG,configure:{mobile:{fluidHeightGrid:FLUID_BLOCK_PARTS}}},IFRAME_FORMULA_KEY="path";function getIframeConfig(e,t){const{path:r,parameters:n,requestType:o,scrolling:i}=e;return{path:configKit$1.path.transform({config:r,compute:{computedResult:t,index:0,key:IFRAME_FORMULA_KEY}}),parameters:configKit$1.parameters.transform({config:n,compute:{computedResult:t,index:0}}),method:o,scrolling:i}}var __defProp$I=Object.defineProperty,__decorateClass$H=(e,t,r,n)=>{for(var o,i=void 0,a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$I(t,r,i),i};class IframeModel extends BaseWidgetModel{constructor(){super(...arguments),__publicField(this,"calculateResult",new Map)}get fieldConfigs(){const{path:e,parameters:t}=this.props;let r=new Map;const n=configKit$1.path.getComputeConfig({config:e,options:{key:IFRAME_FORMULA_KEY}}),o=configKit$1.parameters.getComputeConfig({config:t});return r=new Map([...n,...o]),0===r.size&&r.set("key",{type:"static",value:[]}),r}async setFieldValues(e,t){super.setFieldValues(e,t),this.calculateResult=new Map([...this.calculateResult,...e])}getTemplateDependencies(){const e=super.getTemplateDependencies(),{path:t}=this.props;return t.pathType===PATH_TYPE.TEMPLATE&&e.push(t.value),e}get autoHeight(){var e;return null==(e=this.props.autoHeight)||e}replaceData(e){super.replaceData(e);const{replacement:t}=e,{path:r,parameters:n}=this.props;if(r.pathType===PATH_TYPE.URL){const{value:e}=r;this.setProps({path:{...r,value:e.map((e=>isDynamicValue(e)?replaceDynamicValueDataset(e,t):e))}})}if(n.length>0){const e=n.map((e=>replaceParameterValueData(e,t)));this.setProps({parameters:e})}}onPropsChange(e,t){isEqual$4(e.path,t.path)&&isEqual$4(e.parameters,t.parameters)||this.refresh()}}__decorateClass$H([observable.ref],IframeModel.prototype,"calculateResult");const Iframe=reactExports.forwardRef(((e,t)=>{var r;const{name:n,style:o,method:i}=e,a=reactExports.useRef(null);return reactExports.useEffect((()=>{var e;"POST"===i&&(null==(e=a.current)||e.submit())}),[i,e.url,e.name,"POST"===i?e.parameters:void 0]),jsxs(Fragment,{children:["POST"===i&&jsx("form",{ref:a,target:n,method:"post",action:e.url,children:null==(r=Object.entries(e.parameters))?void 0:r.map((([e,t])=>jsx("input",{type:"hidden",name:encodeURIComponent(e),value:encodeURIComponent(t)},e)))}),jsx("iframe",{ref:t,className:e.className,name:n,title:n,src:"POST"===i?void 0:e.url,"data-src":e.url,style:o})]})}));Iframe.displayName="Iframe";const MOBILE_PARAMS={fine_webView:"true",__pi__:"false"};function getIframeSrc(e,t){return e.value?e.type===PATH_TYPE.TEMPLATE?t(e.value):e.value:""}function dealIframePathAndParams(e,t,r,n){const o=getIframeSrc(e,n),[i,a]=separateUrlAndBodyParams(t);return"POST"===r?{url:o?addSearchParamToUrl(o,a):"",parameters:i,method:r}:{url:o?addSearchParamToUrl(o,{...i,...a}):"",method:r}}function separateUrlAndBodyParams(e){const t=Object.values(MOBILE_UNIQUE_PARAMS);return[Object.fromEntries(Object.entries(e).filter((([e])=>!t.includes(e)))),Object.fromEntries(Object.entries(e).filter((([e])=>t.includes(e))))]}function addMobileParams(e){return dealMobileParams({...e,...MOBILE_PARAMS})}function dealMobileParams(e){if("true"===e[MOBILE_UNIQUE_PARAMS.FORCE_WEB])return e;const t=e[MOBILE_UNIQUE_PARAMS.VIEWLET],r=(null==t?void 0:t.endsWith(".cpt"))||(null==t?void 0:t.endsWith(".frm")),n=e[MOBILE_UNIQUE_PARAMS.OP],o=e[MOBILE_UNIQUE_PARAMS.DISPLAY_PHONE],i=getSearchParamFromUrl(window.location.href,MOBILE_UNIQUE_PARAMS.OP);"h5"!==i||n||(e[MOBILE_UNIQUE_PARAMS.OP]=i);const a=getSearchParamFromUrl(window.location.href,MOBILE_UNIQUE_PARAMS.DISPLAY_PHONE);return a&&!o&&(e[MOBILE_UNIQUE_PARAMS.DISPLAY_PHONE]=a),r?("view"===n&&(e[MOBILE_UNIQUE_PARAMS.BY_PAGE_SIZE]="false"),e[MOBILE_UNIQUE_PARAMS.OP]="write"===n||"h5_write"===n?"h5_write":"h5",e):e}function isSameViewlet(e,t){const r=getSearchParamFromUrl(e,"viewlet"),n=getSearchParamFromUrl(t,"viewlet");return!!r&&!!n&&r===n}function IframeInDesktop(e){const{config:t,state:r}=e,n=useFetcher("executePathInput2Url"),o=reactExports.useMemo((()=>dealIframePathAndParams(t.path,t.parameters,t.method,n)),[t.path,t.parameters,t.method]),i={className:classNames$1("d-iframe",e.className),name:r.name,style:{overflow:t.scrolling?"auto":"hidden"},...o};return jsx(Iframe,{...i})}function IframeInEdit(e){const{t:t}=useI18n();return e.config.path.value?jsx(IframeInDesktop,{...e}):jsx(Empty,{description:t("Duchamp-Please_Add_The_Path_In_The_Right_Configuration_Bar")})}function useIframeKey(e){const[t,r]=reactExports.useReducer((e=>(e+1)%1e6),0);return useUpdateEffect$2((()=>{r()}),[e.method,e.parameters,e.path]),t}function IframeInPreview(e){const{config:t}=e,r=useIframeKey(t);return t.path.value?jsx(IframeInDesktop,{...e},r):jsx(Fragment,{})}const WEB_MESSAGE_TYPES={HEIGHT_AUTO_FIT:0,HYPERLINK:1,REFRESH_TOKEN:2,CLOSE_WEB_PAGE:3};function IframeInMobile(e){var t;const{config:r,state:n}=e,o=useFetcher("executePathInput2Url"),{special:{duchampApi:i}}=useFVS(),[a,s]=reactExports.useState(),l=useLatest$3(r),c=useFrameParentDuchamp$1(i,[]);reactExports.useEffect((()=>{const e=e=>{try{const t=JSON.parse(e.data);if(!t.fine_message)return;const{src:r,contentHeight:n,type:i}=t.fine_message;Number(i)===WEB_MESSAGE_TYPES.HEIGHT_AUTO_FIT&&r&&isSameViewlet(r,getIframeSrc(l.current.path,o))&&s(Number(n))}catch(e3){return}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]);const u=reactExports.useMemo((()=>{const e=dealIframePathAndParams(r.path,{...r.parameters,[MOBILE_UNIQUE_PARAMS.FINE_AUTO_HEIGHT]:"".concat(isNil$4(n.height))},r.method,o);return{...e,url:addSearchParamToUrl(e.url,addMobileParams(parseQueryString(e.url.slice(e.url.indexOf("?")+1))))}}),[r.path,r.parameters,r.method]),d={className:classNames$1("d-iframe-mobile",e.className),name:n.name,style:{width:n.width,height:null!=(t=null==n?void 0:n.height)?t:a,overflow:r.scrolling?"auto":"hidden"},...u};return jsx(Iframe,{ref:c,...d})}function IframeInMobileEdit(e){const{t:t}=useI18n();return e.config.path.value?jsx(IframeInMobile,{...e}):jsx(Empty,{description:t("Duchamp-Please_Add_The_Path_In_The_Right_Configuration_Bar")})}function IframeInMobilePreview(e){const{config:t}=e,r=useIframeKey(t);return t.path.value?jsx(IframeInMobile,{...e},r):jsx(Fragment,{})}const IframeView$1=observer((({model:e})=>{const t=reactExports.useMemo((()=>getIframeConfig(e.props,e.calculateResult)),[e.calculateResult,e.props]),r={name:e.name};return 0===e.calculateResult.size?jsx(Fragment,{}):e.isPreview?jsx(IframeInPreview,{config:t,state:r}):jsx(IframeInEdit,{config:t,state:r})})),IframeView=observer((({model:e,width:t,height:r})=>{const n=reactExports.useMemo((()=>getIframeConfig(e.props,e.calculateResult)),[e.calculateResult,e.props]),o={name:e.name,width:t,height:r};return 0===e.calculateResult.size?jsx(Fragment,{}):jsx(FVSWidgetProvider,{model:e,children:e.isPreview?jsx(IframeInMobilePreview,{config:n,state:o}):jsx(IframeInMobileEdit,{config:n,state:o})})}));function DuchampDynamicValueInput(e){const{crudService:t}=useService(),{supportSummary:r}=settingCenter.getDynamicValueConfig()||{},{value:n,...o}=e;return jsx(DynamicValueInput,{value:toJS(n),...o,fetcher:{getTableInfo:t.getTableInfo,getTableNodeList:t.getTables,searchTable:t.searchTable,getSummaryInfo:r?t.getFieldSummaryInfo:void 0},showFormulaDialog:settingCenter.supportAppService(DUCHAMP_APP_SERVICE.FORMULA)?fvsService.openFormulaEditor:void 0})}function UrlInput(e){return jsx(TextArea,{style:{height:100},...e})}function ImageResourceSelector$1({value:e,title:t=duchampIntl.get("Duchamp-Picture_Type"),className:r,onChange:n}){var o;return jsx(PlatformLineItem,{label:t,children:jsxs(ResourceSelector$1,{value:e,title:t,className:r,onChange:e=>{null==n||n(e)},children:[settingCenter.supportAppService(DUCHAMP_APP_SERVICE.REUSE)&&(null==(o=settingCenter.getResourceConfig())?void 0:o.resourceEnable)?jsx(ResourceSelectorOption,{text:duchampIntl.get("Duchamp-Resource_Center"),value:RESOURCE_TYPE.INTERNAL,children:jsx(DuchampInternalImageResource,{imageScopes:[IMAGE_SCOPE.ICON,IMAGE_SCOPE.DECORATOR]})}):null,jsx(ResourceSelectorOption,{text:duchampIntl.get("Duchamp-Custom_Upload"),value:RESOURCE_TYPE.CUSTOM,children:jsx(DuchampCustomImageResource,{tag:"image",canEdit:!1})}),jsx(ResourceSelectorOption,{text:duchampIntl.get("Duchamp-Online_Pictures"),value:RESOURCE_TYPE.WEBURL,children:isCustomUrlInputValue(e.value)?jsx(DuchampDynamicValueInput,{placeholder:duchampIntl.get("Duchamp-Please_Enter_The_Online_Picture_Address")}):jsx(UrlInput,{placeholder:duchampIntl.get("Duchamp-Please_Enter_The_Online_Picture_Address")})})]})})}const ImageWidgetConfig=observer((({widget:e})=>{const{resourceCenter:t}=useStore(),r=e.model,{asset:n,fillType:o,colorFilter:i}=r.props,a=e=>{r.setPlatformProps(e)};return jsxs(GridItem,{gapSize:GAP_SIZE.MIDDLE,children:[jsx(ImageResourceSelector$1,{value:n,isMobile:r.isMobile,onChange:e=>{e.type===RESOURCE_TYPE.WEBURL&&void 0===e.value&&(e.value=[]),a({asset:e})}}),((e,t)=>{if(!t)return!1;if(t.type===RESOURCE_TYPE.CUSTOM||t.type===RESOURCE_TYPE.INTERNAL){const{imageSource:r}=getImageResource$1(e,t);return!!r}return t.value.length>0})(t,n)&&jsxs(GridItem,{children:[jsx(LineItem,{label:"",children:jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Filling_Method"),children:jsx(RadioGroup$1,{value:o,className:"background-fill-type",options:BACKGROUND_FILL_TYPE_ITEMS,onChange:e=>{a({fillType:e})}})})}),jsx(LineItem,{label:"",children:jsx(FilterProcessPanel,{onChange:e=>{a({colorFilter:{...i,...e}})},...i,layout:"vertical"})})]})]})})),imageWidgetProps={asset:{type:RESOURCE_TYPE.INTERNAL,value:""},fillType:BACKGROUND_FILL_TYPE.AUTO,colorFilter:{hue:0,saturation:0,brightness:0,contrast:0}},IMAGE_WIDGET_META={type:WIDGET_TYPE.IMAGE,widgetType:"multiMedia",displayName:duchampIntl.get("Duchamp-Picture"),version:"0.0.3",iconfont:"icon-picture-components",dragPreviewImage:"/assets/widget/image.svg",refresh:!1,states:{width:320,height:180},configure:{mobile:{magneticHeightRule:"ratio",fluidHeightGrid:FLUID_BLOCK_PARTS},eventTargets:{events:[{trigger:WIDGET_EVENT.CLICK,text:WIDGET_EVENT_MAP.CLICK,actions:defaultActions}]}},props:imageWidgetProps,configuration:e=>jsx(ImageWidgetConfig,{...e})};var __defProp$H=Object.defineProperty,__getOwnPropDesc$E=Object.getOwnPropertyDescriptor,__decorateClass$G=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$E(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$H(t,r,i),i};class ImageModel extends BaseWidgetModel{constructor(){super(...arguments),__publicField(this,"calculateResult",new Map)}getDynamicValues(){const e=[];return Array.isArray(this.props.asset.value)&&this.props.asset.value.forEach((t=>{isDynamicValue(t)&&e.push(t)})),e}handleClick(e){this.widget.trigger({expandIndex:e})}collectResourceIDs(){var e;const{mobile:t,props:r}=this.widget,n=configKit$1.imageResourceType.getResourceConfig(r.asset),o=configKit$1.imageResourceType.getResourceConfig(null==(e=t.props)?void 0:e.asset);return super.collectResourceIDs().concat(n,o).filter(notNil)}get fieldConfigs(){const e=configKit$1.imageResourceType.getComputeConfig({config:this.props.asset});return widgetIsInExpand(this.widget)?removeSummaryConfig(e):e}setFieldValues(e,t){super.setFieldValues(e,t),this.calculateResult=new Map([...this.calculateResult,...e])}onPropsChange(e,t){const{type:r,value:n}=e.asset;isEqual$4(n,t.asset.value)||r!==RESOURCE_TYPE.WEBURL||this.refresh()}mergeProps(e,t){return{...e,...t}}replaceData(e){super.replaceData(e);const t=toJS(this.widget.props),{value:r,type:n}=t.asset;n===RESOURCE_TYPE.WEBURL&&isHasDynamicValue(r)&&this.setProps({asset:{type:n,value:r.map((t=>isDynamicValue(t)?replaceDynamicValueDataset(t,e.replacement):t))}});const o=toJS(this.widget.platform.mobile.props);if(o.asset){const{value:t,type:r}=o.asset;if(r===RESOURCE_TYPE.WEBURL&&isHasDynamicValue(t)){const n={asset:{type:r,value:t.map((t=>isDynamicValue(t)?replaceDynamicValueDataset(t,e.replacement):t))}};this.setMobileProps(n)}}}}function getImageStyle(e){var t;return{width:"100%",height:"100%",...e.colorFilter?getFilterStyle(e.colorFilter):null,...convertBackgroundStyle({imageSource:null!=(t=e.asset)?t:"",backgroundFillType:e.fillType})}}function ImageInPreview(e){const{config:t,events:r}=e;return jsx("div",{className:"d-image",children:jsx("div",{onClick:null==r?void 0:r.onClick,className:classNames$1({"duchamp-hover-pointer":!!(null==r?void 0:r.onClick)}),style:getImageStyle(t)})})}function ImageInEdit(e){const{t:t}=useI18n();return e.config.asset?jsx(ImageInPreview,{...e}):jsx(Empty,{description:t("Duchamp-Add_Picture_In_Configuration_Column_On_Right")})}function getResourceConfig(e,t){const{type:r}=e;return r===RESOURCE_TYPE.INTERNAL||r===RESOURCE_TYPE.CUSTOM?new ResourceHandler(t,fvsService.getEnvInfo().resourceBaseUrl).getResources([e.value]):{}}function getImageConfig(e,t,r){const{props:n,calculateResult:o}=e,{fillType:i,colorFilter:a}=n;return{asset:configKit$1.imageResourceType.transform({config:n.asset,compute:{computedResult:o,index:null!=r?r:0},resource:getResourceConfig(n.asset,e.store.resourceCenter),env:t}),fillType:i,colorFilter:a}}__decorateClass$G([jsApi("trigger")],ImageModel.prototype,"handleClick",1),__decorateClass$G([observable.ref],ImageModel.prototype,"calculateResult",2);const ImageView=observer((({model:e,expandIndex:t})=>{const r=useEnv(),n=getImageConfig(e,r,t),o=e.isHoverPointer?{onClick:()=>{e.handleClick(t)}}:{};return e.isPreview?jsx(ImageInPreview,{config:n,events:o}):jsx(ImageInEdit,{config:n,events:o})})),{Link:Link$2}=Typography;function ProtocolSelect(e){const{value:t,onChange:r,options:n,style:o}=e,[i,a]=reactExports.useState(null),s=()=>jsxs("div",{children:[duchampIntl.get("Duchamp-Install_Streaming_Media_Plugin_Required"),jsx(Link$2,{href:duchampIntl.get("Duchamp-Live_Video_Protocol_Help_Link"),target:"_blank",children:duchampIntl.get("Duchamp-View_Help_Doc")})]});return jsx(Select$1,{style:o,value:t,options:n,onSelect:async e=>{if("HLS"!==e){if(i){await i?r(e):Alert$2.confirm({title:duchampIntl.get("Duchamp-Install_Streaming_Media_Plugin"),content:jsx(s,{}),text4Ok:duchampIntl.get("Duchamp-Go_Install"),onOk:()=>{fvsService.openPluginManager()},onCancel:()=>{r("HLS")}})}}else r("HLS")},onDropdownVisibleChange:e=>{if(e){const e=fvsService.hasMonitorVideoEnv();a(e)}}})}formItemManager.register("d-live-video-protocol",ProtocolSelect),formItemManager.register("dynamic-value-input",DuchampDynamicValueInput);const liveVideoWidgetProps={src:[],videoType:"HLS",fillType:"contain",controls:!1,volume:0},LIVE_VIDEO_WIDGET_META={type:WIDGET_TYPE.LIVE_VIDEO,widgetType:"multiMedia",displayName:duchampIntl.get("Duchamp-Surveillance_Video"),version:"0.0.2",iconfont:"icon-a-surveillance-video-components",dragPreviewImage:"/assets/widget/live_video.svg",refresh:!1,states:{width:320,height:180},props:liveVideoWidgetProps,configuration:[{name:"src",displayName:duchampIntl.get("Duchamp-Monitoring_Address"),className:"live-video-config",value:[],type:"dynamic-value-input",placeholder:duchampIntl.get("Duchamp-Live_Video_Source_Placeholder"),style:{height:100}},{name:"videoType",displayName:duchampIntl.get("Duchamp-Video_Type"),value:"HLS",type:"d-live-video-protocol",options:[{value:"HLS",label:"HLS"},{value:"RTSP",label:"RTSP"},{value:"RTMP",label:"RTMP"}],style:{width:"100%"}},{name:"fillType",displayName:duchampIntl.get("Duchamp-Filling_Method"),value:"contain",type:"radioGroup",buttonStyle:"solid",optionType:"button",options:[{label:duchampIntl.get("Duchamp-Adapt"),value:"contain"},{label:duchampIntl.get("Duchamp-Stretch"),value:"fill"}]},{name:"controls",displayName:duchampIntl.get("Duchamp-Toolbar"),value:!1,type:"checkbox",text:duchampIntl.get("Duchamp-Show_Video_Toolbar")},{name:"volume",displayName:duchampIntl.get("Duchamp-Initial_Volume"),className:"live-video-config",value:0,type:"sliderInput",min:0,max:100,suffix:"%"}],configure:{mobile:{magneticHeightRule:"ratio",fluidHeightGrid:FLUID_BLOCK_PARTS}}},LIVE_VIDEO_FORMULA_KEY="src",getLiveVideoConfig=(e,t)=>{const{props:r,calculateResult:n}=e,{videoType:o,fillType:i,controls:a,volume:s,src:l}=r;return{src:configKit$1.multiDynamicValue.transform({config:toJS(l),compute:{computedResult:n,key:LIVE_VIDEO_FORMULA_KEY,index:0}}),videoType:o,fillType:i,controls:a,volume:s,onError:t=>e.processWidgetError(t),transport:t}};var __defProp$G=Object.defineProperty,__decorateClass$F=(e,t,r,n)=>{for(var o,i=void 0,a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$G(t,r,i),i};class LiveVideoModel extends BaseWidgetModel{constructor(){super(...arguments),__publicField(this,"calculateResult",new Map)}get fieldConfigs(){return configKit$1.multiDynamicValue.getComputeConfig({config:this.props.src,options:{key:LIVE_VIDEO_FORMULA_KEY}})}setFieldValues(e,t){super.setFieldValues(e,t),this.calculateResult=new Map([...this.calculateResult,...e])}setWidgetError(e){this.widget.setWidgetError({...e,errorType:"warning"})}replaceData(e){super.replaceData(e);const{src:t}=this.props;isStringArray(t)||this.setProps({src:t.map((t=>isDynamicValue(t)?replaceDynamicValueDataset(t,e.replacement):t))})}onPropsChange(e,t){isEqual$4(e.src,t.src)||isStringArray(e.src)||this.refresh()}}__decorateClass$F([observable.ref],LiveVideoModel.prototype,"calculateResult");const LiveVideoInEdit=({config:e})=>{const{t:t}=useI18n(),r=useAssetUrl("/system/video_default.png"),{src:n,fillType:o}=e;return jsx(Empty,void 0===n?{description:t("Duchamp-Live_Video_Empty_Tip")}:{isReactSvg:!1,image:r,imageStyle:{objectFit:o}})},BaseVideo=reactExports.lazy((()=>__vitePreload((()=>import("./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/BaseVideo-hash-C8B8pX0X.js")),__vite__mapDeps([13,3,4,6,7,8,14]),import.meta.url).then((e=>({default:e.BaseVideo}))))),LazyBaseVideo=e=>jsx(reactExports.Suspense,{children:jsx(BaseVideo,{...e})}),LiveVideoPlayer=reactExports.lazy((()=>__vitePreload((()=>import("./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/LiveVideoPlayer-hash-D66hhqyi.js")),__vite__mapDeps([15,3,4,16,6,7,8,17]),import.meta.url).then((e=>({default:e.LiveVideoPlayer}))))),LazyLiveVideoPlayer=e=>jsx(reactExports.Suspense,{children:jsx(LiveVideoPlayer,{...e})}),SOCKET_EVENT={VIDEO:"video",RETRY:"retry"},ERROR_RETRY_COUNT_LIMIT=5,LIVE_VIDEO_TYPE={HLS:"HLS",RTSP:"RTSP",RTMP:"RTMP"},LiveVideoInPreview=({config:e})=>{const{videoType:t,src:r="",fillType:n,volume:o=0,controls:i}=e;if(!r)return jsx(Fragment,{});if(t===LIVE_VIDEO_TYPE.HLS){return jsx(LazyBaseVideo,{options:{src:r,volume:o/100,controls:i,autoplay:!0,responsive:!0,fluid:!1,bigPlayButton:!1,muted:!0,playsinline:!0,controlBar:{children:[{name:"playToggle"},{name:"volumePanel",inline:!1},{name:"fullscreenToggle"}]}},style:{objectFit:n}})}return jsx(LazyLiveVideoPlayer,{...e})},LiveVideoInMobilePreview=({config:e})=>e.src?jsx("div",{className:"fvs-mobile-live-video-widget",children:jsx(LiveVideoInPreview,{config:e})}):jsx(Fragment,{}),LiveVideo$1=observer((({model:e})=>{const t=useStore(),r=getLiveVideoConfig(e,t.transport);return e.isPreview?jsx(LiveVideoInPreview,{config:r}):jsx(LiveVideoInEdit,{config:r})})),LiveVideo=observer((({model:e})=>{const{transport:t}=useStore(),r=getLiveVideoConfig(e,t);return e.isPreview?jsx(LiveVideoInMobilePreview,{config:r}):jsx(LiveVideoInEdit,{config:r})}));function VideoResourceSelector({value:e,type:t="video",title:r,className:n,onChange:o,container:i,mask:a=!0}){const{resourceCenter:s,videoReuse:l,reuseService:c}=useStore(),u=c.isAppReuseMode()?{customResourcePane:jsx(SuspenseProcessReusePaneWrapper,{manager:l}),drawerWidth:480}:{};return jsx(LineItem,{label:r,children:jsxs(ResourceSelector$1,{style:{flex:1},value:e,className:n,onChange:e=>{null==o||o(e)},children:[jsx(ResourceSelectorOption,{text:duchampIntl.get("Duchamp-Resource_Center"),value:RESOURCE_TYPE.INTERNAL,children:jsx(InternalVideo,{type:t,getResourceUrl:createResourceURL,readResource:useService().reuseService.readReuseResource,resourceCenter:s,videoReuse:l,drawerContainer:i,mask:a,...u})}),jsx(ResourceSelectorOption,{text:duchampIntl.get("Duchamp-Custom_Upload"),value:RESOURCE_TYPE.CUSTOM,children:jsx(CustomVideoResource,{defaultResource:{id:"",type:"video",name:""},resourceCenter:s,getResourceUrl:createResourceURL,drawerContainer:i,mask:a,placeholderIcon:createAbsoluteUrl("/assets/system/empty_video_thumb.svg"),emptyIcon:createAbsoluteUrl("/assets/system/empty_video.svg"),imageNode:(e,t)=>imageNodeCreator(e,(()=>createResourceURL(getImageSourceNameFromResource(e,s))),(()=>{null==t||t(e)}))})}),jsx(ResourceSelectorOption,{text:duchampIntl.get("Duchamp-Online_Video"),value:RESOURCE_TYPE.WEBURL,children:isCustomUrlInputValue(e.value)?jsx(DuchampDynamicValueInput,{placeholder:duchampIntl.get("Duchamp-Please_Enter_The_Online_Video_Address")}):jsx(UrlInput,{placeholder:duchampIntl.get("Duchamp-Please_Enter_The_Online_Video_Address")})})]})})}function getSourceFromResource(e,t){if(!t)return"";if(t.type===RESOURCE_TYPE.INTERNAL||t.type===RESOURCE_TYPE.CUSTOM){const{imageSource:r}=getImageResource$1(e,t);return r&&createResourceURL(r)}return t.value}function getDurationFromResource(e,t){if(t&&(t.type===RESOURCE_TYPE.CUSTOM||t.type===RESOURCE_TYPE.INTERNAL)){const r=getResourceInfoByID(t.value,e);if(!r)return;return Math.floor(getPayload$2(r,"duration")||0)}}const imageNodeCreator=(e,t,r)=>{var n;return jsxs("div",{className:"video-image-list-item",children:[jsx(FvsImage,{src:t(),wrapperClassName:"video-image-wrapper",height:75,hoverPreview:{contentStyle:{width:232,height:150}}}),jsx("div",{className:"duration",onClick:r,children:configKit$1.videoResourceType.utils.getDuration(null==(n=null==e?void 0:e.payload)?void 0:n.duration)})]})},LocalVideoConfig=observer((({widget:e})=>{const t=e.props,{asset:r,fillType:n,colorFilter:o,controls:i,autoPlay:a,loop:s,volume:l}=t;if(!e)return jsx(Fragment,{});const c=t=>{e.setValue(t)};return jsx("div",{className:"local-video-config",children:jsxs(GridItem,{children:[jsx(VideoResourceSelector,{value:r,onChange:e=>{e.type===RESOURCE_TYPE.WEBURL&&void 0===e.value&&(e.value=[]),c({asset:e})},title:duchampIntl.get("Duchamp-Video_Type")}),jsx(LineItem,{label:"",children:jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Filling_Method"),children:jsx(RadioGroup$1,{options:[{label:duchampIntl.get("Duchamp-Adapt"),value:"contain"},{label:duchampIntl.get("Duchamp-Stretch"),value:"fill"}],value:n,onChange:e=>c({fillType:e})})})}),jsx(LineItem,{label:"",children:jsx(FilterProcessPanel,{hue:o.hue,contrast:o.contrast,saturation:o.saturation,brightness:o.brightness,onChange:e=>{c({colorFilter:{...o,...e}})},layout:"vertical"})}),jsx(LineItem,{label:duchampIntl.get("Duchamp-Toolbar"),children:jsx(Checkbox$4,{text:duchampIntl.get("Duchamp-Show_Video_Toolbar"),value:i,onChange:e=>c({controls:e})})}),jsx(LineItem,{label:duchampIntl.get("Duchamp-Play_Settings"),children:jsxs("div",{style:{display:"flex",alignItems:"center"},children:[jsx(Checkbox$4,{text:duchampIntl.get("Duchamp-Auto_Play_On_Current_Page"),value:a,onChange:e=>c({autoPlay:e})}),jsx(IconPopover,{icon:"icon-help",text:duchampIntl.get("Duchamp-Need_Use_Chrome_Browser_And_Adjust_Configuration"),link:duchampIntl.get("Duchamp-Local_Video_Auto_Play_Help_Link"),linkText:duchampIntl.get("Duchamp-View_The_Help_Document"),placement:"bottom-right"})]})}),jsx(LineItem,{label:"",children:jsx(Checkbox$4,{text:duchampIntl.get("Duchamp-Loop"),value:s,onChange:e=>c({loop:e})})}),jsx(SliderInputItem,{label:duchampIntl.get("Duchamp-Initial_Volume"),suffix:"%",value:l,onChange:e=>c({volume:e})})]})})})),LOCAL_VIDEO_WIDGET_META={type:WIDGET_TYPE.LOCAL_VIDEO,widgetType:"multiMedia",displayName:duchampIntl.get("Duchamp-Local_Video"),version:"0.0.3",iconfont:"icon-local-video-components",dragPreviewImage:"/assets/widget/local_video.svg",refresh:!1,states:{width:320,height:180},configure:{mobile:{magneticHeightRule:"ratio",fluidHeightGrid:FLUID_BLOCK_PARTS}},props:{asset:{type:RESOURCE_TYPE.INTERNAL,value:""},fillType:"contain",colorFilter:{hue:0,saturation:0,brightness:0,contrast:0},controls:!1,autoPlay:!0,loop:!1,volume:0},configuration:e=>jsx(LocalVideoConfig,{...e})};var __defProp$F=Object.defineProperty,__decorateClass$E=(e,t,r,n)=>{for(var o,i=void 0,a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$F(t,r,i),i};class LocalVideoModel extends BaseWidgetModel{constructor(){super(...arguments),__publicField(this,"calculateResult",new Map)}collectResourceIDs(){const e=configKit$1.videoResourceType.getResourceConfig(this.widget.props.asset);return super.collectResourceIDs().concat(e)}get fieldConfigs(){return configKit$1.videoResourceType.getComputeConfig({config:this.props.asset})}setFieldValues(e,t){super.setFieldValues(e,t),this.calculateResult=new Map([...this.calculateResult,...e])}onPropsChange(e,t){const{type:r,value:n}=e.asset;isEqual$4(n,t.asset.value)||r!==RESOURCE_TYPE.WEBURL||this.refresh()}replaceData(e){super.replaceData(e);const{value:t}=this.props.asset;Array.isArray(t)&&!isStringArray(t)&&this.setProps({asset:{type:RESOURCE_TYPE.WEBURL,value:t.map((t=>isDynamicValue(t)?replaceDynamicValueDataset(t,e.replacement):t))}})}}__decorateClass$E([observable.ref],LocalVideoModel.prototype,"calculateResult");const MEDIA_FIT={CONTAIN:"contain",FILL:"fill"},getPosterStyle=({asset:e,fillType:t})=>{const{poster:r}=e;return r?convertBackgroundStyle({imageSource:r,backgroundFillType:t===MEDIA_FIT.CONTAIN?BACKGROUND_FILL_TYPE.AUTO:BACKGROUND_FILL_TYPE.STRETCH}):{}},getColorFilterStyle=({colorFilter:e})=>e?getFilterStyle(e):{},getLocalVideoInEditStyle=e=>({...getPosterStyle(e),...getColorFilterStyle(e)}),getLocalVideoInPreviewStyle=e=>({objectFit:e.fillType,...getColorFilterStyle(e)}),getControlsStyle=e=>convertBorderImageStyle({imageSource:e,imageSlice:[0,30,0,30],borderScale:1}),LocalVideoInEdit=({config:e})=>{const{t:t}=useI18n(),r=useAssetUrl("/system/video_default.png");return void 0===e.asset.src?jsx(Empty,{description:t("Duchamp-Please_Select_A_Video_On_The_Right")}):(e.asset.poster||(e.asset.poster=r),jsx("div",{className:"d-local-video-edit",style:getLocalVideoInEditStyle(e),children:e.controls&&jsx(LocalVideoControls,{config:e})}))},LocalVideoControls=({config:e})=>{const{asset:t,volume:r}=e,{duration:n}=t,o=useAssetUrl("/system/video_tool.png");return jsxs("div",{className:"d-video-controls",style:getControlsStyle(o),children:[n&&jsxs("div",{className:"duration",children:["00:00 / ",jsx("span",{children:n})]}),jsx(Icon$2,{type:0===r?"icon-mute":"icon-sound"})]})},LocalVideoInPreview=({config:e})=>{const{asset:t,volume:r=0,autoPlay:n=!1,controls:o=!1,loop:i=!1}=e;if(!t.src)return jsx(Fragment,{});const a={src:t.src,volume:r/100,muted:0===r,autoplay:n,responsive:!0,fluid:!1,controls:o,loop:i,playsinline:!0,bigPlayButton:!0,controlBar:{children:[{name:"playToggle"},{name:"currentTimeDisplay"},{name:"timeDivider"},{name:"durationDisplay"},{name:"progressControl"},{name:"volumePanel",inline:!1},{name:"fullscreenToggle"}]},userActions:{doubleClick:!1}};return jsx(LazyBaseVideo,{options:a,style:getLocalVideoInPreviewStyle(e)})},LocalVideoInMobilePreview=({config:e})=>{const{asset:t,controls:r,autoPlay:n,fillType:o,loop:i,volume:a=0}=e,{src:s}=t;return s?jsx("div",{className:"d-local-video-mobile-preview",children:jsx(Video,{src:s,controls:r,fit:o,autoPlay:n,loop:i,volume:a/100,playsInline:!0,style:getColorFilterStyle(e)})}):jsx(Fragment,{})},getLocalVideoConfig=(e,t)=>{const{props:r,calculateResult:n}=e,{fillType:o,controls:i,autoPlay:a,loop:s,volume:l,colorFilter:c}=toJS(r);return{asset:configKit$1.videoResourceType.transform({config:r.asset,compute:{computedResult:n,index:0},resource:getResourceConfig(r.asset,e.store.resourceCenter),env:t}),fillType:o,colorFilter:c,controls:i,volume:l,loop:s,autoPlay:a}},LocalVideoView$1=observer((({model:e})=>{const{isPreview:t}=e,r=useEnv();return jsx(t?LocalVideoInPreview:LocalVideoInEdit,{config:getLocalVideoConfig(e,r)})})),LocalVideoView=observer((({model:e})=>{const{isPreview:t}=e,r=useEnv();return jsx(t?LocalVideoInMobilePreview:LocalVideoInEdit,{config:getLocalVideoConfig(e,r)})})),FormContext=reactExports.createContext(null),useSchemaForm=()=>{const e=reactExports.useContext(FormContext);return{...e,widgets:(null==e?void 0:e.widgets)||{},getData:t=>get$5(null==e?void 0:e.value,t),setData:(t,r)=>{e&&e.setData(t,r)}}},SchemaFormProvider=({value:e,children:t})=>{const[r,n]=useUpdateValue$1({...e,value:e.value||{}},[e]);return jsx(FormContext.Provider,{value:{...r,setData:(t,o)=>{var i;set$3(r.value,t,o),null==(i=e.onChange)||i.call(e,r.value,t,o),n({...r,value:r.value})}},children:t})},isExpression=e=>{if("string"!=typeof e)return!1;return e.trim().match(/^{\s*{(.+)}\s*}$/)&&!e.trim().match(/^{\s*{function\(.+}\s*}$/)};function transformFormulaString(e,t={}){if("string"!=typeof e)return!!e;const r=e.replace(/^{\s*{/g,"").replace(/}\s*}$/g,"").trim(),n="\n    return ".concat(r.replace(/formData/g,JSON.stringify(t)),"\n  ");try{return Function(n)()}catch(e3){return!1}}const sortProperties=(e,t="order")=>{const r=new Map,n=[];e.forEach((e=>(e=>{const[,o]=e;"number"==typeof o[t]?r.has(o[t])?r.get(o[t]).push(e):r.set(o[t],[e]):n.push(e)})(e)));return Array.from(r.entries()).sort((([e],[t])=>e-t)).flatMap((([,e])=>e)).concat(n)},FieldWrapper=({schema:e,children:t})=>isNil$3(e.title)?jsx("div",{className:"schema-form-field",children:t}):jsx(LineItem,{className:"schema-form-field",prefix:e.prefixIcon&&(e.prefixIconText?jsx(IconPopover,{icon:e.prefixIcon,text:e.prefixIconText}):jsx(Icon$2,{type:e.prefixIcon})),label:e.title,children:t}),withFieldWrapper=e=>function({schema:t,path:r,...n}){const{getData:o,setData:i,value:a}=useSchemaForm(),s=transformFormulaString(t.hidden||"",a),l={};return each$3(t.props,((e,t)=>{isExpression(e)&&(l[t]=transformFormulaString(e,a))})),s?null:jsx(FieldWrapper,{schema:t,children:jsx(e,{schema:t,path:r,...n,...l,value:o(r),onChange:e=>{i(r,e)}})})},FieldItem=({schema:e,children:t,path:r,renderCore:n})=>{const{widgets:o}=useSchemaForm(),{widget:i,props:a}=e;if(!i||!o[i])return null;const s=o[i];return jsx(s,{...a,path:r,schema:e,renderCore:n,children:t})},FieldList=({schema:e,path:t,renderCore:r})=>{const{widgets:n}=useSchemaForm(),{widget:o,props:i}=e;if(!o||!n[o])return null;const a=n[o];return jsx(a,{...i,path:t,schema:e,renderCore:r})},renderItem=({schema:e,path:t,key:r})=>{var n;if("array"===e.type&&"object"===(null==(n=e.items)?void 0:n.type))return jsx(FieldList,{schema:e,path:t,renderCore:renderCore},r);let o=null;return(null==e?void 0:e.properties)&&(o=renderCore({schema:e,path:t})),jsx(FieldItem,{schema:e,path:t,renderCore:renderCore,children:o},r)},renderCore=({path:e,schema:t})=>t&&0!==Object.keys(t).length?sortProperties(Object.entries(t.properties||{})).map((([t,r])=>renderItem({schema:r,path:[...e,t],key:t}))):null,Card=({direction:e="row",children:t})=>jsx("div",{className:classNames$1("schema-form-card",e),style:{flexDirection:e},children:t});function Collapse({children:e,description:t,open:r=!0}){return jsx(CollapseGroup,{defaultActiveKey:r?["1"]:[],items:[{key:"1",label:t,children:e}]})}const ToggleGroup=({options:e,children:t})=>{const[r,n]=useUpdateValue$1(null==e?void 0:e[0].value,e);return jsxs(Fragment,{children:[jsx(RadioGroup$1,{value:r,options:e,onChange:e=>{n(e)},style:{marginBottom:8}}),t(r)]})},ToggleLayout$1=({options:e,renderCore:t,schema:r,path:n})=>jsx(ToggleGroup,{options:e||[],children:e=>jsx(Fragment,{children:t({schema:r.items,path:[...n,e]})})}),DEFAULT_WIDGETS={checkbox:Checkbox$4,colorSelect:ThemeColorPicker,select:AsyncSelect,input:ValidationInput,card:Card,collapse:Collapse,toggleLayout:ToggleLayout$1},SchemaForm=({schema:e,onChange:t,widgets:r,value:n})=>{const o=cloneDeep$2(n),{properties:i}=e;o&&each$3(i,((e,t)=>{var r,n;(null==(r=e.props)?void 0:r.value)&&set$3(o,t,null!=(n=get$5(o,t))?n:e.props.value)}));const a=reactExports.useMemo((()=>mapValues$1({...DEFAULT_WIDGETS,...r},(e=>withFieldWrapper(e)))),[r]);return jsx(SchemaFormProvider,{value:{schema:e,onChange:t,value:o,widgets:a},children:jsx("div",{className:"schema-form",children:renderCore({schema:e,path:[]})})})},QUERY_PROPERTY_CONFIG={relationWidget:RelationWidgetConfig,fontStyle:FontStyleConfig,fontSelect:FontSelect},QueryConfig=observer((({widget:e})=>{const t=e.getInstance(),r={type:"object",properties:{value:{title:duchampIntl.get("Duchamp-Button_Value"),widget:"input"},relationWidgetIds:{title:duchampIntl.get("Duchamp-Relation_Controller"),widget:"relationWidget",props:{options:t.optionalWidgets}},fontAttr:{widget:"collapse",props:{description:duchampIntl.get("Duchamp-Content_Style")},properties:{fontFamily:{title:duchampIntl.get("Duchamp-Font_Style"),widget:"fontSelect"},fontStyle:{title:"",widget:"fontStyle",props:{style:{width:"100%"},showTypes:{bold:!0,italic:!0},icon:jsx(PlatformPopoverIcon,{}),mobileProperties:["fontSize"]}},color:{title:"",widget:"colorSelect",props:{style:{width:"100%"}}}}}}};return jsx("div",{className:"query-widget-config",children:jsx(SchemaForm,{schema:r,onChange:e=>{t.setConfigurationConfig(e)},widgets:QUERY_PROPERTY_CONFIG,value:cloneDeep$2(t.getConfigurationConfig())})})}));function RelationWidgetConfig(e){return jsx("div",{className:"relation-widget-config",children:jsx(CheckboxGroup,{...e})})}const QUERY_BUTTON_WIDGET_META={type:WIDGET_TYPE.QUERY_BUTTON,displayName:duchampIntl.get("Duchamp-Query"),version:"0.0.1",iconfont:"icon-Inquire-components",dragPreviewImage:"/assets/widget/query.svg",mainGroupName:"controller",states:{width:48,height:28},props:{value:duchampIntl.get("Duchamp-Query"),notRelationWidgetIds:[],fontFamily:TEXT.FONT_FAMILY,fontStyle:{fontSize:12},color:"#FFFFFF"},configure:{countLimit:1,mobile:{fluidHeightGrid:FLUID_LINE_PARTS},eventTargets:{events:[{trigger:WIDGET_EVENT.CLICK,text:WIDGET_EVENT_MAP.CLICK,actions:defaultActions}]}},refresh:!1,configuration:e=>jsx(QueryConfig,{...e})};function content(e){return function(t,r,n){const o=e||r,[i,...a]=o;return t.contentProperties={...t.contentProperties,[o]:{get:n.get,set:t["set".concat(i.toUpperCase()).concat(a.join(""))]}},n}}const PLATFORM={PC:"pc",MOBILE:"mobile"},DEFAULT_BACKGROUND_COLOR="#100B2B",THEME_DEFAULT_LABEL_CONFIG={border:{type:RESOURCE_TYPE.EMPTY},borderHue:0,borderOpacity:100,borderSaturation:0,borderContrast:0,borderBrightness:0,borderScale:1,backgroundFillType:BACKGROUND_FILL_TYPE.AUTO,fillType:FILL_TYPE.BACKGROUND,fontFamily:TEXT.FONT_FAMILY,fontAttr:{fontSize:14,fontWeight:"bold"},color:getThemeVariableColor(PREFIX_THEME_KEY,TEMPLATE_THEME_DEFAULT_COLOR_ROW,TEMPLATE_THEME_DEFAULT_COLOR_TEXT_COL),icon:{type:RESOURCE_TYPE.EMPTY}},THEME_DEFAULT_CONFIG={title:"",groupColor:{palette:"custom",colors:["#116EFF","#75C9FF","#6E7AEB","#1853AC","#44C1C9","#EDDD86","#EFA666","#00B2FF","#7CD6CF","#7898E1"]},backgroundColor:"#000000",textColor:"#FFFFFF",background:{type:"color",value:DEFAULT_BACKGROUND_COLOR},label:THEME_DEFAULT_LABEL_CONFIG},WIDGET_STATE_DEFAULT_CONFIG={border:{type:"empty"},borderHue:0,borderOpacity:100,borderSaturation:0,borderContrast:0,borderBrightness:0,borderScale:1,backgroundFillType:BACKGROUND_FILL_TYPE.AUTO,fillType:FILL_TYPE.BACKGROUND,opacity:100,borderLine:{borderColor:"#ADADADFF"}},WIDGET_CONTROLLER_DEFAULT_CONFIG={styleConfig:{fontFamily:TEXT.FONT_FAMILY,fontAttr:{fontSize:12},color:DEFAULT_SINGLE_COLOR$1,iconColor:DEFAULT_SINGLE_COLOR$1,highlightColor:DEFAULT_SINGLE_COLOR$1}},CHART_BACKGROUND_TYPE={EMPTY:"empty",SINGLE_COLOR:"singleColor",LINEAR_GRADIENT_COLOR:"linearGradientColor"},WIDGET_CHART_DEFAULT_CONFIG={axis:{lineColor:"#cccccc",title:{fontFamily:TEXT.FONT_FAMILY,color:DEFAULT_SINGLE_COLOR$1},label:{fontFamily:TEXT.FONT_FAMILY,color:DEFAULT_SINGLE_COLOR$1}},drawingArea:{lineColor:DEFAULT_BACKGROUND_COLOR},label:{fontFamily:TEXT.FONT_FAMILY,color:DEFAULT_SINGLE_COLOR$1,fontType:"preset"},legend:{fontFamily:TEXT.FONT_FAMILY,color:DEFAULT_SINGLE_COLOR$1},tooltip:{lineColor:DEFAULT_BACKGROUND_COLOR,lineWidth:0,background:{type:CHART_BACKGROUND_TYPE.EMPTY,opacity:100,boxShadow:!0},fontFamily:TEXT.FONT_FAMILY,color:DEFAULT_SINGLE_COLOR$1,fontType:"preset"},series:{scheme:{groupColor:{colors:["#116EFF","#75C9FF","#6E7AEB","#1853AC","#44C1C9","#EDDD86","#EFA666","#00B2FF"],palette:"custom"},linearGradientColor:{colors:[{value:"#116EFF",position:"0"},{value:"#75C9FF",position:"100%"}],angle:0,palette:"custom"}}}},MAX_HISTORY_COLOR_OPTIONS=20,TEMPLATE_RELATION_TABLE_STYLE={CLASSIC:"classic",SIMPLE:"simple",SLIM:"slim"},TEMPLATE_RELATION_TABLE_ALIGNMENT={LEFT:"left",CENTER:"center",RIGHT:"right"},WIDGET_RELATION_DEFAULT_CONFIG={chartGroupColors:{colors:[{value:"#116EFF"},{value:"#75C9FF"},{value:"#6E7AEB"},{value:"#1853AC"},{value:"#44C1C9"},{value:"#EDDD86"},{value:"#EFA666"},{value:"#00B2FF"},{value:"#7CD6CF"},{value:"#7898E1"}],palette:"custom"},chartLinearGradientColor:{colors:[{value:DEFAULT_START_GRADIENT_COLOR$1,position:"0"},{value:DEFAULT_END_GRADIENT_COLOR$1,position:"100%"}],angle:0},tableStyle:TEMPLATE_RELATION_TABLE_STYLE.CLASSIC,tableAlignment:TEMPLATE_RELATION_TABLE_ALIGNMENT.LEFT,tablePrimaryColor:"#116EFF"},APP_SHARE_FUNCTIONS={LINEAGE:"CONSANGUINITY",REUSE_GUIDE:"REUSE_GUIDE",REUSE_GUIDE_V2:"REUSE_GUIDE_V2",REPLACE_DATASET:"REPLACE_DATASET"},REPLACE_DATASET_ENTRANCE={REUSE_GUIDE:"4",DATA_LINEAGE:"3"},isLayoutConfiguration=e=>!isNil$3(e.children),getConfigurationByProperty=(e,t)=>{const r={};return e.some((e=>{if(isLayoutConfiguration(e)){let n;if("toggleLayout"===e.type){(e.options||[]).some((r=>{const o=r.value?"".concat(r.value,"."):"";return t.startsWith(r.value)&&(n=getConfigurationByProperty(e.children,t.slice(o.length))),!!(null==n?void 0:n.configuration)}))}else n=getConfigurationByProperty(e.children,t);(null==n?void 0:n.configuration)&&(r.configuration=n.configuration,!r.platforms&&(r.platforms=e.platforms||n.platforms))}else e.name===t&&(r.configuration=e,!r.platforms&&(r.platforms=e.platforms));return!!r.configuration})),r},transformConfigurationValue=({name:e,value:t,configuration:r,lastPCProps:n,lastMobileProps:o,isMobile:i})=>{const{configuration:a,platforms:s=[]}=getConfigurationByProperty(r,e);if(!a)return{};const{mobileValueTransfer:l,mobileProperties:c}=a,u=get$5(n,e),d=get$5(o,e);return l?l({value:t,lastPCValue:u,lastMobileValue:d,isMobile:i}):i&&c&&isObject$e(t)?transformValueToPlatformValue({value:t,lastPCValue:u||{},lastMobileValue:d||{},mobileProperties:c}):i&&s.includes(PLATFORM.MOBILE)?{mobile:t}:{pc:t}};function transformValueToPlatformValue({value:e,lastPCValue:t,lastMobileValue:r,mobileProperties:n}){const o=Object.keys(e),i={},a={};return o.forEach((o=>{!n.includes(o)||isNil$3(r[o])&&t[o]===e[o]?i[o]=e[o]:(a[o]=e[o],i[o]=t[o])})),{pc:i,mobile:a}}var __defProp$E=Object.defineProperty,__getOwnPropDesc$D=Object.getOwnPropertyDescriptor,__decorateClass$D=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$D(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$E(t,r,i),i};class QueryButtonModel extends BaseWidgetModel{get controlInstances(){var e,t;return null!=(t=null==(e=this.widget.story)?void 0:e.getParameterableInstances())?t:[]}async queryParameters(){if((await Promise.all(this.relationWidgets.map((e=>e.checkValue())))).some((e=>!e)))return;const e=[],t=new Filter("and");this.relationWidgets.forEach((r=>{t.updateFilterValues(r.getFilter().getFilters()),e.push(r.id)})),this.duchampServer.calculateCenter.linkageGlobal(t,e)}get optionalWidgets(){return this.controlInstances.reverse().map((e=>({label:e.name,value:e.id})))}get relationWidgets(){const{notRelationWidgetIds:e}=this.props;return this.controlInstances.filter((t=>!e.includes(t.id)))}get relationWidgetIds(){return this.relationWidgets.map((e=>e.id))}setRelationWidgetIds(e){const t=this.controlInstances.map((e=>e.id)).filter((t=>!e.includes(t)));this.setProps({notRelationWidgetIds:t})}get value(){return this.props.value}setValue(e){this.setProps({value:e})}get fontAttr(){const{fontFamily:e,fontStyle:t,color:r}=this.props;return{fontFamily:e,fontStyle:t,color:r}}setFontAttr(e){const{fontStyle:t,fontFamily:r,color:n}=e;this.setProps({fontFamily:r,color:n}),this.isMobile?this.setMobileFontStyle(t):this.setProps({fontStyle:t})}handleClick(){this.isPreview&&this.queryParameters(),this.widget.trigger()}setMobileFontStyle(e){const{mobile:t,pc:r}=transformValueToPlatformValue({value:e,lastPCValue:this.props.fontStyle,lastMobileValue:this.mobileProps.fontStyle,mobileProperties:["fontSize"]});t&&this.setMobileProps({fontStyle:t}),r&&this.setProps({fontStyle:r})}async onInit(){this.isPreview&&this.duchampServer.calculateCenter.appendLinkageForbiddenList(this.relationWidgetIds)}async onThemeChange(e){const t={type:"color",value:e.colorPrimary};!isBaseResourceType(this.widget.border)&&this.widget.setBorder(t),!isBaseResourceType(this.mobile.border)&&this.mobile.setBorder(t),this.setProps({color:e.fontColorHighLight})}}function QueryButtonWidget(e){const{config:t,events:r}=e,{styleConfig:n,value:o}=t,{fontFamily:i,color:a,fontAttr:s}=n;return jsx("div",{className:"fvs-button-query",onClick:()=>{var e;return null==(e=null==r?void 0:r.onClick)?void 0:e.call(r)},children:jsx("span",{style:{color:a,fontFamily:i,...s},children:o})})}__decorateClass$D([computed],QueryButtonModel.prototype,"controlInstances"),__decorateClass$D([computed],QueryButtonModel.prototype,"optionalWidgets"),__decorateClass$D([computed],QueryButtonModel.prototype,"relationWidgets"),__decorateClass$D([content(),computed],QueryButtonModel.prototype,"relationWidgetIds"),__decorateClass$D([action$1],QueryButtonModel.prototype,"setRelationWidgetIds"),__decorateClass$D([content(),computed],QueryButtonModel.prototype,"value"),__decorateClass$D([action$1],QueryButtonModel.prototype,"setValue"),__decorateClass$D([content(),computed],QueryButtonModel.prototype,"fontAttr"),__decorateClass$D([action$1],QueryButtonModel.prototype,"setFontAttr"),__decorateClass$D([action$1],QueryButtonModel.prototype,"setMobileFontStyle");const QueryButtonView=observer((({model:e,width:t,height:r=0})=>{const{fontFamily:n,color:o,fontStyle:i,value:a}=e.props,s=reactExports.useMemo((()=>({width:t,height:r,name:e.name})),[t,r,e.name]);return jsx(QueryButtonWidget,{theme:e.theme,state:s,config:{value:a,notRelationWidgetIds:e.props.notRelationWidgetIds,styleConfig:{fontFamily:n,color:o,fontAttr:i}},events:{onClick:e.handleClick.bind(e)}})})),DEFAULT_WIDGET_LABEL_CONFIG={enable:!1,value:""},WIDGET_LABEL_COLLAPSE_KEY="label_collapse",DEFAULT_WIDGET_LABEL_CONFIG_ACTIVE_KEY=[WIDGET_LABEL_COLLAPSE_KEY],WidgetLabelConfig=({style:e,className:t,onChange:r,config:n})=>jsx(CollapseGroup,{contentPadding:"10px",defaultActiveKey:DEFAULT_WIDGET_LABEL_CONFIG_ACTIVE_KEY,style:e,className:t,items:[{key:WIDGET_LABEL_COLLAPSE_KEY,label:duchampIntl.get("Duchamp-Title"),children:jsx("div",{className:"collapse-content-panel",children:jsxs(GridItem,{children:[jsx(LineItem,{label:duchampIntl.get("Duchamp-Widget_Label"),children:jsx(Checkbox$4,{text:duchampIntl.get("Duchamp-Widget_Label_Enable"),value:null==n?void 0:n.enable,onChange:e=>{null==r||r({...n,enable:e})}})}),jsx(LineItem,{label:"",hide:!(null==n?void 0:n.enable),children:jsx(ValidationInput,{value:null==n?void 0:n.value,rules:[{required:!0,message:duchampIntl.get("Duchamp-Content_Cannot_Be_Empty")}],onChange:e=>{null==r||r({...n,value:e})}})})]})})}]}),RelationComponentConfig=observer((({model:e})=>jsxs(Fragment,{children:[jsx(ClickEditConfig,{onClick:()=>{var t;null==(t=e.getComponentInstance())||t.doEdit()}}),jsx(WidgetLabelConfig,{config:e.label,style:{paddingTop:18},onChange:t=>{e.setProps({label:t})}})]})));function ImageUrlInput({value:e="",onChange:t}){return jsx(TextArea,{style:{height:100},value:e,onChange:e=>{null==t||t(e)},placeholder:duchampIntl.get("Duchamp-Please_Enter_The_Online_Picture_Address")})}function ImageResourceSelector({value:e,defaultResource:t,className:r,onChange:n,supportEmpty:o=!1,tag:i,imageScopes:a=[IMAGE_SCOPE.ICON],filterProps:s,container:l,mask:c}){var u;const d=[jsx(ResourceSelectorOption,{text:duchampIntl.get("Duchamp-Custom_Upload"),value:RESOURCE_TYPE.CUSTOM,children:jsx(DuchampCustomImageResource,{defaultResource:t,canEdit:!1,tag:i,imgStyle:s&&getFilterStyle(s),container:l,mask:c})},RESOURCE_TYPE.CUSTOM),jsx(ResourceSelectorOption,{text:duchampIntl.get("Duchamp-Online_Pictures"),value:RESOURCE_TYPE.WEBURL,children:jsx(ImageUrlInput,{})},RESOURCE_TYPE.WEBURL)];return settingCenter.supportAppService(DUCHAMP_APP_SERVICE.REUSE)&&(null==(u=settingCenter.getResourceConfig())?void 0:u.resourceEnable)&&d.unshift(jsx(ResourceSelectorOption,{text:duchampIntl.get("Duchamp-Resource_Center"),value:RESOURCE_TYPE.INTERNAL,children:jsx(DuchampInternalImageResource,{defaultResource:t,imageScopes:a,imgStyle:s&&getFilterStyle(s),container:l,mask:c})},RESOURCE_TYPE.INTERNAL)),jsx(LineItem,{children:jsx(ResourceSelector$1,{style:{flex:1},value:e,className:r,onChange:e=>{null==n||n(e)},children:(o?[jsx(ResourceSelectorOption,{text:duchampIntl.get("Duchamp-Without"),value:RESOURCE_TYPE.EMPTY},RESOURCE_TYPE.EMPTY)]:[]).concat(d)})})}function getImageWidgetSrc(e,t){if(!t||t.type===RESOURCE_TYPE.EMPTY)return"";if(t.type===RESOURCE_TYPE.INTERNAL||t.type===RESOURCE_TYPE.CUSTOM){const{imageSource:r}=getImageResource$1(e,t);return r}return t.value}const WidgetLabel=observer((({config:e=DEFAULT_WIDGET_LABEL_CONFIG,className:t,style:r})=>{const n=useStore();if(!e.enable)return null;const{styleConfig:o}=n,{label:i=THEME_DEFAULT_LABEL_CONFIG}=o.theme_config,{border:a,fillType:s,backgroundFillType:l,borderScale:c,borderHue:u,borderOpacity:d,borderSaturation:h,borderBrightness:p,borderContrast:f,color:g,fontAttr:m,fontFamily:y,icon:v}=i,_="default"===(null==v?void 0:v.type)?v.value:getImageWidgetSrc(n.resourceCenter,v);return jsx("div",{className:classNames$1("duchamp-widget-label-wrapper",t),style:r,children:jsxs("div",{className:"label-wrapper",style:{color:hexToRgba(g),fontFamily:y,...m},children:[jsx("div",{style:{...convertBorderBackgroundStyle({borderOpacity:d,borderHue:u,borderSaturation:h,borderBrightness:p,borderContrast:f,border:a,fillType:s,backgroundFillType:l,borderScale:c,resourceCenter:n.resourceCenter,urlParser:e=>createResourceURL(e,n.duchampServer.resourceBaseUrl)})},className:"label-background"}),_?jsx("div",{className:"label-icon",children:jsx("img",{src:createResourceURL(_,n.duchampServer.resourceBaseUrl),alt:""})}):null,jsx("div",{className:"label-text",title:e.value,children:e.value})]})})})),ITEM_MIN_WIDTH=36;function DrillDownNavigationView({value:e,width:t,theme:r,onSwitch:n}){const[o,i]=reactExports.useState(null),a=reactExports.useMemo((()=>({id:uuid$1(),drillInfo:{label:"...",tooltip:"..."},filter:null})),[]);return reactExports.useEffect((()=>{if(0===e.length)return void i(null);const r=Math.max(Math.floor(t/ITEM_MIN_WIDTH),0),n=e.length>r?e.slice(e.length-r,e.length):e,o={id:uuid$1(),drillInfo:{label:duchampIntl.get("Duchamp-Reuse_Button_All"),tooltip:duchampIntl.get("Duchamp-Reuse_Button_All")},filter:null},s=n.length===e.length?[o,...n]:[o,a,...n];i(s)}),[a,i,e,t]),null===o||o.length<2?jsx(Fragment,{}):jsx("div",{className:"drill-down-navigation",style:{color:r===TEMPLATE_THEME_TYPE.DARK?COLOR$1.WHITE:COLOR$1.BLACK},children:o.map(((t,r)=>{const i=r===o.length-1;return jsxs(reactExports.Fragment,{children:[jsx(Tooltip$1,{content:t.drillInfo.tooltip,style:{whiteSpace:"pre-line"},children:jsx("span",{className:classNames$1("navigation-item-name",{"navigation-more-item":a.id===t.id}),onClick:()=>{if(0===r)return void n(0);const o=e.findIndex((e=>e.id===t.id));o>-1&&n(o+1)},children:t.drillInfo.label})}),!i&&jsx("span",{className:"navigation-item-line",children:"/"})]},t.id)}))})}const RelationComponent=({options:e,onClick:t,onFinish:r,onCalculated:n,onMount:o,onUnmount:i,onClearLinkage:a})=>{const s=useStore(),{crudService:l}=useService(),c=reactExports.useRef(null),u=reactExports.useRef();return useMount$1((()=>{if(!c.current||!e||isEmpty$3(e.props)&&isEmpty$3(e.tableId))return;const{content:i}=s.styleConfig.widget.relation;u.current=l.initRelationWidget(c.current,merge$1({},e,{props:{theme:{type:s.styleConfig.theme,...i},filter:e.props.filter}})),u.current.on("finish",r),u.current.on("calculated",(e=>n(e))),u.current.on("click",((e,r)=>{t(e,r)})),u.current.on("clearLinkage",a),null==o||o(u.current)})),useUnmount$2((()=>{null==i||i(),u.current&&(u.current.destroy(),u.current=void 0)})),jsx("div",{className:classNames$1("inner-widget-container",{"not-clickable":!s.isPreview}),ref:c})};RelationComponent.displayName="RelationComponent";const RelationComponentView=observer((({model:e,width:t,height:r=0})=>{var n;const o=useStore(),i=e.styleConfigContent;return reactExports.useEffect((()=>{var t;null==(t=e.getComponentInstance())||t.setProps({theme:{type:o.styleConfig.theme,...i}})}),[i]),e.computed||e.filter?jsxs("div",{className:"relation-component-view",children:[jsx(WidgetLabel,{config:e.label,className:"inner-widget-label"}),jsx(RelationComponent,{options:e.relationModelOptions,width:t,height:r,onClick:(t,r)=>{e.handleClick(t,r)},onFinish:()=>{e.emitCurrentLoaded()},onClearLinkage:()=>{e.clearLinkage()},onMount:t=>e.setComponentInstance(t),onUnmount:()=>e.setComponentInstance(),onCalculated:t=>e.setData(t)},null!=(n=e.activeDrillDownItemIndex)?n:e.relationMeta.wId),jsx(DrillDownNavigationView,{value:e.drillDownNavigation,theme:o.styleConfig.theme,onSwitch:t=>e.switchDrillDownItem(t),width:t}),!e.isPreview&&jsx("div",{className:"widget-masker"})]}):jsx(Fragment,{})})),getRelationComponentMeta=e=>({type:"d-relation-".concat(e),displayName:"",widgetType:"relation",groupName:"",icon:"",props:{relationMeta:{wId:"",tableId:""},relationActionConfig:{open:!0,blacklist:[]},label:DEFAULT_WIDGET_LABEL_CONFIG},states:{width:400,height:260},version:"",async beforeCreate(e){var t;const{widget:r,options:n}=e,o={...r.props.relationActionConfig,open:null==(t=r.store.interactive.autoLink)||t};return isEmptyTableRelationOptions(n)?r.store.crudService.createRelationWidget({tableId:n.tableId,widget:r}).then((e=>{r.setValue({relationMeta:pick(e,["wId","tableId"]),label:{enable:!0,value:null==e?void 0:e.label},relationActionConfig:o}),r.setName(createUniqueName(r.store.story.widgets.map((e=>e.name)),(null==e?void 0:e.label)||"","","_c",0))})):new Promise((e=>{r.props.relationMeta.wId||r.props.relationMeta.tableId||(r.setValue({relationMeta:{wId:null==n?void 0:n.wId,tableId:null==n?void 0:n.tableId},label:{enable:!0,value:null==n?void 0:n.label},relationActionConfig:o}),r.setName(createUniqueName(r.store.story.widgets.map((e=>e.name)),(null==n?void 0:n.label)||"","","_c",0))),e(void 0)}))},configure:{eventTargets:{events:[{trigger:WIDGET_EVENT.CLICK,text:WIDGET_EVENT_MAP.CLICK,actions:[]}]}}});function registerRelation(e,t,r=RelationComponentView,n=RelationComponentConfig){const o=getRelationComponentMeta(e);registerWidget({options:{...merge$1(o,settingCenter.getComponentConfigMeta(o.type)),configuration:[],...t},view:r,configView:n})}function registerRelationComponent(e,t,r,n="interactiveChart"){registerRelation(e,{displayName:t,groupName:r,functionPoint:n,model:RelationComponentModel},RelationComponentView)}const NameConfig=observer((({name:e,onNameChange:t,onCheckingName:r})=>jsx(LineItem,{label:duchampIntl.get("Duchamp-Name"),children:jsx(NameConfigInput,{value:e,onChange:e=>{t(e)},repeatValidator:e=>r(e)})}))),NameConfigInput=observer((({value:e,onChange:t,repeatValidator:r=()=>!0})=>jsx(ValidationInput,{value:e,rules:[{required:!0,message:duchampIntl.get("Duchamp-Content_Cannot_Be_Empty")},{validate:r,message:duchampIntl.get("Duchamp-Duplicate_Name_Exists_Tip")}],onChange:t}))),SizeConfig=observer((({states:e,rect:t,limitRect:r,onKeepRatioChange:n,onRectChange:o})=>{const i=useStore(),{width:a,height:s,keepRatio:l}=e,{left:c,top:u}=t,{width:d=DESIGNER.MAX_WIDTH,height:h=DESIGNER.MAX_HEIGHT,left:p=t.left,top:f=t.top}=r||{},g=p+d-c,m=f+h-u,y=i.platform.mobile.isOpenMobileLayout?PlatformLineItem:LineItem;return jsx(y,{label:duchampIntl.get("Duchamp-Size"),children:jsx(SizeInput,{maxHeight:m,maxWidth:g,width:a,height:s,onChange:e=>{o(e)},keepRatio:l,onKeepRatioChange:e=>{n({keepRatio:e})}})})})),{Item:Item$5}=Tab$1,ExpandTemplateConfig=observer((({widget:e})=>{const t=e.getInstance(),r=useStore(),{states:n,rect:o,limitRect:i}=e.getInstance();return jsx(Tab$1,{theme:"line",stretch:!0,tabHeaderStyle:{margin:"0 12px"},children:jsx(Item$5,{tab:duchampIntl.get("Duchamp-Expand_Template"),className:"form-padding",children:jsxs(GridItem,{children:[jsx(NameConfig,{name:e.name,onNameChange:t=>{e.setName(t)},onCheckingName:t=>!r.story.widgets.some((r=>r.name===t&&r.id!==e.id))}),jsx(SizeConfig,{states:toJS(n),rect:o,limitRect:i,onRectChange:t=>{e.setRectStatesWithEffect(t)},onKeepRatioChange:t=>{e.setStates(t)}}),jsx(LineItem,{label:duchampIntl.get("Duchamp-Container_Keep_Ratio"),icon:jsx(IconPopover,{arrow:{pointAtCenter:!0},icon:"icon-help",placement:"top-left",autoAdjustOverflow:!0,overlayInnerStyle:{maxWidth:"250px"},text:duchampIntl.get("Duchamp-Container_Keep_Ratio_Tip",duchampIntl.get("Duchamp-Expand_Template"))}),children:jsx(Checkbox$4,{value:t.keepRatio,onChange:e=>{t.setKeepRatio(e)},text:duchampIntl.get("Duchamp-Container_Enable_Keep_Ratio")})})]})},"0")})})),STRUCTURE_WIDGET_META_CONFIG={structure:!0,ghost:!1,draggable:e=>!e.target.classList.contains("os-scrollbar-handle")},DEFAULT_WIDGET_GAP={RESERVE_CANVAS:4,TABS:10},EXPAND_TEMPLATE_WIDGET_META={type:WIDGET_TYPE.EXPAND_TEMPLATE,widgetType:"expandTemplate",displayName:duchampIntl.get("Duchamp-Expand_Template"),version:"0.0.1",icon:"",states:{width:300,height:180},refresh:!1,configure:{...STRUCTURE_WIDGET_META_CONFIG,draggable:!1,copyable:!1,resizable:{directions:["s","se","e"]},acceptRule:{parentWhitelist:{rule:[WIDGET_TYPE.EXPAND],tip:duchampIntl.get("Duchamp-Expand_Template_Move_Error_Tip")},contextWhitelist:{rule:e=>{const t=[WIDGET_TYPE.GROUP,WIDGET_TYPE.TITLE,WIDGET_TYPE.RICH_TEXT,WIDGET_TYPE.IMAGE];return isString$3(e)?t.includes(e):e.flattenChildWidgets.every((e=>t.includes(e.type)))}}},defaultName:(e,t,r)=>createUniqueName(e,duchampIntl.get("Duchamp-Expand_Template"),r?"_".concat(r.name):"")},scale:!1};function isWidgetsInMagneticLayout(e){return!!e.length&&isParentMagneticLayout(e[0])}function isParentMagneticLayout(e){return isMagneticLayout(e.parentWidget)}function isMagneticLayout(e){return!e||isMagneticWidget(e.model)}const getWidgetsMobileStates=e=>e.reduce(((e,t)=>{const{width:r,height:n,matrix:o}=t.mobile.states||{};return isNil$3(r)||isNil$3(n)||isNil$3(o)||e.push({states:{width:r,height:n,matrix:o}}),e}),[]),updateMobileGroupRect=e=>{if(!widgetIsGroup(e))return;const t=getWidgetsMobileStates(e.getInstance().childWidgets);if(t.length>0){const{width:r,height:n,top:o,left:i}=calculateAreaBound(t.map((e=>e.states)));e.platform.mobile.setStates({width:r,height:n,matrix:(new Transform$2).translate(i,o).matrix})}},addGroupInMagneticProcessor={access:({cur:e,prev:t})=>isMagneticLayout(t.parent)&&!!e.parent&&widgetIsGroup(e.parent)&&e.parent.parentWidget===t.parent,handler:({adaptor:e,cur:t})=>{var r;const{parent:n}=t;if(!n||!widgetIsGroup(n))return;const o=n.parentWidget?n.parentWidget.platform.mobile:null==(r=e.model.story)?void 0:r.platform.mobile;if(!o)return;const{widgetOrders:i}=o;if(i.includes(n.id))return;const a=n.getInstance().childWidgets.reduce(((e,t)=>{const r=i.indexOf(t.id);return r>-1?e>-1?Math.min(e,r):r:e}),-1);if(a>-1){const e=[...i];e.splice(a,0,n.id),null==o||o.setWidgetOrder(e)}}},removeGroupInMagneticProcessor={access:({cur:e,prev:t})=>isMagneticLayout(e.parent)&&!!t.parent&&widgetIsGroup(t.parent)&&t.parent.parentWidget===e.parent,handler:({adaptor:e,cur:t,prev:r})=>{var n,o;const i=t.parent?t.parent.platform.mobile:null==(n=e.model.story)?void 0:n.platform.mobile;if(i&&r.parent){const{widgetOrders:t}=i,n=t.indexOf(r.parent.id);if(n>-1){const a=[...t];(null==(o=e.model.story)?void 0:o.getWidgetById(r.parent.id))?a.splice(n+1,0,e.model.id):a.splice(n,1,...r.parentChildren.map((e=>e.id))),i.setWidgetOrder(a)}}}},parentChangeProcessor=[addGroupInMagneticProcessor,removeGroupInMagneticProcessor];var __defProp$D=Object.defineProperty,__getOwnPropDesc$C=Object.getOwnPropertyDescriptor,__decorateClass$C=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$C(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$D(t,r,i),i};class StructWidgetModel extends BaseWidgetModel{constructor(){super(...arguments),__publicField(this,"isResize",!1),__publicField(this,"updateScrollViewFlag",0),__publicField(this,"updateScrollView",debounce$4((e=>{runInAction((()=>{var t;e.getInstance().visibleInStory&&!e.getInstance().visibleBindingClientRect&&(this.updateScrollViewFlag++,null==(t=this.parentWidgetModel)||t.updateScrollView(e))}))}))),__publicField(this,"scrollContainerRef",reactExports.createRef())}setIsResize(e){this.isResize=e}get scrollContainer(){var e;return null==(e=this.scrollContainerRef.current)?void 0:e.getContainerEl()}scrollToWidget(e,t){var r,n;null==(n=null==(r=this.scrollContainerRef.current)?void 0:r.scrollToWidget)||n.call(r,e,t)}get childWidgets(){return this.widget.childWidgets}get flattenChildWidgets(){return this.widget.flattenChildWidgets}get showScrollbar(){const{story:e}=this;return e&&!this.isResize&&this.flattenChildWidgets.some((t=>e.currents.has(t.id)))}getBoundsEffect(){return{padding:this.widget.platform.padding,borderWidth:this.widget.borderWidth}}get layoutRect(){return this.widget.layoutRect}get areaRect(){return calculateAreaBound([{width:this.layoutRect.width,height:this.layoutRect.height,matrix:new Transform$2(this.states.matrix).setTranslate(this.layoutRect.left,this.layoutRect.top).matrix},...this.childWidgets.map((e=>e.model.states))])}get scrollAreaRect(){return this.areaRect}get childrenLimitRect(){return{left:this.layoutRect.left,top:this.layoutRect.top}}get childrenLimitBoundingClientRect(){var e;const{scale:t}=this.store.platform,r=null==(e=this.widget.target)?void 0:e.getBoundingClientRect();if(r)return calculateIntersectionRect({width:this.layoutRect.width*t,height:this.layoutRect.height*t,left:r.left+(this.layoutRect.left-this.rect.left)*t,top:r.top+(this.layoutRect.top-this.rect.top)*t},this.visibleBindingClientRect)}get childrenLimitVisibleRect(){return this.visibleRect}get keepRatio(){var e;return null!=(e=this.props.keepRatio)&&e}get availableChildWidgets(){return this.childWidgets}get needInitChildWidgets(){return this.childWidgets}get scroll(){return this.props.scroll||{x:0,y:0}}get mobileChildWidgets(){return this.widget.platform.mobile.childWidgets}get mobileLayoutConfig(){return this.parentWidgetModel?this.parentWidgetModel.mobileLayoutConfig:this.store.platform.mobile.layoutConfig}get mobilePreviewLayout(){return(isPad()?this.mobileLayoutConfig.pad:this.mobileLayoutConfig.phone).layout}initStateChangeListeners(e){super.initStateChangeListeners(e),!this.isPreview&&this.disposes.push(reaction((()=>cloneDeep$2({...this.layoutRect,...this.getBoundsEffect(),matrix:new Transform$2(this.states.matrix).setTranslate(this.layoutRect.left,this.layoutRect.top).matrix,isMagneticLayout:this.store.isMagneticLayout})),((e,t)=>{e.isMagneticLayout===t.isMagneticLayout&&this.store.undoManager.withoutUndo((()=>{this.updateChildrenRectStates({cur:e,pre:t,ignoreSelf:!0,onlyCache:!0})}))}),{equals:(e,t)=>{const r=keys$7(this.getBoundsEffect()),n=keys$7(this.layoutRect);return isEqual$4(pick(e,r),pick(t,r))||isEqual$4(pick(e,n),pick(t,n))}}),reaction((()=>{var e;return null==(e=this.story)?void 0:e.currentWidget}),(e=>{e&&this.childWidgets.includes(e)&&this.updateScrollView(e)})))}getAppendChildTransform(e,t){const r=t?new Transform$2(t).translate(this.scroll.x,this.scroll.y):(new Transform$2).setTranslate(this.layoutRect.left+this.scroll.x+this.layoutRect.width/2-e.model.states.width/2,this.layoutRect.top+this.scroll.y+this.layoutRect.height/2-e.model.states.height/2),[n,o]=r.getPosition();return n<this.layoutRect.left&&r.translate(this.layoutRect.left-n,0),o<this.layoutRect.top&&r.translate(0,this.layoutRect.top-o),r}updateRectAfterAppendChild(e,t){const r=this.getAppendChildTransform(e,t);e.setRectStatesWithEffect({matrix:r.matrix}),this.updateScrollView(e)}removeChildToMainCanvas(e,t){this.store.undoManager.withGroup((()=>{var r;null==(r=this.story)||r.widgetMoveOut(e,new Transform$2(t).translate(-this.scroll.x,-this.scroll.y).matrix)}))}getTargetChildrenStates({widgets:e,cur:t,pre:r,ignoreSelf:n=!1,keepRatio:o=this.keepRatio}){const i=n?{width:0,height:0,left:0,top:0}:{width:this.rect.width-this.layoutRect.width,height:this.rect.height-this.layoutRect.height,left:this.layoutRect.left-this.rect.left,top:this.layoutRect.top-this.rect.top},a={...r,width:r.width-i.width,height:r.height-i.height,matrix:new Transform$2(r.matrix).translate(i.left,i.top).matrix},s={...t,width:t.width&&t.width-i.width,height:t.height&&t.height-i.height,matrix:t.matrix&&new Transform$2(t.matrix).translate(i.left,i.top).matrix};return getTargetChildrenStates(e,a,{...s,width:o?s.width:a.width,height:o?s.height:a.height})}updateChildrenRectStates({cur:e,pre:t,ignoreSelf:r=!1,onlyCache:n}){if(this.isResize&&this.setIsResize(!1),this.store.isMagneticLayout)return void this.updateMagneticChildrenRectStates({cur:e,pre:t,ignoreSelf:r,onlyCache:n});const{width:o=t.width,height:i=t.height}=e,a=o/t.width,s=i/t.height;this.updateScrollPosition({x:this.scroll.x*a,y:this.scroll.y*s});const l=this.getTargetChildrenStates({widgets:this.childWidgets.filter((e=>e.id!==this.id)),cur:e,pre:t,ignoreSelf:r});this.childWidgets.forEach((e=>{const t=l.get(e.id);t&&e.setRectStatesWithEffect(t,!1)}))}updateMagneticChildrenRectStates({cur:e,pre:t,ignoreSelf:r=!1,onlyCache:n}){var o;const{width:i=t.width,height:a=t.height}=e;this.updateScrollPosition({x:this.scroll.x*(i/t.width),y:this.scroll.y*(a/t.height)});const s=null==(o=this.widget.mobile.states)?void 0:o.matrix,l=this.mobile.childWidgets.filter((e=>{var t;return null==(t=e.mobile.states)?void 0:t.matrix})),c=calculateAreaBound(getWidgetsMobileStates(l).map((e=>e.states)));let u=!1;this.mobile.childWidgets.forEach((o=>{var i,a,l;if(o.id===this.id)return;if(!s&&(null==(i=o.mobile.states)?void 0:i.matrix)&&n){const{matrix:t}=o.mobile.states,[r,i]=new Transform$2(t).getPosition(),a=new Transform$2(e.matrix).translate(r-c.left,i-c.top).matrix,{width:s,height:l}=o.model.states;return setMagneticWidgetStates({widget:o,states:{width:s,height:l,matrix:a},onlyCache:n}),void(u=!0)}const{width:d,height:h,matrix:p}=this.widget.states,f=(null==(a=o.mobile.states)?void 0:a.matrix)||!n?t:{width:d,height:h,matrix:p};!(null==(l=o.mobile.states)?void 0:l.width)&&n&&o.platform.mobile.setCacheStates(void 0);const g=this.getTargetChildrenStates({widgets:[o],cur:e,pre:f,ignoreSelf:r}).get(o.id);g&&setMagneticWidgetStates({widget:o,states:g,onlyCache:n})})),u&&this.updateByChildren()}updateByChildren(e){if(0!==this.childWidgets.length&&this.store.isMagneticLayout&&!e){this.mobile.setStates(this.mobile.magneticStates);const{states:t}=this.mobile;this.updateChildrenRectStates({cur:t,pre:t,onlyCache:e})}}resizeStructLayer(e){this.setIsResize(!0);const[t,r]=new Transform$2(this.states.matrix).getPosition(),[n,o]=new Transform$2(e.matrix).getPosition(),i=new Map;return this.getTargetChildrenStates({widgets:this.childWidgets,cur:e,pre:this.states}).forEach(((e,a)=>{i.set(a,{...e,matrix:new Transform$2(e.matrix).translate(t-n,r-o).matrix})})),this.childWidgets.forEach((e=>{if(isStructureWidget(e)){const t=i.get(e.id);t&&e.getInstance().resizeStructLayer(t).forEach(((e,t)=>{i.set(t,e)}))}})),i}updateScrollPosition(e,t,r){const n=null!=t?t:this.scrollContainer;if(this.isResize||!n)return;const o={x:clamp$5(e.x,0,n.scrollWidth-n.clientWidth)/(null!=r?r:1),y:clamp$5(e.y,0,n.scrollHeight-n.clientHeight)/(null!=r?r:1)};isEqual$4(o,this.scroll)||this.store.undoManager.withoutUndo((()=>{this.setProps({scroll:o})}))}setKeepRatio(e){this.setProps({keepRatio:e})}get widgetIsRenderWithoutScale(){return!!this.isPreview&&(this.renderMode?"fitSize"===this.renderMode:!1===this.widget.meta.scale)}}__decorateClass$C([observable],StructWidgetModel.prototype,"isResize",2),__decorateClass$C([action$1],StructWidgetModel.prototype,"setIsResize",1),__decorateClass$C([observable],StructWidgetModel.prototype,"updateScrollViewFlag",2),__decorateClass$C([computed],StructWidgetModel.prototype,"childWidgets",1),__decorateClass$C([computed],StructWidgetModel.prototype,"flattenChildWidgets",1),__decorateClass$C([computed],StructWidgetModel.prototype,"showScrollbar",1),__decorateClass$C([computed],StructWidgetModel.prototype,"layoutRect",1),__decorateClass$C([computed],StructWidgetModel.prototype,"areaRect",1),__decorateClass$C([computed],StructWidgetModel.prototype,"scrollAreaRect",1),__decorateClass$C([computed],StructWidgetModel.prototype,"childrenLimitRect",1),__decorateClass$C([computed],StructWidgetModel.prototype,"childrenLimitBoundingClientRect",1),__decorateClass$C([computed],StructWidgetModel.prototype,"childrenLimitVisibleRect",1),__decorateClass$C([computed],StructWidgetModel.prototype,"keepRatio",1),__decorateClass$C([computed],StructWidgetModel.prototype,"availableChildWidgets",1),__decorateClass$C([computed],StructWidgetModel.prototype,"needInitChildWidgets",1),__decorateClass$C([computed],StructWidgetModel.prototype,"scroll",1),__decorateClass$C([computed],StructWidgetModel.prototype,"mobileChildWidgets",1),__decorateClass$C([computed],StructWidgetModel.prototype,"mobileLayoutConfig",1),__decorateClass$C([computed],StructWidgetModel.prototype,"mobilePreviewLayout",1),__decorateClass$C([override],StructWidgetModel.prototype,"initStateChangeListeners",1),__decorateClass$C([override],StructWidgetModel.prototype,"widgetIsRenderWithoutScale",1);class ExpandTemplateWidgetModel extends StructWidgetModel{}const ScrollableContainer$1=observer((({children:e,placeholderStyle:t,className:r,model:n,adaptiveScale:o={horizontal:1,vertical:1}})=>{const{story:{currentWidget:i},platform:a}=useStore(),{scale:s}=a,{width:l,height:c}=n.areaRect,u=reactExports.useRef(null),d=useScrollBarInitialize(u,["mousemove"]),h=reactExports.useMemo((()=>convertAdaptiveScaleToTransformScale(o)),[o]),p=reactExports.useMemo((()=>debounce$4((e=>{const{scrollOffsetElement:t}=e.elements();n.updateScrollPosition({x:t.scrollLeft,y:t.scrollTop},t,h)}),100)),[n,h]),f=reactExports.useCallback((e=>{var t;const r=null==(t=u.current)?void 0:t.osInstance();if(!r)return;const{scrollOffsetElement:n}=r.elements();n.scrollTo({left:e.x*h,top:e.y*h})}),[h]);return reactExports.useEffect((()=>{f(n.scroll)}),[n.scroll,n.flattenChildWidgets,f]),useUpdateEffect$2((()=>{var e;if(n.isPreview)return;const t=null==(e=u.current)?void 0:e.osInstance(),r=null==i?void 0:i.target;if(t&&r){const{scrollOffsetElement:e}=t.elements(),{x:n,y:o}=e.getBoundingClientRect(),{x:i,y:a}=r.getBoundingClientRect();f({x:e.scrollLeft+(i-n)/s,y:e.scrollTop+(a-o)/s})}}),[n.updateScrollViewFlag]),jsxs(OverlayScrollbar,{ref:u,scale:convertAdaptiveScaleToTransformScale(o),className:r,events:{scroll:p},defer:!1,options:n.isPreview?d?{scrollbars:{autoHide:"move",autoHideDelay:3e3}}:{overflow:{x:"hidden",y:"hidden"}}:n.showScrollbar?void 0:{overflow:{x:"hidden",y:"hidden"}},children:[jsx("div",{className:"structure-placeholder",style:{...calculateAdaptiveScaleStyle({style:{width:l,height:c},adaptiveScale:o,withTransform:!1}),...t}}),e]})})),StructContainer=observer((({model:e,children:t,emptyTip:r,className:n,overflow:o="hidden",placeholderStyle:i,outline:a=!0,tipClassName:s,adaptiveScale:l,offset:c})=>{const{story:{currents:u}}=useStore(),{contentBounds:d}=useAdaptiveStyle({bounds:e.states,padding:e.padding,borderLine:e.borderLine,renderWithoutScale:e.widgetIsRenderWithoutScale,adaptiveScale:l}),h=reactExports.useMemo((()=>{const{left:e,top:t}=d,{left:r=0,top:n=0}=null!=c?c:{};return new Metrics(0,0,[1,0,0,1,e+r,t+n]).toReversed().toUnitCssObject()}),[d,c]),p=!e.showHoverTip&&!u.has(e.id)&&a,f=jsx("div",{className:"structure-layer",style:h,children:t}),g=classNames$1("structure-container",n);return jsxs(Fragment,{children:[!e.isPreview&&jsx("div",{className:classNames$1("structure-container-tip",s,{"outline-rect":e.childWidgets.length>0&&p,"outline-empty":0===e.childWidgets.length&&p}),children:0===e.childWidgets.length&&r}),"auto"===o?jsx(ScrollableContainer$1,{model:e,placeholderStyle:i,className:g,adaptiveScale:l,children:f}):jsx("div",{className:g,style:{overflow:o},children:f})]})})),ExpandTemplateView=observer((({model:e,adaptiveScale:t,expandIndex:r=0})=>jsx(StructContainer,{model:e,emptyTip:0===r?duchampIntl.get("Duchamp-Expand_Component_Add_Tip"):"",overflow:"hidden",tipClassName:0===r?"main-expand-template-container-tip":"expand-template-container-tip",adaptiveScale:t,children:e.childWidgets.map((e=>jsx(WidgetWrapper,{widget:e,expandIndex:r,adaptiveScale:t},e.id)))}))),LAYOUT_TYPE$1={COLUMN:"column",ROW:"row"},DEFAULT_COLUMN_LAYOUT={type:LAYOUT_TYPE$1.COLUMN,value:3},DEFAULT_ROW_LAYOUT={type:LAYOUT_TYPE$1.ROW,value:1},DEFAULT_INTERVAL={horizontal:4,vertical:4},CollapseLayout=e=>{const{children:t,value:r,onChange:n,title:o="",tip:i,hide:a}=e,[s,l]=reactExports.useState(a?[]:["1"]);return jsx(CollapseGroup,{activeKey:s,onChange:l,items:[{key:"1",label:o,extra:i,children:jsx(GridItem,{children:t.map(((e,t)=>{var o;return jsx(ConfigItem,{value:r,onChange:n,config:e},null!=(o=e.name)?o:t)}))})}]})},ToggleLayout=e=>{const{options:t,children:r,value:n,onChange:o}=e;return t?jsx(ToggleGroup,{options:t,children:e=>jsx(Fragment,{children:r.map((t=>jsx(ConfigItem,{value:e?get$5(n,e):n,onChange:(t,r)=>{o(e?"".concat(e,".").concat(t):t,r)},config:t},t.name)))})}):jsx(Fragment,{})},VerticalLayout=e=>{const{children:t,value:r,onChange:n}=e;return jsx(Fragment,{children:t.map((e=>{const{platforms:t=[],title:o,...i}=e;return jsx(VerticalItem$1,{label:o,prefix:t.includes("pc")&&t.includes("mobile")?jsx(PlatformPopoverIcon,{}):void 0,children:jsx(ConfigItem,{value:r,onChange:n,config:{platforms:t,...i}})},e.name)}))})};class FormItemLayoutManager{constructor(){__publicField(this,"formLayoutItems",new Map),this.register("verticalLayout",VerticalLayout),this.register("collapseLayout",CollapseLayout),this.register("toggleLayout",ToggleLayout)}register(e,t){this.formLayoutItems.set(e,t)}getFormItemLayout(e){return this.formLayoutItems.get(e)}}const formItemLayoutManager=new FormItemLayoutManager,ConfigItem=observer((e=>{var t,r;const n=useStore(),{hide:o}=(null==(t=null==e?void 0:e.beforeRender)?void 0:t.call(e))||{hide:!1};if(o)return jsx(Fragment,{});const{platforms:i=[]}=e.config;if(0!==i.length&&!i.includes(n.platform.platformType))return null;const a=i.includes(PLATFORM.PC)&&i.includes(PLATFORM.MOBILE)?PlatformLineItem:LineItem;if(s=e.config,isNil$3(s.children)){const{type:t,name:n,displayName:o,className:i,beforeRender:s,icon:l,mobileProperties:c,...u}=e.config,d=null!=(r=get$5(toJS(e.value),n))?r:null==u?void 0:u.value,h=formItemManager.getFormItem(t),p=t=>{e.onChange(n,t)};if(h)return isNil$3(o)?jsx(h,{...u,value:d,onChange:p}):jsx(a,{label:o,icon:l,className:i,children:jsx(h,{...u,value:d,onChange:p})})}else{const{type:t,displayName:r,icon:n,children:o,platforms:i,...s}=e.config,l=formItemLayoutManager.getFormItemLayout(t),c=o.filter((t=>{var r,n;return!(null==(n=null==(r=t.beforeRender)?void 0:r.call(t,e.displayProps))?void 0:n.hide)}));if(l)return isNil$3(r)?jsx(l,{...s,value:e.value,onChange:e.onChange,children:c}):jsx(a,{label:r,icon:n,children:jsx(l,{...s,value:e.value,onChange:e.onChange,children:c})})}var s;return jsx(Fragment,{})})),WidgetConfiguration=observer((({widget:e,configuration:t})=>{const r=(r,n)=>{const o=toJS(e.props),i=toJS(e.platform.mobile.props),a=transformConfigurationValue({name:r,value:n,configuration:t,lastPCProps:o,lastMobileProps:i,isMobile:e.model.isMobile});e.updatePlatformProps(r,a)};return jsx(GridItem,{style:{gridTemplateColumns:"100%"},children:t.map(((t,n)=>{var o;return jsx(ConfigItem,{config:t,value:e.model.props,onChange:r,beforeRender:()=>{var r;return null==(r=null==t?void 0:t.beforeRender)?void 0:r.call(t,e.model.props)}},null!=(o=t.name)?o:n)}))})})),ExpandConfig=observer((({widget:e})=>{const t=e.getInstance();return jsx(WidgetConfiguration,{widget:e,configuration:[{name:"layout",displayName:duchampIntl.get("Duchamp-Layout"),type:"expand-layout-config",platforms:[PLATFORM.PC,PLATFORM.MOBILE]},{name:"interval",displayName:duchampIntl.get("Duchamp-Component_Interval"),type:"expand-interval-config",platforms:[PLATFORM.PC,PLATFORM.MOBILE]},{name:"accord",displayName:duchampIntl.get("Duchamp-Expand_Accord"),type:"expand-accord-config",accordList:t.accordList}]})})),LayoutConfig=observer((({value:e,onChange:t})=>jsxs(Fragment,{children:[jsx(Select$1,{options:[{value:LAYOUT_TYPE$1.COLUMN,label:duchampIntl.get("Duchamp-Group_Fit_Fixed_Column")},{value:LAYOUT_TYPE$1.ROW,label:duchampIntl.get("Duchamp-Group_Fit_Fixed_Row")}],value:e.type,className:"expand-layout-selector",onChange:e=>{t(e===LAYOUT_TYPE$1.COLUMN?DEFAULT_COLUMN_LAYOUT:DEFAULT_ROW_LAYOUT)}}),jsx(NumberInput$1,{value:e.value,onChange:r=>t({...e,value:r}),style:{width:"100%"},min:1,precision:0})]}))),IntervalConfig=observer((({value:e,onChange:t})=>jsxs("div",{className:"expand-interval-config",children:[jsx(Icon$2,{type:"icon-line-spacing"}),jsx(NumberInput$1,{wrapperClassName:"expand-interval-input",value:e.vertical,onChange:r=>t({...e,vertical:r}),min:0}),jsx(Icon$2,{type:"icon-column-spacing"}),jsx(NumberInput$1,{wrapperClassName:"expand-interval-input",value:e.horizontal,onChange:r=>t({...e,horizontal:r}),min:0})]}))),AccordConfig=observer((({value:e,onChange:t,accordList:r=[]})=>jsx(Select$1,{value:isEmpty$3(e)?void 0:e,options:r.map((e=>({label:e,value:e}))),onChange:e=>{t(e)},placeholder:duchampIntl.get("Duchamp-Please_Choose_Dataset"),style:{width:"100%"}})));formItemManager.register("expand-layout-config",LayoutConfig),formItemManager.register("expand-interval-config",IntervalConfig),formItemManager.register("expand-accord-config",AccordConfig);const EXPAND_WIDGET_META={type:WIDGET_TYPE.EXPAND,widgetType:"container",displayName:duchampIntl.get("Duchamp-Expand_Component"),version:"0.0.1",iconfont:"icon-extended-components-components",dragPreviewImage:"/assets/widget/expand.svg",states:{width:720,height:410},refresh:!1,configure:{...STRUCTURE_WIDGET_META_CONFIG,acceptRule:{childWhitelist:{rule:[WIDGET_TYPE.EXPAND_TEMPLATE]},contextWhitelist:{rule:(e,t)=>(isString$3(e)?e:e.type)!==WIDGET_TYPE.EXPAND_TEMPLATE||0===t.childWidgets.length,tip:duchampIntl.get("Duchamp-Expand_Component_Content_Error_Tip")}}},props:{layout:DEFAULT_COLUMN_LAYOUT,interval:DEFAULT_INTERVAL,accord:""},initialization:async({widget:e})=>{var t;if(0===e.children.length){return null!==await(null==(t=e.story)?void 0:t.createWidget(WIDGET_TYPE.EXPAND_TEMPLATE,{x:0,y:0},e))}return!0},configuration:e=>jsx(ExpandConfig,{...e}),scale:!1};function isInstanceofDynamizable(e){return!isNil$3(null==e?void 0:e.getDynamicValues)}var __defProp$C=Object.defineProperty,__getOwnPropDesc$B=Object.getOwnPropertyDescriptor,__decorateClass$B=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$B(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$C(t,r,i),i};class ExpandWidgetModel extends StructWidgetModel{constructor(){super(...arguments),__publicField(this,"count",1),__publicField(this,"autoHeight",!0)}setCount(e){this.count=e}get fieldConfigs(){const{accord:e}=this.props;return isEmpty$3(e)?new Map([]):new Map([["count",{type:"dataset",datasetName:e,columns:[{index:0,summary:"count"}]}]])}setFieldValues(e){const t=e.get("count");isArray$c(t)&&1===t.length&&isArray$c(t.at(0))&&_isNumber(t.at(0).at(0))&&this.setCount(t.at(0).at(0))}get template(){if(1===this.childWidgets.length)return this.childWidgets.at(0)}get accordList(){var e,t;const r=(null!=(t=null==(e=this.template)?void 0:e.flattenChildWidgets)?t:[]).reduce(((e,t)=>{const r=t.getInstance();return isInstanceofDynamizable(r)&&(e=[...e,...r.getDynamicValues()]),e}),[]).reduce(((e,t)=>{const{source:r}=t;return isDynamicDatasetSource(r)&&e.add(r.dataSet),e}),new Set);return Array.from(r)}updateByChildren(){var e;0===this.childWidgets.length?null==(e=this.story)||e.deleteWidget(this.widget):super.updateByChildren()}get layoutRect(){if(isNil$3(this.template))return this.widget.layoutRect;const{width:e,height:t}=this.template.layoutRect;return{...this.widget.layoutRect,width:e,height:t}}updateRectAfterAppendChild(e){const{width:t,height:r}=e.states,{left:n,top:o}=this.layoutRect;e.setRectStatesWithEffect({width:t,height:r,matrix:[1,0,0,1,n,o]})}getTemplateOffset(e){if(isNil$3(this.template))return{left:0,top:0};const{layout:t,interval:r}=this.props,{rect:{width:n,height:o}}=this.template;let i=0,a=0;return t.type===LAYOUT_TYPE$1.COLUMN?(a=Math.floor(e/t.value),i=e%t.value):(a=e%t.value,i=Math.floor(e/t.value)),{left:(n+r.horizontal)*i,top:(o+r.vertical)*a}}replaceData(e){var t;super.replaceData(e);const r=null==(t=e.replacement.table)?void 0:t[this.props.accord];isNil$3(r)||this.setProps({accord:r.name})}onPropsChange(e,t){e.accord!==t.accord&&this.refresh()}}__decorateClass$B([observable],ExpandWidgetModel.prototype,"count",2),__decorateClass$B([action$1],ExpandWidgetModel.prototype,"setCount",1),__decorateClass$B([computed],ExpandWidgetModel.prototype,"accordList",1),__decorateClass$B([override],ExpandWidgetModel.prototype,"layoutRect",1);const ExpandView$1=observer((({model:e,adaptiveScale:t})=>{const{template:r}=e;return isNil$3(r)?jsx(Fragment,{}):jsx(StructContainer,{className:"expand-container",model:e,emptyTip:duchampIntl.get("Duchamp-Default_Reserve_Canvas_Text"),overflow:"auto",outline:!1,adaptiveScale:t,children:range$1(e.count).map((n=>jsx("div",{className:"expand-template-wrapper",style:calculateAdaptiveScaleStyle({style:e.getTemplateOffset(n),adaptiveScale:t,withTransform:!1}),children:jsx(WidgetWrapper,{widget:r,expandIndex:n,openLazyRender:!0,adaptiveScale:t})},n)))})})),getTransformScaleStyle=e=>e&&1!==e?{transform:"scale(".concat(e,")"),transformOrigin:"top left"}:{},EditExpandView=observer((({model:e,groupScale:t,containerStyleSize:r})=>{const{template:n,rect:o,count:i}=e;return n?jsx(StructContainer,{className:"expand-container",model:e,overflow:"auto",placeholderStyle:{position:"relative",...r},children:jsx("div",{className:"expand-view-content",style:{...getTransformScaleStyle(t),transformOrigin:"".concat(o.left,"px ").concat(o.top,"px")},children:Array.from({length:i}).map(((t,r)=>{const o=e.getTemplateOffset(r);return jsx("div",{className:"expand-template-wrapper",style:o,children:jsx(WidgetWrapper,{widget:n,expandIndex:r,openLazyRender:!0})},r)}))})}):jsx(Fragment,{})}));function useMemoizedFn(e){const t=reactExports.useRef(e);t.current=reactExports.useMemo((()=>e),[e]);const r=reactExports.useRef();return r.current||(r.current=function(...e){return t.current.apply(this,e)}),r.current}const ScrollableContainerWidget=reactExports.forwardRef((({model:e,width:t,height:r,style:n,className:o,placeholderStyle:i,children:a},s)=>{var l;const{story:{stickyInfo:c},platform:u}=useStore(),{scale:d}=u,{scroll:h,areaRect:p,flattenChildWidgets:f}=e,{width:g,height:m}=p,y=reactExports.useRef(null),v=(null==(l=c.widget)?void 0:l.id)===e.id,_=useScrollBarInitialize(y,["touchstart","mousemove"]),b=useMemoizedFn(debounce$4((()=>{if(!y.current)return;const t=y.current;e.updateScrollPosition({x:t.scrollLeft,y:t.scrollTop})}),100)),C=(e,t=d)=>{var r;e.target&&(null==(r=y.current)||r.scrollTo(0,e.target.offsetTop/t))};return reactExports.useImperativeHandle(s,(()=>({getContainerEl:()=>y.current,scrollToWidget:C}))),reactExports.useEffect((()=>{var e;r&&(null==(e=y.current)||e.scrollTo(h.x,h.y))}),[h,r,f,v]),jsxs("div",{className:classNames$1("structure-reverse-container",o),ref:y,style:{width:t,height:r,overflow:_?"auto":"hidden",...n},onScroll:b,children:[jsx("div",{className:"structure-reverse-placeholder",style:{width:g,height:m,...i}}),a]})}));ScrollableContainerWidget.displayName="ScrollableContainer";const ScrollableContainer=observer(ScrollableContainerWidget),WidgetWrapper$1=observer((({className:e,widget:t,rect:r,openLazyRender:n=!1,autoHeight:o=!1,expandIndex:i,adaptiveScale:a,style:s})=>{const{left:l,top:c,width:u,height:d}=t.rect,h=calculateAdaptiveScaleStyle({adaptiveScale:a,style:{...r&&{position:"absolute",left:l-r.left,top:c-r.top},width:u,height:o?"100%":d},withTransform:!1});return jsx(WidgetWrapper,{widget:t,adaptiveScale:a,expandIndex:i,autoHeight:o,className:classNames$1("mobile-widget-wrapper",e),withPosition:!1,style:{...h,...s},openLazyRender:n})})),PreviewExpandView=observer((({model:e,containerStyleSize:t,adaptiveScale:r})=>{const{template:n,count:o}=e;return n?jsx(ScrollableContainer,{className:"expand-view-container",ref:e.scrollContainerRef,model:e,style:t,placeholderStyle:{...t,position:"relative"},children:jsx("div",{className:"expand-view-content",children:Array.from({length:o}).map(((t,o)=>{const i=calculateAdaptiveScaleStyle({adaptiveScale:r,style:e.getTemplateOffset(o),withTransform:!1});return jsx("div",{className:"expand-template-wrapper",style:i,children:jsx(WidgetWrapper$1,{widget:n,expandIndex:o,adaptiveScale:r,openLazyRender:!0})},o)}))})}):jsx(Fragment,{})}));function getExpandTemplateSize(e,t,r,n={width:0,height:0}){const{width:o,height:i}=n;let a=0,s=0;return t.type===LAYOUT_TYPE$1.COLUMN?(a=t.value,s=Math.ceil(e/t.value)):(s=t.value,a=Math.ceil(e/t.value)),{width:o*a+r.horizontal*(a-1),height:i*s+r.vertical*(s-1)}}const useExpandStyle=({layout:e,interval:t,count:r,width:n,height:o,expandWidth:i,adaptiveScale:a,templateWidth:s,templateHeight:l,fluidOrMagneticLayout:c})=>{const u=reactExports.useMemo((()=>getExpandTemplateSize(r,e,t,{width:s,height:l})),[r,e,t,s,l]),d=reactExports.useMemo((()=>c?i/u.width:convertAdaptiveScaleToTransformScale(null!=a?a:{horizontal:1,vertical:1})),[c,i,u.width,a]),h=reactExports.useMemo((()=>{const e=c?u.width:n,t=c?u.height:o;return{width:e*d,height:t*d}}),[u,c,n,o,d]);return{groupScale:d,containerStyleSize:h}},ExpandView=observer((({model:e,width:t,adaptiveScale:r})=>{var n,o;const{rect:i,count:a,template:s,isPreview:l,mobilePreviewLayout:c,props:{layout:u,interval:d}}=e,h=c===LAYOUT_TYPE$2.FLUID||c===LAYOUT_TYPE$2.MAGNETIC,{containerStyleSize:p,groupScale:f}=useExpandStyle({layout:u,interval:d,count:a,adaptiveScale:r,expandWidth:t,fluidOrMagneticLayout:h,width:i.width,height:i.height,templateWidth:null!=(n=null==s?void 0:s.width)?n:0,templateHeight:null!=(o=null==s?void 0:s.height)?o:0});return l?jsx(PreviewExpandView,{model:e,adaptiveScale:{horizontal:f,vertical:f},containerStyleSize:p}):jsx(EditExpandView,{model:e,groupScale:f,containerStyleSize:p})})),loadAndDisplayWidget=async(e,t)=>{const{parentContainerWidgets:r}=e;r.length&&await Promise.all(r.map((r=>{var n,o;return isDraggableTargetStructureWidget(r)?null==(o=(n=r.model).scrollToWidget)?void 0:o.call(n,e,t):Promise.resolve()})))};function getDistanceBetweenDoms(e,t){if(!e||!t)return 0;const r=e.getBoundingClientRect(),n=t.getBoundingClientRect();return Math.abs(r.top-n.top)}const getNavigationText=(e,t,r)=>{const n=t.reduce(((e,t)=>{var r,n;const o=null==(n=null==(r=t.platform.mobile.props.previewConfig)?void 0:r.navigation)?void 0:n.text;return o&&e.push({id:t.id,name:o}),e}),[]);return isUniqueOrOwnName(n,e,r.id)?e:createUniqueName(n.map((e=>e.name)),"".concat(e,"_c"))},isValidAndNotInExpand=e=>e.visible&&e.platform.mobile.isCanvasValid()&&!widgetIsInExpand(e),isWidgetNavigationTextEquals=(e,t)=>{var r;const{enable:n,text:o}=(null==(r=e.platform.mobile.props.previewConfig)?void 0:r.navigation)||{};return n&&o&&o===t},PreviewConfig=observer((({widget:e})=>{var t,r,n,o,i,a;const{story:{widgets:s}}=useStore(),{previewConfig:l={navigation:{enable:!1,text:e.name},pinchToZoom:{enable:!1}}}=e.platform.mobile.props;if(!l)return jsx(Fragment,{});const c=(t,r)=>{const n=toJS(e.platform.mobile.props)||{};set$3(n,t,r),e.platform.mobile.setValue(n)};return jsx("div",{className:"mobile-preview-config-action-config",children:jsxs(GridItem,{children:[jsxs(LineItem,{label:duchampIntl.get("Duchamp-Navigation"),icon:jsx(IconPopover,{icon:"icon-help",content:duchampIntl.get("Duchamp-Navigation_Tip")}),children:[jsx(Checkbox$4,{text:duchampIntl.get("Duchamp-Navigation_Open"),value:null!=(r=null==(t=l.navigation)?void 0:t.enable)&&r,onChange:t=>{var r,n;c("previewConfig.navigation",{enable:t,text:getNavigationText(null!=(n=null==(r=null==l?void 0:l.navigation)?void 0:r.text)?n:e.name,s,e)})}}),(null==(n=l.navigation)?void 0:n.enable)&&jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Navigation_Title"),style:{marginTop:10},children:jsx(NameConfigInput,{value:null!=(i=null==(o=l.navigation)?void 0:o.text)?i:"",onChange:e=>c("previewConfig.navigation",{text:e,enable:!0}),repeatValidator:t=>!s.some((r=>{var n,o;return(null==(o=null==(n=r.model.props.previewConfig)?void 0:n.navigation)?void 0:o.text)===t&&r.id!==e.id}))},e.id)})]}),jsx(LineItem,{label:duchampIntl.get("Duchamp-PinchToZoom"),hide:!widgetIsWorkbook(e.type),children:jsx(Checkbox$4,{text:duchampIntl.get("Duchamp-PinchToZoom_Open"),value:null==(a=l.pinchToZoom)?void 0:a.enable,onChange:e=>{c("previewConfig.pinchToZoom",{enable:e})}})})]})})})),LabelItem=({label:e,visible:t=!0,style:r,className:n,children:o})=>jsxs("div",{className:"label-item",style:{...r,display:t?"":"none"},children:[jsx("div",{className:"label",children:e}),jsx("div",{className:n,children:o})]}),AnimationClassData={in:{label:duchampIntl.get("Duchamp-Enter"),children:[{label:duchampIntl.get("Duchamp-Fade_In"),value:ANIMATION_TYPE.FADE_IN},{label:duchampIntl.get("Duchamp-Enter_Right"),value:ANIMATION_TYPE.FADE_IN_LEFT},{label:duchampIntl.get("Duchamp-Enter_Left"),value:ANIMATION_TYPE.FADE_IN_RIGHT},{label:duchampIntl.get("Duchamp-Go_Up"),value:ANIMATION_TYPE.FADE_IN_UP},{label:duchampIntl.get("Duchamp-Go_Down"),value:ANIMATION_TYPE.FADE_IN_DOWN}]},out:{label:duchampIntl.get("Duchamp-Quit"),children:[{label:duchampIntl.get("Duchamp-Fade_Out"),value:ANIMATION_TYPE.FADE_OUT},{label:duchampIntl.get("Duchamp-Exit_Left"),value:ANIMATION_TYPE.FADE_OUT_LEFT},{label:duchampIntl.get("Duchamp-Exit_Right"),value:ANIMATION_TYPE.FADE_OUT_RIGHT},{label:duchampIntl.get("Duchamp-Exit_Up"),value:ANIMATION_TYPE.FADE_OUT_UP},{label:duchampIntl.get("Duchamp-Exit_Down"),value:ANIMATION_TYPE.FADE_OUT_DOWN}]}},defaultInAnimation={motion:ANIMATION_MOTION.START,name:ANIMATION_TYPE.FADE_IN,duration:1e3,delay:0},defaultOutAnimation={motion:ANIMATION_MOTION.START,name:ANIMATION_TYPE.FADE_OUT,duration:1e3,delay:0},defaultDelayTime=6,getAnimationLabel=(e,t)=>{var r;return(null==(r=AnimationClassData[t].children.find((t=>t.value===e)))?void 0:r.label)||e},getAnimationDesc=e=>{let t="",r="";const n=e.in,o=e.out;return n&&(t=n.name===ANIMATION_NAME.NONE?duchampIntl.get("Duchamp-No_Entry_Animation"):duchampIntl.get("Duchamp-Entry_Animation_Desc",n.motion===ANIMATION_MOTION.START?duchampIntl.get("Duchamp-When_Switching_To_The_Previous_Page"):duchampIntl.get("Duchamp-After_The_Previous_Page_Completely_Disappeared"),0===oldTime2TimeSecond(n.delay).value?duchampIntl.get("Duchamp-Immediately"):duchampIntl.get("Duchamp-Delay",timeUnitToString(oldTime2TimeSecond(n.delay))),getAnimationLabel(n.name,"in"),timeUnitToString(oldTime2TimeMillisecond(n.duration)))),o&&(r=o.name===ANIMATION_NAME.NONE?duchampIntl.get("Duchamp-No_Exit_Animation"):duchampIntl.get("Duchamp-Exit_Animation_Desc",0===oldTime2TimeSecond(o.delay).value?duchampIntl.get("Duchamp-Immediately"):duchampIntl.get("Duchamp-Delay",timeUnitToString(oldTime2TimeSecond(o.delay))),getAnimationLabel(o.name,"out"),timeUnitToString(oldTime2TimeMillisecond(o.duration)))),[t,r]},{Link:Link$1}=Typography,{Option:Option$7}=Select$1,DelayItem={DELAY:"delay",IMMEDIATELY:"immediately"},AnimationModal=({animation:e,onOk:t,onCancel:r})=>{const[n,o]=reactExports.useState({...e.in||defaultInAnimation}),[i,a]=reactExports.useState({...e.out||defaultOutAnimation}),[s,l]=reactExports.useState(0!==timeUnitToSecond(oldTime2TimeSecond(n.delay))),[c,u]=reactExports.useState(0!==timeUnitToSecond(oldTime2TimeSecond(i.delay))),[d,h]=useUpdateValue$1(oldTime2TimeMillisecond(n.duration),[n]),[p,f]=useUpdateValue$1(oldTime2TimeMillisecond(i.duration),[i]),[g,m]=useUpdateValue$1(oldTime2TimeSecond(n.delay),[n]),[y,v]=useUpdateValue$1(oldTime2TimeSecond(i.delay),[i]),_=e=>{o({...n,delay:e})},b=e=>{a({...i,delay:e})},C=jsx(Link$1,{href:duchampIntl.get("Duchamp-Widget_Animation_Config_Help_Link"),target:"_blank",children:duchampIntl.get("Duchamp-How_To_Set_Up_Animation_Effects")});return jsxs(FVSDialog,{className:"animation-config-dialog",visible:!0,title:duchampIntl.get("Duchamp-Page_Animation_Settings"),onOk:()=>{t({in:n,out:i})},onCancel:r,props4Cancel:{},props4Ok:{},footer:C,maskClosable:!1,styles:{body:{padding:"20px 100px"}},children:[jsx(LabelItem,{label:duchampIntl.get("Duchamp-Enter_Animation"),children:jsxs(Select$1,{value:n.name,style:{width:340},onChange:e=>{o({...n,name:e})},children:[jsx(Option$7,{value:ANIMATION_NAME.NONE,children:duchampIntl.get("Duchamp-Without")}),AnimationClassData.in.children.map((e=>jsx(Option$7,{value:e.value,children:e.label},e.value)))]})}),jsx(LabelItem,{label:duchampIntl.get("Duchamp-Animation_Duration"),visible:n.name!==ANIMATION_NAME.NONE,children:jsx(TimeUnitInput,{value:d,onChange:e=>{h(e),o({...n,duration:e})},min:1,max:100})}),jsx(LabelItem,{className:"space-vertical",label:duchampIntl.get("Duchamp-Timing_Of_Entry"),visible:n.name!==ANIMATION_NAME.NONE,children:jsxs(Fragment,{children:[jsxs(Select$1,{value:n.motion,style:{width:340},onChange:e=>{o({...n,motion:e})},children:[jsx(Option$7,{value:ANIMATION_MOTION.START,children:duchampIntl.get("Duchamp-When_Switching_To_The_Previous_Page")}),jsx(Option$7,{value:ANIMATION_MOTION.END,children:duchampIntl.get("Duchamp-After_The_Previous_Page_Completely_Disappeared")})]}),jsxs(Select$1,{value:s?DelayItem.DELAY:DelayItem.IMMEDIATELY,style:{width:340},onChange:e=>{l(e===DelayItem.DELAY),e===DelayItem.DELAY?_(defaultDelayTime):_(0)},children:[jsx(Option$7,{value:DelayItem.IMMEDIATELY,children:duchampIntl.get("Duchamp-Enter_Now")}),jsx(Option$7,{value:DelayItem.DELAY,children:duchampIntl.get("Duchamp-Delayed_Entry")})]}),s?jsx("div",{style:{width:219},children:jsx(TimeUnitInput,{value:g,onChange:e=>{m(e),o({...n,delay:e})},min:.1,max:3600})}):void 0]})}),jsx(Divider,{className:"divider"}),jsx(LabelItem,{label:duchampIntl.get("Duchamp-Exit_Animation"),children:jsxs(Select$1,{value:i.name,style:{width:340},onChange:e=>{a({...i,name:e})},children:[jsx(Option$7,{value:ANIMATION_NAME.NONE,children:duchampIntl.get("Duchamp-Without")}),AnimationClassData.out.children.map((e=>jsx(Option$7,{value:e.value,children:e.label},e.value)))]})}),jsx(LabelItem,{label:duchampIntl.get("Duchamp-Animation_Duration"),visible:i.name!==ANIMATION_NAME.NONE,children:jsx(TimeUnitInput,{value:p,onChange:e=>{f(e),a({...i,duration:e})},min:1,max:100})}),jsx(LabelItem,{className:"space-vertical",label:duchampIntl.get("Duchamp-When_To_Exit"),visible:i.name!==ANIMATION_NAME.NONE,children:jsxs(Fragment,{children:[jsxs(Select$1,{value:c?DelayItem.DELAY:DelayItem.IMMEDIATELY,style:{width:340},onChange:e=>{u(e===DelayItem.DELAY),e===DelayItem.DELAY?b(defaultDelayTime):b(0)},children:[jsx(Option$7,{value:DelayItem.IMMEDIATELY,children:duchampIntl.get("Duchamp-Exit_Immediately_When_The_Current_Page_Is_Switched")}),jsx(Option$7,{value:DelayItem.DELAY,children:duchampIntl.get("Duchamp-Delay_Exit_When_The_Current_Page_Is_Switched")})]}),jsx("div",{style:{display:c?"":"none",width:219},children:jsx(TimeUnitInput,{value:y,onChange:e=>{v(e),a({...i,delay:e})},min:.1,max:3600})})]})})]})};var lottie$1={exports:{}};(function(module,exports){var factory;"undefined"!=typeof navigator&&(factory=function(){var svgNS="http://www.w3.org/2000/svg",locationHref="",_useWebWorker=!1,initialDefaultFrame=-999999,setWebWorker=function(e){_useWebWorker=!!e},getWebWorker=function(){return _useWebWorker},setLocationHref=function(e){locationHref=e},getLocationHref=function(){return locationHref};function createTag(e){return document.createElement(e)}function extendPrototype(e,t){var r,n,o=e.length;for(r=0;r<o;r+=1)for(var i in n=e[r].prototype)Object.prototype.hasOwnProperty.call(n,i)&&(t.prototype[i]=n[i])}function getDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)}function createProxyFunction(e){function t(){}return t.prototype=e,t}var audioControllerFactory=function(){function e(e){this.audios=[],this.audioFactory=e,this._volume=1,this._isMuted=!1}return e.prototype={addAudio:function(e){this.audios.push(e)},pause:function(){var e,t=this.audios.length;for(e=0;e<t;e+=1)this.audios[e].pause()},resume:function(){var e,t=this.audios.length;for(e=0;e<t;e+=1)this.audios[e].resume()},setRate:function(e){var t,r=this.audios.length;for(t=0;t<r;t+=1)this.audios[t].setRate(e)},createAudio:function(e){return this.audioFactory?this.audioFactory(e):window.Howl?new window.Howl({src:[e]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(e){this.audioFactory=e},setVolume:function(e){this._volume=e,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){var e,t=this.audios.length;for(e=0;e<t;e+=1)this.audios[e].volume(this._volume*(this._isMuted?0:1))}},function(){return new e}}(),createTypedArray=function(){function e(e,t){var r,n=0,o=[];switch(e){case"int16":case"uint8c":r=1;break;default:r=1.1}for(n=0;n<t;n+=1)o.push(r);return o}return"function"==typeof Uint8ClampedArray&&"function"==typeof Float32Array?function(t,r){return"float32"===t?new Float32Array(r):"int16"===t?new Int16Array(r):"uint8c"===t?new Uint8ClampedArray(r):e(t,r)}:e}();function createSizedArray(e){return Array.apply(null,{length:e})}function _typeof$6(e){return(_typeof$6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var subframeEnabled=!0,expressionsPlugin=null,expressionsInterfaces=null,idPrefix$1="",isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMax=Math.max,bmMin=Math.min,BMMath={};!function(){var e,t=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],r=t.length;for(e=0;e<r;e+=1)BMMath[t[e]]=Math[t[e]]}(),BMMath.random=Math.random,BMMath.abs=function(e){if("object"===_typeof$6(e)&&e.length){var t,r=createSizedArray(e.length),n=e.length;for(t=0;t<n;t+=1)r[t]=Math.abs(e[t]);return r}return Math.abs(e)};var defaultCurveSegments=150,degToRads=Math.PI/180,roundCorner=.5519;function styleDiv(e){e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.display="block",e.style.transformOrigin="0 0",e.style.webkitTransformOrigin="0 0",e.style.backfaceVisibility="visible",e.style.webkitBackfaceVisibility="visible",e.style.transformStyle="preserve-3d",e.style.webkitTransformStyle="preserve-3d",e.style.mozTransformStyle="preserve-3d"}function BMEnterFrameEvent(e,t,r,n){this.type=e,this.currentTime=t,this.totalTime=r,this.direction=n<0?-1:1}function BMCompleteEvent(e,t){this.type=e,this.direction=t<0?-1:1}function BMCompleteLoopEvent(e,t,r,n){this.type=e,this.currentLoop=r,this.totalLoops=t,this.direction=n<0?-1:1}function BMSegmentStartEvent(e,t,r){this.type=e,this.firstFrame=t,this.totalFrames=r}function BMDestroyEvent(e,t){this.type=e,this.target=t}function BMRenderFrameErrorEvent(e,t){this.type="renderFrameError",this.nativeError=e,this.currentTime=t}function BMConfigErrorEvent(e){this.type="configError",this.nativeError=e}var createElementID=function(){var e=0;return function(){return idPrefix$1+"__lottie_element_"+(e+=1)}}();function HSVtoRGB(e,t,r){var n,o,i,a,s,l,c,u;switch(l=r*(1-t),c=r*(1-(s=6*e-(a=Math.floor(6*e)))*t),u=r*(1-(1-s)*t),a%6){case 0:n=r,o=u,i=l;break;case 1:n=c,o=r,i=l;break;case 2:n=l,o=r,i=u;break;case 3:n=l,o=c,i=r;break;case 4:n=u,o=l,i=r;break;case 5:n=r,o=l,i=c}return[n,o,i]}function RGBtoHSV(e,t,r){var n,o=Math.max(e,t,r),i=Math.min(e,t,r),a=o-i,s=0===o?0:a/o,l=o/255;switch(o){case i:n=0;break;case e:n=t-r+a*(t<r?6:0),n/=6*a;break;case t:n=r-e+2*a,n/=6*a;break;case r:n=e-t+4*a,n/=6*a}return[n,s,l]}function addSaturationToRGB(e,t){var r=RGBtoHSV(255*e[0],255*e[1],255*e[2]);return r[1]+=t,r[1]>1?r[1]=1:r[1]<=0&&(r[1]=0),HSVtoRGB(r[0],r[1],r[2])}function addBrightnessToRGB(e,t){var r=RGBtoHSV(255*e[0],255*e[1],255*e[2]);return r[2]+=t,r[2]>1?r[2]=1:r[2]<0&&(r[2]=0),HSVtoRGB(r[0],r[1],r[2])}function addHueToRGB(e,t){var r=RGBtoHSV(255*e[0],255*e[1],255*e[2]);return r[0]+=t/360,r[0]>1?r[0]-=1:r[0]<0&&(r[0]+=1),HSVtoRGB(r[0],r[1],r[2])}var rgbToHex=function(){var e,t,r=[];for(e=0;e<256;e+=1)t=e.toString(16),r[e]=1===t.length?"0"+t:t;return function(e,t,n){return e<0&&(e=0),t<0&&(t=0),n<0&&(n=0),"#"+r[e]+r[t]+r[n]}}(),setSubframeEnabled=function(e){subframeEnabled=!!e},getSubframeEnabled=function(){return subframeEnabled},setExpressionsPlugin=function(e){expressionsPlugin=e},getExpressionsPlugin=function(){return expressionsPlugin},setExpressionInterfaces=function(e){expressionsInterfaces=e},getExpressionInterfaces=function(){return expressionsInterfaces},setDefaultCurveSegments=function(e){defaultCurveSegments=e},getDefaultCurveSegments=function(){return defaultCurveSegments},setIdPrefix=function(e){idPrefix$1=e};function createNS(e){return document.createElementNS(svgNS,e)}function _typeof$5(e){return(_typeof$5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var dataManager=function(){var e,t,r=1,n=[],o={onmessage:function(){},postMessage:function(t){e({data:t})}},i={postMessage:function(e){o.onmessage({data:e})}};function a(){t||(t=function(t){if(window.Worker&&window.Blob&&getWebWorker()){var r=new Blob(["var _workerSelf = self; self.onmessage = ",t.toString()],{type:"text/javascript"}),n=URL.createObjectURL(r);return new Worker(n)}return e=t,o}((function(e){if(i.dataManager||(i.dataManager=function(){function e(o,i){var a,s,l,c,d,h,p=o.length;for(s=0;s<p;s+=1)if("ks"in(a=o[s])&&!a.completed){if(a.completed=!0,a.hasMask){var f=a.masksProperties;for(c=f.length,l=0;l<c;l+=1)if(f[l].pt.k.i)n(f[l].pt.k);else for(h=f[l].pt.k.length,d=0;d<h;d+=1)f[l].pt.k[d].s&&n(f[l].pt.k[d].s[0]),f[l].pt.k[d].e&&n(f[l].pt.k[d].e[0])}0===a.ty?(a.layers=t(a.refId,i),e(a.layers,i)):4===a.ty?r(a.shapes):5===a.ty&&u(a)}}function t(e,t){var r=function(e,t){for(var r=0,n=t.length;r<n;){if(t[r].id===e)return t[r];r+=1}return null}(e,t);return r?r.layers.__used?JSON.parse(JSON.stringify(r.layers)):(r.layers.__used=!0,r.layers):null}function r(e){var t,o,i;for(t=e.length-1;t>=0;t-=1)if("sh"===e[t].ty)if(e[t].ks.k.i)n(e[t].ks.k);else for(i=e[t].ks.k.length,o=0;o<i;o+=1)e[t].ks.k[o].s&&n(e[t].ks.k[o].s[0]),e[t].ks.k[o].e&&n(e[t].ks.k[o].e[0]);else"gr"===e[t].ty&&r(e[t].it)}function n(e){var t,r=e.i.length;for(t=0;t<r;t+=1)e.i[t][0]+=e.v[t][0],e.i[t][1]+=e.v[t][1],e.o[t][0]+=e.v[t][0],e.o[t][1]+=e.v[t][1]}function o(e,t){var r=t?t.split("."):[100,100,100];return e[0]>r[0]||!(r[0]>e[0])&&(e[1]>r[1]||!(r[1]>e[1])&&(e[2]>r[2]||!(r[2]>e[2])&&null))}var i=function(){var e=[4,4,14];function t(e){var t,r,n,o=e.length;for(t=0;t<o;t+=1)5===e[t].ty&&(n=void 0,n=(r=e[t]).t.d,r.t.d={k:[{s:n,t:0}]})}return function(r){if(o(e,r.v)&&(t(r.layers),r.assets)){var n,i=r.assets.length;for(n=0;n<i;n+=1)r.assets[n].layers&&t(r.assets[n].layers)}}}(),a=function(){var e=[4,7,99];return function(t){if(t.chars&&!o(e,t.v)){var n,i=t.chars.length;for(n=0;n<i;n+=1){var a=t.chars[n];a.data&&a.data.shapes&&(r(a.data.shapes),a.data.ip=0,a.data.op=99999,a.data.st=0,a.data.sr=1,a.data.ks={p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0}},t.chars[n].t||(a.data.shapes.push({ty:"no"}),a.data.shapes[0].it.push({p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0},sk:{k:0,a:0},sa:{k:0,a:0},ty:"tr"})))}}}}(),s=function(){var e=[5,7,15];function t(e){var t,r,n=e.length;for(t=0;t<n;t+=1)5===e[t].ty&&(r=void 0,"number"==typeof(r=e[t].t.p).a&&(r.a={a:0,k:r.a}),"number"==typeof r.p&&(r.p={a:0,k:r.p}),"number"==typeof r.r&&(r.r={a:0,k:r.r}))}return function(r){if(o(e,r.v)&&(t(r.layers),r.assets)){var n,i=r.assets.length;for(n=0;n<i;n+=1)r.assets[n].layers&&t(r.assets[n].layers)}}}(),l=function(){var e=[4,1,9];function t(e){var r,n,o,i=e.length;for(r=0;r<i;r+=1)if("gr"===e[r].ty)t(e[r].it);else if("fl"===e[r].ty||"st"===e[r].ty)if(e[r].c.k&&e[r].c.k[0].i)for(o=e[r].c.k.length,n=0;n<o;n+=1)e[r].c.k[n].s&&(e[r].c.k[n].s[0]/=255,e[r].c.k[n].s[1]/=255,e[r].c.k[n].s[2]/=255,e[r].c.k[n].s[3]/=255),e[r].c.k[n].e&&(e[r].c.k[n].e[0]/=255,e[r].c.k[n].e[1]/=255,e[r].c.k[n].e[2]/=255,e[r].c.k[n].e[3]/=255);else e[r].c.k[0]/=255,e[r].c.k[1]/=255,e[r].c.k[2]/=255,e[r].c.k[3]/=255}function r(e){var r,n=e.length;for(r=0;r<n;r+=1)4===e[r].ty&&t(e[r].shapes)}return function(t){if(o(e,t.v)&&(r(t.layers),t.assets)){var n,i=t.assets.length;for(n=0;n<i;n+=1)t.assets[n].layers&&r(t.assets[n].layers)}}}(),c=function(){var e=[4,4,18];function t(e){var r,n,o;for(r=e.length-1;r>=0;r-=1)if("sh"===e[r].ty)if(e[r].ks.k.i)e[r].ks.k.c=e[r].closed;else for(o=e[r].ks.k.length,n=0;n<o;n+=1)e[r].ks.k[n].s&&(e[r].ks.k[n].s[0].c=e[r].closed),e[r].ks.k[n].e&&(e[r].ks.k[n].e[0].c=e[r].closed);else"gr"===e[r].ty&&t(e[r].it)}function r(e){var r,n,o,i,a,s,l=e.length;for(n=0;n<l;n+=1){if((r=e[n]).hasMask){var c=r.masksProperties;for(i=c.length,o=0;o<i;o+=1)if(c[o].pt.k.i)c[o].pt.k.c=c[o].cl;else for(s=c[o].pt.k.length,a=0;a<s;a+=1)c[o].pt.k[a].s&&(c[o].pt.k[a].s[0].c=c[o].cl),c[o].pt.k[a].e&&(c[o].pt.k[a].e[0].c=c[o].cl)}4===r.ty&&t(r.shapes)}}return function(t){if(o(e,t.v)&&(r(t.layers),t.assets)){var n,i=t.assets.length;for(n=0;n<i;n+=1)t.assets[n].layers&&r(t.assets[n].layers)}}}();function u(e){0===e.t.a.length&&e.t.p}var d={completeData:function(r){r.__complete||(l(r),i(r),a(r),s(r),c(r),e(r.layers,r.assets),function(r,n){if(r){var o=0,i=r.length;for(o=0;o<i;o+=1)1===r[o].t&&(r[o].data.layers=t(r[o].data.refId,n),e(r[o].data.layers,n))}}(r.chars,r.assets),r.__complete=!0)}};return d.checkColors=l,d.checkChars=a,d.checkPathProperties=s,d.checkShapes=c,d.completeLayers=e,d}()),i.assetLoader||(i.assetLoader=function(){function e(e){var t=e.getResponseHeader("content-type");return t&&"json"===e.responseType&&-1!==t.indexOf("json")||e.response&&"object"===_typeof$5(e.response)?e.response:e.response&&"string"==typeof e.response?JSON.parse(e.response):e.responseText?JSON.parse(e.responseText):null}return{load:function(t,r,n,o){var i,a=new XMLHttpRequest;try{a.responseType="json"}catch(s){}a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status)i=e(a),n(i);else try{i=e(a),n(i)}catch(s){o&&o(s)}};try{a.open(["G","E","T"].join(""),t,!0)}catch(l){a.open(["G","E","T"].join(""),r+"/"+t,!0)}a.send()}}}()),"loadAnimation"===e.data.type)i.assetLoader.load(e.data.path,e.data.fullPath,(function(t){i.dataManager.completeData(t),i.postMessage({id:e.data.id,payload:t,status:"success"})}),(function(){i.postMessage({id:e.data.id,status:"error"})}));else if("complete"===e.data.type){var t=e.data.animation;i.dataManager.completeData(t),i.postMessage({id:e.data.id,payload:t,status:"success"})}else"loadData"===e.data.type&&i.assetLoader.load(e.data.path,e.data.fullPath,(function(t){i.postMessage({id:e.data.id,payload:t,status:"success"})}),(function(){i.postMessage({id:e.data.id,status:"error"})}))})),t.onmessage=function(e){var t=e.data,r=t.id,o=n[r];n[r]=null,"success"===t.status?o.onComplete(t.payload):o.onError&&o.onError()})}function s(e,t){var o="processId_"+(r+=1);return n[o]={onComplete:e,onError:t},o}return{loadAnimation:function(e,r,n){a();var o=s(r,n);t.postMessage({type:"loadAnimation",path:e,fullPath:window.location.origin+window.location.pathname,id:o})},loadData:function(e,r,n){a();var o=s(r,n);t.postMessage({type:"loadData",path:e,fullPath:window.location.origin+window.location.pathname,id:o})},completeAnimation:function(e,r,n){a();var o=s(r,n);t.postMessage({type:"complete",animation:e,id:o})}}}(),ImagePreloader=function(){var e=function(){var e=createTag("canvas");e.width=1,e.height=1;var t=e.getContext("2d");return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),e}();function t(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function r(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function n(e,t,r){var n="";if(e.e)n=e.p;else if(t){var o=e.p;-1!==o.indexOf("images/")&&(o=o.split("/")[1]),n=t+o}else n=r,n+=e.u?e.u:"",n+=e.p;return n}function o(e){var t=0,r=setInterval(function(){(e.getBBox().width||t>500)&&(this._imageLoaded(),clearInterval(r)),t+=1}.bind(this),50)}function i(e){var t={assetData:e},r=n(e,this.assetsPath,this.path);return dataManager.loadData(r,function(e){t.img=e,this._footageLoaded()}.bind(this),function(){t.img={},this._footageLoaded()}.bind(this)),t}function a(){this._imageLoaded=t.bind(this),this._footageLoaded=r.bind(this),this.testImageLoaded=o.bind(this),this.createFootageData=i.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return a.prototype={loadAssets:function(e,t){var r;this.imagesLoadedCb=t;var n=e.length;for(r=0;r<n;r+=1)e[r].layers||(e[r].t&&"seq"!==e[r].t?3===e[r].t&&(this.totalFootages+=1,this.images.push(this.createFootageData(e[r]))):(this.totalImages+=1,this.images.push(this._createImageData(e[r]))))},setAssetsPath:function(e){this.assetsPath=e||""},setPath:function(e){this.path=e||""},loadedImages:function(){return this.totalImages===this.loadedAssets},loadedFootages:function(){return this.totalFootages===this.loadedFootagesCount},destroy:function(){this.imagesLoadedCb=null,this.images.length=0},getAsset:function(e){for(var t=0,r=this.images.length;t<r;){if(this.images[t].assetData===e)return this.images[t].img;t+=1}return null},createImgData:function(t){var r=n(t,this.assetsPath,this.path),o=createTag("img");o.crossOrigin="anonymous",o.addEventListener("load",this._imageLoaded,!1),o.addEventListener("error",function(){i.img=e,this._imageLoaded()}.bind(this),!1),o.src=r;var i={img:o,assetData:t};return i},createImageData:function(t){var r=n(t,this.assetsPath,this.path),o=createNS("image");isSafari?this.testImageLoaded(o):o.addEventListener("load",this._imageLoaded,!1),o.addEventListener("error",function(){i.img=e,this._imageLoaded()}.bind(this),!1),o.setAttributeNS("http://www.w3.org/1999/xlink","href",r),this._elementHelper.append?this._elementHelper.append(o):this._elementHelper.appendChild(o);var i={img:o,assetData:t};return i},imageLoaded:t,footageLoaded:r,setCacheType:function(e,t){"svg"===e?(this._elementHelper=t,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}},a}();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(e,t){if(this._cbs[e])for(var r=this._cbs[e],n=0;n<r.length;n+=1)r[n](t)},addEventListener:function(e,t){return this._cbs[e]||(this._cbs[e]=[]),this._cbs[e].push(t),function(){this.removeEventListener(e,t)}.bind(this)},removeEventListener:function(e,t){if(t){if(this._cbs[e]){for(var r=0,n=this._cbs[e].length;r<n;)this._cbs[e][r]===t&&(this._cbs[e].splice(r,1),r-=1,n-=1),r+=1;this._cbs[e].length||(this._cbs[e]=null)}}else this._cbs[e]=null}};var markerParser=function(){function e(e){for(var t,r=e.split("\r\n"),n={},o=0,i=0;i<r.length;i+=1)2===(t=r[i].split(":")).length&&(n[t[0]]=t[1].trim(),o+=1);if(0===o)throw new Error;return n}return function(t){for(var r=[],n=0;n<t.length;n+=1){var o=t[n],i={time:o.tm,duration:o.dr};try{i.payload=JSON.parse(t[n].cm)}catch(a){try{i.payload=e(t[n].cm)}catch(s){i.payload={name:t[n].cm}}}r.push(i)}return r}}(),ProjectInterface=function(){function e(e){this.compositions.push(e)}return function(){function t(e){for(var t=0,r=this.compositions.length;t<r;){if(this.compositions[t].data&&this.compositions[t].data.nm===e)return this.compositions[t].prepareFrame&&this.compositions[t].data.xt&&this.compositions[t].prepareFrame(this.currentFrame),this.compositions[t].compInterface;t+=1}return null}return t.compositions=[],t.currentFrame=0,t.registerComposition=e,t}}(),renderers={},registerRenderer=function(e,t){renderers[e]=t};function getRenderer(e){return renderers[e]}function getRegisteredRenderer(){if(renderers.canvas)return"canvas";for(var e in renderers)if(renderers[e])return e;return""}function _typeof$4(e){return(_typeof$4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=getSubframeEnabled(),this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader,this.audioController=audioControllerFactory(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this),this.drawnFrameEvent=new BMEnterFrameEvent("drawnFrame",0,0,0),this.expressionsPlugin=getExpressionsPlugin()};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(e){(e.wrapper||e.container)&&(this.wrapper=e.wrapper||e.container);var t="svg";e.animType?t=e.animType:e.renderer&&(t=e.renderer);var r=getRenderer(t);this.renderer=new r(this,e.rendererSettings),this.imagePreloader.setCacheType(t,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=t,""===e.loop||null===e.loop||void 0===e.loop||!0===e.loop?this.loop=!0:!1===e.loop?this.loop=!1:this.loop=parseInt(e.loop,10),this.autoplay=!("autoplay"in e)||e.autoplay,this.name=e.name?e.name:"",this.autoloadSegments=!Object.prototype.hasOwnProperty.call(e,"autoloadSegments")||e.autoloadSegments,this.assetsPath=e.assetsPath,this.initialSegment=e.initialSegment,e.audioFactory&&this.audioController.setAudioFactory(e.audioFactory),e.animationData?this.setupAnimation(e.animationData):e.path&&(-1!==e.path.lastIndexOf("\\")?this.path=e.path.substr(0,e.path.lastIndexOf("\\")+1):this.path=e.path.substr(0,e.path.lastIndexOf("/")+1),this.fileName=e.path.substr(e.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),dataManager.loadAnimation(e.path,this.configAnimation,this.onSetupError))},AnimationItem.prototype.onSetupError=function(){this.trigger("data_failed")},AnimationItem.prototype.setupAnimation=function(e){dataManager.completeAnimation(e,this.configAnimation)},AnimationItem.prototype.setData=function(e,t){t&&"object"!==_typeof$4(t)&&(t=JSON.parse(t));var r={wrapper:e,animationData:t},n=e.attributes;r.path=n.getNamedItem("data-animation-path")?n.getNamedItem("data-animation-path").value:n.getNamedItem("data-bm-path")?n.getNamedItem("data-bm-path").value:n.getNamedItem("bm-path")?n.getNamedItem("bm-path").value:"",r.animType=n.getNamedItem("data-anim-type")?n.getNamedItem("data-anim-type").value:n.getNamedItem("data-bm-type")?n.getNamedItem("data-bm-type").value:n.getNamedItem("bm-type")?n.getNamedItem("bm-type").value:n.getNamedItem("data-bm-renderer")?n.getNamedItem("data-bm-renderer").value:n.getNamedItem("bm-renderer")?n.getNamedItem("bm-renderer").value:getRegisteredRenderer()||"canvas";var o=n.getNamedItem("data-anim-loop")?n.getNamedItem("data-anim-loop").value:n.getNamedItem("data-bm-loop")?n.getNamedItem("data-bm-loop").value:n.getNamedItem("bm-loop")?n.getNamedItem("bm-loop").value:"";"false"===o?r.loop=!1:"true"===o?r.loop=!0:""!==o&&(r.loop=parseInt(o,10));var i=n.getNamedItem("data-anim-autoplay")?n.getNamedItem("data-anim-autoplay").value:n.getNamedItem("data-bm-autoplay")?n.getNamedItem("data-bm-autoplay").value:!n.getNamedItem("bm-autoplay")||n.getNamedItem("bm-autoplay").value;r.autoplay="false"!==i,r.name=n.getNamedItem("data-name")?n.getNamedItem("data-name").value:n.getNamedItem("data-bm-name")?n.getNamedItem("data-bm-name").value:n.getNamedItem("bm-name")?n.getNamedItem("bm-name").value:"","false"===(n.getNamedItem("data-anim-prerender")?n.getNamedItem("data-anim-prerender").value:n.getNamedItem("data-bm-prerender")?n.getNamedItem("data-bm-prerender").value:n.getNamedItem("bm-prerender")?n.getNamedItem("bm-prerender").value:"")&&(r.prerender=!1),r.path?this.setParams(r):this.trigger("destroy")},AnimationItem.prototype.includeLayers=function(e){e.op>this.animationData.op&&(this.animationData.op=e.op,this.totalFrames=Math.floor(e.op-this.animationData.ip));var t,r,n=this.animationData.layers,o=n.length,i=e.layers,a=i.length;for(r=0;r<a;r+=1)for(t=0;t<o;){if(n[t].id===i[r].id){n[t]=i[r];break}t+=1}if((e.chars||e.fonts)&&(this.renderer.globalData.fontManager.addChars(e.chars),this.renderer.globalData.fontManager.addFonts(e.fonts,this.renderer.globalData.defs)),e.assets)for(o=e.assets.length,t=0;t<o;t+=1)this.animationData.assets.push(e.assets[t]);this.animationData.__complete=!1,dataManager.completeAnimation(this.animationData,this.onSegmentComplete)},AnimationItem.prototype.onSegmentComplete=function(e){this.animationData=e;var t=getExpressionsPlugin();t&&t.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var e=this.animationData.segments;if(!e||0===e.length||!this.autoloadSegments)return this.trigger("data_ready"),void(this.timeCompleted=this.totalFrames);var t=e.shift();this.timeCompleted=t.time*this.frameRate;var r=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,dataManager.loadData(r,this.includeLayers.bind(this),function(){this.trigger("data_failed")}.bind(this))},AnimationItem.prototype.loadSegments=function(){this.animationData.segments||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(e){if(this.renderer)try{this.animationData=e,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(e),e.assets||(e.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(e.assets),this.markers=markerParser(e.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(t){this.triggerConfigError(t)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){if(!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||"canvas"!==this.renderer.rendererType)&&this.imagePreloader.loadedFootages()){this.isLoaded=!0;var e=getExpressionsPlugin();e&&e.initExpressions(this),this.renderer.initItems(),setTimeout(function(){this.trigger("DOMLoaded")}.bind(this),0),this.gotoFrame(),this.autoplay&&this.play()}},AnimationItem.prototype.resize=function(e,t){var r="number"==typeof e?e:void 0,n="number"==typeof t?t:void 0;this.renderer.updateContainerSize(r,n)},AnimationItem.prototype.setSubframe=function(e){this.isSubframeEnabled=!!e},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame")},AnimationItem.prototype.renderFrame=function(){if(!1!==this.isLoaded&&this.renderer)try{this.expressionsPlugin&&this.expressionsPlugin.resetFrame(),this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(e){this.triggerRenderFrameError(e)}},AnimationItem.prototype.play=function(e){e&&this.name!==e||!0===this.isPaused&&(this.isPaused=!1,this.trigger("_play"),this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")))},AnimationItem.prototype.pause=function(e){e&&this.name!==e||!1===this.isPaused&&(this.isPaused=!0,this.trigger("_pause"),this._idle=!0,this.trigger("_idle"),this.audioController.pause())},AnimationItem.prototype.togglePause=function(e){e&&this.name!==e||(!0===this.isPaused?this.play():this.pause())},AnimationItem.prototype.stop=function(e){e&&this.name!==e||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.getMarkerData=function(e){for(var t,r=0;r<this.markers.length;r+=1)if((t=this.markers[r]).payload&&t.payload.name===e)return t;return null},AnimationItem.prototype.goToAndStop=function(e,t,r){if(!r||this.name===r){var n=Number(e);if(isNaN(n)){var o=this.getMarkerData(e);o&&this.goToAndStop(o.time,!0)}else t?this.setCurrentRawFrameValue(e):this.setCurrentRawFrameValue(e*this.frameModifier);this.pause()}},AnimationItem.prototype.goToAndPlay=function(e,t,r){if(!r||this.name===r){var n=Number(e);if(isNaN(n)){var o=this.getMarkerData(e);o&&(o.duration?this.playSegments([o.time,o.time+o.duration],!0):this.goToAndStop(o.time,!0))}else this.goToAndStop(n,t,r);this.play()}},AnimationItem.prototype.advanceTime=function(e){if(!0!==this.isPaused&&!1!==this.isLoaded){var t=this.currentRawFrame+e*this.frameModifier,r=!1;t>=this.totalFrames-1&&this.frameModifier>0?this.loop&&this.playCount!==this.loop?t>=this.totalFrames?(this.playCount+=1,this.checkSegments(t%this.totalFrames)||(this.setCurrentRawFrameValue(t%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(t):this.checkSegments(t>this.totalFrames?t%this.totalFrames:0)||(r=!0,t=this.totalFrames-1):t<0?this.checkSegments(t%this.totalFrames)||(!this.loop||this.playCount--<=0&&!0!==this.loop?(r=!0,t=0):(this.setCurrentRawFrameValue(this.totalFrames+t%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0)):this.setCurrentRawFrameValue(t),r&&(this.setCurrentRawFrameValue(t),this.pause(),this.trigger("complete"))}},AnimationItem.prototype.adjustSegment=function(e,t){this.playCount=0,e[1]<e[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=e[0]-e[1],this.timeCompleted=this.totalFrames,this.firstFrame=e[1],this.setCurrentRawFrameValue(this.totalFrames-.001-t)):e[1]>e[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=e[1]-e[0],this.timeCompleted=this.totalFrames,this.firstFrame=e[0],this.setCurrentRawFrameValue(.001+t)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(e,t){var r=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<e?r=e:this.currentRawFrame+this.firstFrame>t&&(r=t-e)),this.firstFrame=e,this.totalFrames=t-e,this.timeCompleted=this.totalFrames,-1!==r&&this.goToAndStop(r,!0)},AnimationItem.prototype.playSegments=function(e,t){if(t&&(this.segments.length=0),"object"===_typeof$4(e[0])){var r,n=e.length;for(r=0;r<n;r+=1)this.segments.push(e[r])}else this.segments.push(e);this.segments.length&&t&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(e){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),e&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(e){return!!this.segments.length&&(this.adjustSegment(this.segments.shift(),e),!0)},AnimationItem.prototype.destroy=function(e){e&&this.name!==e||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.expressionsPlugin=null,this.imagePreloader=null,this.projectInterface=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(e){this.currentRawFrame=e,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(e){this.playSpeed=e,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(e){this.playDirection=e<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.setLoop=function(e){this.loop=e},AnimationItem.prototype.setVolume=function(e,t){t&&this.name!==t||this.audioController.setVolume(e)},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume()},AnimationItem.prototype.mute=function(e){e&&this.name!==e||this.audioController.mute()},AnimationItem.prototype.unmute=function(e){e&&this.name!==e||this.audioController.unmute()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(e){var t="";if(e.e)t=e.p;else if(this.assetsPath){var r=e.p;-1!==r.indexOf("images/")&&(r=r.split("/")[1]),t=this.assetsPath+r}else t=this.path,t+=e.u?e.u:"",t+=e.p;return t},AnimationItem.prototype.getAssetData=function(e){for(var t=0,r=this.assets.length;t<r;){if(e===this.assets[t].id)return this.assets[t];t+=1}return null},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(e){return e?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.updateDocumentData=function(e,t,r){try{this.renderer.getElementByPath(e).updateDocumentData(t,r)}catch(n){}},AnimationItem.prototype.trigger=function(e){if(this._cbs&&this._cbs[e])switch(e){case"enterFrame":this.triggerEvent(e,new BMEnterFrameEvent(e,this.currentFrame,this.totalFrames,this.frameModifier));break;case"drawnFrame":this.drawnFrameEvent.currentTime=this.currentFrame,this.drawnFrameEvent.totalTime=this.totalFrames,this.drawnFrameEvent.direction=this.frameModifier,this.triggerEvent(e,this.drawnFrameEvent);break;case"loopComplete":this.triggerEvent(e,new BMCompleteLoopEvent(e,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(e,new BMCompleteEvent(e,this.frameMult));break;case"segmentStart":this.triggerEvent(e,new BMSegmentStartEvent(e,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(e,new BMDestroyEvent(e,this));break;default:this.triggerEvent(e)}"enterFrame"===e&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(e,this.currentFrame,this.totalFrames,this.frameMult)),"loopComplete"===e&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(e,this.loop,this.playCount,this.frameMult)),"complete"===e&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(e,this.frameMult)),"segmentStart"===e&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(e,this.firstFrame,this.totalFrames)),"destroy"===e&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(e,this))},AnimationItem.prototype.triggerRenderFrameError=function(e){var t=new BMRenderFrameErrorEvent(e,this.currentFrame);this.triggerEvent("error",t),this.onError&&this.onError.call(this,t)},AnimationItem.prototype.triggerConfigError=function(e){var t=new BMConfigErrorEvent(e,this.currentFrame);this.triggerEvent("error",t),this.onError&&this.onError.call(this,t)};var animationManager=function(){var e={},t=[],r=0,n=0,o=0,i=!0,a=!1;function s(e){for(var r=0,o=e.target;r<n;)t[r].animation===o&&(t.splice(r,1),r-=1,n-=1,o.isPaused||u()),r+=1}function l(e,r){if(!e)return null;for(var o=0;o<n;){if(t[o].elem===e&&null!==t[o].elem)return t[o].animation;o+=1}var i=new AnimationItem;return d(i,e),i.setData(e,r),i}function c(){o+=1,f()}function u(){o-=1}function d(e,r){e.addEventListener("destroy",s),e.addEventListener("_active",c),e.addEventListener("_idle",u),t.push({elem:r,animation:e}),n+=1}function h(e){var s,l=e-r;for(s=0;s<n;s+=1)t[s].animation.advanceTime(l);r=e,o&&!a?window.requestAnimationFrame(h):i=!0}function p(e){r=e,window.requestAnimationFrame(h)}function f(){!a&&o&&i&&(window.requestAnimationFrame(p),i=!1)}return e.registerAnimation=l,e.loadAnimation=function(e){var t=new AnimationItem;return d(t,null),t.setParams(e),t},e.setSpeed=function(e,r){var o;for(o=0;o<n;o+=1)t[o].animation.setSpeed(e,r)},e.setDirection=function(e,r){var o;for(o=0;o<n;o+=1)t[o].animation.setDirection(e,r)},e.play=function(e){var r;for(r=0;r<n;r+=1)t[r].animation.play(e)},e.pause=function(e){var r;for(r=0;r<n;r+=1)t[r].animation.pause(e)},e.stop=function(e){var r;for(r=0;r<n;r+=1)t[r].animation.stop(e)},e.togglePause=function(e){var r;for(r=0;r<n;r+=1)t[r].animation.togglePause(e)},e.searchAnimations=function(e,t,r){var n,o=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),i=o.length;for(n=0;n<i;n+=1)r&&o[n].setAttribute("data-bm-type",r),l(o[n],e);if(t&&0===i){r||(r="svg");var a=document.getElementsByTagName("body")[0];a.innerText="";var s=createTag("div");s.style.width="100%",s.style.height="100%",s.setAttribute("data-bm-type",r),a.appendChild(s),l(s,e)}},e.resize=function(){var e;for(e=0;e<n;e+=1)t[e].animation.resize()},e.goToAndStop=function(e,r,o){var i;for(i=0;i<n;i+=1)t[i].animation.goToAndStop(e,r,o)},e.destroy=function(e){var r;for(r=n-1;r>=0;r-=1)t[r].animation.destroy(e)},e.freeze=function(){a=!0},e.unfreeze=function(){a=!1,f()},e.setVolume=function(e,r){var o;for(o=0;o<n;o+=1)t[o].animation.setVolume(e,r)},e.mute=function(e){var r;for(r=0;r<n;r+=1)t[r].animation.mute(e)},e.unmute=function(e){var r;for(r=0;r<n;r+=1)t[r].animation.unmute(e)},e.getRegisteredAnimations=function(){var e,r=t.length,n=[];for(e=0;e<r;e+=1)n.push(t[e].animation);return n},e}(),BezierFactory=function(){var e={getBezierEasing:function(e,r,n,o,i){var a=i||("bez_"+e+"_"+r+"_"+n+"_"+o).replace(/\./g,"p");if(t[a])return t[a];var s=new u([e,r,n,o]);return t[a]=s,s}},t={},r=11,n=1/(r-1),o="function"==typeof Float32Array;function i(e,t){return 1-3*t+3*e}function a(e,t){return 3*t-6*e}function s(e){return 3*e}function l(e,t,r){return((i(t,r)*e+a(t,r))*e+s(t))*e}function c(e,t,r){return 3*i(t,r)*e*e+2*a(t,r)*e+s(t)}function u(e){this._p=e,this._mSampleValues=o?new Float32Array(r):new Array(r),this._precomputed=!1,this.get=this.get.bind(this)}return u.prototype={get:function(e){var t=this._p[0],r=this._p[1],n=this._p[2],o=this._p[3];return this._precomputed||this._precompute(),t===r&&n===o?e:0===e?0:1===e?1:l(this._getTForX(e),r,o)},_precompute:function(){var e=this._p[0],t=this._p[1],r=this._p[2],n=this._p[3];this._precomputed=!0,e===t&&r===n||this._calcSampleValues()},_calcSampleValues:function(){for(var e=this._p[0],t=this._p[2],o=0;o<r;++o)this._mSampleValues[o]=l(o*n,e,t)},_getTForX:function(e){for(var t=this._p[0],o=this._p[2],i=this._mSampleValues,a=0,s=1,u=r-1;s!==u&&i[s]<=e;++s)a+=n;var d=a+(e-i[--s])/(i[s+1]-i[s])*n,h=c(d,t,o);return h>=.001?function(e,t,r,n){for(var o=0;o<4;++o){var i=c(t,r,n);if(0===i)return t;t-=(l(t,r,n)-e)/i}return t}(e,d,t,o):0===h?d:function(e,t,r,n,o){var i,a,s=0;do{(i=l(a=t+(r-t)/2,n,o)-e)>0?r=a:t=a}while(Math.abs(i)>1e-7&&++s<10);return a}(e,a,a+n,t,o)}},e}(),pooling=function(){return{double:function(e){return e.concat(createSizedArray(e.length))}}}(),poolFactory=function(){return function(e,t,r){var n=0,o=e,i=createSizedArray(o);return{newElement:function(){return n?i[n-=1]:t()},release:function(e){n===o&&(i=pooling.double(i),o*=2),r&&r(e),i[n]=e,n+=1}}}}(),bezierLengthPool=poolFactory(8,(function(){return{addedLength:0,percents:createTypedArray("float32",getDefaultCurveSegments()),lengths:createTypedArray("float32",getDefaultCurveSegments())}})),segmentsLengthPool=poolFactory(8,(function(){return{lengths:[],totalLength:0}}),(function(e){var t,r=e.lengths.length;for(t=0;t<r;t+=1)bezierLengthPool.release(e.lengths[t]);e.lengths.length=0}));function bezFunction(){var e=Math;function t(e,t,r,n,o,i){var a=e*n+t*o+r*i-o*n-i*e-r*t;return a>-.001&&a<.001}var r=function(){return function(e,t,r,n){var o,i,a,s,l,c,u=getDefaultCurveSegments(),d=0,h=[],p=[],f=bezierLengthPool.newElement();for(a=r.length,o=0;o<u;o+=1){for(l=o/(u-1),c=0,i=0;i<a;i+=1)s=bmPow(1-l,3)*e[i]+3*bmPow(1-l,2)*l*r[i]+3*(1-l)*bmPow(l,2)*n[i]+bmPow(l,3)*t[i],h[i]=s,null!==p[i]&&(c+=bmPow(h[i]-p[i],2)),p[i]=h[i];c&&(d+=c=bmSqrt(c)),f.percents[o]=l,f.lengths[o]=d}return f.addedLength=d,f}}();function n(e){this.segmentLength=0,this.points=new Array(e)}function o(e,t){this.partialLength=e,this.point=t}var i=function(){var e={};return function(r,i,a,s){var l=(r[0]+"_"+r[1]+"_"+i[0]+"_"+i[1]+"_"+a[0]+"_"+a[1]+"_"+s[0]+"_"+s[1]).replace(/\./g,"p");if(!e[l]){var c,u,d,h,p,f,g,m=getDefaultCurveSegments(),y=0,v=null;2===r.length&&(r[0]!==i[0]||r[1]!==i[1])&&t(r[0],r[1],i[0],i[1],r[0]+a[0],r[1]+a[1])&&t(r[0],r[1],i[0],i[1],i[0]+s[0],i[1]+s[1])&&(m=2);var _=new n(m);for(d=a.length,c=0;c<m;c+=1){for(g=createSizedArray(d),p=c/(m-1),f=0,u=0;u<d;u+=1)h=bmPow(1-p,3)*r[u]+3*bmPow(1-p,2)*p*(r[u]+a[u])+3*(1-p)*bmPow(p,2)*(i[u]+s[u])+bmPow(p,3)*i[u],g[u]=h,null!==v&&(f+=bmPow(g[u]-v[u],2));y+=f=bmSqrt(f),_.points[c]=new o(f,g),v=g}_.segmentLength=y,e[l]=_}return e[l]}}();function a(e,t){var r=t.percents,n=t.lengths,o=r.length,i=bmFloor((o-1)*e),a=e*t.addedLength,s=0;if(i===o-1||0===i||a===n[i])return r[i];for(var l=n[i]>a?-1:1,c=!0;c;)if(n[i]<=a&&n[i+1]>a?(s=(a-n[i])/(n[i+1]-n[i]),c=!1):i+=l,i<0||i>=o-1){if(i===o-1)return r[i];c=!1}return r[i]+(r[i+1]-r[i])*s}var s=createTypedArray("float32",8);return{getSegmentsLength:function(e){var t,n=segmentsLengthPool.newElement(),o=e.c,i=e.v,a=e.o,s=e.i,l=e._length,c=n.lengths,u=0;for(t=0;t<l-1;t+=1)c[t]=r(i[t],i[t+1],a[t],s[t+1]),u+=c[t].addedLength;return o&&l&&(c[t]=r(i[t],i[0],a[t],s[0]),u+=c[t].addedLength),n.totalLength=u,n},getNewSegment:function(t,r,n,o,i,l,c){i<0?i=0:i>1&&(i=1);var u,d=a(i,c),h=a(l=l>1?1:l,c),p=t.length,f=1-d,g=1-h,m=f*f*f,y=d*f*f*3,v=d*d*f*3,_=d*d*d,b=f*f*g,C=d*f*g+f*d*g+f*f*h,E=d*d*g+f*d*h+d*f*h,T=d*d*h,S=f*g*g,P=d*g*g+f*h*g+f*g*h,w=d*h*g+f*h*h+d*g*h,x=d*h*h,O=g*g*g,$=h*g*g+g*h*g+g*g*h,I=h*h*g+g*h*h+h*g*h,R=h*h*h;for(u=0;u<p;u+=1)s[4*u]=e.round(1e3*(m*t[u]+y*n[u]+v*o[u]+_*r[u]))/1e3,s[4*u+1]=e.round(1e3*(b*t[u]+C*n[u]+E*o[u]+T*r[u]))/1e3,s[4*u+2]=e.round(1e3*(S*t[u]+P*n[u]+w*o[u]+x*r[u]))/1e3,s[4*u+3]=e.round(1e3*(O*t[u]+$*n[u]+I*o[u]+R*r[u]))/1e3;return s},getPointInSegment:function(t,r,n,o,i,s){var l=a(i,s),c=1-l;return[e.round(1e3*(c*c*c*t[0]+(l*c*c+c*l*c+c*c*l)*n[0]+(l*l*c+c*l*l+l*c*l)*o[0]+l*l*l*r[0]))/1e3,e.round(1e3*(c*c*c*t[1]+(l*c*c+c*l*c+c*c*l)*n[1]+(l*l*c+c*l*l+l*c*l)*o[1]+l*l*l*r[1]))/1e3]},buildBezierData:i,pointOnLine2D:t,pointOnLine3D:function(r,n,o,i,a,s,l,c,u){if(0===o&&0===s&&0===u)return t(r,n,i,a,l,c);var d,h=e.sqrt(e.pow(i-r,2)+e.pow(a-n,2)+e.pow(s-o,2)),p=e.sqrt(e.pow(l-r,2)+e.pow(c-n,2)+e.pow(u-o,2)),f=e.sqrt(e.pow(l-i,2)+e.pow(c-a,2)+e.pow(u-s,2));return(d=h>p?h>f?h-p-f:f-p-h:f>p?f-p-h:p-h-f)>-1e-4&&d<1e-4}}}var bez=bezFunction(),initFrame=initialDefaultFrame,mathAbs=Math.abs;function interpolateValue(e,t){var r,n=this.offsetTime;"multidimensional"===this.propType&&(r=createTypedArray("float32",this.pv.length));for(var o,i,a,s,l,c,u,d,h,p=t.lastIndex,f=p,g=this.keyframes.length-1,m=!0;m;){if(o=this.keyframes[f],i=this.keyframes[f+1],f===g-1&&e>=i.t-n){o.h&&(o=i),p=0;break}if(i.t-n>e){p=f;break}f<g-1?f+=1:(p=0,m=!1)}a=this.keyframesMetadata[f]||{};var y,v=i.t-n,_=o.t-n;if(o.to){a.bezierData||(a.bezierData=bez.buildBezierData(o.s,i.s||o.e,o.to,o.ti));var b=a.bezierData;if(e>=v||e<_){var C=e>=v?b.points.length-1:0;for(l=b.points[C].point.length,s=0;s<l;s+=1)r[s]=b.points[C].point[s]}else{a.__fnct?h=a.__fnct:(h=BezierFactory.getBezierEasing(o.o.x,o.o.y,o.i.x,o.i.y,o.n).get,a.__fnct=h),c=h((e-_)/(v-_));var E,T=b.segmentLength*c,S=t.lastFrame<e&&t._lastKeyframeIndex===f?t._lastAddedLength:0;for(d=t.lastFrame<e&&t._lastKeyframeIndex===f?t._lastPoint:0,m=!0,u=b.points.length;m;){if(S+=b.points[d].partialLength,0===T||0===c||d===b.points.length-1){for(l=b.points[d].point.length,s=0;s<l;s+=1)r[s]=b.points[d].point[s];break}if(T>=S&&T<S+b.points[d+1].partialLength){for(E=(T-S)/b.points[d+1].partialLength,l=b.points[d].point.length,s=0;s<l;s+=1)r[s]=b.points[d].point[s]+(b.points[d+1].point[s]-b.points[d].point[s])*E;break}d<u-1?d+=1:m=!1}t._lastPoint=d,t._lastAddedLength=S-b.points[d].partialLength,t._lastKeyframeIndex=f}}else{var P,w,x,O,$;if(g=o.s.length,y=i.s||o.e,this.sh&&1!==o.h)e>=v?(r[0]=y[0],r[1]=y[1],r[2]=y[2]):e<=_?(r[0]=o.s[0],r[1]=o.s[1],r[2]=o.s[2]):quaternionToEuler(r,slerp(createQuaternion(o.s),createQuaternion(y),(e-_)/(v-_)));else for(f=0;f<g;f+=1)1!==o.h&&(e>=v?c=1:e<_?c=0:(o.o.x.constructor===Array?(a.__fnct||(a.__fnct=[]),a.__fnct[f]?h=a.__fnct[f]:(P=void 0===o.o.x[f]?o.o.x[0]:o.o.x[f],w=void 0===o.o.y[f]?o.o.y[0]:o.o.y[f],x=void 0===o.i.x[f]?o.i.x[0]:o.i.x[f],O=void 0===o.i.y[f]?o.i.y[0]:o.i.y[f],h=BezierFactory.getBezierEasing(P,w,x,O).get,a.__fnct[f]=h)):a.__fnct?h=a.__fnct:(P=o.o.x,w=o.o.y,x=o.i.x,O=o.i.y,h=BezierFactory.getBezierEasing(P,w,x,O).get,o.keyframeMetadata=h),c=h((e-_)/(v-_)))),y=i.s||o.e,$=1===o.h?o.s[f]:o.s[f]+(y[f]-o.s[f])*c,"multidimensional"===this.propType?r[f]=$:r=$}return t.lastIndex=p,r}function slerp(e,t,r){var n,o,i,a,s,l=[],c=e[0],u=e[1],d=e[2],h=e[3],p=t[0],f=t[1],g=t[2],m=t[3];return(o=c*p+u*f+d*g+h*m)<0&&(o=-o,p=-p,f=-f,g=-g,m=-m),1-o>1e-6?(n=Math.acos(o),i=Math.sin(n),a=Math.sin((1-r)*n)/i,s=Math.sin(r*n)/i):(a=1-r,s=r),l[0]=a*c+s*p,l[1]=a*u+s*f,l[2]=a*d+s*g,l[3]=a*h+s*m,l}function quaternionToEuler(e,t){var r=t[0],n=t[1],o=t[2],i=t[3],a=Math.atan2(2*n*i-2*r*o,1-2*n*n-2*o*o),s=Math.asin(2*r*n+2*o*i),l=Math.atan2(2*r*i-2*n*o,1-2*r*r-2*o*o);e[0]=a/degToRads,e[1]=s/degToRads,e[2]=l/degToRads}function createQuaternion(e){var t=e[0]*degToRads,r=e[1]*degToRads,n=e[2]*degToRads,o=Math.cos(t/2),i=Math.cos(r/2),a=Math.cos(n/2),s=Math.sin(t/2),l=Math.sin(r/2),c=Math.sin(n/2);return[s*l*a+o*i*c,s*i*a+o*l*c,o*l*a-s*i*c,o*i*a-s*l*c]}function getValueAtCurrentTime(){var e=this.comp.renderedFrame-this.offsetTime,t=this.keyframes[0].t-this.offsetTime,r=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(e===this._caching.lastFrame||this._caching.lastFrame!==initFrame&&(this._caching.lastFrame>=r&&e>=r||this._caching.lastFrame<t&&e<t))){this._caching.lastFrame>=e&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var n=this.interpolateValue(e,this._caching);this.pv=n}return this._caching.lastFrame=e,this.pv}function setVValue(e){var t;if("unidimensional"===this.propType)t=e*this.mult,mathAbs(this.v-t)>1e-5&&(this.v=t,this._mdf=!0);else for(var r=0,n=this.v.length;r<n;)t=e[r]*this.mult,mathAbs(this.v[r]-t)>1e-5&&(this.v[r]=t,this._mdf=!0),r+=1}function processEffectsSequence(){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{var e;this.lock=!0,this._mdf=this._isFirstFrame;var t=this.effectsSequence.length,r=this.kf?this.pv:this.data.k;for(e=0;e<t;e+=1)r=this.effectsSequence[e](r);this.setVValue(r),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function addEffect(e){this.effectsSequence.push(e),this.container.addDynamicProperty(this)}function ValueProperty(e,t,r,n){this.propType="unidimensional",this.mult=r||1,this.data=t,this.v=r?t.k*r:t.k,this.pv=t.k,this._mdf=!1,this.elem=e,this.container=n,this.comp=e.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function MultiDimensionalProperty(e,t,r,n){var o;this.propType="multidimensional",this.mult=r||1,this.data=t,this._mdf=!1,this.elem=e,this.container=n,this.comp=e.comp,this.k=!1,this.kf=!1,this.frameId=-1;var i=t.k.length;for(this.v=createTypedArray("float32",i),this.pv=createTypedArray("float32",i),this.vel=createTypedArray("float32",i),o=0;o<i;o+=1)this.v[o]=t.k[o]*this.mult,this.pv[o]=t.k[o];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function KeyframedValueProperty(e,t,r,n){this.propType="unidimensional",this.keyframes=t.k,this.keyframesMetadata=[],this.offsetTime=e.data.st,this.frameId=-1,this._caching={lastFrame:initFrame,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=t,this.mult=r||1,this.elem=e,this.container=n,this.comp=e.comp,this.v=initFrame,this.pv=initFrame,this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.addEffect=addEffect}function KeyframedMultidimensionalProperty(e,t,r,n){var o;this.propType="multidimensional";var i,a,s,l,c=t.k.length;for(o=0;o<c-1;o+=1)t.k[o].to&&t.k[o].s&&t.k[o+1]&&t.k[o+1].s&&(i=t.k[o].s,a=t.k[o+1].s,s=t.k[o].to,l=t.k[o].ti,(2===i.length&&(i[0]!==a[0]||i[1]!==a[1])&&bez.pointOnLine2D(i[0],i[1],a[0],a[1],i[0]+s[0],i[1]+s[1])&&bez.pointOnLine2D(i[0],i[1],a[0],a[1],a[0]+l[0],a[1]+l[1])||3===i.length&&(i[0]!==a[0]||i[1]!==a[1]||i[2]!==a[2])&&bez.pointOnLine3D(i[0],i[1],i[2],a[0],a[1],a[2],i[0]+s[0],i[1]+s[1],i[2]+s[2])&&bez.pointOnLine3D(i[0],i[1],i[2],a[0],a[1],a[2],a[0]+l[0],a[1]+l[1],a[2]+l[2]))&&(t.k[o].to=null,t.k[o].ti=null),i[0]===a[0]&&i[1]===a[1]&&0===s[0]&&0===s[1]&&0===l[0]&&0===l[1]&&(2===i.length||i[2]===a[2]&&0===s[2]&&0===l[2])&&(t.k[o].to=null,t.k[o].ti=null));this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.data=t,this.keyframes=t.k,this.keyframesMetadata=[],this.offsetTime=e.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=r||1,this.elem=e,this.container=n,this.comp=e.comp,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.frameId=-1;var u=t.k[0].s.length;for(this.v=createTypedArray("float32",u),this.pv=createTypedArray("float32",u),o=0;o<u;o+=1)this.v[o]=initFrame,this.pv[o]=initFrame;this._caching={lastFrame:initFrame,lastIndex:0,value:createTypedArray("float32",u)},this.addEffect=addEffect}var PropertyFactory=function(){return{getProp:function(e,t,r,n,o){var i;if(t.sid&&(t=e.globalData.slotManager.getProp(t)),t.k.length)if("number"==typeof t.k[0])i=new MultiDimensionalProperty(e,t,n,o);else switch(r){case 0:i=new KeyframedValueProperty(e,t,n,o);break;case 1:i=new KeyframedMultidimensionalProperty(e,t,n,o)}else i=new ValueProperty(e,t,n,o);return i.effectsSequence.length&&o.addDynamicProperty(i),i}}}();function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(e){-1===this.dynamicProperties.indexOf(e)&&(this.dynamicProperties.push(e),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){var e;this._mdf=!1;var t=this.dynamicProperties.length;for(e=0;e<t;e+=1)this.dynamicProperties[e].getValue(),this.dynamicProperties[e]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(e){this.container=e,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var pointPool=poolFactory(8,(function(){return createTypedArray("float32",2)}));function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(e,t){this.c=e,this.setLength(t);for(var r=0;r<t;)this.v[r]=pointPool.newElement(),this.o[r]=pointPool.newElement(),this.i[r]=pointPool.newElement(),r+=1},ShapePath.prototype.setLength=function(e){for(;this._maxLength<e;)this.doubleArrayLength();this._length=e},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(e,t,r,n,o){var i;switch(this._length=Math.max(this._length,n+1),this._length>=this._maxLength&&this.doubleArrayLength(),r){case"v":i=this.v;break;case"i":i=this.i;break;case"o":i=this.o;break;default:i=[]}(!i[n]||i[n]&&!o)&&(i[n]=pointPool.newElement()),i[n][0]=e,i[n][1]=t},ShapePath.prototype.setTripleAt=function(e,t,r,n,o,i,a,s){this.setXYAt(e,t,"v",a,s),this.setXYAt(r,n,"o",a,s),this.setXYAt(o,i,"i",a,s)},ShapePath.prototype.reverse=function(){var e=new ShapePath;e.setPathData(this.c,this._length);var t=this.v,r=this.o,n=this.i,o=0;this.c&&(e.setTripleAt(t[0][0],t[0][1],n[0][0],n[0][1],r[0][0],r[0][1],0,!1),o=1);var i,a=this._length-1,s=this._length;for(i=o;i<s;i+=1)e.setTripleAt(t[a][0],t[a][1],n[a][0],n[a][1],r[a][0],r[a][1],i,!1),a-=1;return e},ShapePath.prototype.length=function(){return this._length};var shapePool=(factory=poolFactory(4,(function(){return new ShapePath}),(function(e){var t,r=e._length;for(t=0;t<r;t+=1)pointPool.release(e.v[t]),pointPool.release(e.i[t]),pointPool.release(e.o[t]),e.v[t]=null,e.i[t]=null,e.o[t]=null;e._length=0,e.c=!1})),factory.clone=function(e){var t,r=factory.newElement(),n=void 0===e._length?e.v.length:e._length;for(r.setLength(n),r.c=e.c,t=0;t<n;t+=1)r.setTripleAt(e.v[t][0],e.v[t][1],e.o[t][0],e.o[t][1],e.i[t][0],e.i[t][1],t);return r},factory),factory;function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}ShapeCollection.prototype.addShape=function(e){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=e,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){var e;for(e=0;e<this._length;e+=1)shapePool.release(this.shapes[e]);this._length=0};var shapeCollectionPool=(ob2={newShapeCollection:function(){return _length?pool[_length-=1]:new ShapeCollection},release:function(e){var t,r=e._length;for(t=0;t<r;t+=1)shapePool.release(e.shapes[t]);e._length=0,_length===_maxLength&&(pool=pooling.double(pool),_maxLength*=2),pool[_length]=e,_length+=1}},_length=0,_maxLength=4,pool=createSizedArray(_maxLength),ob2),ob2,_length,_maxLength,pool,ShapePropertyFactory=function(){var e=-999999;function t(e,t,r){var n,o,i,a,s,l,c,u,d,h=r.lastIndex,p=this.keyframes;if(e<p[0].t-this.offsetTime)n=p[0].s[0],i=!0,h=0;else if(e>=p[p.length-1].t-this.offsetTime)n=p[p.length-1].s?p[p.length-1].s[0]:p[p.length-2].e[0],i=!0;else{for(var f,g,m,y=h,v=p.length-1,_=!0;_&&(f=p[y],!((g=p[y+1]).t-this.offsetTime>e));)y<v-1?y+=1:_=!1;if(m=this.keyframesMetadata[y]||{},h=y,!(i=1===f.h)){if(e>=g.t-this.offsetTime)u=1;else if(e<f.t-this.offsetTime)u=0;else{var b;m.__fnct?b=m.__fnct:(b=BezierFactory.getBezierEasing(f.o.x,f.o.y,f.i.x,f.i.y).get,m.__fnct=b),u=b((e-(f.t-this.offsetTime))/(g.t-this.offsetTime-(f.t-this.offsetTime)))}o=g.s?g.s[0]:f.e[0]}n=f.s[0]}for(l=t._length,c=n.i[0].length,r.lastIndex=h,a=0;a<l;a+=1)for(s=0;s<c;s+=1)d=i?n.i[a][s]:n.i[a][s]+(o.i[a][s]-n.i[a][s])*u,t.i[a][s]=d,d=i?n.o[a][s]:n.o[a][s]+(o.o[a][s]-n.o[a][s])*u,t.o[a][s]=d,d=i?n.v[a][s]:n.v[a][s]+(o.v[a][s]-n.v[a][s])*u,t.v[a][s]=d}function r(){var t=this.comp.renderedFrame-this.offsetTime,r=this.keyframes[0].t-this.offsetTime,n=this.keyframes[this.keyframes.length-1].t-this.offsetTime,o=this._caching.lastFrame;return o!==e&&(o<r&&t<r||o>n&&t>n)||(this._caching.lastIndex=o<t?this._caching.lastIndex:0,this.interpolateShape(t,this.pv,this._caching)),this._caching.lastFrame=t,this.pv}function n(){this.paths=this.localShapeCollection}function o(e){(function(e,t){if(e._length!==t._length||e.c!==t.c)return!1;var r,n=e._length;for(r=0;r<n;r+=1)if(e.v[r][0]!==t.v[r][0]||e.v[r][1]!==t.v[r][1]||e.o[r][0]!==t.o[r][0]||e.o[r][1]!==t.o[r][1]||e.i[r][0]!==t.i[r][0]||e.i[r][1]!==t.i[r][1])return!1;return!0})(this.v,e)||(this.v=shapePool.clone(e),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function i(){if(this.elem.globalData.frameId!==this.frameId)if(this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{var e,t;this.lock=!0,this._mdf=!1,e=this.kf?this.pv:this.data.ks?this.data.ks.k:this.data.pt.k;var r=this.effectsSequence.length;for(t=0;t<r;t+=1)e=this.effectsSequence[t](e);this.setVValue(e),this.lock=!1,this.frameId=this.elem.globalData.frameId}else this._mdf=!1}function a(e,t,r){this.propType="shape",this.comp=e.comp,this.container=e,this.elem=e,this.data=t,this.k=!1,this.kf=!1,this._mdf=!1;var o=3===r?t.pt.k:t.ks.k;this.v=shapePool.clone(o),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=n,this.effectsSequence=[]}function s(e){this.effectsSequence.push(e),this.container.addDynamicProperty(this)}function l(t,o,i){this.propType="shape",this.comp=t.comp,this.elem=t,this.container=t,this.offsetTime=t.data.st,this.keyframes=3===i?o.pt.k:o.ks.k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;var a=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,a),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=e,this.reset=n,this._caching={lastFrame:e,lastIndex:0},this.effectsSequence=[r.bind(this)]}a.prototype.interpolateShape=t,a.prototype.getValue=i,a.prototype.setVValue=o,a.prototype.addEffect=s,l.prototype.getValue=i,l.prototype.interpolateShape=t,l.prototype.setVValue=o,l.prototype.addEffect=s;var c=function(){var e=roundCorner;function t(e,t){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=t.d,this.elem=e,this.comp=e.comp,this.frameId=-1,this.initDynamicPropertyContainer(e),this.p=PropertyFactory.getProp(e,t.p,1,0,this),this.s=PropertyFactory.getProp(e,t.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return t.prototype={reset:n,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var t=this.p.v[0],r=this.p.v[1],n=this.s.v[0]/2,o=this.s.v[1]/2,i=3!==this.d,a=this.v;a.v[0][0]=t,a.v[0][1]=r-o,a.v[1][0]=i?t+n:t-n,a.v[1][1]=r,a.v[2][0]=t,a.v[2][1]=r+o,a.v[3][0]=i?t-n:t+n,a.v[3][1]=r,a.i[0][0]=i?t-n*e:t+n*e,a.i[0][1]=r-o,a.i[1][0]=i?t+n:t-n,a.i[1][1]=r-o*e,a.i[2][0]=i?t+n*e:t-n*e,a.i[2][1]=r+o,a.i[3][0]=i?t-n:t+n,a.i[3][1]=r+o*e,a.o[0][0]=i?t+n*e:t-n*e,a.o[0][1]=r-o,a.o[1][0]=i?t+n:t-n,a.o[1][1]=r+o*e,a.o[2][0]=i?t-n*e:t+n*e,a.o[2][1]=r+o,a.o[3][0]=i?t-n:t+n,a.o[3][1]=r-o*e}},extendPrototype([DynamicPropertyContainer],t),t}(),u=function(){function e(e,t){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=e,this.comp=e.comp,this.data=t,this.frameId=-1,this.d=t.d,this.initDynamicPropertyContainer(e),1===t.sy?(this.ir=PropertyFactory.getProp(e,t.ir,0,0,this),this.is=PropertyFactory.getProp(e,t.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(e,t.pt,0,0,this),this.p=PropertyFactory.getProp(e,t.p,1,0,this),this.r=PropertyFactory.getProp(e,t.r,0,degToRads,this),this.or=PropertyFactory.getProp(e,t.or,0,0,this),this.os=PropertyFactory.getProp(e,t.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return e.prototype={reset:n,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var e,t,r,n,o=2*Math.floor(this.pt.v),i=2*Math.PI/o,a=!0,s=this.or.v,l=this.ir.v,c=this.os.v,u=this.is.v,d=2*Math.PI*s/(2*o),h=2*Math.PI*l/(2*o),p=-Math.PI/2;p+=this.r.v;var f=3===this.data.d?-1:1;for(this.v._length=0,e=0;e<o;e+=1){r=a?c:u,n=a?d:h;var g=(t=a?s:l)*Math.cos(p),m=t*Math.sin(p),y=0===g&&0===m?0:m/Math.sqrt(g*g+m*m),v=0===g&&0===m?0:-g/Math.sqrt(g*g+m*m);g+=+this.p.v[0],m+=+this.p.v[1],this.v.setTripleAt(g,m,g-y*n*r*f,m-v*n*r*f,g+y*n*r*f,m+v*n*r*f,e,!0),a=!a,p+=i*f}},convertPolygonToPath:function(){var e,t=Math.floor(this.pt.v),r=2*Math.PI/t,n=this.or.v,o=this.os.v,i=2*Math.PI*n/(4*t),a=.5*-Math.PI,s=3===this.data.d?-1:1;for(a+=this.r.v,this.v._length=0,e=0;e<t;e+=1){var l=n*Math.cos(a),c=n*Math.sin(a),u=0===l&&0===c?0:c/Math.sqrt(l*l+c*c),d=0===l&&0===c?0:-l/Math.sqrt(l*l+c*c);l+=+this.p.v[0],c+=+this.p.v[1],this.v.setTripleAt(l,c,l-u*i*o*s,c-d*i*o*s,l+u*i*o*s,c+d*i*o*s,e,!0),a+=r*s}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],e),e}(),d=function(){function e(e,t){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=e,this.comp=e.comp,this.frameId=-1,this.d=t.d,this.initDynamicPropertyContainer(e),this.p=PropertyFactory.getProp(e,t.p,1,0,this),this.s=PropertyFactory.getProp(e,t.s,1,0,this),this.r=PropertyFactory.getProp(e,t.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return e.prototype={convertRectToPath:function(){var e=this.p.v[0],t=this.p.v[1],r=this.s.v[0]/2,n=this.s.v[1]/2,o=bmMin(r,n,this.r.v),i=o*(1-roundCorner);this.v._length=0,2===this.d||1===this.d?(this.v.setTripleAt(e+r,t-n+o,e+r,t-n+o,e+r,t-n+i,0,!0),this.v.setTripleAt(e+r,t+n-o,e+r,t+n-i,e+r,t+n-o,1,!0),0!==o?(this.v.setTripleAt(e+r-o,t+n,e+r-o,t+n,e+r-i,t+n,2,!0),this.v.setTripleAt(e-r+o,t+n,e-r+i,t+n,e-r+o,t+n,3,!0),this.v.setTripleAt(e-r,t+n-o,e-r,t+n-o,e-r,t+n-i,4,!0),this.v.setTripleAt(e-r,t-n+o,e-r,t-n+i,e-r,t-n+o,5,!0),this.v.setTripleAt(e-r+o,t-n,e-r+o,t-n,e-r+i,t-n,6,!0),this.v.setTripleAt(e+r-o,t-n,e+r-i,t-n,e+r-o,t-n,7,!0)):(this.v.setTripleAt(e-r,t+n,e-r+i,t+n,e-r,t+n,2),this.v.setTripleAt(e-r,t-n,e-r,t-n+i,e-r,t-n,3))):(this.v.setTripleAt(e+r,t-n+o,e+r,t-n+i,e+r,t-n+o,0,!0),0!==o?(this.v.setTripleAt(e+r-o,t-n,e+r-o,t-n,e+r-i,t-n,1,!0),this.v.setTripleAt(e-r+o,t-n,e-r+i,t-n,e-r+o,t-n,2,!0),this.v.setTripleAt(e-r,t-n+o,e-r,t-n+o,e-r,t-n+i,3,!0),this.v.setTripleAt(e-r,t+n-o,e-r,t+n-i,e-r,t+n-o,4,!0),this.v.setTripleAt(e-r+o,t+n,e-r+o,t+n,e-r+i,t+n,5,!0),this.v.setTripleAt(e+r-o,t+n,e+r-i,t+n,e+r-o,t+n,6,!0),this.v.setTripleAt(e+r,t+n-o,e+r,t+n-o,e+r,t+n-i,7,!0)):(this.v.setTripleAt(e-r,t-n,e-r+i,t-n,e-r,t-n,1,!0),this.v.setTripleAt(e-r,t+n,e-r,t+n-i,e-r,t+n,2,!0),this.v.setTripleAt(e+r,t+n,e+r-i,t+n,e+r,t+n,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:n},extendPrototype([DynamicPropertyContainer],e),e}(),h={getShapeProp:function(e,t,r){var n;return 3===r||4===r?n=(3===r?t.pt:t.ks).k.length?new l(e,t,r):new a(e,t,r):5===r?n=new d(e,t):6===r?n=new c(e,t):7===r&&(n=new u(e,t)),n.k&&e.addDynamicProperty(n),n},getConstructorFunction:function(){return a},getKeyframedConstructorFunction:function(){return l}};return h}(),Matrix=function(){var e=Math.cos,t=Math.sin,r=Math.tan,n=Math.round;function o(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function i(r){if(0===r)return this;var n=e(r),o=t(r);return this._t(n,-o,0,0,o,n,0,0,0,0,1,0,0,0,0,1)}function a(r){if(0===r)return this;var n=e(r),o=t(r);return this._t(1,0,0,0,0,n,-o,0,0,o,n,0,0,0,0,1)}function s(r){if(0===r)return this;var n=e(r),o=t(r);return this._t(n,0,o,0,0,1,0,0,-o,0,n,0,0,0,0,1)}function l(r){if(0===r)return this;var n=e(r),o=t(r);return this._t(n,-o,0,0,o,n,0,0,0,0,1,0,0,0,0,1)}function c(e,t){return this._t(1,t,e,1,0,0)}function u(e,t){return this.shear(r(e),r(t))}function d(n,o){var i=e(o),a=t(o);return this._t(i,a,0,0,-a,i,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,r(n),1,0,0,0,0,1,0,0,0,0,1)._t(i,-a,0,0,a,i,0,0,0,0,1,0,0,0,0,1)}function h(e,t,r){return r||0===r||(r=1),1===e&&1===t&&1===r?this:this._t(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1)}function p(e,t,r,n,o,i,a,s,l,c,u,d,h,p,f,g){return this.props[0]=e,this.props[1]=t,this.props[2]=r,this.props[3]=n,this.props[4]=o,this.props[5]=i,this.props[6]=a,this.props[7]=s,this.props[8]=l,this.props[9]=c,this.props[10]=u,this.props[11]=d,this.props[12]=h,this.props[13]=p,this.props[14]=f,this.props[15]=g,this}function f(e,t,r){return r=r||0,0!==e||0!==t||0!==r?this._t(1,0,0,0,0,1,0,0,0,0,1,0,e,t,r,1):this}function g(e,t,r,n,o,i,a,s,l,c,u,d,h,p,f,g){var m=this.props;if(1===e&&0===t&&0===r&&0===n&&0===o&&1===i&&0===a&&0===s&&0===l&&0===c&&1===u&&0===d)return m[12]=m[12]*e+m[15]*h,m[13]=m[13]*i+m[15]*p,m[14]=m[14]*u+m[15]*f,m[15]*=g,this._identityCalculated=!1,this;var y=m[0],v=m[1],_=m[2],b=m[3],C=m[4],E=m[5],T=m[6],S=m[7],P=m[8],w=m[9],x=m[10],O=m[11],$=m[12],I=m[13],R=m[14],A=m[15];return m[0]=y*e+v*o+_*l+b*h,m[1]=y*t+v*i+_*c+b*p,m[2]=y*r+v*a+_*u+b*f,m[3]=y*n+v*s+_*d+b*g,m[4]=C*e+E*o+T*l+S*h,m[5]=C*t+E*i+T*c+S*p,m[6]=C*r+E*a+T*u+S*f,m[7]=C*n+E*s+T*d+S*g,m[8]=P*e+w*o+x*l+O*h,m[9]=P*t+w*i+x*c+O*p,m[10]=P*r+w*a+x*u+O*f,m[11]=P*n+w*s+x*d+O*g,m[12]=$*e+I*o+R*l+A*h,m[13]=$*t+I*i+R*c+A*p,m[14]=$*r+I*a+R*u+A*f,m[15]=$*n+I*s+R*d+A*g,this._identityCalculated=!1,this}function m(e){var t=e.props;return this.transform(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function y(){return this._identityCalculated||(this._identity=!(1!==this.props[0]||0!==this.props[1]||0!==this.props[2]||0!==this.props[3]||0!==this.props[4]||1!==this.props[5]||0!==this.props[6]||0!==this.props[7]||0!==this.props[8]||0!==this.props[9]||1!==this.props[10]||0!==this.props[11]||0!==this.props[12]||0!==this.props[13]||0!==this.props[14]||1!==this.props[15]),this._identityCalculated=!0),this._identity}function v(e){for(var t=0;t<16;){if(e.props[t]!==this.props[t])return!1;t+=1}return!0}function _(e){var t;for(t=0;t<16;t+=1)e.props[t]=this.props[t];return e}function b(e){var t;for(t=0;t<16;t+=1)this.props[t]=e[t]}function C(e,t,r){return{x:e*this.props[0]+t*this.props[4]+r*this.props[8]+this.props[12],y:e*this.props[1]+t*this.props[5]+r*this.props[9]+this.props[13],z:e*this.props[2]+t*this.props[6]+r*this.props[10]+this.props[14]}}function E(e,t,r){return e*this.props[0]+t*this.props[4]+r*this.props[8]+this.props[12]}function T(e,t,r){return e*this.props[1]+t*this.props[5]+r*this.props[9]+this.props[13]}function S(e,t,r){return e*this.props[2]+t*this.props[6]+r*this.props[10]+this.props[14]}function P(){var e=this.props[0]*this.props[5]-this.props[1]*this.props[4],t=this.props[5]/e,r=-this.props[1]/e,n=-this.props[4]/e,o=this.props[0]/e,i=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/e,a=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/e,s=new Matrix;return s.props[0]=t,s.props[1]=r,s.props[4]=n,s.props[5]=o,s.props[12]=i,s.props[13]=a,s}function w(e){return this.getInverseMatrix().applyToPointArray(e[0],e[1],e[2]||0)}function x(e){var t,r=e.length,n=[];for(t=0;t<r;t+=1)n[t]=w(e[t]);return n}function O(e,t,r){var n=createTypedArray("float32",6);if(this.isIdentity())n[0]=e[0],n[1]=e[1],n[2]=t[0],n[3]=t[1],n[4]=r[0],n[5]=r[1];else{var o=this.props[0],i=this.props[1],a=this.props[4],s=this.props[5],l=this.props[12],c=this.props[13];n[0]=e[0]*o+e[1]*a+l,n[1]=e[0]*i+e[1]*s+c,n[2]=t[0]*o+t[1]*a+l,n[3]=t[0]*i+t[1]*s+c,n[4]=r[0]*o+r[1]*a+l,n[5]=r[0]*i+r[1]*s+c}return n}function $(e,t,r){return this.isIdentity()?[e,t,r]:[e*this.props[0]+t*this.props[4]+r*this.props[8]+this.props[12],e*this.props[1]+t*this.props[5]+r*this.props[9]+this.props[13],e*this.props[2]+t*this.props[6]+r*this.props[10]+this.props[14]]}function I(e,t){if(this.isIdentity())return e+","+t;var r=this.props;return Math.round(100*(e*r[0]+t*r[4]+r[12]))/100+","+Math.round(100*(e*r[1]+t*r[5]+r[13]))/100}function R(){for(var e=0,t=this.props,r="matrix3d(";e<16;)r+=n(1e4*t[e])/1e4,r+=15===e?")":",",e+=1;return r}function A(e){return e<1e-6&&e>0||e>-1e-6&&e<0?n(1e4*e)/1e4:e}function D(){var e=this.props;return"matrix("+A(e[0])+","+A(e[1])+","+A(e[4])+","+A(e[5])+","+A(e[12])+","+A(e[13])+")"}return function(){this.reset=o,this.rotate=i,this.rotateX=a,this.rotateY=s,this.rotateZ=l,this.skew=u,this.skewFromAxis=d,this.shear=c,this.scale=h,this.setTransform=p,this.translate=f,this.transform=g,this.multiply=m,this.applyToPoint=C,this.applyToX=E,this.applyToY=T,this.applyToZ=S,this.applyToPointArray=$,this.applyToTriplePoints=O,this.applyToPointStringified=I,this.toCSS=R,this.to2dCSS=D,this.clone=_,this.cloneFromProps=b,this.equals=v,this.inversePoints=x,this.inversePoint=w,this.getInverseMatrix=P,this._t=this.transform,this.isIdentity=y,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}}();function _typeof$3(e){return(_typeof$3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var lottie={};function setLocation(e){setLocationHref(e)}function searchAnimations(){animationManager.searchAnimations()}function setSubframeRendering(e){setSubframeEnabled(e)}function setPrefix(e){setIdPrefix(e)}function loadAnimation(e){return animationManager.loadAnimation(e)}function setQuality(e){if("string"==typeof e)switch(e){case"high":setDefaultCurveSegments(200);break;default:case"medium":setDefaultCurveSegments(50);break;case"low":setDefaultCurveSegments(10)}else!isNaN(e)&&e>1&&setDefaultCurveSegments(e)}function inBrowser(){return"undefined"!=typeof navigator}function installPlugin(e,t){"expressions"===e&&setExpressionsPlugin(t)}function getFactory(e){switch(e){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null}}function checkReady(){"complete"===document.readyState&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(e){for(var t=queryString.split("&"),r=0;r<t.length;r+=1){var n=t[r].split("=");if(decodeURIComponent(n[0])==e)return decodeURIComponent(n[1])}return null}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocation,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.useWebWorker=setWebWorker,lottie.setIDPrefix=setPrefix,lottie.__getFactory=getFactory,lottie.version="5.12.2";var queryString="",scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""};queryString=myScript.src?myScript.src.replace(/^[^\?]+\??/,""):"",getQueryVariable("renderer");var readyStateCheckInterval=setInterval(checkReady,100);try{"object"!==_typeof$3(exports)&&(window.bodymovin=lottie)}catch(err2){}var ShapeModifiers=function(){var e={},t={};return e.registerModifier=function(e,r){t[e]||(t[e]=r)},e.getModifier=function(e,r,n){return new t[e](r,n)},e}();function ShapeModifier(){}function TrimModifier(){}function PuckerAndBloatModifier(){}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(e){if(!this.closed){e.sh.container.addDynamicProperty(e.sh);var t={shape:e.sh,data:e,localShapeCollection:shapeCollectionPool.newShapeCollection()};this.shapes.push(t),this.addShapeToModifier(t),this._isAnimated&&e.setAsAnimated()}},ShapeModifier.prototype.init=function(e,t){this.shapes=[],this.elem=e,this.initDynamicPropertyContainer(e),this.initModifierProperties(e,t),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier),extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(e,t){this.s=PropertyFactory.getProp(e,t.s,0,.01,this),this.e=PropertyFactory.getProp(e,t.e,0,.01,this),this.o=PropertyFactory.getProp(e,t.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=t.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(e){e.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(e,t,r,n,o){var i=[];t<=1?i.push({s:e,e:t}):e>=1?i.push({s:e-1,e:t-1}):(i.push({s:e,e:1}),i.push({s:0,e:t-1}));var a,s,l=[],c=i.length;for(a=0;a<c;a+=1){var u,d;(s=i[a]).e*o<n||s.s*o>n+r||(u=s.s*o<=n?0:(s.s*o-n)/r,d=s.e*o>=n+r?1:(s.e*o-n)/r,l.push([u,d]))}return l.length||l.push([0,0]),l},TrimModifier.prototype.releasePathsData=function(e){var t,r=e.length;for(t=0;t<r;t+=1)segmentsLengthPool.release(e[t]);return e.length=0,e},TrimModifier.prototype.processShapes=function(e){var t,r,n,o;if(this._mdf||e){var i=this.o.v%360/360;if(i<0&&(i+=1),(t=this.s.v>1?1+i:this.s.v<0?0+i:this.s.v+i)>(r=this.e.v>1?1+i:this.e.v<0?0+i:this.e.v+i)){var a=t;t=r,r=a}t=1e-4*Math.round(1e4*t),r=1e-4*Math.round(1e4*r),this.sValue=t,this.eValue=r}else t=this.sValue,r=this.eValue;var s,l,c,u,d,h=this.shapes.length,p=0;if(r===t)for(o=0;o<h;o+=1)this.shapes[o].localShapeCollection.releaseShapes(),this.shapes[o].shape._mdf=!0,this.shapes[o].shape.paths=this.shapes[o].localShapeCollection,this._mdf&&(this.shapes[o].pathsData.length=0);else if(1===r&&0===t||0===r&&1===t){if(this._mdf)for(o=0;o<h;o+=1)this.shapes[o].pathsData.length=0,this.shapes[o].shape._mdf=!0}else{var f,g,m=[];for(o=0;o<h;o+=1)if((f=this.shapes[o]).shape._mdf||this._mdf||e||2===this.m){if(l=(n=f.shape.paths)._length,d=0,!f.shape._mdf&&f.pathsData.length)d=f.totalShapeLength;else{for(c=this.releasePathsData(f.pathsData),s=0;s<l;s+=1)u=bez.getSegmentsLength(n.shapes[s]),c.push(u),d+=u.totalLength;f.totalShapeLength=d,f.pathsData=c}p+=d,f.shape._mdf=!0}else f.shape.paths=f.localShapeCollection;var y,v=t,_=r,b=0;for(o=h-1;o>=0;o-=1)if((f=this.shapes[o]).shape._mdf){for((g=f.localShapeCollection).releaseShapes(),2===this.m&&h>1?(y=this.calculateShapeEdges(t,r,f.totalShapeLength,b,p),b+=f.totalShapeLength):y=[[v,_]],l=y.length,s=0;s<l;s+=1){v=y[s][0],_=y[s][1],m.length=0,_<=1?m.push({s:f.totalShapeLength*v,e:f.totalShapeLength*_}):v>=1?m.push({s:f.totalShapeLength*(v-1),e:f.totalShapeLength*(_-1)}):(m.push({s:f.totalShapeLength*v,e:f.totalShapeLength}),m.push({s:0,e:f.totalShapeLength*(_-1)}));var C=this.addShapes(f,m[0]);if(m[0].s!==m[0].e){if(m.length>1)if(f.shape.paths.shapes[f.shape.paths._length-1].c){var E=C.pop();this.addPaths(C,g),C=this.addShapes(f,m[1],E)}else this.addPaths(C,g),C=this.addShapes(f,m[1]);this.addPaths(C,g)}}f.shape.paths=g}}},TrimModifier.prototype.addPaths=function(e,t){var r,n=e.length;for(r=0;r<n;r+=1)t.addShape(e[r])},TrimModifier.prototype.addSegment=function(e,t,r,n,o,i,a){o.setXYAt(t[0],t[1],"o",i),o.setXYAt(r[0],r[1],"i",i+1),a&&o.setXYAt(e[0],e[1],"v",i),o.setXYAt(n[0],n[1],"v",i+1)},TrimModifier.prototype.addSegmentFromArray=function(e,t,r,n){t.setXYAt(e[1],e[5],"o",r),t.setXYAt(e[2],e[6],"i",r+1),n&&t.setXYAt(e[0],e[4],"v",r),t.setXYAt(e[3],e[7],"v",r+1)},TrimModifier.prototype.addShapes=function(e,t,r){var n,o,i,a,s,l,c,u,d=e.pathsData,h=e.shape.paths.shapes,p=e.shape.paths._length,f=0,g=[],m=!0;for(r?(s=r._length,u=r._length):(r=shapePool.newElement(),s=0,u=0),g.push(r),n=0;n<p;n+=1){for(l=d[n].lengths,r.c=h[n].c,i=h[n].c?l.length:l.length+1,o=1;o<i;o+=1)if(f+(a=l[o-1]).addedLength<t.s)f+=a.addedLength,r.c=!1;else{if(f>t.e){r.c=!1;break}t.s<=f&&t.e>=f+a.addedLength?(this.addSegment(h[n].v[o-1],h[n].o[o-1],h[n].i[o],h[n].v[o],r,s,m),m=!1):(c=bez.getNewSegment(h[n].v[o-1],h[n].v[o],h[n].o[o-1],h[n].i[o],(t.s-f)/a.addedLength,(t.e-f)/a.addedLength,l[o-1]),this.addSegmentFromArray(c,r,s,m),m=!1,r.c=!1),f+=a.addedLength,s+=1}if(h[n].c&&l.length){if(a=l[o-1],f<=t.e){var y=l[o-1].addedLength;t.s<=f&&t.e>=f+y?(this.addSegment(h[n].v[o-1],h[n].o[o-1],h[n].i[0],h[n].v[0],r,s,m),m=!1):(c=bez.getNewSegment(h[n].v[o-1],h[n].v[0],h[n].o[o-1],h[n].i[0],(t.s-f)/y,(t.e-f)/y,l[o-1]),this.addSegmentFromArray(c,r,s,m),m=!1,r.c=!1)}else r.c=!1;f+=a.addedLength,s+=1}if(r._length&&(r.setXYAt(r.v[u][0],r.v[u][1],"i",u),r.setXYAt(r.v[r._length-1][0],r.v[r._length-1][1],"o",r._length-1)),f>t.e)break;n<p-1&&(r=shapePool.newElement(),m=!0,g.push(r),s=0)}return g},extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(e,t.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},PuckerAndBloatModifier.prototype.processPath=function(e,t){var r=t/100,n=[0,0],o=e._length,i=0;for(i=0;i<o;i+=1)n[0]+=e.v[i][0],n[1]+=e.v[i][1];n[0]/=o,n[1]/=o;var a,s,l,c,u,d,h=shapePool.newElement();for(h.c=e.c,i=0;i<o;i+=1)a=e.v[i][0]+(n[0]-e.v[i][0])*r,s=e.v[i][1]+(n[1]-e.v[i][1])*r,l=e.o[i][0]+(n[0]-e.o[i][0])*-r,c=e.o[i][1]+(n[1]-e.o[i][1])*-r,u=e.i[i][0]+(n[0]-e.i[i][0])*-r,d=e.i[i][1]+(n[1]-e.i[i][1])*-r,h.setTripleAt(a,s,l,c,u,d,i);return h},PuckerAndBloatModifier.prototype.processShapes=function(e){var t,r,n,o,i,a,s=this.shapes.length,l=this.amount.v;if(0!==l)for(r=0;r<s;r+=1){if(a=(i=this.shapes[r]).localShapeCollection,i.shape._mdf||this._mdf||e)for(a.releaseShapes(),i.shape._mdf=!0,t=i.shape.paths.shapes,o=i.shape.paths._length,n=0;n<o;n+=1)a.addShape(this.processPath(t[n],l));i.shape.paths=i.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)};var TransformPropertyFactory=function(){var e=[0,0];function t(e,t,r){if(this.elem=e,this.frameId=-1,this.propType="transform",this.data=t,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(r||e),t.p&&t.p.s?(this.px=PropertyFactory.getProp(e,t.p.x,0,0,this),this.py=PropertyFactory.getProp(e,t.p.y,0,0,this),t.p.z&&(this.pz=PropertyFactory.getProp(e,t.p.z,0,0,this))):this.p=PropertyFactory.getProp(e,t.p||{k:[0,0,0]},1,0,this),t.rx){if(this.rx=PropertyFactory.getProp(e,t.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(e,t.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(e,t.rz,0,degToRads,this),t.or.k[0].ti){var n,o=t.or.k.length;for(n=0;n<o;n+=1)t.or.k[n].to=null,t.or.k[n].ti=null}this.or=PropertyFactory.getProp(e,t.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(e,t.r||{k:0},0,degToRads,this);t.sk&&(this.sk=PropertyFactory.getProp(e,t.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(e,t.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(e,t.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(e,t.s||{k:[100,100,100]},1,.01,this),t.o?this.o=PropertyFactory.getProp(e,t.o,0,.01,e):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}return t.prototype={applyToMatrix:function(e){var t=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||t,this.a&&e.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&e.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&e.skewFromAxis(-this.sk.v,this.sa.v),this.r?e.rotate(-this.r.v):e.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?e.translate(this.px.v,this.py.v,-this.pz.v):e.translate(this.px.v,this.py.v,0):e.translate(this.p.v[0],this.p.v[1],-this.p.v[2])},getValue:function(t){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||t){var r;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var n,o;if(r=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(n=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/r,0),o=this.p.getValueAtTime(this.p.keyframes[0].t/r,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(n=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/r,0),o=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/r,0)):(n=this.p.pv,o=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/r,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){n=[],o=[];var i=this.px,a=this.py;i._caching.lastFrame+i.offsetTime<=i.keyframes[0].t?(n[0]=i.getValueAtTime((i.keyframes[0].t+.01)/r,0),n[1]=a.getValueAtTime((a.keyframes[0].t+.01)/r,0),o[0]=i.getValueAtTime(i.keyframes[0].t/r,0),o[1]=a.getValueAtTime(a.keyframes[0].t/r,0)):i._caching.lastFrame+i.offsetTime>=i.keyframes[i.keyframes.length-1].t?(n[0]=i.getValueAtTime(i.keyframes[i.keyframes.length-1].t/r,0),n[1]=a.getValueAtTime(a.keyframes[a.keyframes.length-1].t/r,0),o[0]=i.getValueAtTime((i.keyframes[i.keyframes.length-1].t-.01)/r,0),o[1]=a.getValueAtTime((a.keyframes[a.keyframes.length-1].t-.01)/r,0)):(n=[i.pv,a.pv],o[0]=i.getValueAtTime((i._caching.lastFrame+i.offsetTime-.01)/r,i.offsetTime),o[1]=a.getValueAtTime((a._caching.lastFrame+a.offsetTime-.01)/r,a.offsetTime))}else n=o=e;this.v.rotate(-Math.atan2(n[1]-o[1],n[0]-o[0]))}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}},precalculateMatrix:function(){if(this.appliedTransformations=0,this.pre.reset(),!this.a.effectsSequence.length&&(this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1,!this.s.effectsSequence.length)){if(this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2,this.sk){if(this.sk.effectsSequence.length||this.sa.effectsSequence.length)return;this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3}this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):this.rz.effectsSequence.length||this.ry.effectsSequence.length||this.rx.effectsSequence.length||this.or.effectsSequence.length||(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}},autoOrient:function(){}},extendPrototype([DynamicPropertyContainer],t),t.prototype.addDynamicProperty=function(e){this._addDynamicProperty(e),this.elem.addDynamicProperty(e),this._isDirty=!0},t.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty,{getTransformProperty:function(e,r,n){return new t(e,r,n)}}}();function RepeaterModifier(){}function RoundCornersModifier(){}function floatEqual(e,t){return 1e5*Math.abs(e-t)<=Math.min(Math.abs(e),Math.abs(t))}function floatZero(e){return Math.abs(e)<=1e-5}function lerp(e,t,r){return e*(1-r)+t*r}function lerpPoint(e,t,r){return[lerp(e[0],t[0],r),lerp(e[1],t[1],r)]}function quadRoots(e,t,r){if(0===e)return[];var n=t*t-4*e*r;if(n<0)return[];var o=-t/(2*e);if(0===n)return[o];var i=Math.sqrt(n)/(2*e);return[o-i,o+i]}function polynomialCoefficients(e,t,r,n){return[3*t-e-3*r+n,3*e-6*t+3*r,-3*e+3*t,e]}function singlePoint(e){return new PolynomialBezier(e,e,e,e,!1)}function PolynomialBezier(e,t,r,n,o){o&&pointEqual(e,t)&&(t=lerpPoint(e,n,1/3)),o&&pointEqual(r,n)&&(r=lerpPoint(e,n,2/3));var i=polynomialCoefficients(e[0],t[0],r[0],n[0]),a=polynomialCoefficients(e[1],t[1],r[1],n[1]);this.a=[i[0],a[0]],this.b=[i[1],a[1]],this.c=[i[2],a[2]],this.d=[i[3],a[3]],this.points=[e,t,r,n]}function extrema(e,t){var r=e.points[0][t],n=e.points[e.points.length-1][t];if(r>n){var o=n;n=r,r=o}for(var i=quadRoots(3*e.a[t],2*e.b[t],e.c[t]),a=0;a<i.length;a+=1)if(i[a]>0&&i[a]<1){var s=e.point(i[a])[t];s<r?r=s:s>n&&(n=s)}return{min:r,max:n}}function intersectData(e,t,r){var n=e.boundingBox();return{cx:n.cx,cy:n.cy,width:n.width,height:n.height,bez:e,t:(t+r)/2,t1:t,t2:r}}function splitData(e){var t=e.bez.split(.5);return[intersectData(t[0],e.t1,e.t),intersectData(t[1],e.t,e.t2)]}function boxIntersect(e,t){return 2*Math.abs(e.cx-t.cx)<e.width+t.width&&2*Math.abs(e.cy-t.cy)<e.height+t.height}function intersectsImpl(e,t,r,n,o,i){if(boxIntersect(e,t))if(r>=i||e.width<=n&&e.height<=n&&t.width<=n&&t.height<=n)o.push([e.t,t.t]);else{var a=splitData(e),s=splitData(t);intersectsImpl(a[0],s[0],r+1,n,o,i),intersectsImpl(a[0],s[1],r+1,n,o,i),intersectsImpl(a[1],s[0],r+1,n,o,i),intersectsImpl(a[1],s[1],r+1,n,o,i)}}function crossProduct(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function lineIntersection(e,t,r,n){var o=[e[0],e[1],1],i=[t[0],t[1],1],a=[r[0],r[1],1],s=[n[0],n[1],1],l=crossProduct(crossProduct(o,i),crossProduct(a,s));return floatZero(l[2])?null:[l[0]/l[2],l[1]/l[2]]}function polarOffset(e,t,r){return[e[0]+Math.cos(t)*r,e[1]-Math.sin(t)*r]}function pointDistance(e,t){return Math.hypot(e[0]-t[0],e[1]-t[1])}function pointEqual(e,t){return floatEqual(e[0],t[0])&&floatEqual(e[1],t[1])}function ZigZagModifier(){}function setPoint(e,t,r,n,o,i,a){var s=r-Math.PI/2,l=r+Math.PI/2,c=t[0]+Math.cos(r)*n*o,u=t[1]-Math.sin(r)*n*o;e.setTripleAt(c,u,c+Math.cos(s)*i,u-Math.sin(s)*i,c+Math.cos(l)*a,u-Math.sin(l)*a,e.length())}function getPerpendicularVector(e,t){var r=[t[0]-e[0],t[1]-e[1]],n=.5*-Math.PI;return[Math.cos(n)*r[0]-Math.sin(n)*r[1],Math.sin(n)*r[0]+Math.cos(n)*r[1]]}function getProjectingAngle(e,t){var r=0===t?e.length()-1:t-1,n=(t+1)%e.length(),o=getPerpendicularVector(e.v[r],e.v[n]);return Math.atan2(0,1)-Math.atan2(o[1],o[0])}function zigZagCorner(e,t,r,n,o,i,a){var s=getProjectingAngle(t,r),l=t.v[r%t._length],c=t.v[0===r?t._length-1:r-1],u=t.v[(r+1)%t._length],d=2===i?Math.sqrt(Math.pow(l[0]-c[0],2)+Math.pow(l[1]-c[1],2)):0,h=2===i?Math.sqrt(Math.pow(l[0]-u[0],2)+Math.pow(l[1]-u[1],2)):0;setPoint(e,t.v[r%t._length],s,a,n,h/(2*(o+1)),d/(2*(o+1)))}function zigZagSegment(e,t,r,n,o,i){for(var a=0;a<n;a+=1){var s=(a+1)/(n+1),l=2===o?Math.sqrt(Math.pow(t.points[3][0]-t.points[0][0],2)+Math.pow(t.points[3][1]-t.points[0][1],2)):0,c=t.normalAngle(s);setPoint(e,t.point(s),c,i,r,l/(2*(n+1)),l/(2*(n+1))),i=-i}return i}function linearOffset(e,t,r){var n=Math.atan2(t[0]-e[0],t[1]-e[1]);return[polarOffset(e,n,r),polarOffset(t,n,r)]}function offsetSegment(e,t){var r,n,o,i,a,s,l;r=(l=linearOffset(e.points[0],e.points[1],t))[0],n=l[1],o=(l=linearOffset(e.points[1],e.points[2],t))[0],i=l[1],a=(l=linearOffset(e.points[2],e.points[3],t))[0],s=l[1];var c=lineIntersection(r,n,o,i);null===c&&(c=n);var u=lineIntersection(a,s,o,i);return null===u&&(u=a),new PolynomialBezier(r,c,u,s)}function joinLines(e,t,r,n,o){var i=t.points[3],a=r.points[0];if(3===n)return i;if(pointEqual(i,a))return i;if(2===n){var s=-t.tangentAngle(1),l=-r.tangentAngle(0)+Math.PI,c=lineIntersection(i,polarOffset(i,s+Math.PI/2,100),a,polarOffset(a,s+Math.PI/2,100)),u=c?pointDistance(c,i):pointDistance(i,a)/2,d=polarOffset(i,s,2*u*roundCorner);return e.setXYAt(d[0],d[1],"o",e.length()-1),d=polarOffset(a,l,2*u*roundCorner),e.setTripleAt(a[0],a[1],a[0],a[1],d[0],d[1],e.length()),a}var h=lineIntersection(pointEqual(i,t.points[2])?t.points[0]:t.points[2],i,a,pointEqual(a,r.points[1])?r.points[3]:r.points[1]);return h&&pointDistance(h,i)<o?(e.setTripleAt(h[0],h[1],h[0],h[1],h[0],h[1],e.length()),h):i}function getIntersection(e,t){var r=e.intersections(t);return r.length&&floatEqual(r[0][0],1)&&r.shift(),r.length?r[0]:null}function pruneSegmentIntersection(e,t){var r=e.slice(),n=t.slice(),o=getIntersection(e[e.length-1],t[0]);return o&&(r[e.length-1]=e[e.length-1].split(o[0])[0],n[0]=t[0].split(o[1])[1]),e.length>1&&t.length>1&&(o=getIntersection(e[0],t[t.length-1]))?[[e[0].split(o[0])[0]],[t[t.length-1].split(o[1])[1]]]:[r,n]}function pruneIntersections(e){for(var t,r=1;r<e.length;r+=1)t=pruneSegmentIntersection(e[r-1],e[r]),e[r-1]=t[0],e[r]=t[1];return e.length>1&&(t=pruneSegmentIntersection(e[e.length-1],e[0]),e[e.length-1]=t[0],e[0]=t[1]),e}function offsetSegmentSplit(e,t){var r,n,o,i,a=e.inflectionPoints();if(0===a.length)return[offsetSegment(e,t)];if(1===a.length||floatEqual(a[1],1))return r=(o=e.split(a[0]))[0],n=o[1],[offsetSegment(r,t),offsetSegment(n,t)];r=(o=e.split(a[0]))[0];var s=(a[1]-a[0])/(1-a[0]);return i=(o=o[1].split(s))[0],n=o[1],[offsetSegment(r,t),offsetSegment(i,t),offsetSegment(n,t)]}function OffsetPathModifier(){}function getFontProperties(e){for(var t=e.fStyle?e.fStyle.split(" "):[],r="normal",n="normal",o=t.length,i=0;i<o;i+=1)switch(t[i].toLowerCase()){case"italic":n="italic";break;case"bold":r="700";break;case"black":r="900";break;case"medium":r="500";break;case"regular":case"normal":r="400";break;case"light":case"thin":r="200"}return{style:n,weight:e.fWeight||r}}extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(e,t.c,0,null,this),this.o=PropertyFactory.getProp(e,t.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(e,t.tr,this),this.so=PropertyFactory.getProp(e,t.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(e,t.tr.eo,0,.01,this),this.data=t,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(e,t,r,n,o,i){var a=i?-1:1,s=n.s.v[0]+(1-n.s.v[0])*(1-o),l=n.s.v[1]+(1-n.s.v[1])*(1-o);e.translate(n.p.v[0]*a*o,n.p.v[1]*a*o,n.p.v[2]),t.translate(-n.a.v[0],-n.a.v[1],n.a.v[2]),t.rotate(-n.r.v*a*o),t.translate(n.a.v[0],n.a.v[1],n.a.v[2]),r.translate(-n.a.v[0],-n.a.v[1],n.a.v[2]),r.scale(i?1/s:s,i?1/l:l),r.translate(n.a.v[0],n.a.v[1],n.a.v[2])},RepeaterModifier.prototype.init=function(e,t,r,n){for(this.elem=e,this.arr=t,this.pos=r,this.elemsData=n,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(e),this.initModifierProperties(e,t[r]);r>0;)r-=1,this._elements.unshift(t[r]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(e){var t,r=e.length;for(t=0;t<r;t+=1)e[t]._processed=!1,"gr"===e[t].ty&&this.resetElements(e[t].it)},RepeaterModifier.prototype.cloneElements=function(e){var t=JSON.parse(JSON.stringify(e));return this.resetElements(t),t},RepeaterModifier.prototype.changeGroupRender=function(e,t){var r,n=e.length;for(r=0;r<n;r+=1)e[r]._render=t,"gr"===e[r].ty&&this.changeGroupRender(e[r].it,t)},RepeaterModifier.prototype.processShapes=function(e){var t,r,n,o,i,a=!1;if(this._mdf||e){var s,l=Math.ceil(this.c.v);if(this._groups.length<l){for(;this._groups.length<l;){var c={it:this.cloneElements(this._elements),ty:"gr"};c.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,c),this._groups.splice(0,0,c),this._currentCopies+=1}this.elem.reloadShapes(),a=!0}for(i=0,n=0;n<=this._groups.length-1;n+=1){if(s=i<l,this._groups[n]._render=s,this.changeGroupRender(this._groups[n].it,s),!s){var u=this.elemsData[n].it,d=u[u.length-1];0!==d.transform.op.v?(d.transform.op._mdf=!0,d.transform.op.v=0):d.transform.op._mdf=!1}i+=1}this._currentCopies=l;var h=this.o.v,p=h%1,f=h>0?Math.floor(h):Math.ceil(h),g=this.pMatrix.props,m=this.rMatrix.props,y=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var v,_,b=0;if(h>0){for(;b<f;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),b+=1;p&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,p,!1),b+=p)}else if(h<0){for(;b>f;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),b-=1;p&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-p,!0),b-=p)}for(n=1===this.data.m?0:this._currentCopies-1,o=1===this.data.m?1:-1,i=this._currentCopies;i;){if(_=(r=(t=this.elemsData[n].it)[t.length-1].transform.mProps.v.props).length,t[t.length-1].transform.mProps._mdf=!0,t[t.length-1].transform.op._mdf=!0,t[t.length-1].transform.op.v=1===this._currentCopies?this.so.v:this.so.v+(this.eo.v-this.so.v)*(n/(this._currentCopies-1)),0!==b){for((0!==n&&1===o||n!==this._currentCopies-1&&-1===o)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7],m[8],m[9],m[10],m[11],m[12],m[13],m[14],m[15]),this.matrix.transform(y[0],y[1],y[2],y[3],y[4],y[5],y[6],y[7],y[8],y[9],y[10],y[11],y[12],y[13],y[14],y[15]),this.matrix.transform(g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],g[8],g[9],g[10],g[11],g[12],g[13],g[14],g[15]),v=0;v<_;v+=1)r[v]=this.matrix.props[v];this.matrix.reset()}else for(this.matrix.reset(),v=0;v<_;v+=1)r[v]=this.matrix.props[v];b+=1,i-=1,n+=o}}else for(i=this._currentCopies,n=0,o=1;i;)r=(t=this.elemsData[n].it)[t.length-1].transform.mProps.v.props,t[t.length-1].transform.mProps._mdf=!1,t[t.length-1].transform.op._mdf=!1,i-=1,n+=o;return a},RepeaterModifier.prototype.addShape=function(){},extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(e,t.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(e,t){var r,n=shapePool.newElement();n.c=e.c;var o,i,a,s,l,c,u,d,h,p,f,g,m=e._length,y=0;for(r=0;r<m;r+=1)o=e.v[r],a=e.o[r],i=e.i[r],o[0]===a[0]&&o[1]===a[1]&&o[0]===i[0]&&o[1]===i[1]?0!==r&&r!==m-1||e.c?(s=0===r?e.v[m-1]:e.v[r-1],c=(l=Math.sqrt(Math.pow(o[0]-s[0],2)+Math.pow(o[1]-s[1],2)))?Math.min(l/2,t)/l:0,u=f=o[0]+(s[0]-o[0])*c,d=g=o[1]-(o[1]-s[1])*c,h=u-(u-o[0])*roundCorner,p=d-(d-o[1])*roundCorner,n.setTripleAt(u,d,h,p,f,g,y),y+=1,s=r===m-1?e.v[0]:e.v[r+1],c=(l=Math.sqrt(Math.pow(o[0]-s[0],2)+Math.pow(o[1]-s[1],2)))?Math.min(l/2,t)/l:0,u=h=o[0]+(s[0]-o[0])*c,d=p=o[1]+(s[1]-o[1])*c,f=u-(u-o[0])*roundCorner,g=d-(d-o[1])*roundCorner,n.setTripleAt(u,d,h,p,f,g,y),y+=1):(n.setTripleAt(o[0],o[1],a[0],a[1],i[0],i[1],y),y+=1):(n.setTripleAt(e.v[r][0],e.v[r][1],e.o[r][0],e.o[r][1],e.i[r][0],e.i[r][1],y),y+=1);return n},RoundCornersModifier.prototype.processShapes=function(e){var t,r,n,o,i,a,s=this.shapes.length,l=this.rd.v;if(0!==l)for(r=0;r<s;r+=1){if(a=(i=this.shapes[r]).localShapeCollection,i.shape._mdf||this._mdf||e)for(a.releaseShapes(),i.shape._mdf=!0,t=i.shape.paths.shapes,o=i.shape.paths._length,n=0;n<o;n+=1)a.addShape(this.processPath(t[n],l));i.shape.paths=i.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},PolynomialBezier.prototype.point=function(e){return[((this.a[0]*e+this.b[0])*e+this.c[0])*e+this.d[0],((this.a[1]*e+this.b[1])*e+this.c[1])*e+this.d[1]]},PolynomialBezier.prototype.derivative=function(e){return[(3*e*this.a[0]+2*this.b[0])*e+this.c[0],(3*e*this.a[1]+2*this.b[1])*e+this.c[1]]},PolynomialBezier.prototype.tangentAngle=function(e){var t=this.derivative(e);return Math.atan2(t[1],t[0])},PolynomialBezier.prototype.normalAngle=function(e){var t=this.derivative(e);return Math.atan2(t[0],t[1])},PolynomialBezier.prototype.inflectionPoints=function(){var e=this.a[1]*this.b[0]-this.a[0]*this.b[1];if(floatZero(e))return[];var t=-.5*(this.a[1]*this.c[0]-this.a[0]*this.c[1])/e,r=t*t-1/3*(this.b[1]*this.c[0]-this.b[0]*this.c[1])/e;if(r<0)return[];var n=Math.sqrt(r);return floatZero(n)?n>0&&n<1?[t]:[]:[t-n,t+n].filter((function(e){return e>0&&e<1}))},PolynomialBezier.prototype.split=function(e){if(e<=0)return[singlePoint(this.points[0]),this];if(e>=1)return[this,singlePoint(this.points[this.points.length-1])];var t=lerpPoint(this.points[0],this.points[1],e),r=lerpPoint(this.points[1],this.points[2],e),n=lerpPoint(this.points[2],this.points[3],e),o=lerpPoint(t,r,e),i=lerpPoint(r,n,e),a=lerpPoint(o,i,e);return[new PolynomialBezier(this.points[0],t,o,a,!0),new PolynomialBezier(a,i,n,this.points[3],!0)]},PolynomialBezier.prototype.bounds=function(){return{x:extrema(this,0),y:extrema(this,1)}},PolynomialBezier.prototype.boundingBox=function(){var e=this.bounds();return{left:e.x.min,right:e.x.max,top:e.y.min,bottom:e.y.max,width:e.x.max-e.x.min,height:e.y.max-e.y.min,cx:(e.x.max+e.x.min)/2,cy:(e.y.max+e.y.min)/2}},PolynomialBezier.prototype.intersections=function(e,t,r){void 0===t&&(t=2),void 0===r&&(r=7);var n=[];return intersectsImpl(intersectData(this,0,1),intersectData(e,0,1),0,t,n,r),n},PolynomialBezier.shapeSegment=function(e,t){var r=(t+1)%e.length();return new PolynomialBezier(e.v[t],e.o[t],e.i[r],e.v[r],!0)},PolynomialBezier.shapeSegmentInverted=function(e,t){var r=(t+1)%e.length();return new PolynomialBezier(e.v[r],e.i[r],e.o[t],e.v[t],!0)},extendPrototype([ShapeModifier],ZigZagModifier),ZigZagModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.amplitude=PropertyFactory.getProp(e,t.s,0,null,this),this.frequency=PropertyFactory.getProp(e,t.r,0,null,this),this.pointsType=PropertyFactory.getProp(e,t.pt,0,null,this),this._isAnimated=0!==this.amplitude.effectsSequence.length||0!==this.frequency.effectsSequence.length||0!==this.pointsType.effectsSequence.length},ZigZagModifier.prototype.processPath=function(e,t,r,n){var o=e._length,i=shapePool.newElement();if(i.c=e.c,e.c||(o-=1),0===o)return i;var a=-1,s=PolynomialBezier.shapeSegment(e,0);zigZagCorner(i,e,0,t,r,n,a);for(var l=0;l<o;l+=1)a=zigZagSegment(i,s,t,r,n,-a),s=l!==o-1||e.c?PolynomialBezier.shapeSegment(e,(l+1)%o):null,zigZagCorner(i,e,l+1,t,r,n,a);return i},ZigZagModifier.prototype.processShapes=function(e){var t,r,n,o,i,a,s=this.shapes.length,l=this.amplitude.v,c=Math.max(0,Math.round(this.frequency.v)),u=this.pointsType.v;if(0!==l)for(r=0;r<s;r+=1){if(a=(i=this.shapes[r]).localShapeCollection,i.shape._mdf||this._mdf||e)for(a.releaseShapes(),i.shape._mdf=!0,t=i.shape.paths.shapes,o=i.shape.paths._length,n=0;n<o;n+=1)a.addShape(this.processPath(t[n],l,c,u));i.shape.paths=i.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},extendPrototype([ShapeModifier],OffsetPathModifier),OffsetPathModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(e,t.a,0,null,this),this.miterLimit=PropertyFactory.getProp(e,t.ml,0,null,this),this.lineJoin=t.lj,this._isAnimated=0!==this.amount.effectsSequence.length},OffsetPathModifier.prototype.processPath=function(e,t,r,n){var o=shapePool.newElement();o.c=e.c;var i,a,s,l=e.length();e.c||(l-=1);var c=[];for(i=0;i<l;i+=1)s=PolynomialBezier.shapeSegment(e,i),c.push(offsetSegmentSplit(s,t));if(!e.c)for(i=l-1;i>=0;i-=1)s=PolynomialBezier.shapeSegmentInverted(e,i),c.push(offsetSegmentSplit(s,t));c=pruneIntersections(c);var u=null,d=null;for(i=0;i<c.length;i+=1){var h=c[i];for(d&&(u=joinLines(o,d,h[0],r,n)),d=h[h.length-1],a=0;a<h.length;a+=1)s=h[a],u&&pointEqual(s.points[0],u)?o.setXYAt(s.points[1][0],s.points[1][1],"o",o.length()-1):o.setTripleAt(s.points[0][0],s.points[0][1],s.points[1][0],s.points[1][1],s.points[0][0],s.points[0][1],o.length()),o.setTripleAt(s.points[3][0],s.points[3][1],s.points[3][0],s.points[3][1],s.points[2][0],s.points[2][1],o.length()),u=s.points[3]}return c.length&&joinLines(o,d,c[0][0],r,n),o},OffsetPathModifier.prototype.processShapes=function(e){var t,r,n,o,i,a,s=this.shapes.length,l=this.amount.v,c=this.miterLimit.v,u=this.lineJoin;if(0!==l)for(r=0;r<s;r+=1){if(a=(i=this.shapes[r]).localShapeCollection,i.shape._mdf||this._mdf||e)for(a.releaseShapes(),i.shape._mdf=!0,t=i.shape.paths.shapes,o=i.shape.paths._length,n=0;n<o;n+=1)a.addShape(this.processPath(t[n],l,u,c));i.shape.paths=i.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)};var FontManager=function(){var e={w:0,size:0,shapes:[],data:{shapes:[]}},t=[];t=t.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var r=127988,n=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"];function o(e,t){var r=createTag("span");r.setAttribute("aria-hidden",!0),r.style.fontFamily=t;var n=createTag("span");n.innerText="giItT1WQy@!-/#",r.style.position="absolute",r.style.left="-10000px",r.style.top="-10000px",r.style.fontSize="300px",r.style.fontVariant="normal",r.style.fontStyle="normal",r.style.fontWeight="normal",r.style.letterSpacing="0",r.appendChild(n),document.body.appendChild(r);var o=n.offsetWidth;return n.style.fontFamily=function(e){var t,r=e.split(","),n=r.length,o=[];for(t=0;t<n;t+=1)"sans-serif"!==r[t]&&"monospace"!==r[t]&&o.push(r[t]);return o.join(",")}(e)+", "+t,{node:n,w:o,parent:r}}function i(e,t){var r,n=document.body&&t?"svg":"canvas",o=getFontProperties(e);if("svg"===n){var i=createNS("text");i.style.fontSize="100px",i.setAttribute("font-family",e.fFamily),i.setAttribute("font-style",o.style),i.setAttribute("font-weight",o.weight),i.textContent="1",e.fClass?(i.style.fontFamily="inherit",i.setAttribute("class",e.fClass)):i.style.fontFamily=e.fFamily,t.appendChild(i),r=i}else{var a=new OffscreenCanvas(500,500).getContext("2d");a.font=o.style+" "+o.weight+" 100px "+e.fFamily,r=a}return{measureText:function(e){return"svg"===n?(r.textContent=e,r.getComputedTextLength()):r.measureText(e).width}}}function a(e){var t=0,r=e.charCodeAt(0);if(r>=55296&&r<=56319){var n=e.charCodeAt(1);n>=56320&&n<=57343&&(t=1024*(r-55296)+n-56320+65536)}return t}function s(e){var t=a(e);return t>=127462&&t<=127487}var l=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)};l.isModifier=function(e,t){var r=e.toString(16)+t.toString(16);return-1!==n.indexOf(r)},l.isZeroWidthJoiner=function(e){return 8205===e},l.isFlagEmoji=function(e){return s(e.substr(0,2))&&s(e.substr(2,2))},l.isRegionalCode=s,l.isCombinedCharacter=function(e){return-1!==t.indexOf(e)},l.isRegionalFlag=function(e,t){var n=a(e.substr(t,2));if(n!==r)return!1;var o=0;for(t+=2;o<5;){if((n=a(e.substr(t,2)))<917601||n>917626)return!1;o+=1,t+=2}return 917631===a(e.substr(t,2))},l.isVariationSelector=function(e){return 65039===e},l.BLACK_FLAG_CODE_POINT=r;var c={addChars:function(e){if(e){var t;this.chars||(this.chars=[]);var r,n,o=e.length,i=this.chars.length;for(t=0;t<o;t+=1){for(r=0,n=!1;r<i;)this.chars[r].style===e[t].style&&this.chars[r].fFamily===e[t].fFamily&&this.chars[r].ch===e[t].ch&&(n=!0),r+=1;n||(this.chars.push(e[t]),i+=1)}}},addFonts:function(e,t){if(e){if(this.chars)return this.isLoaded=!0,void(this.fonts=e.list);if(!document.body)return this.isLoaded=!0,e.list.forEach((function(e){e.helper=i(e),e.cache={}})),void(this.fonts=e.list);var r,n=e.list,a=n.length,s=a;for(r=0;r<a;r+=1){var l,c,u=!0;if(n[r].loaded=!1,n[r].monoCase=o(n[r].fFamily,"monospace"),n[r].sansCase=o(n[r].fFamily,"sans-serif"),n[r].fPath){if("p"===n[r].fOrigin||3===n[r].origin){if((l=document.querySelectorAll('style[f-forigin="p"][f-family="'+n[r].fFamily+'"], style[f-origin="3"][f-family="'+n[r].fFamily+'"]')).length>0&&(u=!1),u){var d=createTag("style");d.setAttribute("f-forigin",n[r].fOrigin),d.setAttribute("f-origin",n[r].origin),d.setAttribute("f-family",n[r].fFamily),d.type="text/css",d.innerText="@font-face {font-family: "+n[r].fFamily+"; font-style: normal; src: url('"+n[r].fPath+"');}",t.appendChild(d)}}else if("g"===n[r].fOrigin||1===n[r].origin){for(l=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),c=0;c<l.length;c+=1)-1!==l[c].href.indexOf(n[r].fPath)&&(u=!1);if(u){var h=createTag("link");h.setAttribute("f-forigin",n[r].fOrigin),h.setAttribute("f-origin",n[r].origin),h.type="text/css",h.rel="stylesheet",h.href=n[r].fPath,document.body.appendChild(h)}}else if("t"===n[r].fOrigin||2===n[r].origin){for(l=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),c=0;c<l.length;c+=1)n[r].fPath===l[c].src&&(u=!1);if(u){var p=createTag("link");p.setAttribute("f-forigin",n[r].fOrigin),p.setAttribute("f-origin",n[r].origin),p.setAttribute("rel","stylesheet"),p.setAttribute("href",n[r].fPath),t.appendChild(p)}}}else n[r].loaded=!0,s-=1;n[r].helper=i(n[r],t),n[r].cache={},this.fonts.push(n[r])}0===s?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}else this.isLoaded=!0},getCharData:function(t,r,n){for(var o=0,i=this.chars.length;o<i;){if(this.chars[o].ch===t&&this.chars[o].style===r&&this.chars[o].fFamily===n)return this.chars[o];o+=1}return("string"==typeof t&&13!==t.charCodeAt(0)||!t)&&console&&console.warn&&!this._warned&&(this._warned=!0),e},getFontByName:function(e){for(var t=0,r=this.fonts.length;t<r;){if(this.fonts[t].fName===e)return this.fonts[t];t+=1}return this.fonts[0]},measureText:function(e,t,r){var n=this.getFontByName(t),o=e;if(!n.cache[o]){var i=n.helper;if(" "===e){var a=i.measureText("|"+e+"|"),s=i.measureText("||");n.cache[o]=(a-s)/100}else n.cache[o]=i.measureText(e)/100}return n.cache[o]*r},checkLoadedFonts:function(){var e,t,r,n=this.fonts.length,o=n;for(e=0;e<n;e+=1)this.fonts[e].loaded?o-=1:"n"===this.fonts[e].fOrigin||0===this.fonts[e].origin?this.fonts[e].loaded=!0:(t=this.fonts[e].monoCase.node,r=this.fonts[e].monoCase.w,t.offsetWidth!==r?(o-=1,this.fonts[e].loaded=!0):(t=this.fonts[e].sansCase.node,r=this.fonts[e].sansCase.w,t.offsetWidth!==r&&(o-=1,this.fonts[e].loaded=!0)),this.fonts[e].loaded&&(this.fonts[e].sansCase.parent.parentNode.removeChild(this.fonts[e].sansCase.parent),this.fonts[e].monoCase.parent.parentNode.removeChild(this.fonts[e].monoCase.parent)));0!==o&&Date.now()-this.initTime<5e3?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)},setIsLoaded:function(){this.isLoaded=!0}};return l.prototype=c,l}();function SlotManager(e){this.animationData=e}function slotFactory(e){return new SlotManager(e)}function RenderableElement(){}SlotManager.prototype.getProp=function(e){return this.animationData.slots&&this.animationData.slots[e.sid]?Object.assign(e,this.animationData.slots[e.sid].p):e},RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(e){-1===this.renderableComponents.indexOf(e)&&this.renderableComponents.push(e)},removeRenderableComponent:function(e){-1!==this.renderableComponents.indexOf(e)&&this.renderableComponents.splice(this.renderableComponents.indexOf(e),1)},prepareRenderableFrame:function(e){this.checkLayerLimits(e)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(e){this.data.ip-this.data.st<=e&&this.data.op-this.data.st>e?!0!==this.isInRange&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):!1!==this.isInRange&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var e,t=this.renderableComponents.length;for(e=0;e<t;e+=1)this.renderableComponents[e].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return 5===this.data.ty?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}};var getBlendMode=function(){var e={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"};return function(t){return e[t]||""}}();function SliderEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,0,0,r)}function AngleEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,0,0,r)}function ColorEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,1,0,r)}function PointEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,1,0,r)}function LayerIndexEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,0,0,r)}function MaskIndexEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,0,0,r)}function CheckboxEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,0,0,r)}function NoValueEffect(){this.p={}}function EffectsManager(e,t){var r,n=e.ef||[];this.effectElements=[];var o,i=n.length;for(r=0;r<i;r+=1)o=new GroupEffect(n[r],t),this.effectElements.push(o)}function GroupEffect(e,t){this.init(e,t)}function BaseElement(){}function FrameElement(){}function FootageElement(e,t,r){this.initFrame(),this.initRenderable(),this.assetData=t.getAssetData(e.refId),this.footageData=t.imageLoader.getAsset(this.assetData),this.initBaseData(e,t,r)}function AudioElement(e,t,r){this.initFrame(),this.initRenderable(),this.assetData=t.getAssetData(e.refId),this.initBaseData(e,t,r),this._isPlaying=!1,this._canPlay=!1;var n=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio(n),this._currentTime=0,this.globalData.audioController.addAudio(this),this._volumeMultiplier=1,this._volume=1,this._previousVolume=null,this.tm=e.tm?PropertyFactory.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0},this.lv=PropertyFactory.getProp(this,e.au&&e.au.lv?e.au.lv:{k:[100]},1,.01,this)}function BaseRenderer(){}extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(e,t){var r;this.data=e,this.effectElements=[],this.initDynamicPropertyContainer(t);var n,o=this.data.ef.length,i=this.data.ef;for(r=0;r<o;r+=1){switch(n=null,i[r].ty){case 0:n=new SliderEffect(i[r],t,this);break;case 1:n=new AngleEffect(i[r],t,this);break;case 2:n=new ColorEffect(i[r],t,this);break;case 3:n=new PointEffect(i[r],t,this);break;case 4:case 7:n=new CheckboxEffect(i[r],t,this);break;case 10:n=new LayerIndexEffect(i[r],t,this);break;case 11:n=new MaskIndexEffect(i[r],t,this);break;case 5:n=new EffectsManager(i[r],t);break;default:n=new NoValueEffect(i[r])}n&&this.effectElements.push(n)}},BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var e=0,t=this.data.masksProperties.length;e<t;){if("n"!==this.data.masksProperties[e].mode&&!1!==this.data.masksProperties[e].cl)return!0;e+=1}return!1},initExpressions:function(){var e=getExpressionInterfaces();if(e){var t=e("layer"),r=e("effects"),n=e("shape"),o=e("text"),i=e("comp");this.layerInterface=t(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var a=r.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(a),0===this.data.ty||this.data.xt?this.compInterface=i(this):4===this.data.ty?(this.layerInterface.shapeInterface=n(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):5===this.data.ty&&(this.layerInterface.textInterface=o(this),this.layerInterface.text=this.layerInterface.textInterface)}},setBlendMode:function(){var e=getBlendMode(this.data.bm);(this.baseElement||this.layerElement).style["mix-blend-mode"]=e},initBaseData:function(e,t,r){this.globalData=t,this.comp=r,this.data=e,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}},FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(e,t){var r,n=this.dynamicProperties.length;for(r=0;r<n;r+=1)(t||this._isParent&&"transform"===this.dynamicProperties[r].propType)&&(this.dynamicProperties[r].getValue(),this.dynamicProperties[r]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(e){-1===this.dynamicProperties.indexOf(e)&&this.dynamicProperties.push(e)}},FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){var e=getExpressionInterfaces();if(e){var t=e("footage");this.layerInterface=t(this)}},FootageElement.prototype.getFootageData=function(){return this.footageData},AudioElement.prototype.prepareFrame=function(e){if(this.prepareRenderableFrame(e,!0),this.prepareProperties(e,!0),this.tm._placeholder)this._currentTime=e/this.data.sr;else{var t=this.tm.v;this._currentTime=t}this._volume=this.lv.v[0];var r=this._volume*this._volumeMultiplier;this._previousVolume!==r&&(this._previousVolume=r,this.audio.volume(r))},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},AudioElement.prototype.resume=function(){this._canPlay=!0},AudioElement.prototype.setRate=function(e){this.audio.rate(e)},AudioElement.prototype.volume=function(e){this._volumeMultiplier=e,this._previousVolume=e*this._volume,this.audio.volume(this._previousVolume)},AudioElement.prototype.getBaseElement=function(){return null},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){},BaseRenderer.prototype.checkLayers=function(e){var t,r,n=this.layers.length;for(this.completeLayers=!0,t=n-1;t>=0;t-=1)this.elements[t]||(r=this.layers[t]).ip-r.st<=e-this.layers[t].st&&r.op-r.st>e-this.layers[t].st&&this.buildItem(t),this.completeLayers=!!this.elements[t]&&this.completeLayers;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(e){switch(e.ty){case 2:return this.createImage(e);case 0:return this.createComp(e);case 1:return this.createSolid(e);case 3:default:return this.createNull(e);case 4:return this.createShape(e);case 5:return this.createText(e);case 6:return this.createAudio(e);case 13:return this.createCamera(e);case 15:return this.createFootage(e)}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.createAudio=function(e){return new AudioElement(e,this.globalData,this)},BaseRenderer.prototype.createFootage=function(e){return new FootageElement(e,this.globalData,this)},BaseRenderer.prototype.buildAllItems=function(){var e,t=this.layers.length;for(e=0;e<t;e+=1)this.buildItem(e);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(e){var t;this.completeLayers=!1;var r,n=e.length,o=this.layers.length;for(t=0;t<n;t+=1)for(r=0;r<o;){if(this.layers[r].id===e[t].id){this.layers[r]=e[t];break}r+=1}},BaseRenderer.prototype.setProjectInterface=function(e){this.globalData.projectInterface=e},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(e,t,r){for(var n=this.elements,o=this.layers,i=0,a=o.length;i<a;)o[i].ind==t&&(n[i]&&!0!==n[i]?(r.push(n[i]),n[i].setAsParent(),void 0!==o[i].parent?this.buildElementParenting(e,o[i].parent,r):e.setHierarchy(r)):(this.buildItem(i),this.addPendingElement(e))),i+=1},BaseRenderer.prototype.addPendingElement=function(e){this.pendingElements.push(e)},BaseRenderer.prototype.searchExtraCompositions=function(e){var t,r=e.length;for(t=0;t<r;t+=1)if(e[t].xt){var n=this.createComp(e[t]);n.initExpressions(),this.globalData.projectInterface.registerComposition(n)}},BaseRenderer.prototype.getElementById=function(e){var t,r=this.elements.length;for(t=0;t<r;t+=1)if(this.elements[t].data.ind===e)return this.elements[t];return null},BaseRenderer.prototype.getElementByPath=function(e){var t,r=e.shift();if("number"==typeof r)t=this.elements[r];else{var n,o=this.elements.length;for(n=0;n<o;n+=1)if(this.elements[n].data.nm===r){t=this.elements[n];break}}return 0===e.length?t:t.getElementByPath(e)},BaseRenderer.prototype.setupGlobalData=function(e,t){this.globalData.fontManager=new FontManager,this.globalData.slotManager=slotFactory(e),this.globalData.fontManager.addChars(e.chars),this.globalData.fontManager.addFonts(e.fonts,t),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=e.fr,this.globalData.nm=e.nm,this.globalData.compSize={w:e.w,h:e.h}};var effectTypes={TRANSFORM_EFFECT:"transformEFfect"};function TransformElement(){}function MaskElement(e,t,r){this.data=e,this.element=t,this.globalData=r,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var n,o,i=this.globalData.defs,a=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(a),this.solidPath="";var s,l,c,u,d,h,p=this.masksProperties,f=0,g=[],m=createElementID(),y="clipPath",v="clip-path";for(n=0;n<a;n+=1)if(("a"!==p[n].mode&&"n"!==p[n].mode||p[n].inv||100!==p[n].o.k||p[n].o.x)&&(y="mask",v="mask"),"s"!==p[n].mode&&"i"!==p[n].mode||0!==f?c=null:((c=createNS("rect")).setAttribute("fill","#ffffff"),c.setAttribute("width",this.element.comp.data.w||0),c.setAttribute("height",this.element.comp.data.h||0),g.push(c)),o=createNS("path"),"n"===p[n].mode)this.viewData[n]={op:PropertyFactory.getProp(this.element,p[n].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,p[n],3),elem:o,lastPath:""},i.appendChild(o);else{var _;if(f+=1,o.setAttribute("fill","s"===p[n].mode?"#000000":"#ffffff"),o.setAttribute("clip-rule","nonzero"),0!==p[n].x.k?(y="mask",v="mask",h=PropertyFactory.getProp(this.element,p[n].x,0,null,this.element),_=createElementID(),(u=createNS("filter")).setAttribute("id",_),(d=createNS("feMorphology")).setAttribute("operator","erode"),d.setAttribute("in","SourceGraphic"),d.setAttribute("radius","0"),u.appendChild(d),i.appendChild(u),o.setAttribute("stroke","s"===p[n].mode?"#000000":"#ffffff")):(d=null,h=null),this.storedData[n]={elem:o,x:h,expan:d,lastPath:"",lastOperator:"",filterId:_,lastRadius:0},"i"===p[n].mode){l=g.length;var b=createNS("g");for(s=0;s<l;s+=1)b.appendChild(g[s]);var C=createNS("mask");C.setAttribute("mask-type","alpha"),C.setAttribute("id",m+"_"+f),C.appendChild(o),i.appendChild(C),b.setAttribute("mask","url("+getLocationHref()+"#"+m+"_"+f+")"),g.length=0,g.push(b)}else g.push(o);p[n].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[n]={elem:o,lastPath:"",op:PropertyFactory.getProp(this.element,p[n].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,p[n],3),invRect:c},this.viewData[n].prop.k||this.drawPath(p[n],this.viewData[n].prop.v,this.viewData[n])}for(this.maskElement=createNS(y),a=g.length,n=0;n<a;n+=1)this.maskElement.appendChild(g[n]);f>0&&(this.maskElement.setAttribute("id",m),this.element.maskedElement.setAttribute(v,"url("+getLocationHref()+"#"+m+")"),i.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}TransformElement.prototype={initTransform:function(){var e=new Matrix;this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_localMatMdf:!1,_opMdf:!1,mat:e,localMat:e,localOpacity:1},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var e,t=this.finalTransform.mat,r=0,n=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;r<n;){if(this.hierarchy[r].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}r+=1}if(this.finalTransform._matMdf)for(e=this.finalTransform.mProp.v.props,t.cloneFromProps(e),r=0;r<n;r+=1)t.multiply(this.hierarchy[r].finalTransform.mProp.v)}this.finalTransform._matMdf&&(this.finalTransform._localMatMdf=this.finalTransform._matMdf),this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v)},renderLocalTransform:function(){if(this.localTransforms){var e=0,t=this.localTransforms.length;if(this.finalTransform._localMatMdf=this.finalTransform._matMdf,!this.finalTransform._localMatMdf||!this.finalTransform._opMdf)for(;e<t;)this.localTransforms[e]._mdf&&(this.finalTransform._localMatMdf=!0),this.localTransforms[e]._opMdf&&!this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v,this.finalTransform._opMdf=!0),e+=1;if(this.finalTransform._localMatMdf){var r=this.finalTransform.localMat;for(this.localTransforms[0].matrix.clone(r),e=1;e<t;e+=1){var n=this.localTransforms[e].matrix;r.multiply(n)}r.multiply(this.finalTransform.mat)}if(this.finalTransform._opMdf){var o=this.finalTransform.localOpacity;for(e=0;e<t;e+=1)o*=.01*this.localTransforms[e].opacity;this.finalTransform.localOpacity=o}}},searchEffectTransforms:function(){if(this.renderableEffectsManager){var e=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT);if(e.length){this.localTransforms=[],this.finalTransform.localMat=new Matrix;var t=0,r=e.length;for(t=0;t<r;t+=1)this.localTransforms.push(e[t])}}},globalToLocal:function(e){var t=[];t.push(this.finalTransform);for(var r,n=!0,o=this.comp;n;)o.finalTransform?(o.data.hasMask&&t.splice(0,0,o.finalTransform),o=o.comp):n=!1;var i,a=t.length;for(r=0;r<a;r+=1)i=t[r].mat.applyToPointArray(0,0,0),e=[e[0]-i[0],e[1]-i[1],0];return e},mHelper:new Matrix},MaskElement.prototype.getMaskProperty=function(e){return this.viewData[e].prop},MaskElement.prototype.renderFrame=function(e){var t,r=this.element.finalTransform.mat,n=this.masksProperties.length;for(t=0;t<n;t+=1)if((this.viewData[t].prop._mdf||e)&&this.drawPath(this.masksProperties[t],this.viewData[t].prop.v,this.viewData[t]),(this.viewData[t].op._mdf||e)&&this.viewData[t].elem.setAttribute("fill-opacity",this.viewData[t].op.v),"n"!==this.masksProperties[t].mode&&(this.viewData[t].invRect&&(this.element.finalTransform.mProp._mdf||e)&&this.viewData[t].invRect.setAttribute("transform",r.getInverseMatrix().to2dCSS()),this.storedData[t].x&&(this.storedData[t].x._mdf||e))){var o=this.storedData[t].expan;this.storedData[t].x.v<0?("erode"!==this.storedData[t].lastOperator&&(this.storedData[t].lastOperator="erode",this.storedData[t].elem.setAttribute("filter","url("+getLocationHref()+"#"+this.storedData[t].filterId+")")),o.setAttribute("radius",-this.storedData[t].x.v)):("dilate"!==this.storedData[t].lastOperator&&(this.storedData[t].lastOperator="dilate",this.storedData[t].elem.setAttribute("filter",null)),this.storedData[t].elem.setAttribute("stroke-width",2*this.storedData[t].x.v))}},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var e="M0,0 ";return e+=" h"+this.globalData.compSize.w,e+=" v"+this.globalData.compSize.h,e+=" h-"+this.globalData.compSize.w,e+=" v-"+this.globalData.compSize.h+" "},MaskElement.prototype.drawPath=function(e,t,r){var n,o,i=" M"+t.v[0][0]+","+t.v[0][1];for(o=t._length,n=1;n<o;n+=1)i+=" C"+t.o[n-1][0]+","+t.o[n-1][1]+" "+t.i[n][0]+","+t.i[n][1]+" "+t.v[n][0]+","+t.v[n][1];if(t.c&&o>1&&(i+=" C"+t.o[n-1][0]+","+t.o[n-1][1]+" "+t.i[0][0]+","+t.i[0][1]+" "+t.v[0][0]+","+t.v[0][1]),r.lastPath!==i){var a="";r.elem&&(t.c&&(a=e.inv?this.solidPath+i:i),r.elem.setAttribute("d",a)),r.lastPath=i}},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null};var filtersFactory=function(){var e={createFilter:function(e,t){var r=createNS("filter");return r.setAttribute("id",e),!0!==t&&(r.setAttribute("filterUnits","objectBoundingBox"),r.setAttribute("x","0%"),r.setAttribute("y","0%"),r.setAttribute("width","100%"),r.setAttribute("height","100%")),r},createAlphaToLuminanceFilter:function(){var e=createNS("feColorMatrix");return e.setAttribute("type","matrix"),e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),e}};return e}(),featureSupport=function(){var e={maskType:!0,svgLumaHidden:!0,offscreenCanvas:"undefined"!=typeof OffscreenCanvas};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(e.maskType=!1),/firefox/i.test(navigator.userAgent)&&(e.svgLumaHidden=!1),e}(),registeredEffects$1={},idPrefix="filter_result_";function SVGEffects(e){var t,r,n="SourceGraphic",o=e.data.ef?e.data.ef.length:0,i=createElementID(),a=filtersFactory.createFilter(i,!0),s=0;for(this.filters=[],t=0;t<o;t+=1){r=null;var l=e.data.ef[t].ty;registeredEffects$1[l]&&(r=new(0,registeredEffects$1[l].effect)(a,e.effectsManager.effectElements[t],e,idPrefix+s,n),n=idPrefix+s,registeredEffects$1[l].countsAsEffect&&(s+=1)),r&&this.filters.push(r)}s&&(e.globalData.defs.appendChild(a),e.layerElement.setAttribute("filter","url("+getLocationHref()+"#"+i+")")),this.filters.length&&e.addRenderableComponent(this)}function registerEffect$1(e,t,r){registeredEffects$1[e]={effect:t,countsAsEffect:r}}function SVGBaseElement(){}function HierarchyElement(){}function RenderableDOMElement(){}function IImageElement(e,t,r){this.assetData=t.getAssetData(e.refId),this.assetData&&this.assetData.sid&&(this.assetData=t.slotManager.getProp(this.assetData)),this.initElement(e,t,r),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}function ProcessedElement(e,t){this.elem=e,this.pos=t}function IShapeElement(){}SVGEffects.prototype.renderFrame=function(e){var t,r=this.filters.length;for(t=0;t<r;t+=1)this.filters[t].renderFrame(e)},SVGEffects.prototype.getEffects=function(e){var t,r=this.filters.length,n=[];for(t=0;t<r;t+=1)this.filters[t].type===e&&n.push(this.filters[t]);return n},SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var e=null;if(this.data.td){this.matteMasks={};var t=createNS("g");t.setAttribute("id",this.layerId),t.appendChild(this.layerElement),e=t,this.globalData.defs.appendChild(t)}else this.data.tt?(this.matteElement.appendChild(this.layerElement),e=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),0===this.data.ty&&!this.data.hd){var r=createNS("clipPath"),n=createNS("path");n.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var o=createElementID();if(r.setAttribute("id",o),r.appendChild(n),this.globalData.defs.appendChild(r),this.checkMasks()){var i=createNS("g");i.setAttribute("clip-path","url("+getLocationHref()+"#"+o+")"),i.appendChild(this.layerElement),this.transformedElement=i,e?e.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+o+")")}0!==this.data.bm&&this.setBlendMode()},renderElement:function(){this.finalTransform._localMatMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.localMat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.localOpacity)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this),this.searchEffectTransforms()},getMatte:function(e){if(this.matteMasks||(this.matteMasks={}),!this.matteMasks[e]){var t,r,n,o,i=this.layerId+"_"+e;if(1===e||3===e){var a=createNS("mask");a.setAttribute("id",i),a.setAttribute("mask-type",3===e?"luminance":"alpha"),(n=createNS("use")).setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),a.appendChild(n),this.globalData.defs.appendChild(a),featureSupport.maskType||1!==e||(a.setAttribute("mask-type","luminance"),t=createElementID(),r=filtersFactory.createFilter(t),this.globalData.defs.appendChild(r),r.appendChild(filtersFactory.createAlphaToLuminanceFilter()),(o=createNS("g")).appendChild(n),a.appendChild(o),o.setAttribute("filter","url("+getLocationHref()+"#"+t+")"))}else if(2===e){var s=createNS("mask");s.setAttribute("id",i),s.setAttribute("mask-type","alpha");var l=createNS("g");s.appendChild(l),t=createElementID(),r=filtersFactory.createFilter(t);var c=createNS("feComponentTransfer");c.setAttribute("in","SourceGraphic"),r.appendChild(c);var u=createNS("feFuncA");u.setAttribute("type","table"),u.setAttribute("tableValues","1.0 0.0"),c.appendChild(u),this.globalData.defs.appendChild(r);var d=createNS("rect");d.setAttribute("width",this.comp.data.w),d.setAttribute("height",this.comp.data.h),d.setAttribute("x","0"),d.setAttribute("y","0"),d.setAttribute("fill","#ffffff"),d.setAttribute("opacity","0"),l.setAttribute("filter","url("+getLocationHref()+"#"+t+")"),l.appendChild(d),(n=createNS("use")).setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),l.appendChild(n),featureSupport.maskType||(s.setAttribute("mask-type","luminance"),r.appendChild(filtersFactory.createAlphaToLuminanceFilter()),o=createNS("g"),l.appendChild(d),o.appendChild(this.layerElement),l.appendChild(o)),this.globalData.defs.appendChild(s)}this.matteMasks[e]=i}return this.matteMasks[e]},setMatte:function(e){this.matteElement&&this.matteElement.setAttribute("mask","url("+getLocationHref()+"#"+e+")")}},HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(e){this.hierarchy=e},setAsParent:function(){this._isParent=!0},checkParenting:function(){void 0!==this.data.parent&&this.comp.buildElementParenting(this,this.data.parent,[])}},extendPrototype([RenderableElement,createProxyFunction({initElement:function(e,t,r){this.initFrame(),this.initBaseData(e,t,r),this.initTransform(e,t,r),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){this.hidden||this.isInRange&&!this.isTransparent||((this.baseElement||this.layerElement).style.display="none",this.hidden=!0)},show:function(){this.isInRange&&!this.isTransparent&&(this.data.hd||((this.baseElement||this.layerElement).style.display="block"),this.hidden=!1,this._isFirstFrame=!0)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(e){this._mdf=!1,this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}})],RenderableDOMElement),extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var e=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",e),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect},IShapeElement.prototype={addShapeToModifiers:function(e){var t,r=this.shapeModifiers.length;for(t=0;t<r;t+=1)this.shapeModifiers[t].addShape(e)},isShapeInAnimatedModifiers:function(e){for(var t=this.shapeModifiers.length;0<t;)if(this.shapeModifiers[0].isAnimatedWithShape(e))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var e,t=this.shapes.length;for(e=0;e<t;e+=1)this.shapes[e].sh.reset();for(e=(t=this.shapeModifiers.length)-1;e>=0&&!this.shapeModifiers[e].processShapes(this._isFirstFrame);e-=1);}},searchProcessedElement:function(e){for(var t=this.processedElements,r=0,n=t.length;r<n;){if(t[r].elem===e)return t[r].pos;r+=1}return 0},addProcessedElement:function(e,t){for(var r=this.processedElements,n=r.length;n;)if(r[n-=1].elem===e)return void(r[n].pos=t);r.push(new ProcessedElement(e,t))},prepareFrame:function(e){this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange)}};var lineCapEnum={1:"butt",2:"round",3:"square"},lineJoinEnum={1:"miter",2:"round",3:"bevel"};function SVGShapeData(e,t,r){this.caches=[],this.styles=[],this.transformers=e,this.lStr="",this.sh=r,this.lvl=t,this._isAnimated=!!r.k;for(var n=0,o=e.length;n<o;){if(e[n].mProps.dynamicProperties.length){this._isAnimated=!0;break}n+=1}}function SVGStyleData(e,t){this.data=e,this.type=e.ty,this.d="",this.lvl=t,this._mdf=!1,this.closed=!0===e.hd,this.pElem=createNS("path"),this.msElem=null}function DashProperty(e,t,r,n){var o;this.elem=e,this.frameId=-1,this.dataProps=createSizedArray(t.length),this.renderer=r,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",t.length?t.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer(n);var i,a=t.length||0;for(o=0;o<a;o+=1)i=PropertyFactory.getProp(e,t[o].v,0,0,this),this.k=i.k||this.k,this.dataProps[o]={n:t[o].n,p:i};this.k||this.getValue(!0),this._isAnimated=this.k}function SVGStrokeStyleData(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(e,t.o,0,.01,this),this.w=PropertyFactory.getProp(e,t.w,0,null,this),this.d=new DashProperty(e,t.d||{},"svg",this),this.c=PropertyFactory.getProp(e,t.c,1,255,this),this.style=r,this._isAnimated=!!this._isAnimated}function SVGFillStyleData(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(e,t.o,0,.01,this),this.c=PropertyFactory.getProp(e,t.c,1,255,this),this.style=r}function SVGNoStyleData(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.style=r}function GradientProperty(e,t,r){this.data=t,this.c=createTypedArray("uint8c",4*t.p);var n=t.k.k[0].s?t.k.k[0].s.length-4*t.p:t.k.k.length-4*t.p;this.o=createTypedArray("float32",n),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=n,this.initDynamicPropertyContainer(r),this.prop=PropertyFactory.getProp(e,t.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}function SVGGradientFillStyleData(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.initGradientData(e,t,r)}function SVGGradientStrokeStyleData(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(e,t.w,0,null,this),this.d=new DashProperty(e,t.d||{},"svg",this),this.initGradientData(e,t,r),this._isAnimated=!!this._isAnimated}function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}function SVGTransformData(e,t,r){this.transform={mProps:e,op:t,container:r},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0},SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1},DashProperty.prototype.getValue=function(e){if((this.elem.globalData.frameId!==this.frameId||e)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||e,this._mdf)){var t=0,r=this.dataProps.length;for("svg"===this.renderer&&(this.dashStr=""),t=0;t<r;t+=1)"o"!==this.dataProps[t].n?"svg"===this.renderer?this.dashStr+=" "+this.dataProps[t].p.v:this.dashArray[t]=this.dataProps[t].p.v:this.dashoffset[0]=this.dataProps[t].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty),extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData),extendPrototype([DynamicPropertyContainer],SVGFillStyleData),extendPrototype([DynamicPropertyContainer],SVGNoStyleData),GradientProperty.prototype.comparePoints=function(e,t){for(var r=0,n=this.o.length/2;r<n;){if(Math.abs(e[4*r]-e[4*t+2*r])>.01)return!1;r+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!=this.c.length/4)return!1;if(this.data.k.k[0].s)for(var e=0,t=this.data.k.k.length;e<t;){if(!this.comparePoints(this.data.k.k[e].s,this.data.p))return!1;e+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(e){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||e){var t,r,n,o=4*this.data.p;for(t=0;t<o;t+=1)r=t%4==0?100:255,n=Math.round(this.prop.v[t]*r),this.c[t]!==n&&(this.c[t]=n,this._cmdf=!e);if(this.o.length)for(o=this.prop.v.length,t=4*this.data.p;t<o;t+=1)r=t%2==0?100:1,n=t%2==0?Math.round(100*this.prop.v[t]):this.prop.v[t],this.o[t-4*this.data.p]!==n&&(this.o[t-4*this.data.p]=n,this._omdf=!e);this._mdf=!e}},extendPrototype([DynamicPropertyContainer],GradientProperty),SVGGradientFillStyleData.prototype.initGradientData=function(e,t,r){this.o=PropertyFactory.getProp(e,t.o,0,.01,this),this.s=PropertyFactory.getProp(e,t.s,1,null,this),this.e=PropertyFactory.getProp(e,t.e,1,null,this),this.h=PropertyFactory.getProp(e,t.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(e,t.a||{k:0},0,degToRads,this),this.g=new GradientProperty(e,t.g,this),this.style=r,this.stops=[],this.setGradientData(r.pElem,t),this.setGradientOpacity(t,r),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(e,t){var r=createElementID(),n=createNS(1===t.t?"linearGradient":"radialGradient");n.setAttribute("id",r),n.setAttribute("spreadMethod","pad"),n.setAttribute("gradientUnits","userSpaceOnUse");var o,i,a,s=[];for(a=4*t.g.p,i=0;i<a;i+=4)o=createNS("stop"),n.appendChild(o),s.push(o);e.setAttribute("gf"===t.ty?"fill":"stroke","url("+getLocationHref()+"#"+r+")"),this.gf=n,this.cst=s},SVGGradientFillStyleData.prototype.setGradientOpacity=function(e,t){if(this.g._hasOpacity&&!this.g._collapsable){var r,n,o,i=createNS("mask"),a=createNS("path");i.appendChild(a);var s=createElementID(),l=createElementID();i.setAttribute("id",l);var c=createNS(1===e.t?"linearGradient":"radialGradient");c.setAttribute("id",s),c.setAttribute("spreadMethod","pad"),c.setAttribute("gradientUnits","userSpaceOnUse"),o=e.g.k.k[0].s?e.g.k.k[0].s.length:e.g.k.k.length;var u=this.stops;for(n=4*e.g.p;n<o;n+=2)(r=createNS("stop")).setAttribute("stop-color","rgb(255,255,255)"),c.appendChild(r),u.push(r);a.setAttribute("gf"===e.ty?"fill":"stroke","url("+getLocationHref()+"#"+s+")"),"gs"===e.ty&&(a.setAttribute("stroke-linecap",lineCapEnum[e.lc||2]),a.setAttribute("stroke-linejoin",lineJoinEnum[e.lj||2]),1===e.lj&&a.setAttribute("stroke-miterlimit",e.ml)),this.of=c,this.ms=i,this.ost=u,this.maskId=l,t.msElem=a}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData),extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);var buildShapeString=function(e,t,r,n){if(0===t)return"";var o,i=e.o,a=e.i,s=e.v,l=" M"+n.applyToPointStringified(s[0][0],s[0][1]);for(o=1;o<t;o+=1)l+=" C"+n.applyToPointStringified(i[o-1][0],i[o-1][1])+" "+n.applyToPointStringified(a[o][0],a[o][1])+" "+n.applyToPointStringified(s[o][0],s[o][1]);return r&&t&&(l+=" C"+n.applyToPointStringified(i[o-1][0],i[o-1][1])+" "+n.applyToPointStringified(a[0][0],a[0][1])+" "+n.applyToPointStringified(s[0][0],s[0][1]),l+="z"),l},SVGElementsRenderer=function(){var e=new Matrix,t=new Matrix;function r(e,t,r){(r||t.transform.op._mdf)&&t.transform.container.setAttribute("opacity",t.transform.op.v),(r||t.transform.mProps._mdf)&&t.transform.container.setAttribute("transform",t.transform.mProps.v.to2dCSS())}function n(){}function o(r,n,o){var i,a,s,l,c,u,d,h,p,f,g=n.styles.length,m=n.lvl;for(u=0;u<g;u+=1){if(l=n.sh._mdf||o,n.styles[u].lvl<m){for(h=t.reset(),p=m-n.styles[u].lvl,f=n.transformers.length-1;!l&&p>0;)l=n.transformers[f].mProps._mdf||l,p-=1,f-=1;if(l)for(p=m-n.styles[u].lvl,f=n.transformers.length-1;p>0;)h.multiply(n.transformers[f].mProps.v),p-=1,f-=1}else h=e;if(a=(d=n.sh.paths)._length,l){for(s="",i=0;i<a;i+=1)(c=d.shapes[i])&&c._length&&(s+=buildShapeString(c,c._length,c.c,h));n.caches[u]=s}else s=n.caches[u];n.styles[u].d+=!0===r.hd?"":s,n.styles[u]._mdf=l||n.styles[u]._mdf}}function i(e,t,r){var n=t.style;(t.c._mdf||r)&&n.pElem.setAttribute("fill","rgb("+bmFloor(t.c.v[0])+","+bmFloor(t.c.v[1])+","+bmFloor(t.c.v[2])+")"),(t.o._mdf||r)&&n.pElem.setAttribute("fill-opacity",t.o.v)}function a(e,t,r){s(e,t,r),l(0,t,r)}function s(e,t,r){var n,o,i,a,s,l=t.gf,c=t.g._hasOpacity,u=t.s.v,d=t.e.v;if(t.o._mdf||r){var h="gf"===e.ty?"fill-opacity":"stroke-opacity";t.style.pElem.setAttribute(h,t.o.v)}if(t.s._mdf||r){var p=1===e.t?"x1":"cx",f="x1"===p?"y1":"cy";l.setAttribute(p,u[0]),l.setAttribute(f,u[1]),c&&!t.g._collapsable&&(t.of.setAttribute(p,u[0]),t.of.setAttribute(f,u[1]))}if(t.g._cmdf||r){n=t.cst;var g=t.g.c;for(i=n.length,o=0;o<i;o+=1)(a=n[o]).setAttribute("offset",g[4*o]+"%"),a.setAttribute("stop-color","rgb("+g[4*o+1]+","+g[4*o+2]+","+g[4*o+3]+")")}if(c&&(t.g._omdf||r)){var m=t.g.o;for(i=(n=t.g._collapsable?t.cst:t.ost).length,o=0;o<i;o+=1)a=n[o],t.g._collapsable||a.setAttribute("offset",m[2*o]+"%"),a.setAttribute("stop-opacity",m[2*o+1])}if(1===e.t)(t.e._mdf||r)&&(l.setAttribute("x2",d[0]),l.setAttribute("y2",d[1]),c&&!t.g._collapsable&&(t.of.setAttribute("x2",d[0]),t.of.setAttribute("y2",d[1])));else if((t.s._mdf||t.e._mdf||r)&&(s=Math.sqrt(Math.pow(u[0]-d[0],2)+Math.pow(u[1]-d[1],2)),l.setAttribute("r",s),c&&!t.g._collapsable&&t.of.setAttribute("r",s)),t.e._mdf||t.h._mdf||t.a._mdf||r){s||(s=Math.sqrt(Math.pow(u[0]-d[0],2)+Math.pow(u[1]-d[1],2)));var y=Math.atan2(d[1]-u[1],d[0]-u[0]),v=t.h.v;v>=1?v=.99:v<=-1&&(v=-.99);var _=s*v,b=Math.cos(y+t.a.v)*_+u[0],C=Math.sin(y+t.a.v)*_+u[1];l.setAttribute("fx",b),l.setAttribute("fy",C),c&&!t.g._collapsable&&(t.of.setAttribute("fx",b),t.of.setAttribute("fy",C))}}function l(e,t,r){var n=t.style,o=t.d;o&&(o._mdf||r)&&o.dashStr&&(n.pElem.setAttribute("stroke-dasharray",o.dashStr),n.pElem.setAttribute("stroke-dashoffset",o.dashoffset[0])),t.c&&(t.c._mdf||r)&&n.pElem.setAttribute("stroke","rgb("+bmFloor(t.c.v[0])+","+bmFloor(t.c.v[1])+","+bmFloor(t.c.v[2])+")"),(t.o._mdf||r)&&n.pElem.setAttribute("stroke-opacity",t.o.v),(t.w._mdf||r)&&(n.pElem.setAttribute("stroke-width",t.w.v),n.msElem&&n.msElem.setAttribute("stroke-width",t.w.v))}return{createRenderFunction:function(e){switch(e.ty){case"fl":return i;case"gf":return s;case"gs":return a;case"st":return l;case"sh":case"el":case"rc":case"sr":return o;case"tr":return r;case"no":return n;default:return null}}}}();function SVGShapeElement(e,t,r){this.shapes=[],this.shapesData=e.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(e,t,r),this.prevViewData=[]}function LetterProps(e,t,r,n,o,i){this.o=e,this.sw=t,this.sc=r,this.fc=n,this.m=o,this.p=i,this._mdf={o:!0,sw:!!t,sc:!!r,fc:!!n,m:!0,p:!0}}function TextProperty(e,t){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,t.d&&t.d.sid&&(t.d=e.globalData.slotManager.getProp(t.d)),this.data=t,this.elem=e,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){var e,t,r,n,o=this.shapes.length,i=this.stylesList.length,a=[],s=!1;for(r=0;r<i;r+=1){for(n=this.stylesList[r],s=!1,a.length=0,e=0;e<o;e+=1)-1!==(t=this.shapes[e]).styles.indexOf(n)&&(a.push(t),s=t._isAnimated||s);a.length>1&&s&&this.setShapesAsAnimated(a)}},SVGShapeElement.prototype.setShapesAsAnimated=function(e){var t,r=e.length;for(t=0;t<r;t+=1)e[t].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(e,t){var r,n=new SVGStyleData(e,t),o=n.pElem;return"st"===e.ty?r=new SVGStrokeStyleData(this,e,n):"fl"===e.ty?r=new SVGFillStyleData(this,e,n):"gf"===e.ty||"gs"===e.ty?(r=new("gf"===e.ty?SVGGradientFillStyleData:SVGGradientStrokeStyleData)(this,e,n),this.globalData.defs.appendChild(r.gf),r.maskId&&(this.globalData.defs.appendChild(r.ms),this.globalData.defs.appendChild(r.of),o.setAttribute("mask","url("+getLocationHref()+"#"+r.maskId+")"))):"no"===e.ty&&(r=new SVGNoStyleData(this,e,n)),"st"!==e.ty&&"gs"!==e.ty||(o.setAttribute("stroke-linecap",lineCapEnum[e.lc||2]),o.setAttribute("stroke-linejoin",lineJoinEnum[e.lj||2]),o.setAttribute("fill-opacity","0"),1===e.lj&&o.setAttribute("stroke-miterlimit",e.ml)),2===e.r&&o.setAttribute("fill-rule","evenodd"),e.ln&&o.setAttribute("id",e.ln),e.cl&&o.setAttribute("class",e.cl),e.bm&&(o.style["mix-blend-mode"]=getBlendMode(e.bm)),this.stylesList.push(n),this.addToAnimatedContents(e,r),r},SVGShapeElement.prototype.createGroupElement=function(e){var t=new ShapeGroupData;return e.ln&&t.gr.setAttribute("id",e.ln),e.cl&&t.gr.setAttribute("class",e.cl),e.bm&&(t.gr.style["mix-blend-mode"]=getBlendMode(e.bm)),t},SVGShapeElement.prototype.createTransformElement=function(e,t){var r=TransformPropertyFactory.getTransformProperty(this,e,this),n=new SVGTransformData(r,r.o,t);return this.addToAnimatedContents(e,n),n},SVGShapeElement.prototype.createShapeElement=function(e,t,r){var n=4;"rc"===e.ty?n=5:"el"===e.ty?n=6:"sr"===e.ty&&(n=7);var o=new SVGShapeData(t,r,ShapePropertyFactory.getShapeProp(this,e,n,this));return this.shapes.push(o),this.addShapeToModifiers(o),this.addToAnimatedContents(e,o),o},SVGShapeElement.prototype.addToAnimatedContents=function(e,t){for(var r=0,n=this.animatedContents.length;r<n;){if(this.animatedContents[r].element===t)return;r+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(e),element:t,data:e})},SVGShapeElement.prototype.setElementStyles=function(e){var t,r=e.styles,n=this.stylesList.length;for(t=0;t<n;t+=1)this.stylesList[t].closed||r.push(this.stylesList[t])},SVGShapeElement.prototype.reloadShapes=function(){var e;this._isFirstFrame=!0;var t=this.itemsData.length;for(e=0;e<t;e+=1)this.prevViewData[e]=this.itemsData[e];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),t=this.dynamicProperties.length,e=0;e<t;e+=1)this.dynamicProperties[e].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(e,t,r,n,o,i,a){var s,l,c,u,d,h,p=[].concat(i),f=e.length-1,g=[],m=[];for(s=f;s>=0;s-=1){if((h=this.searchProcessedElement(e[s]))?t[s]=r[h-1]:e[s]._render=a,"fl"===e[s].ty||"st"===e[s].ty||"gf"===e[s].ty||"gs"===e[s].ty||"no"===e[s].ty)h?t[s].style.closed=!1:t[s]=this.createStyleElement(e[s],o),e[s]._render&&t[s].style.pElem.parentNode!==n&&n.appendChild(t[s].style.pElem),g.push(t[s].style);else if("gr"===e[s].ty){if(h)for(c=t[s].it.length,l=0;l<c;l+=1)t[s].prevViewData[l]=t[s].it[l];else t[s]=this.createGroupElement(e[s]);this.searchShapes(e[s].it,t[s].it,t[s].prevViewData,t[s].gr,o+1,p,a),e[s]._render&&t[s].gr.parentNode!==n&&n.appendChild(t[s].gr)}else"tr"===e[s].ty?(h||(t[s]=this.createTransformElement(e[s],n)),u=t[s].transform,p.push(u)):"sh"===e[s].ty||"rc"===e[s].ty||"el"===e[s].ty||"sr"===e[s].ty?(h||(t[s]=this.createShapeElement(e[s],p,o)),this.setElementStyles(t[s])):"tm"===e[s].ty||"rd"===e[s].ty||"ms"===e[s].ty||"pb"===e[s].ty||"zz"===e[s].ty||"op"===e[s].ty?(h?(d=t[s]).closed=!1:((d=ShapeModifiers.getModifier(e[s].ty)).init(this,e[s]),t[s]=d,this.shapeModifiers.push(d)),m.push(d)):"rp"===e[s].ty&&(h?(d=t[s]).closed=!0:(d=ShapeModifiers.getModifier(e[s].ty),t[s]=d,d.init(this,e,s,t),this.shapeModifiers.push(d),a=!1),m.push(d));this.addProcessedElement(e[s],s+1)}for(f=g.length,s=0;s<f;s+=1)g[s].closed=!0;for(f=m.length,s=0;s<f;s+=1)m[s].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){var e;this.renderModifiers();var t=this.stylesList.length;for(e=0;e<t;e+=1)this.stylesList[e].reset();for(this.renderShape(),e=0;e<t;e+=1)(this.stylesList[e]._mdf||this._isFirstFrame)&&(this.stylesList[e].msElem&&(this.stylesList[e].msElem.setAttribute("d",this.stylesList[e].d),this.stylesList[e].d="M0 0"+this.stylesList[e].d),this.stylesList[e].pElem.setAttribute("d",this.stylesList[e].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){var e,t,r=this.animatedContents.length;for(e=0;e<r;e+=1)t=this.animatedContents[e],(this._isFirstFrame||t.element._isAnimated)&&!0!==t.data&&t.fn(t.data,t.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null},LetterProps.prototype.update=function(e,t,r,n,o,i){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var a=!1;return this.o!==e&&(this.o=e,this._mdf.o=!0,a=!0),this.sw!==t&&(this.sw=t,this._mdf.sw=!0,a=!0),this.sc!==r&&(this.sc=r,this._mdf.sc=!0,a=!0),this.fc!==n&&(this.fc=n,this._mdf.fc=!0,a=!0),this.m!==o&&(this.m=o,this._mdf.m=!0,a=!0),!i.length||this.p[0]===i[0]&&this.p[1]===i[1]&&this.p[4]===i[4]&&this.p[5]===i[5]&&this.p[12]===i[12]&&this.p[13]===i[13]||(this.p=i,this._mdf.p=!0,a=!0),a},TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},TextProperty.prototype.setCurrentData=function(e){e.__complete||this.completeTextData(e),this.currentData=e,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(e){this.effectsSequence.push(e),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(e){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length||e){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var t=this.currentData,r=this.keysIndex;if(this.lock)this.setCurrentData(this.currentData);else{var n;this.lock=!0,this._mdf=!1;var o=this.effectsSequence.length,i=e||this.data.d.k[this.keysIndex].s;for(n=0;n<o;n+=1)i=r!==this.keysIndex?this.effectsSequence[n](i,i.t):this.effectsSequence[n](this.currentData,i.t);t!==i&&this.setCurrentData(i),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}}},TextProperty.prototype.getKeyframeValue=function(){for(var e=this.data.d.k,t=this.elem.comp.renderedFrame,r=0,n=e.length;r<=n-1&&!(r===n-1||e[r+1].t>t);)r+=1;return this.keysIndex!==r&&(this.keysIndex=r),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(e){for(var t,r,n=[],o=0,i=e.length,a=!1,s=!1,l="";o<i;)a=s,s=!1,t=e.charCodeAt(o),l=e.charAt(o),FontManager.isCombinedCharacter(t)?a=!0:t>=55296&&t<=56319?FontManager.isRegionalFlag(e,o)?l=e.substr(o,14):(r=e.charCodeAt(o+1))>=56320&&r<=57343&&(FontManager.isModifier(t,r)?(l=e.substr(o,2),a=!0):l=FontManager.isFlagEmoji(e.substr(o,4))?e.substr(o,4):e.substr(o,2)):t>56319?(r=e.charCodeAt(o+1),FontManager.isVariationSelector(t)&&(a=!0)):FontManager.isZeroWidthJoiner(t)&&(a=!0,s=!0),a?(n[n.length-1]+=l,a=!1):n.push(l),o+=l.length;return n},TextProperty.prototype.completeTextData=function(e){e.__complete=!0;var t,r,n,o,i,a,s,l=this.elem.globalData.fontManager,c=this.data,u=[],d=0,h=c.m.g,p=0,f=0,g=0,m=[],y=0,v=0,_=l.getFontByName(e.f),b=0,C=getFontProperties(_);e.fWeight=C.weight,e.fStyle=C.style,e.finalSize=e.s,e.finalText=this.buildFinalText(e.t),r=e.finalText.length,e.finalLineHeight=e.lh;var E,T=e.tr/1e3*e.finalSize;if(e.sz)for(var S,P,w=!0,x=e.sz[0],O=e.sz[1];w;){S=0,y=0,r=(P=this.buildFinalText(e.t)).length,T=e.tr/1e3*e.finalSize;var $=-1;for(t=0;t<r;t+=1)E=P[t].charCodeAt(0),n=!1," "===P[t]?$=t:13!==E&&3!==E||(y=0,n=!0,S+=e.finalLineHeight||1.2*e.finalSize),l.chars?(s=l.getCharData(P[t],_.fStyle,_.fFamily),b=n?0:s.w*e.finalSize/100):b=l.measureText(P[t],e.f,e.finalSize),y+b>x&&" "!==P[t]?(-1===$?r+=1:t=$,S+=e.finalLineHeight||1.2*e.finalSize,P.splice(t,$===t?1:0,"\r"),$=-1,y=0):(y+=b,y+=T);S+=_.ascent*e.finalSize/100,this.canResize&&e.finalSize>this.minimumFontSize&&O<S?(e.finalSize-=1,e.finalLineHeight=e.finalSize*e.lh/e.s):(e.finalText=P,r=e.finalText.length,w=!1)}y=-T,b=0;var I,R=0;for(t=0;t<r;t+=1)if(n=!1,13===(E=(I=e.finalText[t]).charCodeAt(0))||3===E?(R=0,m.push(y),v=y>v?y:v,y=-2*T,o="",n=!0,g+=1):o=I,l.chars?(s=l.getCharData(I,_.fStyle,l.getFontByName(e.f).fFamily),b=n?0:s.w*e.finalSize/100):b=l.measureText(o,e.f,e.finalSize)," "===I?R+=b+T:(y+=b+T+R,R=0),u.push({l:b,an:b,add:p,n:n,anIndexes:[],val:o,line:g,animatorJustifyOffset:0}),2==h){if(p+=b,""===o||" "===o||t===r-1){for(""!==o&&" "!==o||(p-=b);f<=t;)u[f].an=p,u[f].ind=d,u[f].extra=b,f+=1;d+=1,p=0}}else if(3==h){if(p+=b,""===o||t===r-1){for(""===o&&(p-=b);f<=t;)u[f].an=p,u[f].ind=d,u[f].extra=b,f+=1;p=0,d+=1}}else u[d].ind=d,u[d].extra=0,d+=1;if(e.l=u,v=y>v?y:v,m.push(y),e.sz)e.boxWidth=e.sz[0],e.justifyOffset=0;else switch(e.boxWidth=v,e.j){case 1:e.justifyOffset=-e.boxWidth;break;case 2:e.justifyOffset=-e.boxWidth/2;break;default:e.justifyOffset=0}e.lineWidths=m;var A,D,L,N,M=c.a;a=M.length;var k=[];for(i=0;i<a;i+=1){for((A=M[i]).a.sc&&(e.strokeColorAnim=!0),A.a.sw&&(e.strokeWidthAnim=!0),(A.a.fc||A.a.fh||A.a.fs||A.a.fb)&&(e.fillColorAnim=!0),N=0,L=A.s.b,t=0;t<r;t+=1)(D=u[t]).anIndexes[i]=N,(1==L&&""!==D.val||2==L&&""!==D.val&&" "!==D.val||3==L&&(D.n||" "==D.val||t==r-1)||4==L&&(D.n||t==r-1))&&(1===A.s.rn&&k.push(N),N+=1);c.a[i].s.totalChars=N;var F,j=-1;if(1===A.s.rn)for(t=0;t<r;t+=1)j!=(D=u[t]).anIndexes[i]&&(j=D.anIndexes[i],F=k.splice(Math.floor(Math.random()*k.length),1)[0]),D.anIndexes[i]=F}e.yOffset=e.finalLineHeight||1.2*e.finalSize,e.ls=e.ls||0,e.ascent=_.ascent*e.finalSize/100},TextProperty.prototype.updateDocumentData=function(e,t){t=void 0===t?this.keysIndex:t;var r=this.copyData({},this.data.d.k[t].s);r=this.copyData(r,e),this.data.d.k[t].s=r,this.recalculate(t),this.setCurrentData(r),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(e){var t=this.data.d.k[e].s;t.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(t)},TextProperty.prototype.canResizeFont=function(e){this.canResize=e,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(e){this.minimumFontSize=Math.floor(e)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var TextSelectorProp=function(){var e=Math.max,t=Math.min,r=Math.floor;function n(e,t){this._currentTextLength=-1,this.k=!1,this.data=t,this.elem=e,this.comp=e.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(e),this.s=PropertyFactory.getProp(e,t.s||{k:0},0,0,this),this.e="e"in t?PropertyFactory.getProp(e,t.e,0,0,this):{v:100},this.o=PropertyFactory.getProp(e,t.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(e,t.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(e,t.ne||{k:0},0,0,this),this.sm=PropertyFactory.getProp(e,t.sm||{k:100},0,0,this),this.a=PropertyFactory.getProp(e,t.a,0,.01,this),this.dynamicProperties.length||this.getValue()}return n.prototype={getMult:function(n){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var o=0,i=0,a=1,s=1;this.ne.v>0?o=this.ne.v/100:i=-this.ne.v/100,this.xe.v>0?a=1-this.xe.v/100:s=1+this.xe.v/100;var l=BezierFactory.getBezierEasing(o,i,a,s).get,c=0,u=this.finalS,d=this.finalE,h=this.data.sh;if(2===h)c=l(c=d===u?n>=d?1:0:e(0,t(.5/(d-u)+(n-u)/(d-u),1)));else if(3===h)c=l(c=d===u?n>=d?0:1:1-e(0,t(.5/(d-u)+(n-u)/(d-u),1)));else if(4===h)d===u?c=0:(c=e(0,t(.5/(d-u)+(n-u)/(d-u),1)))<.5?c*=2:c=1-2*(c-.5),c=l(c);else if(5===h){if(d===u)c=0;else{var p=d-u,f=-p/2+(n=t(e(0,n+.5-u),d-u)),g=p/2;c=Math.sqrt(1-f*f/(g*g))}c=l(c)}else 6===h?(d===u?c=0:(n=t(e(0,n+.5-u),d-u),c=(1+Math.cos(Math.PI+2*Math.PI*n/(d-u)))/2),c=l(c)):(n>=r(u)&&(c=e(0,t(n-u<0?t(d,1)-(u-n):d-n,1))),c=l(c));if(100!==this.sm.v){var m=.01*this.sm.v;0===m&&(m=1e-8);var y=.5-.5*m;c<y?c=0:(c=(c-y)/m)>1&&(c=1)}return c*this.a.v},getValue:function(e){this.iterateDynamicProperties(),this._mdf=e||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,e&&2===this.data.r&&(this.e.v=this._currentTextLength);var t=2===this.data.r?1:100/this.data.totalChars,r=this.o.v/t,n=this.s.v/t+r,o=this.e.v/t+r;if(n>o){var i=n;n=o,o=i}this.finalS=n,this.finalE=o}},extendPrototype([DynamicPropertyContainer],n),{getTextSelectorProp:function(e,t,r){return new n(e,t)}}}();function TextAnimatorDataProperty(e,t,r){var n={propType:!1},o=PropertyFactory.getProp,i=t.a;this.a={r:i.r?o(e,i.r,0,degToRads,r):n,rx:i.rx?o(e,i.rx,0,degToRads,r):n,ry:i.ry?o(e,i.ry,0,degToRads,r):n,sk:i.sk?o(e,i.sk,0,degToRads,r):n,sa:i.sa?o(e,i.sa,0,degToRads,r):n,s:i.s?o(e,i.s,1,.01,r):n,a:i.a?o(e,i.a,1,0,r):n,o:i.o?o(e,i.o,0,.01,r):n,p:i.p?o(e,i.p,1,0,r):n,sw:i.sw?o(e,i.sw,0,0,r):n,sc:i.sc?o(e,i.sc,1,0,r):n,fc:i.fc?o(e,i.fc,1,0,r):n,fh:i.fh?o(e,i.fh,0,0,r):n,fs:i.fs?o(e,i.fs,0,.01,r):n,fb:i.fb?o(e,i.fb,0,.01,r):n,t:i.t?o(e,i.t,0,0,r):n},this.s=TextSelectorProp.getTextSelectorProp(e,t.s,r),this.s.t=t.s.t}function TextAnimatorProperty(e,t,r){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=e,this._renderType=t,this._elem=r,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(r)}function ITextElement(){}TextAnimatorProperty.prototype.searchProperties=function(){var e,t,r=this._textData.a.length,n=PropertyFactory.getProp;for(e=0;e<r;e+=1)t=this._textData.a[e],this._animatorsData[e]=new TextAnimatorDataProperty(this._elem,t,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:n(this._elem,this._textData.p.a,0,0,this),f:n(this._elem,this._textData.p.f,0,0,this),l:n(this._elem,this._textData.p.l,0,0,this),r:n(this._elem,this._textData.p.r,0,0,this),p:n(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=n(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(e,t){if(this.lettersChangedFlag=t,this._mdf||this._isFirstFrame||t||this._hasMaskedPath&&this._pathData.m._mdf){this._isFirstFrame=!1;var r,n,o,i,a,s,l,c,u,d,h,p,f,g,m,y,v,_,b,C=this._moreOptions.alignment.v,E=this._animatorsData,T=this._textData,S=this.mHelper,P=this._renderType,w=this.renderedLetters.length,x=e.l;if(this._hasMaskedPath){if(b=this._pathData.m,!this._pathData.n||this._pathData._mdf){var O,$=b.v;for(this._pathData.r.v&&($=$.reverse()),a={tLength:0,segments:[]},i=$._length-1,y=0,o=0;o<i;o+=1)O=bez.buildBezierData($.v[o],$.v[o+1],[$.o[o][0]-$.v[o][0],$.o[o][1]-$.v[o][1]],[$.i[o+1][0]-$.v[o+1][0],$.i[o+1][1]-$.v[o+1][1]]),a.tLength+=O.segmentLength,a.segments.push(O),y+=O.segmentLength;o=i,b.v.c&&(O=bez.buildBezierData($.v[o],$.v[0],[$.o[o][0]-$.v[o][0],$.o[o][1]-$.v[o][1]],[$.i[0][0]-$.v[0][0],$.i[0][1]-$.v[0][1]]),a.tLength+=O.segmentLength,a.segments.push(O),y+=O.segmentLength),this._pathData.pi=a}if(a=this._pathData.pi,s=this._pathData.f.v,h=0,d=1,c=0,u=!0,g=a.segments,s<0&&b.v.c)for(a.tLength<Math.abs(s)&&(s=-Math.abs(s)%a.tLength),d=(f=g[h=g.length-1].points).length-1;s<0;)s+=f[d].partialLength,(d-=1)<0&&(d=(f=g[h-=1].points).length-1);p=(f=g[h].points)[d-1],m=(l=f[d]).partialLength}i=x.length,r=0,n=0;var I,R,A,D,L,N=1.2*e.finalSize*.714,M=!0;A=E.length;var k,F,j,B,W,V,H,G,U,Y,z,K,Z=-1,X=s,J=h,Q=d,q=-1,ee="",te=this.defaultPropsArray;if(2===e.j||1===e.j){var re=0,ne=0,oe=2===e.j?-.5:-1,ie=0,ae=!0;for(o=0;o<i;o+=1)if(x[o].n){for(re&&(re+=ne);ie<o;)x[ie].animatorJustifyOffset=re,ie+=1;re=0,ae=!0}else{for(R=0;R<A;R+=1)(I=E[R].a).t.propType&&(ae&&2===e.j&&(ne+=I.t.v*oe),(L=E[R].s.getMult(x[o].anIndexes[R],T.a[R].s.totalChars)).length?re+=I.t.v*L[0]*oe:re+=I.t.v*L*oe);ae=!1}for(re&&(re+=ne);ie<o;)x[ie].animatorJustifyOffset=re,ie+=1}for(o=0;o<i;o+=1){if(S.reset(),B=1,x[o].n)r=0,n+=e.yOffset,n+=M?1:0,s=X,M=!1,this._hasMaskedPath&&(d=Q,p=(f=g[h=J].points)[d-1],m=(l=f[d]).partialLength,c=0),ee="",z="",U="",K="",te=this.defaultPropsArray;else{if(this._hasMaskedPath){if(q!==x[o].line){switch(e.j){case 1:s+=y-e.lineWidths[x[o].line];break;case 2:s+=(y-e.lineWidths[x[o].line])/2}q=x[o].line}Z!==x[o].ind&&(x[Z]&&(s+=x[Z].extra),s+=x[o].an/2,Z=x[o].ind),s+=C[0]*x[o].an*.005;var se=0;for(R=0;R<A;R+=1)(I=E[R].a).p.propType&&((L=E[R].s.getMult(x[o].anIndexes[R],T.a[R].s.totalChars)).length?se+=I.p.v[0]*L[0]:se+=I.p.v[0]*L),I.a.propType&&((L=E[R].s.getMult(x[o].anIndexes[R],T.a[R].s.totalChars)).length?se+=I.a.v[0]*L[0]:se+=I.a.v[0]*L);for(u=!0,this._pathData.a.v&&(s=.5*x[0].an+(y-this._pathData.f.v-.5*x[0].an-.5*x[x.length-1].an)*Z/(i-1),s+=this._pathData.f.v);u;)c+m>=s+se||!f?(v=(s+se-c)/l.partialLength,F=p.point[0]+(l.point[0]-p.point[0])*v,j=p.point[1]+(l.point[1]-p.point[1])*v,S.translate(-C[0]*x[o].an*.005,-C[1]*N*.01),u=!1):f&&(c+=l.partialLength,(d+=1)>=f.length&&(d=0,g[h+=1]?f=g[h].points:b.v.c?(d=0,f=g[h=0].points):(c-=l.partialLength,f=null)),f&&(p=l,m=(l=f[d]).partialLength));k=x[o].an/2-x[o].add,S.translate(-k,0,0)}else k=x[o].an/2-x[o].add,S.translate(-k,0,0),S.translate(-C[0]*x[o].an*.005,-C[1]*N*.01,0);for(R=0;R<A;R+=1)(I=E[R].a).t.propType&&(L=E[R].s.getMult(x[o].anIndexes[R],T.a[R].s.totalChars),0===r&&0===e.j||(this._hasMaskedPath?L.length?s+=I.t.v*L[0]:s+=I.t.v*L:L.length?r+=I.t.v*L[0]:r+=I.t.v*L));for(e.strokeWidthAnim&&(V=e.sw||0),e.strokeColorAnim&&(W=e.sc?[e.sc[0],e.sc[1],e.sc[2]]:[0,0,0]),e.fillColorAnim&&e.fc&&(H=[e.fc[0],e.fc[1],e.fc[2]]),R=0;R<A;R+=1)(I=E[R].a).a.propType&&((L=E[R].s.getMult(x[o].anIndexes[R],T.a[R].s.totalChars)).length?S.translate(-I.a.v[0]*L[0],-I.a.v[1]*L[1],I.a.v[2]*L[2]):S.translate(-I.a.v[0]*L,-I.a.v[1]*L,I.a.v[2]*L));for(R=0;R<A;R+=1)(I=E[R].a).s.propType&&((L=E[R].s.getMult(x[o].anIndexes[R],T.a[R].s.totalChars)).length?S.scale(1+(I.s.v[0]-1)*L[0],1+(I.s.v[1]-1)*L[1],1):S.scale(1+(I.s.v[0]-1)*L,1+(I.s.v[1]-1)*L,1));for(R=0;R<A;R+=1){if(I=E[R].a,L=E[R].s.getMult(x[o].anIndexes[R],T.a[R].s.totalChars),I.sk.propType&&(L.length?S.skewFromAxis(-I.sk.v*L[0],I.sa.v*L[1]):S.skewFromAxis(-I.sk.v*L,I.sa.v*L)),I.r.propType&&(L.length?S.rotateZ(-I.r.v*L[2]):S.rotateZ(-I.r.v*L)),I.ry.propType&&(L.length?S.rotateY(I.ry.v*L[1]):S.rotateY(I.ry.v*L)),I.rx.propType&&(L.length?S.rotateX(I.rx.v*L[0]):S.rotateX(I.rx.v*L)),I.o.propType&&(L.length?B+=(I.o.v*L[0]-B)*L[0]:B+=(I.o.v*L-B)*L),e.strokeWidthAnim&&I.sw.propType&&(L.length?V+=I.sw.v*L[0]:V+=I.sw.v*L),e.strokeColorAnim&&I.sc.propType)for(G=0;G<3;G+=1)L.length?W[G]+=(I.sc.v[G]-W[G])*L[0]:W[G]+=(I.sc.v[G]-W[G])*L;if(e.fillColorAnim&&e.fc){if(I.fc.propType)for(G=0;G<3;G+=1)L.length?H[G]+=(I.fc.v[G]-H[G])*L[0]:H[G]+=(I.fc.v[G]-H[G])*L;I.fh.propType&&(H=L.length?addHueToRGB(H,I.fh.v*L[0]):addHueToRGB(H,I.fh.v*L)),I.fs.propType&&(H=L.length?addSaturationToRGB(H,I.fs.v*L[0]):addSaturationToRGB(H,I.fs.v*L)),I.fb.propType&&(H=L.length?addBrightnessToRGB(H,I.fb.v*L[0]):addBrightnessToRGB(H,I.fb.v*L))}}for(R=0;R<A;R+=1)(I=E[R].a).p.propType&&(L=E[R].s.getMult(x[o].anIndexes[R],T.a[R].s.totalChars),this._hasMaskedPath?L.length?S.translate(0,I.p.v[1]*L[0],-I.p.v[2]*L[1]):S.translate(0,I.p.v[1]*L,-I.p.v[2]*L):L.length?S.translate(I.p.v[0]*L[0],I.p.v[1]*L[1],-I.p.v[2]*L[2]):S.translate(I.p.v[0]*L,I.p.v[1]*L,-I.p.v[2]*L));if(e.strokeWidthAnim&&(U=V<0?0:V),e.strokeColorAnim&&(Y="rgb("+Math.round(255*W[0])+","+Math.round(255*W[1])+","+Math.round(255*W[2])+")"),e.fillColorAnim&&e.fc&&(z="rgb("+Math.round(255*H[0])+","+Math.round(255*H[1])+","+Math.round(255*H[2])+")"),this._hasMaskedPath){if(S.translate(0,-e.ls),S.translate(0,C[1]*N*.01+n,0),this._pathData.p.v){_=(l.point[1]-p.point[1])/(l.point[0]-p.point[0]);var le=180*Math.atan(_)/Math.PI;l.point[0]<p.point[0]&&(le+=180),S.rotate(-le*Math.PI/180)}S.translate(F,j,0),s-=C[0]*x[o].an*.005,x[o+1]&&Z!==x[o+1].ind&&(s+=x[o].an/2,s+=.001*e.tr*e.finalSize)}else{switch(S.translate(r,n,0),e.ps&&S.translate(e.ps[0],e.ps[1]+e.ascent,0),e.j){case 1:S.translate(x[o].animatorJustifyOffset+e.justifyOffset+(e.boxWidth-e.lineWidths[x[o].line]),0,0);break;case 2:S.translate(x[o].animatorJustifyOffset+e.justifyOffset+(e.boxWidth-e.lineWidths[x[o].line])/2,0,0)}S.translate(0,-e.ls),S.translate(k,0,0),S.translate(C[0]*x[o].an*.005,C[1]*N*.01,0),r+=x[o].l+.001*e.tr*e.finalSize}"html"===P?ee=S.toCSS():"svg"===P?ee=S.to2dCSS():te=[S.props[0],S.props[1],S.props[2],S.props[3],S.props[4],S.props[5],S.props[6],S.props[7],S.props[8],S.props[9],S.props[10],S.props[11],S.props[12],S.props[13],S.props[14],S.props[15]],K=B}w<=o?(D=new LetterProps(K,U,Y,z,ee,te),this.renderedLetters.push(D),w+=1,this.lettersChangedFlag=!0):(D=this.renderedLetters[o],this.lettersChangedFlag=D.update(K,U,Y,z,ee,te)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty),ITextElement.prototype.initElement=function(e,t,r){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(e,t,r),this.textProperty=new TextProperty(this,e.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(e.t,this.renderType,this),this.initTransform(e,t,r),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(e){this._mdf=!1,this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange)},ITextElement.prototype.createPathShape=function(e,t){var r,n,o=t.length,i="";for(r=0;r<o;r+=1)"sh"===t[r].ty&&(n=t[r].ks.k,i+=buildShapeString(n,n.i.length,!0,e));return i},ITextElement.prototype.updateDocumentData=function(e,t){this.textProperty.updateDocumentData(e,t)},ITextElement.prototype.canResizeFont=function(e){this.textProperty.canResizeFont(e)},ITextElement.prototype.setMinimumFontSize=function(e){this.textProperty.setMinimumFontSize(e)},ITextElement.prototype.applyTextPropertiesToMatrix=function(e,t,r,n,o){switch(e.ps&&t.translate(e.ps[0],e.ps[1]+e.ascent,0),t.translate(0,-e.ls,0),e.j){case 1:t.translate(e.justifyOffset+(e.boxWidth-e.lineWidths[r]),0,0);break;case 2:t.translate(e.justifyOffset+(e.boxWidth-e.lineWidths[r])/2,0,0)}t.translate(n,o,0)},ITextElement.prototype.buildColor=function(e){return"rgb("+Math.round(255*e[0])+","+Math.round(255*e[1])+","+Math.round(255*e[2])+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){},ITextElement.prototype.validateText=function(){(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)};var emptyShapeData={shapes:[]};function SVGTextLottieElement(e,t,r){this.textSpans=[],this.renderType="svg",this.initElement(e,t,r)}function ISolidElement(e,t,r){this.initElement(e,t,r)}function NullElement(e,t,r){this.initFrame(),this.initBaseData(e,t,r),this.initFrame(),this.initTransform(e,t,r),this.initHierarchy()}function SVGRendererBase(){}function ICompElement(){}function SVGCompElement(e,t,r){this.layers=e.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(e,t,r),this.tm=e.tm?PropertyFactory.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0}}function SVGRenderer(e,t){this.animationItem=e,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var r="";if(t&&t.title){var n=createNS("title"),o=createElementID();n.setAttribute("id",o),n.textContent=t.title,this.svgElement.appendChild(n),r+=o}if(t&&t.description){var i=createNS("desc"),a=createElementID();i.setAttribute("id",a),i.textContent=t.description,this.svgElement.appendChild(i),r+=" "+a}r&&this.svgElement.setAttribute("aria-labelledby",r);var s=createNS("defs");this.svgElement.appendChild(s);var l=createNS("g");this.svgElement.appendChild(l),this.layerElement=l,this.renderConfig={preserveAspectRatio:t&&t.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:t&&t.contentVisibility||"visible",progressiveLoad:t&&t.progressiveLoad||!1,hideOnTransparent:!(t&&!1===t.hideOnTransparent),viewBoxOnly:t&&t.viewBoxOnly||!1,viewBoxSize:t&&t.viewBoxSize||!1,className:t&&t.className||"",id:t&&t.id||"",focusable:t&&t.focusable,filterSize:{width:t&&t.filterSize&&t.filterSize.width||"100%",height:t&&t.filterSize&&t.filterSize.height||"100%",x:t&&t.filterSize&&t.filterSize.x||"0%",y:t&&t.filterSize&&t.filterSize.y||"0%"},width:t&&t.width,height:t&&t.height,runExpressions:!t||void 0===t.runExpressions||t.runExpressions},this.globalData={_mdf:!1,frameNum:-1,defs:s,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextLottieElement.prototype.buildTextContents=function(e){for(var t=0,r=e.length,n=[],o="";t<r;)e[t]===String.fromCharCode(13)||e[t]===String.fromCharCode(3)?(n.push(o),o=""):o+=e[t],t+=1;return n.push(o),n},SVGTextLottieElement.prototype.buildShapeData=function(e,t){if(e.shapes&&e.shapes.length){var r=e.shapes[0];if(r.it){var n=r.it[r.it.length-1];n.s&&(n.s.k[0]=t,n.s.k[1]=t)}}return e},SVGTextLottieElement.prototype.buildNewText=function(){var e,t;this.addDynamicProperty(this);var r=this.textProperty.currentData;this.renderedLetters=createSizedArray(r?r.l.length:0),r.fc?this.layerElement.setAttribute("fill",this.buildColor(r.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),r.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(r.sc)),this.layerElement.setAttribute("stroke-width",r.sw)),this.layerElement.setAttribute("font-size",r.finalSize);var n=this.globalData.fontManager.getFontByName(r.f);if(n.fClass)this.layerElement.setAttribute("class",n.fClass);else{this.layerElement.setAttribute("font-family",n.fFamily);var o=r.fWeight,i=r.fStyle;this.layerElement.setAttribute("font-style",i),this.layerElement.setAttribute("font-weight",o)}this.layerElement.setAttribute("aria-label",r.t);var a,s=r.l||[],l=!!this.globalData.fontManager.chars;t=s.length;var c=this.mHelper,u=this.data.singleShape,d=0,h=0,p=!0,f=.001*r.tr*r.finalSize;if(!u||l||r.sz){var g,m=this.textSpans.length;for(e=0;e<t;e+=1){if(this.textSpans[e]||(this.textSpans[e]={span:null,childSpan:null,glyph:null}),!l||!u||0===e){if(a=m>e?this.textSpans[e].span:createNS(l?"g":"text"),m<=e){if(a.setAttribute("stroke-linecap","butt"),a.setAttribute("stroke-linejoin","round"),a.setAttribute("stroke-miterlimit","4"),this.textSpans[e].span=a,l){var y=createNS("g");a.appendChild(y),this.textSpans[e].childSpan=y}this.textSpans[e].span=a,this.layerElement.appendChild(a)}a.style.display="inherit"}if(c.reset(),u&&(s[e].n&&(d=-f,h+=r.yOffset,h+=p?1:0,p=!1),this.applyTextPropertiesToMatrix(r,c,s[e].line,d,h),d+=s[e].l||0,d+=f),l){var v;if(1===(g=this.globalData.fontManager.getCharData(r.finalText[e],n.fStyle,this.globalData.fontManager.getFontByName(r.f).fFamily)).t)v=new SVGCompElement(g.data,this.globalData,this);else{var _=emptyShapeData;g.data&&g.data.shapes&&(_=this.buildShapeData(g.data,r.finalSize)),v=new SVGShapeElement(_,this.globalData,this)}if(this.textSpans[e].glyph){var b=this.textSpans[e].glyph;this.textSpans[e].childSpan.removeChild(b.layerElement),b.destroy()}this.textSpans[e].glyph=v,v._debug=!0,v.prepareFrame(0),v.renderFrame(),this.textSpans[e].childSpan.appendChild(v.layerElement),1===g.t&&this.textSpans[e].childSpan.setAttribute("transform","scale("+r.finalSize/100+","+r.finalSize/100+")")}else u&&a.setAttribute("transform","translate("+c.props[12]+","+c.props[13]+")"),a.textContent=s[e].val,a.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve")}u&&a&&a.setAttribute("d","")}else{var C=this.textContainer,E="start";switch(r.j){case 1:E="end";break;case 2:E="middle";break;default:E="start"}C.setAttribute("text-anchor",E),C.setAttribute("letter-spacing",f);var T=this.buildTextContents(r.finalText);for(t=T.length,h=r.ps?r.ps[1]+r.ascent:0,e=0;e<t;e+=1)(a=this.textSpans[e].span||createNS("tspan")).textContent=T[e],a.setAttribute("x",0),a.setAttribute("y",h),a.style.display="inherit",C.appendChild(a),this.textSpans[e]||(this.textSpans[e]={span:null,glyph:null}),this.textSpans[e].span=a,h+=r.finalLineHeight;this.layerElement.appendChild(C)}for(;e<this.textSpans.length;)this.textSpans[e].span.style.display="none",e+=1;this._sizeChanged=!0},SVGTextLottieElement.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var e=this.layerElement.getBBox();this.bbox={top:e.y,left:e.x,width:e.width,height:e.height}}return this.bbox},SVGTextLottieElement.prototype.getValue=function(){var e,t,r=this.textSpans.length;for(this.renderedFrame=this.comp.renderedFrame,e=0;e<r;e+=1)(t=this.textSpans[e].glyph)&&(t.prepareFrame(this.comp.renderedFrame-this.data.st),t._mdf&&(this._mdf=!0))},SVGTextLottieElement.prototype.renderInnerContent=function(){if(this.validateText(),(!this.data.singleShape||this._mdf)&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){var e,t;this._sizeChanged=!0;var r,n,o,i=this.textAnimator.renderedLetters,a=this.textProperty.currentData.l;for(t=a.length,e=0;e<t;e+=1)a[e].n||(r=i[e],n=this.textSpans[e].span,(o=this.textSpans[e].glyph)&&o.renderFrame(),r._mdf.m&&n.setAttribute("transform",r.m),r._mdf.o&&n.setAttribute("opacity",r.o),r._mdf.sw&&n.setAttribute("stroke-width",r.sw),r._mdf.sc&&n.setAttribute("stroke",r.sc),r._mdf.fc&&n.setAttribute("fill",r.fc))}},extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var e=createNS("rect");e.setAttribute("width",this.data.sw),e.setAttribute("height",this.data.sh),e.setAttribute("fill",this.data.sc),this.layerElement.appendChild(e)},NullElement.prototype.prepareFrame=function(e){this.prepareProperties(e,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement),extendPrototype([BaseRenderer],SVGRendererBase),SVGRendererBase.prototype.createNull=function(e){return new NullElement(e,this.globalData,this)},SVGRendererBase.prototype.createShape=function(e){return new SVGShapeElement(e,this.globalData,this)},SVGRendererBase.prototype.createText=function(e){return new SVGTextLottieElement(e,this.globalData,this)},SVGRendererBase.prototype.createImage=function(e){return new IImageElement(e,this.globalData,this)},SVGRendererBase.prototype.createSolid=function(e){return new ISolidElement(e,this.globalData,this)},SVGRendererBase.prototype.configAnimation=function(e){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.svgElement.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+e.w+" "+e.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",e.w),this.svgElement.setAttribute("height",e.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.width&&this.svgElement.setAttribute("width",this.renderConfig.width),this.renderConfig.height&&this.svgElement.setAttribute("height",this.renderConfig.height),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),void 0!==this.renderConfig.focusable&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var t=this.globalData.defs;this.setupGlobalData(e,t),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=e;var r=createNS("clipPath"),n=createNS("rect");n.setAttribute("width",e.w),n.setAttribute("height",e.h),n.setAttribute("x",0),n.setAttribute("y",0);var o=createElementID();r.setAttribute("id",o),r.appendChild(n),this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+o+")"),t.appendChild(r),this.layers=e.layers,this.elements=createSizedArray(e.layers.length)},SVGRendererBase.prototype.destroy=function(){var e;this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var t=this.layers?this.layers.length:0;for(e=0;e<t;e+=1)this.elements[e]&&this.elements[e].destroy&&this.elements[e].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRendererBase.prototype.updateContainerSize=function(){},SVGRendererBase.prototype.findIndexByInd=function(e){var t=0,r=this.layers.length;for(t=0;t<r;t+=1)if(this.layers[t].ind===e)return t;return-1},SVGRendererBase.prototype.buildItem=function(e){var t=this.elements;if(!t[e]&&99!==this.layers[e].ty){t[e]=!0;var r=this.createItem(this.layers[e]);if(t[e]=r,getExpressionsPlugin()&&(0===this.layers[e].ty&&this.globalData.projectInterface.registerComposition(r),r.initExpressions()),this.appendElementInPos(r,e),this.layers[e].tt){var n="tp"in this.layers[e]?this.findIndexByInd(this.layers[e].tp):e-1;if(-1===n)return;if(this.elements[n]&&!0!==this.elements[n]){var o=t[n].getMatte(this.layers[e].tt);r.setMatte(o)}else this.buildItem(n),this.addPendingElement(r)}}},SVGRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var e=this.pendingElements.pop();if(e.checkParenting(),e.data.tt)for(var t=0,r=this.elements.length;t<r;){if(this.elements[t]===e){var n="tp"in e.data?this.findIndexByInd(e.data.tp):t-1,o=this.elements[n].getMatte(this.layers[t].tt);e.setMatte(o);break}t+=1}}},SVGRendererBase.prototype.renderFrame=function(e){if(this.renderedFrame!==e&&!this.destroyed){var t;null===e?e=this.renderedFrame:this.renderedFrame=e,this.globalData.frameNum=e,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=e,this.globalData._mdf=!1;var r=this.layers.length;for(this.completeLayers||this.checkLayers(e),t=r-1;t>=0;t-=1)(this.completeLayers||this.elements[t])&&this.elements[t].prepareFrame(e-this.layers[t].st);if(this.globalData._mdf)for(t=0;t<r;t+=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()}},SVGRendererBase.prototype.appendElementInPos=function(e,t){var r=e.getBaseElement();if(r){for(var n,o=0;o<t;)this.elements[o]&&!0!==this.elements[o]&&this.elements[o].getBaseElement()&&(n=this.elements[o].getBaseElement()),o+=1;n?this.layerElement.insertBefore(r,n):this.layerElement.appendChild(r)}},SVGRendererBase.prototype.hide=function(){this.layerElement.style.display="none"},SVGRendererBase.prototype.show=function(){this.layerElement.style.display="block"},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(e,t,r){this.initFrame(),this.initBaseData(e,t,r),this.initTransform(e,t,r),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),!this.data.xt&&t.progressiveLoad||this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(e){if(this._mdf=!1,this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange),this.isInRange||this.data.xt){if(this.tm._placeholder)this.renderedFrame=e/this.data.sr;else{var t=this.tm.v;t===this.data.op&&(t=this.data.op-1),this.renderedFrame=t}var r,n=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),r=n-1;r>=0;r-=1)(this.completeLayers||this.elements[r])&&(this.elements[r].prepareFrame(this.renderedFrame-this.layers[r].st),this.elements[r]._mdf&&(this._mdf=!0))}},ICompElement.prototype.renderInnerContent=function(){var e,t=this.layers.length;for(e=0;e<t;e+=1)(this.completeLayers||this.elements[e])&&this.elements[e].renderFrame()},ICompElement.prototype.setElements=function(e){this.elements=e},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){var e,t=this.layers.length;for(e=0;e<t;e+=1)this.elements[e]&&this.elements[e].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()},extendPrototype([SVGRendererBase,ICompElement,SVGBaseElement],SVGCompElement),SVGCompElement.prototype.createComp=function(e){return new SVGCompElement(e,this.globalData,this)},extendPrototype([SVGRendererBase],SVGRenderer),SVGRenderer.prototype.createComp=function(e){return new SVGCompElement(e,this.globalData,this)},ShapeTransformManager.prototype={addTransformSequence:function(e){var t,r=e.length,n="_";for(t=0;t<r;t+=1)n+=e[t].transform.key+"_";var o=this.sequences[n];return o||(o={transforms:[].concat(e),finalTransform:new Matrix,_mdf:!1},this.sequences[n]=o,this.sequenceList.push(o)),o},processSequence:function(e,t){for(var r=0,n=e.transforms.length,o=t;r<n&&!t;){if(e.transforms[r].transform.mProps._mdf){o=!0;break}r+=1}if(o)for(e.finalTransform.reset(),r=n-1;r>=0;r-=1)e.finalTransform.multiply(e.transforms[r].transform.mProps.v);e._mdf=o},processSequences:function(e){var t,r=this.sequenceList.length;for(t=0;t<r;t+=1)this.processSequence(this.sequenceList[t],e)},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count}};var lumaLoader=function(){var e="__lottie_element_luma_buffer",t=null,r=null,n=null;function o(){var o,i,a;t||(o=createNS("svg"),i=createNS("filter"),a=createNS("feColorMatrix"),i.setAttribute("id",e),a.setAttribute("type","matrix"),a.setAttribute("color-interpolation-filters","sRGB"),a.setAttribute("values","0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0"),i.appendChild(a),o.appendChild(i),o.setAttribute("id",e+"_svg"),featureSupport.svgLumaHidden&&(o.style.display="none"),n=o,document.body.appendChild(n),t=createTag("canvas"),(r=t.getContext("2d")).filter="url(#"+e+")",r.fillStyle="rgba(0,0,0,0)",r.fillRect(0,0,1,1))}return{load:o,get:function(n){return t||o(),t.width=n.width,t.height=n.height,r.filter="url(#"+e+")",t}}};function createCanvas(e,t){if(featureSupport.offscreenCanvas)return new OffscreenCanvas(e,t);var r=createTag("canvas");return r.width=e,r.height=t,r}var assetLoader={loadLumaCanvas:lumaLoader.load,getLumaCanvas:lumaLoader.get,createCanvas:createCanvas},registeredEffects={};function CVEffects(e){var t,r,n=e.data.ef?e.data.ef.length:0;for(this.filters=[],t=0;t<n;t+=1){r=null;var o=e.data.ef[t].ty;registeredEffects[o]&&(r=new(0,registeredEffects[o].effect)(e.effectsManager.effectElements[t],e)),r&&this.filters.push(r)}this.filters.length&&e.addRenderableComponent(this)}function registerEffect(e,t){registeredEffects[e]={effect:t}}function CVMaskElement(e,t){var r;this.data=e,this.element=t,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);var n=this.masksProperties.length,o=!1;for(r=0;r<n;r+=1)"n"!==this.masksProperties[r].mode&&(o=!0),this.viewData[r]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[r],3);this.hasMasks=o,o&&this.element.addRenderableComponent(this)}function CVBaseElement(){}CVEffects.prototype.renderFrame=function(e){var t,r=this.filters.length;for(t=0;t<r;t+=1)this.filters[t].renderFrame(e)},CVEffects.prototype.getEffects=function(e){var t,r=this.filters.length,n=[];for(t=0;t<r;t+=1)this.filters[t].type===e&&n.push(this.filters[t]);return n},CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var e,t,r,n,o=this.element.finalTransform.mat,i=this.element.canvasContext,a=this.masksProperties.length;for(i.beginPath(),e=0;e<a;e+=1)if("n"!==this.masksProperties[e].mode){var s;this.masksProperties[e].inv&&(i.moveTo(0,0),i.lineTo(this.element.globalData.compSize.w,0),i.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),i.lineTo(0,this.element.globalData.compSize.h),i.lineTo(0,0)),n=this.viewData[e].v,t=o.applyToPointArray(n.v[0][0],n.v[0][1],0),i.moveTo(t[0],t[1]);var l=n._length;for(s=1;s<l;s+=1)r=o.applyToTriplePoints(n.o[s-1],n.i[s],n.v[s]),i.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]);r=o.applyToTriplePoints(n.o[s-1],n.i[0],n.v[0]),i.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5])}this.element.globalData.renderer.save(!0),i.clip()}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null};var operationsMap={1:"source-in",2:"source-out",3:"source-in",4:"source-out"};function CVShapeData(e,t,r,n){this.styledShapes=[],this.tr=[0,0,0,0,0,0];var o,i=4;"rc"===t.ty?i=5:"el"===t.ty?i=6:"sr"===t.ty&&(i=7),this.sh=ShapePropertyFactory.getShapeProp(e,t,i,e);var a,s=r.length;for(o=0;o<s;o+=1)r[o].closed||(a={transforms:n.addTransformSequence(r[o].transforms),trNodes:[]},this.styledShapes.push(a),r[o].elements.push(a))}function CVShapeElement(e,t,r){this.shapes=[],this.shapesData=e.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager,this.initElement(e,t,r)}function CVTextElement(e,t,r){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(e,t,r)}function CVImageElement(e,t,r){this.assetData=t.getAssetData(e.refId),this.img=t.imageLoader.getAsset(this.assetData),this.initElement(e,t,r)}function CVSolidElement(e,t,r){this.initElement(e,t,r)}function CanvasRendererBase(){}function CanvasContext(){this.opacity=-1,this.transform=createTypedArray("float32",16),this.fillStyle="",this.strokeStyle="",this.lineWidth="",this.lineCap="",this.lineJoin="",this.miterLimit="",this.id=Math.random()}function CVContextData(){var e;for(this.stack=[],this.cArrPos=0,this.cTr=new Matrix,e=0;e<15;e+=1){var t=new CanvasContext;this.stack[e]=t}this._length=15,this.nativeContext=null,this.transformMat=new Matrix,this.currentOpacity=1,this.currentFillStyle="",this.appliedFillStyle="",this.currentStrokeStyle="",this.appliedStrokeStyle="",this.currentLineWidth="",this.appliedLineWidth="",this.currentLineCap="",this.appliedLineCap="",this.currentLineJoin="",this.appliedLineJoin="",this.appliedMiterLimit="",this.currentMiterLimit=""}function CVCompElement(e,t,r){this.completeLayers=!1,this.layers=e.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(e,t,r),this.tm=e.tm?PropertyFactory.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0}}function CanvasRenderer(e,t){this.animationItem=e,this.renderConfig={clearCanvas:!t||void 0===t.clearCanvas||t.clearCanvas,context:t&&t.context||null,progressiveLoad:t&&t.progressiveLoad||!1,preserveAspectRatio:t&&t.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:t&&t.contentVisibility||"visible",className:t&&t.className||"",id:t&&t.id||"",runExpressions:!t||void 0===t.runExpressions||t.runExpressions},this.renderConfig.dpr=t&&t.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=t&&t.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas",this.renderConfig.clearCanvas&&(this.ctxTransform=this.contextData.transform.bind(this.contextData),this.ctxOpacity=this.contextData.opacity.bind(this.contextData),this.ctxFillStyle=this.contextData.fillStyle.bind(this.contextData),this.ctxStrokeStyle=this.contextData.strokeStyle.bind(this.contextData),this.ctxLineWidth=this.contextData.lineWidth.bind(this.contextData),this.ctxLineCap=this.contextData.lineCap.bind(this.contextData),this.ctxLineJoin=this.contextData.lineJoin.bind(this.contextData),this.ctxMiterLimit=this.contextData.miterLimit.bind(this.contextData),this.ctxFill=this.contextData.fill.bind(this.contextData),this.ctxFillRect=this.contextData.fillRect.bind(this.contextData),this.ctxStroke=this.contextData.stroke.bind(this.contextData),this.save=this.contextData.save.bind(this.contextData))}function HBaseElement(){}function HSolidElement(e,t,r){this.initElement(e,t,r)}function HShapeElement(e,t,r){this.shapes=[],this.shapesData=e.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.shapesContainer=createNS("g"),this.initElement(e,t,r),this.prevViewData=[],this.currentBBox={x:999999,y:-999999,h:0,w:0}}function HTextElement(e,t,r){this.textSpans=[],this.textPaths=[],this.currentBBox={x:999999,y:-999999,h:0,w:0},this.renderType="svg",this.isMasked=!1,this.initElement(e,t,r)}function HCameraElement(e,t,r){this.initFrame(),this.initBaseData(e,t,r),this.initHierarchy();var n=PropertyFactory.getProp;if(this.pe=n(this,e.pe,0,0,this),e.ks.p.s?(this.px=n(this,e.ks.p.x,1,0,this),this.py=n(this,e.ks.p.y,1,0,this),this.pz=n(this,e.ks.p.z,1,0,this)):this.p=n(this,e.ks.p,1,0,this),e.ks.a&&(this.a=n(this,e.ks.a,1,0,this)),e.ks.or.k.length&&e.ks.or.k[0].to){var o,i=e.ks.or.k.length;for(o=0;o<i;o+=1)e.ks.or.k[o].to=null,e.ks.or.k[o].ti=null}this.or=n(this,e.ks.or,1,degToRads,this),this.or.sh=!0,this.rx=n(this,e.ks.rx,0,degToRads,this),this.ry=n(this,e.ks.ry,0,degToRads,this),this.rz=n(this,e.ks.rz,0,degToRads,this),this.mat=new Matrix,this._prevMat=new Matrix,this._isFirstFrame=!0,this.finalTransform={mProp:this}}function HImageElement(e,t,r){this.assetData=t.getAssetData(e.refId),this.initElement(e,t,r)}function HybridRendererBase(e,t){this.animationItem=e,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:t&&t.className||"",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(t&&!1===t.hideOnTransparent),filterSize:{width:t&&t.filterSize&&t.filterSize.width||"400%",height:t&&t.filterSize&&t.filterSize.height||"400%",x:t&&t.filterSize&&t.filterSize.x||"-100%",y:t&&t.filterSize&&t.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}function HCompElement(e,t,r){this.layers=e.layers,this.supports3d=!e.hasMask,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(e,t,r),this.tm=e.tm?PropertyFactory.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0}}function HybridRenderer(e,t){this.animationItem=e,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:t&&t.className||"",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(t&&!1===t.hideOnTransparent),filterSize:{width:t&&t.filterSize&&t.filterSize.width||"400%",height:t&&t.filterSize&&t.filterSize.height||"400%",x:t&&t.filterSize&&t.filterSize.x||"-100%",y:t&&t.filterSize&&t.filterSize.y||"-100%"},runExpressions:!t||void 0===t.runExpressions||t.runExpressions},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){if(this.data.tt>=1){this.buffers=[];var e=this.globalData.canvasContext,t=assetLoader.createCanvas(e.canvas.width,e.canvas.height);this.buffers.push(t);var r=assetLoader.createCanvas(e.canvas.width,e.canvas.height);this.buffers.push(r),this.data.tt>=3&&!document._isProxy&&assetLoader.loadLumaCanvas()}this.canvasContext=this.globalData.canvasContext,this.transformCanvas=this.globalData.transformCanvas,this.renderableEffectsManager=new CVEffects(this),this.searchEffectTransforms()},createContent:function(){},setBlendMode:function(){var e=this.globalData;if(e.blendMode!==this.data.bm){e.blendMode=this.data.bm;var t=getBlendMode(this.data.bm);e.canvasContext.globalCompositeOperation=t}},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this),this.transformEffects=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT)},hideElement:function(){this.hidden||this.isInRange&&!this.isTransparent||(this.hidden=!0)},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0)},clearCanvas:function(e){e.clearRect(this.transformCanvas.tx,this.transformCanvas.ty,this.transformCanvas.w*this.transformCanvas.sx,this.transformCanvas.h*this.transformCanvas.sy)},prepareLayer:function(){if(this.data.tt>=1){var e=this.buffers[0].getContext("2d");this.clearCanvas(e),e.drawImage(this.canvasContext.canvas,0,0),this.currentTransform=this.canvasContext.getTransform(),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform)}},exitLayer:function(){if(this.data.tt>=1){var e=this.buffers[1],t=e.getContext("2d");if(this.clearCanvas(t),t.drawImage(this.canvasContext.canvas,0,0),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform),this.comp.getElementById("tp"in this.data?this.data.tp:this.data.ind-1).renderFrame(!0),this.canvasContext.setTransform(1,0,0,1,0,0),this.data.tt>=3&&!document._isProxy){var r=assetLoader.getLumaCanvas(this.canvasContext.canvas);r.getContext("2d").drawImage(this.canvasContext.canvas,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.drawImage(r,0,0)}this.canvasContext.globalCompositeOperation=operationsMap[this.data.tt],this.canvasContext.drawImage(e,0,0),this.canvasContext.globalCompositeOperation="destination-over",this.canvasContext.drawImage(this.buffers[0],0,0),this.canvasContext.setTransform(this.currentTransform),this.canvasContext.globalCompositeOperation="source-over"}},renderFrame:function(e){if(!this.hidden&&!this.data.hd&&(1!==this.data.td||e)){this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.setBlendMode();var t=0===this.data.ty;this.prepareLayer(),this.globalData.renderer.save(t),this.globalData.renderer.ctxTransform(this.finalTransform.localMat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.localOpacity),this.renderInnerContent(),this.globalData.renderer.restore(t),this.exitLayer(),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame&&(this._isFirstFrame=!1)}},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy()},mHelper:new Matrix},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement,CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated,extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[])},CVShapeElement.prototype.createStyleElement=function(e,t){var r={data:e,type:e.ty,preTransforms:this.transformsManager.addTransformSequence(t),transforms:[],elements:[],closed:!0===e.hd},n={};if("fl"===e.ty||"st"===e.ty?(n.c=PropertyFactory.getProp(this,e.c,1,255,this),n.c.k||(r.co="rgb("+bmFloor(n.c.v[0])+","+bmFloor(n.c.v[1])+","+bmFloor(n.c.v[2])+")")):"gf"!==e.ty&&"gs"!==e.ty||(n.s=PropertyFactory.getProp(this,e.s,1,null,this),n.e=PropertyFactory.getProp(this,e.e,1,null,this),n.h=PropertyFactory.getProp(this,e.h||{k:0},0,.01,this),n.a=PropertyFactory.getProp(this,e.a||{k:0},0,degToRads,this),n.g=new GradientProperty(this,e.g,this)),n.o=PropertyFactory.getProp(this,e.o,0,.01,this),"st"===e.ty||"gs"===e.ty){if(r.lc=lineCapEnum[e.lc||2],r.lj=lineJoinEnum[e.lj||2],1==e.lj&&(r.ml=e.ml),n.w=PropertyFactory.getProp(this,e.w,0,null,this),n.w.k||(r.wi=n.w.v),e.d){var o=new DashProperty(this,e.d,"canvas",this);n.d=o,n.d.k||(r.da=n.d.dashArray,r.do=n.d.dashoffset[0])}}else r.r=2===e.r?"evenodd":"nonzero";return this.stylesList.push(r),n.style=r,n},CVShapeElement.prototype.createGroupElement=function(){return{it:[],prevViewData:[]}},CVShapeElement.prototype.createTransformElement=function(e){return{transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,e.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,e,this)}}},CVShapeElement.prototype.createShapeElement=function(e){var t=new CVShapeData(this,e,this.stylesList,this.transformsManager);return this.shapes.push(t),this.addShapeToModifiers(t),t},CVShapeElement.prototype.reloadShapes=function(){var e;this._isFirstFrame=!0;var t=this.itemsData.length;for(e=0;e<t;e+=1)this.prevViewData[e]=this.itemsData[e];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),t=this.dynamicProperties.length,e=0;e<t;e+=1)this.dynamicProperties[e].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame)},CVShapeElement.prototype.addTransformToStyleList=function(e){var t,r=this.stylesList.length;for(t=0;t<r;t+=1)this.stylesList[t].closed||this.stylesList[t].transforms.push(e)},CVShapeElement.prototype.removeTransformFromStyleList=function(){var e,t=this.stylesList.length;for(e=0;e<t;e+=1)this.stylesList[e].closed||this.stylesList[e].transforms.pop()},CVShapeElement.prototype.closeStyles=function(e){var t,r=e.length;for(t=0;t<r;t+=1)e[t].closed=!0},CVShapeElement.prototype.searchShapes=function(e,t,r,n,o){var i,a,s,l,c,u,d=e.length-1,h=[],p=[],f=[].concat(o);for(i=d;i>=0;i-=1){if((l=this.searchProcessedElement(e[i]))?t[i]=r[l-1]:e[i]._shouldRender=n,"fl"===e[i].ty||"st"===e[i].ty||"gf"===e[i].ty||"gs"===e[i].ty)l?t[i].style.closed=!1:t[i]=this.createStyleElement(e[i],f),h.push(t[i].style);else if("gr"===e[i].ty){if(l)for(s=t[i].it.length,a=0;a<s;a+=1)t[i].prevViewData[a]=t[i].it[a];else t[i]=this.createGroupElement(e[i]);this.searchShapes(e[i].it,t[i].it,t[i].prevViewData,n,f)}else"tr"===e[i].ty?(l||(u=this.createTransformElement(e[i]),t[i]=u),f.push(t[i]),this.addTransformToStyleList(t[i])):"sh"===e[i].ty||"rc"===e[i].ty||"el"===e[i].ty||"sr"===e[i].ty?l||(t[i]=this.createShapeElement(e[i])):"tm"===e[i].ty||"rd"===e[i].ty||"pb"===e[i].ty||"zz"===e[i].ty||"op"===e[i].ty?(l?(c=t[i]).closed=!1:((c=ShapeModifiers.getModifier(e[i].ty)).init(this,e[i]),t[i]=c,this.shapeModifiers.push(c)),p.push(c)):"rp"===e[i].ty&&(l?(c=t[i]).closed=!0:(c=ShapeModifiers.getModifier(e[i].ty),t[i]=c,c.init(this,e,i,t),this.shapeModifiers.push(c),n=!1),p.push(c));this.addProcessedElement(e[i],i+1)}for(this.removeTransformFromStyleList(),this.closeStyles(h),d=p.length,i=0;i<d;i+=1)p[i].closed=!0},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0)},CVShapeElement.prototype.renderShapeTransform=function(e,t){(e._opMdf||t.op._mdf||this._isFirstFrame)&&(t.opacity=e.opacity,t.opacity*=t.op.v,t._opMdf=!0)},CVShapeElement.prototype.drawLayer=function(){var e,t,r,n,o,i,a,s,l,c=this.stylesList.length,u=this.globalData.renderer,d=this.globalData.canvasContext;for(e=0;e<c;e+=1)if(("st"!==(s=(l=this.stylesList[e]).type)&&"gs"!==s||0!==l.wi)&&l.data._shouldRender&&0!==l.coOp&&0!==this.globalData.currentGlobalAlpha){for(u.save(),i=l.elements,"st"===s||"gs"===s?(u.ctxStrokeStyle("st"===s?l.co:l.grd),u.ctxLineWidth(l.wi),u.ctxLineCap(l.lc),u.ctxLineJoin(l.lj),u.ctxMiterLimit(l.ml||0)):u.ctxFillStyle("fl"===s?l.co:l.grd),u.ctxOpacity(l.coOp),"st"!==s&&"gs"!==s&&d.beginPath(),u.ctxTransform(l.preTransforms.finalTransform.props),r=i.length,t=0;t<r;t+=1){for("st"!==s&&"gs"!==s||(d.beginPath(),l.da&&(d.setLineDash(l.da),d.lineDashOffset=l.do)),o=(a=i[t].trNodes).length,n=0;n<o;n+=1)"m"===a[n].t?d.moveTo(a[n].p[0],a[n].p[1]):"c"===a[n].t?d.bezierCurveTo(a[n].pts[0],a[n].pts[1],a[n].pts[2],a[n].pts[3],a[n].pts[4],a[n].pts[5]):d.closePath();"st"!==s&&"gs"!==s||(u.ctxStroke(),l.da&&d.setLineDash(this.dashResetter))}"st"!==s&&"gs"!==s&&this.globalData.renderer.ctxFill(l.r),u.restore()}},CVShapeElement.prototype.renderShape=function(e,t,r,n){var o,i;for(i=e,o=t.length-1;o>=0;o-=1)"tr"===t[o].ty?(i=r[o].transform,this.renderShapeTransform(e,i)):"sh"===t[o].ty||"el"===t[o].ty||"rc"===t[o].ty||"sr"===t[o].ty?this.renderPath(t[o],r[o]):"fl"===t[o].ty?this.renderFill(t[o],r[o],i):"st"===t[o].ty?this.renderStroke(t[o],r[o],i):"gf"===t[o].ty||"gs"===t[o].ty?this.renderGradientFill(t[o],r[o],i):"gr"===t[o].ty?this.renderShape(i,t[o].it,r[o].it):t[o].ty;n&&this.drawLayer()},CVShapeElement.prototype.renderStyledShape=function(e,t){if(this._isFirstFrame||t._mdf||e.transforms._mdf){var r,n,o,i=e.trNodes,a=t.paths,s=a._length;i.length=0;var l=e.transforms.finalTransform;for(o=0;o<s;o+=1){var c=a.shapes[o];if(c&&c.v){for(n=c._length,r=1;r<n;r+=1)1===r&&i.push({t:"m",p:l.applyToPointArray(c.v[0][0],c.v[0][1],0)}),i.push({t:"c",pts:l.applyToTriplePoints(c.o[r-1],c.i[r],c.v[r])});1===n&&i.push({t:"m",p:l.applyToPointArray(c.v[0][0],c.v[0][1],0)}),c.c&&n&&(i.push({t:"c",pts:l.applyToTriplePoints(c.o[r-1],c.i[0],c.v[0])}),i.push({t:"z"}))}}e.trNodes=i}},CVShapeElement.prototype.renderPath=function(e,t){if(!0!==e.hd&&e._shouldRender){var r,n=t.styledShapes.length;for(r=0;r<n;r+=1)this.renderStyledShape(t.styledShapes[r],t.sh)}},CVShapeElement.prototype.renderFill=function(e,t,r){var n=t.style;(t.c._mdf||this._isFirstFrame)&&(n.co="rgb("+bmFloor(t.c.v[0])+","+bmFloor(t.c.v[1])+","+bmFloor(t.c.v[2])+")"),(t.o._mdf||r._opMdf||this._isFirstFrame)&&(n.coOp=t.o.v*r.opacity)},CVShapeElement.prototype.renderGradientFill=function(e,t,r){var n,o=t.style;if(!o.grd||t.g._mdf||t.s._mdf||t.e._mdf||1!==e.t&&(t.h._mdf||t.a._mdf)){var i,a=this.globalData.canvasContext,s=t.s.v,l=t.e.v;if(1===e.t)n=a.createLinearGradient(s[0],s[1],l[0],l[1]);else{var c=Math.sqrt(Math.pow(s[0]-l[0],2)+Math.pow(s[1]-l[1],2)),u=Math.atan2(l[1]-s[1],l[0]-s[0]),d=t.h.v;d>=1?d=.99:d<=-1&&(d=-.99);var h=c*d,p=Math.cos(u+t.a.v)*h+s[0],f=Math.sin(u+t.a.v)*h+s[1];n=a.createRadialGradient(p,f,0,s[0],s[1],c)}var g=e.g.p,m=t.g.c,y=1;for(i=0;i<g;i+=1)t.g._hasOpacity&&t.g._collapsable&&(y=t.g.o[2*i+1]),n.addColorStop(m[4*i]/100,"rgba("+m[4*i+1]+","+m[4*i+2]+","+m[4*i+3]+","+y+")");o.grd=n}o.coOp=t.o.v*r.opacity},CVShapeElement.prototype.renderStroke=function(e,t,r){var n=t.style,o=t.d;o&&(o._mdf||this._isFirstFrame)&&(n.da=o.dashArray,n.do=o.dashoffset[0]),(t.c._mdf||this._isFirstFrame)&&(n.co="rgb("+bmFloor(t.c.v[0])+","+bmFloor(t.c.v[1])+","+bmFloor(t.c.v[2])+")"),(t.o._mdf||r._opMdf||this._isFirstFrame)&&(n.coOp=t.o.v*r.opacity),(t.w._mdf||this._isFirstFrame)&&(n.wi=t.w.v)},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){var e=this.textProperty.currentData;this.renderedLetters=createSizedArray(e.l?e.l.length:0);var t=!1;e.fc?(t=!0,this.values.fill=this.buildColor(e.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=t;var r=!1;e.sc&&(r=!0,this.values.stroke=this.buildColor(e.sc),this.values.sWidth=e.sw);var n,o,i,a,s,l,c,u,d,h,p,f,g=this.globalData.fontManager.getFontByName(e.f),m=e.l,y=this.mHelper;this.stroke=r,this.values.fValue=e.finalSize+"px "+this.globalData.fontManager.getFontByName(e.f).fFamily,o=e.finalText.length;var v=this.data.singleShape,_=.001*e.tr*e.finalSize,b=0,C=0,E=!0,T=0;for(n=0;n<o;n+=1){a=(i=this.globalData.fontManager.getCharData(e.finalText[n],g.fStyle,this.globalData.fontManager.getFontByName(e.f).fFamily))&&i.data||{},y.reset(),v&&m[n].n&&(b=-_,C+=e.yOffset,C+=E?1:0,E=!1),d=(c=a.shapes?a.shapes[0].it:[]).length,y.scale(e.finalSize/100,e.finalSize/100),v&&this.applyTextPropertiesToMatrix(e,y,m[n].line,b,C),p=createSizedArray(d-1);var S=0;for(u=0;u<d;u+=1)if("sh"===c[u].ty){for(l=c[u].ks.k.i.length,h=c[u].ks.k,f=[],s=1;s<l;s+=1)1===s&&f.push(y.applyToX(h.v[0][0],h.v[0][1],0),y.applyToY(h.v[0][0],h.v[0][1],0)),f.push(y.applyToX(h.o[s-1][0],h.o[s-1][1],0),y.applyToY(h.o[s-1][0],h.o[s-1][1],0),y.applyToX(h.i[s][0],h.i[s][1],0),y.applyToY(h.i[s][0],h.i[s][1],0),y.applyToX(h.v[s][0],h.v[s][1],0),y.applyToY(h.v[s][0],h.v[s][1],0));f.push(y.applyToX(h.o[s-1][0],h.o[s-1][1],0),y.applyToY(h.o[s-1][0],h.o[s-1][1],0),y.applyToX(h.i[0][0],h.i[0][1],0),y.applyToY(h.i[0][0],h.i[0][1],0),y.applyToX(h.v[0][0],h.v[0][1],0),y.applyToY(h.v[0][0],h.v[0][1],0)),p[S]=f,S+=1}v&&(b+=m[n].l,b+=_),this.textSpans[T]?this.textSpans[T].elem=p:this.textSpans[T]={elem:p},T+=1}},CVTextElement.prototype.renderInnerContent=function(){var e,t,r,n,o,i;this.validateText(),this.canvasContext.font=this.values.fValue,this.globalData.renderer.ctxLineCap("butt"),this.globalData.renderer.ctxLineJoin("miter"),this.globalData.renderer.ctxMiterLimit(4),this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);var a,s=this.textAnimator.renderedLetters,l=this.textProperty.currentData.l;t=l.length;var c,u,d=null,h=null,p=null,f=this.globalData.renderer;for(e=0;e<t;e+=1)if(!l[e].n){if((a=s[e])&&(f.save(),f.ctxTransform(a.p),f.ctxOpacity(a.o)),this.fill){for(a&&a.fc?d!==a.fc&&(f.ctxFillStyle(a.fc),d=a.fc):d!==this.values.fill&&(d=this.values.fill,f.ctxFillStyle(this.values.fill)),n=(c=this.textSpans[e].elem).length,this.globalData.canvasContext.beginPath(),r=0;r<n;r+=1)for(i=(u=c[r]).length,this.globalData.canvasContext.moveTo(u[0],u[1]),o=2;o<i;o+=6)this.globalData.canvasContext.bezierCurveTo(u[o],u[o+1],u[o+2],u[o+3],u[o+4],u[o+5]);this.globalData.canvasContext.closePath(),f.ctxFill()}if(this.stroke){for(a&&a.sw?p!==a.sw&&(p=a.sw,f.ctxLineWidth(a.sw)):p!==this.values.sWidth&&(p=this.values.sWidth,f.ctxLineWidth(this.values.sWidth)),a&&a.sc?h!==a.sc&&(h=a.sc,f.ctxStrokeStyle(a.sc)):h!==this.values.stroke&&(h=this.values.stroke,f.ctxStrokeStyle(this.values.stroke)),n=(c=this.textSpans[e].elem).length,this.globalData.canvasContext.beginPath(),r=0;r<n;r+=1)for(i=(u=c[r]).length,this.globalData.canvasContext.moveTo(u[0],u[1]),o=2;o<i;o+=6)this.globalData.canvasContext.bezierCurveTo(u[o],u[o+1],u[o+2],u[o+3],u[o+4],u[o+5]);this.globalData.canvasContext.closePath(),f.ctxStroke()}a&&this.globalData.renderer.restore()}},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){if(this.img.width&&(this.assetData.w!==this.img.width||this.assetData.h!==this.img.height)){var e=createTag("canvas");e.width=this.assetData.w,e.height=this.assetData.h;var t,r,n=e.getContext("2d"),o=this.img.width,i=this.img.height,a=o/i,s=this.assetData.w/this.assetData.h,l=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio;a>s&&"xMidYMid slice"===l||a<s&&"xMidYMid slice"!==l?t=(r=i)*s:r=(t=o)/s,n.drawImage(this.img,(o-t)/2,(i-r)/2,t,r,0,0,this.assetData.w,this.assetData.h),this.img=e}},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0)},CVImageElement.prototype.destroy=function(){this.img=null},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){this.globalData.renderer.ctxFillStyle(this.data.sc),this.globalData.renderer.ctxFillRect(0,0,this.data.sw,this.data.sh)},extendPrototype([BaseRenderer],CanvasRendererBase),CanvasRendererBase.prototype.createShape=function(e){return new CVShapeElement(e,this.globalData,this)},CanvasRendererBase.prototype.createText=function(e){return new CVTextElement(e,this.globalData,this)},CanvasRendererBase.prototype.createImage=function(e){return new CVImageElement(e,this.globalData,this)},CanvasRendererBase.prototype.createSolid=function(e){return new CVSolidElement(e,this.globalData,this)},CanvasRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRendererBase.prototype.ctxTransform=function(e){1===e[0]&&0===e[1]&&0===e[4]&&1===e[5]&&0===e[12]&&0===e[13]||this.canvasContext.transform(e[0],e[1],e[4],e[5],e[12],e[13])},CanvasRendererBase.prototype.ctxOpacity=function(e){this.canvasContext.globalAlpha*=e<0?0:e},CanvasRendererBase.prototype.ctxFillStyle=function(e){this.canvasContext.fillStyle=e},CanvasRendererBase.prototype.ctxStrokeStyle=function(e){this.canvasContext.strokeStyle=e},CanvasRendererBase.prototype.ctxLineWidth=function(e){this.canvasContext.lineWidth=e},CanvasRendererBase.prototype.ctxLineCap=function(e){this.canvasContext.lineCap=e},CanvasRendererBase.prototype.ctxLineJoin=function(e){this.canvasContext.lineJoin=e},CanvasRendererBase.prototype.ctxMiterLimit=function(e){this.canvasContext.miterLimit=e},CanvasRendererBase.prototype.ctxFill=function(e){this.canvasContext.fill(e)},CanvasRendererBase.prototype.ctxFillRect=function(e,t,r,n){this.canvasContext.fillRect(e,t,r,n)},CanvasRendererBase.prototype.ctxStroke=function(){this.canvasContext.stroke()},CanvasRendererBase.prototype.reset=function(){this.renderConfig.clearCanvas?this.contextData.reset():this.canvasContext.restore()},CanvasRendererBase.prototype.save=function(){this.canvasContext.save()},CanvasRendererBase.prototype.restore=function(e){this.renderConfig.clearCanvas?(e&&(this.globalData.blendMode="source-over"),this.contextData.restore(e)):this.canvasContext.restore()},CanvasRendererBase.prototype.configAnimation=function(e){if(this.animationItem.wrapper){this.animationItem.container=createTag("canvas");var t=this.animationItem.container.style;t.width="100%",t.height="100%";var r="0px 0px 0px";t.transformOrigin=r,t.mozTransformOrigin=r,t.webkitTransformOrigin=r,t["-webkit-transform"]=r,t.contentVisibility=this.renderConfig.contentVisibility,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id)}else this.canvasContext=this.renderConfig.context;this.contextData.setContext(this.canvasContext),this.data=e,this.layers=e.layers,this.transformCanvas={w:e.w,h:e.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(e,document.body),this.globalData.canvasContext=this.canvasContext,this.globalData.renderer=this,this.globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(e.layers.length),this.updateContainerSize()},CanvasRendererBase.prototype.updateContainerSize=function(e,t){var r,n,o,i;if(this.reset(),e?(r=e,n=t,this.canvasContext.canvas.width=r,this.canvasContext.canvas.height=n):(this.animationItem.wrapper&&this.animationItem.container?(r=this.animationItem.wrapper.offsetWidth,n=this.animationItem.wrapper.offsetHeight):(r=this.canvasContext.canvas.width,n=this.canvasContext.canvas.height),this.canvasContext.canvas.width=r*this.renderConfig.dpr,this.canvasContext.canvas.height=n*this.renderConfig.dpr),-1!==this.renderConfig.preserveAspectRatio.indexOf("meet")||-1!==this.renderConfig.preserveAspectRatio.indexOf("slice")){var a=this.renderConfig.preserveAspectRatio.split(" "),s=a[1]||"meet",l=a[0]||"xMidYMid",c=l.substr(0,4),u=l.substr(4);o=r/n,(i=this.transformCanvas.w/this.transformCanvas.h)>o&&"meet"===s||i<o&&"slice"===s?(this.transformCanvas.sx=r/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=r/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=n/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=n/(this.transformCanvas.h/this.renderConfig.dpr)),this.transformCanvas.tx="xMid"===c&&(i<o&&"meet"===s||i>o&&"slice"===s)?(r-this.transformCanvas.w*(n/this.transformCanvas.h))/2*this.renderConfig.dpr:"xMax"===c&&(i<o&&"meet"===s||i>o&&"slice"===s)?(r-this.transformCanvas.w*(n/this.transformCanvas.h))*this.renderConfig.dpr:0,this.transformCanvas.ty="YMid"===u&&(i>o&&"meet"===s||i<o&&"slice"===s)?(n-this.transformCanvas.h*(r/this.transformCanvas.w))/2*this.renderConfig.dpr:"YMax"===u&&(i>o&&"meet"===s||i<o&&"slice"===s)?(n-this.transformCanvas.h*(r/this.transformCanvas.w))*this.renderConfig.dpr:0}else"none"===this.renderConfig.preserveAspectRatio?(this.transformCanvas.sx=r/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=n/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr,this.transformCanvas.tx=0,this.transformCanvas.ty=0);this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0)},CanvasRendererBase.prototype.destroy=function(){var e;for(this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),e=(this.layers?this.layers.length:0)-1;e>=0;e-=1)this.elements[e]&&this.elements[e].destroy&&this.elements[e].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0},CanvasRendererBase.prototype.renderFrame=function(e,t){if((this.renderedFrame!==e||!0!==this.renderConfig.clearCanvas||t)&&!this.destroyed&&-1!==e){var r;this.renderedFrame=e,this.globalData.frameNum=e-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||t,this.globalData.projectInterface.currentFrame=e;var n=this.layers.length;for(this.completeLayers||this.checkLayers(e),r=n-1;r>=0;r-=1)(this.completeLayers||this.elements[r])&&this.elements[r].prepareFrame(e-this.layers[r].st);if(this.globalData._mdf){for(!0===this.renderConfig.clearCanvas?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),r=n-1;r>=0;r-=1)(this.completeLayers||this.elements[r])&&this.elements[r].renderFrame();!0!==this.renderConfig.clearCanvas&&this.restore()}}},CanvasRendererBase.prototype.buildItem=function(e){var t=this.elements;if(!t[e]&&99!==this.layers[e].ty){var r=this.createItem(this.layers[e],this,this.globalData);t[e]=r,r.initExpressions()}},CanvasRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;)this.pendingElements.pop().checkParenting()},CanvasRendererBase.prototype.hide=function(){this.animationItem.container.style.display="none"},CanvasRendererBase.prototype.show=function(){this.animationItem.container.style.display="block"},CVContextData.prototype.duplicate=function(){var e=2*this._length,t=0;for(t=this._length;t<e;t+=1)this.stack[t]=new CanvasContext;this._length=e},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.stack[this.cArrPos].opacity=1},CVContextData.prototype.restore=function(e){this.cArrPos-=1;var t,r=this.stack[this.cArrPos],n=r.transform,o=this.cTr.props;for(t=0;t<16;t+=1)o[t]=n[t];if(e){this.nativeContext.restore();var i=this.stack[this.cArrPos+1];this.appliedFillStyle=i.fillStyle,this.appliedStrokeStyle=i.strokeStyle,this.appliedLineWidth=i.lineWidth,this.appliedLineCap=i.lineCap,this.appliedLineJoin=i.lineJoin,this.appliedMiterLimit=i.miterLimit}this.nativeContext.setTransform(n[0],n[1],n[4],n[5],n[12],n[13]),(e||-1!==r.opacity&&this.currentOpacity!==r.opacity)&&(this.nativeContext.globalAlpha=r.opacity,this.currentOpacity=r.opacity),this.currentFillStyle=r.fillStyle,this.currentStrokeStyle=r.strokeStyle,this.currentLineWidth=r.lineWidth,this.currentLineCap=r.lineCap,this.currentLineJoin=r.lineJoin,this.currentMiterLimit=r.miterLimit},CVContextData.prototype.save=function(e){e&&this.nativeContext.save();var t=this.cTr.props;this._length<=this.cArrPos&&this.duplicate();var r,n=this.stack[this.cArrPos];for(r=0;r<16;r+=1)n.transform[r]=t[r];this.cArrPos+=1;var o=this.stack[this.cArrPos];o.opacity=n.opacity,o.fillStyle=n.fillStyle,o.strokeStyle=n.strokeStyle,o.lineWidth=n.lineWidth,o.lineCap=n.lineCap,o.lineJoin=n.lineJoin,o.miterLimit=n.miterLimit},CVContextData.prototype.setOpacity=function(e){this.stack[this.cArrPos].opacity=e},CVContextData.prototype.setContext=function(e){this.nativeContext=e},CVContextData.prototype.fillStyle=function(e){this.stack[this.cArrPos].fillStyle!==e&&(this.currentFillStyle=e,this.stack[this.cArrPos].fillStyle=e)},CVContextData.prototype.strokeStyle=function(e){this.stack[this.cArrPos].strokeStyle!==e&&(this.currentStrokeStyle=e,this.stack[this.cArrPos].strokeStyle=e)},CVContextData.prototype.lineWidth=function(e){this.stack[this.cArrPos].lineWidth!==e&&(this.currentLineWidth=e,this.stack[this.cArrPos].lineWidth=e)},CVContextData.prototype.lineCap=function(e){this.stack[this.cArrPos].lineCap!==e&&(this.currentLineCap=e,this.stack[this.cArrPos].lineCap=e)},CVContextData.prototype.lineJoin=function(e){this.stack[this.cArrPos].lineJoin!==e&&(this.currentLineJoin=e,this.stack[this.cArrPos].lineJoin=e)},CVContextData.prototype.miterLimit=function(e){this.stack[this.cArrPos].miterLimit!==e&&(this.currentMiterLimit=e,this.stack[this.cArrPos].miterLimit=e)},CVContextData.prototype.transform=function(e){this.transformMat.cloneFromProps(e);var t=this.cTr;this.transformMat.multiply(t),t.cloneFromProps(this.transformMat.props);var r=t.props;this.nativeContext.setTransform(r[0],r[1],r[4],r[5],r[12],r[13])},CVContextData.prototype.opacity=function(e){var t=this.stack[this.cArrPos].opacity;t*=e<0?0:e,this.stack[this.cArrPos].opacity!==t&&(this.currentOpacity!==e&&(this.nativeContext.globalAlpha=e,this.currentOpacity=e),this.stack[this.cArrPos].opacity=t)},CVContextData.prototype.fill=function(e){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fill(e)},CVContextData.prototype.fillRect=function(e,t,r,n){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fillRect(e,t,r,n)},CVContextData.prototype.stroke=function(){this.appliedStrokeStyle!==this.currentStrokeStyle&&(this.appliedStrokeStyle=this.currentStrokeStyle,this.nativeContext.strokeStyle=this.appliedStrokeStyle),this.appliedLineWidth!==this.currentLineWidth&&(this.appliedLineWidth=this.currentLineWidth,this.nativeContext.lineWidth=this.appliedLineWidth),this.appliedLineCap!==this.currentLineCap&&(this.appliedLineCap=this.currentLineCap,this.nativeContext.lineCap=this.appliedLineCap),this.appliedLineJoin!==this.currentLineJoin&&(this.appliedLineJoin=this.currentLineJoin,this.nativeContext.lineJoin=this.appliedLineJoin),this.appliedMiterLimit!==this.currentMiterLimit&&(this.appliedMiterLimit=this.currentMiterLimit,this.nativeContext.miterLimit=this.appliedMiterLimit),this.nativeContext.stroke()},extendPrototype([CanvasRendererBase,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var e,t=this.canvasContext;for(t.beginPath(),t.moveTo(0,0),t.lineTo(this.data.w,0),t.lineTo(this.data.w,this.data.h),t.lineTo(0,this.data.h),t.lineTo(0,0),t.clip(),e=this.layers.length-1;e>=0;e-=1)(this.completeLayers||this.elements[e])&&this.elements[e].renderFrame()},CVCompElement.prototype.destroy=function(){var e;for(e=this.layers.length-1;e>=0;e-=1)this.elements[e]&&this.elements[e].destroy();this.layers=null,this.elements=null},CVCompElement.prototype.createComp=function(e){return new CVCompElement(e,this.globalData,this)},extendPrototype([CanvasRendererBase],CanvasRenderer),CanvasRenderer.prototype.createComp=function(e){return new CVCompElement(e,this.globalData,this)},HBaseElement.prototype={checkBlendMode:function(){},initRendererElement:function(){this.baseElement=createTag(this.data.tg||"div"),this.data.hasMask?(this.svgElement=createNS("svg"),this.layerElement=createNS("g"),this.maskedElement=this.layerElement,this.svgElement.appendChild(this.layerElement),this.baseElement.appendChild(this.svgElement)):this.layerElement=this.baseElement,styleDiv(this.baseElement)},createContainerElements:function(){this.renderableEffectsManager=new CVEffects(this),this.transformedElement=this.baseElement,this.maskedElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),0!==this.data.bm&&this.setBlendMode()},renderElement:function(){var e=this.transformedElement?this.transformedElement.style:{};if(this.finalTransform._matMdf){var t=this.finalTransform.mat.toCSS();e.transform=t,e.webkitTransform=t}this.finalTransform._opMdf&&(e.opacity=this.finalTransform.mProp.o.v)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},destroy:function(){this.layerElement=null,this.transformedElement=null,this.matteElement&&(this.matteElement=null),this.maskManager&&(this.maskManager.destroy(),this.maskManager=null)},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData)},addEffects:function(){},setMatte:function(){}},HBaseElement.prototype.getBaseElement=SVGBaseElement.prototype.getBaseElement,HBaseElement.prototype.destroyBaseElement=HBaseElement.prototype.destroy,HBaseElement.prototype.buildElementParenting=BaseRenderer.prototype.buildElementParenting,extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],HSolidElement),HSolidElement.prototype.createContent=function(){var e;this.data.hasMask?((e=createNS("rect")).setAttribute("width",this.data.sw),e.setAttribute("height",this.data.sh),e.setAttribute("fill",this.data.sc),this.svgElement.setAttribute("width",this.data.sw),this.svgElement.setAttribute("height",this.data.sh)):((e=createTag("div")).style.width=this.data.sw+"px",e.style.height=this.data.sh+"px",e.style.backgroundColor=this.data.sc),this.layerElement.appendChild(e)},extendPrototype([BaseElement,TransformElement,HSolidElement,SVGShapeElement,HBaseElement,HierarchyElement,FrameElement,RenderableElement],HShapeElement),HShapeElement.prototype._renderShapeFrame=HShapeElement.prototype.renderInnerContent,HShapeElement.prototype.createContent=function(){var e;if(this.baseElement.style.fontSize=0,this.data.hasMask)this.layerElement.appendChild(this.shapesContainer),e=this.svgElement;else{e=createNS("svg");var t=this.comp.data?this.comp.data:this.globalData.compSize;e.setAttribute("width",t.w),e.setAttribute("height",t.h),e.appendChild(this.shapesContainer),this.layerElement.appendChild(e)}this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.shapesContainer,0,[],!0),this.filterUniqueShapes(),this.shapeCont=e},HShapeElement.prototype.getTransformedPoint=function(e,t){var r,n=e.length;for(r=0;r<n;r+=1)t=e[r].mProps.v.applyToPointArray(t[0],t[1],0);return t},HShapeElement.prototype.calculateShapeBoundingBox=function(e,t){var r,n,o,i,a,s=e.sh.v,l=e.transformers,c=s._length;if(!(c<=1)){for(r=0;r<c-1;r+=1)n=this.getTransformedPoint(l,s.v[r]),o=this.getTransformedPoint(l,s.o[r]),i=this.getTransformedPoint(l,s.i[r+1]),a=this.getTransformedPoint(l,s.v[r+1]),this.checkBounds(n,o,i,a,t);s.c&&(n=this.getTransformedPoint(l,s.v[r]),o=this.getTransformedPoint(l,s.o[r]),i=this.getTransformedPoint(l,s.i[0]),a=this.getTransformedPoint(l,s.v[0]),this.checkBounds(n,o,i,a,t))}},HShapeElement.prototype.checkBounds=function(e,t,r,n,o){this.getBoundsOfCurve(e,t,r,n);var i=this.shapeBoundingBox;o.x=bmMin(i.left,o.x),o.xMax=bmMax(i.right,o.xMax),o.y=bmMin(i.top,o.y),o.yMax=bmMax(i.bottom,o.yMax)},HShapeElement.prototype.shapeBoundingBox={left:0,right:0,top:0,bottom:0},HShapeElement.prototype.tempBoundingBox={x:0,xMax:0,y:0,yMax:0,width:0,height:0},HShapeElement.prototype.getBoundsOfCurve=function(e,t,r,n){for(var o,i,a,s,l,c,u,d=[[e[0],n[0]],[e[1],n[1]]],h=0;h<2;++h)i=6*e[h]-12*t[h]+6*r[h],o=-3*e[h]+9*t[h]-9*r[h]+3*n[h],a=3*t[h]-3*e[h],i|=0,a|=0,0==(o|=0)&&0===i||(0===o?(s=-a/i)>0&&s<1&&d[h].push(this.calculateF(s,e,t,r,n,h)):(l=i*i-4*a*o)>=0&&((c=(-i+bmSqrt(l))/(2*o))>0&&c<1&&d[h].push(this.calculateF(c,e,t,r,n,h)),(u=(-i-bmSqrt(l))/(2*o))>0&&u<1&&d[h].push(this.calculateF(u,e,t,r,n,h))));this.shapeBoundingBox.left=bmMin.apply(null,d[0]),this.shapeBoundingBox.top=bmMin.apply(null,d[1]),this.shapeBoundingBox.right=bmMax.apply(null,d[0]),this.shapeBoundingBox.bottom=bmMax.apply(null,d[1])},HShapeElement.prototype.calculateF=function(e,t,r,n,o,i){return bmPow(1-e,3)*t[i]+3*bmPow(1-e,2)*e*r[i]+3*(1-e)*bmPow(e,2)*n[i]+bmPow(e,3)*o[i]},HShapeElement.prototype.calculateBoundingBox=function(e,t){var r,n=e.length;for(r=0;r<n;r+=1)e[r]&&e[r].sh?this.calculateShapeBoundingBox(e[r],t):e[r]&&e[r].it?this.calculateBoundingBox(e[r].it,t):e[r]&&e[r].style&&e[r].w&&this.expandStrokeBoundingBox(e[r].w,t)},HShapeElement.prototype.expandStrokeBoundingBox=function(e,t){var r=0;if(e.keyframes){for(var n=0;n<e.keyframes.length;n+=1){var o=e.keyframes[n].s;o>r&&(r=o)}r*=e.mult}else r=e.v*e.mult;t.x-=r,t.xMax+=r,t.y-=r,t.yMax+=r},HShapeElement.prototype.currentBoxContains=function(e){return this.currentBBox.x<=e.x&&this.currentBBox.y<=e.y&&this.currentBBox.width+this.currentBBox.x>=e.x+e.width&&this.currentBBox.height+this.currentBBox.y>=e.y+e.height},HShapeElement.prototype.renderInnerContent=function(){if(this._renderShapeFrame(),!this.hidden&&(this._isFirstFrame||this._mdf)){var e=this.tempBoundingBox,t=999999;if(e.x=t,e.xMax=-t,e.y=t,e.yMax=-t,this.calculateBoundingBox(this.itemsData,e),e.width=e.xMax<e.x?0:e.xMax-e.x,e.height=e.yMax<e.y?0:e.yMax-e.y,this.currentBoxContains(e))return;var r=!1;if(this.currentBBox.w!==e.width&&(this.currentBBox.w=e.width,this.shapeCont.setAttribute("width",e.width),r=!0),this.currentBBox.h!==e.height&&(this.currentBBox.h=e.height,this.shapeCont.setAttribute("height",e.height),r=!0),r||this.currentBBox.x!==e.x||this.currentBBox.y!==e.y){this.currentBBox.w=e.width,this.currentBBox.h=e.height,this.currentBBox.x=e.x,this.currentBBox.y=e.y,this.shapeCont.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h);var n=this.shapeCont.style,o="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";n.transform=o,n.webkitTransform=o}}},extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],HTextElement),HTextElement.prototype.createContent=function(){if(this.isMasked=this.checkMasks(),this.isMasked){this.renderType="svg",this.compW=this.comp.data.w,this.compH=this.comp.data.h,this.svgElement.setAttribute("width",this.compW),this.svgElement.setAttribute("height",this.compH);var e=createNS("g");this.maskedElement.appendChild(e),this.innerElem=e}else this.renderType="html",this.innerElem=this.layerElement;this.checkParenting()},HTextElement.prototype.buildNewText=function(){var e=this.textProperty.currentData;this.renderedLetters=createSizedArray(e.l?e.l.length:0);var t=this.innerElem.style,r=e.fc?this.buildColor(e.fc):"rgba(0,0,0,0)";t.fill=r,t.color=r,e.sc&&(t.stroke=this.buildColor(e.sc),t.strokeWidth=e.sw+"px");var n,o,i=this.globalData.fontManager.getFontByName(e.f);if(!this.globalData.fontManager.chars)if(t.fontSize=e.finalSize+"px",t.lineHeight=e.finalSize+"px",i.fClass)this.innerElem.className=i.fClass;else{t.fontFamily=i.fFamily;var a=e.fWeight,s=e.fStyle;t.fontStyle=s,t.fontWeight=a}var l,c,u,d=e.l;o=d.length;var h,p=this.mHelper,f="",g=0;for(n=0;n<o;n+=1){if(this.globalData.fontManager.chars?(this.textPaths[g]?l=this.textPaths[g]:((l=createNS("path")).setAttribute("stroke-linecap",lineCapEnum[1]),l.setAttribute("stroke-linejoin",lineJoinEnum[2]),l.setAttribute("stroke-miterlimit","4")),this.isMasked||(this.textSpans[g]?u=(c=this.textSpans[g]).children[0]:((c=createTag("div")).style.lineHeight=0,(u=createNS("svg")).appendChild(l),styleDiv(c)))):this.isMasked?l=this.textPaths[g]?this.textPaths[g]:createNS("text"):this.textSpans[g]?(c=this.textSpans[g],l=this.textPaths[g]):(styleDiv(c=createTag("span")),styleDiv(l=createTag("span")),c.appendChild(l)),this.globalData.fontManager.chars){var m,y=this.globalData.fontManager.getCharData(e.finalText[n],i.fStyle,this.globalData.fontManager.getFontByName(e.f).fFamily);if(m=y?y.data:null,p.reset(),m&&m.shapes&&m.shapes.length&&(h=m.shapes[0].it,p.scale(e.finalSize/100,e.finalSize/100),f=this.createPathShape(p,h),l.setAttribute("d",f)),this.isMasked)this.innerElem.appendChild(l);else{if(this.innerElem.appendChild(c),m&&m.shapes){document.body.appendChild(u);var v=u.getBBox();u.setAttribute("width",v.width+2),u.setAttribute("height",v.height+2),u.setAttribute("viewBox",v.x-1+" "+(v.y-1)+" "+(v.width+2)+" "+(v.height+2));var _=u.style,b="translate("+(v.x-1)+"px,"+(v.y-1)+"px)";_.transform=b,_.webkitTransform=b,d[n].yOffset=v.y-1}else u.setAttribute("width",1),u.setAttribute("height",1);c.appendChild(u)}}else if(l.textContent=d[n].val,l.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.isMasked)this.innerElem.appendChild(l);else{this.innerElem.appendChild(c);var C=l.style,E="translate3d(0,"+-e.finalSize/1.2+"px,0)";C.transform=E,C.webkitTransform=E}this.isMasked?this.textSpans[g]=l:this.textSpans[g]=c,this.textSpans[g].style.display="block",this.textPaths[g]=l,g+=1}for(;g<this.textSpans.length;)this.textSpans[g].style.display="none",g+=1},HTextElement.prototype.renderInnerContent=function(){var e;if(this.validateText(),this.data.singleShape){if(!this._isFirstFrame&&!this.lettersChangedFlag)return;if(this.isMasked&&this.finalTransform._matMdf){this.svgElement.setAttribute("viewBox",-this.finalTransform.mProp.p.v[0]+" "+-this.finalTransform.mProp.p.v[1]+" "+this.compW+" "+this.compH),e=this.svgElement.style;var t="translate("+-this.finalTransform.mProp.p.v[0]+"px,"+-this.finalTransform.mProp.p.v[1]+"px)";e.transform=t,e.webkitTransform=t}}if(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag){var r,n,o,i,a,s=0,l=this.textAnimator.renderedLetters,c=this.textProperty.currentData.l;for(n=c.length,r=0;r<n;r+=1)c[r].n?s+=1:(i=this.textSpans[r],a=this.textPaths[r],o=l[s],s+=1,o._mdf.m&&(this.isMasked?i.setAttribute("transform",o.m):(i.style.webkitTransform=o.m,i.style.transform=o.m)),i.style.opacity=o.o,o.sw&&o._mdf.sw&&a.setAttribute("stroke-width",o.sw),o.sc&&o._mdf.sc&&a.setAttribute("stroke",o.sc),o.fc&&o._mdf.fc&&(a.setAttribute("fill",o.fc),a.style.color=o.fc));if(this.innerElem.getBBox&&!this.hidden&&(this._isFirstFrame||this._mdf)){var u=this.innerElem.getBBox();if(this.currentBBox.w!==u.width&&(this.currentBBox.w=u.width,this.svgElement.setAttribute("width",u.width)),this.currentBBox.h!==u.height&&(this.currentBBox.h=u.height,this.svgElement.setAttribute("height",u.height)),this.currentBBox.w!==u.width+2||this.currentBBox.h!==u.height+2||this.currentBBox.x!==u.x-1||this.currentBBox.y!==u.y-1){this.currentBBox.w=u.width+2,this.currentBBox.h=u.height+2,this.currentBBox.x=u.x-1,this.currentBBox.y=u.y-1,this.svgElement.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),e=this.svgElement.style;var d="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";e.transform=d,e.webkitTransform=d}}}},extendPrototype([BaseElement,FrameElement,HierarchyElement],HCameraElement),HCameraElement.prototype.setup=function(){var e,t,r,n,o=this.comp.threeDElements.length;for(e=0;e<o;e+=1)if("3d"===(t=this.comp.threeDElements[e]).type){r=t.perspectiveElem.style,n=t.container.style;var i=this.pe.v+"px",a="0px 0px 0px",s="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";r.perspective=i,r.webkitPerspective=i,n.transformOrigin=a,n.mozTransformOrigin=a,n.webkitTransformOrigin=a,r.transform=s,r.webkitTransform=s}},HCameraElement.prototype.createElements=function(){},HCameraElement.prototype.hide=function(){},HCameraElement.prototype.renderFrame=function(){var e,t,r=this._isFirstFrame;if(this.hierarchy)for(t=this.hierarchy.length,e=0;e<t;e+=1)r=this.hierarchy[e].finalTransform.mProp._mdf||r;if(r||this.pe._mdf||this.p&&this.p._mdf||this.px&&(this.px._mdf||this.py._mdf||this.pz._mdf)||this.rx._mdf||this.ry._mdf||this.rz._mdf||this.or._mdf||this.a&&this.a._mdf){if(this.mat.reset(),this.hierarchy)for(e=t=this.hierarchy.length-1;e>=0;e-=1){var n=this.hierarchy[e].finalTransform.mProp;this.mat.translate(-n.p.v[0],-n.p.v[1],n.p.v[2]),this.mat.rotateX(-n.or.v[0]).rotateY(-n.or.v[1]).rotateZ(n.or.v[2]),this.mat.rotateX(-n.rx.v).rotateY(-n.ry.v).rotateZ(n.rz.v),this.mat.scale(1/n.s.v[0],1/n.s.v[1],1/n.s.v[2]),this.mat.translate(n.a.v[0],n.a.v[1],n.a.v[2])}if(this.p?this.mat.translate(-this.p.v[0],-this.p.v[1],this.p.v[2]):this.mat.translate(-this.px.v,-this.py.v,this.pz.v),this.a){var o;o=this.p?[this.p.v[0]-this.a.v[0],this.p.v[1]-this.a.v[1],this.p.v[2]-this.a.v[2]]:[this.px.v-this.a.v[0],this.py.v-this.a.v[1],this.pz.v-this.a.v[2]];var i=Math.sqrt(Math.pow(o[0],2)+Math.pow(o[1],2)+Math.pow(o[2],2)),a=[o[0]/i,o[1]/i,o[2]/i],s=Math.sqrt(a[2]*a[2]+a[0]*a[0]),l=Math.atan2(a[1],s),c=Math.atan2(a[0],-a[2]);this.mat.rotateY(c).rotateX(-l)}this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),this.mat.translate(this.globalData.compSize.w/2,this.globalData.compSize.h/2,0),this.mat.translate(0,0,this.pe.v);var u=!this._prevMat.equals(this.mat);if((u||this.pe._mdf)&&this.comp.threeDElements){var d,h,p;for(t=this.comp.threeDElements.length,e=0;e<t;e+=1)if("3d"===(d=this.comp.threeDElements[e]).type){if(u){var f=this.mat.toCSS();(p=d.container.style).transform=f,p.webkitTransform=f}this.pe._mdf&&((h=d.perspectiveElem.style).perspective=this.pe.v+"px",h.webkitPerspective=this.pe.v+"px")}this.mat.clone(this._prevMat)}}this._isFirstFrame=!1},HCameraElement.prototype.prepareFrame=function(e){this.prepareProperties(e,!0)},HCameraElement.prototype.destroy=function(){},HCameraElement.prototype.getBaseElement=function(){return null},extendPrototype([BaseElement,TransformElement,HBaseElement,HSolidElement,HierarchyElement,FrameElement,RenderableElement],HImageElement),HImageElement.prototype.createContent=function(){var e=this.globalData.getAssetsPath(this.assetData),t=new Image;this.data.hasMask?(this.imageElem=createNS("image"),this.imageElem.setAttribute("width",this.assetData.w+"px"),this.imageElem.setAttribute("height",this.assetData.h+"px"),this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink","href",e),this.layerElement.appendChild(this.imageElem),this.baseElement.setAttribute("width",this.assetData.w),this.baseElement.setAttribute("height",this.assetData.h)):this.layerElement.appendChild(t),t.crossOrigin="anonymous",t.src=e,this.data.ln&&this.baseElement.setAttribute("id",this.data.ln)},extendPrototype([BaseRenderer],HybridRendererBase),HybridRendererBase.prototype.buildItem=SVGRenderer.prototype.buildItem,HybridRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;)this.pendingElements.pop().checkParenting()},HybridRendererBase.prototype.appendElementInPos=function(e,t){var r=e.getBaseElement();if(r){var n=this.layers[t];if(n.ddd&&this.supports3d)this.addTo3dContainer(r,t);else if(this.threeDElements)this.addTo3dContainer(r,t);else{for(var o,i,a=0;a<t;)this.elements[a]&&!0!==this.elements[a]&&this.elements[a].getBaseElement&&(i=this.elements[a],o=(this.layers[a].ddd?this.getThreeDContainerByPos(a):i.getBaseElement())||o),a+=1;o?n.ddd&&this.supports3d||this.layerElement.insertBefore(r,o):n.ddd&&this.supports3d||this.layerElement.appendChild(r)}}},HybridRendererBase.prototype.createShape=function(e){return this.supports3d?new HShapeElement(e,this.globalData,this):new SVGShapeElement(e,this.globalData,this)},HybridRendererBase.prototype.createText=function(e){return this.supports3d?new HTextElement(e,this.globalData,this):new SVGTextLottieElement(e,this.globalData,this)},HybridRendererBase.prototype.createCamera=function(e){return this.camera=new HCameraElement(e,this.globalData,this),this.camera},HybridRendererBase.prototype.createImage=function(e){return this.supports3d?new HImageElement(e,this.globalData,this):new IImageElement(e,this.globalData,this)},HybridRendererBase.prototype.createSolid=function(e){return this.supports3d?new HSolidElement(e,this.globalData,this):new ISolidElement(e,this.globalData,this)},HybridRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,HybridRendererBase.prototype.getThreeDContainerByPos=function(e){for(var t=0,r=this.threeDElements.length;t<r;){if(this.threeDElements[t].startPos<=e&&this.threeDElements[t].endPos>=e)return this.threeDElements[t].perspectiveElem;t+=1}return null},HybridRendererBase.prototype.createThreeDContainer=function(e,t){var r,n,o=createTag("div");styleDiv(o);var i=createTag("div");if(styleDiv(i),"3d"===t){(r=o.style).width=this.globalData.compSize.w+"px",r.height=this.globalData.compSize.h+"px";var a="50% 50%";r.webkitTransformOrigin=a,r.mozTransformOrigin=a,r.transformOrigin=a;var s="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";(n=i.style).transform=s,n.webkitTransform=s}o.appendChild(i);var l={container:i,perspectiveElem:o,startPos:e,endPos:e,type:t};return this.threeDElements.push(l),l},HybridRendererBase.prototype.build3dContainers=function(){var e,t,r=this.layers.length,n="";for(e=0;e<r;e+=1)this.layers[e].ddd&&3!==this.layers[e].ty?("3d"!==n&&(n="3d",t=this.createThreeDContainer(e,"3d")),t.endPos=Math.max(t.endPos,e)):("2d"!==n&&(n="2d",t=this.createThreeDContainer(e,"2d")),t.endPos=Math.max(t.endPos,e));for(e=(r=this.threeDElements.length)-1;e>=0;e-=1)this.resizerElem.appendChild(this.threeDElements[e].perspectiveElem)},HybridRendererBase.prototype.addTo3dContainer=function(e,t){for(var r=0,n=this.threeDElements.length;r<n;){if(t<=this.threeDElements[r].endPos){for(var o,i=this.threeDElements[r].startPos;i<t;)this.elements[i]&&this.elements[i].getBaseElement&&(o=this.elements[i].getBaseElement()),i+=1;o?this.threeDElements[r].container.insertBefore(e,o):this.threeDElements[r].container.appendChild(e);break}r+=1}},HybridRendererBase.prototype.configAnimation=function(e){var t=createTag("div"),r=this.animationItem.wrapper,n=t.style;n.width=e.w+"px",n.height=e.h+"px",this.resizerElem=t,styleDiv(t),n.transformStyle="flat",n.mozTransformStyle="flat",n.webkitTransformStyle="flat",this.renderConfig.className&&t.setAttribute("class",this.renderConfig.className),r.appendChild(t),n.overflow="hidden";var o=createNS("svg");o.setAttribute("width","1"),o.setAttribute("height","1"),styleDiv(o),this.resizerElem.appendChild(o);var i=createNS("defs");o.appendChild(i),this.data=e,this.setupGlobalData(e,o),this.globalData.defs=i,this.layers=e.layers,this.layerElement=this.resizerElem,this.build3dContainers(),this.updateContainerSize()},HybridRendererBase.prototype.destroy=function(){var e;this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.animationItem.container=null,this.globalData.defs=null;var t=this.layers?this.layers.length:0;for(e=0;e<t;e+=1)this.elements[e]&&this.elements[e].destroy&&this.elements[e].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},HybridRendererBase.prototype.updateContainerSize=function(){var e,t,r,n,o=this.animationItem.wrapper.offsetWidth,i=this.animationItem.wrapper.offsetHeight,a=o/i;this.globalData.compSize.w/this.globalData.compSize.h>a?(e=o/this.globalData.compSize.w,t=o/this.globalData.compSize.w,r=0,n=(i-this.globalData.compSize.h*(o/this.globalData.compSize.w))/2):(e=i/this.globalData.compSize.h,t=i/this.globalData.compSize.h,r=(o-this.globalData.compSize.w*(i/this.globalData.compSize.h))/2,n=0);var s=this.resizerElem.style;s.webkitTransform="matrix3d("+e+",0,0,0,0,"+t+",0,0,0,0,1,0,"+r+","+n+",0,1)",s.transform=s.webkitTransform},HybridRendererBase.prototype.renderFrame=SVGRenderer.prototype.renderFrame,HybridRendererBase.prototype.hide=function(){this.resizerElem.style.display="none"},HybridRendererBase.prototype.show=function(){this.resizerElem.style.display="block"},HybridRendererBase.prototype.initItems=function(){if(this.buildAllItems(),this.camera)this.camera.setup();else{var e,t=this.globalData.compSize.w,r=this.globalData.compSize.h,n=this.threeDElements.length;for(e=0;e<n;e+=1){var o=this.threeDElements[e].perspectiveElem.style;o.webkitPerspective=Math.sqrt(Math.pow(t,2)+Math.pow(r,2))+"px",o.perspective=o.webkitPerspective}}},HybridRendererBase.prototype.searchExtraCompositions=function(e){var t,r=e.length,n=createTag("div");for(t=0;t<r;t+=1)if(e[t].xt){var o=this.createComp(e[t],n,this.globalData.comp,null);o.initExpressions(),this.globalData.projectInterface.registerComposition(o)}},extendPrototype([HybridRendererBase,ICompElement,HBaseElement],HCompElement),HCompElement.prototype._createBaseContainerElements=HCompElement.prototype.createContainerElements,HCompElement.prototype.createContainerElements=function(){this._createBaseContainerElements(),this.data.hasMask?(this.svgElement.setAttribute("width",this.data.w),this.svgElement.setAttribute("height",this.data.h),this.transformedElement=this.baseElement):this.transformedElement=this.layerElement},HCompElement.prototype.addTo3dContainer=function(e,t){for(var r,n=0;n<t;)this.elements[n]&&this.elements[n].getBaseElement&&(r=this.elements[n].getBaseElement()),n+=1;r?this.layerElement.insertBefore(e,r):this.layerElement.appendChild(e)},HCompElement.prototype.createComp=function(e){return this.supports3d?new HCompElement(e,this.globalData,this):new SVGCompElement(e,this.globalData,this)},extendPrototype([HybridRendererBase],HybridRenderer),HybridRenderer.prototype.createComp=function(e){return this.supports3d?new HCompElement(e,this.globalData,this):new SVGCompElement(e,this.globalData,this)};var CompExpressionInterface=function(){return function(e){function t(t){for(var r=0,n=e.layers.length;r<n;){if(e.layers[r].nm===t||e.layers[r].ind===t)return e.elements[r].layerInterface;r+=1}return null}return Object.defineProperty(t,"_name",{value:e.data.nm}),t.layer=t,t.pixelAspect=1,t.height=e.data.h||e.globalData.compSize.h,t.width=e.data.w||e.globalData.compSize.w,t.pixelAspect=1,t.frameDuration=1/e.globalData.frameRate,t.displayStartTime=0,t.numLayers=e.layers.length,t}}();function _typeof$2(e){return(_typeof$2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function seedRandom(e,t){var r=this,n=256,o="random",i=t.pow(n,6),a=t.pow(2,52),s=2*a,l=255;function c(e){var t,r=e.length,o=this,i=0,a=o.i=o.j=0,s=o.S=[];for(r||(e=[r++]);i<n;)s[i]=i++;for(i=0;i<n;i++)s[i]=s[a=l&a+e[i%r]+(t=s[i])],s[a]=t;o.g=function(e){for(var t,r=0,i=o.i,a=o.j,s=o.S;e--;)t=s[i=l&i+1],r=r*n+s[l&(s[i]=s[a=l&a+t])+(s[a]=t)];return o.i=i,o.j=a,r}}function u(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function d(e,t){var r,n=[],o=_typeof$2(e);if(t&&"object"==o)for(r in e)try{n.push(d(e[r],t-1))}catch(e3){}return n.length?n:"string"==o?e:e+"\0"}function h(e,t){for(var r,n=e+"",o=0;o<n.length;)t[l&o]=l&(r^=19*t[l&o])+n.charCodeAt(o++);return p(t)}function p(e){return String.fromCharCode.apply(0,e)}t["seed"+o]=function(l,f,g){var m=[],y=h(d((f=!0===f?{entropy:!0}:f||{}).entropy?[l,p(e)]:null===l?function(){try{var t=new Uint8Array(n);return(r.crypto||r.msCrypto).getRandomValues(t),p(t)}catch(e3){var o=r.navigator,i=o&&o.plugins;return[+new Date,r,i,r.screen,p(e)]}}():l,3),m),v=new c(m),_=function(){for(var e=v.g(6),t=i,r=0;e<a;)e=(e+r)*n,t*=n,r=v.g(1);for(;e>=s;)e/=2,t/=2,r>>>=1;return(e+r)/t};return _.int32=function(){return 0|v.g(4)},_.quick=function(){return v.g(4)/4294967296},_.double=_,h(p(v.S),e),(f.pass||g||function(e,r,n,i){return i&&(i.S&&u(i,v),e.state=function(){return u(v,{})}),n?(t[o]=e,r):e})(_,y,"global"in f?f.global:this==t,f.state)},h(t.random(),e)}function initialize$2(e){seedRandom([],e)}var propTypes={SHAPE:"shape"};function _typeof$1(e){return(_typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ExpressionManager=function(){var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null,frames=null,_lottieGlobal={};function resetFrame(){_lottieGlobal={}}function $bm_isInstanceOfArray(e){return e.constructor===Array||e.constructor===Float32Array}function isNumerable(e,t){return"number"===e||t instanceof Number||"boolean"===e||"string"===e}function $bm_neg(e){var t=_typeof$1(e);if("number"===t||e instanceof Number||"boolean"===t)return-e;if($bm_isInstanceOfArray(e)){var r,n=e.length,o=[];for(r=0;r<n;r+=1)o[r]=-e[r];return o}return e.propType?e.v:-e}initialize$2(BMMath);var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(e,t){var r=_typeof$1(e),n=_typeof$1(t);if(isNumerable(r,e)&&isNumerable(n,t)||"string"===r||"string"===n)return e+t;if($bm_isInstanceOfArray(e)&&isNumerable(n,t))return(e=e.slice(0))[0]+=t,e;if(isNumerable(r,e)&&$bm_isInstanceOfArray(t))return(t=t.slice(0))[0]=e+t[0],t;if($bm_isInstanceOfArray(e)&&$bm_isInstanceOfArray(t)){for(var o=0,i=e.length,a=t.length,s=[];o<i||o<a;)("number"==typeof e[o]||e[o]instanceof Number)&&("number"==typeof t[o]||t[o]instanceof Number)?s[o]=e[o]+t[o]:s[o]=void 0===t[o]?e[o]:e[o]||t[o],o+=1;return s}return 0}var add=sum;function sub(e,t){var r=_typeof$1(e),n=_typeof$1(t);if(isNumerable(r,e)&&isNumerable(n,t))return"string"===r&&(e=parseInt(e,10)),"string"===n&&(t=parseInt(t,10)),e-t;if($bm_isInstanceOfArray(e)&&isNumerable(n,t))return(e=e.slice(0))[0]-=t,e;if(isNumerable(r,e)&&$bm_isInstanceOfArray(t))return(t=t.slice(0))[0]=e-t[0],t;if($bm_isInstanceOfArray(e)&&$bm_isInstanceOfArray(t)){for(var o=0,i=e.length,a=t.length,s=[];o<i||o<a;)("number"==typeof e[o]||e[o]instanceof Number)&&("number"==typeof t[o]||t[o]instanceof Number)?s[o]=e[o]-t[o]:s[o]=void 0===t[o]?e[o]:e[o]||t[o],o+=1;return s}return 0}function mul(e,t){var r,n,o,i=_typeof$1(e),a=_typeof$1(t);if(isNumerable(i,e)&&isNumerable(a,t))return e*t;if($bm_isInstanceOfArray(e)&&isNumerable(a,t)){for(o=e.length,r=createTypedArray("float32",o),n=0;n<o;n+=1)r[n]=e[n]*t;return r}if(isNumerable(i,e)&&$bm_isInstanceOfArray(t)){for(o=t.length,r=createTypedArray("float32",o),n=0;n<o;n+=1)r[n]=e*t[n];return r}return 0}function div(e,t){var r,n,o,i=_typeof$1(e),a=_typeof$1(t);if(isNumerable(i,e)&&isNumerable(a,t))return e/t;if($bm_isInstanceOfArray(e)&&isNumerable(a,t)){for(o=e.length,r=createTypedArray("float32",o),n=0;n<o;n+=1)r[n]=e[n]/t;return r}if(isNumerable(i,e)&&$bm_isInstanceOfArray(t)){for(o=t.length,r=createTypedArray("float32",o),n=0;n<o;n+=1)r[n]=e/t[n];return r}return 0}function mod(e,t){return"string"==typeof e&&(e=parseInt(e,10)),"string"==typeof t&&(t=parseInt(t,10)),e%t}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(e,t,r){if(t>r){var n=r;r=t,t=n}return Math.min(Math.max(e,t),r)}function radiansToDegrees(e){return e/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(e){return e*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(e,t){if("number"==typeof e||e instanceof Number)return t=t||0,Math.abs(e-t);var r;t||(t=helperLengthArray);var n=Math.min(e.length,t.length),o=0;for(r=0;r<n;r+=1)o+=Math.pow(t[r]-e[r],2);return Math.sqrt(o)}function normalize(e){return div(e,length(e))}function rgbToHsl(e){var t,r,n=e[0],o=e[1],i=e[2],a=Math.max(n,o,i),s=Math.min(n,o,i),l=(a+s)/2;if(a===s)t=0,r=0;else{var c=a-s;switch(r=l>.5?c/(2-a-s):c/(a+s),a){case n:t=(o-i)/c+(o<i?6:0);break;case o:t=(i-n)/c+2;break;case i:t=(n-o)/c+4}t/=6}return[t,r,l,e[3]]}function hue2rgb(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function hslToRgb(e){var t,r,n,o=e[0],i=e[1],a=e[2];if(0===i)t=a,n=a,r=a;else{var s=a<.5?a*(1+i):a+i-a*i,l=2*a-s;t=hue2rgb(l,s,o+1/3),r=hue2rgb(l,s,o),n=hue2rgb(l,s,o-1/3)}return[t,r,n,e[3]]}function linear(e,t,r,n,o){if(void 0!==n&&void 0!==o||(n=t,o=r,t=0,r=1),r<t){var i=r;r=t,t=i}if(e<=t)return n;if(e>=r)return o;var a,s=r===t?0:(e-t)/(r-t);if(!n.length)return n+(o-n)*s;var l=n.length,c=createTypedArray("float32",l);for(a=0;a<l;a+=1)c[a]=n[a]+(o[a]-n[a])*s;return c}function random(e,t){if(void 0===t&&(void 0===e?(e=0,t=1):(t=e,e=void 0)),t.length){var r,n=t.length;e||(e=createTypedArray("float32",n));var o=createTypedArray("float32",n),i=BMMath.random();for(r=0;r<n;r+=1)o[r]=e[r]+i*(t[r]-e[r]);return o}return void 0===e&&(e=0),e+BMMath.random()*(t-e)}function createPath(e,t,r,n){var o,i=e.length,a=shapePool.newElement();a.setPathData(!!n,i);var s,l,c=[0,0];for(o=0;o<i;o+=1)s=t&&t[o]?t[o]:c,l=r&&r[o]?r[o]:c,a.setTripleAt(e[o][0],e[o][1],l[0]+e[o][0],l[1]+e[o][1],s[0]+e[o][0],s[1]+e[o][1],o,!0);return a}function initiateExpression(elem,data,property){function noOp(e){return e}if(!elem.globalData.renderConfig.runExpressions)return noOp;var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=-1!==val.indexOf("random"),elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||!0!==this.data.hd,wiggle=function(e,t){var r,n,o=this.pv.length?this.pv.length:1,i=createTypedArray("float32",o),a=Math.floor(5*time);for(r=0,n=0;r<a;){for(n=0;n<o;n+=1)i[n]+=-t+2*t*BMMath.random();r+=1}var s=5*time,l=s-Math.floor(s),c=createTypedArray("float32",o);if(o>1){for(n=0;n<o;n+=1)c[n]=this.pv[n]+i[n]+(-t+2*t*BMMath.random())*l;return c}return this.pv+i[0]+(-t+2*t*BMMath.random())*l}.bind(this);function loopInDuration(e,t){return loopIn(e,t,!0)}function loopOutDuration(e,t){return loopOut(e,t,!0)}thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty)),this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface),time,velocity,value,text,textIndex,textTotal,selectorValue;function lookAt(e,t){var r=[t[0]-e[0],t[1]-e[1],t[2]-e[2]],n=Math.atan2(r[0],Math.sqrt(r[1]*r[1]+r[2]*r[2]))/degToRads;return[-Math.atan2(r[1],r[2])/degToRads,n,0]}function easeOut(e,t,r,n,o){return applyEase(easeOutBez,e,t,r,n,o)}function easeIn(e,t,r,n,o){return applyEase(easeInBez,e,t,r,n,o)}function ease(e,t,r,n,o){return applyEase(easeInOutBez,e,t,r,n,o)}function applyEase(e,t,r,n,o,i){void 0===o?(o=r,i=n):t=(t-r)/(n-r),t>1?t=1:t<0&&(t=0);var a=e(t);if($bm_isInstanceOfArray(o)){var s,l=o.length,c=createTypedArray("float32",l);for(s=0;s<l;s+=1)c[s]=(i[s]-o[s])*a+o[s];return c}return(i-o)*a+o}function nearestKey(e){var t,r,n,o=data.k.length;if(data.k.length&&"number"!=typeof data.k[0])if(r=-1,(e*=elem.comp.globalData.frameRate)<data.k[0].t)r=1,n=data.k[0].t;else{for(t=0;t<o-1;t+=1){if(e===data.k[t].t){r=t+1,n=data.k[t].t;break}if(e>data.k[t].t&&e<data.k[t+1].t){e-data.k[t].t>data.k[t+1].t-e?(r=t+2,n=data.k[t+1].t):(r=t+1,n=data.k[t].t);break}}-1===r&&(r=t+1,n=data.k[t].t)}else r=0,n=0;var i={};return i.index=r,i.time=n/elem.comp.globalData.frameRate,i}function key(e){var t,r,n;if(!data.k.length||"number"==typeof data.k[0])throw new Error("The property has no keyframe at index "+e);e-=1,t={time:data.k[e].t/elem.comp.globalData.frameRate,value:[]};var o=Object.prototype.hasOwnProperty.call(data.k[e],"s")?data.k[e].s:data.k[e-1].e;for(n=o.length,r=0;r<n;r+=1)t[r]=o[r],t.value[r]=o[r];return t}function framesToTime(e,t){return t||(t=elem.comp.globalData.frameRate),e/t}function timeToFrames(e,t){return e||0===e||(e=time),t||(t=elem.comp.globalData.frameRate),e*t}function seedRandom(e){BMMath.seedrandom(randSeed+e)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(e,t){return"string"==typeof value?void 0===t?value.substring(e):value.substring(e,t):""}function substr(e,t){return"string"==typeof value?void 0===t?value.substr(e):value.substr(e,t):""}function posterizeTime(e){time=0===e?0:Math.floor(time*e)/e,value=valueAtTime(time)}var index=elem.data.ind,hasParent=!(!elem.hierarchy||!elem.hierarchy.length),parent,randSeed=Math.floor(1e6*Math.random()),globalData=elem.globalData;function executeExpression(e){return value=e,this.frameExpressionId===elem.globalData.frameId&&"textSelector"!==this.propType?value:("textSelector"===this.propType&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform,transform&&(anchorPoint=transform.anchorPoint)),4!==elemType||content||(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),(hasParent=!(!elem.hierarchy||!elem.hierarchy.length))&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,_needsRandom&&seedRandom(randSeed+time),needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,scoped_bm_rt=scoped_bm_rt.propType===propTypes.SHAPE?scoped_bm_rt.v:scoped_bm_rt)}return executeExpression.__preventDeadCodeRemoval=[$bm_transform,anchorPoint,time,velocity,inPoint,outPoint,width,height,name,loop_in,loop_out,smooth,toComp,fromCompToSurface,toWorld,fromWorld,mask,position,rotation,scale,thisComp,numKeys,active,wiggle,loopInDuration,loopOutDuration,comp,lookAt,easeOut,easeIn,ease,nearestKey,key,text,textIndex,textTotal,selectorValue,framesToTime,timeToFrames,sourceRectAtTime,substring,substr,posterizeTime,index,globalData],executeExpression}return ob.initiateExpression=initiateExpression,ob.__preventDeadCodeRemoval=[window,document,XMLHttpRequest,fetch,frames,$bm_neg,add,$bm_sum,$bm_sub,$bm_mul,$bm_div,$bm_mod,clamp,radians_to_degrees,degreesToRadians,degrees_to_radians,normalize,rgbToHsl,hslToRgb,linear,random,createPath,_lottieGlobal],ob.resetFrame=resetFrame,ob}(),Expressions=function(){var e={initExpressions:function(e){var t=0,r=[];e.renderer.compInterface=CompExpressionInterface(e.renderer),e.renderer.globalData.projectInterface.registerComposition(e.renderer),e.renderer.globalData.pushExpression=function(){t+=1},e.renderer.globalData.popExpression=function(){0==(t-=1)&&function(){var e,t=r.length;for(e=0;e<t;e+=1)r[e].release();r.length=0}()},e.renderer.globalData.registerExpressionProperty=function(e){-1===r.indexOf(e)&&r.push(e)}}};return e.resetFrame=ExpressionManager.resetFrame,e}(),MaskManagerInterface=function(){function e(e,t){this._mask=e,this._data=t}return Object.defineProperty(e.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(e.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),100*this._mask.op.v}}),function(t){var r,n=createSizedArray(t.viewData.length),o=t.viewData.length;for(r=0;r<o;r+=1)n[r]=new e(t.viewData[r],t.masksProperties[r]);return function(e){for(r=0;r<o;){if(t.masksProperties[r].nm===e)return n[r];r+=1}return null}}}(),ExpressionPropertyInterface=function(){var e={pv:0,v:0,mult:1},t={pv:[0,0,0],v:[0,0,0],mult:1};function r(e,t,r){Object.defineProperty(e,"velocity",{get:function(){return t.getVelocityAtTime(t.comp.currentFrame)}}),e.numKeys=t.keyframes?t.keyframes.length:0,e.key=function(n){if(!e.numKeys)return 0;var o="";o="s"in t.keyframes[n-1]?t.keyframes[n-1].s:"e"in t.keyframes[n-2]?t.keyframes[n-2].e:t.keyframes[n-2].s;var i="unidimensional"===r?new Number(o):Object.assign({},o);return i.time=t.keyframes[n-1].t/t.elem.comp.globalData.frameRate,i.value="unidimensional"===r?o[0]:o,i},e.valueAtTime=t.getValueAtTime,e.speedAtTime=t.getSpeedAtTime,e.velocityAtTime=t.getVelocityAtTime,e.propertyGroup=t.propertyGroup}function n(){return e}return function(o){return o?"unidimensional"===o.propType?function(t){t&&"pv"in t||(t=e);var n=1/t.mult,o=t.pv*n,i=new Number(o);return i.value=o,r(i,t,"unidimensional"),function(){return t.k&&t.getValue(),o=t.v*n,i.value!==o&&((i=new Number(o)).value=o,r(i,t,"unidimensional")),i}}(o):function(e){e&&"pv"in e||(e=t);var n=1/e.mult,o=e.data&&e.data.l||e.pv.length,i=createTypedArray("float32",o),a=createTypedArray("float32",o);return i.value=a,r(i,e,"multidimensional"),function(){e.k&&e.getValue();for(var t=0;t<o;t+=1)a[t]=e.v[t]*n,i[t]=a[t];return i}}(o):n}}(),TransformExpressionInterface=function(){return function(e){function t(e){switch(e){case"scale":case"Scale":case"ADBE Scale":case 6:return t.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return t.rotation;case"ADBE Rotate X":return t.xRotation;case"ADBE Rotate Y":return t.yRotation;case"position":case"Position":case"ADBE Position":case 2:return t.position;case"ADBE Position_0":return t.xPosition;case"ADBE Position_1":return t.yPosition;case"ADBE Position_2":return t.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return t.anchorPoint;case"opacity":case"Opacity":case 11:return t.opacity;default:return null}}var r,n,o,i;return Object.defineProperty(t,"rotation",{get:ExpressionPropertyInterface(e.r||e.rz)}),Object.defineProperty(t,"zRotation",{get:ExpressionPropertyInterface(e.rz||e.r)}),Object.defineProperty(t,"xRotation",{get:ExpressionPropertyInterface(e.rx)}),Object.defineProperty(t,"yRotation",{get:ExpressionPropertyInterface(e.ry)}),Object.defineProperty(t,"scale",{get:ExpressionPropertyInterface(e.s)}),e.p?i=ExpressionPropertyInterface(e.p):(r=ExpressionPropertyInterface(e.px),n=ExpressionPropertyInterface(e.py),e.pz&&(o=ExpressionPropertyInterface(e.pz))),Object.defineProperty(t,"position",{get:function(){return e.p?i():[r(),n(),o?o():0]}}),Object.defineProperty(t,"xPosition",{get:ExpressionPropertyInterface(e.px)}),Object.defineProperty(t,"yPosition",{get:ExpressionPropertyInterface(e.py)}),Object.defineProperty(t,"zPosition",{get:ExpressionPropertyInterface(e.pz)}),Object.defineProperty(t,"anchorPoint",{get:ExpressionPropertyInterface(e.a)}),Object.defineProperty(t,"opacity",{get:ExpressionPropertyInterface(e.o)}),Object.defineProperty(t,"skew",{get:ExpressionPropertyInterface(e.sk)}),Object.defineProperty(t,"skewAxis",{get:ExpressionPropertyInterface(e.sa)}),Object.defineProperty(t,"orientation",{get:ExpressionPropertyInterface(e.or)}),t}}(),LayerExpressionInterface=function(){function e(e){var t=new Matrix;return void 0!==e?this._elem.finalTransform.mProp.getValueAtTime(e).clone(t):this._elem.finalTransform.mProp.applyToMatrix(t),t}function t(e,t){var r=this.getMatrix(t);return r.props[12]=0,r.props[13]=0,r.props[14]=0,this.applyPoint(r,e)}function r(e,t){var r=this.getMatrix(t);return this.applyPoint(r,e)}function n(e,t){var r=this.getMatrix(t);return r.props[12]=0,r.props[13]=0,r.props[14]=0,this.invertPoint(r,e)}function o(e,t){var r=this.getMatrix(t);return this.invertPoint(r,e)}function i(e,t){if(this._elem.hierarchy&&this._elem.hierarchy.length){var r,n=this._elem.hierarchy.length;for(r=0;r<n;r+=1)this._elem.hierarchy[r].finalTransform.mProp.applyToMatrix(e)}return e.applyToPointArray(t[0],t[1],t[2]||0)}function a(e,t){if(this._elem.hierarchy&&this._elem.hierarchy.length){var r,n=this._elem.hierarchy.length;for(r=0;r<n;r+=1)this._elem.hierarchy[r].finalTransform.mProp.applyToMatrix(e)}return e.inversePoint(t)}function s(e){var t=new Matrix;if(t.reset(),this._elem.finalTransform.mProp.applyToMatrix(t),this._elem.hierarchy&&this._elem.hierarchy.length){var r,n=this._elem.hierarchy.length;for(r=0;r<n;r+=1)this._elem.hierarchy[r].finalTransform.mProp.applyToMatrix(t);return t.inversePoint(e)}return t.inversePoint(e)}function l(){return[1,1,1,1]}return function(c){var u;function d(e){switch(e){case"ADBE Root Vectors Group":case"Contents":case 2:return d.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return u;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return d.effect;case"ADBE Text Properties":return d.textInterface;default:return null}}d.getMatrix=e,d.invertPoint=a,d.applyPoint=i,d.toWorld=r,d.toWorldVec=t,d.fromWorld=o,d.fromWorldVec=n,d.toComp=r,d.fromComp=s,d.sampleImage=l,d.sourceRectAtTime=c.sourceRectAtTime.bind(c),d._elem=c;var h=getDescriptor(u=TransformExpressionInterface(c.finalTransform.mProp),"anchorPoint");return Object.defineProperties(d,{hasParent:{get:function(){return c.hierarchy.length}},parent:{get:function(){return c.hierarchy[0].layerInterface}},rotation:getDescriptor(u,"rotation"),scale:getDescriptor(u,"scale"),position:getDescriptor(u,"position"),opacity:getDescriptor(u,"opacity"),anchorPoint:h,anchor_point:h,transform:{get:function(){return u}},active:{get:function(){return c.isInRange}}}),d.startTime=c.data.st,d.index=c.data.ind,d.source=c.data.refId,d.height=0===c.data.ty?c.data.h:100,d.width=0===c.data.ty?c.data.w:100,d.inPoint=c.data.ip/c.comp.globalData.frameRate,d.outPoint=c.data.op/c.comp.globalData.frameRate,d._name=c.data.nm,d.registerMaskInterface=function(e){d.mask=new MaskManagerInterface(e,c)},d.registerEffectsInterface=function(e){d.effect=e},d}}(),propertyGroupFactory=function(){return function(e,t){return function(r){return(r=void 0===r?1:r)<=0?e:t(r-1)}}}(),PropertyInterface=function(){return function(e,t){var r={_name:e};return function(e){return(e=void 0===e?1:e)<=0?r:t(e-1)}}}(),EffectsExpressionInterface=function(){var e={createEffectsInterface:function(e,r){if(e.effectsManager){var n,o=[],i=e.data.ef,a=e.effectsManager.effectElements.length;for(n=0;n<a;n+=1)o.push(t(i[n],e.effectsManager.effectElements[n],r,e));var s=e.data.ef||[],l=function(e){for(n=0,a=s.length;n<a;){if(e===s[n].nm||e===s[n].mn||e===s[n].ix)return o[n];n+=1}return null};return Object.defineProperty(l,"numProperties",{get:function(){return s.length}}),l}return null}};function t(e,n,o,i){function a(t){for(var r=e.ef,n=0,o=r.length;n<o;){if(t===r[n].nm||t===r[n].mn||t===r[n].ix)return 5===r[n].ty?c[n]:c[n]();n+=1}throw new Error}var s,l=propertyGroupFactory(a,o),c=[],u=e.ef.length;for(s=0;s<u;s+=1)5===e.ef[s].ty?c.push(t(e.ef[s],n.effectElements[s],n.effectElements[s].propertyGroup,i)):c.push(r(n.effectElements[s],e.ef[s].ty,i,l));return"ADBE Color Control"===e.mn&&Object.defineProperty(a,"color",{get:function(){return c[0]()}}),Object.defineProperties(a,{numProperties:{get:function(){return e.np}},_name:{value:e.nm},propertyGroup:{value:l}}),a.enabled=0!==e.en,a.active=a.enabled,a}function r(e,t,r,n){var o=ExpressionPropertyInterface(e.p);return e.p.setGroupProperty&&e.p.setGroupProperty(PropertyInterface("",n)),function(){return 10===t?r.comp.compInterface(e.p.v):o()}}return e}(),ShapePathInterface=function(){return function(e,t,r){var n=t.sh;function o(e){return"Shape"===e||"shape"===e||"Path"===e||"path"===e||"ADBE Vector Shape"===e||2===e?o.path:null}var i=propertyGroupFactory(o,r);return n.setGroupProperty(PropertyInterface("Path",i)),Object.defineProperties(o,{path:{get:function(){return n.k&&n.getValue(),n}},shape:{get:function(){return n.k&&n.getValue(),n}},_name:{value:e.nm},ix:{value:e.ix},propertyIndex:{value:e.ix},mn:{value:e.mn},propertyGroup:{value:r}}),o}}(),ShapeExpressionInterface=function(){function e(e,a,h){var p,f=[],g=e?e.length:0;for(p=0;p<g;p+=1)"gr"===e[p].ty?f.push(t(e[p],a[p],h)):"fl"===e[p].ty?f.push(r(e[p],a[p],h)):"st"===e[p].ty?f.push(o(e[p],a[p],h)):"tm"===e[p].ty?f.push(i(e[p],a[p],h)):"tr"===e[p].ty||("el"===e[p].ty?f.push(s(e[p],a[p],h)):"sr"===e[p].ty?f.push(l(e[p],a[p],h)):"sh"===e[p].ty?f.push(ShapePathInterface(e[p],a[p],h)):"rc"===e[p].ty?f.push(c(e[p],a[p],h)):"rd"===e[p].ty?f.push(u(e[p],a[p],h)):"rp"===e[p].ty?f.push(d(e[p],a[p],h)):"gf"===e[p].ty?f.push(n(e[p],a[p],h)):f.push((e[p],a[p],function(){return null})));return f}function t(t,r,n){var o=function(e){switch(e){case"ADBE Vectors Group":case"Contents":case 2:return o.content;default:return o.transform}};o.propertyGroup=propertyGroupFactory(o,n);var i=function(t,r,n){var o,i=function(e){for(var t=0,r=o.length;t<r;){if(o[t]._name===e||o[t].mn===e||o[t].propertyIndex===e||o[t].ix===e||o[t].ind===e)return o[t];t+=1}return"number"==typeof e?o[e-1]:null};i.propertyGroup=propertyGroupFactory(i,n),o=e(t.it,r.it,i.propertyGroup),i.numProperties=o.length;var s=a(t.it[t.it.length-1],r.it[r.it.length-1],i.propertyGroup);return i.transform=s,i.propertyIndex=t.cix,i._name=t.nm,i}(t,r,o.propertyGroup),s=a(t.it[t.it.length-1],r.it[r.it.length-1],o.propertyGroup);return o.content=i,o.transform=s,Object.defineProperty(o,"_name",{get:function(){return t.nm}}),o.numProperties=t.np,o.propertyIndex=t.ix,o.nm=t.nm,o.mn=t.mn,o}function r(e,t,r){function n(e){return"Color"===e||"color"===e?n.color:"Opacity"===e||"opacity"===e?n.opacity:null}return Object.defineProperties(n,{color:{get:ExpressionPropertyInterface(t.c)},opacity:{get:ExpressionPropertyInterface(t.o)},_name:{value:e.nm},mn:{value:e.mn}}),t.c.setGroupProperty(PropertyInterface("Color",r)),t.o.setGroupProperty(PropertyInterface("Opacity",r)),n}function n(e,t,r){function n(e){return"Start Point"===e||"start point"===e?n.startPoint:"End Point"===e||"end point"===e?n.endPoint:"Opacity"===e||"opacity"===e?n.opacity:null}return Object.defineProperties(n,{startPoint:{get:ExpressionPropertyInterface(t.s)},endPoint:{get:ExpressionPropertyInterface(t.e)},opacity:{get:ExpressionPropertyInterface(t.o)},type:{get:function(){return"a"}},_name:{value:e.nm},mn:{value:e.mn}}),t.s.setGroupProperty(PropertyInterface("Start Point",r)),t.e.setGroupProperty(PropertyInterface("End Point",r)),t.o.setGroupProperty(PropertyInterface("Opacity",r)),n}function o(e,t,r){var n,o,i=propertyGroupFactory(c,r),a=propertyGroupFactory(l,i),s=e.d?e.d.length:0,l={};for(n=0;n<s;n+=1)o=n,Object.defineProperty(l,e.d[o].nm,{get:ExpressionPropertyInterface(t.d.dataProps[o].p)}),t.d.dataProps[n].p.setGroupProperty(a);function c(e){return"Color"===e||"color"===e?c.color:"Opacity"===e||"opacity"===e?c.opacity:"Stroke Width"===e||"stroke width"===e?c.strokeWidth:null}return Object.defineProperties(c,{color:{get:ExpressionPropertyInterface(t.c)},opacity:{get:ExpressionPropertyInterface(t.o)},strokeWidth:{get:ExpressionPropertyInterface(t.w)},dash:{get:function(){return l}},_name:{value:e.nm},mn:{value:e.mn}}),t.c.setGroupProperty(PropertyInterface("Color",i)),t.o.setGroupProperty(PropertyInterface("Opacity",i)),t.w.setGroupProperty(PropertyInterface("Stroke Width",i)),c}function i(e,t,r){function n(t){return t===e.e.ix||"End"===t||"end"===t?n.end:t===e.s.ix?n.start:t===e.o.ix?n.offset:null}var o=propertyGroupFactory(n,r);return n.propertyIndex=e.ix,t.s.setGroupProperty(PropertyInterface("Start",o)),t.e.setGroupProperty(PropertyInterface("End",o)),t.o.setGroupProperty(PropertyInterface("Offset",o)),n.propertyIndex=e.ix,n.propertyGroup=r,Object.defineProperties(n,{start:{get:ExpressionPropertyInterface(t.s)},end:{get:ExpressionPropertyInterface(t.e)},offset:{get:ExpressionPropertyInterface(t.o)},_name:{value:e.nm}}),n.mn=e.mn,n}function a(e,t,r){function n(t){return e.a.ix===t||"Anchor Point"===t?n.anchorPoint:e.o.ix===t||"Opacity"===t?n.opacity:e.p.ix===t||"Position"===t?n.position:e.r.ix===t||"Rotation"===t||"ADBE Vector Rotation"===t?n.rotation:e.s.ix===t||"Scale"===t?n.scale:e.sk&&e.sk.ix===t||"Skew"===t?n.skew:e.sa&&e.sa.ix===t||"Skew Axis"===t?n.skewAxis:null}var o=propertyGroupFactory(n,r);return t.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",o)),t.transform.mProps.p.setGroupProperty(PropertyInterface("Position",o)),t.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",o)),t.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",o)),t.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",o)),t.transform.mProps.sk&&(t.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",o)),t.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",o))),t.transform.op.setGroupProperty(PropertyInterface("Opacity",o)),Object.defineProperties(n,{opacity:{get:ExpressionPropertyInterface(t.transform.mProps.o)},position:{get:ExpressionPropertyInterface(t.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(t.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(t.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(t.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(t.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(t.transform.mProps.sa)},_name:{value:e.nm}}),n.ty="tr",n.mn=e.mn,n.propertyGroup=r,n}function s(e,t,r){function n(t){return e.p.ix===t?n.position:e.s.ix===t?n.size:null}var o=propertyGroupFactory(n,r);n.propertyIndex=e.ix;var i="tm"===t.sh.ty?t.sh.prop:t.sh;return i.s.setGroupProperty(PropertyInterface("Size",o)),i.p.setGroupProperty(PropertyInterface("Position",o)),Object.defineProperties(n,{size:{get:ExpressionPropertyInterface(i.s)},position:{get:ExpressionPropertyInterface(i.p)},_name:{value:e.nm}}),n.mn=e.mn,n}function l(e,t,r){function n(t){return e.p.ix===t?n.position:e.r.ix===t?n.rotation:e.pt.ix===t?n.points:e.or.ix===t||"ADBE Vector Star Outer Radius"===t?n.outerRadius:e.os.ix===t?n.outerRoundness:!e.ir||e.ir.ix!==t&&"ADBE Vector Star Inner Radius"!==t?e.is&&e.is.ix===t?n.innerRoundness:null:n.innerRadius}var o=propertyGroupFactory(n,r),i="tm"===t.sh.ty?t.sh.prop:t.sh;return n.propertyIndex=e.ix,i.or.setGroupProperty(PropertyInterface("Outer Radius",o)),i.os.setGroupProperty(PropertyInterface("Outer Roundness",o)),i.pt.setGroupProperty(PropertyInterface("Points",o)),i.p.setGroupProperty(PropertyInterface("Position",o)),i.r.setGroupProperty(PropertyInterface("Rotation",o)),e.ir&&(i.ir.setGroupProperty(PropertyInterface("Inner Radius",o)),i.is.setGroupProperty(PropertyInterface("Inner Roundness",o))),Object.defineProperties(n,{position:{get:ExpressionPropertyInterface(i.p)},rotation:{get:ExpressionPropertyInterface(i.r)},points:{get:ExpressionPropertyInterface(i.pt)},outerRadius:{get:ExpressionPropertyInterface(i.or)},outerRoundness:{get:ExpressionPropertyInterface(i.os)},innerRadius:{get:ExpressionPropertyInterface(i.ir)},innerRoundness:{get:ExpressionPropertyInterface(i.is)},_name:{value:e.nm}}),n.mn=e.mn,n}function c(e,t,r){function n(t){return e.p.ix===t?n.position:e.r.ix===t?n.roundness:e.s.ix===t||"Size"===t||"ADBE Vector Rect Size"===t?n.size:null}var o=propertyGroupFactory(n,r),i="tm"===t.sh.ty?t.sh.prop:t.sh;return n.propertyIndex=e.ix,i.p.setGroupProperty(PropertyInterface("Position",o)),i.s.setGroupProperty(PropertyInterface("Size",o)),i.r.setGroupProperty(PropertyInterface("Rotation",o)),Object.defineProperties(n,{position:{get:ExpressionPropertyInterface(i.p)},roundness:{get:ExpressionPropertyInterface(i.r)},size:{get:ExpressionPropertyInterface(i.s)},_name:{value:e.nm}}),n.mn=e.mn,n}function u(e,t,r){function n(t){return e.r.ix===t||"Round Corners 1"===t?n.radius:null}var o=propertyGroupFactory(n,r),i=t;return n.propertyIndex=e.ix,i.rd.setGroupProperty(PropertyInterface("Radius",o)),Object.defineProperties(n,{radius:{get:ExpressionPropertyInterface(i.rd)},_name:{value:e.nm}}),n.mn=e.mn,n}function d(e,t,r){function n(t){return e.c.ix===t||"Copies"===t?n.copies:e.o.ix===t||"Offset"===t?n.offset:null}var o=propertyGroupFactory(n,r),i=t;return n.propertyIndex=e.ix,i.c.setGroupProperty(PropertyInterface("Copies",o)),i.o.setGroupProperty(PropertyInterface("Offset",o)),Object.defineProperties(n,{copies:{get:ExpressionPropertyInterface(i.c)},offset:{get:ExpressionPropertyInterface(i.o)},_name:{value:e.nm}}),n.mn=e.mn,n}return function(t,r,n){var o;function i(e){if("number"==typeof e)return 0===(e=void 0===e?1:e)?n:o[e-1];for(var t=0,r=o.length;t<r;){if(o[t]._name===e)return o[t];t+=1}return null}return i.propertyGroup=propertyGroupFactory(i,(function(){return n})),o=e(t,r,i.propertyGroup),i.numProperties=o.length,i._name="Contents",i}}(),TextExpressionInterface=function(){return function(e){var t;function r(e){return"ADBE Text Document"===e?r.sourceText:null}return Object.defineProperty(r,"sourceText",{get:function(){e.textProperty.getValue();var r=e.textProperty.currentData.t;return t&&r===t.value||((t=new String(r)).value=r||new String(r),Object.defineProperty(t,"style",{get:function(){return{fillColor:e.textProperty.currentData.fc}}})),t}}),r}}();function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var FootageInterface=function(){var e=function(e){function t(e){return"Outline"===e?t.outlineInterface():null}return t._name="Outline",t.outlineInterface=function(e){var t="",r=e.getFootageData();function n(e){if(r[e])return t=e,"object"===_typeof(r=r[e])?n:r;var o=e.indexOf(t);if(-1!==o){var i=parseInt(e.substr(o+t.length),10);return"object"===_typeof(r=r[i])?n:r}return""}return function(){return t="",r=e.getFootageData(),n}}(e),t};return function(t){function r(e){return"Data"===e?r.dataInterface:null}return r._name="Data",r.dataInterface=e(t),r}}(),interfaces={layer:LayerExpressionInterface,effects:EffectsExpressionInterface,comp:CompExpressionInterface,shape:ShapeExpressionInterface,text:TextExpressionInterface,footage:FootageInterface};function getInterface(e){return interfaces[e]||null}var expressionHelpers=function(){return{searchExpressions:function(e,t,r){t.x&&(r.k=!0,r.x=!0,r.initiateExpression=ExpressionManager.initiateExpression,r.effectsSequence.push(r.initiateExpression(e,t,r).bind(r)))},getSpeedAtTime:function(e){var t=this.getValueAtTime(e),r=this.getValueAtTime(e+-.01),n=0;if(t.length){var o;for(o=0;o<t.length;o+=1)n+=Math.pow(r[o]-t[o],2);n=100*Math.sqrt(n)}else n=0;return n},getVelocityAtTime:function(e){if(void 0!==this.vel)return this.vel;var t,r,n=-.001,o=this.getValueAtTime(e),i=this.getValueAtTime(e+n);if(o.length)for(t=createTypedArray("float32",o.length),r=0;r<o.length;r+=1)t[r]=(i[r]-o[r])/n;else t=(i-o)/n;return t},getValueAtTime:function(e){return e*=this.elem.globalData.frameRate,(e-=this.offsetTime)!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<e?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(e,this._cachingAtTime),this._cachingAtTime.lastFrame=e),this._cachingAtTime.value},getStaticValueAtTime:function(){return this.pv},setGroupProperty:function(e){this.propertyGroup=e}}}();function addPropertyDecorator(){function e(e,t,r){if(!this.k||!this.keyframes)return this.pv;e=e?e.toLowerCase():"";var n,o,i,a,s,l=this.comp.renderedFrame,c=this.keyframes,u=c[c.length-1].t;if(l<=u)return this.pv;if(r?o=u-(n=t?Math.abs(u-this.elem.comp.globalData.frameRate*t):Math.max(0,u-this.elem.data.ip)):((!t||t>c.length-1)&&(t=c.length-1),n=u-(o=c[c.length-1-t].t)),"pingpong"===e){if(Math.floor((l-o)/n)%2!=0)return this.getValueAtTime((n-(l-o)%n+o)/this.comp.globalData.frameRate,0)}else{if("offset"===e){var d=this.getValueAtTime(o/this.comp.globalData.frameRate,0),h=this.getValueAtTime(u/this.comp.globalData.frameRate,0),p=this.getValueAtTime(((l-o)%n+o)/this.comp.globalData.frameRate,0),f=Math.floor((l-o)/n);if(this.pv.length){for(a=(s=new Array(d.length)).length,i=0;i<a;i+=1)s[i]=(h[i]-d[i])*f+p[i];return s}return(h-d)*f+p}if("continue"===e){var g=this.getValueAtTime(u/this.comp.globalData.frameRate,0),m=this.getValueAtTime((u-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(a=(s=new Array(g.length)).length,i=0;i<a;i+=1)s[i]=g[i]+(g[i]-m[i])*((l-u)/this.comp.globalData.frameRate)/5e-4;return s}return g+(l-u)/.001*(g-m)}}return this.getValueAtTime(((l-o)%n+o)/this.comp.globalData.frameRate,0)}function t(e,t,r){if(!this.k)return this.pv;e=e?e.toLowerCase():"";var n,o,i,a,s,l=this.comp.renderedFrame,c=this.keyframes,u=c[0].t;if(l>=u)return this.pv;if(r?o=u+(n=t?Math.abs(this.elem.comp.globalData.frameRate*t):Math.max(0,this.elem.data.op-u)):((!t||t>c.length-1)&&(t=c.length-1),n=(o=c[t].t)-u),"pingpong"===e){if(Math.floor((u-l)/n)%2==0)return this.getValueAtTime(((u-l)%n+u)/this.comp.globalData.frameRate,0)}else{if("offset"===e){var d=this.getValueAtTime(u/this.comp.globalData.frameRate,0),h=this.getValueAtTime(o/this.comp.globalData.frameRate,0),p=this.getValueAtTime((n-(u-l)%n+u)/this.comp.globalData.frameRate,0),f=Math.floor((u-l)/n)+1;if(this.pv.length){for(a=(s=new Array(d.length)).length,i=0;i<a;i+=1)s[i]=p[i]-(h[i]-d[i])*f;return s}return p-(h-d)*f}if("continue"===e){var g=this.getValueAtTime(u/this.comp.globalData.frameRate,0),m=this.getValueAtTime((u+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(a=(s=new Array(g.length)).length,i=0;i<a;i+=1)s[i]=g[i]+(g[i]-m[i])*(u-l)/.001;return s}return g+(g-m)*(u-l)/.001}}return this.getValueAtTime((n-((u-l)%n+u))/this.comp.globalData.frameRate,0)}function r(e,t){if(!this.k)return this.pv;if(e=.5*(e||.4),(t=Math.floor(t||5))<=1)return this.pv;var r,n,o=this.comp.renderedFrame/this.comp.globalData.frameRate,i=o-e,a=t>1?(o+e-i)/(t-1):1,s=0,l=0;for(r=this.pv.length?createTypedArray("float32",this.pv.length):0;s<t;){if(n=this.getValueAtTime(i+s*a),this.pv.length)for(l=0;l<this.pv.length;l+=1)r[l]+=n[l];else r+=n;s+=1}if(this.pv.length)for(l=0;l<this.pv.length;l+=1)r[l]/=t;else r/=t;return r}function n(e){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix});var t=this._transformCachingAtTime.v;if(t.cloneFromProps(this.pre.props),this.appliedTransformations<1){var r=this.a.getValueAtTime(e);t.translate(-r[0]*this.a.mult,-r[1]*this.a.mult,r[2]*this.a.mult)}if(this.appliedTransformations<2){var n=this.s.getValueAtTime(e);t.scale(n[0]*this.s.mult,n[1]*this.s.mult,n[2]*this.s.mult)}if(this.sk&&this.appliedTransformations<3){var o=this.sk.getValueAtTime(e),i=this.sa.getValueAtTime(e);t.skewFromAxis(-o*this.sk.mult,i*this.sa.mult)}if(this.r&&this.appliedTransformations<4){var a=this.r.getValueAtTime(e);t.rotate(-a*this.r.mult)}else if(!this.r&&this.appliedTransformations<4){var s=this.rz.getValueAtTime(e),l=this.ry.getValueAtTime(e),c=this.rx.getValueAtTime(e),u=this.or.getValueAtTime(e);t.rotateZ(-s*this.rz.mult).rotateY(l*this.ry.mult).rotateX(c*this.rx.mult).rotateZ(-u[2]*this.or.mult).rotateY(u[1]*this.or.mult).rotateX(u[0]*this.or.mult)}if(this.data.p&&this.data.p.s){var d=this.px.getValueAtTime(e),h=this.py.getValueAtTime(e);if(this.data.p.z){var p=this.pz.getValueAtTime(e);t.translate(d*this.px.mult,h*this.py.mult,-p*this.pz.mult)}else t.translate(d*this.px.mult,h*this.py.mult,0)}else{var f=this.p.getValueAtTime(e);t.translate(f[0]*this.p.mult,f[1]*this.p.mult,-f[2]*this.p.mult)}return t}function o(){return this.v.clone(new Matrix)}var i=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(e,t,r){var a=i(e,t,r);return a.dynamicProperties.length?a.getValueAtTime=n.bind(a):a.getValueAtTime=o.bind(a),a.setGroupProperty=expressionHelpers.setGroupProperty,a};var a=PropertyFactory.getProp;PropertyFactory.getProp=function(n,o,i,s,l){var c=a(n,o,i,s,l);c.kf?c.getValueAtTime=expressionHelpers.getValueAtTime.bind(c):c.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(c),c.setGroupProperty=expressionHelpers.setGroupProperty,c.loopOut=e,c.loopIn=t,c.smooth=r,c.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(c),c.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(c),c.numKeys=1===o.a?o.k.length:0,c.propertyIndex=o.ix;var u=0;return 0!==i&&(u=createTypedArray("float32",1===o.a?o.k[0].s.length:o.k.length)),c._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:u},expressionHelpers.searchExpressions(n,o,c),c.k&&l.addDynamicProperty(c),c};var s=ShapePropertyFactory.getConstructorFunction(),l=ShapePropertyFactory.getKeyframedConstructorFunction();function c(){}c.prototype={vertices:function(e,t){this.k&&this.getValue();var r,n=this.v;void 0!==t&&(n=this.getValueAtTime(t,0));var o=n._length,i=n[e],a=n.v,s=createSizedArray(o);for(r=0;r<o;r+=1)s[r]="i"===e||"o"===e?[i[r][0]-a[r][0],i[r][1]-a[r][1]]:[i[r][0],i[r][1]];return s},points:function(e){return this.vertices("v",e)},inTangents:function(e){return this.vertices("i",e)},outTangents:function(e){return this.vertices("o",e)},isClosed:function(){return this.v.c},pointOnPath:function(e,t){var r=this.v;void 0!==t&&(r=this.getValueAtTime(t,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(r));for(var n,o=this._segmentsLength,i=o.lengths,a=o.totalLength*e,s=0,l=i.length,c=0;s<l;){if(c+i[s].addedLength>a){var u=s,d=r.c&&s===l-1?0:s+1,h=(a-c)/i[s].addedLength;n=bez.getPointInSegment(r.v[u],r.v[d],r.o[u],r.i[d],h,i[s]);break}c+=i[s].addedLength,s+=1}return n||(n=r.c?[r.v[0][0],r.v[0][1]]:[r.v[r._length-1][0],r.v[r._length-1][1]]),n},vectorOnPath:function(e,t,r){1==e?e=this.v.c:0==e&&(e=.999);var n=this.pointOnPath(e,t),o=this.pointOnPath(e+.001,t),i=o[0]-n[0],a=o[1]-n[1],s=Math.sqrt(Math.pow(i,2)+Math.pow(a,2));return 0===s?[0,0]:"tangent"===r?[i/s,a/s]:[-a/s,i/s]},tangentOnPath:function(e,t){return this.vectorOnPath(e,t,"tangent")},normalOnPath:function(e,t){return this.vectorOnPath(e,t,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([c],s),extendPrototype([c],l),l.prototype.getValueAtTime=function(e){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),e*=this.elem.globalData.frameRate,(e-=this.offsetTime)!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<e?this._caching.lastIndex:0,this._cachingAtTime.lastTime=e,this.interpolateShape(e,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue},l.prototype.initiateExpression=ExpressionManager.initiateExpression;var u=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(e,t,r,n,o){var i=u(e,t,r,n,o);return i.propertyIndex=t.ix,i.lock=!1,3===r?expressionHelpers.searchExpressions(e,t.pt,i):4===r&&expressionHelpers.searchExpressions(e,t.ks,i),i.k&&e.addDynamicProperty(i),i}}function initialize$1(){addPropertyDecorator()}function addDecorator(){TextProperty.prototype.getExpressionValue=function(e,t){var r=this.calculateExpression(t);if(e.t!==r){var n={};return this.copyData(n,e),n.t=r.toString(),n.__complete=!1,n}return e},TextProperty.prototype.searchProperty=function(){var e=this.searchKeyframes(),t=this.searchExpressions();return this.kf=e||t,this.kf},TextProperty.prototype.searchExpressions=function(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null}}function initialize(){addDecorator()}function SVGComposableEffect(){}SVGComposableEffect.prototype={createMergeNode:function(e,t){var r,n,o=createNS("feMerge");for(o.setAttribute("result",e),n=0;n<t.length;n+=1)(r=createNS("feMergeNode")).setAttribute("in",t[n]),o.appendChild(r),o.appendChild(r);return o}};var linearFilterValue="0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0";function SVGTintFilter(e,t,r,n,o){this.filterManager=t;var i=createNS("feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("color-interpolation-filters","linearRGB"),i.setAttribute("values",linearFilterValue+" 1 0"),this.linearFilter=i,i.setAttribute("result",n+"_tint_1"),e.appendChild(i),(i=createNS("feColorMatrix")).setAttribute("type","matrix"),i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),i.setAttribute("result",n+"_tint_2"),e.appendChild(i),this.matrixFilter=i;var a=this.createMergeNode(n,[o,n+"_tint_1",n+"_tint_2"]);e.appendChild(a)}function SVGFillFilter(e,t,r,n){this.filterManager=t;var o=createNS("feColorMatrix");o.setAttribute("type","matrix"),o.setAttribute("color-interpolation-filters","sRGB"),o.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),o.setAttribute("result",n),e.appendChild(o),this.matrixFilter=o}function SVGStrokeEffect(e,t,r){this.initialized=!1,this.filterManager=t,this.elem=r,this.paths=[]}function SVGTritoneFilter(e,t,r,n){this.filterManager=t;var o=createNS("feColorMatrix");o.setAttribute("type","matrix"),o.setAttribute("color-interpolation-filters","linearRGB"),o.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),e.appendChild(o);var i=createNS("feComponentTransfer");i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("result",n),this.matrixFilter=i;var a=createNS("feFuncR");a.setAttribute("type","table"),i.appendChild(a),this.feFuncR=a;var s=createNS("feFuncG");s.setAttribute("type","table"),i.appendChild(s),this.feFuncG=s;var l=createNS("feFuncB");l.setAttribute("type","table"),i.appendChild(l),this.feFuncB=l,e.appendChild(i)}function SVGProLevelsFilter(e,t,r,n){this.filterManager=t;var o=this.filterManager.effectElements,i=createNS("feComponentTransfer");(o[10].p.k||0!==o[10].p.v||o[11].p.k||1!==o[11].p.v||o[12].p.k||1!==o[12].p.v||o[13].p.k||0!==o[13].p.v||o[14].p.k||1!==o[14].p.v)&&(this.feFuncR=this.createFeFunc("feFuncR",i)),(o[17].p.k||0!==o[17].p.v||o[18].p.k||1!==o[18].p.v||o[19].p.k||1!==o[19].p.v||o[20].p.k||0!==o[20].p.v||o[21].p.k||1!==o[21].p.v)&&(this.feFuncG=this.createFeFunc("feFuncG",i)),(o[24].p.k||0!==o[24].p.v||o[25].p.k||1!==o[25].p.v||o[26].p.k||1!==o[26].p.v||o[27].p.k||0!==o[27].p.v||o[28].p.k||1!==o[28].p.v)&&(this.feFuncB=this.createFeFunc("feFuncB",i)),(o[31].p.k||0!==o[31].p.v||o[32].p.k||1!==o[32].p.v||o[33].p.k||1!==o[33].p.v||o[34].p.k||0!==o[34].p.v||o[35].p.k||1!==o[35].p.v)&&(this.feFuncA=this.createFeFunc("feFuncA",i)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(i.setAttribute("color-interpolation-filters","sRGB"),e.appendChild(i)),(o[3].p.k||0!==o[3].p.v||o[4].p.k||1!==o[4].p.v||o[5].p.k||1!==o[5].p.v||o[6].p.k||0!==o[6].p.v||o[7].p.k||1!==o[7].p.v)&&((i=createNS("feComponentTransfer")).setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("result",n),e.appendChild(i),this.feFuncRComposed=this.createFeFunc("feFuncR",i),this.feFuncGComposed=this.createFeFunc("feFuncG",i),this.feFuncBComposed=this.createFeFunc("feFuncB",i))}function SVGDropShadowEffect(e,t,r,n,o){var i=t.container.globalData.renderConfig.filterSize,a=t.data.fs||i;e.setAttribute("x",a.x||i.x),e.setAttribute("y",a.y||i.y),e.setAttribute("width",a.width||i.width),e.setAttribute("height",a.height||i.height),this.filterManager=t;var s=createNS("feGaussianBlur");s.setAttribute("in","SourceAlpha"),s.setAttribute("result",n+"_drop_shadow_1"),s.setAttribute("stdDeviation","0"),this.feGaussianBlur=s,e.appendChild(s);var l=createNS("feOffset");l.setAttribute("dx","25"),l.setAttribute("dy","0"),l.setAttribute("in",n+"_drop_shadow_1"),l.setAttribute("result",n+"_drop_shadow_2"),this.feOffset=l,e.appendChild(l);var c=createNS("feFlood");c.setAttribute("flood-color","#00ff00"),c.setAttribute("flood-opacity","1"),c.setAttribute("result",n+"_drop_shadow_3"),this.feFlood=c,e.appendChild(c);var u=createNS("feComposite");u.setAttribute("in",n+"_drop_shadow_3"),u.setAttribute("in2",n+"_drop_shadow_2"),u.setAttribute("operator","in"),u.setAttribute("result",n+"_drop_shadow_4"),e.appendChild(u);var d=this.createMergeNode(n,[n+"_drop_shadow_4",o]);e.appendChild(d)}extendPrototype([SVGComposableEffect],SVGTintFilter),SVGTintFilter.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t=this.filterManager.effectElements[0].p.v,r=this.filterManager.effectElements[1].p.v,n=this.filterManager.effectElements[2].p.v/100;this.linearFilter.setAttribute("values",linearFilterValue+" "+n+" 0"),this.matrixFilter.setAttribute("values",r[0]-t[0]+" 0 0 0 "+t[0]+" "+(r[1]-t[1])+" 0 0 0 "+t[1]+" "+(r[2]-t[2])+" 0 0 0 "+t[2]+" 0 0 0 1 0")}},SVGFillFilter.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t=this.filterManager.effectElements[2].p.v,r=this.filterManager.effectElements[6].p.v;this.matrixFilter.setAttribute("values","0 0 0 0 "+t[0]+" 0 0 0 0 "+t[1]+" 0 0 0 0 "+t[2]+" 0 0 0 "+r+" 0")}},SVGStrokeEffect.prototype.initialize=function(){var e,t,r,n,o=this.elem.layerElement.children||this.elem.layerElement.childNodes;for(1===this.filterManager.effectElements[1].p.v?(n=this.elem.maskManager.masksProperties.length,r=0):n=1+(r=this.filterManager.effectElements[0].p.v-1),(t=createNS("g")).setAttribute("fill","none"),t.setAttribute("stroke-linecap","round"),t.setAttribute("stroke-dashoffset",1);r<n;r+=1)e=createNS("path"),t.appendChild(e),this.paths.push({p:e,m:r});if(3===this.filterManager.effectElements[10].p.v){var i=createNS("mask"),a=createElementID();i.setAttribute("id",a),i.setAttribute("mask-type","alpha"),i.appendChild(t),this.elem.globalData.defs.appendChild(i);var s=createNS("g");for(s.setAttribute("mask","url("+getLocationHref()+"#"+a+")");o[0];)s.appendChild(o[0]);this.elem.layerElement.appendChild(s),this.masker=i,t.setAttribute("stroke","#fff")}else if(1===this.filterManager.effectElements[10].p.v||2===this.filterManager.effectElements[10].p.v){if(2===this.filterManager.effectElements[10].p.v)for(o=this.elem.layerElement.children||this.elem.layerElement.childNodes;o.length;)this.elem.layerElement.removeChild(o[0]);this.elem.layerElement.appendChild(t),this.elem.layerElement.removeAttribute("mask"),t.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=t},SVGStrokeEffect.prototype.renderFrame=function(e){var t;this.initialized||this.initialize();var r,n,o=this.paths.length;for(t=0;t<o;t+=1)if(-1!==this.paths[t].m&&(r=this.elem.maskManager.viewData[this.paths[t].m],n=this.paths[t].p,(e||this.filterManager._mdf||r.prop._mdf)&&n.setAttribute("d",r.lastPath),e||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||r.prop._mdf)){var i;if(0!==this.filterManager.effectElements[7].p.v||100!==this.filterManager.effectElements[8].p.v){var a=.01*Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v),s=.01*Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v),l=n.getTotalLength();i="0 0 0 "+l*a+" ";var c,u=l*(s-a),d=1+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01,h=Math.floor(u/d);for(c=0;c<h;c+=1)i+="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01+" ";i+="0 "+10*l+" 0 0"}else i="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01;n.setAttribute("stroke-dasharray",i)}if((e||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",2*this.filterManager.effectElements[4].p.v),(e||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),(1===this.filterManager.effectElements[10].p.v||2===this.filterManager.effectElements[10].p.v)&&(e||this.filterManager.effectElements[3].p._mdf)){var p=this.filterManager.effectElements[3].p.v;this.pathMasker.setAttribute("stroke","rgb("+bmFloor(255*p[0])+","+bmFloor(255*p[1])+","+bmFloor(255*p[2])+")")}},SVGTritoneFilter.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t=this.filterManager.effectElements[0].p.v,r=this.filterManager.effectElements[1].p.v,n=this.filterManager.effectElements[2].p.v,o=n[0]+" "+r[0]+" "+t[0],i=n[1]+" "+r[1]+" "+t[1],a=n[2]+" "+r[2]+" "+t[2];this.feFuncR.setAttribute("tableValues",o),this.feFuncG.setAttribute("tableValues",i),this.feFuncB.setAttribute("tableValues",a)}},SVGProLevelsFilter.prototype.createFeFunc=function(e,t){var r=createNS(e);return r.setAttribute("type","table"),t.appendChild(r),r},SVGProLevelsFilter.prototype.getTableValue=function(e,t,r,n,o){for(var i,a,s=0,l=Math.min(e,t),c=Math.max(e,t),u=Array.call(null,{length:256}),d=0,h=o-n,p=t-e;s<=256;)a=(i=s/256)<=l?p<0?o:n:i>=c?p<0?n:o:n+h*Math.pow((i-e)/p,1/r),u[d]=a,d+=1,s+=256/255;return u.join(" ")},SVGProLevelsFilter.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t,r=this.filterManager.effectElements;this.feFuncRComposed&&(e||r[3].p._mdf||r[4].p._mdf||r[5].p._mdf||r[6].p._mdf||r[7].p._mdf)&&(t=this.getTableValue(r[3].p.v,r[4].p.v,r[5].p.v,r[6].p.v,r[7].p.v),this.feFuncRComposed.setAttribute("tableValues",t),this.feFuncGComposed.setAttribute("tableValues",t),this.feFuncBComposed.setAttribute("tableValues",t)),this.feFuncR&&(e||r[10].p._mdf||r[11].p._mdf||r[12].p._mdf||r[13].p._mdf||r[14].p._mdf)&&(t=this.getTableValue(r[10].p.v,r[11].p.v,r[12].p.v,r[13].p.v,r[14].p.v),this.feFuncR.setAttribute("tableValues",t)),this.feFuncG&&(e||r[17].p._mdf||r[18].p._mdf||r[19].p._mdf||r[20].p._mdf||r[21].p._mdf)&&(t=this.getTableValue(r[17].p.v,r[18].p.v,r[19].p.v,r[20].p.v,r[21].p.v),this.feFuncG.setAttribute("tableValues",t)),this.feFuncB&&(e||r[24].p._mdf||r[25].p._mdf||r[26].p._mdf||r[27].p._mdf||r[28].p._mdf)&&(t=this.getTableValue(r[24].p.v,r[25].p.v,r[26].p.v,r[27].p.v,r[28].p.v),this.feFuncB.setAttribute("tableValues",t)),this.feFuncA&&(e||r[31].p._mdf||r[32].p._mdf||r[33].p._mdf||r[34].p._mdf||r[35].p._mdf)&&(t=this.getTableValue(r[31].p.v,r[32].p.v,r[33].p.v,r[34].p.v,r[35].p.v),this.feFuncA.setAttribute("tableValues",t))}},extendPrototype([SVGComposableEffect],SVGDropShadowEffect),SVGDropShadowEffect.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){if((e||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),e||this.filterManager.effectElements[0].p._mdf){var t=this.filterManager.effectElements[0].p.v;this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(255*t[0]),Math.round(255*t[1]),Math.round(255*t[2])))}if((e||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),e||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf){var r=this.filterManager.effectElements[3].p.v,n=(this.filterManager.effectElements[2].p.v-90)*degToRads,o=r*Math.cos(n),i=r*Math.sin(n);this.feOffset.setAttribute("dx",o),this.feOffset.setAttribute("dy",i)}}};var _svgMatteSymbols=[];function SVGMatte3Effect(e,t,r){this.initialized=!1,this.filterManager=t,this.filterElem=e,this.elem=r,r.matteElement=createNS("g"),r.matteElement.appendChild(r.layerElement),r.matteElement.appendChild(r.transformedElement),r.baseElement=r.matteElement}function SVGGaussianBlurEffect(e,t,r,n){e.setAttribute("x","-100%"),e.setAttribute("y","-100%"),e.setAttribute("width","300%"),e.setAttribute("height","300%"),this.filterManager=t;var o=createNS("feGaussianBlur");o.setAttribute("result",n),e.appendChild(o),this.feGaussianBlur=o}function TransformEffect(){}function SVGTransformEffect(e,t){this.init(t)}function CVTransformEffect(e){this.init(e)}return SVGMatte3Effect.prototype.findSymbol=function(e){for(var t=0,r=_svgMatteSymbols.length;t<r;){if(_svgMatteSymbols[t]===e)return _svgMatteSymbols[t];t+=1}return null},SVGMatte3Effect.prototype.replaceInParent=function(e,t){var r=e.layerElement.parentNode;if(r){for(var n,o=r.children,i=0,a=o.length;i<a&&o[i]!==e.layerElement;)i+=1;i<=a-2&&(n=o[i+1]);var s=createNS("use");s.setAttribute("href","#"+t),n?r.insertBefore(s,n):r.appendChild(s)}},SVGMatte3Effect.prototype.setElementAsMask=function(e,t){if(!this.findSymbol(t)){var r=createElementID(),n=createNS("mask");n.setAttribute("id",t.layerId),n.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(t);var o=e.globalData.defs;o.appendChild(n);var i=createNS("symbol");i.setAttribute("id",r),this.replaceInParent(t,r),i.appendChild(t.layerElement),o.appendChild(i);var a=createNS("use");a.setAttribute("href","#"+r),n.appendChild(a),t.data.hd=!1,t.show()}e.setMatte(t.layerId)},SVGMatte3Effect.prototype.initialize=function(){for(var e=this.filterManager.effectElements[0].p.v,t=this.elem.comp.elements,r=0,n=t.length;r<n;)t[r]&&t[r].data.ind===e&&this.setElementAsMask(this.elem,t[r]),r+=1;this.initialized=!0},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize()},SVGGaussianBlurEffect.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t=.3*this.filterManager.effectElements[0].p.v,r=this.filterManager.effectElements[1].p.v,n=3==r?0:t,o=2==r?0:t;this.feGaussianBlur.setAttribute("stdDeviation",n+" "+o);var i=1==this.filterManager.effectElements[2].p.v?"wrap":"duplicate";this.feGaussianBlur.setAttribute("edgeMode",i)}},TransformEffect.prototype.init=function(e){this.effectsManager=e,this.type=effectTypes.TRANSFORM_EFFECT,this.matrix=new Matrix,this.opacity=-1,this._mdf=!1,this._opMdf=!1},TransformEffect.prototype.renderFrame=function(e){if(this._opMdf=!1,this._mdf=!1,e||this.effectsManager._mdf){var t=this.effectsManager.effectElements,r=t[0].p.v,n=t[1].p.v,o=1===t[2].p.v,i=t[3].p.v,a=o?i:t[4].p.v,s=t[5].p.v,l=t[6].p.v,c=t[7].p.v;this.matrix.reset(),this.matrix.translate(-r[0],-r[1],r[2]),this.matrix.scale(.01*a,.01*i,1),this.matrix.rotate(-c*degToRads),this.matrix.skewFromAxis(-s*degToRads,(l+90)*degToRads),this.matrix.translate(n[0],n[1],0),this._mdf=!0,this.opacity!==t[8].p.v&&(this.opacity=t[8].p.v,this._opMdf=!0)}},extendPrototype([TransformEffect],SVGTransformEffect),extendPrototype([TransformEffect],CVTransformEffect),registerRenderer("canvas",CanvasRenderer),registerRenderer("html",HybridRenderer),registerRenderer("svg",SVGRenderer),ShapeModifiers.registerModifier("tm",TrimModifier),ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeModifiers.registerModifier("rd",RoundCornersModifier),ShapeModifiers.registerModifier("zz",ZigZagModifier),ShapeModifiers.registerModifier("op",OffsetPathModifier),setExpressionsPlugin(Expressions),setExpressionInterfaces(getInterface),initialize$1(),initialize(),registerEffect$1(20,SVGTintFilter,!0),registerEffect$1(21,SVGFillFilter,!0),registerEffect$1(22,SVGStrokeEffect,!1),registerEffect$1(23,SVGTritoneFilter,!0),registerEffect$1(24,SVGProLevelsFilter,!0),registerEffect$1(25,SVGDropShadowEffect,!0),registerEffect$1(28,SVGMatte3Effect,!1),registerEffect$1(29,SVGGaussianBlurEffect,!0),registerEffect$1(35,SVGTransformEffect,!1),registerEffect(35,CVTransformEffect),lottie},module.exports=factory())})(lottie$1,lottie$1.exports);var lottieExports=lottie$1.exports;const lottie=getDefaultExportFromCjs$1(lottieExports),LottieAnimation=({animationJson:e})=>{const t=reactExports.useRef(null),r=reactExports.useRef(null),n=e;const o=COLORS_REPLACE_TOKEN.map((e=>{return function(e){const t=hexToJson$1(e.trim()),{r:r,g:n,b:o}=t;return[r/255,n/255,o/255]}((t=e,getComputedStyle(document.querySelector(".".concat(FVS_THEME_SCOPE))).getPropertyValue(t)));var t})),[i,a,s,l,c,u]=o,d=[{oldColor:[.9412,.9569,1],newColor:i},{oldColor:[.902,.9216,1],newColor:a},{oldColor:[.7412,.7922,1],newColor:s},{oldColor:[.5804,.651,1],newColor:l},{oldColor:[.4196,.498,1],newColor:c},{oldColor:[0,.9411764705882353,.9568627450980393,1,1,.7411764705882353,.792156862745098,1],newColor:[0,...i,1,...s]},{oldColor:[0,.7411764705882353,.792156862745098,1,1,.9411764705882353,.9568627450980393,1],newColor:[0,...s,1,...i]},{oldColor:[0,.9019607843137255,.9215686274509803,1,1,.7411764705882353,.792156862745098,1],newColor:[0,...a,1,...s]},{oldColor:[0,.5803921568627451,.6509803921568628,1,1,.9411764705882353,.9568627450980393,1],newColor:[0,...l,1,...i]},{oldColor:[0,.4196078431372549,.4980392156862745,1,1,.5803921568627451,.6509803921568628,1],newColor:[0,...c,1,...l]},{oldColor:[0,.5803921568627451,.6509803921568628,1,1,.4196078431372549,.4980392156862745,1],newColor:[0,...l,1,...c]},{oldColor:[0,.4196078431372549,.4980392156862745,1,1,.2627450980392157,.33725490196078434,1],newColor:[0,...c,1,...u]},{oldColor:[0,1,1,1,1,.9019607843137255,.9215686274509803,1],newColor:[0,1,1,1,1,...a]}];return reactExports.useEffect((()=>{const e=((e,t)=>{const r=JSON.parse(JSON.stringify(e)),n=e=>{Array.isArray(e)?e.forEach(n):"object"==typeof e&&(e.k&&Array.isArray(e.k)&&t.forEach((t=>{JSON.stringify(e.k)===JSON.stringify(t.oldColor)&&(e.k=t.newColor)})),Object.values(e).forEach((e=>n(e))))};return n(r),r})(n,d);return r.current&&r.current.destroy(),t.current&&(r.current=lottie.loadAnimation({container:t.current,animationData:e,renderer:"svg",loop:!0,autoplay:!0})),()=>{r.current&&r.current.destroy()}}),[n]),jsx("div",{ref:t,className:"lottie-container"})},{Paragraph:Paragraph,Text:Text$3}=Typography,AnimationConfig=observer((()=>{const e=useStore(),{story:t}=e,r=t.currentWidgets[0],[n,o]=reactExports.useState(!1),[i,a]=reactExports.useState();reactExports.useEffect((()=>{(async()=>{const e=await __vitePreload((()=>import("./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/widget_animation_hint-hash-Ba90NuOq.js")),[],import.meta.url);a(e.default)})()}),[]);const s=()=>{o(!0)},l={...r.model.states.animation},[c,u]=getAnimationDesc(l);return jsxs(Fragment,{children:[l.in||l.out?jsxs(Fragment,{children:[jsxs(Row$1,{justify:"space-between",children:[jsx(Col,{children:duchampIntl.get("Duchamp-Animation_Overview")}),jsxs(Col,{className:"action",children:[jsx(Icon$2,{type:"icon-edit",onClick:s}),jsx(Divider,{direction:"vertical",className:"divider"}),jsx(Icon$2,{type:"icon-delete",onClick:()=>{r.setAnimation({})}})]})]}),jsxs(Paragraph,{children:[jsx("div",{children:jsxs(Text$3,{type:"secondary",children:["· ",c]})}),jsx("div",{children:jsxs(Text$3,{type:"secondary",children:["· ",u]})})]})]}):jsxs(Fragment,{children:[jsx(Button$4,{block:!0,onClick:s,children:duchampIntl.get("Duchamp-Animation_Settings")}),i&&jsx(LottieAnimation,{animationJson:i})]}),n&&jsx(AnimationModal,{animation:cloneDeep$2(l),onOk:e=>{r.setAnimation(e),o(!1)},onCancel:()=>{o(!1)}})]})})),{Text:Text$2}=Typography,GroupAnimation=observer((()=>jsxs("div",{className:"animation-config",children:[jsxs("div",{className:"title",children:[duchampIntl.get("Duchamp-Combine_Dynamics_Between_Pages"),jsx(IconPopover,{icon:"icon-help",text:duchampIntl.get("Duchamp-Setting_Group_Animations_Effect_Tip"),link:duchampIntl.get("Duchamp-Widget_Animation_Help_Link"),linkText:duchampIntl.get("Duchamp-Click_To_View_The_Reason")})]}),jsx(Text$2,{type:"secondary",children:duchampIntl.get("Duchamp-Setting_Group_Animations_Tip")}),jsx(Divider,{className:"divider"}),jsx(AnimationConfig,{})]}))),PositionConfig=observer((({states:e,rect:t,limitRect:r,onPositionChange:n})=>{const o=useStore(),{minLeft:i,minTop:a,maxLeft:s,maxTop:l}=getWidgetLimitRect(e,r),c=o.platform.mobile.isOpenMobileLayout?PlatformLineItem:LineItem;return jsx(c,{label:duchampIntl.get("Duchamp-Position"),children:jsxs("div",{className:"flex-space-between",children:[jsxs("div",{className:"position-space-between",children:[jsx("span",{className:"position-title",children:duchampIntl.get("Duchamp-Axis_X")}),jsx(NumberInput$1,{value:t.left,min:i,max:s,onChange:e=>{n(e,t.top)}})]}),jsxs("div",{className:"position-space-between",children:[jsx("span",{className:"position-title",children:duchampIntl.get("Duchamp-Axis_Y")}),jsx(NumberInput$1,{value:t.top,min:a,max:l,onChange:e=>{n(t.left,e)}})]})]})})})),Item$4=e=>{const{text:t,...r}=e;return jsx(LineItem,{style:{justifyContent:"space-between"},label:t,children:jsx(NumberInput$1,{width:96,min:-1e4,max:1e4,suffix:"°",...r})})},Rotate3d=e=>{const{value:t,onChange:r}=e;return jsx("div",{className:"duchamp-rotate3d",children:jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,children:[jsx(Item$4,{text:duchampIntl.get("Duchamp-X_Axis"),value:null==t?void 0:t.rotateX,defaultValue:0,onChange:e=>r({rotateX:e})}),jsx(Item$4,{text:duchampIntl.get("Duchamp-Y_Axis"),value:null==t?void 0:t.rotateY,defaultValue:0,onChange:e=>r({rotateY:e})}),jsx(Item$4,{text:duchampIntl.get("Duchamp-Z_Axis"),value:null==t?void 0:t.rotateZ,defaultValue:0,onChange:e=>r({rotateZ:e})}),jsx(Item$4,{text:duchampIntl.get("Duchamp-Visible_Distance"),min:1,max:void 0,suffix:"px",value:null==t?void 0:t.perspective,onChange:e=>r({perspective:e})})]})})},Rotate3dConfirm=e=>{const{onChange:t}=e,[r,n]=reactExports.useState({}),[o,i]=reactExports.useState(!1),a=jsx("div",{className:"duchamp-rotate3d-confirm-content",children:jsx(Rotate3d,{value:r,onChange:e=>{n({...r,...e})}})});return jsx(Fragment,{children:jsx(LabelItem$1,{label:duchampIntl.get("Duchamp-3d_Rotation"),className:"duchamp-transform3d",children:jsx(PopConfirm,{className:"duchamp-rotate3d-confirm",placement:"bottom",content:a,onVisibleChange:e=>{n({}),i(e)},text4Ok:duchampIntl.get("Duchamp-Apply_To_All_Group_Widget"),props4Ok:{block:!0,className:"duchamp-rotate3d-confirm-footer"},props4Cancel:{block:!0,className:"duchamp-rotate3d-confirm-footer"},onOk:()=>{t(r),i(!1)},visible:o,destroyTooltipOnHide:!0,offset:[0,15],children:jsx(Button$4,{onClick:()=>{i(!o)},block:!0,children:duchampIntl.get("Duchamp-Set_Combination_Rotation")})})})})},{Item:Item$3}=Tab$1,GroupConfig=observer((({widget:e})=>{const t=!isNil$3(e.parentContainerWidget),r=e.getInstance(),n=useStore(),{states:o,rect:i,limitRect:a}=r;return jsxs(Tab$1,{defaultActiveKey:WIDGET_TABS.COMBINATION,theme:t?"line":"card",tabHeaderStyle:{margin:t?"0 12px":"0"},stretch:!0,children:[!n.isMagneticLayout&&!t&&jsx(Item$3,{tab:duchampIntl.get("Duchamp-Animation"),className:"form-padding",children:jsx(GroupAnimation,{})},WIDGET_TABS.ANIMATION),jsxs(Item$3,{tab:duchampIntl.get("Duchamp-Combination"),className:"form-padding",children:[jsxs(GridItem,{children:[jsx(NameConfig,{name:e.name,onNameChange:t=>{e.setName(t)},onCheckingName:t=>!n.story.widgets.some((r=>r.name===t&&r.id!==e.id))}),jsx(SizeConfig,{states:toJS(o),rect:i,limitRect:a,onRectChange:t=>{n.undoManager.withGroup((()=>{e.setRectStatesWithEffect(t),n.story.platform.updateLayout()}))},onKeepRatioChange:t=>{e.setStates(t)}}),jsx(PositionConfig,{states:toJS(o),rect:i,limitRect:a,onPositionChange:(t,r)=>{n.undoManager.withGroup((()=>{e.setPosition(t,r),n.story.platform.updateLayout()}))}}),jsx(Rotate3dConfirm,{onChange:e=>r.setTransform3d(e)})]}),!n.isMagneticLayout&&jsx(Tooltip$1,{content:"shift + ctrl + G",arrow:!1,placement:"bottom",children:jsx(Button$4,{onClick:()=>{n.story.deleteGroup()},icon:jsx(Icon$2,{type:"icon-ungroup",style:{color:"inherit"}}),type:"secondary",style:{width:"100%"},children:duchampIntl.get("Duchamp-Un_Group")})})]},WIDGET_TABS.COMBINATION),r.isMobile&&jsx(Item$3,{tab:duchampIntl.get("Duchamp-Interactive"),className:"form-padding",children:jsx(PreviewConfig,{widget:e})},WIDGET_TABS.INTERACTION)]})})),GROUP_WIDGET_MATE={type:WIDGET_TYPE.GROUP,widgetType:"group",displayName:duchampIntl.get("Duchamp-Grouping"),version:"0.0.1",icon:"",configure:{...STRUCTURE_WIDGET_META_CONFIG,hide:!0,ghost:!0},scale:!1};var __defProp$B=Object.defineProperty,__getOwnPropDesc$A=Object.getOwnPropertyDescriptor,__decorateClass$A=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$A(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$B(t,r,i),i};class GroupWidgetModel extends StructWidgetModel{constructor(){super(...arguments),__publicField(this,"canResizedByChildren",!0)}get keepRatio(){return!0}get scrollAreaRect(){var e;return null==(e=this.parentWidgetModel)?void 0:e.scrollAreaRect}updateByChildren(e){var t,r;if(this.childWidgets.length>0){if(this.store.isMagneticLayout){const t=calculateAreaBound(this.childWidgets.filter((e=>e.visible)).map((e=>e.model.states))),{width:r,height:n,top:o,left:i}=t,a={width:r,height:n,matrix:(new Transform$2).setTranslate(i,o).matrix};this.mobile.setStates(a,e),e||this.updateChildrenRectStates({cur:a,pre:a,onlyCache:e})}else{const e=calculateAreaBound(this.childWidgets.map((e=>e.model.states)));this.widget.updateRect(e),this.widget.mobile.states&&updateMobileGroupRect(this.widget)}null==(t=this.parentWidgetModel)||t.updateByChildren(e)}else null==(r=this.story)||r.deleteWidget(this.widget)}get childrenLimitRect(){var e;return null==(e=this.parentWidgetModel)?void 0:e.childrenLimitRect}get mobileLayoutConfig(){return{pad:{layout:LAYOUT_TYPE$2.RESERVE},phone:{layout:LAYOUT_TYPE$2.RESERVE}}}setTransform3d(e){this.childWidgets.forEach((t=>{t.getInstance().setTransform3d(e)}))}updateRectAfterAppendChild(){this.updateByChildren()}}__decorateClass$A([override],GroupWidgetModel.prototype,"keepRatio"),__decorateClass$A([override],GroupWidgetModel.prototype,"scrollAreaRect"),__decorateClass$A([override],GroupWidgetModel.prototype,"childrenLimitRect"),__decorateClass$A([override],GroupWidgetModel.prototype,"mobileLayoutConfig");const GroupWidgetView=observer((({model:e,expandIndex:t,adaptiveScale:r})=>jsx(StructContainer,{model:e,className:"group-widget-container",overflow:"visible",outline:!1,adaptiveScale:r,children:e.childWidgets.map((e=>jsx(WidgetWrapper,{widget:e,adaptiveScale:r,expandIndex:t},e.id)))}))),RESERVE_CANVAS_CONFIG=[{name:"sticky",displayName:duchampIntl.get("Duchamp-Container_Sticky"),icon:jsx(IconPopover,{arrow:{pointAtCenter:!0},icon:"icon-help",placement:"top-left",autoAdjustOverflow:!0,overlayInnerStyle:{maxWidth:"250px"},text:duchampIntl.get("Duchamp-Container_Sticky_Tip_Reserve_Canvas")}),value:!1,type:"checkbox",text:duchampIntl.get("Duchamp-Container_Enable_Sticky_When_Preview")},{name:"keepRatio",displayName:duchampIntl.get("Duchamp-Container_Keep_Ratio"),icon:jsx(IconPopover,{arrow:{pointAtCenter:!0},icon:"icon-help",placement:"top-left",autoAdjustOverflow:!0,overlayInnerStyle:{maxWidth:"250px"},text:duchampIntl.get("Duchamp-Container_Keep_Ratio_Tip",duchampIntl.get("Duchamp-Reserve_Canvas"))}),value:!1,type:"checkbox",text:duchampIntl.get("Duchamp-Container_Enable_Keep_Ratio")},{type:"verticalLayout",displayName:duchampIntl.get("Duchamp-Preview_Fluid_Layout"),icon:jsx(IconPopover,{arrow:{pointAtCenter:!0},icon:"icon-help",placement:"top-left",autoAdjustOverflow:!0,overlayInnerStyle:{maxWidth:"250px"},text:duchampIntl.get("Duchamp-Preview_Fluid_Layout_Tips")}),platforms:["mobile"],children:[{name:"phoneLayout",value:!1,type:"checkbox",text:duchampIntl.get("Duchamp-Phone_Reset_Layout")},{name:"padLayout",value:!1,type:"checkbox",text:duchampIntl.get("Duchamp-Pad_Reset_Layout")}]},{type:"number",displayName:duchampIntl.get("Duchamp-Widget_Gap"),name:"widgetGap",value:DEFAULT_WIDGET_GAP.RESERVE_CANVAS,min:0,suffix:"px",platforms:["mobile"],style:{width:"100%"},beforeRender:e=>({hide:!e.phoneLayout&&!e.padLayout})}],RESERVE_CANVAS_META={type:WIDGET_TYPE.RESERVE_CANVAS,widgetType:"container",displayName:duchampIntl.get("Duchamp-Reserve_Canvas"),version:"0.0.1",iconfont:"icon-a-absolute-canvas-components",dragPreviewImage:"/assets/widget/reserve_canvas.svg",states:{width:480,height:320},refresh:!1,props:{keepRatio:!1,sticky:!1},configure:{...STRUCTURE_WIDGET_META_CONFIG,acceptRule:{contextBlocklist:{rule:e=>(isString$3(e)?[{type:e}]:e.flattenChildWidgets).filter((e=>e.type===WIDGET_TYPE.RESERVE_CANVAS)).length>0}}},configuration:RESERVE_CANVAS_CONFIG,scale:!1};var __defProp$A=Object.defineProperty,__getOwnPropDesc$z=Object.getOwnPropertyDescriptor,__decorateClass$z=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$z(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$A(t,r,i),i};class ReserveCanvasWidgetModel extends StructWidgetModel{constructor(){super(...arguments),__publicField(this,"placeholderRef",reactExports.createRef())}get sticky(){return this.props.sticky&&isNil$3(this.widget.parentContainerWidget)&&this.flattenChildWidgets.every((e=>e.type!==WIDGET_TYPE.IFRAME))}get autoHeight(){const{padLayout:e,phoneLayout:t}=this.mobileProps;return!!(isPad()?e:t)}get mobileLayoutConfig(){return{pad:{layout:this.props.padLayout?LAYOUT_TYPE$2.FLUID:LAYOUT_TYPE$2.RESERVE},phone:{layout:this.props.phoneLayout?LAYOUT_TYPE$2.FLUID:LAYOUT_TYPE$2.RESERVE}}}}__decorateClass$z([computed],ReserveCanvasWidgetModel.prototype,"sticky"),__decorateClass$z([computed],ReserveCanvasWidgetModel.prototype,"autoHeight"),__decorateClass$z([override],ReserveCanvasWidgetModel.prototype,"mobileLayoutConfig");const ReserveCanvasView$1=observer((({model:e,adaptiveScale:t,expandIndex:r})=>jsx(StructContainer,{className:"reserve-canvas-container",model:e,emptyTip:duchampIntl.get("Duchamp-Default_Reserve_Canvas_Text"),overflow:"auto",adaptiveScale:t,children:e.childWidgets.map((e=>jsx(WidgetWrapper,{widget:e,adaptiveScale:t,expandIndex:r},e.id)))})));function isSticky(e){return!!(null==e?void 0:e.sticky)&&!!(null==e?void 0:e.placeholderRef)}const StickyPlaceholder=observer((({widget:e})=>{const t=e.getInstance();return isSticky(t)?jsx("div",{ref:t.placeholderRef,style:{height:0,width:0}}):jsx(Fragment,{})})),WidgetRenderComponent$1=reactExports.forwardRef(((e,t)=>{const[r,n]=useUpdateValue$1(e,[e]),{widget:o,store:i,domRefs:a,width:s,height:l,adaptiveScale:c,expandIndex:u}=r,d=jsx(WidgetView,{widget:o,width:s,height:l,adaptiveScale:c,expandIndex:u});return reactExports.useImperativeHandle(t,(()=>({update:e=>{n(e)}}))),jsx(ErrorBoundary,{errorRender:e=>jsx(ErrorImageDisplay,{error:e,height:o.height}),children:jsx(StoreContext.Provider,{value:i,children:jsx(DomRefsContext.Provider,{value:a,children:jsx(DuchampProvider,{locale:getLanguage(),fetchInfo:getFetchInfo(i),children:d})})})})}));WidgetRenderComponent$1.displayName="WidgetRenderComponent";const WidgetRender$1=observer(WidgetRenderComponent$1);class RenderManager{constructor(){__publicField(this,"cacheMap",new Map)}attachStyle(e,{className:t,style:r}){e.className=classNames$1("single-root",t),e.style.cssText="",r&&Object.entries(r).forEach((([t,r])=>{e.style[t]=isNumber$5(r)?"".concat(r,"px"):String(r)}))}render(e,{widget:t,fromWidget:r=t,className:n,style:o,...i},a=!0){var s;const l={...o,width:i.width,height:i.height},c=this.cacheMap.get(t.id)||this.cacheMap.get(r.id);if(c)return r.id!==t.id&&(this.cacheMap.delete(r.id),this.cacheMap.set(t.id,c)),!e.contains(c.target)&&e.appendChild(c.target),this.attachStyle(c.target,{className:n,style:l}),void(null==(s=c.ref.current)||s.update({widget:t,...i}));const u=document.createElement("div"),d=reactExports.createRef(),h=jsx(reactExports.StrictMode,{children:jsx(WidgetRender$1,{ref:d,widget:t,...i})});if(e.appendChild(u),this.attachStyle(u,{className:n,style:l}),a){const e=createRoot$1(u);e.render(h),this.cacheMap.set(t.id,{root:e,target:u,ref:d})}else ReactDOM.render(h,u),this.cacheMap.set(t.id,{target:u,ref:d})}dispose(e){var t;const r=this.cacheMap.get(e);r&&(r.root?r.root.unmount():ReactDOM.unmountComponentAtNode(r.target),null==(t=r.target.parentNode)||t.removeChild(r.target),r.target.remove(),this.cacheMap.delete(e))}clear(){return this.cacheMap.forEach(((e,t)=>{this.dispose(t)})),this.cacheMap.clear(),new Promise((e=>{window.requestAnimationFrame((()=>{e()}))}))}retain(e){this.cacheMap.forEach(((t,r)=>{e.includes(r)||this.dispose(r)}))}}function isInstanceofZoomable(e){return!isNil$3(null==e?void 0:e.isZoomed)&&!isNil$3(null==e?void 0:e.toggleZoom)}function useRender(e,{widget:t,adaptiveScale:r,expandIndex:n,width:o,height:i,className:a,style:s,transitionFrame:l,isSingleRoot:c}){const u=useStore(),d=useDomRefs(),h=null!=c?c:isInstanceofZoomable(t.model),{widgetError:p}=t;return reactExports.useEffect((()=>{const c=e.current;c&&h&&u.renderManager.render(c,{widget:t,fromWidget:null==l?void 0:l.from,adaptiveScale:r,store:u,domRefs:d,className:a,style:s,width:o,height:i,expandIndex:n})}),[h,d,u,null==l?void 0:l.from,e,a,s,t,r,n,o,i,p]),h}const DEFAULT_LOAD_ANIMATION_HEIGHT=172,DEFAULT_LOAD_ANIMATION_IMAGE_HEIGHT=140,MAX_LOAD_ANIMATION_IMAGE_HEIGHT=320,MIN_LOAD_ANIMATION_IMAGE_HEIGHT=120,LoadingAnimation=({height:e,hue:t=0,saturation:r=0,contrast:n=0,brightness:o=0,opacity:i=100,percentage:a,scale:s=1})=>{const l=Math.floor(a),c=e?e/4:DEFAULT_LOAD_ANIMATION_HEIGHT,u=Math.max(MIN_LOAD_ANIMATION_IMAGE_HEIGHT,Math.min(c,MAX_LOAD_ANIMATION_IMAGE_HEIGHT))/DEFAULT_LOAD_ANIMATION_IMAGE_HEIGHT*s,d={...1!==u&&{transform:"scale(".concat(u,")"),transformOrigin:"center"},...getFilterStyle({hue:t,opacity:i,saturation:r,contrast:n,brightness:o})},h=useAssetUrl("/system/loading_animation_dark_blue.png");return jsxs("div",{className:"loading-animation-wrapper",style:d,children:[jsx("div",{className:"load-animation-image",children:jsx("div",{className:"load-animation-image-view",style:{backgroundImage:"url(".concat(h,")")}})}),jsxs("div",{className:"load-animation-content",children:[jsxs("div",{className:"loading-animation-text-container",children:[jsx("div",{className:"load-animation-percentage",children:"".concat(l,"%")}),jsx("div",{className:"load-animation-text",children:"LOADING..."})]}),jsx("div",{className:"load-animation-progress",children:jsx("div",{className:"load-animation-progress-container",children:jsx("div",{className:"load-animation-progress-finished",style:{width:"".concat(l,"%")}})})})]})]})},LoadingSimpleSpin=({type:e=LOADING_SPIN_TYPE.SPIN_ONE,hue:t=0,saturation:r=0,contrast:n=0,brightness:o=0,opacity:i=100,scale:a=1})=>jsx("div",{className:"simple-loading-spin",style:{...1!==a&&{transform:"scale(".concat(a,")"),transformOrigin:"center"}},children:jsx("div",{className:classNames$1("loading-spin","loading-spin-".concat(e)),style:getFilterStyle({hue:t,opacity:i,saturation:r,contrast:n,brightness:o}),children:jsx("div",{className:"loader"})})}),LoadingWidgetAlert=({className:e,widget:t,delay:r,loadConfig:n,loadProgress:o,isHeavyWidget:i,scale:a,...s})=>{if(!n)return;const l=i?n.heavyLoadConfig:n.normalLoadConfig;if(!(l&&l.enableLoad))return jsx(Fragment,{});const{resource:c,opacity:u,hue:d,saturation:h,contrast:p,brightness:f}=l;return jsx(Spin$1,{...s,center:!0,delay:i&&"animation"===c.type?0:r,className:classNames$1("duchamp-loading-alert",e),indicator:(()=>{if("spin"===c.type)return jsx(LoadingSimpleSpin,{type:c.value,hue:d,opacity:u,saturation:h,brightness:f,contrast:p,scale:a});const{height:e}=t.states,r=null!=o?o:0;return r>=100?jsx(Fragment,{}):jsx(LoadingAnimation,{percentage:r,height:e,hue:d,opacity:u,saturation:h,brightness:f,contrast:p,scale:a})})()})};var baseMerge$1=_baseMerge,createAssigner=_createAssigner$1,mergeWith$1=createAssigner((function(e,t,r,n){baseMerge$1(e,t,r,n)})),mergeWith_1=mergeWith$1;const mergeWith$2=getDefaultExportFromCjs$1(mergeWith_1);var baseFlatten=_baseFlatten,map=map_1;function flatMap(e,t){return baseFlatten(map(e,t),1)}var flatMap_1=flatMap;const flatMap$1=getDefaultExportFromCjs$1(flatMap_1),CONTROLLER_VALUE_TYPE={STRING:"string",DATE:"date",FIELD:"field",FORMULA:"formula",DATE_RANGE:"dateRange"},DATE_RANGE_TYPE={START_DATE:"startDate",END_DATE:"endDate"},VALUE_SOURCE$1=[{type:CONTROLLER_VALUE_TYPE.STRING,text:duchampIntl.get("Duchamp-Custom_String")},{type:CONTROLLER_VALUE_TYPE.DATE,text:duchampIntl.get("Duchamp-Custom_Date")},{type:CONTROLLER_VALUE_TYPE.FIELD,text:duchampIntl.get("Duchamp-Field")},{type:CONTROLLER_VALUE_TYPE.FORMULA,text:duchampIntl.get("Duchamp-Formula")},{type:CONTROLLER_VALUE_TYPE.DATE_RANGE,text:duchampIntl.get("Duchamp-Date_Range_Selector")}],DEFAULT_CONTROLLER_STYLE_PROPS={fontFamily:TEXT.FONT_FAMILY,fontAttr:{fontSize:12},color:"#FFFFFF"},DEFAULT_CONTROLLER_FONT_CONFIGURATION=[{name:"fontFamily",displayName:duchampIntl.get("Duchamp-Font_Style"),value:DEFAULT_CONTROLLER_STYLE_PROPS.fontFamily,type:"fontSelect"},{name:"fontAttr",displayName:"",value:DEFAULT_CONTROLLER_STYLE_PROPS.fontAttr,showTypes:{bold:!0,italic:!0},mobileProperties:["fontSize"],type:"title-style",prefixIcon:jsx(PlatformPopoverIcon,{})}],DEFAULT_CONTROLLER_STYLE_META={type:"default",displayName:duchampIntl.get("Duchamp-Default_Style"),configuration:[...DEFAULT_CONTROLLER_FONT_CONFIGURATION,{name:"color",displayName:"",value:DEFAULT_CONTROLLER_STYLE_PROPS.color,type:"colorSelect"}],themeTransfer:e=>({color:e.fontColorNormal})},DEFAULT_CONTROLLER_BORDER_LINE={borderStyle:"solid",borderWidth:1,borderColor:"#ADADADFF"},DEFAULT_CONTROLLER_AUTO_HEIGHT_CONFIG={name:"autoHeight",type:"autoHeight",displayName:"",value:!0,platforms:["mobile"],"data-focus-point":{id:"S265",trigger:"onChange",getParam:e=>({value:e?"1":"2"})}};function coverFieldConfigs(e,t){const r=new Map;return Object.entries(t).forEach((([t,n])=>{const o=e[t];isNil$3(o)||r.set(t,coverFieldConfig(o,n))})),Object.fromEntries(r)}function coverFieldConfig(e,t){return isObject$e(t)&&isObject$e(e)&&"type"in t&&"type"in e?e.type===CONTROLLER_VALUE_TYPE.DATE?t.type===CONTROLLER_VALUE_TYPE.DATE?t:e:t.type===CONTROLLER_VALUE_TYPE.DATE?e:t:e}var baseUniq$1=_baseUniq;function uniqWith(e,t){return t="function"==typeof t?t:void 0,e&&e.length?baseUniq$1(e,void 0,t):[]}var uniqWith_1=uniqWith;const uniqWith$1=getDefaultExportFromCjs$1(uniqWith_1);function getValueFieldConfig(e,t=!1,r=!1){return"string"===e.type?{type:"static",value:[e.payload.value]}:"date"===e.type?{type:"static",value:[e.payload.date]}:"field"===e.type?{type:"dataset",datasetName:e.payload.dataSet,columns:[{name:e.payload.field,...t?{}:{summary:"first"}}],payload:{repeatable:r}}:"formula"===e.type?{type:"formula",columns:[{formula:e.payload.formula}]}:e}function getDataFieldConfig(e,t,r){const{value:n,sortConfig:o}=e,{allowDuplicateRemoval:i}=settingCenter.controllerConfig,a=!i||e.repeatable,s=r?void 0:o;if("dataQuery"===n.type)return{type:"dataset",datasetName:n.datasetName,columns:[getColumn(n.itemValue),getColumn(n.itemText)],payload:{repeatable:a,sort:s}};if("dataTable"===n.type)return{type:"database",database:n.database,schema:n.schema,tableName:n.tableName,columns:[getColumn(n.itemValue),getColumn(n.itemText)],payload:{repeatable:a,sort:s}};if("formula"===n.type)return{type:"formula",columns:[{formula:n.itemValue.value},{formula:n.itemText.value,operatorIndex:0}],payload:{repeatable:a,sort:s}};if("customData"===n.type){const e=a?n.value:uniqWith$1(n.value,isEqual$4);return{type:"static",value:[e.map((e=>e.value)),e.map((e=>e.text))]}}return"widgetField"===n.type?{type:"tableField",sort:s,fields:[{table:n.table,field:n.field}]}:"auto"===n.type?getFieldConfigByRelatedFields(t,s):n}function getFieldConfigByRelatedFields(e,t){return{type:"tableField",canLinkByFilter:!0,sort:t,fields:e.map((e=>({table:e.table,field:e.field})))}}function getColumn(e){return"name"===e.type?{name:e.value}:"index"===e.type?{index:e.value}:"formula"===e.type?{formula:e.value,operatorIndex:0}:e}function getDateRangeConfig(e){return"formula"===e.type?{type:"formula",columns:[{formula:e.payload.formula}]}:"date"===e.type?{type:"static",value:[e.payload.date]}:null}var arraySupport$1={exports:{}};arraySupport$1.exports=function(e,t,r){var n=t.prototype,o=function(e){var t=e.date,n=e.utc;return Array.isArray(t)?n?t.length?new Date(Date.UTC.apply(null,t)):new Date:1===t.length?r(String(t[0])).toDate():new(Function.prototype.bind.apply(Date,[null].concat(t))):t},i=n.parse;n.parse=function(e){e.date=o.bind(this)(e),i.bind(this)(e)}};var arraySupportExports=arraySupport$1.exports;const arraySupport=getDefaultExportFromCjs$1(arraySupportExports);function isNilOrEmptyString$1(e){return isNil$3(e)||Number.isNaN(e)||""===e}function isDateTimeType(e){return(null==e?void 0:e.type)===CONTROLLER_VALUE_TYPE.DATE}function parse2String(e){return isNilOrEmptyString$1(e)?"":isDateTimeType(e)?parseTimestamp2String(e.value):e.toString()}function parse2Number(e){return isNilOrEmptyString$1(e)?0:toNumber$7(e)}function parse2Boolean(e){return!!e}function parse2Date(e){if(isNilOrEmptyString$1(e))return;if(has$2(e,"__time__"))return e.__time__;const t=e;if(isDateTimeType(t))return t.value;const r=dayjs(t).valueOf();return isNaN(r)?void 0:r}function parseSingle(e,t){switch(t){case"string":return parse2String(e);case"number":return parse2Number(e);case"boolean":return parse2Boolean(e);case"date":return parse2Date(e);case"dateRange":return{start:parse2Date(e.start),end:parse2Date(e.end)}}}function parse2List(e,t){if(isNilOrEmptyString$1(e))return[];if(isArray$c(e))return e;if("string"===(null==t?void 0:t.type)){const{splitor:r=",",startSymbol:n="",endSymbol:o=""}=t.payload;let i=parse2String(e);if(checkStartSymbol(i,n)&&checkEndSymbol(i,o))return i=i.substring(n.length),i=i.substring(0,i.lastIndexOf(o)),i.split(r)}return parse2String(e).split(",")}function listStringify(e,t){return"".concat(t.startSymbol).concat(Array.isArray(e)?e.map((e=>parse2String(e))).join(t.splitor):parse2String(e)).concat(t.endSymbol)}function checkStartSymbol(e,t){return""===t||e.startsWith(t)}function checkEndSymbol(e,t){return""===t||e.endsWith(t)}function parseTimestamp2String(e){return isNil$3(e)?"":dayjs(e).toString()}function replaceDatasetInValueConfig(e,t){var r,n,o;if("field"===e.type){const{dataSet:n,field:o}=e.payload,i=null==(r=t.table)?void 0:r[n];if(i){return{...e,payload:{dataSet:i.name,field:getReplacedFieldName(o,i.fields)}}}}else if("formula"===e.type)return{...e,payload:{formula:null!=(o=null==(n=t.formula)?void 0:n[e.payload.formula])?o:e.payload.formula}};return null}function replaceDatasetInDataConfig(e,t){var r,n,o,i,a,s;const l=cloneDeep$2(e);if("dataQuery"===(null==l?void 0:l.type)){const e=null==(r=t.table)?void 0:r[l.datasetName];return{...l,datasetName:null!=(n=null==e?void 0:e.name)?n:l.datasetName,itemValue:replaceFieldData(l.itemValue,e,t.formula),itemText:replaceFieldData(l.itemText,e,t.formula)}}if("formula"===(null==l?void 0:l.type)){const{itemValue:e,itemText:r}=l;return{...l,itemValue:{...e,value:null!=(i=null==(o=null==t?void 0:t.formula)?void 0:o[e.value])?i:e.value},itemText:{...r,value:null!=(s=null==(a=null==t?void 0:t.formula)?void 0:a[r.value])?s:r.value}}}return"dataTable"===(null==l?void 0:l.type)?{...l,itemText:replaceFieldData(l.itemText,void 0,t.formula)}:null}function replaceFieldData(e,t,r){var n;if("name"===e.type&&t){const r=e.value;return{...e,value:getReplacedFieldName(r,t.fields)}}return"formula"===e.type?{...e,value:null!=(n=null==r?void 0:r[e.value])?n:e.value}:e}function getReplacedFieldName(e,t){var r;return null!=(r=t[e])?r:e}function replaceDateConfigData(e,t){var r,n;if("formula"===e.type){const{formula:o}=e.payload;return{...e,payload:{...e.payload,formula:null!=(n=null==(r=null==t?void 0:t.formula)?void 0:r[o])?n:o}}}return e}dayjs.extend(arraySupport);const INTERNAL_VALIDATE={none:()=>!0,empty:e=>isNilOrEmptyString$1(e),length:(e,t)=>(null===t.max||e.length<=t.max)&&e.length>=t.min,email:e=>/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(e),idCard:e=>validateIDCard$1(e),postalCode:e=>/^[1-9][0-9]{5}$/.test(e),phone:(e,t)=>new RegExp(t.regex).test(e),mobile:e=>/^[1][3,4,5,7,8][0-9]{9}$/.test(e),regex:(e,t)=>new RegExp(t.regex).test(e)};function internalValidate(e,...t){const[r,n]=t;return INTERNAL_VALIDATE[r](e,n)}function formatValidate(e,t){return INTERNAL_VALIDATE[t.type](e,t.payload)}function validateIDCard$1(e){const t="".concat(e);if(15===t.length)return isValidityBrithBy15IdCard$1(t);if(18===t.length){const e=t.split("");return isValidityBrithBy18IdCard$1(t)&&isTrueValidateCodeBy18IdCard$1(e)}return!1}function isTrueValidateCodeBy18IdCard$1(e){const t=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2,1];let r=0;"x"===e[17].toLowerCase()&&(e[17]="10");for(let o=0;o<17;o++)r+=t[o]*parseInt(e[o],10);const n=r%11;return e[17]==="".concat([1,0,10,9,8,7,6,5,4,3,2][n])}function isValidityBrithBy18IdCard$1(e){const t=parseFloat(e.substring(6,10)),r=parseFloat(e.substring(10,12)),n=parseFloat(e.substring(12,14)),o=new Date(t,r-1,n);return o.getFullYear()===t&&o.getMonth()===r-1&&o.getDate()===n}function isValidityBrithBy15IdCard$1(e){const t=parseFloat(e.substring(6,8)),r=parseFloat(e.substring(8,10)),n=parseFloat(e.substring(10,12)),o=new Date(t,r-1,n);return o.getFullYear()%100===t&&o.getMonth()===r-1&&o.getDate()===n}function getDataWithPage(e){if(isObject$e(e)&&"hasNext"in e){const t=get$5(e,"value",[]);return isArray$c(t)?{items:t.map((e=>({value:e,text:e}))),hasNext:!!e.hasNext}:{items:[],hasNext:!1}}return null}function isSameValueTextConfig(e){return"auto"===e.type||"widgetField"===e.type||("dataQuery"===e.type||"dataTable"===e.type?isSameColConfig(e.itemText,e.itemValue):"formula"===e.type?"=$$$"===e.itemText.value||e.itemText.value===e.itemValue.value:e.value.every((e=>e.text===e.value)))}function isSameColConfig(e,t){return"formula"===e.type?"=$$$"===e.value:"name"===e.type?"name"===t.type&&e.value===t.value:"index"===e.type&&("index"===t.type&&e.value===t.value)}function getDataValue(e){if(isUndefined$3(e))return null;const t=getDataWithPage(e);if(t)return t.items;if(isDataDictionaryResult(e)){const t=[],r=e[0];if(isArray$c(r))r.forEach(((r,n)=>{const o=r.toString(),i=e[1][n].toString();i&&t.push({value:o,text:i})}));else{const n=e[1];n&&t.push({value:r.toString(),text:n.toString()})}return t}return null}function isDataDictionaryResult(e){return Array.isArray(e)&&2===e.length}function fuzzySearchDataDictionary(e,t){if(""===e)return t;const r=getSearchResult(t,e),n=r.match,o=r.find;return n.concat(o)}var __defProp$z=Object.defineProperty,__getOwnPropDesc$y=Object.getOwnPropertyDescriptor,__decorateClass$y=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$y(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$z(t,r,i),i};const PARAMETER_FIELD_NAME="valueConfig",DATE_INTERVAL_PARAMETER_FIELD_NAME_ARR=["startDateValueConfig","endDateValueConfig"],DEFAULT_CONTROLLER_PROPS={fontSize:12,enable:!0,validation:{allowEmpty:{open:!0,errorTip:""}},valueConfig:{type:CONTROLLER_VALUE_TYPE.STRING,payload:{value:""}},styleType:"default",styleConfig:DEFAULT_CONTROLLER_STYLE_PROPS,relatedParams:{[PARAMETER_FIELD_NAME]:""},relatedFields:[],relatedControllers:[],searchAllWhenEmpty:!0};function isValidateSuccess(e){return!0===e.success}function getCalculateSingleValue(e){return isArray$c(e)?e[0]:e}const CONTROLLER_REFRESHED=Symbol("controller-refreshed");class ControllerModel extends BaseWidgetModel{constructor(){super(...arguments),__publicField(this,"isGlobalParameter",!0),__publicField(this,"dataFieldName","dataDictionaryConfig"),__publicField(this,"dataType","string"),__publicField(this,"originalValue"),__publicField(this,"showDataOnInit",!0),__publicField(this,"calculation",{}),__publicField(this,"filterLinkageFieldNames",[this.dataFieldName]),__publicField(this,"verificationSuccess",!0)}setCalculation(e){this.calculation={...this.calculation,...e}}get relation(){const e=new Map;Object.entries(this.relatedParams).forEach((([t,r])=>{!isEmpty$3(r)&&e.set(r,t)}));const t=this.relatedFields.map((e=>({field:e.field,targetId:e.widget,table:e.table})));return{parameter:e,field:t,filterComponent:this.relatedControllers}}get filterFieldGroup(){return"dateRange"===this.dataType?[...DATE_INTERVAL_PARAMETER_FIELD_NAME_ARR,this.dataFieldName]:[PARAMETER_FIELD_NAME,this.dataFieldName]}getFilter(){const e=new Filter("and"),t=(t,r)=>{var n,o,i;switch(t){case PARAMETER_FIELD_NAME:e.updateParameterFilter(r,this.getValue(),!1,null==(n=this.props.formatConfig)?void 0:n.payload.type);break;case DATE_INTERVAL_PARAMETER_FIELD_NAME_ARR[0]:e.updateParameterFilter(r,this.getValue().start||"",!1,null==(o=this.props.formatConfig)?void 0:o.payload.type);break;case DATE_INTERVAL_PARAMETER_FIELD_NAME_ARR[1]:e.updateParameterFilter(r,this.getValue().end||"",!1,null==(i=this.props.formatConfig)?void 0:i.payload.type);break;default:return}};return Object.entries(this.relatedParams).forEach((([e,r])=>{t(e,r)})),this.relatedFields.forEach((t=>{e.updateFieldFilter(this.getFilterValueWithField(t.table,t.field),t.widget)})),this.relatedControllers.forEach((t=>{const r=this.relation.field.at(0);r&&e.updateFieldFilter(this.getFilterValueWithField(r.table,r.field),t)})),e}getFilterValueWithField(e,t){const r=this.getValue();return{field:t,value:""===r?null:r,table:e,invert:!1,trigger:this.id,searchAllWhenEmpty:this.searchAll}}getNeedLinkageItem(e){return e===this.dataFieldName?{field:PARAMETER_FIELD_NAME,value:()=>[this.getValue()]}:null}get valid(){return this.verificationSuccess}get value(){return this.parse(this.calculation.value)}get data(){return this.calculation.data||[]}get valueConfig(){return this.props.valueConfig}get extendValue(){return this.calculation.extend||{}}get referenceInfo(){var e;return{tableIds:null==(e=this.props.relatedFields)?void 0:e.map((e=>e.table)),parameterIds:Object.values(this.props.relatedParams||{})}}collectFonts(){const{styleConfig:e}=this.props;return[e.fontFamily]}get fieldConfigs(){return getFieldConfigs(this)}setWidgetError(e){this.widget.setWidgetError({...e,errorType:"warning"})}async setFieldValues(e,t){var r;super.setFieldValues(e,t);const n=null!=(r=e.get(PARAMETER_FIELD_NAME))?r:[this.calculation.value],o=e.get(this.dataFieldName),i=getDataValue(o);if(this.setCalculation({value:""}),i&&(this.setData(i),"init"!==t.type&&this.fireEvent("resetData")),!isUndefined$3(n)){const e=getCalculateSingleValue(n);if("init"===t.type)await this.setValueWithoutValidate(e);else{const t=o?await this.filterValueByDataset(this.parse(e)):e;await this.setValue(t,!1)}e&&(this.originalValue=this.getValue()||void 0)}this.fireEvent(CONTROLLER_REFRESHED)}replaceData(e){super.replaceData(e);const{replacement:t}=e,{dataDictionaryConfig:r,valueConfig:n}=this.props,o=replaceDatasetInValueConfig(n,t);if(o&&this.setProps({valueConfig:o}),r){const e=replaceDatasetInDataConfig(r.value,t);e&&this.setProps({dataDictionaryConfig:{...r,value:e}})}}get isUnset(){return controllerIsUnset(this.props.valueConfig)}get name(){return this.widget.name}get relatedParams(){var e;return null!=(e=toJS(this.props.relatedParams))?e:{}}get relatedFields(){var e;return null!=(e=toJS(this.props.relatedFields))?e:[]}get relatedControllers(){var e;return null!=(e=toJS(this.props.relatedControllers))?e:[]}setRelatedFields(e){this.setProps({relatedFields:e}),this.dataConfig&&"auto"!==this.dataConfig.value.type||this.refresh()}setRelatedControllers(e){this.setProps({relatedControllers:e})}get widgetId(){return this.widget.id}get fontSize(){return this.styleConfig.fontAttr.fontSize}get enable(){return this.props.enable}get authority(){return this.props.enable}get placeholder(){return this.props.placeholder||""}get validation(){return toJS(this.props.validation)}get defaultValue(){return toJS(this.props.valueConfig)}get watermark(){return this.props.placeholder}get parseDataValue(){var e;return null==(e=this.props.parseDateConfig)?void 0:e.type}get formatConfig(){return toJS(this.props.formatConfig)}get dataConfig(){return toJS(this.props.dataDictionaryConfig)}get selectAll(){return this.props.showSelectAll}get searchAll(){var e;return null==(e=this.props.searchAllWhenEmpty)||e}get parseValueConfig(){return toJS(this.props.parseValueConfig)}get style(){return{styleType:this.props.styleType,styleConfig:toJS(this.props.styleConfig)}}get styleConfig(){return toJS(this.props.styleConfig)}get fontStyle(){return{iconColor:this.props.styleConfig.iconColor||this.store.styleConfig.widget.controller.content.styleConfig.iconColor,fontFamily:this.props.styleConfig.fontFamily,...this.props.styleConfig.fontAttr,color:hexToRgba(this.props.styleConfig.color)}}parse(e){return parseSingle(e,this.dataType)}get allowEmpty(){var e;return!!(null==(e=this.props.validation.allowEmpty)?void 0:e.open)}get customValue(){var e;return!!(null==(e=this.props.validation.customValue)?void 0:e.open)}isSameNameWidget(e){return e.name.toLocaleUpperCase()===this.name.toLocaleUpperCase()&&e.id!==this.widget.id}setFieldConfigByRelatedParam(e){this.setProps(coverFieldConfigs(this.props,e))}applyConfigsBySameRelatedParam(){if(this.storyIndex<0)return;const e=new Map;for(const[t,r]of Object.entries(this.relatedParams))for(const n of this.store.allControllerWidgets){if(this.id===n.id)continue;const o=n.getInstance();o.relation.parameter.forEach(((n,i)=>{if(this.calculateCenter.parameterCenter.sameName(r,i)){const r=o.widget.props[n];isNil$3(r)||e.set(t,toJS(r))}}))}this.setFieldConfigByRelatedParam(Object.fromEntries(e))}syncConfigsBySameRelatedParam(){if(!(this.storyIndex<0))for(const e of this.store.allControllerWidgets){if(this.id===e.id)continue;const t=e.getInstance();for(const[e,r]of Object.entries(t.relatedParams))this.relation.parameter.forEach(((n,o)=>{if(this.calculateCenter.parameterCenter.sameName(r,o)){const r=this.widget.props[n];r&&t.setFieldConfigByRelatedParam({[e]:toJS(r)})}}))}}initializationRelatedParams(){var e;const t=Object.values(this.relatedParams),r=flatMap$1(null==(e=this.story)?void 0:e.widgets,(e=>{if(!widgetIsParameter(e))return[];const r=e.getInstance();return e.id===this.id?[]:Object.values(r.relatedParams).filter((e=>t.includes(e)))}));r.length>0&&this.setProps({relatedParams:mapValues$1(toJS(this.relatedParams),(e=>r.includes(e)?"":e))})}setName(e){this.widget.setName(e)}setRelatedParams(e){const t=flatten$1(this.store.allControllerWidgets.map((e=>{const t=e.getInstance();return e.id===this.id?[]:Object.values(t.relatedParams)}))),r=Object.values(this.relatedParams).filter((r=>!Object.values(e).includes(r)&&!t.includes(r))),n=toJS(this.relatedParams);return this.setProps({relatedParams:e}),this.applyConfigsBySameRelatedParam(),this.refresh().then((()=>{const e={parameter:new Map(r.map((e=>[e,""]))),field:[],filterComponent:[]};return r.length<=0?Promise.resolve():this.calculateCenter.linkageByFilterDelete([{trigger:this.id,relation:e}])})).catch((e=>{catchCircularDependencyError(e,(()=>{this.setProps({relatedParams:n})}))}))}setPropsValueConfig(e){e.type===CONTROLLER_VALUE_TYPE.DATE?this.setProps({valueConfig:{type:CONTROLLER_VALUE_TYPE.STRING,payload:{value:parseTimestamp2String(e.payload.date)}}}):this.setProps({valueConfig:e})}setDefaultValue(e){const t=this.props.valueConfig;return this.setPropsValueConfig(e),this.refresh().then((()=>{this.syncConfigsBySameRelatedParam()})).catch((e=>{catchCircularDependencyError(e,(()=>{this.setPropsValueConfig(t)}))}))}setCalculationProps(e,t){const r=this.props[e];return this.setProps({[e]:t}),this.refresh().catch((()=>{this.setProps({[e]:r})}))}resetStyleConfigWhenFormatChange(e){}setFormatConfig(e){this.setCalculationProps("formatConfig",e),this.resetStyleConfigWhenFormatChange(e)}setParseDataValue(e){this.setCalculationProps("parseDateConfig",{type:e})}setParseValueConfig(e){this.setCalculationProps("parseValueConfig",e)}setDataConfig(e){const t=this.props.dataDictionaryConfig;return this.setProps({dataDictionaryConfig:e}),this.refresh().catch((e=>{catchCircularDependencyError(e,(()=>{this.setProps({dataDictionaryConfig:t})}))}))}setAuthority(e){this.setProps({enable:e})}setWatermark(e){this.setProps({placeholder:e})}setValidation(e){this.setProps({validation:{...this.validation,...e}})}getExtend(){return toJS(this.props.extend)||{}}setExtend(e,t){return this.setProps({extend:cloneDeep$2({...this.props.extend,...e})}),t?this.refresh():Promise.resolve()}setControllerValue(e,t=!0){return this.setCalculation({value:e}),t?this.emitValueChange():Promise.resolve()}setData(e){this.setCalculation({data:e})}updateRelationalValue(e){this.setCalculation({value:e})}setExtendValue(e){e&&this.setCalculation({extend:e})}async setValue(e,t=!0){const r=this.parse(e),n=await this.validate(r);return isValidateSuccess(n)?(this.clearWarning(),await this.setControllerValue(r,t),this.verificationSuccess=!0):(n.valueChanged?Message.error(n.errorMessage):this.setWarning({message:n.errorMessage}),await this.setControllerValue(n.value,t&&n.valueChanged),this.verificationSuccess=!1),this.fireEvent(CONTROLLER_REFRESHED),n}async checkValue(){const e=await this.validate(this.value);return isValidateSuccess(e)?(this.clearWarning(),this.verificationSuccess=!0):(e.valueChanged||this.setWarning({message:e.errorMessage}),this.verificationSuccess=!1),this.verificationSuccess}async filterValueByDataset(e){return e}setStyle({name:e,styleType:t,styleConfig:r}){const n=toJS(this.mobile.props),o=toJS(this.widget.props),i=!isEmpty$3(t)&&this.props.styleType!==t,a=widgetManager.getExtendStyle(this.type,t);isEmpty$3(r)||this.store.undoManager.withGroup((()=>{var s,l,c;if(!(null==a?void 0:a.configuration))return;if(i){if(this.isMobile)this.setMobileProps({styleType:t,styleConfig:r});else{const e=a&&(!a.platforms||(null==(s=a.platforms)?void 0:s.includes(PLATFORM.MOBILE)));n.styleType||this.setMobileProps({styleConfig:{}}),e||this.mobile.setValue({styleType:this.mobileProps.styleType,styleConfig:this.mobileProps.styleType}),this.setProps({styleType:t,styleConfig:r,fontSize:null==(l=null==r?void 0:r.fontAttr)?void 0:l.fontSize})}return}if(n.styleType)return void(this.isMobile?this.setMobileProps({styleType:t,styleConfig:r}):this.setProps({styleType:t,styleConfig:r,fontSize:null==(c=null==r?void 0:r.fontAttr)?void 0:c.fontSize}));if(!e)return;const u=get$5(r,e),d=transformConfigurationValue({name:e,value:u,configuration:a.configuration,lastPCProps:o.styleConfig||{},lastMobileProps:n.styleConfig||{},isMobile:this.isMobile});isNil$3(d.mobile)||set$3(n,["styleConfig",e].join("."),d.mobile),isNil$3(d.pc)||set$3(o,["styleConfig",e].join("."),d.pc),this.setMobileProps({styleConfig:n.styleConfig}),this.setProps({styleConfig:o.styleConfig,fontSize:o.styleConfig.fontAttr.fontSize})}))}async setValueWithoutValidate(e){const t=this.parse(e);this.clearWarning(),await this.setControllerValue(t,!1)}getValue(){var e;return"string"===(null==(e=this.props.parseValueConfig)?void 0:e.type)&&isArray$c(this.value)?listStringify(this.value,this.props.parseValueConfig.payload):this.value}onResetData(e){return this.addEventListener("resetData",e),()=>{this.removeEventListener("resetData",e)}}validateFormat(e){return this.validation.format&&"none"!==this.validation.format.type&&!formatValidate(e,this.validation.format)?{success:!1,valueChanged:!1,errorMessage:this.validation.format.errorTip||duchampIntl.get("Duchamp-Does_Not_Meet_The_Format_Specification"),value:e}:{success:!0}}isValueEmpty(e){return isArray$c(e)?0===e.length:internalValidate(parse2String(e),"empty")}async validate(e){if(!this.isPreview)return{success:!0};if(this.isValueEmpty(e))return this.validation.allowEmpty.open?{success:!0}:{success:!1,valueChanged:!1,errorMessage:this.validation.allowEmpty.errorTip||duchampIntl.get("Duchamp-Can_Not_Empty"),value:e};const t=await this.validateData(e);if(!t.success)return t;const r=this.validateFormat(e);return r.success?{success:!0}:r}async validateData(e){return{success:!0}}onMount(){}onEdit(e){this.widget.trigger({trigger:WIDGET_EVENT.EDIT})}onFinish(e){this.originalValue=e,this.setValue(e).finally((()=>{this.isPreview&&(this.widget.trigger({trigger:WIDGET_EVENT.EDIT_FINISH}),this.fireEvent(WIDGET_EVENT.AFTER_FINISH))}))}setOriginalValue(e){this.originalValue=e}getText(){return this.value}isEnabled(){return this.enable}reset(){this.setValue(),this.originalValue=void 0}get showSelectAll(){var e;return null==(e=this.props.showSelectAll)||e}setSelectAll(e){this.setProps({showSelectAll:e})}setSearchAll(e){this.setProps({searchAllWhenEmpty:e}),this.calculateCenter.linkageGlobal(this.getFilter(),[this.id])}getControllerConfigOptions(){return{}}getThemeStyle(e,t){var r;const{widgetManager:n}=this.duchampServer,o=null==n?void 0:n.getExtendStyle(this.type,t);return o?null==(r=o.themeTransfer)?void 0:r.call(o,e):{}}async onThemeChange(e){var t;this.widget.setBorderLine({...this.widget.borderLine,borderColor:e.borderColorNormal}),(null==(t=this.mobile.borderLine)?void 0:t.borderColor)&&this.mobile.setBorderLine({...this.mobile.borderLine,borderColor:e.borderColorNormal}),this.setProps({styleConfig:merge$1(this.styleConfig,this.getThemeStyle(e,this.props.styleType))}),this.mobile.props.styleType&&this.setMobileProps({styleConfig:merge$1(toJS(this.mobile.props.styleConfig),this.getThemeStyle(e,this.mobile.props.styleType))})}mergeProps(e,t){const{styleType:r,...n}=t;if(r)return{...e,styleType:r,styleConfig:{...e.styleConfig,...n.styleConfig}};const o=widgetManager.getExtendStyle(this.type,e.styleType);return(null==o?void 0:o.mergeProps)?mergeWith$2({},e,n,((e,t,r,i,a)=>{if("styleConfig"===r&&(null==o?void 0:o.mergeProps)&&n===a)return o.mergeProps(e,t||{})})):super.mergeProps(e,n)}}function getFieldConfigs(e,t=!1,r=!1){const n=e.props.dataDictionaryConfig,o=new Map;if(e.isUnset?o.set("valueConfig",{type:"static",value:""}):o.set("valueConfig",getValueFieldConfig(e.props.valueConfig,t,!!(null==n?void 0:n.repeatable))),n){const t=getDataFieldConfig(n,e.relatedFields);o.set("dataDictionaryConfig",{...t,computeConfig:{disable:({bindParams:t})=>{const r=e.isUnset&&!t,{customValue:o={open:!0}}=e.props.validation;return!e.showDataOnInit&&(r||o.open&&isSameValueTextConfig(n.value))&&!e.calculation.data}}})}else r&&settingCenter.controllerConfig.source.includes(SETTING_CONTROLLER_SOURCE_TYPE.AUTO)&&o.set("dataDictionaryConfig",getFieldConfigByRelatedFields(e.relatedFields));return o}function controllerIsUnset(e){return e.type===CONTROLLER_VALUE_TYPE.STRING?""===e.payload.value:e.type===CONTROLLER_VALUE_TYPE.FIELD?""===e.payload.field:e.type===CONTROLLER_VALUE_TYPE.FORMULA?""===e.payload.formula:e.type===CONTROLLER_VALUE_TYPE.DATE&&isNil$3(e.payload.date)}function catchCircularDependencyError(e,t){e instanceof CircularDependencyError&&(Message.error(duchampIntl.get("Duchamp-Calculation_Circular_Dependency")),t())}__decorateClass$y([observable.ref],ControllerModel.prototype,"calculation",2),__decorateClass$y([action$1],ControllerModel.prototype,"setCalculation",1),__decorateClass$y([content()],ControllerModel.prototype,"name",1),__decorateClass$y([content()],ControllerModel.prototype,"relatedParams",1),__decorateClass$y([content()],ControllerModel.prototype,"relatedFields",1),__decorateClass$y([content()],ControllerModel.prototype,"relatedControllers",1),__decorateClass$y([content()],ControllerModel.prototype,"authority",1),__decorateClass$y([content()],ControllerModel.prototype,"validation",1),__decorateClass$y([content()],ControllerModel.prototype,"defaultValue",1),__decorateClass$y([content()],ControllerModel.prototype,"watermark",1),__decorateClass$y([content()],ControllerModel.prototype,"parseDataValue",1),__decorateClass$y([content()],ControllerModel.prototype,"formatConfig",1),__decorateClass$y([content()],ControllerModel.prototype,"dataConfig",1),__decorateClass$y([content()],ControllerModel.prototype,"selectAll",1),__decorateClass$y([content()],ControllerModel.prototype,"searchAll",1),__decorateClass$y([content()],ControllerModel.prototype,"parseValueConfig",1),__decorateClass$y([content()],ControllerModel.prototype,"style",1),__decorateClass$y([computed],ControllerModel.prototype,"fontStyle",1),__decorateClass$y([jsApi("setEnable")],ControllerModel.prototype,"setAuthority",1),__decorateClass$y([jsApi("setWaterMark")],ControllerModel.prototype,"setWatermark",1),__decorateClass$y([action$1],ControllerModel.prototype,"setControllerValue",1),__decorateClass$y([action$1],ControllerModel.prototype,"setData",1),__decorateClass$y([action$1],ControllerModel.prototype,"setExtendValue",1),__decorateClass$y([observable],ControllerModel.prototype,"verificationSuccess",2),__decorateClass$y([jsApi()],ControllerModel.prototype,"setValue",1),__decorateClass$y([jsApi()],ControllerModel.prototype,"getValue",1),__decorateClass$y([jsApi()],ControllerModel.prototype,"getText",1),__decorateClass$y([jsApi()],ControllerModel.prototype,"isEnabled",1),__decorateClass$y([jsApi()],ControllerModel.prototype,"reset",1);var arrayFilter$1=_arrayFilter,arrayMap$2=_arrayMap$1,baseProperty$1=_baseProperty,baseTimes$1=_baseTimes$1,isArrayLikeObject=isArrayLikeObject_1,nativeMax$3=Math.max;function unzip$1(e){if(!e||!e.length)return[];var t=0;return e=arrayFilter$1(e,(function(e){if(isArrayLikeObject(e))return t=nativeMax$3(e.length,t),!0})),baseTimes$1(t,(function(t){return arrayMap$2(e,baseProperty$1(t))}))}var unzip_1=unzip$1,apply$1=_apply$1,arrayMap$1=_arrayMap$1,unzip=unzip_1;function unzipWith$1(e,t){if(!e||!e.length)return[];var r=unzip(e);return null==t?r:arrayMap$1(r,(function(e){return apply$1(t,void 0,e)}))}var unzipWith_1=unzipWith$1,baseRest$1=_baseRest$1,unzipWith=unzipWith_1,zipWith=baseRest$1((function(e){var t=e.length,r=t>1?e[t-1]:void 0;return r="function"==typeof r?(e.pop(),r):void 0,unzipWith(e,r)})),zipWith_1=zipWith;const zipWith$1=getDefaultExportFromCjs$1(zipWith_1),LIMIT_COUNT=500;function getDataByPagination(e,t){const r=LIMIT_COUNT*(t.times-1);let n=LIMIT_COUNT*t.times;t.loadTotal&&(n=e.length);return{items:cloneDeep$2(e.slice(r,n)),hasNext:e.length>n}}var __defProp$y=Object.defineProperty,__getOwnPropDesc$x=Object.getOwnPropertyDescriptor,__decorateClass$x=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$x(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$y(t,r,i),i};class ListControllerModel extends ControllerModel{constructor(){super(...arguments),__publicField(this,"ref",null),__publicField(this,"isSelectAll",!1),__publicField(this,"showDataOnInit",!1)}setRef(e){this.ref=e}setIsSearchAll(e){this.isSelectAll=e}get multiSelect(){return!!this.props.multiSelect}setMultiSelect(e){this.store.undoManager.withGroup((()=>{e?this.setProps({multiSelect:e,showSelectAll:!0,parseValueConfig:{type:"array"}}):this.setProps({multiSelect:e,parseValueConfig:void 0,showSelectAll:!1}),this.triggerMultiSelectReaction(e),this.refresh()}))}triggerMultiSelectReaction(e){}parse(e){const t=this.data.map((e=>parseSingle(e.value,this.dataType))),r=this.data.map((e=>parseSingle(e.text,this.dataType)));return this.multiSelect?parse2List(e,this.props.parseValueConfig).map((e=>this.parseValueFromData(e,t,r))):this.parseValueFromData(e,t,r)}parseValueFromData(e,t,r){var n;const o=parseSingle(e,this.dataType);if(t.includes(o))return o;const i=r.findIndex((e=>e===o));return-1!==i?null==(n=this.data[i])?void 0:n.value:o}async filterValueByDataset(e){const t=await this.fetchData(),[r,n]=this.filterValue(e,t);return r.length>0?Array.isArray(e)?n:"":e}textFinder(e){const t=this.data.find((t=>this.dataFinder(e,t)));return isNil$3(t)?e:t.text}dataFinder(e,t){return parseSingle(t.value,this.dataType)===e||parseSingle(t.text,this.dataType)===e}filterValue(e,t){const r=Array.isArray(e)?e:[e],n=t.map((e=>parseSingle(e.text,this.dataType))),o=t.map((e=>parseSingle(e.value,this.dataType))),i=r.filter((e=>n.includes(e)||o.includes(e)));return[r.filter((e=>!i.includes(e))),i]}handleCustomValue(e,t,r){var n;return(null==(n=this.validation.customValue)?void 0:n.open)?(this.setData([...this.data,...t.map((e=>({text:e,value:e})))]),{success:!0}):{success:!1,valueChanged:!0,errorMessage:this.validation.customValue?this.validation.customValue.errorTip||duchampIntl.get("Duchamp-Custom_Values_Are_Not_Allowed"):duchampIntl.get("Duchamp-Operation_Error_And_No_Legal_Value"),value:Array.isArray(e)?r:""}}async validateData(e){const t=await this.fetchData(),[r,n]=this.filterValue(e,t);return r.length>0?this.handleCustomValue(e,r,n):{success:!0}}get fieldConfigs(){return getFieldConfigs(this,this.multiSelect,!0)}getControllerConfigOptions(){return{parseValueConfig:{hide:!this.multiSelect},selectAll:{hide:!this.multiSelect}}}getText(){var e;if(Array.isArray(this.value)){const t=this.value.map((e=>this.textFinder(e))),r="string"===(null==(e=this.props.parseValueConfig)?void 0:e.type)?this.props.parseValueConfig.payload.splitor:",";return t.join(r)}return this.textFinder(this.value)}getDataDictionary(e){return new Promise((t=>{!settingCenter.controllerConfig.source.includes(SETTING_CONTROLLER_SOURCE_TYPE.AUTO)||this.dataConfig&&"auto"!==this.dataConfig.value.type&&"widgetField"!==this.dataConfig.value.type?e.keyword?this.searchData(e.keyword).then((r=>{t(getDataByPagination(r,e))})):this.fetchData().then((r=>{t(getDataByPagination(r,e))})):this.getDataListByPage(e).then((e=>{t(e)}))}))}async searchData(e){const t=this.dataFieldName,r=this.fieldConfigs.get(t);if(r&&isStaticFieldConfig(r)){const t=r.value;return fuzzySearchDataDictionary(e,zipWith$1(...t,((e,t)=>({value:e,text:t}))))}if(r){const n="".concat(this.id,".").concat(t);r.payload={...r.payload,filter:{content:e}};const o=await this.calculateCenter.calculateFieldConfigs(new Map([[n,r]]),!1,!1,this.calculateCenter.getFilter(this.id).getParameterFiltersObject());for(const e of o.values())if(this.preprocessWidgetError(e),this.widget.widgetError)break;const i=getDataValue(o.get(n));return null!=i?i:[]}return[]}async fetchData(){if(0===this.data.length){const e=await this.searchData("");this.setData(e)}return this.data}getFilterValueWithField(e,t){return{field:t,value:this.isSelectAll?this.originalValue:(()=>isNil$3(this.originalValue)?null:this.getValue())(),table:e,invert:this.isSelectAll,searchAllWhenEmpty:this.searchAll,trigger:this.id}}async addData(e){await this.fetchData(),this.data.some((t=>t.value===e))||this.setData([...this.data,{text:e,value:e}])}async getDataListByPage(e){const t=this.dataFieldName,r=this.fieldConfigs.get(this.dataFieldName);if(!r)return{items:[],hasNext:!1};const n="".concat(this.id,".").concat(t);r.payload={...r.payload,...e};const o=getDataWithPage((await this.calculateCenter.calculateFieldConfigs(new Map([[n,r]]),!1,!1)).get(n));return o||{items:[],hasNext:!1}}}function isControllerModel(e){return e instanceof ControllerModel}__decorateClass$x([content()],ListControllerModel.prototype,"multiSelect"),__decorateClass$x([jsApi()],ListControllerModel.prototype,"getText");const WidgetTurboFrameWidget=reactExports.forwardRef((({widget:e,transitionFrame:t,children:r,enableTransform3d:n=!0,enableBoxShadow:o=!0,enableReflect:i=!0,adaptiveScale:a},s)=>{const l=useStore(),c=timeUnitToMillisecond(oldTime2TimeMillisecond(l.mainStory.transition.duration)),u=reactExports.useMemo((()=>{var t;return n?getTransformOrigin(e.model.states,{origin:null==(t=e.parentWidget)?void 0:t.model.states,adaptiveScale:a}):void 0}),[n,e,a]),d=e.busying,[h]=useTransitionState((null==t?void 0:t.from)||e,null==t?void 0:t.to),{needRecalculate:p}=e.model;return jsxs(CompositeFrame,{transition:t?c:void 0,scale:a?convertAdaptiveScaleToTransformScale(a):void 0,transform3d:n?toJS(h.transform3d):void 0,transformOrigin:u,backdropFilter:toJS(h.platform.backdropFilter),boxReflect:i?toJS(h.platform.boxReflect):void 0,boxShadowEffect:o?toJS(h.platform.boxShadowEffect):void 0,opacity:h.platform.opacity,padding:toJS(h.platform.padding),borderRadius:toJS(h.platform.borderRadius),borderLine:toJS(h.platform.borderLine),background:{border:toJS(h.platform.border),borderHue:h.platform.borderHue,borderSaturation:h.platform.borderSaturation,borderBrightness:h.platform.borderBrightness,borderContrast:h.platform.borderContrast,borderOpacity:h.platform.borderOpacity,borderScale:h.platform.borderScale,fillType:h.platform.fillType,backgroundFillType:h.platform.backgroundFillType},resourceCenter:l.resourceCenter,urlParser:e=>createResourceURL(e,l.duchampServer.resourceBaseUrl),overflow:isGhostStructureWidget(e)||(isControllerModel(e.model)||widgetIsWorkbook(e.type))&&!l.platform.isMobile&&e.model.isPreview?"visible":"hidden",className:classNames$1("duchamp-widget-setter-wrapper",{"controller-wrapper":isControllerModel(e.model),"error-wrapper":e.warning}),ref:s,children:[!e.initializing&&(!p||!isNil$4(t))&&r,d&&jsx(LoadingWidgetAlert,{scale:a?convertAdaptiveScaleToTransformScale(a):void 0,widget:e,delay:l.widgetLoadingDelay,loadConfig:l.loadConfig.widget,loadProgress:e.model.loadProgress,isHeavyWidget:widgetIsHeavyComponent(e.type)})]})}));WidgetTurboFrameWidget.displayName="WidgetTurboFrameWidget";const WidgetTurboFrame=observer(WidgetTurboFrameWidget);function usePointerFocus(e,t,r){reactExports.useEffect((()=>{const n=getTargetElement$2(e);if(!t||!n)return;let o=null;const i=e=>{o!==e&&(t(e),o=e)},a=isNil$3(r)?null:debounce$4((()=>{i(!1)}),r),s=()=>{i(!0),null==a||a()},l=()=>{i(!1)};return n.addEventListener("mouseenter",s),n.addEventListener("mousemove",s),n.addEventListener("mouseleave",l),()=>{n.removeEventListener("mouseenter",s),n.removeEventListener("mousemove",s),n.removeEventListener("mouseleave",l),null==a||a.cancel()}}),[r,t,e])}function isInstanceofRollable(e){const t=e;return!isNil$3(null==t?void 0:t.pauseRollPlay)&&!isNil$3(null==t?void 0:t.continueRollPlay)&&!isNil$3(null==t?void 0:t.stopOnHover)}function useRollPlay(e,t,r){const n=t.getInstance();usePointerFocus(e,isInstanceofRollable(n)&&n.stopOnHover?e=>{e?n.pauseRollPlay():n.continueRollPlay()}:void 0,r)}const ZOOM_DEFAULT_COLOR="#100b2b",ZoomContainer=observer((({widget:e,children:t,adaptiveScale:r})=>{var n;const{story:o}=useStore(),{zoomRef:i}=useDomRefs(),a=reactExports.useRef(null),s=reactExports.useRef(null),l=reactExports.useRef(null),c=useMergedRefs(t.ref,l),u=e.getInstance(),{isZoomed:d,widget:{states:{width:h,height:p}}}=u,f=useZoomScale({width:h,height:p,isZoomed:d,adaptiveScale:r}),g=null!=(n=o.platform.backgroundLayer.color)?n:ZOOM_DEFAULT_COLOR;return reactExports.useEffect((()=>{var t,r,n,o;const i=l.current;i&&(d?!(null==(t=s.current)?void 0:t.contains(i))&&(null==(r=s.current)||r.appendChild(i)):!(null==(n=e.target)?void 0:n.contains(i))&&(null==(o=e.target)||o.appendChild(i)))}),[d,e.target]),reactExports.useEffect((()=>{const e=s.current,t=l.current;return()=>{t&&(null==e?void 0:e.contains(t))&&t.remove()}}),[]),jsxs(Fragment,{children:[reactExports.cloneElement(t,{ref:c}),(null==i?void 0:i.current)&&f&&reactDomExports.createPortal(jsx("div",{className:"zoom-mask",onClick:e=>{e.target===a.current&&u.toggleZoom(!1)},ref:a,children:jsx("div",{className:"wrapper",style:{background:g,...calculateAdaptiveScaleStyle({style:{width:h,height:p},adaptiveScale:f,withTransform:!1})},ref:s})}),i.current)]})})),WidgetRenderComponent=reactExports.forwardRef((({widget:e,children:t,adaptiveScale:r,enableRecoveryInterval:n=!0,...o},i)=>{const a=useStore(),s=reactExports.useRef(null),l=useMergedRefs(s,i),c=jsx(WidgetTurboFrame,{ref:l,widget:e,adaptiveScale:r,...o,children:t});return useRollPlay(s,e,n&&a.widgetFillCanvas(e)?3e3:void 0),jsx(WidgetError,{widget:e,adaptiveScale:r,children:isInstanceofZoomable(e.model)?jsx(ZoomContainer,{adaptiveScale:r,widget:e,children:c}):c})}));WidgetRenderComponent.displayName="WidgetRenderComponent";const WidgetRender=observer(WidgetRenderComponent),PreviewViewComponent=reactExports.forwardRef((({widget:e,width:t,height:r,className:n,style:o,expandIndex:i,adaptiveScale:a,transitionFrame:s,contentClassName:l,contentStyle:c,openLazyRender:u,isSingleRoot:d,enableTransform3d:h,enableReflect:p,enableBoxShadow:f,enableRecoveryInterval:g,children:m,...y},v)=>{const _=reactExports.useRef(null),b=reactExports.useRef(null),C=useMergedRefs(_,v),{lazy:E}=useLazyRender(_,u),{widgetIsRenderWithoutScale:T}=e.getInstance(),S=!useRender(b,{widget:e,width:t,height:r,className:l,style:c,expandIndex:i,adaptiveScale:a,transitionFrame:s,isSingleRoot:d&&!E})&&jsx(WidgetView,{widget:e,adaptiveScale:a,expandIndex:i,width:t,height:r});return jsx("div",{ref:C,className:classNames$1("duchamp-preview-mode",n),style:o,...y,children:!E&&jsx(Fragment,{children:m||jsx(WidgetRender,{widget:e,ref:b,adaptiveScale:a,transitionFrame:s,enableTransform3d:h,enableReflect:p,enableBoxShadow:f,enableRecoveryInterval:g,children:S&&(r||T?jsx("div",{className:l,style:c,children:S}):jsx(AutoHeightWrapper,{adaptiveScale:a,className:l,children:S}))})})})}));PreviewViewComponent.displayName="PreviewViewComponent";const PreviewView=observer(PreviewViewComponent),useSize=(e,t)=>{const r=isInstanceofZoomable(e.model)&&e.model.isZoomed,{width:n,height:o}=e.platform.states,i=useZoomScale({width:n,height:o,isZoomed:r,adaptiveScale:t});return reactExports.useMemo((()=>({size:{width:n,height:o},adaptiveScale:i||t})),[n,o,t,i])};function useFrameCommunication(e){const{ref:t,type:r,extraHeight:n=0,adaptiveMode:o,sessionID:i,toolHeightManager:a}=e,s=useSize_1(t),l=useMemoizedFn(debounce$4(((e,a)=>{var s;const l=getTargetElement$2(t),c=(null!=(s=null==l?void 0:l.getBoundingClientRect().height)?s:0)+a+n,u={fine_message:{src:e,type:r,contentHeight:Math.ceil(c),sessionID:i},duchamp_message:{adaptiveMode:o}};i?window.postMessage(JSON.stringify(u),"*"):postMessage(u)}),300));reactExports.useEffect((()=>{var e,t,r;if(!isInIframe()&&!s.height)return;const n=(null==(t=null==(e=window.frameElement)?void 0:e.dataset)?void 0:t.src)||(null==(r=window.frameElement)?void 0:r.getAttribute("src"))||window.location.href;n&&l(n,a.allHeight)}),[l,s.height,a.allHeight])}function getFluidCSSVariables(e){return{"--widget-line-height":"".concat(calculateFluidGridHeight(FLUID_LINE_PARTS,e),"px"),"--widget-block-height":"".concat(calculateFluidGridHeight(FLUID_BLOCK_PARTS,e),"px")}}function isFluidLayout(e){const{phone:t,pad:r}=e;return(isPad()?r.layout:t.layout)===LAYOUT_TYPE$2.FLUID}const FluidWidgetView=observer((({adaptiveScale:e,widget:t,expandIndex:r=0,width:n,style:o,className:i})=>{const a=reactExports.useRef(null),{size:s,adaptiveScale:l}=useSize(t,e),c=isInstanceofZoomable(t.model)&&t.model.isZoomed,{contentStyle:u}=useAdaptiveStyle({bounds:{matrix:t.platform.states.matrix,...s},padding:t.platform.padding,borderLine:t.platform.borderLine,renderWithoutScale:t.model.widgetIsRenderWithoutScale,autoHeight:!c,adaptiveScale:l});return reactExports.useEffect((()=>{const e=getTargetElement$1(a);return e&&t.setTarget(e,r),()=>{t.setTarget(void 0,r)}}),[r,t]),jsxs(Fragment,{children:[jsx(StickyPlaceholder,{widget:t}),jsx(PreviewView,{ref:a,"data-id":t.id,"data-name":t.name,"data-type":t.type,widget:t,expandIndex:r,width:c?u.width:n,height:c?u.height:void 0,style:o,adaptiveScale:l,contentStyle:c?u:void 0,className:classNames$1(i,"duchamp-fluid-widget-view"),contentClassName:"duchamp-widget-view",enableTransform3d:!1,enableReflect:!1,enableBoxShadow:!1,enableRecoveryInterval:!1})]})})),FluidAdaptiveContent=observer((({model:e,contentRef:t,adaptiveScale:r={horizontal:1,vertical:1}})=>{const{gap:n,padding:o,adaptiveMode:i,adjustLayout:a,fluidLayoutStyle:s}=e,l=useStore();useFrameCommunication({ref:t,type:WEB_MESSAGE_TYPES$1.HEIGHT_AUTO_FIT,extraHeight:(o.top+o.bottom)*r.horizontal,adaptiveMode:i,sessionID:l.duchampServer.sessionID,toolHeightManager:l.platform.mobile.toolHeightManager});const c=calculateAdaptiveScaleStyle({adaptiveScale:r,style:s,withTransform:!1});return jsx(FluidLayout,{style:{...c,...getFluidCSSVariables(n)},items:a.map((e=>e.states)),gap:n,adaptiveScale:r,children:a.map((t=>{var n;const o=(null==(n=l.story.stickyInfo.widget)?void 0:n.id)===t.id,i=e.widgetWidth-t.platform.padding.left-t.platform.padding.right-2*t.borderWidth,{width:a}=t.model.widgetIsRenderWithoutScale?calculateAdaptiveScaleStyle({adaptiveScale:r,style:{width:i},withTransform:!t.model.widgetIsRenderWithoutScale}):{width:i};return jsx(FluidWidgetView,{widget:t,width:a,adaptiveScale:r,className:classNames$1({"duchamp-widget-sticky":o})},t.id)}))})})),FluidStructContainerWidget=reactExports.forwardRef((({childWidgets:e,widgetGap:t=0,style:r,expandIndex:n,containerWidth:o,adaptiveScale:i},a)=>{const s=reactExports.useRef(null),l=e=>{var t;e.target&&(null==(t=s.current)||t.scrollTo(0,e.target.offsetTop))};reactExports.useImperativeHandle(a,(()=>({getContainerEl:()=>s.current,scrollToWidget:l})),[]);const{gap:c}=calculateAdaptiveScaleStyle({adaptiveScale:i,style:{gap:t},withTransform:!1});return jsx("div",{className:"structure-fluid-wrapper",ref:s,style:{...getFluidCSSVariables(t),...r},children:e.map(((e,t)=>jsx(FluidWidgetView,{widget:e,width:o-e.platform.padding.left-e.platform.padding.right-2*e.borderWidth,style:{marginTop:0===t?0:c},adaptiveScale:i,expandIndex:n},e.id)))})}));FluidStructContainerWidget.displayName="FluidStructContainer";const FluidStructContainer=observer(FluidStructContainerWidget);function isAutoHeight(e){return!!(null==e?void 0:e.autoHeight)}const MagneticContentWidget=reactExports.forwardRef((({widgets:e,options:t,offset:r={left:0,top:0},expandIndex:n,sticky:o,adaptiveScale:i,...a},s)=>{const{gap:l,padding:c}=t,u=useStore(),d=reactExports.useMemo((()=>transformToMagneticLayoutItems(e.map((e=>({...e.model.states,data:e}))),l)),[e,l]),h=reactExports.useMemo((()=>[c.left+r.left,0]),[r,c]);return jsx(MagneticLayout,{ref:s,padding:c,items:d,gap:l,offset:h,adaptiveScale:i,...a,children:d.map(((e,t)=>{var r,a;const s=e.length<=1?e[0].data:void 0,l=s&&isAutoHeight(s.model)&&!s.platform.mobile.isWidgetZoomed,c=s&&o&&(null==(r=u.story.stickyInfo.widget)?void 0:r.id)===s.id,d=s&&{"--iframe-widget-height":"".concat(s.height,"px")};return jsxs(reactExports.Fragment,{children:[s&&jsx(StickyPlaceholder,{widget:s}),jsx(MagneticLayout.Item,{className:classNames$1("duchamp-magnetic-widget-wrapper",{"duchamp-widget-sticky":c}),adaptiveScale:i,style:{...d,...c&&{position:"sticky"}},children:e.map((({data:e})=>jsx(WidgetWrapper$1,{className:"duchamp-magnetic-widget-view",autoHeight:l,widget:e,adaptiveScale:i,expandIndex:n},e.id)))})]},null!=(a=null==s?void 0:s.id)?a:t)}))})}));MagneticContentWidget.displayName="MagneticLayoutWidget";const MagneticContent=observer(MagneticContentWidget),MagneticStructContainerWidget=reactExports.forwardRef(((e,t)=>{const{model:r,adaptiveScale:n,offset:o,expandIndex:i,style:a}=e,s=reactExports.useRef(null),l=reactExports.useRef(null),c=e=>{var t;if(!e.target||!s.current)return;const r=getDistanceBetweenDoms(l.current,e.target);null==(t=s.current)||t.scrollTo(0,r)};return reactExports.useImperativeHandle(t,(()=>({getContainerEl:()=>s.current,scrollToWidget:c})),[]),jsx("div",{className:"structure-magnetic-wrapper",ref:s,style:a,children:jsx(MagneticContent,{ref:l,adaptiveScale:n,widgets:r.mobileChildWidgets.filter((e=>e.visible)),options:r.magneticOptions,offset:o,expandIndex:i})})}));MagneticStructContainerWidget.displayName="MagneticStructContainerWidget";const MagneticStructContainer=observer(MagneticStructContainerWidget);function getReLayoutWidgets(e){return e.sort(((e,t)=>{const[r,n]=e.position,[o,i]=t.position;return n===i?r-o:n-i}))}const StructureContainer=observer((({model:e,widgetGap:t=0,previewLayout:r=LAYOUT_TYPE$2.RESERVE,adaptiveScale:n={horizontal:1,vertical:1},style:o,expandIndex:i,width:a,height:s})=>{const{childWidgets:l,width:c,height:u,rect:d}=e,h=l.filter((e=>e.visible)),p=useStore(),f=a/c;if(e.isPreview){if(r===LAYOUT_TYPE$2.FLUID)return jsx(FluidStructContainer,{ref:e.scrollContainerRef,childWidgets:getReLayoutWidgets(h),widgetGap:t,adaptiveScale:n,expandIndex:i,containerWidth:a,style:o});if(r===LAYOUT_TYPE$2.MAGNETIC&&isMagneticWidget(e)){const{left:t,top:r}=e.layoutRect;return jsx(MagneticStructContainer,{ref:e.scrollContainerRef,model:e,adaptiveScale:n,offset:{left:t,top:r},expandIndex:i,style:o})}if(isFluidLayout(p.platform.mobile.layoutConfig))return jsx(ScrollableContainer,{ref:e.scrollContainerRef,model:e,style:{height:u*f,width:a},placeholderStyle:{width:"100%",height:"100%"},children:h.map((e=>jsx(WidgetWrapper$1,{widget:e,rect:d,adaptiveScale:{horizontal:f,vertical:f}},e.id)))});const{width:l,height:c}=e.areaRect,g=calculateAdaptiveScaleStyle({adaptiveScale:n,style:{width:l,height:c}});return jsx(ScrollableContainer,{ref:e.scrollContainerRef,model:e,width:a,height:null!=s?s:u*f,placeholderStyle:g,children:h.map((e=>jsx(WidgetWrapper$1,{widget:e,rect:d,adaptiveScale:n},e.id)))})}return jsx(StructContainer,{model:e,overflow:"auto",children:h.map((e=>jsx(WidgetWrapper,{widget:e,expandIndex:i},e.id)))})})),ReserveCanvasView=observer((({model:e,adaptiveScale:t,expandIndex:r,width:n,height:o})=>{const{widgetGap:i}=e.mobileProps;return jsx(StructureContainer,{model:e,adaptiveScale:t,widgetGap:i,previewLayout:e.mobilePreviewLayout,expandIndex:r,width:n,height:o,style:{overflowY:"auto"}})})),useNavigatorStyle=e=>reactExports.useCallback((t=>{t.setAttribute("style","fill: ".concat(hexToRgba(e.color),"; opacity: ").concat(e.opacity/100,"; height: ").concat(e.size,"px;"))}),[e]),INTERNAL_TABS=[{imageSource:"/assets/slideshow/tab0.png",imageSlice:[2,35,1,30]},{imageSource:"/assets/slideshow/tab1.png",imageSlice:[12]},{imageSource:"/assets/slideshow/tab2.png",imageSlice:[13,31,24,14]},{imageSource:"/assets/slideshow/tab3.png",imageSlice:[10,26,10,35],offset:-3},{imageSource:"/assets/slideshow/tab4.png",imageSlice:[22,47,25,50],offset:-3}],TABS_HEADER_TYPE={NONE:"",NAVIGATOR:"navigator",TAB:"tab"},TabsNavigation=({navigator:e,onPageChange:t,tabsLength:r,current:n,className:o,adaptiveScale:i})=>{const a=useNavigatorStyle(e),s=useAssetUrl("/slideshow/navigator.svg");return jsxs("div",{className:classNames$1("duchamp-slideshow-navigator",{float:(null==e?void 0:e.showType)===TABS_SHOW_TYPE.FLOAT},o),style:calculateAdaptiveScaleStyle({adaptiveScale:i,style:{width:"100%",height:"100%"}}),children:[jsx(ReactSVG$1,{className:"navigator-button",style:{transform:"rotateY(180deg)"},beforeInjection:a,onClick:()=>{t(n-1)},src:s}),jsx(ReactSVG$1,{className:"navigator-button",beforeInjection:a,onClick:()=>{t(n+1)},src:s}),e.showPoint&&jsx("div",{className:"slideshow-navigator-points",children:Array.from({length:r}).map(((t,r)=>jsx("div",{style:{backgroundColor:e.color},className:classNames$1("navigator-points",{selected:r===n})},r)))})]})},SELECT_TYPE={SELECTED:"selected",UNSELECTED:""},SHOW_TYPE_OPTIONS=[{label:duchampIntl.get("Duchamp-Fixed_Display"),value:TABS_SHOW_TYPE.FIX},{label:duchampIntl.get("Duchamp-Floating_Display"),value:TABS_SHOW_TYPE.FLOAT}],ALIGN_OPTIONS=[{label:duchampIntl.get("Duchamp-On_The_Left"),value:BUTTON_GROUP_TEXT_ALIGN.LEFT},{label:duchampIntl.get("Duchamp-Centered"),value:BUTTON_GROUP_TEXT_ALIGN.CENTER},{label:duchampIntl.get("Duchamp-On_The_Right"),value:BUTTON_GROUP_TEXT_ALIGN.RIGHT}],VERTICAL_ALIGN_OPTIONS=[{label:duchampIntl.get("Duchamp-Top"),value:BUTTON_GROUP_TEXT_ALIGN.LEFT},{label:duchampIntl.get("Duchamp-Centered"),value:BUTTON_GROUP_TEXT_ALIGN.CENTER},{label:duchampIntl.get("Duchamp-Lay_Down"),value:BUTTON_GROUP_TEXT_ALIGN.RIGHT}],LAYOUT_OPTIONS=[{label:duchampIntl.get("Duchamp-Natural_Layout"),value:BUTTON_GROUP_LAYOUT.INITIAL},{label:duchampIntl.get("Duchamp-Divided_Layout"),value:BUTTON_GROUP_LAYOUT.EQUAL}],POSITION_OPTIONS=[{label:duchampIntl.get("Duchamp-Superior"),value:BUTTON_GROUP_POSITION.TOP},{label:duchampIntl.get("Duchamp-Down"),value:BUTTON_GROUP_POSITION.BOTTOM},{label:duchampIntl.get("Duchamp-Left"),value:BUTTON_GROUP_POSITION.LEFT},{label:duchampIntl.get("Duchamp-Right"),value:BUTTON_GROUP_POSITION.RIGHT}],INTERNAL_SLIDESHOW_BUTTONS=["/assets/slideshow/button0.png","/assets/slideshow/button1.png","/assets/slideshow/button2.png","/assets/slideshow/button3.png","/assets/slideshow/button4.png"],TAB_ARROW_IMAGES=["/assets/slideshow/arrow/whole-arrow0.png","/assets/slideshow/arrow/whole-arrow1.png","/assets/slideshow/arrow/whole-arrow2.png","/assets/slideshow/arrow/whole-arrow3.png"],TEMPLATE_OPTIONS=[{label:duchampIntl.get("Duchamp-Slideshow_Tech_Style"),value:BUTTON_GROUP_TYPE.SCIENCE},{label:duchampIntl.get("Duchamp-Slideshow_Button_Style"),value:BUTTON_GROUP_TYPE.BUTTON},{label:duchampIntl.get("Duchamp-Slideshow_Underline_Style"),value:BUTTON_GROUP_TYPE.UNDERLINE}],BORDER_RADIUS_UNITS=[{value:"px",min:0,max:1e3,label:"px"},{value:"%",min:0,max:200,label:"%"}],DEFAULT_STYLE={color:"#808080",background:"",borderConfig:{borderStyle:"solid",borderColor:"#ADADAD80",borderWidth:1}},UNDERLINE_DEFAULT_STYLE={color:"#808080",background:"",borderConfig:{borderStyle:"solid",borderColor:"#ADADAD80",borderWidth:1}},UNDERLINE_DEFAULT_SELECTED_STYLE={color:getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.ONE),background:"",borderConfig:{borderStyle:"solid",borderColor:getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.ONE),borderWidth:1}},BUTTON_DEFAULT_STYLE={color:"#808080",background:"#FFFFFF00",borderConfig:{borderStyle:"solid",borderColor:"#ADADAD80",borderWidth:1}},BUTTON_DEFAULT_SELECTED_STYLE={color:getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.TEXT),background:getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.ONE),borderConfig:{borderStyle:"solid",borderColor:getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.ONE),borderWidth:1}},DEFAULT_TAB_STYLE={[BUTTON_GROUP_TYPE.SCIENCE]:{selected:DEFAULT_STYLE,...DEFAULT_STYLE},[BUTTON_GROUP_TYPE.BUTTON]:{selected:BUTTON_DEFAULT_SELECTED_STYLE,...BUTTON_DEFAULT_STYLE},[BUTTON_GROUP_TYPE.UNDERLINE]:{selected:UNDERLINE_DEFAULT_SELECTED_STYLE,...UNDERLINE_DEFAULT_STYLE}},DEFAULT_TAB_CARD_STYLE={tabArrow:{hue:0,value:0,saturation:0,brightness:0,contrast:0},borderRadius:{type:"px",value:2},hue:0,saturation:0,brightness:0,contrast:0,interinalIndex:0},DEFAULT_TAB_CARD_CONFIG={showType:TABS_SHOW_TYPE.FIX,layout:BUTTON_GROUP_LAYOUT.EQUAL,position:BUTTON_GROUP_POSITION.TOP,alignItem:BUTTON_GROUP_TEXT_ALIGN.CENTER,templateType:BUTTON_GROUP_TYPE.UNDERLINE,characterStyle:{fontFamily:TEXT.FONT_FAMILY,fontStyle:void 0,fontWeight:void 0,fontSize:14},selected:UNDERLINE_DEFAULT_SELECTED_STYLE,...DEFAULT_STYLE,...DEFAULT_TAB_CARD_STYLE},DEFAULT_TAB_CONFIG={tabButtonType:TABS_HEADER_TYPE.TAB,navigator:{showType:TABS_SHOW_TYPE.FIX,size:18,color:getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.ONE),showPoint:!1,opacity:100},tabCard:DEFAULT_TAB_CARD_CONFIG};new Array(2).fill(duchampIntl.get("Duchamp-Example")),TEXT.FONT_FAMILY,BUTTON_GROUP_LAYOUT.EQUAL;const TAB_CARD_TYPE_OMIT_CONFIG={[BUTTON_GROUP_TYPE.SCIENCE]:["borderRadius","background","borderConfig","selected.borderConfig","selected.background"],[BUTTON_GROUP_TYPE.BUTTON]:["tabArrow"],[BUTTON_GROUP_TYPE.UNDERLINE]:["tabArrow","borderRadius","selected.background","background"]},TABS_FOCUS_POINT={[BUTTON_GROUP_TYPE.SCIENCE]:"tech",[BUTTON_GROUP_TYPE.BUTTON]:"rowing",[BUTTON_GROUP_TYPE.UNDERLINE]:"underline"},SELECT_OPTIONS=[{label:duchampIntl.get("Duchamp-Unselected"),value:SELECT_TYPE.UNSELECTED},{label:duchampIntl.get("Duchamp-Selected"),value:SELECT_TYPE.SELECTED}],DEFAULT_COMPATIBILITY_TAB_CONFIG={tabCard:{templateType:BUTTON_GROUP_TYPE.SCIENCE}},NavButtonConfig=observer((({model:e,className:t})=>{const{navigator:{showType:r,showPoint:n,color:o,size:i,opacity:a}}=e.props,s=(t,r=!1)=>e.changePlatformNavigatorValue(t,r);return jsx("div",{className:classNames$1(t),children:jsxs(GridItem,{children:[jsx(LineItem,{label:duchampIntl.get("Duchamp-Display_Strategy"),hide:e.isMobile,children:jsx(Select$1,{options:SHOW_TYPE_OPTIONS,value:r,style:{width:"100%"},onChange:t=>{e.changeNavigatorShowType(t)}})}),jsx(PlatformLineItem,{label:duchampIntl.get("Duchamp-Size"),children:jsx(NumberInput$1,{value:i,onChange:s("size",!0)})}),jsx(LineItem,{label:duchampIntl.get("Duchamp-Colour"),children:jsx(ThemeColorPicker,{value:o,onChange:s("color")})}),jsx(SliderInputItem,{label:duchampIntl.get("Duchamp-Opacity"),value:a,onChange:s("opacity")}),jsx(LineItem,{label:duchampIntl.get("Duchamp-Navigation_Point"),children:jsx(Checkbox$4,{value:n,onChange:e=>s("showPoint")(e),children:duchampIntl.get("Duchamp-Show_Navigation_Point")})})]})})}));var isSymbol$1=isSymbol_1$1;function baseExtremum$2(e,t,r){for(var n=-1,o=e.length;++n<o;){var i=e[n],a=t(i);if(null!=a&&(void 0===s?a==a&&!isSymbol$1(a):r(a,s)))var s=a,l=i}return l}var _baseExtremum=baseExtremum$2;function baseGt$2(e,t){return e>t}var _baseGt=baseGt$2,baseExtremum$1=_baseExtremum,baseGt$1=_baseGt,identity$1=identity_1$1;function max(e){return e&&e.length?baseExtremum$1(e,identity$1,baseGt$1):void 0}var max_1=max;const max$1=getDefaultExportFromCjs$1(max_1);function getButtonWrapperStyle(e,t){const{position:r}=e,{imageSlice:n}=t,[o,i=o,,a=o]=n,s=(i+a)/2;return r===BUTTON_GROUP_POSITION.TOP||r===BUTTON_GROUP_POSITION.BOTTOM?{minWidth:s}:{minHeight:s}}function getButtonBgStyle(e,t){const{position:r}=e,{imageSource:n,imageSlice:o}=t,i={...getFilterStyle(e),borderStyle:"solid"};if(r===BUTTON_GROUP_POSITION.TOP||r===BUTTON_GROUP_POSITION.BOTTOM)return merge$1(i,{borderImageSource:"url(".concat(createAbsoluteUrl(n),")"),borderWidth:o.map((e=>"".concat(e/2,"px"))).join(" "),borderImageSlice:"fill ".concat(o.join(" "))});const a="".concat("".concat(n.split(".")[0],"r.")).concat(n.split(".")[1]),s=arrayMove([...o],0,3);return merge$1(i,{borderImageSource:"url(".concat(createAbsoluteUrl(a),")"),borderWidth:s.map((e=>"".concat(e/2,"px"))).join(" "),borderImageSlice:"fill ".concat(s.join(" "))})}function getTabCardExtendsStyle(e,t,r,n,o=0){const{hue:i=0,saturation:a=0,brightness:s=0,contrast:l=0}=n||{};return{height:t?"100%":e,width:t?e:"100%","--group-arrow-size":"".concat(max$1([(.8*r.fontSize).toFixed(0),10]),"px"),"--group-arrow-padding":"".concat(max$1([(.15*r.fontSize).toFixed(0),2]),"px"),"--group-arrow-hue":"hue-rotate(".concat(i,"deg) saturate(").concat(a+100,"%) brightness(").concat(s+100,"%) contrast(").concat(l+100,"%)"),"--button-offset":"".concat(o,"px"),...r}}function getButtonGroupStyle(e,t){const{selected:{background:r="",color:n,borderConfig:o=BUTTON_DEFAULT_SELECTED_STYLE.borderConfig},characterStyle:i,templateType:a,background:s="",borderConfig:l=BUTTON_DEFAULT_STYLE.borderConfig,layout:c,alignItem:u,buttonHeight:d}=e;return getButtonGroupCssVariables({...e,alignItem:c===BUTTON_GROUP_LAYOUT.EQUAL?TEXT_ALIGN_ITEM_MAP[u]:"center",type:a,fontSize:i.fontSize,buttonHeight:d,selectedColor:n,background:s,selectedBackground:r,border:l,selectedBorder:o,extendsCommonStyle:t})}function getCleanProps(e){return omit$1(e,TAB_CARD_TYPE_OMIT_CONFIG[e.templateType])}function getCompatibilityDefaultProps(e){return merge$1(e,DEFAULT_COMPATIBILITY_TAB_CONFIG)}function getPrefixPath(e,t){return isNil$3(t)?e:"".concat(t).concat(t?".":"").concat(e)}const ButtonStyleConfig=observer((({model:e})=>{const{tabCard:t}=toJS(e.props),{templateType:r}=t;if(r!==BUTTON_GROUP_TYPE.BUTTON)return jsx(Fragment,{});const n=(e,r)=>get$5(t,getPrefixPath(e,r)),o=(t,r,n)=>e.changePlatformTabCardValue(getPrefixPath(t,r),n);return jsxs(Fragment,{children:[jsx(LabelItem$1,{label:duchampIntl.get("Duchamp-Button_Style"),children:jsx(ToggleGroup,{options:SELECT_OPTIONS,children:t=>jsxs(Fragment,{children:[jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Font_Color"),children:jsx(ThemeColorPicker,{value:n("color",t),onChange:o("color",t)})}),jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Fill_Color"),children:jsx(ThemeColorPicker,{value:n("background",t),onChange:o("background",t)})}),jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Border_Line"),children:jsx(LineConfig,{value:n("borderConfig",t),onChange:r=>{const n=getPrefixPath("borderConfig",t),i=transformValueToPlatformValue({value:r,lastPCValue:get$5(e.props.tabCard,n,{}),lastMobileValue:get$5(e.mobile.props.tabCard,n,{}),mobileProperties:["borderWidth"]});o("borderConfig",t,!0)(i.mobile,i.pc)},showPlatform:!0})})]})})}),jsx(PlatformLineItem,{label:duchampIntl.get("Duchamp-Rounded_Corner"),children:jsx(NumberUnitInput,{value:n("borderRadius"),units:BORDER_RADIUS_UNITS,onChange:e.changePlatformTabCardValue("borderRadius",!0)})})]})})),GeneralConfig=observer((({model:e})=>{const t=toJS(e.props.tabCard)||DEFAULT_TAB_CONFIG.tabCard,r=t.position===BUTTON_GROUP_POSITION.LEFT||t.position===BUTTON_GROUP_POSITION.RIGHT,{showType:n,templateType:o,layout:i,position:a,alignItem:s,characterStyle:l}=t;return jsxs(Fragment,{children:[jsx(LineItem,{label:duchampIntl.get("Duchamp-Display_Strategy"),hide:e.isMobile,children:jsx(Select$1,{options:SHOW_TYPE_OPTIONS,value:n,style:{width:"100%"},onChange:t=>{e.changeTabCardShowType(t)}})}),jsx(PlatformLineItem,{label:duchampIntl.get("Duchamp-Template_Type"),children:jsx(Select$1,{options:TEMPLATE_OPTIONS,value:o,style:{width:"100%"},onChange:t=>e.changeTemplateType(t)})}),jsx(PlatformLineItem,{label:duchampIntl.get("Duchamp-Layout"),children:jsx(RadioGroup$1,{value:i,options:LAYOUT_OPTIONS,onChange:t=>{e.changePlatformTabCardValue("layout",!0)(t)}})}),jsx(LineItem,{label:duchampIntl.get("Duchamp-Button_Position"),children:jsx(RadioGroup$1,{value:a,options:POSITION_OPTIONS.map((e=>({...e,style:{flexBasis:"auto",minWidth:"30px"}}))),onChange:t=>{e.changePlatformTabCardValue("position",!1)(t)}})}),jsxs(LineItem,{label:duchampIntl.get("Duchamp-Font_Style"),children:[jsx(FontSelect,{value:l.fontFamily,onChange:t=>{e.changePlatformTabCardValue("characterStyle.fontFamily")(t)},style:{width:158,marginBottom:8}}),jsx(FontStyleConfig,{value:l,onChange:t=>{var r;const n=transformValueToPlatformValue({value:t,lastPCValue:e.props.tabCard.characterStyle,lastMobileValue:(null==(r=e.mobile.props.tabCard)?void 0:r.characterStyle)||{},mobileProperties:["fontSize"]});e.changePlatformTabCardValue("characterStyle",!0)(n.mobile,n.pc)},showTypes:{bold:!0,italic:!0},prefixIcon:jsx(PlatformPopoverIcon,{})})]}),jsx(LineItem,{hide:i===BUTTON_GROUP_LAYOUT.INITIAL,label:duchampIntl.get("Duchamp-Text_Position"),children:jsx(RadioGroup$1,{value:s,options:r?VERTICAL_ALIGN_OPTIONS:ALIGN_OPTIONS,onChange:t=>{e.changePlatformTabCardValue("alignItem")(t)}})})]})})),TechStyleConfig=observer((({model:e})=>{const{tabCard:t}=toJS(e.props),{layout:r,tabArrow:n,templateType:o,interinalIndex:i,hue:a,saturation:s,brightness:l,contrast:c}=t;if(o!==BUTTON_GROUP_TYPE.SCIENCE)return jsx(Fragment,{});const u=(e,r)=>get$5(t,getPrefixPath(e,r)),d=(t,r)=>e.changePlatformTabCardValue(getPrefixPath(t,r));return jsxs(Fragment,{children:[jsx(LineItem,{label:duchampIntl.get("Duchamp-Button_Style"),children:jsx(ToggleGroup,{options:SELECT_OPTIONS,children:e=>jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Font_Color"),children:jsx(ThemeColorPicker,{value:u("color",e),onChange:d("color",e)})})})}),jsxs(LineItem,{label:duchampIntl.get("Duchamp-Button_Background"),children:[jsx("div",{className:"duchamp-internal-tabcards",children:INTERNAL_SLIDESHOW_BUTTONS.map(((e,t)=>{const r=createAbsoluteUrl(e);return jsx(Toolbox,{showSelectedIcon:!0,selected:t===i,onClick:()=>d("interinalIndex")(t),children:jsx(Popover$3,{content:jsx(SlideShowTabButtonContent,{src:r}),mouseEnterDelay:2,overlayClassName:"slideshow-tab-button-popover",destroyTooltipOnHide:!0,placement:"top",children:jsx("div",{className:"slideshow-tab-button-wrapper",children:jsx(SlideShowTabButtonContent,{src:r})})})},e)}))}),jsx(FilterProcessPanel,{hue:a,onChange:(e,t,r)=>{d(t)(r)},contrast:c,saturation:s,brightness:l,layout:"vertical"})]}),jsx(LineItem,{label:duchampIntl.get("Duchamp-Tab_Arrow"),hide:r===BUTTON_GROUP_LAYOUT.EQUAL,children:n?jsxs(Fragment,{children:[jsx("div",{className:"duchamp-tab-arrow",children:TAB_ARROW_IMAGES.map(((e,t)=>jsx(Toolbox,{showSelectedIcon:!0,selected:n.value===t,onClick:()=>d("tabArrow.value")(t),children:jsx(FvsImage,{src:createAbsoluteUrl(e),hoverPreview:{previewContentClassName:"arrow-item-preview-content"}})},t)))}),jsx(FilterProcessPanel,{hue:n.hue,contrast:n.contrast,saturation:n.saturation,brightness:n.brightness,onChange:(e,t,r)=>{d("tabArrow.".concat(t))(r)},layout:"vertical"})]}):void 0})]})}));function SlideShowTabButtonContent({src:e}){return jsxs("div",{style:{backgroundImage:"url(".concat(e,")")},className:"slideshow-tab-button-content",children:[jsx("span",{children:duchampIntl.get("Duchamp-Example")}),jsx("span",{children:duchampIntl.get("Duchamp-Example")})]})}const UnderlineStyleConfig=observer((({model:e})=>{const{tabCard:t}=toJS(e.props),{templateType:r}=t;if(r!==BUTTON_GROUP_TYPE.UNDERLINE)return jsx(Fragment,{});const n=(e,r)=>get$5(t,getPrefixPath(e,r)),o=(t,r,n)=>e.changePlatformTabCardValue(getPrefixPath(t,r),n);return jsx(LabelItem$1,{label:duchampIntl.get("Duchamp-Button_Style"),children:jsx(ToggleGroup,{options:SELECT_OPTIONS,children:t=>jsxs(Fragment,{children:[jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Font_Color"),children:jsx(ThemeColorPicker,{value:n("color",t),onChange:o("color",t)})}),jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Underline"),children:jsx(LineConfig,{value:n("borderConfig",t),onChange:r=>{const n=getPrefixPath("borderConfig",t),i=transformValueToPlatformValue({value:r,lastPCValue:get$5(e.props.tabCard,n,{}),lastMobileValue:get$5(e.mobile.props.tabCard,n,{}),mobileProperties:["borderWidth"]});o("borderConfig",t,!0)(i.mobile,i.pc)},showPlatform:!0})})]})})})})),TabButtonConfig=observer((({model:e,className:t})=>jsx("div",{className:classNames$1("slideshow-tabcard",t),children:jsxs(GridItem,{children:[jsx(GeneralConfig,{model:e}),jsx(TechStyleConfig,{model:e}),jsx(ButtonStyleConfig,{model:e}),jsx(UnderlineStyleConfig,{model:e})]})}))),AutoHeightConfig=({value:e,onChange:t,subTitle:r,style:n})=>{const o={marginLeft:0,...n},i=jsx(IconPopover,{arrow:{pointAtCenter:!0},icon:"icon-help",placement:"top-left",autoAdjustOverflow:!0,overlayInnerStyle:{maxWidth:250},text:duchampIntl.get("Duchamp-Auto_Height_Preview_Tips")});return r?jsx(VerticalItem$1,{label:r,icon:i,children:jsx(Checkbox$4,{value:e,onChange:e=>{null==t||t(e)},style:o,text:duchampIntl.get("Duchamp-Auto_Height_Preview")})}):jsx(Checkbox$4,{value:e,onChange:e=>{null==t||t(e)},text:jsxs("div",{className:"duchamp-auto-height-content",children:[duchampIntl.get("Duchamp-Auto_Height_Preview"),i]}),style:o})};formItemManager.register("autoHeight",AutoHeightConfig);const TabsConfig=observer((({model:e})=>{const{tabButtonType:t,keepRatio:r,tabPadding:n,widgetGap:o,autoHeight:i}=e,a=useStore();return jsxs(Fragment,{children:[jsxs(LineItem,{className:"slideshow-button-checkbox",label:duchampIntl.get("Duchamp-Tab_Pane"),children:[a.isMagneticLayout&&jsxs(Fragment,{children:[jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Inner_Margin"),children:jsx(PaddingConfig,{paddingInputProps:{min:0},value:n,onChange:t=>{e.setTabPadding(t)}})}),jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Widget_Gap"),children:jsx(NumberInput$1,{suffix:"px",value:o,min:0,onChange:t=>{e.setWidgetGap(t)}})})]}),jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Container_Keep_Ratio"),icon:jsx(IconPopover,{arrow:{pointAtCenter:!0},icon:"icon-help",placement:"top-left",autoAdjustOverflow:!0,overlayInnerStyle:{maxWidth:"250px"},text:duchampIntl.get("Duchamp-Container_Keep_Ratio_Tip",duchampIntl.get("Duchamp-Tab"))}),children:jsx(Checkbox$4,{value:r,onChange:t=>e.setKeepRatio(t),children:duchampIntl.get("Duchamp-Container_Enable_Keep_Ratio")})}),a.isMagneticLayout&&jsx(AutoHeightConfig,{subTitle:duchampIntl.get("Duchamp-Auto_Height"),value:i,onChange:t=>{e.setAutoHeight(t)},"data-focus-point":{id:"S261",trigger:"onChange",getParam:()=>({value:e.autoHeight?"1":"2"})}})]}),jsx(LineItem,{className:"slideshow-button-checkbox",label:duchampIntl.get("Duchamp-Switch_Page_Button"),children:jsx(Checkbox$4,{value:!!t,onChange:()=>{e.setProps({tabButtonType:t?TABS_HEADER_TYPE.NONE:TABS_HEADER_TYPE.TAB})},children:duchampIntl.get("Duchamp-Show_Switch_Page_Button")})}),jsx(RadioGroup$1,{value:t,className:classNames$1("slideshow-config-row",{tabHide:!t}),options:[{label:duchampIntl.get("Duchamp-Tab_Bar_Button"),value:TABS_HEADER_TYPE.TAB},{label:duchampIntl.get("Duchamp-Navigator_Button"),value:TABS_HEADER_TYPE.NAVIGATOR}],onChange:t=>{e.setProps({tabButtonType:t})}}),jsx(NavButtonConfig,{className:classNames$1({tabHide:t!==TABS_HEADER_TYPE.NAVIGATOR}),model:e}),jsx(TabButtonConfig,{className:classNames$1({tabHide:t!==TABS_HEADER_TYPE.TAB}),model:e})]})})),MAX_DEPTH=3;function isTabs(e){return e===WIDGET_TYPE.TABS}const TABS_WIDGET_META={type:WIDGET_TYPE.TABS,widgetType:"container",displayName:duchampIntl.get("Duchamp-Tab"),version:"0.0.5",iconfont:"icon-tab-components",dragPreviewImage:"/assets/widget/slideshow.svg",states:{width:480,height:320},refresh:!1,props:DEFAULT_TAB_CONFIG,carousel:{autoplay:!1,autoplaySpeed:6e3},configure:{...STRUCTURE_WIDGET_META_CONFIG,eventTargets:{events:[{trigger:WIDGET_EVENT.CAROUSEL,text:WIDGET_EVENT_MAP.CAROUSEL,actions:carouselActions}]},acceptRule:{childWhitelist:{rule:[WIDGET_TYPE.TAB_PANE]},contextWhitelist:{rule:(e,t)=>{const r=[t,...t.parentWidgets].filter((e=>isTabs(e.type))).length,n=MAX_DEPTH-r;return isString$3(e)?!isTabs(e)||n>0:Math.max(...e.flattenChildWidgets.filter((e=>isTabs(e.type))).map((e=>e.getInstance().tabsDepth)))<=n},tip:duchampIntl.get("Duchamp-Tab_Max_Depth_Tip",MAX_DEPTH)}}},initialization:async({widget:e})=>{var t;if(0===e.children.length){return null!==await(null==(t=e.story)?void 0:t.createWidget(WIDGET_TYPE.TAB_PANE,{x:0,y:0},e))}return!0},scale:!1};var __defProp$x=Object.defineProperty,__getOwnPropDesc$w=Object.getOwnPropertyDescriptor,__decorateClass$w=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$w(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$x(t,r,i),i};const _TabsWidgetModel=class e extends StructWidgetModel{constructor(){super(...arguments),__publicField(this,"invisibleTabIds",new Set),__publicField(this,"disableRoll",!1),__publicField(this,"stopOnHover",!this.disableRoll),__publicField(this,"currentTabId",null==(_b=first(this.visibleTabs))?void 0:_b.id)}isTabPaneRectNeedFixed(){const e=this.childWidgets.at(0);if(e){const t=e.rect,r=this.layoutRect;return!isEqual$4(t,r)}return!1}async scrollToWidget(e,t){var r;await this.navigateTo(e),null==(r=this.currentPageModel)||r.scrollToWidget(e,t)}async navigateTo(e){if(e&&e!==this.widget){const t=this.layoutChildWidgets.find((t=>[...e.parentWidgets,e].includes(t)));t&&await this.setCurrentTabId({id:null==t?void 0:t.id})}}initStateChangeListeners(e){super.initStateChangeListeners(e),!this.isPreview&&this.disposes.push(reaction((()=>{var e;return{currentWidget:null==(e=this.story)?void 0:e.currentWidget,flattenChildWidgets:this.flattenChildWidgets}}),(({currentWidget:e})=>this.navigateTo(e))),reaction((()=>this.store.platform.platformType),(()=>{this.store.isMagneticLayout&&this.isTabPaneRectNeedFixed()&&this.store.undoManager.withoutUndo((()=>{this.childWidgets.forEach((e=>{var t;!isNil$3(null==(t=this.widget.mobile.states)?void 0:t.width)&&setMagneticWidgetStates({widget:e,states:{width:this.layoutRect.width,height:this.layoutRect.height,matrix:(new Transform$2).setTranslate(this.layoutRect.left,this.layoutRect.top).matrix},onlyCache:!0})}))}))}))),this.disposes.push(reaction((()=>this.visibleTabs.length),(()=>{this.visibleTabs.some((e=>e.id===this.currentTabId))||this.setCurrentTabId()})))}get layoutChildWidgets(){return this.widget.layoutChildWidgets}get tabCardSize(){const{characterStyle:e,showType:t}=this.tabCard;return this.tabButtonType===TABS_HEADER_TYPE.TAB&&t===TABS_SHOW_TYPE.FIX?TAB_CARD_SIZE_MULTIPLE$1*e.fontSize:0}get tabCardOffset(){return this.parentWidgetModels.reduce(((t,r)=>r instanceof e&&r.tabCard.position===this.tabCard.position?t+r.tabCardSize:t),0)}get layoutRect(){const{position:e}=this.tabCard,{left:t,top:r,width:n,height:o}=this.widget.layoutRect;return{width:this.isVertical?n-this.tabCardSize:n,height:this.isVertical?o:o-this.tabCardSize,left:e===BUTTON_GROUP_POSITION.LEFT?t+this.tabCardSize:t,top:e===BUTTON_GROUP_POSITION.TOP?r+this.tabCardSize:r}}pauseRollPlay(){this.disableRoll=!0}continueRollPlay(){this.disableRoll=!1}setStopOnHover(e){this.stopOnHover=e}openHoverPauseRollPlay(){this.setStopOnHover(!0)}closeHoverPauseRollPlay(){this.setStopOnHover(!1)}get childrenLimitRect(){return this.layoutRect}getBoundsEffect(){return{...super.getBoundsEffect(),position:this.tabCard.position,showType:this.tabCard.showType,fontSize:this.tabCard.characterStyle.fontSize,tabButtonType:this.tabButtonType}}getTargetChildrenStates(...[e]){if(!e.ignoreSelf)return super.getTargetChildrenStates({...e,keepRatio:!0});const{left:t,top:r,width:n,height:o}=this.layoutRect,i=new Map;return e.widgets.forEach((e=>{i.set(e.id,{width:n,height:o,matrix:[1,0,0,1,t,r]})})),i}updateByChildren(){var e;0===this.childWidgets.length&&(null==(e=this.story)||e.deleteWidget(this.widget))}collectFonts(){const{characterStyle:e}=this.tabCard;return[e.fontFamily]}async setCurrentTabId({id:e,options:t}={}){this.currentTabId&&this.currentTabId===e||(this.currentTabId=e,this.needInitChildWidgets.length>0&&await this.store.duchampServer.widgetInstanceManager.instanceInit(flatAvailableWidgets(this.needInitChildWidgets,{fetcher:e=>e.needInitChildWidgets}),{type:"init"},void 0,void 0,new Filter("and").updateParameterFilters(null!=t?t:{})),this.widget.trigger({trigger:WIDGET_EVENT.CAROUSEL}))}get current(){return Math.max(0,this.visibleTabs.findIndex((e=>e.id===this.currentTabId)))}get currentPage(){return this.visibleTabs[this.current]}get currentPageModel(){var e;return null==(e=this.currentPage)?void 0:e.getInstance()}get availableChildWidgets(){return this.currentPage?[this.currentPage]:[]}get needInitChildWidgets(){return this.lazyLoad?this.availableChildWidgets:this.childWidgets}get visibleTabs(){return this.layoutChildWidgets.filter((e=>!this.invisibleTabIds.has(e.id)&&e.visibleInStory))}get tabButtonType(){return this.props.tabButtonType}get isNavigatorType(){return this.props.tabButtonType===TABS_HEADER_TYPE.NAVIGATOR}get isTabType(){return this.props.tabButtonType===TABS_HEADER_TYPE.TAB}get navigator(){return this.props.navigator}get tabCard(){return this.props.tabCard||DEFAULT_TAB_CONFIG.tabCard}get carousel(){const{carousel:e}=this.widget.platform;return this.isMobile?{swiperAnimation:!1,swiper:!1,...e}:e}get lazyLoad(){var e;return!this.isMobile||!(null==(e=this.carousel)?void 0:e.swiperAnimation)}get isVertical(){var e,t;return(null==(e=this.props.tabCard)?void 0:e.position)===BUTTON_GROUP_POSITION.LEFT||(null==(t=this.props.tabCard)?void 0:t.position)===BUTTON_GROUP_POSITION.RIGHT}get tabPadding(){return this.props.tabPadding}get widgetGap(){var e;return null!=(e=this.props.widgetGap)?e:DEFAULT_WIDGET_GAP.TABS}get autoHeight(){var e;return null==(e=this.props.autoHeight)||e}get tabsDepth(){const t=this.flattenChildWidgets.reduce(((t,r)=>{const n=r.getInstance();return r!==this.widget&&n instanceof e&&t.push(n.tabsDepth),t}),[]);return t.length>0?Math.max(...t)+1:1}addTabPane(){var e;null==(e=this.story)||e.createWidget(WIDGET_TYPE.TAB_PANE,{x:0,y:0},this.widget,0)}deleteTabPane(e){var t;null==(t=this.story)||t.deleteWidget(e)}get listToolbar(){return[{icon:"icon-add",text:duchampIntl.get("Duchamp-Tab_Pane_New"),onClick:()=>{this.addTabPane()}}]}updateRectAfterAppendChild(e){const{left:t,top:r,width:n,height:o}=this.layoutRect;e.setRectStatesWithEffect({width:n,height:o,matrix:[1,0,0,1,t,r]})}switchTab(e){var t;e<0||e>this.visibleTabs.length-1||this.setCurrentTabId({id:null==(t=this.visibleTabs[e])?void 0:t.id})}changeTabCardValue(e,t){return r=>{const n=toJS(this.props.tabCard);if(t)return set$3(n,e,r),this.setProps({tabCard:merge$1(n,DEFAULT_TAB_STYLE[n.templateType],DEFAULT_TAB_CARD_STYLE,r===BUTTON_GROUP_TYPE.BUTTON?{layout:BUTTON_GROUP_LAYOUT.EQUAL}:{})});set$3(n,e,r),this.setProps({tabCard:n})}}changeTemplateType(e){this.store.undoManager.withGroup((()=>{if(this.props.tabCard.templateType===e)return;const t=toJS(this.props.tabCard),r=toJS(this.mobile.props.tabCard)||{};if(this.isMobile)this.setMobileProps({tabCard:merge$1(r.templateType?r:t,DEFAULT_TAB_STYLE[e],DEFAULT_TAB_CARD_STYLE,e===BUTTON_GROUP_TYPE.BUTTON?{layout:BUTTON_GROUP_LAYOUT.EQUAL}:{},{templateType:e})});else{if(!r.templateType){const{characterStyle:e,showType:t}=r;this.setMobileProps({tabCard:{characterStyle:e,showType:t}})}this.changeTabCardValue("templateType",!0)(e)}}))}changeTabCardShowType(e){this.store.undoManager.withGroup((()=>{this.setMobileProps({tabCard:{...this.mobile.props.tabCard||{},showType:TABS_SHOW_TYPE.FIX}}),this.changeTabCardValue("showType")(e)}))}changePlatformTabCardValue(e,t=!1){return(r,n)=>{this.store.undoManager.withGroup((()=>{const o=toJS(this.mobile.props.tabCard)||{},i=n?merge$1({},n,r):r;if(this.isMobile){if(o.templateType)return set$3(o,e,i),this.setMobileProps({tabCard:o});if(t)return set$3(o,e,r),this.setMobileProps({tabCard:o}),void(n&&this.changeTabCardValue(e)(n))}this.changeTabCardValue(e)(i)}))}}changeNavigatorShowType(e){this.store.undoManager.withGroup((()=>{this.setMobileProps({navigator:{...this.mobile.props.navigator||{},showType:TABS_SHOW_TYPE.FIX}}),this.changePlatformNavigatorValue("showType")(e)}))}changePlatformNavigatorValue(e,t=!1){return r=>{this.store.undoManager.withGroup((()=>{const n=toJS(this.mobile.props.navigator)||{};if(this.isMobile&&t)return set$3(n,e,r),void this.setMobileProps({navigator:n});const o=toJS(this.widget.props.navigator);set$3(o,e,r),this.setProps({navigator:o})}))}}mergeProps(e,t){return mergeWith$2({},e,t,((e,r,n)=>{if("tabCard"===n&&r.templateType&&r===(null==t?void 0:t.tabCard))return r}))}setTabPadding(e){this.setProps({tabPadding:e})}setWidgetGap(e){this.setProps({widgetGap:e})}setAutoHeight(e){this.setPlatformProps({autoHeight:e})}setVisibleTabs(e,t){t?this.invisibleTabIds.delete(e):this.invisibleTabIds.add(e)}setTabVisible(e,t){const r=this.layoutChildWidgets.find((t=>t.name===e||t.props.tabName===e));r&&this.setVisibleTabs(r.id,t)}getShowIndex(){return this.currentPage?this.layoutChildWidgets.indexOf(this.currentPage):0}showCardByIndex(e,t){if(!isNaturalInteger(e))return;const r=this.layoutChildWidgets[e];r&&this.visibleTabs.includes(r)&&this.setCurrentTabId({id:r.id,options:t})}getPageContext(){return new PageContext({getPages:()=>this.layoutChildWidgets.map(((e,t)=>({id:e.id,name:e.name,index:t+1,visible:this.visibleTabs.includes(e)}))),getCurrent:()=>this.layoutChildWidgets.findIndex((e=>{var t;return e.id===(null==(t=this.currentPage)?void 0:t.id)}))+1,isLoop:()=>!0},{goto:(e,t)=>this.showCardByIndex(e.index-1,t),setVisible:(e,t)=>{e.id&&this.setVisibleTabs(e.id,t)}})}};__decorateClass$w([override],_TabsWidgetModel.prototype,"initStateChangeListeners",1),__decorateClass$w([observable],_TabsWidgetModel.prototype,"invisibleTabIds",2),__decorateClass$w([computed],_TabsWidgetModel.prototype,"layoutChildWidgets",1),__decorateClass$w([computed],_TabsWidgetModel.prototype,"tabCardSize",1),__decorateClass$w([computed],_TabsWidgetModel.prototype,"tabCardOffset",1),__decorateClass$w([override],_TabsWidgetModel.prototype,"layoutRect",1),__decorateClass$w([observable],_TabsWidgetModel.prototype,"disableRoll",2),__decorateClass$w([action$1],_TabsWidgetModel.prototype,"pauseRollPlay",1),__decorateClass$w([action$1],_TabsWidgetModel.prototype,"continueRollPlay",1),__decorateClass$w([observable],_TabsWidgetModel.prototype,"stopOnHover",2),__decorateClass$w([action$1],_TabsWidgetModel.prototype,"setStopOnHover",1),__decorateClass$w([jsApi()],_TabsWidgetModel.prototype,"openHoverPauseRollPlay",1),__decorateClass$w([jsApi()],_TabsWidgetModel.prototype,"closeHoverPauseRollPlay",1),__decorateClass$w([override],_TabsWidgetModel.prototype,"childrenLimitRect",1),__decorateClass$w([observable],_TabsWidgetModel.prototype,"currentTabId",2),__decorateClass$w([action$1],_TabsWidgetModel.prototype,"setCurrentTabId",1),__decorateClass$w([computed],_TabsWidgetModel.prototype,"current",1),__decorateClass$w([computed],_TabsWidgetModel.prototype,"currentPage",1),__decorateClass$w([computed],_TabsWidgetModel.prototype,"currentPageModel",1),__decorateClass$w([override],_TabsWidgetModel.prototype,"availableChildWidgets",1),__decorateClass$w([override],_TabsWidgetModel.prototype,"needInitChildWidgets",1),__decorateClass$w([computed],_TabsWidgetModel.prototype,"visibleTabs",1),__decorateClass$w([computed],_TabsWidgetModel.prototype,"tabButtonType",1),__decorateClass$w([computed],_TabsWidgetModel.prototype,"isNavigatorType",1),__decorateClass$w([computed],_TabsWidgetModel.prototype,"isTabType",1),__decorateClass$w([computed],_TabsWidgetModel.prototype,"navigator",1),__decorateClass$w([computed],_TabsWidgetModel.prototype,"tabCard",1),__decorateClass$w([override],_TabsWidgetModel.prototype,"carousel",1),__decorateClass$w([computed],_TabsWidgetModel.prototype,"lazyLoad",1),__decorateClass$w([computed],_TabsWidgetModel.prototype,"isVertical",1),__decorateClass$w([computed],_TabsWidgetModel.prototype,"tabPadding",1),__decorateClass$w([computed],_TabsWidgetModel.prototype,"widgetGap",1),__decorateClass$w([computed],_TabsWidgetModel.prototype,"autoHeight",1),__decorateClass$w([computed],_TabsWidgetModel.prototype,"tabsDepth",1),__decorateClass$w([action$1],_TabsWidgetModel.prototype,"setVisibleTabs",1),__decorateClass$w([jsApi()],_TabsWidgetModel.prototype,"setTabVisible",1),__decorateClass$w([jsApi()],_TabsWidgetModel.prototype,"getShowIndex",1),__decorateClass$w([jsApi()],_TabsWidgetModel.prototype,"showCardByIndex",1),__decorateClass$w([jsApi({travel:!0,flatten:!0})],_TabsWidgetModel.prototype,"getPageContext",1);let TabsWidgetModel=_TabsWidgetModel;function FillTypeConfig$1(e){const{asset:t,fillType:r,backgroundFillType:n,borderScale:o,onFillTypeChange:i,onBackgroundFillTypeChange:a,onBorderScaleChange:s}=e,{resourceCenter:l}=useStore();if(isBaseResourceType(t)){const{imageSource:e,imageSlice:c}=getImageResource$1(l,t),u=!!e,d=u&&c.length>0;return jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,hide:!u,children:[jsx(LineItem,{label:"",hide:!d,children:jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Filling_Method"),children:jsx(RadioGroup$1,{value:r,className:"fill-type",options:FILL_TYPE_ITEMS,onChange:i})})}),jsx(LineItem,{label:"",hide:d,children:jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Filling_Method"),children:jsx(RadioGroup$1,{value:n,className:"background-fill-type",options:BACKGROUND_FILL_TYPE_ITEMS,onChange:a})})}),jsx(LineItem,{label:"",hide:!(d&&r===FILL_TYPE.BACKGROUND),children:jsx(RadioGroup$1,{value:n,className:"background-fill-type",options:BACKGROUND_FILL_TYPE_ITEMS,onChange:a})}),jsx(LineItem,{label:"",hide:!(d&&r===FILL_TYPE.BORDER),children:jsx(RadioGroup$1,{value:o,className:"border-image-scale",options:BORDER_SCALE_ITEMS,onChange:s})})]})}return jsx(Fragment,{})}const BorderConfig=observer((({border:e,onBorderChange:t,borderHue:r,borderOpacity:n,borderContrast:o,borderSaturation:i,borderBrightness:a,borderScale:s,onBorderScaleChange:l,backgroundFillType:c,onBackgroundFillTypeChange:u,fillType:d,onFillTypeChange:h,onBorderStyleChange:p,imageScopes:f=[IMAGE_SCOPE.BACKGROUND],hasOpacitySet:g=!0,showPlatform:m=!0,showOnlineMode:y=!0,tag:v="widget",label:_=duchampIntl.get("Duchamp-Border_Background")})=>{const{resourceCenter:b}=useStore(),C=!!getImageResource$1(b,e).imageSource,E=(C||"color"===e.type)&&g,T=C||E,S=[...C?["hue"]:[],...E?["opacity"]:[],...C?[["saturation","brightness","contrast"]]:[]];return jsxs(GridItem,{gapSize:GAP_SIZE.MIDDLE,children:[jsx(WidgetResourceSelector,{title:_,value:e,onChange:e=>{t(e)},imageScopes:f,showPlatform:m,tag:v,showOnlineMode:y}),jsxs(GridItem,{gapSize:GAP_SIZE.MIDDLE,style:{display:T?"":"none"},children:[jsx(FillTypeConfig$1,{asset:e,fillType:d,borderScale:s,backgroundFillType:c,onFillTypeChange:e=>{h(e)},onBackgroundFillTypeChange:e=>{u(e)},onBorderScaleChange:e=>{l(e)}}),jsx(LineItem,{label:"",hide:!T,children:jsx(FilterProcessPanel,{components:S,hue:r,opacity:n,contrast:o,saturation:i,brightness:a,onChange:(e,t,r)=>{null==p||p(t,r)},layout:"vertical"})})]})]})})),{Item:Item$2}=Tab$1,TabPaneConfig=observer((({widget:e})=>{const{platform:t}=e,r=e.getInstance(),n=useStore(),o=reactExports.useMemo((()=>toJS(t.borderRadius)),[t.borderRadius]);return jsx(Tab$1,{theme:"line",stretch:!0,tabHeaderStyle:{margin:"0 12px"},children:jsx(Item$2,{tab:duchampIntl.get("Duchamp-Tab_Pane"),className:"form-padding",children:jsxs(GridItem,{children:[jsx(NameConfig,{name:e.name,onNameChange:t=>{e.setName(t)},onCheckingName:t=>!n.story.widgets.some((r=>r.name===t&&r.id!==e.id))}),jsx(LineItem,{label:duchampIntl.get("Duchamp-Title_Content"),children:jsx(Input$2,{value:r.tabName,onChange:e=>{r.setTabName(e||"")}})}),jsx(BorderConfig,{tag:"widget",border:toJS(t.border),borderHue:t.borderHue,borderScale:t.borderScale,borderOpacity:t.borderOpacity,borderContrast:t.borderContrast,borderSaturation:t.borderSaturation,borderBrightness:t.borderBrightness,backgroundFillType:t.backgroundFillType,fillType:t.fillType,onBorderChange:e=>{n.undoManager.withGroup((()=>{t.setBorder(e)}))},onBorderStyleChange:(e,r)=>{switch(e){case"hue":t.setBorderHue(r);break;case"opacity":t.setBorderOpacity(r);break;case"brightness":t.setBorderBrightness(r);break;case"contrast":t.setBorderContrast(r);break;case"saturation":t.setBorderSaturation(r);break;default:return}},onBorderScaleChange:e=>{t.setBorderScale(e)},onBackgroundFillTypeChange:e=>{t.setBackgroundFillType(e)},onFillTypeChange:e=>{t.setFillType(e)}}),jsx(PlatformLineItem,{label:duchampIntl.get("Duchamp-Border_Line"),children:jsx(LineConfig,{allowNone:!0,value:e.platform.borderLine,onChange:t=>{e.platform.setBorderLine(t)}})}),jsx(PlatformLineItem,{label:duchampIntl.get("Duchamp-Border_Radius"),children:jsx(BorderRadiusConfig$1,{value:o,onChange:e=>{t.setBorderRadius(e)}})})]})},"0")})})),TAB_PANE_META={type:WIDGET_TYPE.TAB_PANE,widgetType:"tabPane",displayName:duchampIntl.get("Duchamp-Tab_Pane"),version:"0.0.1",icon:"",configure:{...STRUCTURE_WIDGET_META_CONFIG,resizable:!1,draggable:!1,hide:!0,acceptTip:duchampIntl.get("Duchamp-Tab_Pane_Drag_Release_Into_Tip"),acceptRule:{parentWhitelist:{rule:[WIDGET_TYPE.TABS],tip:duchampIntl.get("Duchamp-Tab_Pane_Can_Only_Drag_Into_Tab")}},defaultName:(e,t,r)=>createUniqueName(e,duchampIntl.get("Duchamp-Tab_Pane"),r?"_".concat(r.name):""),mobile:{fluidHeightGrid:FLUID_BLOCK_PARTS}},initialization:async({widget:e,parent:t,type:r})=>("create"===r&&e.setValue({tabName:createUniqueName((null==t?void 0:t.childWidgets.map((e=>e.props.tabName)))||[],duchampIntl.get("Duchamp-Tab_Pane"))}),!0),scale:!1};var __defProp$w=Object.defineProperty,__getOwnPropDesc$v=Object.getOwnPropertyDescriptor,__decorateClass$v=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$v(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$w(t,r,i),i};class TabPaneWidgetModel extends StructWidgetModel{constructor(e,t){super(e,t);const r=when((()=>!isNil$3(this.parentWidgetModel)),(()=>{if(!this.parentWidgetModel||this.store.isMagneticLayout)return;const{left:e,top:t,width:n,height:o}=this.parentWidgetModel.layoutRect,i={width:n,height:o,matrix:new Transform$2(this.widget.states.matrix).setTranslate(e,t).matrix},a={width:this.widget.states.width,height:this.widget.states.height,matrix:new Transform$2(this.widget.states.matrix).matrix};if(!isEqual$4(i,a)){const e=isEqual$4(a,pick(WIDGET_STATES,["width","height","matrix"]));this.store.undoManager.withoutUndo((()=>{this.widget.setStates(i),!e&&this.parentWidgetModel&&this.updateChildrenRectStates({cur:i,pre:a,ignoreSelf:!0})}))}r()}))}initStateChangeListeners(e){super.initStateChangeListeners(e),this.isPreview||this.disposes.push(reaction((()=>[this.magneticGap,this.magneticPadding]),(()=>{this.store.isMagneticLayout&&this.store.undoManager.withGroup((()=>{transferMagneticWidgets({widgets:this.mobileChildWidgets.filter((e=>e.visible)),options:this.magneticOptions,onlyCache:!0})}))}),{delay:500}))}get parentWidgetModel(){var e;return null==(e=this.widget.parentWidget)?void 0:e.getInstance()}get keepRatio(){var e,t;return null!=(t=null==(e=this.parentWidgetModel)?void 0:e.keepRatio)&&t}get tabName(){var e;return null!=(e=this.props.tabName)?e:this.name}setTabName(e){this.setProps({tabName:e})}get magneticGap(){var e,t;return null!=(t=null==(e=this.parentWidgetModel)?void 0:e.widgetGap)?t:0}get magneticPadding(){var e,t;return null!=(t=null==(e=this.parentWidgetModel)?void 0:e.tabPadding)?t:{top:0,bottom:0,left:0,right:0}}get magneticOptions(){const{left:e,top:t}=this.layoutRect;return{padding:this.magneticPadding,gap:this.magneticGap,width:this.layoutRect.width,offset:{left:e,top:t}}}get showScrollbar(){const{story:e}=this;return e&&!this.isResize&&[this.widget.parentWidget,...this.flattenChildWidgets].some((t=>t&&e.currents.has(t.id)))}get areaRect(){const{left:e,top:t,width:r,height:n}=this.layoutRect;if(!this.isPreview&&this.store.isMagneticLayout){const o=calculateAreaBound(this.mobileChildWidgets.map((e=>e.model.states)));return{left:e,top:t,width:r,height:Math.max(o.height+this.magneticPadding.top+this.magneticPadding.bottom,n)}}return calculateAreaBound([{width:r,height:n,matrix:new Transform$2(this.states.matrix).setTranslate(e,t).matrix},...this.childWidgets.map((e=>e.model.states))])}updateByChildren(e){this.store.isMagneticLayout||super.updateByChildren(e)}updateMagneticChildrenRectStates({cur:e,pre:t,onlyCache:r}){const{width:n=t.width,height:o=t.height}=e,{width:i,height:a}=t,s=this.magneticPadding.left+this.magneticPadding.right,l=this.magneticPadding.top+this.magneticPadding.bottom,c=(n-s)/(i-s),u=(o-l)/(a-l);transferMagneticWidgets({widgets:this.mobileChildWidgets.filter((e=>e.visible)),options:{...this.magneticOptions,width:n},sizeGetter:e=>{const{width:t,height:n}=getWidgetMagneticSize(e),{states:o}=e.model,i=!r&&this.keepRatio;setMagneticWidgetStates({widget:e,states:{width:t,height:n,matrix:o.matrix},onlyCache:r}),null==e||e.updateByChildren(r);const{width:a,height:s}=e.model.states;return{width:i?Math.round(a*c):a,height:i?Math.round(s*u):s}},onlyCache:r}),this.widget.platform.mobile.updateWidgetOrders()}}__decorateClass$v([override],TabPaneWidgetModel.prototype,"initStateChangeListeners"),__decorateClass$v([override],TabPaneWidgetModel.prototype,"parentWidgetModel"),__decorateClass$v([override],TabPaneWidgetModel.prototype,"keepRatio"),__decorateClass$v([computed],TabPaneWidgetModel.prototype,"tabName"),__decorateClass$v([computed],TabPaneWidgetModel.prototype,"magneticGap"),__decorateClass$v([computed],TabPaneWidgetModel.prototype,"magneticPadding"),__decorateClass$v([computed],TabPaneWidgetModel.prototype,"magneticOptions"),__decorateClass$v([override],TabPaneWidgetModel.prototype,"showScrollbar"),__decorateClass$v([override],TabPaneWidgetModel.prototype,"areaRect");const TabPaneView$1=observer((({model:e,expandIndex:t,adaptiveScale:r})=>jsx(StructContainer,{className:"tab-pane-container",model:e,emptyTip:duchampIntl.get("Duchamp-Default_Tab_Pane_Text"),outline:!1,overflow:"auto",adaptiveScale:r,children:e.childWidgets.map((e=>jsx(WidgetWrapper,{widget:e,expandIndex:t,adaptiveScale:r},e.id)))}))),TabPaneView=observer((({model:e,expandIndex:t,width:r,height:n,adaptiveScale:o})=>{const{magneticGap:i}=e;return jsx(StructureContainer,{model:e,adaptiveScale:o,widgetGap:i,previewLayout:e.mobilePreviewLayout,expandIndex:t,width:r,height:n})})),DIRECTION={LEFT:"left",RIGHT:"right"},DIRECTION_ROTATE={[DIRECTION.LEFT]:-180,[DIRECTION.RIGHT]:0},VERTICAL_DIRECTION_ROTATE={[DIRECTION.LEFT]:270,[DIRECTION.RIGHT]:90},Arrow=({hide:e,direction:t="left",type:r,arrowIndex:n=0,arrowStyle:o,vertical:i,disabled:a=!1,onClick:s})=>{const l=i?VERTICAL_DIRECTION_ROTATE[t]:DIRECTION_ROTATE[t],c=useAssetUrl("/slideshow/arrow/arrow".concat(n,".png"));return jsx("div",{className:classNames$1("duchamp-button-group-arrow",t,{vertical:i,disabled:a,hide:e}),onClick:()=>{!a&&(null==s||s())},children:(e=>{switch(e){case BUTTON_GROUP_TYPE.UNDERLINE:return jsx(Icon$2,{svgContent:SvgIconPlay,type:"icon-play",rotate:l,style:o});case BUTTON_GROUP_TYPE.BUTTON:return jsx(Icon$2,{svgContent:SvgIconNextpageS,type:"icon-nextPage-s",style:o,rotate:l});case BUTTON_GROUP_TYPE.SCIENCE:return jsx("img",{className:"duchamp-science-arrow",src:c,style:{transform:"rotate(".concat(l,"deg)")},alt:"arrow"});default:return jsx(Fragment,{})}})(r)})},ScienceButtonContent=observer((({config:e,tab:t,text:r,style:n})=>{const{layout:o}=e;return jsxs("div",{style:getButtonWrapperStyle(e,t),children:[jsx("div",{className:"duchamp-tab-button-bg",style:getButtonBgStyle(e,t)}),jsx("div",{className:classNames$1("duchamp-tab-title",o),style:{justifyContent:o===BUTTON_GROUP_LAYOUT.EQUAL?e.alignItem:"center",...n},children:jsx("span",{children:r})})]})})),TabButton=observer((({size:e,items:t,selectIndex:r,config:n,tab:o,vertical:i=!1,className:a,style:s,onChange:l,showAddButton:c=!1,showDeleteButton:u,onDelete:d,onAdd:h})=>{const{position:p,showType:f,templateType:g,layout:m,tabArrow:y}=n,[v,_]=reactExports.useState(!1),b=u?"top"===p||"bottom"===p?{paddingRight:12}:{paddingBottom:16}:void 0,C=reactExports.useRef(null),E=usePrevious(r);return useUpdateEffect$2((()=>{var e;r!==E&&(null==(e=C.current)||e.scrollToNodeByIndex(r,{alignTop:r<(E||0)}))}),[r]),jsxs("div",{className:classNames$1(a,"duchamp-slideshow-tab",p,f),style:s,children:[jsx(ButtonGroup,{ref:C,className:"group",vertical:i,type:g,layout:m,value:r,position:p,horizontalScroll:!0,leftIcon:jsx(Arrow,{hide:!v,direction:"left",vertical:i,type:g,arrowIndex:(null==y?void 0:y.value)||0}),rightIcon:jsx(Arrow,{hide:!v,direction:"right",vertical:i,type:g,arrowIndex:(null==y?void 0:y.value)||0}),onButtonOverflow:_,onChange:l,style:getButtonGroupStyle({...n,buttonHeight:e},getTabCardExtendsStyle(e,i,n.characterStyle,n.tabArrow,null==o?void 0:o.offset)),children:t.map((({text:e,name:t},r)=>jsx(Button,{value:r,children:jsxs(Fragment,{children:[g===BUTTON_GROUP_TYPE.SCIENCE?jsx(ScienceButtonContent,{config:n,tab:o,text:e,style:b}):jsx("div",{style:{...b,overflow:"hidden",textOverflow:"ellipsis"},children:e}),u&&jsx("div",{className:"icon-close",children:jsx(Icon$2,{type:"icon-close-nocircle-tabs-1",title:duchampIntl.get("Duchamp-Tab_Pane_Delete"),onClick:e=>{e.stopPropagation(),null==d||d(r)}})})]})},r)))}),c&&jsx("div",{className:"icon-add",children:jsx(Icon$2,{type:"icon-add",title:duchampIntl.get("Duchamp-Tab_Pane_New"),onClick:h})})]})})),TabsView$1=observer((({model:e,expandIndex:t,adaptiveScale:r})=>{const n=useStore(),{story:o}=n,{visibleTabs:i,current:a,tabButtonType:s,isTabType:l,isNavigatorType:c,isVertical:u,navigator:d,tabCard:h,childWidgets:p}=e,f=reactExports.useMemo((()=>{const e=TAB_CARD_SIZE_MULTIPLE$1*h.characterStyle.fontSize;return u?calculateAdaptiveScaleStyle({adaptiveScale:r,style:{width:e}}).width:calculateAdaptiveScaleStyle({adaptiveScale:r,style:{height:e}}).height}),[r,u,h.characterStyle.fontSize]),g=reactExports.useMemo((()=>l&&h.showType===TABS_SHOW_TYPE.FIX&&i.length>0?calculateAdaptiveScaleStyle({adaptiveScale:r,style:{tabsMargin:f},withTransform:!1}).tabsMargin:0),[r,f,l,h.showType,i.length]),m=t=>{const r=i.length-1,n=t<0?r:t>r?0:t;e.switchTab(n),o.setCurrents([i.length>0?i[n].id:e.id])},y=reactExports.useMemo((()=>{if(e.disableRoll||!e.isPreview||isNil$3(e.carousel))return null;const{autoplay:t,autoplaySpeed:r}=e.carousel;return t&&r?timeUnitToMillisecond(oldTime2TimeMillisecond(r)):null}),[e.carousel,e.disableRoll]);return useInterval$1((()=>{m(a+1)}),y),jsxs("div",{className:"duchamp-slideshow",children:[jsx("div",{className:"duchamp-slideshow-content",style:{position:"absolute",top:0,bottom:0,left:0,right:0,[h.position]:g},children:jsx(StructContainer,{model:e,emptyTip:duchampIntl.get("Duchamp-Default_Tab_Text"),outline:o.currentWidgets.every((e=>!p.includes(e))),adaptiveScale:r,offset:{[h.position]:g},children:i.map(((e,n)=>jsx(LazyRenderWrapper,{visible:n===a,children:(n,o)=>jsx(WidgetWrapper,{adaptiveScale:r,widget:e,expandIndex:t,className:"slideshow-item",style:o})},e.id)))})}),jsx(TabsNavigation,{className:classNames$1({hide:!c}),navigator:d,tabsLength:i.length,current:a,onPageChange:m,adaptiveScale:r}),jsx(TabButton,{className:classNames$1(s,{hide:!(l&&i.length>0)}),style:calculateAdaptiveScaleStyle({direction:h.position,adaptiveScale:r,style:u?{height:"100%"}:{width:"100%"}}),items:i.map((e=>({text:e.getInstance().tabName,name:e.name}))),selectIndex:a,size:f,config:h,vertical:u,onChange:e=>{m(Number(e))},tab:INTERNAL_TABS[h.interinalIndex],showAddButton:!e.isPreview,showDeleteButton:!e.isPreview,onAdd:()=>{e.addTabPane()},onDelete:t=>{e.deleteTabPane(i[t])}})]})})),TAB_CARD_LAYOUT_MAP={equal:"equal",initial:"default"},TEMPLATE_TYPE_MAP={[BUTTON_GROUP_TYPE.BUTTON]:"solid-button",[BUTTON_GROUP_TYPE.SCIENCE]:"science",[BUTTON_GROUP_TYPE.UNDERLINE]:"underline"},TAB_CARD_SIZE_MULTIPLE=2.3,SCIENCE_BUTTON_PADDING_RATIO=.65,useTabStyles=e=>{const{adaptiveScale:t,isVertical:r,tabCardSize:n,useStickyOffset:o,tabCardOffset:i,tabCard:a,marginOffset:s=0,navigatorSize:l,stickyWidgetOffset:c}=e,{characterStyle:u,templateType:d}=a,{height:h,stickyOffset:p,tabSize:f,padding:g}=calculateAdaptiveScaleStyle({adaptiveScale:t,style:{height:r?u.fontSize*TAB_CARD_SIZE_MULTIPLE:n,stickyOffset:i,tabSize:n,padding:u.fontSize*SCIENCE_BUTTON_PADDING_RATIO},withTransform:!1}),m=calculateAdaptiveScaleStyle({adaptiveScale:t,style:getButtonGroupStyle({...a,buttonHeight:n},{"--margin-offset":"".concat(s,"px"),"--tab-card-size":"".concat(n,"px"),...u,...r?{height:"100%"}:{width:"100%"},...d===BUTTON_GROUP_TYPE.SCIENCE&&{"--active-background":"transparent","--background":"transparent"}})}),y=p+c,v=o?{"--tab-card-sticky-offset":"".concat(p,"px"),scrollMargin:y}:{},_=calculateAdaptiveScaleStyle({adaptiveScale:t,style:{width:l,height:l},withTransform:!1});return{containerStyle:v,swiperStyle:{"--tab-card-size":"".concat(f,"px")},tabPropsStyle:m,navigatorStyle:_,swiperOffset:h,scrollMargin:y,scienceButtonStyle:{padding:g}}},TabsView=observer((({model:e,width:t,height:r,adaptiveScale:n,expandIndex:o})=>{var i,a;const s=reactExports.useRef(null),l=reactExports.useRef(null),c=reactExports.useRef([]),[u,d]=reactExports.useState(),{story:h}=useStore(),p=(null==(a=null==(i=h.stickyInfo.widget)?void 0:i.target)?void 0:a.getBoundingClientRect().height)||0,{visibleTabs:f,tabButtonType:g,tabCard:m,navigator:y,carousel:v,current:_,isVertical:b,isPreview:C,lazyLoad:E,tabCardSize:T,tabCardOffset:S,mobileLayoutConfig:P}=e,{characterStyle:w,interinalIndex:x,position:O,templateType:$,alignItem:I,layout:R}=m,A=isFluidLayout(P),D=INTERNAL_TABS[x],{containerStyle:L,swiperStyle:N,tabPropsStyle:M,navigatorStyle:k,scrollMargin:F,scienceButtonStyle:j,swiperOffset:B}=useTabStyles({useStickyOffset:A,marginOffset:null==D?void 0:D.offset,adaptiveScale:n,isVertical:b,tabCardSize:T,tabCard:m,tabCardOffset:S,stickyWidgetOffset:p,navigatorSize:y.size}),W=(A?e.mobileProps.tabPadding:void 0)||{left:0,right:0,top:0,bottom:0},V=useNavigatorStyle(y);reactExports.useEffect((()=>{var e;null==(e=l.current)||e.swipeTo(_)}),[_]);return f.length?jsx("div",{ref:s,className:classNames$1("duchamp-slideshow",{"sticky-tabs":A&&!b}),style:C?L:void 0,children:jsx(Swiper,{lazyLoadCount:E?0:void 0,animated:null==v?void 0:v.swiperAnimation,swiperRef:l,className:classNames$1("fvs-mobile-swiper",O),style:N,swipeButtonType:g,showPoint:y.showPoint,autoplay:(null==v?void 0:v.autoplay)&&C,autoplayInterval:(null==v?void 0:v.autoplaySpeed)&&timeUnitToMillisecond(oldTime2TimeMillisecond(v.autoplaySpeed)),allowTouchMove:!!(null==v?void 0:v.swiper)&&C,indicatorProps:{style:{"--dot-color":hexToRgba(y.color),"--active-dot-color":hexToRgba(y.color)}},loop:!0,tabsWrapperProps:{className:classNames$1("duchamp-tabs-swiper-wrapper",O),style:b?{width:B,height:u}:{height:B}},tabsProps:{type:TEMPLATE_TYPE_MAP[$],position:O,layout:TAB_CARD_LAYOUT_MAP[R],style:M,className:classNames$1($,R)},navigatorWrapperStyle:{width:k.width,height:k.height},navigatorIcon:jsx("div",{style:{transform:M.transform,transformOrigin:M.transformOrigin},children:jsx(ReactSVG$1,{beforeInjection:V,src:createAbsoluteUrl("/assets/slideshow/navigator.svg")})}),onIndexChange:t=>{if(e.switchTab(t),c.current[t]&&d(c.current[t]),!s.current||!A||(null==v?void 0:v.autoplay))return;const{top:r}=s.current.getBoundingClientRect();r<F&&s.current.scrollIntoView({behavior:"smooth",block:"start"})},children:f.map(((i,a)=>{const s=i.getInstance().tabName;return jsx(Swiper.Item,{style:{...E&&a!==_&&{display:"none"},height:C&&u?"".concat(u,"px"):"100%"},label:$===BUTTON_GROUP_TYPE.SCIENCE?jsx(ScienceButtonContent,{config:m,tab:D,text:s,style:j}):s,tabProps:{className:O,style:{textAlign:TEXT_ALIGN_ITEM_MAP[I]}},children:i.visibleInStory&&jsx(SwiperItem,{model:e,widget:i,height:r,width:isNil$3(r)&&b?t-w.fontSize*TAB_CARD_SIZE_MULTIPLE:t,tabPadding:W,adaptiveScale:n,onSizeChange:e=>{_===a&&d(e),c.current[a]=e},expandIndex:o})},i.id)}))})}):jsx(Fragment,{})})),SwiperItem=observer((({model:e,widget:t,width:r,height:n,tabPadding:o,adaptiveScale:i,onSizeChange:a,expandIndex:s})=>{const l=useStore(),c=reactExports.useRef(null),u=useResizeDetector({targetRef:c,refreshMode:"throttle",refreshRate:200,refreshOptions:{leading:!0}}),d=o.top+o.bottom,{tabCardSize:h,tabCard:{position:p}}=e;return reactExports.useEffect((()=>{const e=u.height?u.height+d:u.height;null==a||a(null!=e?e:0)}),[u.height,d]),jsx("div",{className:"duchamp-swiper-item",ref:c,style:{paddingTop:null==o?void 0:o.top,paddingLeft:null==o?void 0:o.left,paddingRight:null==o?void 0:o.right,paddingBottom:null==o?void 0:o.bottom,height:isNil$3(n)?"none":"100%"},children:n?e.isPreview?jsx(WidgetWrapper,{widget:t,expandIndex:s,adaptiveScale:i,withPosition:!1}):jsx(StructContainer,{model:e,emptyTip:duchampIntl.get("Duchamp-Default_Tab_Text"),outline:l.story.currentWidgets.every((t=>!e.childWidgets.includes(t))),offset:{[p]:h},children:jsx(WidgetWrapper,{widget:t,adaptiveScale:i,expandIndex:s})}):jsx(FluidWidgetView,{widget:t,expandIndex:s,adaptiveScale:i,width:r-o.left-o.right})})})),PlatformCollapseHeader=observer((({title:e})=>jsxs("div",{className:"platform-collapse-header",children:[jsx(PlatformPopoverIcon,{}),e]}))),RichTextConfigPanel=observer((({widget:e})=>{var t,r;const n=e.getInstance(),o=useLatest$3(e),i=useStore();return jsx(CollapseGroup,{defaultActiveKey:["1","2"],items:[{key:"1",label:jsx(PlatformCollapseHeader,{title:duchampIntl.get("Duchamp-Content_Style")}),children:jsxs(Fragment,{children:[jsx(RichText$1,{value:{ops:null!=(t=n.props.values)?t:[],attributes:{verticalAlign:n.props.verticalAlign}},onChange:e=>{var t;null==(t=o.current)||t.model.setPlatformProps({values:e.ops,...e.attributes&&has$2(e.attributes,"verticalAlign")&&{verticalAlign:e.attributes.verticalAlign}})},toolbar:{position:RICH_TEXT_TOOLBAR_POSITION.TOP,value:getToolbarWithEmbed()},className:"rich-text-config-wrapper",style:getThemeStyle$1(i),defaultFormats:{...getThemeStyle$1(i),verticalAlign:n.props.verticalAlign},innerClassName:"rich-text-config",placeholder:duchampIntl.get("Duchamp-Please_Enter_Text_Content")}),i.isMagneticLayout&&jsx(AutoHeightConfig,{value:n.autoHeight,onChange:e=>n.setAutoHeight(e),style:{marginBottom:12},"data-focus-point":{id:"S264",trigger:"onChange",getParam:()=>({value:n.autoHeight?"1":"2"})}})]})},{key:"2",label:jsx(MarqueeHeader,{}),children:jsx(MarqueeConfig,{value:toJS(null!=(r=null==e?void 0:e.props.marquee)?r:DEFAULT_MARQUEE_CONFIG),onChange:t=>{null==e||e.setValue({marquee:t})}})}]})})),RICH_TEXT_META={type:WIDGET_TYPE.RICH_TEXT,displayName:duchampIntl.get("Duchamp-Rich_Text"),version:"0.0.2",iconfont:"icon-rich-text-components",dragPreviewImage:"/assets/widget/text.svg",widgetType:"text",states:{width:240,height:128},props:{value:null,verticalAlign:RICH_TEXT_VERTICAL_ALIGN.START},configuration:e=>jsx(RichTextConfigPanel,{...e}),configure:{mobile:{fluidHeightGrid:FLUID_BLOCK_PARTS}}},blotRender=(e,t)=>{const{icon:r,iconSource:n}=t;r&&createRoot$1(e).render(jsx("span",{className:"dynamic-value-img",style:getDynamicValueIconStyles(r,n)}))},getDynamicValueIconStyles=(e,t)=>(null==e?void 0:e.enabled)?t?{...getFilterStyle(e.filter),...getMarginStyles(e.position),...getBackgroundStyles(t,e.fillType)}:{...getMarginStyles(e.position)}:{},getMarginStyles=e=>{const t=e===DYNAMIC_VALUE_ICON_POSITION.FRONT;return{marginLeft:e===DYNAMIC_VALUE_ICON_POSITION.BACK?"2px":"0",marginRight:t?"2px":"0"}},getBackgroundStyles=(e,t)=>convertBackgroundStyle({imageSource:e,backgroundFillType:t});function useMarquee({marquee:e,ref:t}){const[r,n]=reactExports.useState(null);reactExports.useEffect((()=>(null==r||r.start(),()=>{null==r||r.stop()})),[r]);return{updateMarquee:reactExports.useCallback((()=>{var r;const o=null==(r=t.current)?void 0:r.getRoot();o&&e&&e&&n(new DomScrollAction$1(e,o,Array.from(o.children)))}),[e])}}function RichTextInPreview(e){const{config:t,theme:r}=e,{values:n,verticalAlign:o,marquee:i}=t,a={color:r.textColor,userSelect:"text"},s=reactExports.useRef(null),{updateMarquee:l}=useMarquee({marquee:i,ref:s}),c=reactExports.useMemo((()=>[{key:IMAGE_EMBED_KEY,render:blotRender}]),[]),u=reactExports.useMemo((()=>o?{display:"flex",flexDirection:"column",justifyContent:FLEX_ALIGN_MAP[o]}:{}),[o]),d=reactExports.useMemo((()=>({ops:n,attributes:{verticalAlign:o}})),[n,o]);return jsx(RichTextCore,{className:"d-text-view quill-rich-text",value:d,embeds:c,style:a,innerStyle:u,ref:s,readOnly:!0,...i&&{onInstanceUpdate:()=>{l()}}})}const isEmpty$1=e=>!e.length||1===e.length&&"\n"===e[0].insert;function RichTextInEdit(e){const{t:t}=useI18n();if(isEmpty$1(e.config.values))return jsx(Empty,{className:"p-absolute",description:t("Duchamp-Rich_Text_Empty_Tip")});const r={...e,config:{...e.config,marquee:void 0}};return jsx(RichTextInPreview,{...r})}const RICH_TEXT_FORMULA_KEY="value",RichText=observer((({model:e,expandIndex:t})=>{var r;const{verticalAlign:n,values:o,marquee:i}=e.props,a=useEnv(),s={theme:e.theme,config:{values:configKit$1.richText.transform({config:null!=(r=toJS(o))?r:[],compute:{computedResult:e.calculateResult,index:null!=t?t:0,key:RICH_TEXT_FORMULA_KEY},resource:o?new ResourceHandler(e.store.resourceCenter,fvsService.getEnvInfo().resourceBaseUrl).getResources(configKit$1.richText.getResourceConfig(o)):{},env:a}),verticalAlign:n,marquee:i},state:{width:e.width,height:e.height,name:e.name}};return jsx(FVSWidgetProvider,{model:e,children:e.isPreview?jsx(RichTextInPreview,{...s}):jsx(RichTextInEdit,{...s})})}));function isInstanceofFontCollector(e){return void 0!==(null==e?void 0:e.collectFonts)}async function collectStoryBuiltInFonts(e,t,r){const n={},o=(e,r)=>{if(!e)return;const o=standardizeFonts(e).filter((e=>t.includes(e)));o.length>0&&(n[r]=o)};e.widgets.forEach((e=>{const t=e.getInstance();isInstanceofFontCollector(t)?o(t.collectFonts(),e.id):o(collectWidgetCommonFonts(e),e.id)}));const i=await collectWorkbookAndChartBuiltInFonts(r,e.widgets);for(const a in i)o(i[a],a);return n}function collectWidgetCommonFonts(e){const{widgetEvents:t}=e,{fontFamily:r}=e.getInstance().props,n=new Set;return r&&n.add(r),t.flatMap((e=>e.events)).flatMap((e=>e.actions)).forEach((e=>{if("webPagePopover"===e.type){const{url:t}=e.body;if(t&&"textPrompt"===t.pathType){const{value:e}=t;e&&processRichTextProps(e.value).forEach((e=>n.add(e)))}}})),Array.from(n)}function standardizeFonts(e){return e.filter((e=>null!=e)).map((e=>e.replace(/^["']|["']$/g,"")))}const collectWorkbookAndChartBuiltInFonts=async(e,t)=>{const r={},n=[],o=t.map((async e=>{const t=e.getInstance(),{fieldConfigs:r}=t;(widgetIsWorkbook(e.type)||widgetIsChart(e))&&n.push({key:e.id,configs:Array.from(r.values())})}));try{await Promise.all(o);const t=await e.computeFieldFont({fields:n});if(!responseIsError$1(t))for(const e in t){const n=t[e];n.length&&(r[e]=n)}}finally{for(const e in r)r[e].length||delete r[e]}return r};function processRichTextProps(e){const t=new Set;return null==e||e.forEach((({attributes:e})=>{const r=null==e?void 0:e.font;"string"==typeof r&&r&&t.add(r)})),[...t]}var __defProp$v=Object.defineProperty,__getOwnPropDesc$u=Object.getOwnPropertyDescriptor,__decorateClass$u=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$u(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$v(t,r,i),i};class RichTextModel extends BaseWidgetModel{constructor(){super(...arguments),__publicField(this,"calculateResult",new Map)}get autoHeight(){var e;return null==(e=this.props.autoHeight)||e}setAutoHeight(e){this.setPlatformProps({autoHeight:e})}setMarqueeStopOnHover(e){this.props.marquee&&this.setProps({marquee:{...this.props.marquee,stopOnHover:e}})}openHoverPauseRollPlay(){this.setMarqueeStopOnHover(!0)}closeHoverPauseRollPlay(){this.setMarqueeStopOnHover(!1)}get fieldConfigs(){var e,t;const r=configKit$1.richText.getComputeConfig({config:[...null!=(e=this.widget.props.values)?e:[],...null!=(t=this.mobile.props.values)?t:[]],options:{key:RICH_TEXT_FORMULA_KEY}});return widgetIsInExpand(this.widget)?removeSummaryConfig(r):r}setFieldValues(e,t){var r;super.setFieldValues(e,t);const n=new Map([...this.calculateResult,...e]),o=new Map,i=configKit$1.richText.getComputeConfig({config:null!=(r=this.props.values)?r:[],options:{key:RICH_TEXT_FORMULA_KEY}});[...i.keys()].forEach((e=>{if(e===RICH_TEXT_FORMULA_KEY){const e=n.get(RICH_TEXT_FORMULA_KEY);if(isArray$c(e)){const t=i.get(RICH_TEXT_FORMULA_KEY).columns.length;o.set(RICH_TEXT_FORMULA_KEY,e.slice(this.isMobile?-t:0))}}else o.set(e,n.get(e))})),this.calculateResult=o}collectFonts(){const e=[];return this.props.values&&Array.isArray(this.props.values)&&e.push(...processRichTextProps(this.props.values)),e}getDynamicValues(){var e,t;const r=[];return[...null!=(e=this.widget.props.values)?e:[],...null!=(t=this.mobile.props.values)?t:[]].forEach((e=>{if(isDynamicValueOp(e)){const{fx:t}=e.insert[DYNAMIC_VALUE_EMBED_KEY];r.push(t)}})),r}replaceData(e){super.replaceData(e);const{replacement:t}=e,r=this.widget.props.values,n=this.mobile.props.values;isNil$3(r)||this.setProps({values:replaceOpsData(r,t)}),isNil$3(n)||this.widget.platform.mobile.setValue({values:replaceOpsData(n,t)})}mergeProps(e,t){return{...e,...t}}onPropsChange(e,t){isEqual$4(e.values,t.values)||0!==this.fieldConfigs.size&&this.refresh()}collectResourceIDs(){const e=super.collectResourceIDs(),t=[...this.props.values||[],...this.mobile.props.values||[]],r=configKit$1.richText.getResourceConfig(t);return e.concat(r)}}__decorateClass$u([jsApi()],RichTextModel.prototype,"openHoverPauseRollPlay",1),__decorateClass$u([jsApi()],RichTextModel.prototype,"closeHoverPauseRollPlay",1),__decorateClass$u([observable.ref],RichTextModel.prototype,"calculateResult",2);const TEXT_ALIGN_DEFAULT_VALUE=TEXT_LAYOUT.LEFT,TEXT_ALIGN_CONFIG={name:"textAlign",title:duchampIntl.get("Duchamp-Horizontally_Align"),value:TEXT_ALIGN_DEFAULT_VALUE,type:"radioGroup",buttonStyle:"solid",optionType:"button",options:[{label:jsx(Icon$2,{type:"icon-align-left",title:duchampIntl.get("Duchamp-Align_Left")}),value:TEXT_LAYOUT.LEFT},{label:jsx(Icon$2,{type:"icon-align-vertically",title:duchampIntl.get("Duchamp-Align_Center")}),value:TEXT_LAYOUT.CENTER},{label:jsx(Icon$2,{type:"icon-align-right",title:duchampIntl.get("Duchamp-Align_Right")}),value:TEXT_LAYOUT.RIGHT}]},VERTICAL_ALIGN_DEFAULT_VALUE=ALIGN$1.CENTER,VERTICAL_ALIGN_CONFIG={name:"verticalAlign",title:duchampIntl.get("Duchamp-Vertically_Align"),value:VERTICAL_ALIGN_DEFAULT_VALUE,type:"radioGroup",buttonStyle:"solid",optionType:"button",options:[{label:jsx(Icon$2,{type:"icon-text-align-top",title:duchampIntl.get("Duchamp-Align_Top")}),value:ALIGN$1.START},{label:jsx(Icon$2,{type:"icon-text-align-middle",title:duchampIntl.get("Duchamp-Vertically_Centered")}),value:ALIGN$1.CENTER},{label:jsx(Icon$2,{type:"icon-text-align-bottom",title:duchampIntl.get("Duchamp-Align_Bottom")}),value:ALIGN$1.END}]},DEFAULT_TIME_FORMAT={type:DATE_FORMAT_TYPE.YMD_HMS,value:getFormatsByDateFormatType(DATE_FORMAT_TYPE.YMD_HMS)[0]},TIME_WIDGET_CONFIG=[{name:"icon",displayName:duchampIntl.get("Duchamp-Icon"),type:"iconConfigPanel",placeholder:duchampIntl.get("Duchamp-Please_Enter_A_Title"),value:{enabled:!1,color:getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.TEXT),size:14,iconSpacing:4}},{name:"dateTime",displayName:duchampIntl.get("Duchamp-Date_Time"),type:"toggleDateFormatConfig",value:{enabled:!0,dateTimeFormat:DEFAULT_TIME_FORMAT}},{name:"week",displayName:duchampIntl.get("Duchamp-Week"),type:"weekDayFormat",value:{enabled:!0,weekFormat:DEFAULT_WEEKDAY_FORMAT}},{type:"verticalLayout",displayName:duchampIntl.get("Duchamp-Word"),children:[{name:"fontFamily",title:duchampIntl.get("Duchamp-Font"),value:TEXT.FONT_FAMILY,type:"fontSelect"},{name:"style",title:duchampIntl.get("Duchamp-Style"),value:{fontSize:14},type:"title-style",mobileProperties:["fontSize"],showTypes:{bold:!0,italic:!0,underline:!0},prefixIcon:jsx(PlatformPopoverIcon,{})},{name:"color",title:duchampIntl.get("Duchamp-Color"),value:getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.TEXT),type:"compositeColorSelector"},{name:"textShadow",title:duchampIntl.get("Duchamp-Shadow"),type:"shadowInput",hideSetting:!0,value:{enabled:!1,boxShadow:[]}},{name:"letterSpacing",title:duchampIntl.get("Duchamp-Basic_Letter_Spacing"),value:0,min:0,type:"number",suffix:"px",style:{width:"100%"},platforms:["pc","mobile"]},{name:"wordSpacing",title:duchampIntl.get("Duchamp-Basic_Word_Spacing"),value:8,min:0,type:"number",suffix:"px",style:{width:"100%"},platforms:["pc","mobile"]}]},{type:"verticalLayout",displayName:duchampIntl.get("Duchamp-Basic_Layout"),children:[TEXT_ALIGN_CONFIG,VERTICAL_ALIGN_CONFIG],platforms:["pc","mobile"]}],TIME_WIDGET_META={type:"d-text-time",displayName:duchampIntl.get("Duchamp-Time"),version:"0.0.1",iconfont:"icon-time-components",dragPreviewImage:"/assets/widget/text_time.svg",widgetType:"text",refresh:!1,states:{width:290,height:28},props:{verticalAlign:VERTICAL_ALIGN_DEFAULT_VALUE},configuration:TIME_WIDGET_CONFIG,configure:{mobile:{fluidHeightGrid:FLUID_LINE_PARTS}}};class TimeWidgetModel extends BaseWidgetModel{get transitionDuration(){return this.store.mainStory.transition.duration}}const getLayoutStyle=e=>({...configKit.textAlign.getCssStyle(e.textAlign),...configKit.verticalAlign.getCssStyle(e.verticalAlign)}),getIconStyle=e=>{const{size:t,iconSpacing:r,color:n}=e;return{fontSize:t,marginRight:r,...configKit.color.getCssStyle(n)}},getIconGradientConfig=e=>{const{color:t}=e;return isString$4(t)?void 0:t},getContentStyle=(e,t)=>{const{fontFamily:r,style:n,color:o,textShadow:i,letterSpacing:a,wordSpacing:s}=e;return{fontFamily:r,letterSpacing:a,wordSpacing:s,...getTransitionStyle(t),...n,...configKit.color.getCssStyle(o),...configKit.textShadow.getCssStyle(i)}},getFormattedTime=(e,{dateTime:t,week:r})=>{const n=configKit.dateTimeFormat.getFormattedDateTime(e,t),o=configKit.weekDayFormat.getFormattedWeekDay(e,r);return n&&o?"".concat(n," ").concat(o):n||o},Time=e=>{const[t,r]=reactExports.useState(new Date),{config:n,transition:o}=e,{icon:i}=n;return reactExports.useEffect((()=>{const e=setInterval((()=>{r(new Date)}),1e3);return()=>{clearInterval(e)}}),[]),jsx("div",{className:"d-text-time",style:getLayoutStyle({textAlign:n.textAlign,verticalAlign:n.verticalAlign}),children:jsxs("div",{className:"d-text-time-content",children:[(null==i?void 0:i.enabled)&&jsx(Icon$2,{type:"icon-time-fill",svgContent:SvgIconFillTime,style:getIconStyle(i),gradientConfig:getIconGradientConfig(i)}),jsx("div",{style:getContentStyle(n,o),children:getFormattedTime(t,n)})]})})},getTimeConfig=e=>{const t=toJS(e.props);return{icon:configKit$1.timePrefixIcon.transform(t.icon),dateTime:configKit$1.dateTimeFormat.transform(t.dateTime),week:configKit$1.weekDayFormat.transform(t.week),fontFamily:configKit$1.fontFamily.transform(t.fontFamily),style:configKit$1.style.transform(t.style),color:configKit$1.color.transform(t.color),textShadow:configKit$1.textShadow.transform(t.textShadow),letterSpacing:configKit$1.numberInput.transform(t.letterSpacing),wordSpacing:configKit$1.numberInput.transform(t.wordSpacing),textAlign:configKit$1.textAlign.transform(t.textAlign),verticalAlign:configKit$1.verticalAlign.transform(t.verticalAlign)}},TimeWidgetView=observer((({model:e})=>{const t="start"===e.transitionStatus?{duration:timeUnitToMillisecond(oldTime2TimeMillisecond(e.transitionDuration))}:void 0;return jsx(Time,{config:getTimeConfig(e),transition:t})})),TITLE_VALUE_TYPE={STRING:"string",DYNAMIC_VALUE:"dynamicValue"};function createDynamicValue(){return{id:uuid$1(),source:DEFAULT_DYNAMIC_DATASET_SOURCE,formatter:{type:FORMATTER_TYPE.NORMAL,value:""},conditionStyles:[]}}function getDefaultMarqueeConfig(){return{enable:!1,direction:MARQUEE_DIRECTION.LEFT,speed:50,stay:{type:TIME_UNIT$1.SECOND,value:1}}}const ValueConfig$1=observer((e=>{const{value:t,onChange:r,defaultStyle:n}=e,o=useDraft(t,r),i=useFocusPointTarget(),[a,s]=reactExports.useState(!1),l=[{label:duchampIntl.get("Duchamp-String"),value:TITLE_VALUE_TYPE.STRING},{label:duchampIntl.get("Duchamp-Dynamic_Value"),value:TITLE_VALUE_TYPE.DYNAMIC_VALUE}];return jsxs("div",{className:"title-value-config",children:[jsx(RadioGroup$1,{onChange:e=>{e===TITLE_VALUE_TYPE.STRING?r(duchampIntl.get("Duchamp-Heading_1")):r(createDynamicValue())},optionType:"button",buttonStyle:"solid",value:isString$3(t)?TITLE_VALUE_TYPE.STRING:TITLE_VALUE_TYPE.DYNAMIC_VALUE,options:l}),jsx("div",{className:"title-value-content",children:isString$3(t)?jsx(Input$2,{value:t,onChange:r}):jsxs("div",{className:"dynamic-value-trigger",children:[jsx(Button$4,{onClick:()=>s(!0),block:!0,"data-focus-point":{id:"S91",getTarget:()=>i},children:duchampIntl.get("Duchamp-Edit_Dynamic_Value")}),jsx(DynamicValueInfoPanel,{value:t})]})}),a&&isDynamicValue(t)&&n&&jsx(DynamicValueEditor,{defaultValue:t,onCancel:()=>{s(!1),o.reset()},onConfirm:e=>{o.commit(e),s(!1)},onValueChange:e=>{o.change({...t,...e})},defaultStyle:n})]})})),DynamicValueInfoPanel=observer((({value:e})=>{const{source:t}=e;return jsx("div",{className:"dynamic-value-info-panel",children:isDynamicDatasetSource(t)?jsx(DatasetSourceInfoPanel,{value:t}):jsx(FormulaSourceInfoPanel,{value:t})})})),DatasetSourceInfoPanel=observer((({value:e})=>{var t,r,n;const{crudService:o}=useService(),{dataSet:i,field:a,summary:s}=e,{value:l,loading:c}=useAsync((async()=>await o.getTableInfo(i)),[e.dataSet]),u=!c&&i&&(isNil$3(l)||!0===l.deleted),d=reactExports.useMemo((()=>null==l?void 0:l.fields.find((e=>e.id===a))),[a,null==l?void 0:l.fields]),h=a&&(u||!c&&isNil$3(d)),p=reactExports.useMemo((()=>{var e,t;const r=null==(t=o.getFieldSummaryInfo()[null!=(e=null==d?void 0:d.type)?e:""])?void 0:t.options;return null==r?void 0:r.find((e=>e.value===s))}),[o,null==d?void 0:d.type,s]),f=s&&!c&&isNil$3(p);return jsxs(Fragment,{children:[jsxs("div",{children:[jsx("span",{children:duchampIntl.get("Duchamp-Source_Table")}),jsx("span",{className:classNames$1({"error-text":u}),children:u?duchampIntl.get("Duchamp-Deleted"):null!=(t=null==l?void 0:l.name)?t:""})]}),jsxs("div",{children:[jsx("span",{children:duchampIntl.get("Duchamp-Source_Field")}),jsx("span",{className:classNames$1({"error-text":h}),children:h?duchampIntl.get("Duchamp-Deleted"):null!=(r=null==d?void 0:d.name)?r:""}),!h&&s&&jsxs(Fragment,{children:[jsx("span",{children:duchampIntl.get("Duchamp-Bracket_Left")}),jsx("span",{className:classNames$1({"error-text":f}),children:f?duchampIntl.get("Duchamp-Summary_Mismatched"):null!=(n=null==p?void 0:p.label)?n:""}),jsx("span",{children:duchampIntl.get("Duchamp-Bracket_Right")})]})]})]})})),FormulaSourceInfoPanel=observer((({value:e})=>jsx("div",{children:"".concat(duchampIntl.get("Duchamp-Formula_With_Colon")+e.formula)}))),TitleWidgetConfig=observer((({widget:e})=>{const t=e.getInstance();return jsx(WidgetConfiguration,{widget:e,configuration:[{name:"values",displayName:duchampIntl.get("Duchamp-Title_Content"),value:[duchampIntl.get("Duchamp-Heading_1")],type:"title-value-config",placeholder:duchampIntl.get("Duchamp-Please_Enter_A_Title"),defaultStyle:{fontColor:t.props.color,fontFamily:t.props.fontFamily,fontStyle:t.props.style,textShadow:t.props.textShadow}},{type:"collapseLayout",title:duchampIntl.get("Duchamp-Content_Style"),children:[{name:"fontFamily",displayName:duchampIntl.get("Duchamp-Font"),value:TEXT.FONT_FAMILY,type:"fontSelect"},{name:"style",displayName:duchampIntl.get("Duchamp-Style"),value:{fontSize:24,fontWeight:"bold"},mobileProperties:["fontSize"],showTypes:{bold:!0,italic:!0,underline:!0},prefixIcon:jsx(PlatformPopoverIcon,{}),type:"title-style"},{name:"color",displayName:duchampIntl.get("Duchamp-Colour"),value:DEFAULT_SINGLE_COLOR$1,type:"compositeColorSelector"},{name:"textShadow",displayName:duchampIntl.get("Duchamp-Text_Shadow"),type:"shadowInput",hideSetting:!0,value:{enabled:!1,boxShadow:[]}},{type:"verticalLayout",displayName:duchampIntl.get("Duchamp-Basic_Layout"),platforms:["pc","mobile"],children:[{name:"textRank",title:duchampIntl.get("Duchamp-Basic_Rank_Type"),value:TEXT_LAYOUT.HORIZONTAL,type:"radioGroup",buttonStyle:"solid",optionType:"button",options:[{label:duchampIntl.get("Duchamp-Basic_Horizontal"),value:TEXT_LAYOUT.HORIZONTAL},{label:duchampIntl.get("Duchamp-Basic_Vertical"),value:TEXT_LAYOUT.VERTICAL}]},TEXT_ALIGN_CONFIG,VERTICAL_ALIGN_CONFIG]},{name:"letterSpacing",displayName:duchampIntl.get("Duchamp-Basic_Letter_Spacing"),platforms:[PLATFORM.PC,PLATFORM.MOBILE],value:0,min:0,type:"number",suffix:"px",style:{width:"100%"}},{name:"wordSpacing",displayName:duchampIntl.get("Duchamp-Basic_Word_Spacing"),platforms:[PLATFORM.PC,PLATFORM.MOBILE],value:0,min:0,type:"number",suffix:"px",style:{width:"100%"}}]},{type:"collapseLayout",title:jsx(MarqueeHeader,{}),hide:!1,children:[{name:"marquee",value:DEFAULT_MARQUEE_CONFIG,type:"marquee",style:{width:"100%"}}]}]})}));formItemManager.register("title-value-config",ValueConfig$1);const TITLE_WIDGET_META={type:WIDGET_TYPE.TITLE,displayName:duchampIntl.get("Duchamp-Title"),version:"0.0.3",iconfont:"icon-title-components",dragPreviewImage:"/assets/widget/text_title.svg",widgetType:"text",props:{values:duchampIntl.get("Duchamp-Heading_1"),fontFamily:TEXT.FONT_FAMILY,style:{fontSize:16,fontWeight:"bold"},color:getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.TEXT),textShadow:{enabled:!1,boxShadow:[]},textRank:TEXT_LAYOUT.HORIZONTAL,textAlign:TEXT_ALIGN_DEFAULT_VALUE,verticalAlign:VERTICAL_ALIGN_DEFAULT_VALUE,letterSpacing:0,wordSpacing:0,marquee:DEFAULT_MARQUEE_CONFIG,fontLineHeight:"normal"},states:{width:160,height:40},configuration:e=>jsx(TitleWidgetConfig,{...e}),configure:{mobile:{fluidHeightGrid:FLUID_LINE_PARTS},eventTargets:{events:[{trigger:WIDGET_EVENT.CLICK,text:WIDGET_EVENT_MAP.CLICK,actions:defaultActions}]}}};var __defProp$u=Object.defineProperty,__getOwnPropDesc$t=Object.getOwnPropertyDescriptor,__decorateClass$t=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$t(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$u(t,r,i),i};formItemManager.register("title-style",FontStyleConfig);class TitleWidgetModel extends BaseWidgetModel{constructor(){super(...arguments),__publicField(this,"computedResult",new Map),__publicField(this,"titleValue",isString$3(this.props.values)?[this.props.values]:null)}setTitleValue(e){this.titleValue=e}get isStatic(){return isString$3(this.props.values)}get fieldConfigs(){const e=configKit$1.dynamicValue.getComputeConfig({config:this.props.values});return widgetIsInExpand(this.widget)?e:removeSummaryConfig(e)}handleClick(e){this.widget.trigger({expandIndex:e})}getValue(){return this.titleValue?this.titleValue[0]:""}setMarqueeStopOnHover(e){var t;const r=null!=(t=this.props.marquee)?t:getDefaultMarqueeConfig();this.setProps({marquee:{...r,stopOnHover:e}})}openHoverPauseRollPlay(){this.setMarqueeStopOnHover(!0)}closeHoverPauseRollPlay(){this.setMarqueeStopOnHover(!1)}setFieldValues(e,t){super.setFieldValues(e,t),e.forEach(((e,t)=>{this.computedResult.set(t,e)}));const r=this.dynamicValue&&(e.get(this.dynamicValue.id)||e.get(DYNAMIC_VALUE_FORMULA_FIELD_CONFIG_KEY));r&&!isString$3(this.props.values)&&this.setTitleValue(getDynamicValueResult(r,this.props.values,widgetIsInExpand(this.widget)))}replaceData(e){super.replaceData(e),this.dynamicValue&&this.setProps({values:replaceDynamicValueDataset(this.dynamicValue,e.replacement)})}get transitionDuration(){return this.store.mainStory.transition.duration}setValue(e){this.setTitleValue(["".concat(e)])}get dynamicValue(){return isDynamicValue(this.props.values)?this.props.values:null}getDynamicValues(){return isNil$3(this.dynamicValue)?[]:[this.dynamicValue]}onPropsChange(e,t){isEqual$4(e.values,t.values)||(this.setProps({fontLineHeight:"normal"}),isString$3(this.props.values)?this.setValue(this.props.values):this.fieldConfigs.size>0?this.refresh():this.setValue([]))}}function getTitleWidgetStyle(e,t){const{textDirection:r,wordSpacing:n,textShadow:o,letterSpacing:i,color:a,fontLineHeight:s,fontFamily:l,style:c}=e;return{...c,fontFamily:l,writingMode:r,...configKit.textShadow.getCssStyle(o),...configKit.color.getCssStyle(a),...getTransitionStyle(t),lineHeight:s,wordSpacing:n,letterSpacing:i,textOrientation:"upright",userSelect:"text"}}function Title(e){var t,r;const{config:n,transition:o}=e,{value:i,marquee:a}=n,{containerRef:s,contentRef:l}=useMarquee$2(a);return jsx("div",{className:classNames$1("d-text-title",{"duchamp-hover-pointer":!!(null==(t=e.events)?void 0:t.onClick)}),style:getLayoutStyle({textAlign:n.textAlign,verticalAlign:n.verticalAlign}),onClick:null==(r=e.events)?void 0:r.onClick,ref:s,children:jsx("div",{ref:l,style:getTitleWidgetStyle(n,o),children:i})})}__decorateClass$t([observable.ref],TitleWidgetModel.prototype,"titleValue",2),__decorateClass$t([action$1],TitleWidgetModel.prototype,"setTitleValue",1),__decorateClass$t([computed],TitleWidgetModel.prototype,"isStatic",1),__decorateClass$t([jsApi("trigger")],TitleWidgetModel.prototype,"handleClick",1),__decorateClass$t([jsApi()],TitleWidgetModel.prototype,"getValue",1),__decorateClass$t([jsApi()],TitleWidgetModel.prototype,"openHoverPauseRollPlay",1),__decorateClass$t([jsApi()],TitleWidgetModel.prototype,"closeHoverPauseRollPlay",1),__decorateClass$t([jsApi(),action$1],TitleWidgetModel.prototype,"setValue",1);const{dynamicValue:dynamicValue,textAlign:textAlign$1,style:style,verticalAlign:verticalAlign$1}=configKit$1;function getComputedTitleConfig(e,t){var r;const{titleValue:n}=e;if(!n||e.isStatic)return{...getTitleConfigWithoutCompute(e),value:null!=(r=null==n?void 0:n.at(0))?r:""};const o=toJS(e.props.values),i=isString$3(o)?DYNAMIC_VALUE_FORMULA_FIELD_CONFIG_KEY:o.id,a=dynamicValue.transform({config:o,compute:{computedResult:new Map(e.computedResult).set(i,[n]),key:i,index:null!=t?t:0}}),s=a.style;return{...getTitleConfigWithoutCompute(e),...toJS(s?{...s,color:s.fontColor,style:style.transform(s.fontStyle)}:{}),value:a.text}}function getTitleConfigWithoutCompute(e){var t,r;const n=toJS(e.props),o=isString$3(n.values)?n.values:"",i=null!=(t=n.marquee)?t:getDefaultMarqueeConfig();return{value:o,textDirection:null!=(r=n.textRank)?r:"horizontal-tb",textAlign:textAlign$1.transform(n.textAlign),verticalAlign:verticalAlign$1.transform(n.verticalAlign),fontFamily:n.fontFamily,style:style.transform(n.style),color:n.color,textShadow:n.textShadow,letterSpacing:n.letterSpacing,wordSpacing:n.wordSpacing,fontLineHeight:n.fontLineHeight,marquee:{...i,enable:!!e.isPreview&&i.enable}}}const TitleWidgetView=observer((({model:e,expandIndex:t})=>{const r=getComputedTitleConfig(e,t),n=e.isHoverPointer?{onClick:()=>{e.handleClick(t)}}:{};return jsx(Title,{transition:e.getWidgetTransitionInfo(),config:r,events:n})})),TABLE_FIT_MODE$1={HEIGHT:6,WIDTH:1,WIDTH_HEIGHT:2,NONE:3},TABLE_ADAPTIVE_MODES=[{label:duchampIntl.get("Duchamp-Full_Height"),value:TABLE_FIT_MODE$1.HEIGHT},{label:duchampIntl.get("Duchamp-Full_Width"),value:TABLE_FIT_MODE$1.WIDTH},{label:duchampIntl.get("Duchamp-Full_Width_Height"),value:TABLE_FIT_MODE$1.WIDTH_HEIGHT},{label:duchampIntl.get("Duchamp-Without"),value:TABLE_FIT_MODE$1.NONE}],DEFAULT_TOOLBAR_DARK_BACKGROUND="#FFFFFF80",DEFAULT_TOOLBAR_LIGHT_BACKGROUND$1="#000000A6",WORKBOOK_FIT_MODE={HEIGHT:6,WIDTH:1,WIDTH_HEIGHT:2,NONE:3},DEFAULT_FIT_CODE=3;function getFitCode(e){var t;if(void 0===e)return DEFAULT_FIT_CODE;return null!=(t={[WORKBOOK_FIT_MODE.WIDTH]:4,[WORKBOOK_FIT_MODE.WIDTH_HEIGHT]:5,[WORKBOOK_FIT_MODE.NONE]:3,[WORKBOOK_FIT_MODE.HEIGHT]:6}[e])?t:DEFAULT_FIT_CODE}function mergeTableChartParams({chartParams:e,mergeKey:t,paramsGetter:r}){const n=Object.entries(r()).reduce(((e,[t,r])=>(e[t.toUpperCase()]=r,e)),{});if(t){const r=e[t];let o=n;return isObject$f(r)&&(o={...o,...r}),{...e,[t]:o}}return{...n,...e}}function setTableEnvConfig(){BI.config("report.env.provider",(e=>{e.useEnv({getFineServletURL:()=>Report.fineServletURL,getReqPrefix(){return"".concat(this.getFineServletURL(),"/view/fit/form")},getSessionID:()=>FR.SessionMgr.getSessionID()})})),BI.Providers.getProvider("report.env.provider"),BI.Providers.getProvider("report.link.provider")}function getAttachPrefix(){return"".concat(BI.Providers.getProvider("report.env.provider").FineServletURL,"/view/duchamp/fit/form")}class ScrollAction extends BaseScrollAction$1{constructor(e,t){super(e),this.table=t}createOption(){return{mode:this.config.content===MARQUEE_CONTENT.ITEM?"item":"page",joinable:this.config.mode===MARQUEE_MODE.END_TO_END,to:this.config.direction,speed:this.config.speed,stay:timeUnitToSecond(this.config.stay),stopOnHover:this.config.stopOnHover}}startInternal(e){this.stopInternal(),e&&("offset"in e||"interval"in e)?this.table.startMarquee(e):this.table.startCarousel(e)}stopInternal(){this.table.stopCarousel(),this.table.stopMarquee()}}const TOOLBAR_SETTINGS_LIGHT={toolbarClass:"workbook-toolbar-light",toolTipOverlayBackgroundColor:"rgba(0, 0, 0, 65%)",toolTipOverlayColor:"#fff"},TOOLBAR_SETTINGS_DARK={toolbarClass:"workbook-toolbar-dark",toolTipOverlayBackgroundColor:"rgba(255, 255, 255, 50%)",toolTipOverlayColor:"rgba(0, 0, 0, 85%)"},TOOLBAR_BUTTON_TYPE={PAGE:"page",PAGE_EXPORT:"pageExport",SIMPLE_EXPORT:"simpleExport",ZOOM:"zoom"},DEFAULT_TOOLBAR_LIGHT_BACKGROUND="#000000A6";function PageButton$1({value:e,onChange:t,onFirst:r,onPrevious:n,onNext:o,onLast:i,total:a=1,disabled:s=!1,toolbarStyleSettings:l}){const{t:c}=useI18n();return jsxs("div",{className:"page-button",children:[jsx(Icon$2,{svgContent:SvgIconFrontPage,type:"icon-front-page",disabled:s||1===e,onClick:r,title:c("Duchamp-First_Page"),toolTipOverlayBackgroundColor:l.toolTipOverlayBackgroundColor,toolTipOverlayStyle:{color:l.toolTipOverlayColor}}),jsx(Icon$2,{svgContent:SvgIconPreviousPage,type:"icon-previous-page",disabled:s||1===e,onClick:n,title:c("Duchamp-Previous_Page"),toolTipOverlayBackgroundColor:l.toolTipOverlayBackgroundColor,toolTipOverlayStyle:{color:l.toolTipOverlayColor}}),jsx(NumberInput$1,{value:e,onChange:t,width:32,wrapperClassName:"page-input-wrapper",className:"page-input",disabled:s,min:1,max:a,precision:0,hasControlBtn:!1}),jsx("span",{className:classNames$1("total-page",{disabled:s}),children:"/"}),jsx("span",{className:classNames$1("total-page",{disabled:s}),children:a}),jsx(Icon$2,{svgContent:SvgIconNextPage1,type:"icon-next-page1",disabled:s||e===a,onClick:o,title:c("Duchamp-Next_Page"),toolTipOverlayBackgroundColor:l.toolTipOverlayBackgroundColor,toolTipOverlayStyle:{color:l.toolTipOverlayColor}}),jsx(Icon$2,{svgContent:SvgIconLastPage1,type:"icon-last-page1",disabled:s||e===a,onClick:i,title:c("Duchamp-Last_Page"),toolTipOverlayBackgroundColor:l.toolTipOverlayBackgroundColor,toolTipOverlayStyle:{color:l.toolTipOverlayColor}})]})}const Toolbar$1=({isZoomed:e,disabled:t,pageContext:r,pageIndex:n,buttonGroups:o,toolbarStyleSettings:i,style:a,onExcelExport:s,onToggleZoom:l})=>{const{t:c}=useI18n();return jsx("div",{className:classNames$1("workbook-toolbar",i.toolbarClass),style:a,children:null==o?void 0:o.map(((o,a)=>jsxs(reactExports.Fragment,{children:[0!==a&&jsx(Divider,{direction:"vertical",className:"divider"}),o.map(((o,a)=>jsxs(reactExports.Fragment,{children:[o.type===TOOLBAR_BUTTON_TYPE.PAGE&&jsx(PageButton$1,{value:r.indexToVisibleIndex(n),total:r.visibleTotal,onChange:e=>{const t=r.visibleIndexToIndex(e);t&&r.getPage(t).goto()},onFirst:()=>r.getFirstPage().goto(),onPrevious:()=>r.getPreviousPage().goto(),onNext:()=>r.getNextPage().goto(),onLast:()=>r.getLastPage().goto(),disabled:t,toolbarStyleSettings:i}),o.type===TOOLBAR_BUTTON_TYPE.PAGE_EXPORT&&jsx(Icon$2,{toolTipOverlayBackgroundColor:i.toolTipOverlayBackgroundColor,toolTipOverlayStyle:{color:i.toolTipOverlayColor},svgContent:SvgIconPaginatedExport,type:"icon-paginated-export",title:c("Duchamp-Excel_Page_Export"),overlayClassName:"workbook-toolbar-icon-tooltip",disabled:t,onClick:()=>s(EXPORT_EXCEL_TYPE.PAGE)}),o.type===TOOLBAR_BUTTON_TYPE.SIMPLE_EXPORT&&jsx(Icon$2,{toolTipOverlayBackgroundColor:i.toolTipOverlayBackgroundColor,toolTipOverlayStyle:{color:i.toolTipOverlayColor},svgContent:SvgIconExport,type:"icon-export",title:c("Duchamp-Excel_Simple_Export"),overlayClassName:"workbook-toolbar-icon-tooltip",disabled:t,onClick:()=>s(EXPORT_EXCEL_TYPE.SIMPLE)}),o.type===TOOLBAR_BUTTON_TYPE.ZOOM&&jsx(ZoomIcon,{isZoomed:e,toolTipOverlayBackgroundColor:i.toolTipOverlayBackgroundColor,toolTipOverlayColor:i.toolTipOverlayColor,disabled:t,overlayClassName:"workbook-toolbar-icon-tooltip",onClick:l})]},a)))]},a)))})};function isExportExcelType(e){return Object.values(EXPORT_EXCEL_TYPE).includes(e)}const getWorkbookThemeStyleProps=e=>{const t=e===TEMPLATE_THEME_TYPE.DARK;return{toolbarBackground:t?DEFAULT_TOOLBAR_DARK_BACKGROUND:DEFAULT_TOOLBAR_LIGHT_BACKGROUND$1,toolbarButtonStyle:t?TOOLBAR_BUTTON_STYLE.DARK:TOOLBAR_BUTTON_STYLE.LIGHT}};function getWorkbookToolbarSetting$1(e){return(null!=e?e:TOOLBAR_BUTTON_STYLE.LIGHT)===TOOLBAR_BUTTON_STYLE.LIGHT?TOOLBAR_SETTINGS_LIGHT:TOOLBAR_SETTINGS_DARK}var __defProp$t=Object.defineProperty,__getOwnPropDesc$s=Object.getOwnPropertyDescriptor,__decorateClass$s=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$s(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$t(t,r,i),i};const DEFAULT_MARQUEE_STAY={type:"second",value:1},DEFAULT_TABLE_MARQUEE_CONFIG={enable:!1,content:MARQUEE_CONTENT$1.ITEM,mode:MARQUEE_MODE$1.END_TO_END,direction:MARQUEE_DIRECTION$1.TOP,speed:50,stay:DEFAULT_MARQUEE_STAY},DEFAULT_TOOLBAR={buttonGroups:[[{type:TOOLBAR_BUTTON_TYPE.PAGE,enable:!1}],[{type:TOOLBAR_BUTTON_TYPE.PAGE_EXPORT,enable:!1},{type:TOOLBAR_BUTTON_TYPE.SIMPLE_EXPORT,enable:!1}],[{type:TOOLBAR_BUTTON_TYPE.ZOOM,enable:!1}]],position:TOOL_BAR_POSITION.TOP,toolbarBackground:DEFAULT_TOOLBAR_LIGHT_BACKGROUND$1,toolbarButtonStyle:TOOLBAR_BUTTON_STYLE.LIGHT},DEFAULT_MOBILE_TOOLBAR={buttonGroups:[[{type:TOOLBAR_BUTTON_TYPE.PAGE,enable:!1}],[{type:TOOLBAR_BUTTON_TYPE.ZOOM,enable:!1}]]},WORKBOOK_TOOLBAR_HEIGHT=32;class WorkbookXWidgetModel extends BaseWidgetModel{constructor(){super(...arguments),__publicField(this,"pageIndex",1),__publicField(this,"parameters",new Map),__publicField(this,"isZoomed",!1),__publicField(this,"options"),__publicField(this,"table"),__publicField(this,"effectConfigMap",new Map),__publicField(this,"hidePages",[]),__publicField(this,"wrapEl")}toggleZoom(e=!this.isZoomed){this.isZoomed=e}loadedEmit(){this.emitCurrentLoaded()}loadFinished(){this.widget.setLoading(!1),this.loadedEmit()}beforeCalculate(){this.widget.setLoading(!0)}afterCalculate(){this.widget.setLoading(!1)}setTable(e){this.table=e}get workbookName(){var e;return(null==(e=this.store.resourceCenter.getInfoByID(this.props.configFile))?void 0:e.name)||""}get fitState(){var e,t,r;return null!=(r=null!=(t=this.props.fitState)?t:null==(e=this.options)?void 0:e.reportFitAttr.fitStateInPC)?r:TABLE_FIT_MODE$1.WIDTH}get reportFitAttr(){var e,t;return{fitFont:!!(null==(t=null==(e=this.options)?void 0:e.reportFitAttr)?void 0:t.fitFont),fitStateInPC:getFitCode(this.fitState)}}get workbookToolbar(){return this.props.toolbar}get toolbarButtonGroups(){var e;return null==(e=this.workbookToolbar)?void 0:e.buttonGroups}get buttonGroups(){var e;return null==(e=this.toolbarButtonGroups)?void 0:e.map((e=>e.filter((e=>e.enable)))).filter((e=>e.length>0))}get totalPage(){var e,t;return null!=(t=null==(e=this.options)?void 0:e.totalPage)?t:1}get showToolbar(){var e,t;return null==(t=null==(e=this.toolbarButtonGroups)?void 0:e.flat())?void 0:t.some((e=>e.enable))}get autoHeight(){var e;return null==(e=this.props.autoHeight)||e}setAutoHeight(e){this.setPlatformProps({autoHeight:e})}get showMobilePaginationButton(){var e;const t=this.getPageContext();return(null==(e=this.toolbarButtonGroups)?void 0:e.flat().some((e=>e.type===TOOLBAR_BUTTON_TYPE.PAGE&&e.enable)))&&t.visibleTotal>1}get showMobileZoomButton(){var e;return null==(e=this.toolbarButtonGroups)?void 0:e.flat().some((e=>e.type===TOOLBAR_BUTTON_TYPE.ZOOM&&e.enable))}get showMobileToolbar(){const e=getParamInURL(MOBILE_UNIQUE_PARAMS.FINE_WEBVIEW);return(this.showMobilePaginationButton||this.showMobileZoomButton)&&"true"!==e}get toolbarStyleSettings(){var e;return getWorkbookToolbarSetting$1(null==(e=this.workbookToolbar)?void 0:e.toolbarButtonStyle)}get scalable(){var e,t,r;return null!=(r=null==(t=null==(e=this.props.previewConfig)?void 0:e.pinchToZoom)?void 0:t.enable)&&r}setOptions(e){this.options=e}initStateChangeListeners(e){super.initStateChangeListeners(e),this.isPreview||this.disposes.push(reaction((()=>this.name),(()=>{this.refresh()})))}mergeProps(e,t){return mergeWith$2({},e,t,((e,t,r)=>{if("buttonGroups"===r&&(null==t?void 0:t.length)&&(null==e?void 0:e.length)){const r=e.flat();return t.flat().forEach((e=>{const t=r.find((t=>t.type===e.type));t?t.enable=e.enable:r.push(e)})),r}}))}getPageContext(){return new PageContext({getPages:()=>range$1(this.totalPage).map((e=>({index:e+1,visible:!this.hidePages.includes(e+1)}))),getCurrent:()=>this.pageIndex,isLoop:()=>!0},{goto:(e,t)=>{this.gotoPage(e.index,t)},setVisible:(e,t)=>{t?this.removeHidePages(e.index):this.addHidePages(e.index)}})}addHidePages(e){this.hidePages=[...this.hidePages,e]}removeHidePages(e){this.hidePages=this.hidePages.filter((t=>t!==e))}updateToolbarButton(e,t){var r;const{toolbar:n}=this.props,o=null==(r=null==n?void 0:n.buttonGroups)?void 0:r.flat(),i=cloneDeep$2(this.isMobile?DEFAULT_MOBILE_TOOLBAR.buttonGroups:DEFAULT_TOOLBAR.buttonGroups);null==i||i.flat().forEach((r=>{if(r.type===e)Object.assign(r,t);else{const e=null==o?void 0:o.find((e=>e.type===r.type));e&&Object.assign(r,e)}})),this.updateToolbar({buttonGroups:i})}updateToolbar(e){var t;this.isMobile?this.setMobileProps({toolbar:{...toJS(this.mobile.props.toolbar),...e}}):this.setProps({toolbar:{...toJS(null!=(t=this.props.toolbar)?t:DEFAULT_TOOLBAR),...e}})}collectResourceIDs(){const e=super.collectResourceIDs();return this.props.configFile&&e.push(this.props.configFile),e}updateResourceIDs(e){const{configFile:t}=this.props,r=e.get(t);r&&this.setProps({configFile:r})}get marquee(){var e;return null!=(e=toJS(this.props.marquee))?e:DEFAULT_TABLE_MARQUEE_CONFIG}updateMarquee(e){this.setProps({marquee:{...this.marquee,...e}})}get lineHeight(){var e,t;return null!=(t=null==(e=this.props)?void 0:e.lineHeight)?t:"normal"}updateLineHeight(e){this.props.lineHeight!==e&&this.setProps({lineHeight:e})}setFitState(e){this.setPlatformProps({fitState:e})}setAndRefreshFitState(e){this.setFitState(e)}async setFieldValues(e,t,r){super.setFieldValues(e,t);const n=await this.preprocessOptions(configKit$1.configFile.transform({config:this.id,compute:{index:0,computedResult:e},options:{type:"workbook"}}));n&&!("errorCode"in n)&&(this.pageIndex=n.pageIndex,r&&(this.parameters=r),this.setOptions(n),"init"===t.type&&this.loadedEmit(),this.widget.setLoading(!1))}getWorkbookParameters(){return Object.fromEntries(this.parameters)}get forwardComputedName(){return this.name}get fieldConfigs(){return configKit$1.configFile.getComputeConfig({config:this.id,options:{type:"workbook",payload:{widgetName:this.widget.name,outsidePayload:{features_accept:"progress-bar-cell-json"},simpleJson:this.store.simpleJson}}})}async onInit(){this.widget.setLoading(!0)}initializationToolbar(){var e;if(isNil$3(this.props.toolbar)){const{toolbarBackground:t,toolbarButtonStyle:r}=getWorkbookThemeStyleProps(null==(e=this.store.styleConfig)?void 0:e.theme),n={...cloneDeep$2(DEFAULT_TOOLBAR),toolbarBackground:t,toolbarButtonStyle:r};this.setProps({toolbar:n})}}async onThemeChange(e){const{toolbarBackground:t,toolbarButtonStyle:r}=getWorkbookThemeStyleProps(e.themeType);this.updateToolbar({toolbarBackground:t,toolbarButtonStyle:r})}async waitUntilTableRender(){return this.table?this.table:new Promise(((e,t)=>{const r=reaction((()=>this.table),(()=>{this.table&&(r(),this.table?e(this.table):t())}))}))}startMarquee(e={}){this.setProps({marquee:{options:e,open:!0}})}stopMarquee(){this.setProps({marquee:{open:!1}})}setMarqueeStopOnHover(e){this.setProps({marquee:{...this.marquee,..."open"in this.marquee?this.marquee.open?{options:{...this.marquee.options,stopOnHover:e}}:{}:{stopOnHover:e}}})}openHoverPauseRollPlay(){this.setMarqueeStopOnHover(!0)}closeHoverPauseRollPlay(){this.setMarqueeStopOnHover(!1)}getCell(e,t){var r;return null==(r=this.table)?void 0:r.getCell(e,t)}getRow(e){var t;return null==(t=this.table)?void 0:t.getRow(e)}getColumn(e){var t;return null==(t=this.table)?void 0:t.getColumn(e)}getRowCount(){var e;return(null==(e=this.table)?void 0:e.getRowCount())||-1}getColumnCount(){var e;return(null==(e=this.table)?void 0:e.getColumnCount())||-1}setRowHeight(e,t){this.waitUntilTableRender().then((r=>{r.setRowHeight(e,t)}))}setColWidth(e,t){this.waitUntilTableRender().then((r=>{r.setColWidth(e,t)}))}getCellValue(e,t){var r;return null==(r=this.table)?void 0:r.getCellVal(e,t)}getCellVal(e,t){var r;return null==(r=this.table)?void 0:r.getCellVal(e,t)}setCellValue(e,t,r){var n;return null==(n=this.table)?void 0:n.setCellVal(e,t,r)}setCellVal(e,t,r){var n;return null==(n=this.table)?void 0:n.setCellVal(e,t,r)}onMouseClick(e){this.waitUntilTableRender().then((t=>{t.addMouseEventHandler("CELL_CLICK",e)}))}onMouseUp(e){this.waitUntilTableRender().then((t=>{t.addMouseEventHandler("CELL_CLICK",e)}))}onMouseDown(e){this.waitUntilTableRender().then((t=>{t.addMouseEventHandler("CELL_MOUSE_DOWN",e)}))}onMouseMoveInCell(e){this.waitUntilTableRender().then((t=>{t.addMouseEventHandler("CELL_HOVER",e)}))}onMouseMoveOutCell(e){this.waitUntilTableRender().then((t=>{t.addMouseEventHandler("CELL_MOUSE_LEAVE",e)}))}setHScrollBarVisible(e){this.waitUntilTableRender().then((t=>{t.setHScrollBarVisible(e)}))}setVScrollBarVisible(e){this.waitUntilTableRender().then((t=>{t.setVScrollBarVisible(e)}))}scrollTo(e){this.waitUntilTableRender().then((t=>{const{x:r,y:n}=e;t.scrollTo(r,n)}))}getScrollOffset(){var e;return null==(e=this.table)?void 0:e.getScrollOffset()}batchUpdateTableAttr(e,t){var r;return null==(r=this.table)?void 0:r.batchUpdateTableAttr(e,t)}addCustomTableHandler(e){var t;return null==(t=this.table)?void 0:t.addCustomHandler(e)}setRadius(e,t,r){this.waitUntilTableRender().then((n=>{n.setCellRadius(e,t,r)}))}addEffect(e,t){this.effectConfigMap.set(e,t),this.waitUntilTableRender().then((r=>{switch(e){case"highlightRow":!1===t.single?r.addHighlightRowHoldEffect(t.color,t.trigger):r.addHighlightRowEffect(t.color,t.trigger);break;case"highlightCol":!1===t.single?r.addHighlightColHoldEffect(t.color,t.trigger):r.addHighlightColEffect(t.color,t.trigger);break;case"highlightCross":!1===t.single?r.addHighlightCrossHoldEffect(t.color,t.trigger):r.addHighlightCrossEffect(t.color,t.trigger);break;case"highlightCell":!1===t.single?r.addHighlightCellHoldEffect(t.color,void 0,t.trigger):r.addHighlightCellEffect(t.color,t.trigger);break;case"setCellFont":!1===t.single?r.addSetCellFontHoldEffect(t.style,void 0,t.trigger):r.addSetCellFontEffect(t.style,t.trigger);break;case"setRowFont":!1===t.single?r.addSetRowFontHoldEffect(t.style,!0,t.trigger):r.addSetRowFontEffect(t.style,t.trigger);break;case"showTooltip":r.addPopoverEffect(t.address,t)}}))}showToolTip(e){this.waitUntilTableRender().then((t=>{const{content:r}=e;t.addPopoverEffect("",{type:"table",text:null==r?void 0:r.text,header:null==r?void 0:r.header,image:null==r?void 0:r.image,style:e.style})}))}refresh(e){return this.widget.setLoading(!0),super.refresh(e).finally((()=>{this.widget.setLoading(!1)}))}async refreshTable(e){this.widget.setLoading(!0),await this.duchampServer.calculateCenter.calculate(new Set([this]),"refresh",{...e,pageIndex:this.pageIndex},{},!this.isPreview),this.widget.setLoading(!1)}async gotoPage(e,t){e<1||e>this.totalPage||(this.pageIndex=+e,this.widget.setLoading(!0),await this.duchampServer.calculateCenter.calculate(new Set([this]),"refresh",{pageIndex:e},t),this.widget.setLoading(!1))}gotoPreviousPage(){this.pageIndex<=1||(this.pageIndex--,this.gotoPage(this.pageIndex))}gotoNextPage(){this.pageIndex>=this.totalPage||(this.pageIndex++,this.gotoPage(this.pageIndex))}gotoLastPage(){this.gotoPage(this.totalPage)}gotoFirstPage(){this.gotoPage(1)}getCurrentPageIndex(){return this.pageIndex}getReportTotalPage(){return this.totalPage}exportReportToExcel(e){isExportExcelType(e)&&otherService.export({format:EXPORT_FORMAT.EXCEL,type:e,widgetName:this.name,storyIndex:this.storyIndex,payload:{depWidgets:getStoryWorkbookNamedIdentifier(this.story)}})}openEditor(){this.store.setModified(!0),otherService.openWorkBookEdit(this.workbookName,this.id,(()=>{this.updateLineHeight("120%"),this.refresh()}))}async preprocessOptions(e){return await loadWidgetResource(e.fontDependency||[]),e}getChart(e){var t,r;return null==(r=null==(t=this.table)?void 0:t.getChart)?void 0:r.call(t,e)}get widgetIsRenderWithoutScale(){return!1}get tableFileName(){var e;return(null==(e=this.store.resourceCenter.getInfoByID(this.props.configFile))?void 0:e.name)||""}getSpecialPayload(){return{widgetFilePath:this.workbookName}}setTempState(e){super.setTempState(e),isObject$f(e)&&"table"in e&&this.setTable(e.table)}}__decorateClass$s([observable],WorkbookXWidgetModel.prototype,"isZoomed",2),__decorateClass$s([action$1],WorkbookXWidgetModel.prototype,"toggleZoom",1),__decorateClass$s([observable.ref],WorkbookXWidgetModel.prototype,"options",2),__decorateClass$s([observable.ref],WorkbookXWidgetModel.prototype,"table",2),__decorateClass$s([action$1],WorkbookXWidgetModel.prototype,"setTable",1),__decorateClass$s([action$1],WorkbookXWidgetModel.prototype,"setOptions",1),__decorateClass$s([override],WorkbookXWidgetModel.prototype,"initStateChangeListeners",1),__decorateClass$s([jsApi({travel:!0,flatten:!0})],WorkbookXWidgetModel.prototype,"getPageContext",1),__decorateClass$s([observable],WorkbookXWidgetModel.prototype,"hidePages",2),__decorateClass$s([action$1],WorkbookXWidgetModel.prototype,"addHidePages",1),__decorateClass$s([action$1],WorkbookXWidgetModel.prototype,"removeHidePages",1),__decorateClass$s([computed],WorkbookXWidgetModel.prototype,"marquee",1),__decorateClass$s([computed],WorkbookXWidgetModel.prototype,"lineHeight",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"startMarquee",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"stopMarquee",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"openHoverPauseRollPlay",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"closeHoverPauseRollPlay",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"getCell",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"getRow",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"getColumn",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"getRowCount",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"getColumnCount",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"setRowHeight",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"setColWidth",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"getCellValue",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"getCellVal",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"setCellValue",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"setCellVal",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"onMouseClick",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"onMouseUp",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"onMouseDown",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"onMouseMoveInCell",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"onMouseMoveOutCell",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"setHScrollBarVisible",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"setVScrollBarVisible",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"scrollTo",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"getScrollOffset",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"batchUpdateTableAttr",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"addCustomTableHandler",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"setRadius",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"addEffect",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"showToolTip",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"refresh",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"gotoPage",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"gotoPreviousPage",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"gotoNextPage",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"gotoLastPage",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"gotoFirstPage",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"getCurrentPageIndex",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"getReportTotalPage",1),__decorateClass$s([jsApi()],WorkbookXWidgetModel.prototype,"exportReportToExcel",1),__decorateClass$s([override],WorkbookXWidgetModel.prototype,"widgetIsRenderWithoutScale",1);const{Option:Option$6}=Select$1,{Text:Text$1}=Typography,WorkbookWidgetConfig=observer((({model:e})=>{var t,r,n,o,i,a,s;const l=useStore(),c=t=>{var r,n;const o=null==(r=e.props.toolbar)?void 0:r.buttonGroups.flat(),i=null==o?void 0:o.find((e=>e.type===t));return null!=(n=null==i?void 0:i.enable)&&n},u=e.marquee,d=reactExports.useMemo((()=>{var t;return null==(t=e.props.toolbar)?void 0:t.buttonGroups.flat().some((e=>e.enable))}),[null==(t=e.props.toolbar)?void 0:t.buttonGroups]),h=null!=(o=null!=(n=e.props.fitState)?n:null==(r=e.options)?void 0:r.reportFitAttr.fitStateInPC)?o:TABLE_FIT_MODE$1.WIDTH;return jsx("div",{className:"workbook-widget-config",children:jsxs(GridItem,{children:[jsx(ClickEditConfig,{onClick:()=>{e.openEditor()}}),jsx(Divider,{className:"divider"}),jsx(PlatformLineItem,{label:duchampIntl.get("Duchamp-Content_Adaptation"),children:jsx(Select$1,{style:{width:"100%"},onChange:t=>{e.setAndRefreshFitState(t)},value:h,children:TABLE_ADAPTIVE_MODES.map((e=>jsx(Option$6,{value:e.value,children:e.label},e.value)))})}),l.isMagneticLayout&&jsx(LineItem,{label:"",children:jsx(AutoHeightConfig,{value:e.autoHeight,onChange:t=>e.setAutoHeight(t),"data-focus-point":{id:"S262",trigger:"onChange",getParam:()=>({value:e.autoHeight?"1":"2"})}})}),jsx(CollapseGroup,{defaultActiveKey:["1","2"],items:[{key:"1",label:duchampIntl.get("Duchamp-Table_Toolbar"),children:jsxs(GridItem,{style:{marginBottom:12},children:[jsx("div",{className:"toolbar-tip",children:jsx(Text$1,{type:"secondary",children:duchampIntl.get("Duchamp-Table_Toolbar_Tip")})}),jsx(LineItem,{label:duchampIntl.get("Duchamp-Toolbar_Button"),children:jsxs(GridItem,{children:[jsx(LineItem,{children:jsx(Checkbox$4,{value:c(TOOLBAR_BUTTON_TYPE$2.PAGE),onChange:t=>{e.updateToolbarButton(TOOLBAR_BUTTON_TYPE$2.PAGE,{enable:t})},text:jsx(PlatformCollapseHeader,{title:duchampIntl.get("Duchamp-Show_Page_Button")})})}),!e.isMobile&&jsxs(Fragment,{children:[jsx(LineItem,{children:jsx(Checkbox$4,{value:c(TOOLBAR_BUTTON_TYPE$2.PAGE_EXPORT),onChange:t=>{e.updateToolbarButton(TOOLBAR_BUTTON_TYPE$2.PAGE_EXPORT,{enable:t})},text:duchampIntl.get("Duchamp-Show_Page_Export_Button")})}),jsx(LineItem,{children:jsx(Checkbox$4,{value:c(TOOLBAR_BUTTON_TYPE$2.SIMPLE_EXPORT),onChange:t=>{e.updateToolbarButton(TOOLBAR_BUTTON_TYPE$2.SIMPLE_EXPORT,{enable:t})},text:duchampIntl.get("Duchamp-Show_Simple_Export_Button")})})]}),jsx(LineItem,{children:jsx(Checkbox$4,{value:c(TOOLBAR_BUTTON_TYPE$2.ZOOM),onChange:t=>{e.updateToolbarButton(TOOLBAR_BUTTON_TYPE$2.ZOOM,{enable:t})},text:jsx(PlatformCollapseHeader,{title:duchampIntl.get("Duchamp-Show_Zoom_Button")})})})]})}),d?jsxs(Fragment,{children:[jsx(PlatformLineItem,{label:duchampIntl.get("Duchamp-Toolbar_Position"),children:jsx(RadioGroup$1,{value:null==(i=e.props.toolbar)?void 0:i.position,options:[{label:duchampIntl.get("Duchamp-Top_Position"),value:TOOL_BAR_POSITION.TOP},{label:duchampIntl.get("Duchamp-Bottom"),value:TOOL_BAR_POSITION.BOTTOM}],onChange:t=>{e.updateToolbar({position:t})}})}),jsx(PlatformLineItem,{label:duchampIntl.get("Duchamp-Toolbar_Background"),children:jsx(ThemeColorPicker,{value:(null==(a=e.props.toolbar)?void 0:a.toolbarBackground)||DEFAULT_TOOLBAR_LIGHT_BACKGROUND$1,onChange:t=>{e.updateToolbar({toolbarBackground:t})}})}),jsx(PlatformLineItem,{label:duchampIntl.get("Duchamp-Button_Mode"),children:jsx(RadioGroup$1,{value:(null==(s=e.props.toolbar)?void 0:s.toolbarButtonStyle)||TOOLBAR_BUTTON_STYLE.LIGHT,options:[{label:duchampIntl.get("Duchamp-Light_Color"),value:TOOLBAR_BUTTON_STYLE.LIGHT},{label:duchampIntl.get("Duchamp-Dark_Color"),value:TOOLBAR_BUTTON_STYLE.DARK}],onChange:t=>{e.updateToolbar({toolbarButtonStyle:t})}})})]}):null]})},{key:"2",label:jsx(MarqueeHeader,{}),children:jsx(MarqueeConfig,{value:e.isMobile?omit$1(u,"mode"):u,onChange:t=>{if(u.content!==t.content){const e=DEFAULT_MARQUEE_STAY;t={...t,stay:e}}e.updateMarquee(t)}})}]})]})})})),WORKBOOK_META={displayName:duchampIntl.get("Duchamp-Sheet"),groupName:"",iconfont:"icon-sheet-components",dragPreviewImage:"/assets/widget/workbook_x.svg",props:{workbookName:"",fitState:TABLE_FIT_MODE$1.WIDTH},states:{width:330,height:180},type:"d-workbook-x",version:"0.0.2",widgetType:"text",dependencies:[],async initialization(e){const{widget:t,parent:r,...n}=e,o={widgetId:t.id,widgetType:t.type,payload:{snapshot:JSON.stringify(getSnapshot(t)),storyIndex:t.storyIndex}};let i=!0;const a=t.getInstance();if(a.initializationToolbar(),"create"===e.type){const{resourceCenter:e}=t.store,r=uuid$1();t.model.setProps({configFile:r});const n=(await otherService.createWidget({...o,mainResourceId:r})).map((e=>({...e,payload:{isPrivate:"true",...e.payload}})));e.addResourceInfo(n),n.length>0?o.payload.snapshot=JSON.stringify(getSnapshot(t)):i=!1}return i&&(i=await otherService.initWidget({...o,...n,payload:{...o.payload,...a.fieldPayload}})),i},configure:{mobile:{fluidHeightGrid:FLUID_BLOCK_PARTS},eventTargets:{events:[{trigger:WIDGET_EVENT.MOUNTED,text:WIDGET_EVENT_MAP.MOUNTED,actions:[{action:DUCHAMP_ACTION_TYPE.JAVASCRIPT}]}]}}};var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},isBrowser="object"===("undefined"==typeof window?"undefined":_typeof(window))&&"object"===("undefined"==typeof document?"undefined":_typeof(document))&&9===document.nodeType,plainObjectConstrurctor={}.constructor;function cloneStyle(e){if(null==e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(cloneStyle);if(e.constructor!==plainObjectConstrurctor)return e;var t={};for(var r in e)t[r]=cloneStyle(e[r]);return t}function createRule(e,t,r){void 0===e&&(e="unnamed");var n=r.jss,o=cloneStyle(t),i=n.plugins.onCreateRule(e,o,r);return i||(e[0],null)}var join=function(e,t){for(var r="",n=0;n<e.length&&"!important"!==e[n];n++)r&&(r+=t),r+=e[n];return r},toCssValue=function(e){if(!Array.isArray(e))return e;var t="";if(Array.isArray(e[0]))for(var r=0;r<e.length&&"!important"!==e[r];r++)t&&(t+=", "),t+=join(e[r]," ");else t=join(e,", ");return"!important"===e[e.length-1]&&(t+=" !important"),t};function getWhitespaceSymbols(e){return e&&!1===e.format?{linebreak:"",space:""}:{linebreak:"\n",space:" "}}function indentStr(e,t){for(var r="",n=0;n<t;n++)r+="  ";return r+e}function toCss(e,t,r){void 0===r&&(r={});var n="";if(!t)return n;var o=r.indent,i=void 0===o?0:o,a=t.fallbacks;!1===r.format&&(i=-1/0);var s=getWhitespaceSymbols(r),l=s.linebreak,c=s.space;if(e&&i++,a)if(Array.isArray(a))for(var u=0;u<a.length;u++){var d=a[u];for(var h in d){var p=d[h];null!=p&&(n&&(n+=l),n+=indentStr(h+":"+c+toCssValue(p)+";",i))}}else for(var f in a){var g=a[f];null!=g&&(n&&(n+=l),n+=indentStr(f+":"+c+toCssValue(g)+";",i))}for(var m in t){var y=t[m];null!=y&&"fallbacks"!==m&&(n&&(n+=l),n+=indentStr(m+":"+c+toCssValue(y)+";",i))}return(n||r.allowEmpty)&&e?(n&&(n=""+l+n+l),indentStr(""+e+c+"{"+n,--i)+indentStr("}",i)):n}var escapeRegex=/([[\].#*$><+~=|^:(),"'`\s])/g,nativeEscape="undefined"!=typeof CSS&&CSS.escape,escape$1=function(e){return nativeEscape?nativeEscape(e):e.replace(escapeRegex,"\\$1")},BaseStyleRule=function(){function e(e,t,r){this.type="style",this.isProcessed=!1;var n=r.sheet,o=r.Renderer;this.key=e,this.options=r,this.style=t,n?this.renderer=n.renderer:o&&(this.renderer=new o)}return e.prototype.prop=function(e,t,r){if(void 0===t)return this.style[e];var n=!!r&&r.force;if(!n&&this.style[e]===t)return this;var o=t;r&&!1===r.process||(o=this.options.jss.plugins.onChangeValue(t,e,this));var i=null==o||!1===o,a=e in this.style;if(i&&!a&&!n)return this;var s=i&&a;if(s?delete this.style[e]:this.style[e]=o,this.renderable&&this.renderer)return s?this.renderer.removeProperty(this.renderable,e):this.renderer.setProperty(this.renderable,e,o),this;var l=this.options.sheet;return l&&l.attached,this},e}(),StyleRule=function(e){function t(t,r,n){var o;o=e.call(this,t,r,n)||this;var i=n.selector,a=n.scoped,s=n.sheet,l=n.generateId;return i?o.selectorText=i:!1!==a&&(o.id=l(_assertThisInitialized$27(_assertThisInitialized$27(o)),s),o.selectorText="."+escape$1(o.id)),o}_inheritsLoose(t,e);var r=t.prototype;return r.applyTo=function(e){var t=this.renderer;if(t){var r=this.toJSON();for(var n in r)t.setProperty(e,n,r[n])}return this},r.toJSON=function(){var e={};for(var t in this.style){var r=this.style[t];"object"!=typeof r?e[t]=r:Array.isArray(r)&&(e[t]=toCssValue(r))}return e},r.toString=function(e){var t=this.options.sheet,r=!!t&&t.options.link?_extends$4({},e,{allowEmpty:!0}):e;return toCss(this.selectorText,this.style,r)},_createClass$2D(t,[{key:"selector",set:function(e){if(e!==this.selectorText){this.selectorText=e;var t=this.renderer,r=this.renderable;if(r&&t)t.setSelector(r,e)||t.replaceRule(r,this)}},get:function(){return this.selectorText}}]),t}(BaseStyleRule),pluginStyleRule={onCreateRule:function(e,t,r){return"@"===e[0]||r.parent&&"keyframes"===r.parent.type?null:new StyleRule(e,t,r)}},defaultToStringOptions={indent:1,children:!0},atRegExp=/@([\w-]+)/,ConditionalRule=function(){function e(e,t,r){this.type="conditional",this.isProcessed=!1,this.key=e;var n=e.match(atRegExp);for(var o in this.at=n?n[1]:"unknown",this.query=r.name||"@"+this.at,this.options=r,this.rules=new RuleList(_extends$4({},r,{parent:this})),t)this.rules.add(o,t[o]);this.rules.process()}var t=e.prototype;return t.getRule=function(e){return this.rules.get(e)},t.indexOf=function(e){return this.rules.indexOf(e)},t.addRule=function(e,t,r){var n=this.rules.add(e,t,r);return n?(this.options.jss.plugins.onProcessRule(n),n):null},t.replaceRule=function(e,t,r){var n=this.rules.replace(e,t,r);return n&&this.options.jss.plugins.onProcessRule(n),n},t.toString=function(e){void 0===e&&(e=defaultToStringOptions);var t=getWhitespaceSymbols(e).linebreak;if(null==e.indent&&(e.indent=defaultToStringOptions.indent),null==e.children&&(e.children=defaultToStringOptions.children),!1===e.children)return this.query+" {}";var r=this.rules.toString(e);return r?this.query+" {"+t+r+t+"}":""},e}(),keyRegExp=/@media|@supports\s+/,pluginConditionalRule={onCreateRule:function(e,t,r){return keyRegExp.test(e)?new ConditionalRule(e,t,r):null}},defaultToStringOptions$1={indent:1,children:!0},nameRegExp=/@keyframes\s+([\w-]+)/,KeyframesRule=function(){function e(e,t,r){this.type="keyframes",this.at="@keyframes",this.isProcessed=!1;var n=e.match(nameRegExp);n&&n[1]?this.name=n[1]:this.name="noname",this.key=this.type+"-"+this.name,this.options=r;var o=r.scoped,i=r.sheet,a=r.generateId;for(var s in this.id=!1===o?this.name:escape$1(a(this,i)),this.rules=new RuleList(_extends$4({},r,{parent:this})),t)this.rules.add(s,t[s],_extends$4({},r,{parent:this}));this.rules.process()}return e.prototype.toString=function(e){void 0===e&&(e=defaultToStringOptions$1);var t=getWhitespaceSymbols(e).linebreak;if(null==e.indent&&(e.indent=defaultToStringOptions$1.indent),null==e.children&&(e.children=defaultToStringOptions$1.children),!1===e.children)return this.at+" "+this.id+" {}";var r=this.rules.toString(e);return r&&(r=""+t+r+t),this.at+" "+this.id+" {"+r+"}"},e}(),keyRegExp$1=/@keyframes\s+/,refRegExp$1=/\$([\w-]+)/g,findReferencedKeyframe=function(e,t){return"string"==typeof e?e.replace(refRegExp$1,(function(e,r){return r in t?t[r]:e})):e},replaceRef=function(e,t,r){var n=e[t],o=findReferencedKeyframe(n,r);o!==n&&(e[t]=o)},pluginKeyframesRule={onCreateRule:function(e,t,r){return"string"==typeof e&&keyRegExp$1.test(e)?new KeyframesRule(e,t,r):null},onProcessStyle:function(e,t,r){return"style"===t.type&&r?("animation-name"in e&&replaceRef(e,"animation-name",r.keyframes),"animation"in e&&replaceRef(e,"animation",r.keyframes),e):e},onChangeValue:function(e,t,r){var n=r.options.sheet;if(!n)return e;switch(t){case"animation":case"animation-name":return findReferencedKeyframe(e,n.keyframes);default:return e}}},KeyframeRule=function(e){function t(){return e.apply(this,arguments)||this}return _inheritsLoose(t,e),t.prototype.toString=function(e){var t=this.options.sheet,r=!!t&&t.options.link?_extends$4({},e,{allowEmpty:!0}):e;return toCss(this.key,this.style,r)},t}(BaseStyleRule),pluginKeyframeRule={onCreateRule:function(e,t,r){return r.parent&&"keyframes"===r.parent.type?new KeyframeRule(e,t,r):null}},FontFaceRule=function(){function e(e,t,r){this.type="font-face",this.at="@font-face",this.isProcessed=!1,this.key=e,this.style=t,this.options=r}return e.prototype.toString=function(e){var t=getWhitespaceSymbols(e).linebreak;if(Array.isArray(this.style)){for(var r="",n=0;n<this.style.length;n++)r+=toCss(this.at,this.style[n]),this.style[n+1]&&(r+=t);return r}return toCss(this.at,this.style,e)},e}(),keyRegExp$2=/@font-face/,pluginFontFaceRule={onCreateRule:function(e,t,r){return keyRegExp$2.test(e)?new FontFaceRule(e,t,r):null}},ViewportRule=function(){function e(e,t,r){this.type="viewport",this.at="@viewport",this.isProcessed=!1,this.key=e,this.style=t,this.options=r}return e.prototype.toString=function(e){return toCss(this.key,this.style,e)},e}(),pluginViewportRule={onCreateRule:function(e,t,r){return"@viewport"===e||"@-ms-viewport"===e?new ViewportRule(e,t,r):null}},SimpleRule=function(){function e(e,t,r){this.type="simple",this.isProcessed=!1,this.key=e,this.value=t,this.options=r}return e.prototype.toString=function(e){if(Array.isArray(this.value)){for(var t="",r=0;r<this.value.length;r++)t+=this.key+" "+this.value[r]+";",this.value[r+1]&&(t+="\n");return t}return this.key+" "+this.value+";"},e}(),keysMap={"@charset":!0,"@import":!0,"@namespace":!0},pluginSimpleRule={onCreateRule:function(e,t,r){return e in keysMap?new SimpleRule(e,t,r):null}},plugins=[pluginStyleRule,pluginConditionalRule,pluginKeyframesRule,pluginKeyframeRule,pluginFontFaceRule,pluginViewportRule,pluginSimpleRule],defaultUpdateOptions={process:!0},forceUpdateOptions={force:!0,process:!0},RuleList=function(){function e(e){this.map={},this.raw={},this.index=[],this.counter=0,this.options=e,this.classes=e.classes,this.keyframes=e.keyframes}var t=e.prototype;return t.add=function(e,t,r){var n=this.options,o=n.parent,i=n.sheet,a=n.jss,s=n.Renderer,l=n.generateId,c=n.scoped,u=_extends$4({classes:this.classes,parent:o,sheet:i,jss:a,Renderer:s,generateId:l,scoped:c,name:e,keyframes:this.keyframes,selector:void 0},r),d=e;e in this.raw&&(d=e+"-d"+this.counter++),this.raw[d]=t,d in this.classes&&(u.selector="."+escape$1(this.classes[d]));var h=createRule(d,t,u);if(!h)return null;this.register(h);var p=void 0===u.index?this.index.length:u.index;return this.index.splice(p,0,h),h},t.replace=function(e,t,r){var n=this.get(e),o=this.index.indexOf(n);n&&this.remove(n);var i=r;return-1!==o&&(i=_extends$4({},r,{index:o})),this.add(e,t,i)},t.get=function(e){return this.map[e]},t.remove=function(e){this.unregister(e),delete this.raw[e.key],this.index.splice(this.index.indexOf(e),1)},t.indexOf=function(e){return this.index.indexOf(e)},t.process=function(){var e=this.options.jss.plugins;this.index.slice(0).forEach(e.onProcessRule,e)},t.register=function(e){this.map[e.key]=e,e instanceof StyleRule?(this.map[e.selector]=e,e.id&&(this.classes[e.key]=e.id)):e instanceof KeyframesRule&&this.keyframes&&(this.keyframes[e.name]=e.id)},t.unregister=function(e){delete this.map[e.key],e instanceof StyleRule?(delete this.map[e.selector],delete this.classes[e.key]):e instanceof KeyframesRule&&delete this.keyframes[e.name]},t.update=function(){var e,t,r;if("string"==typeof(arguments.length<=0?void 0:arguments[0])?(e=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1],r=arguments.length<=2?void 0:arguments[2]):(t=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1],e=null),e)this.updateOne(this.get(e),t,r);else for(var n=0;n<this.index.length;n++)this.updateOne(this.index[n],t,r)},t.updateOne=function(t,r,n){void 0===n&&(n=defaultUpdateOptions);var o=this.options,i=o.jss.plugins,a=o.sheet;if(t.rules instanceof e)t.rules.update(r,n);else{var s=t.style;if(i.onUpdate(r,t,a,n),n.process&&s&&s!==t.style){for(var l in i.onProcessStyle(t.style,t,a),t.style){var c=t.style[l];c!==s[l]&&t.prop(l,c,forceUpdateOptions)}for(var u in s){var d=t.style[u],h=s[u];null==d&&d!==h&&t.prop(u,null,forceUpdateOptions)}}}},t.toString=function(e){for(var t="",r=this.options.sheet,n=!!r&&r.options.link,o=getWhitespaceSymbols(e).linebreak,i=0;i<this.index.length;i++){var a=this.index[i].toString(e);(a||n)&&(t&&(t+=o),t+=a)}return t},e}(),StyleSheet=function(){function e(e,t){for(var r in this.attached=!1,this.deployed=!1,this.classes={},this.keyframes={},this.options=_extends$4({},t,{sheet:this,parent:this,classes:this.classes,keyframes:this.keyframes}),t.Renderer&&(this.renderer=new t.Renderer(this)),this.rules=new RuleList(this.options),e)this.rules.add(r,e[r]);this.rules.process()}var t=e.prototype;return t.attach=function(){return this.attached||(this.renderer&&this.renderer.attach(),this.attached=!0,this.deployed||this.deploy()),this},t.detach=function(){return this.attached?(this.renderer&&this.renderer.detach(),this.attached=!1,this):this},t.addRule=function(e,t,r){var n=this.queue;this.attached&&!n&&(this.queue=[]);var o=this.rules.add(e,t,r);return o?(this.options.jss.plugins.onProcessRule(o),this.attached?this.deployed?(n?n.push(o):(this.insertRule(o),this.queue&&(this.queue.forEach(this.insertRule,this),this.queue=void 0)),o):o:(this.deployed=!1,o)):null},t.replaceRule=function(e,t,r){var n=this.rules.get(e);if(!n)return this.addRule(e,t,r);var o=this.rules.replace(e,t,r);return o&&this.options.jss.plugins.onProcessRule(o),this.attached?this.deployed?(this.renderer&&(o?n.renderable&&this.renderer.replaceRule(n.renderable,o):this.renderer.deleteRule(n)),o):o:(this.deployed=!1,o)},t.insertRule=function(e){this.renderer&&this.renderer.insertRule(e)},t.addRules=function(e,t){var r=[];for(var n in e){var o=this.addRule(n,e[n],t);o&&r.push(o)}return r},t.getRule=function(e){return this.rules.get(e)},t.deleteRule=function(e){var t="object"==typeof e?e:this.rules.get(e);return!(!t||this.attached&&!t.renderable)&&(this.rules.remove(t),!(this.attached&&t.renderable&&this.renderer)||this.renderer.deleteRule(t.renderable))},t.indexOf=function(e){return this.rules.indexOf(e)},t.deploy=function(){return this.renderer&&this.renderer.deploy(),this.deployed=!0,this},t.update=function(){var e;return(e=this.rules).update.apply(e,arguments),this},t.updateOne=function(e,t,r){return this.rules.updateOne(e,t,r),this},t.toString=function(e){return this.rules.toString(e)},e}(),PluginsRegistry=function(){function e(){this.plugins={internal:[],external:[]},this.registry={}}var t=e.prototype;return t.onCreateRule=function(e,t,r){for(var n=0;n<this.registry.onCreateRule.length;n++){var o=this.registry.onCreateRule[n](e,t,r);if(o)return o}return null},t.onProcessRule=function(e){if(!e.isProcessed){for(var t=e.options.sheet,r=0;r<this.registry.onProcessRule.length;r++)this.registry.onProcessRule[r](e,t);e.style&&this.onProcessStyle(e.style,e,t),e.isProcessed=!0}},t.onProcessStyle=function(e,t,r){for(var n=0;n<this.registry.onProcessStyle.length;n++)t.style=this.registry.onProcessStyle[n](t.style,t,r)},t.onProcessSheet=function(e){for(var t=0;t<this.registry.onProcessSheet.length;t++)this.registry.onProcessSheet[t](e)},t.onUpdate=function(e,t,r,n){for(var o=0;o<this.registry.onUpdate.length;o++)this.registry.onUpdate[o](e,t,r,n)},t.onChangeValue=function(e,t,r){for(var n=e,o=0;o<this.registry.onChangeValue.length;o++)n=this.registry.onChangeValue[o](n,t,r);return n},t.use=function(e,t){void 0===t&&(t={queue:"external"});var r=this.plugins[t.queue];-1===r.indexOf(e)&&(r.push(e),this.registry=[].concat(this.plugins.external,this.plugins.internal).reduce((function(e,t){for(var r in t)r in e&&e[r].push(t[r]);return e}),{onCreateRule:[],onProcessRule:[],onProcessStyle:[],onProcessSheet:[],onChangeValue:[],onUpdate:[]}))},e}(),SheetsRegistry=function(){function e(){this.registry=[]}var t=e.prototype;return t.add=function(e){var t=this.registry,r=e.options.index;if(-1===t.indexOf(e))if(0===t.length||r>=this.index)t.push(e);else for(var n=0;n<t.length;n++)if(t[n].options.index>r)return void t.splice(n,0,e)},t.reset=function(){this.registry=[]},t.remove=function(e){var t=this.registry.indexOf(e);this.registry.splice(t,1)},t.toString=function(e){for(var t=void 0===e?{}:e,r=t.attached,n=_objectWithoutPropertiesLoose$e(t,["attached"]),o=getWhitespaceSymbols(n).linebreak,i="",a=0;a<this.registry.length;a++){var s=this.registry[a];null!=r&&s.attached!==r||(i&&(i+=o),i+=s.toString(n))}return i},_createClass$2D(e,[{key:"index",get:function(){return 0===this.registry.length?0:this.registry[this.registry.length-1].options.index}}]),e}(),sheets=new SheetsRegistry,globalThis$1="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window&&window.Math===Math?window:"undefined"!=typeof self&&self.Math===Math?self:Function("return this")(),ns="2f1acc6c3a606b082e5eef5e54414ffb";null==globalThis$1[ns]&&(globalThis$1[ns]=0);var moduleId=globalThis$1[ns]++,createGenerateId=function(e){void 0===e&&(e={});var t=0;return function(r,n){t+=1;var o="",i="";return n&&(n.options.classNamePrefix&&(i=n.options.classNamePrefix),null!=n.options.jss.id&&(o=String(n.options.jss.id))),e.minify?""+(i||"c")+moduleId+o+t:i+r.key+"-"+moduleId+(o?"-"+o:"")+"-"+t}},memoize$1=function(e){var t;return function(){return t||(t=e()),t}},getPropertyValue=function(e,t){try{return e.attributeStyleMap?e.attributeStyleMap.get(t):e.style.getPropertyValue(t)}catch(r){return""}},setProperty=function(e,t,r){try{var n=r;if(Array.isArray(r)&&(n=toCssValue(r)),e.attributeStyleMap)e.attributeStyleMap.set(t,n);else{var o=n?n.indexOf("!important"):-1,i=o>-1?n.substr(0,o-1):n;e.style.setProperty(t,i,o>-1?"important":"")}}catch(a){return!1}return!0},removeProperty=function(e,t){try{e.attributeStyleMap?e.attributeStyleMap.delete(t):e.style.removeProperty(t)}catch(r){}},setSelector=function(e,t){return e.selectorText=t,e.selectorText===t},getHead=memoize$1((function(){return document.querySelector("head")}));function findHigherSheet(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.attached&&n.options.index>t.index&&n.options.insertionPoint===t.insertionPoint)return n}return null}function findHighestSheet(e,t){for(var r=e.length-1;r>=0;r--){var n=e[r];if(n.attached&&n.options.insertionPoint===t.insertionPoint)return n}return null}function findCommentNode(e){for(var t=getHead(),r=0;r<t.childNodes.length;r++){var n=t.childNodes[r];if(8===n.nodeType&&n.nodeValue.trim()===e)return n}return null}function findPrevNode(e){var t=sheets.registry;if(t.length>0){var r=findHigherSheet(t,e);if(r&&r.renderer)return{parent:r.renderer.element.parentNode,node:r.renderer.element};if((r=findHighestSheet(t,e))&&r.renderer)return{parent:r.renderer.element.parentNode,node:r.renderer.element.nextSibling}}var n=e.insertionPoint;if(n&&"string"==typeof n){var o=findCommentNode(n);if(o)return{parent:o.parentNode,node:o.nextSibling}}return!1}function insertStyle(e,t){var r=t.insertionPoint,n=findPrevNode(t);if(!1!==n&&n.parent)n.parent.insertBefore(e,n.node);else if(r&&"number"==typeof r.nodeType){var o=r,i=o.parentNode;i&&i.insertBefore(e,o.nextSibling)}else getHead().appendChild(e)}var getNonce=memoize$1((function(){var e=document.querySelector('meta[property="csp-nonce"]');return e?e.getAttribute("content"):null})),_insertRule=function(e,t,r){try{"insertRule"in e?e.insertRule(t,r):"appendRule"in e&&e.appendRule(t)}catch(n){return!1}return e.cssRules[r]},getValidRuleInsertionIndex=function(e,t){var r=e.cssRules.length;return void 0===t||t>r?r:t},createStyle=function(){var e=document.createElement("style");return e.textContent="\n",e},DomRenderer=function(){function e(e){this.getPropertyValue=getPropertyValue,this.setProperty=setProperty,this.removeProperty=removeProperty,this.setSelector=setSelector,this.hasInsertedRules=!1,this.cssRules=[],e&&sheets.add(e),this.sheet=e;var t=this.sheet?this.sheet.options:{},r=t.media,n=t.meta,o=t.element;this.element=o||createStyle(),this.element.setAttribute("data-jss",""),r&&this.element.setAttribute("media",r),n&&this.element.setAttribute("data-meta",n);var i=getNonce();i&&this.element.setAttribute("nonce",i)}var t=e.prototype;return t.attach=function(){if(!this.element.parentNode&&this.sheet){insertStyle(this.element,this.sheet.options);var e=Boolean(this.sheet&&this.sheet.deployed);this.hasInsertedRules&&e&&(this.hasInsertedRules=!1,this.deploy())}},t.detach=function(){if(this.sheet){var e=this.element.parentNode;e&&e.removeChild(this.element),this.sheet.options.link&&(this.cssRules=[],this.element.textContent="\n")}},t.deploy=function(){var e=this.sheet;e&&(e.options.link?this.insertRules(e.rules):this.element.textContent="\n"+e.toString()+"\n")},t.insertRules=function(e,t){for(var r=0;r<e.index.length;r++)this.insertRule(e.index[r],r,t)},t.insertRule=function(e,t,r){if(void 0===r&&(r=this.element.sheet),e.rules){var n=e,o=r;if("conditional"===e.type||"keyframes"===e.type){var i=getValidRuleInsertionIndex(r,t);if(!1===(o=_insertRule(r,n.toString({children:!1}),i)))return!1;this.refCssRule(e,i,o)}return this.insertRules(n.rules,o),o}var a=e.toString();if(!a)return!1;var s=getValidRuleInsertionIndex(r,t),l=_insertRule(r,a,s);return!1!==l&&(this.hasInsertedRules=!0,this.refCssRule(e,s,l),l)},t.refCssRule=function(e,t,r){e.renderable=r,e.options.parent instanceof StyleSheet&&this.cssRules.splice(t,0,r)},t.deleteRule=function(e){var t=this.element.sheet,r=this.indexOf(e);return-1!==r&&(t.deleteRule(r),this.cssRules.splice(r,1),!0)},t.indexOf=function(e){return this.cssRules.indexOf(e)},t.replaceRule=function(e,t){var r=this.indexOf(e);return-1!==r&&(this.element.sheet.deleteRule(r),this.cssRules.splice(r,1),this.insertRule(t,r))},t.getRules=function(){return this.element.sheet.cssRules},e}(),instanceCounter=0,Jss=function(){function e(e){this.id=instanceCounter++,this.version="10.9.2",this.plugins=new PluginsRegistry,this.options={id:{minify:!1},createGenerateId:createGenerateId,Renderer:isBrowser?DomRenderer:null,plugins:[]},this.generateId=createGenerateId({minify:!1});for(var t=0;t<plugins.length;t++)this.plugins.use(plugins[t],{queue:"internal"});this.setup(e)}var t=e.prototype;return t.setup=function(e){return void 0===e&&(e={}),e.createGenerateId&&(this.options.createGenerateId=e.createGenerateId),e.id&&(this.options.id=_extends$4({},this.options.id,e.id)),(e.createGenerateId||e.id)&&(this.generateId=this.options.createGenerateId(this.options.id)),null!=e.insertionPoint&&(this.options.insertionPoint=e.insertionPoint),"Renderer"in e&&(this.options.Renderer=e.Renderer),e.plugins&&this.use.apply(this,e.plugins),this},t.createStyleSheet=function(e,t){void 0===t&&(t={});var r=t.index;"number"!=typeof r&&(r=0===sheets.index?0:sheets.index+1);var n=new StyleSheet(e,_extends$4({},t,{jss:this,generateId:t.generateId||this.generateId,insertionPoint:this.options.insertionPoint,Renderer:this.options.Renderer,index:r}));return this.plugins.onProcessSheet(n),n},t.removeStyleSheet=function(e){return e.detach(),sheets.remove(e),this},t.createRule=function(e,t,r){if(void 0===t&&(t={}),void 0===r&&(r={}),"object"==typeof e)return this.createRule(void 0,e,t);var n=_extends$4({},r,{name:e,jss:this,Renderer:this.options.Renderer});n.generateId||(n.generateId=this.generateId),n.classes||(n.classes={}),n.keyframes||(n.keyframes={});var o=createRule(e,t,n);return o&&this.plugins.onProcessRule(o),o},t.use=function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(t){e.plugins.use(t)})),this},e}(),createJss=function(e){return new Jss(e)};!function(){function e(){this.length=0,this.sheets=new WeakMap}var t=e.prototype;t.get=function(e){var t=this.sheets.get(e);return t&&t.sheet},t.add=function(e,t){this.sheets.has(e)||(this.length++,this.sheets.set(e,{sheet:t,refs:0}))},t.manage=function(e){var t=this.sheets.get(e);if(t)return 0===t.refs&&t.sheet.attach(),t.refs++,t.sheet},t.unmanage=function(e){var t=this.sheets.get(e);t&&t.refs>0&&(t.refs--,0===t.refs&&t.sheet.detach())},_createClass$2D(e,[{key:"size",get:function(){return this.length}}])}();var index=createJss(),at$1="@global",atPrefix="@global ",GlobalContainerRule=function(){function e(e,t,r){for(var n in this.type="global",this.at=at$1,this.isProcessed=!1,this.key=e,this.options=r,this.rules=new RuleList(_extends$4({},r,{parent:this})),t)this.rules.add(n,t[n]);this.rules.process()}var t=e.prototype;return t.getRule=function(e){return this.rules.get(e)},t.addRule=function(e,t,r){var n=this.rules.add(e,t,r);return n&&this.options.jss.plugins.onProcessRule(n),n},t.replaceRule=function(e,t,r){var n=this.rules.replace(e,t,r);return n&&this.options.jss.plugins.onProcessRule(n),n},t.indexOf=function(e){return this.rules.indexOf(e)},t.toString=function(e){return this.rules.toString(e)},e}(),GlobalPrefixedRule=function(){function e(e,t,r){this.type="global",this.at=at$1,this.isProcessed=!1,this.key=e,this.options=r;var n=e.substr(atPrefix.length);this.rule=r.jss.createRule(n,t,_extends$4({},r,{parent:this}))}return e.prototype.toString=function(e){return this.rule?this.rule.toString(e):""},e}(),separatorRegExp$1=/\s*,\s*/g;function addScope(e,t){for(var r=e.split(separatorRegExp$1),n="",o=0;o<r.length;o++)n+=t+" "+r[o].trim(),r[o+1]&&(n+=", ");return n}function handleNestedGlobalContainerRule(e,t){var r=e.options,n=e.style,o=n?n[at$1]:null;if(o){for(var i in o)t.addRule(i,o[i],_extends$4({},r,{selector:addScope(i,e.selector)}));delete n[at$1]}}function handlePrefixedGlobalRule(e,t){var r=e.options,n=e.style;for(var o in n)if("@"===o[0]&&o.substr(0,at$1.length)===at$1){var i=addScope(o.substr(at$1.length),e.selector);t.addRule(i,n[o],_extends$4({},r,{selector:i})),delete n[o]}}function jssGlobal(){return{onCreateRule:function(e,t,r){if(!e)return null;if(e===at$1)return new GlobalContainerRule(e,t,r);if("@"===e[0]&&e.substr(0,atPrefix.length)===atPrefix)return new GlobalPrefixedRule(e,t,r);var n=r.parent;return n&&("global"===n.type||n.options.parent&&"global"===n.options.parent.type)&&(r.scoped=!1),r.selector||!1!==r.scoped||(r.selector=e),null},onProcessRule:function(e,t){"style"===e.type&&t&&(handleNestedGlobalContainerRule(e,t),handlePrefixedGlobalRule(e,t))}}}var separatorRegExp=/\s*,\s*/g,parentRegExp=/&/g,refRegExp=/\$([\w-]+)/g;function jssNested(){function e(e,t){return function(r,n){var o=e.getRule(n)||t&&t.getRule(n);return o?o.selector:n}}function t(e,t){for(var r=t.split(separatorRegExp),n=e.split(separatorRegExp),o="",i=0;i<r.length;i++)for(var a=r[i],s=0;s<n.length;s++){var l=n[s];o&&(o+=", "),o+=-1!==l.indexOf("&")?l.replace(parentRegExp,a):a+" "+l}return o}function r(e,t,r){if(r)return _extends$4({},r,{index:r.index+1});var n=e.options.nestingLevel;n=void 0===n?1:n+1;var o=_extends$4({},e.options,{nestingLevel:n,index:t.indexOf(e)+1});return delete o.name,o}return{onProcessStyle:function(n,o,i){if("style"!==o.type)return n;var a,s,l=o,c=l.options.parent;for(var u in n){var d=-1!==u.indexOf("&"),h="@"===u[0];if(d||h){if(a=r(l,c,a),d){var p=t(u,l.selector);s||(s=e(c,i)),p=p.replace(refRegExp,s);var f=l.key+"-"+u;"replaceRule"in c?c.replaceRule(f,n[u],_extends$4({},a,{selector:p})):c.addRule(f,n[u],_extends$4({},a,{selector:p}))}else h&&c.addRule(u,{},a).addRule(l.key,n[u],{selector:l.selector});delete n[u]}}return n}}}const ICON_BUTTON_TYPES={FIRST_PAGE:"first",PRE_PAGE:"previous",CUR_PAGE:"page-navi",NEXT_PAGE:"next",LAST_PAGE:"last",SCALE_ADJUST:"scale",MAIL:"mail",EXPORT:"excel-menu",PDF:"export-pdf",PAGE_EXCEL:"export-excel-page",ORIGIN_EXCEL:"export-excel-ori",PAGE_SHEET_EXCEL:"export-excel-sheet",WORD:"export-word",PRINT:"print",CUSTOM_BUTTON:"button",COMPATIBLE_PRINT:"compatible-print",FLASH_PRINT:"flash-print",APPLET_PRINT:"applet-print",PDF_PRINT:"pdf-print",OFFSET_PRINT:"offset-print",SUBMIT:"submit",TEMP_SAVE:"temp-save",CHECK_DATA:"check-data",CLEAR_DATA:"clear-data",INSERT_DATA:"insert-data",DELETE_DATA:"delete-data",SHOW_CELL_VALUE:"label",IMPORT_EXCEL:"import-excel",CUSTOM_IMPOERT_EXCEL:"custom-import-excel",PRINT_PREVIEW:"print-preview",IMAGE_EXPORT:"export-image",PAGE_SETTING:"page-setting",MENU_BUTTON:"menubutton"},ICON_FONT_MAP=new Map([[ICON_BUTTON_TYPES.SUBMIT,"submit-font"],["submitall","submit-font"],["pdf","export-pdf-font"],["excel","export-excel-font"],["word","export-word-font"],["image","export-image-font"],["appletprint","print-applet-font"],[ICON_BUTTON_TYPES.LAST_PAGE,"last-page-font"],[ICON_BUTTON_TYPES.NEXT_PAGE,"next-page-font"],[ICON_BUTTON_TYPES.FIRST_PAGE,"first-page-font"],[ICON_BUTTON_TYPES.PRE_PAGE,"pre-page-font"],["pdfprint","print-pdf-font"],["flashprint","print-flash-font"],["customizexcel","import-excel-font"],["stash","temp-save-font"],[ICON_BUTTON_TYPES.PRINT,"print-font"],["export","export-font"],["setprinteroffset","print-offset-font"],["email","mail-font"],["appendrow","add-record-font"],["deleterow","delete-record-font"],["preview","print-preview-font"],["pagesetup","page-setting-font"],["frozzen","show-cell-font"],["clearstash","clear-data-font"],["verify","check-data-font"]]),ERROR_CODE={DATA_NO_AUTH:"22400070"};function _classCallCheck$2B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2w(n.key),n)}}function _createClass$2B(e,t,r){return t&&_defineProperties$2w(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2w(e){var t=_toPrimitive$2w(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2w(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$26(e,t,r){return t=_getPrototypeOf$26(t),_possibleConstructorReturn$26(e,_isNativeReflectConstruct$26()?Reflect.construct(t,r||[],_getPrototypeOf$26(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$26(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$26(e)}function _assertThisInitialized$26(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$26(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$26=function(){return!!e})()}function _getPrototypeOf$26(e){return(_getPrototypeOf$26=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$26(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$26(e,t)}function _setPrototypeOf$26(e,t){return(_setPrototypeOf$26=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __decorate$1j=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};const{shortcut:shortcut,model:model,store:store$1,Model:Model,provider:provider}=BI.Decorators;let BasicButtonWrapper=function(e){function t(){return _classCallCheck$2B(this,t),_callSuper$26(this,t,arguments)}return _inherits$26(t,BI.BasicButton),_createClass$2B(t,[{key:"render",value:function(){return this.options.render()}},{key:"doClick",value:function(){this.options.doClick()}}])}();function click(){return function(e,t,r){const n=r.value;return r.value=function(...e){return{type:BasicButtonWrapper.xtype,cls:"cursor-default",render:()=>n.apply(this,e),doClick:()=>{this.fireEvent("click")}}},r}}function transformColor(e){if(BI.isString(e))return e;if(!e)return"#000";const t=(~e).toString(16),r=parseInt("0x".concat(t.replace(/#/g,"")),16),n="000000".concat((16777215-r).toString(16));return"#".concat(n.substring(n.length-6,n.length))}function getIconCls(e){return ICON_FONT_MAP.get(e.iconName)||getIconImageCls(e)}function getIconImageCls(e){const t="icon-".concat(BI.UUID()),{iconPosition:r,toolbarImage:n}=e;return index.use(jssGlobal(),jssNested()),index.createStyleSheet({"@global":{[".".concat(t," .b-font")]:{"background-image":"url(".concat(n,")"),"background-repeat":"no-repeat","background-position":r,height:"16px",width:"16px"},[".base-disabled .".concat(t," .b-font")]:{opacity:".5"}}}).attach(),t}function htmlDecode(e){return BI.isNull(e)?"":e.replace(/<br\/>/g,"\n").replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ")}function _classCallCheck$2A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2v(n.key),n)}}function _createClass$2A(e,t,r){return t&&_defineProperties$2v(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2v(e){var t=_toPrimitive$2v(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2v(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$25(e,t,r){return t=_getPrototypeOf$25(t),_possibleConstructorReturn$25(e,_isNativeReflectConstruct$25()?Reflect.construct(t,r||[],_getPrototypeOf$25(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$25(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$25(e)}function _assertThisInitialized$25(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$25(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$25=function(){return!!e})()}function _getPrototypeOf$25(e){return(_getPrototypeOf$25=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$25(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$25(e,t)}function _setPrototypeOf$25(e,t){return(_setPrototypeOf$25=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}BasicButtonWrapper.xtype="report.core.basic_button_wrapper",BasicButtonWrapper=__decorate$1j([shortcut()],BasicButtonWrapper);var __decorate$1i=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__rest$l=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};let ReportHtml=function(e){function t(){var e;return _classCallCheck$2A(this,t),(e=_callSuper$25(this,t,arguments)).props={baseCls:"report-html",text:"",textAlign:"left",lineHeight:null,whiteSpace:"normal"},e}return _inherits$25(t,BI.Widget),_createClass$2A(t,[{key:"render",value:function(){const e=this.options,{text:t}=e,r=__rest$l(e,["text"]);return Object.assign(Object.assign({},r),{type:BI.Html.xtype,ref:e=>{this.htmlContainer=e},text:htmlDecode(t)})}},{key:"setText",value:function(e){this.htmlContainer.setText(htmlDecode(e))}}])}();function _classCallCheck$2z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2u(n.key),n)}}function _createClass$2z(e,t,r){return t&&_defineProperties$2u(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2u(e){var t=_toPrimitive$2u(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2u(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$24(e,t,r){return t=_getPrototypeOf$24(t),_possibleConstructorReturn$24(e,_isNativeReflectConstruct$24()?Reflect.construct(t,r||[],_getPrototypeOf$24(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$24(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$24(e)}function _assertThisInitialized$24(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$24(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$24=function(){return!!e})()}function _getPrototypeOf$24(e){return(_getPrototypeOf$24=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$24(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$24(e,t)}function _setPrototypeOf$24(e,t){return(_setPrototypeOf$24=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ReportHtml.xtype="report.components.html",ReportHtml=__decorate$1i([shortcut()],ReportHtml);var __decorate$1h=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__rest$k=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},ErrorTipTab,ErrorTipTab2;ErrorTipTab2=ErrorTipTab||(ErrorTipTab={}),ErrorTipTab2.SOLUTION="solution",ErrorTipTab2.EXCEPTION="exception";let ErrorTipModel=function(e){function t(){var e;return _classCallCheck$2z(this,t),(e=_callSuper$24(this,t,arguments)).actions={changeTabPanel:t=>{e.model.showIndex=t},setErrorResult:t=>{const{solution:r}=t,n=__rest$k(t,["solution"]);e.model.errorResult=Object.assign({solution:r||BI.i18nText("Fine-Report_Preview_Fail_Tip")},n)}},e}return _inherits$24(t,Model),_createClass$2z(t,[{key:"state",value:function(){return{showIndex:ErrorTipTab.SOLUTION,errorResult:{}}}}])}();function _classCallCheck$2y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2t(n.key),n)}}function _createClass$2y(e,t,r){return t&&_defineProperties$2t(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2t(e){var t=_toPrimitive$2t(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2t(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$23(e,t,r){return t=_getPrototypeOf$23(t),_possibleConstructorReturn$23(e,_isNativeReflectConstruct$23()?Reflect.construct(t,r||[],_getPrototypeOf$23(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$23(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$23(e)}function _assertThisInitialized$23(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$23(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$23=function(){return!!e})()}function _superPropGet$s(e,t,r,n){var o=_get$s(_getPrototypeOf$23(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$s(){return _get$s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$s(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$s.apply(null,arguments)}function _superPropBase$s(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$23(e)););return e}function _getPrototypeOf$23(e){return(_getPrototypeOf$23=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$23(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$23(e,t)}function _setPrototypeOf$23(e,t){return(_setPrototypeOf$23=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ErrorTipModel.xtype="report.model.errortip",ErrorTipModel=__decorate$1h([model()],ErrorTipModel);var __decorate$1g=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ErrorTip=function(e){function t(){var e;return _classCallCheck$2y(this,t),(e=_callSuper$23(this,t,arguments)).props={baseCls:"report-main-components-error-pane bi-user-select-enable",errorCode:"",errorMsg:"",errorTip:"",solution:"",exception:""},e}return _inherits$23(t,BI.Widget),_createClass$2y(t,[{key:"setup",value:function(){const e=this;return function(){return e.store.setErrorResult(e.options),{type:BI.CenterAdaptLayout.xtype,items:[{type:BI.VerticalLayout.xtype,vgap:10,items:[{type:BI.CenterAdaptLayout.xtype,items:[{type:BI.Icon.xtype,height:130,width:130,cls:"preview-fail-tip-background"}]},{type:BI.Label.xtype,cls:"fail-tip-title bi-font-PingFang bi-font-bold",text:BI.i18nText("Fine-Report_Preview_Fail_Title")},{type:BI.Label.xtype,width:540,whiteSpace:"normal",cls:"fail-tip-message  bi-font-PingFang bi-font-bold",text:()=>e.getErrorCodeText(e.model.errorResult.errorMsg)},{type:BI.VerticalLayout.xtype,cls:"error-tips",items:[{type:BI.LinearSegment.xtype,height:40,ref:t=>{e.tabTrigger=t},cls:"fail-tip-message",value:ErrorTipTab.SOLUTION,items:[{text:BI.i18nText("Fine-Report_Exception"),value:ErrorTipTab.EXCEPTION},{text:BI.i18nText("Fine-Report_Solution"),value:ErrorTipTab.SOLUTION}],listeners:[{eventName:"EVENT_CHANGE",action:()=>{var t;e.store.changeTabPanel(null===(t=e.tabTrigger)||void 0===t?void 0:t.getValue()[0])}}]},{type:BI.Tab.xtype,height:260,vgap:10,showIndex:()=>e.model.showIndex,cardCreator:t=>{switch(t){case ErrorTipTab.EXCEPTION:return{type:BI.VerticalLayout.xtype,scrolly:!0,hgap:10,items:[{el:{type:BI.Text.xtype,text:()=>e.model.errorResult.exception}}]};case ErrorTipTab.SOLUTION:default:return{type:BI.VerticalLayout.xtype,scrolly:!0,hgap:10,items:[{el:{type:ReportHtml.xtype,ref:t=>{e.labelSolution=t},text:BI.i18nText("Fine-Report_Preview_Fail_Tip")}}]}}}}]}]}]}}}},{key:"setErrorTexts",value:function(e){var t;const{errorTip:r,solution:n}=e;null===(t=this.labelSolution)||void 0===t||t.setText(n||r||BI.i18nText("Fine-Report_Preview_Fail_Tip")),this.store.setErrorResult(e)}},{key:"getErrorCodeText",value:function(e){const t=e;return t.length>500?"".concat(t.substring(0,500),"..."):t}},{key:"destroyed",value:function(){var e;null===(e=_superPropGet$s(t,"destroyed",this,1))||void 0===e||e.call(this),this.tabTrigger=null,this.labelSolution=null}}])}();function errorTip(){return function(e,t,r){const n=r.value;return r.value=function(...e){let t;return this.on("EVENT_SHOW_ERROR",(e=>{null==t||t.setErrorTexts(e),null==t||t.visible()})),[n.apply(this,...e),{type:BI.AbsoluteLayout.xtype,items:[{el:{type:ErrorTip.xtype,invisible:!0,ref:e=>{t=e},cls:"bi-card"},top:0,left:0,right:0,bottom:0}],destroyed:()=>{var e;null===(e=null==t?void 0:t.destroyed)||void 0===e||e.call(t),t=null}}]},r}}function _classCallCheck$2x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2s(n.key),n)}}function _createClass$2x(e,t,r){return t&&_defineProperties$2s(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2s(e){var t=_toPrimitive$2s(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2s(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}ErrorTip.xtype="report.components.error_tip",ErrorTip=__decorate$1g([shortcut(),store$1(ErrorTipModel)],ErrorTip);let AbstractEnv=_createClass$2x((function e(){_classCallCheck$2x(this,e),this.init()}),[{key:"init",value:function(){}},{key:"toJSON",value:function(){return{reqPrefix:this.getReqPrefix(),sessionID:this.getSessionID(),version:this.getVersion(),fineServletURL:this.getFineServletURL(),initParameters:this.getInitParameters(),servletURL:this.getServletURL()}}}]);function _callSuper$22(e,t,r){return t=_getPrototypeOf$22(t),_possibleConstructorReturn$22(e,_isNativeReflectConstruct$22()?Reflect.construct(t,r||[],_getPrototypeOf$22(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$22(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$22(e)}function _assertThisInitialized$22(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$22(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$22=function(){return!!e})()}function _getPrototypeOf$22(e){return(_getPrototypeOf$22=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$22(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$22(e,t)}function _setPrototypeOf$22(e,t){return(_setPrototypeOf$22=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _classCallCheck$2w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2r(n.key),n)}}function _createClass$2w(e,t,r){return t&&_defineProperties$2r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2r(e){var t=_toPrimitive$2r(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2r(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var __decorate$1f=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ReportEnvProvider=_createClass$2w((function e(){_classCallCheck$2w(this,e)}),[{key:"$get",value:function(){const e=this;return _createClass$2w((function e(){_classCallCheck$2w(this,e)}),[{key:"Version",get:function(){return e.env.getVersion()}},{key:"FineServletURL",get:function(){return e.env.getFineServletURL()}},{key:"ReqPrefix",get:function(){return e.env.getReqPrefix()}},{key:"SessionID",get:function(){return e.env.getSessionID()}},{key:"initParameters",get:function(){return e.env.getInitParameters()}},{key:"use",value:function(t){e.env=new t}},{key:"assign",value:function(t){e.env=transformEnvJSON2AbstractEnv(t)}},{key:"isAssigned",value:function(){return!!e.env}},{key:"getInstance",value:function(){return e.env}},{key:"servletURL",get:function(){return e.env.getServletURL()}}])}},{key:"useEnv",value:function(e){this.env=transformEnvJSON2AbstractEnv(e)}}]);function transformEnvJSON2AbstractEnv(e){let t=function(){function t(){return _classCallCheck$2w(this,t),_callSuper$22(this,t,arguments)}return _inherits$22(t,AbstractEnv),_createClass$2w(t,[{key:"getFineServletURL",value:function(){return"getFineServletURL"in e?e.getFineServletURL():e.fineServletURL}},{key:"getReqPrefix",value:function(){return"getReqPrefix"in e?e.getReqPrefix():e.reqPrefix}},{key:"getVersion",value:function(){return"getVersion"in e?e.getVersion():e.version}},{key:"getServletURL",value:function(){return"getServletURL"in e?e.getServletURL():e.servletURL}},{key:"getSessionID",value:function(){return"getSessionID"in e?e.getSessionID():e.sessionID}},{key:"getInitParameters",value:function(){return"getInitParameters"in e?e.getInitParameters():e.initParameters}}])}();return new t}ReportEnvProvider.xtype="report.env.provider",ReportEnvProvider=__decorate$1f([provider()],ReportEnvProvider);const envProvider=BI.Providers.getProvider(ReportEnvProvider.xtype);function _classCallCheck$2v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2q(n.key),n)}}function _createClass$2v(e,t,r){return t&&_defineProperties$2q(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2q(e){var t=_toPrimitive$2q(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2q(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$21(e,t,r){return t=_getPrototypeOf$21(t),_possibleConstructorReturn$21(e,_isNativeReflectConstruct$21()?Reflect.construct(t,r||[],_getPrototypeOf$21(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$21(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$21(e)}function _assertThisInitialized$21(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$21(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$21=function(){return!!e})()}function _getPrototypeOf$21(e){return(_getPrototypeOf$21=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$21(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$21(e,t)}function _setPrototypeOf$21(e,t){return(_setPrototypeOf$21=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _classCallCheck$2u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2p(n.key),n)}}function _createClass$2u(e,t,r){return t&&_defineProperties$2p(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2p(e){var t=_toPrimitive$2p(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2p(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$20(e,t,r){return t=_getPrototypeOf$20(t),_possibleConstructorReturn$20(e,_isNativeReflectConstruct$20()?Reflect.construct(t,r||[],_getPrototypeOf$20(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$20(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$20(e)}function _assertThisInitialized$20(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$20(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$20=function(){return!!e})()}function _getPrototypeOf$20(e){return(_getPrototypeOf$20=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$20(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$20(e,t)}function _setPrototypeOf$20(e,t){return(_setPrototypeOf$20=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _classCallCheck$2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2o(n.key),n)}}function _createClass$2t(e,t,r){return t&&_defineProperties$2o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2o(e){var t=_toPrimitive$2o(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2o(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}!function(e){function t(){return _classCallCheck$2v(this,t),_callSuper$21(this,t,arguments)}_inherits$21(t,AbstractEnv),_createClass$2v(t,[{key:"getVersion",value:function(){return""}},{key:"getFineServletURL",value:function(){return Report.fineServletURL}},{key:"getReqPrefix",value:function(){return"".concat(this.getFineServletURL(),"/view/fit/form")}},{key:"getSessionID",value:function(){return Report.SessionMgr.get()}},{key:"getInitParameters",value:function(){}},{key:"getServletURL",value:function(){return"".concat(this.getFineServletURL(),"/view/form")}}])}(),function(e){function t(){return _classCallCheck$2u(this,t),_callSuper$20(this,t,arguments)}_inherits$20(t,AbstractEnv),_createClass$2u(t,[{key:"getVersion",value:function(){return""}},{key:"getFineServletURL",value:function(){return""}},{key:"getReqPrefix",value:function(){return""}},{key:"getSessionID",value:function(){return""}},{key:"getInitParameters",value:function(){}},{key:"getServletURL",value:function(){return""}}])}();let CoreWidgetManager=function(){function e(){_classCallCheck$2t(this,e),this.controllerDict=new Map}return _createClass$2t(e,[{key:"register",value:function(e,t){this.controllerDict.set(t||e.attr("widgetName"),e)}},{key:"getWidgetsMap",value:function(){return this.controllerDict}},{key:"getWidgetByName",value:function(e){return e?this.controllerDict.get(e.toUpperCase()):void 0}},{key:"getWidgets",value:function(){return Array.from(this.getWidgetsMap().values())}},{key:"getDependenceByWidget",value:function(e){return BI.uniq(BI.concat(e.attr("dependence")||[],e.attr("valueDependence")||[])).map((e=>e.toLowerCase()))}},{key:"getValueDependenceByWidget",value:function(e){return(e.attr("widgetExeDependence")||[]).map((e=>e.toLowerCase()))}},{key:"getWidgetDependenceByWidgetName",value:function(e){return this.getWidgetDependence(e,this.getDependenceByWidget)}},{key:"getWidgetValueDependenceByWidgetName",value:function(e){return this.getWidgetDependence(e,this.getValueDependenceByWidget)}},{key:"getWidgetDependence",value:function(t,r,n=[]){const o=this.getWidgets();n.push(t);const i=o.reduce(((o,i)=>{const a=i.attr("widgetName");if(n.includes(a))return o;const s=r(i);return e.compareWidgetNameByDependences(t,s)&&o.push(a,...this.getWidgetDependence(a,r,n)),o}),[]);return BI.uniq(i)}},{key:"resolveVariable",value:function(e){const t=this.getWidgetByName(BI.startWith(e,"$")?e.substring(1):e);return t?t.getValue():void 0}},{key:"clear",value:function(){this.controllerDict.clear()}},{key:"destroy",value:function(e){e?BI.isArray(e)?e.forEach((e=>{this.controllerDict.delete(e)})):this.controllerDict.delete(e):this.clear()}},{key:"update",value:function(){}},{key:"refresh",value:function(){}}])}();function _classCallCheck$2s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2n(n.key),n)}}function _createClass$2s(e,t,r){return t&&_defineProperties$2n(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2n(e){var t=_toPrimitive$2n(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2n(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}CoreWidgetManager.compareWidgetNameByDependences=(e,t)=>t.includes("$".concat(e.toLowerCase()))||t.includes(e.toLowerCase());let UniversalEnvProvider=_createClass$2s((function e(){_classCallCheck$2s(this,e)}),[{key:"ReqPrefix",get:function(){var e;return(null===(e=this.env)||void 0===e?void 0:e.getReqPrefix())||envProvider.ReqPrefix}},{key:"use",value:function(e){this.env=new e}},{key:"assign",value:function(e){this.env=e}}]);const universalEnvProvider=new UniversalEnvProvider;function _createClass$2r(e,t,r){return Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck$2r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck$2q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2m(n.key),n)}}function _createClass$2q(e,t,r){return t&&_defineProperties$2m(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2m(e){var t=_toPrimitive$2m(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2m(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}_createClass$2r((function e(){_classCallCheck$2r(this,e)}));var __decorate$1e=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let TableStickerGenerator=_createClass$2q((function e(t){_classCallCheck$2q(this,e),this.externalContext=t}),[{key:"handleTableStickers",value:function(){const e=this.externalContext.getStickerConfig(),t=[...getTableStickerProvider().getAllTableStickers().entries()].reduce(((e,[t,r])=>(e[t]=r,e)),{});this.tableStickers=Object.assign(Object.assign({},t),e)}},{key:"generator",value:function(e){!this.tableStickers&&this.handleTableStickers();const t=[];return Object.keys(this.tableStickers).forEach((r=>{const n=this.tableStickers[r],o=BI.isFunction(n)?n:n&&e.getCellStickerDict().get(r);o&&t.push(o.call(e))})),t}}]),ReportTableStickerProvider=_createClass$2q((function e(){_classCallCheck$2q(this,e),this.tableStickerDict=new Map}),[{key:"$get",value:function(){const e=this;return _createClass$2q((function e(){_classCallCheck$2q(this,e)}),[{key:"setSticker",value:function(t,r){e.tableStickerDict.set(t,r)}},{key:"getSticker",value:function(t){return e.tableStickerDict.get(t)}},{key:"getAllTableStickers",value:function(){return e.tableStickerDict}}])}},{key:"addSticker",value:function(e,t){this.tableStickerDict.set(e,t)}}]);function getTableStickerProvider(){return BI.Providers.getProvider(ReportTableStickerProvider.xtype)}ReportTableStickerProvider.xtype="report.table_sticker.provider",ReportTableStickerProvider=__decorate$1e([provider()],ReportTableStickerProvider),"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)});let Element$1=class e{constructor(e,t=""){"string"==typeof e?(this.el=document.createElement(e),this.el.className=t):this.el=e}on(e,t){return this.el.addEventListener(e,t),this}off(e,t){return this.el.removeEventListener(e,t),this}children(...t){return t.forEach((t=>{t instanceof e?this.el.appendChild(t.el):this.el.appendChild(t)})),this}unshiftChildren(...t){return t.forEach((t=>{t instanceof e?this.el.insertBefore(t.el,this.el.firstChild):this.el.insertBefore(t,this.el.firstChild)})),this}css(e,t){return void 0===t&&"string"==typeof e?this.el.style[e]:("number"==typeof e||"string"==typeof e?this.el.style[e]=t:Object.keys(e).forEach((t=>{this.el.style[t]=e[t]})),this)}offset(e){if(void 0===e){const{offsetTop:e,offsetLeft:t,offsetHeight:r,offsetWidth:n}=this.el;return{top:e,left:t,height:r-e,width:n-t}}return Object.keys(e).forEach((t=>{this.el.style[t]="".concat(e[t],"px")})),this}addClass(e){return new RegExp(e,"ig").test(this.el.className)||(this.el.className="".concat(this.el.className," ").concat(e)),this}removeClass(e){return new RegExp(e,"ig").test(this.el.className)&&(this.el.className=this.el.className.replace(e,"")),this}html(e){return void 0!==e?(this.el.innerHTML=e,this):this.el.innerHTML}text(e){return void 0!==e?(this.el.innerText=e,this):this.el.innerText}attr(e,t){return this.el.setAttribute(e,t),this}contains(e){return this.el.contains(e)}remove(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild)}hide(){return this.css("display","none"),this}show(){return this.css("display","block"),this}focus(){return this.el.focus(),this}disableChild(e){for(let t=0;t<this.el.childNodes.length;t++){const r=this.el.childNodes[t];r.className.includes(e)&&!r.className.includes("disable")&&(r.className="".concat(r.className," disable"))}}childEnable(e){for(let t=0;t<this.el.childNodes.length;t++){const r=this.el.childNodes[t];r.className.includes(e)&&(r.className=r.className.replace(" disable",""))}}hasChild(e){let t=!1;for(let r=0;r<this.el.childNodes.length;r++){const n=this.el.childNodes[r];if(t=e instanceof HTMLElement?n===e:n===e.el,t)break}return t}scroll({top:e,left:t}){this.el.scrollLeft=t,this.el.scrollTop=e}};const h$1=(e,t="")=>new Element$1(e,t),WidgetsMap={};function widget(e){return function(t){WidgetsMap[e]=t}}function createWidget(e){const{type:t="bi.label"}=e;return WidgetsMap[t]?new WidgetsMap[t](e):null}const NAMED_COLORS={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},HEX3=/^#([a-f0-9]{3})$/i,hex3=e=>{const t=e.match(HEX3);return!!t&&[parseInt(t[1][0]+t[1][0],16),parseInt(t[1][1]+t[1][1],16),parseInt(t[1][2]+t[1][2],16),null]},HEX6=/^#([a-f0-9]{6})$/i,hex6=e=>{const t=e.match(HEX6);return!!t&&[parseInt(t[1].substring(0,2),16),parseInt(t[1].substring(2,4),16),parseInt(t[1].substring(4,6),16),null]},RGB=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/,rgb=e=>{const t=e.match(RGB);return!!t&&[Number(t[1]),Number(t[2]),Number(t[3]),null]},RGBA=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/,rgba=e=>{const t=e.match(RGBA);return!!(t&&t.length>4)&&[Number(t[1]),Number(t[2]),Number(t[3]),Number(t[4])]},fromArray=e=>[Math.min(e[0],255),Math.min(e[1],255),Math.min(e[2],255),e.length>3?e[3]:null],namedColor=e=>{const t=NAMED_COLORS[e.toLowerCase()];return t||!1};class Color{constructor(e){const[t,r,n,o]=Array.isArray(e)?fromArray(e):hex3(e)||rgb(e)||rgba(e)||namedColor(e)||hex6(e)||[255,255,255,0];this.r=t,this.g=r,this.b=n,this.a=o}isTransparent(){return 0===this.a}toString(){return null!==this.a&&1!==this.a&&void 0!==this.a?"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.a,")"):"rgb(".concat(this.r,",").concat(this.g,",").concat(this.b,")")}}function dpr(){const e=window.screen;let t=1;return window.devicePixelRatio?t=window.devicePixelRatio:e.systemXDPI&&e.logicalXDPI&&(t=e.systemXDPI/e.logicalXDPI),t>1?Math.ceil(t):1}function px(e){return"".concat(~~"".concat(e),"px")}function setCtxFont(e,t){const{fontStyle:r="",fontWeight:n="",fontSize:o="",fontFamily:i=""}=t;e.font="".concat(r," ").concat(n," ").concat(o,' "Helvetica Neue"'),e.font="".concat(r," ").concat(n," ").concat(o,' "').concat(i,'"')}function measureTextByStyle(e,t){const r=document.createElement("canvas").getContext("2d",{alpha:!1});return setCtxFont(r,t),r.measureText(e)}function _parseMetrics(e){const t=document.createElement("div"),r=document.createElement("img"),n=document.createElement("span"),o=document.body;if(!o)throw new Error("");t.style.visibility="hidden",t.style.fontFamily=e.fontFamily,t.style.fontSize=e.fontSize,t.style.margin="0",t.style.padding="0",t.appendChild(document.createTextNode("Hidden Text")),o.appendChild(t),r.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",r.width=1,r.height=Math.round(parseFloat(e.fontSize)/10),r.style.margin="0",r.style.padding="0",r.style.verticalAlign="baseline",t.appendChild(n),t.appendChild(r);const i=Math.round(parseFloat(e.fontSize)/3)+r.height+1;t.style.lineHeight="normal",r.style.verticalAlign="super";const a=r.offsetTop-t.offsetTop+r.height+1;return o.removeChild(t),{baseline:i,middle:a}}new Color([0,0,0,0]);const mCache={};function getMetrics(e){const t="".concat(e.fontFamily," ").concat(e.fontSize);return void 0===mCache[t]&&(mCache[t]=_parseMetrics(e)),mCache[t]}function getBiasLines(e,t,r,n,o=!1,i){const a=[];if(!1===o){if(1===i&&a.push([[e,t],[e+r,t+n]]),2===i)a.push([[e,t],[e+r,t+2*n/3]]),a.push([[e,t],[e+2*r/3,t+n]]);else if(i>1){const o=Math.atan(n/r),s=Math.PI/2/(i+1);let l=0;for(let c=0;c<i;c++)l+=s,l<o?a.push([[e,t],[e+r,t+Math.ceil(Math.tan(l)*r)]]):a.push([[e,t],[e+Math.ceil(n*Math.tan(Math.PI/2-l)),t+n]])}}else if(1===i&&a.push([[e,t+n],[e+r,t]]),2===i)a.push([[e,t+n],[e+2*r/3,t]]),a.push([[e,t+n],[e+r,t+n/3]]);else if(i>1){const o=Math.atan(r/n),s=Math.PI/2/(i+1);let l=0;for(let c=0;c<i;c++)l+=s,l<o?a.push([[e,t+n],[e+Math.ceil(Math.tan(l)*n),t]]):a.push([[e,t+n],[e+r,t+n-Math.ceil(Math.tan(Math.PI/2-l)*r)]])}return a}function getSelection(){return window.getSelection?window.getSelection():document.getSelection?document.getSelection():document.selection}function transformCell2HTML(e){return""}var objectProto$g=Object.prototype;function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$g)}function overArg(e,t){return function(r){return e(t(r))}}var nativeKeys=overArg(Object.keys,Object),objectProto$f=Object.prototype,hasOwnProperty$d=objectProto$f.hasOwnProperty;function baseKeys(e){if(!isPrototype(e))return nativeKeys(e);var t=[];for(var r in Object(e))hasOwnProperty$d.call(e,r)&&"constructor"!=r&&t.push(r);return t}var freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root$1=freeGlobal||freeSelf||Function("return this")(),Symbol$1=root$1.Symbol,objectProto$e=Object.prototype,hasOwnProperty$c=objectProto$e.hasOwnProperty,nativeObjectToString$1=objectProto$e.toString,symToStringTag$1=Symbol$1?Symbol$1.toStringTag:void 0;function getRawTag(e){var t=hasOwnProperty$c.call(e,symToStringTag$1),r=e[symToStringTag$1];try{e[symToStringTag$1]=void 0;var n=!0}catch(e3){}var o=nativeObjectToString$1.call(e);return n&&(t?e[symToStringTag$1]=r:delete e[symToStringTag$1]),o}var objectProto$d=Object.prototype,nativeObjectToString=objectProto$d.toString;function objectToString(e){return nativeObjectToString.call(e)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$1?Symbol$1.toStringTag:void 0;function baseGetTag(e){return null==e?void 0===e?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(e)?getRawTag(e):objectToString(e)}function isObject$2(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$1(e){if(!isObject$2(e))return!1;var t=baseGetTag(e);return t==funcTag$2||t==genTag$1||t==asyncTag||t==proxyTag}var coreJsData=root$1["__core-js_shared__"],maskSrcKey=function(){var e=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var funcProto$1=Function.prototype,funcToString$1=funcProto$1.toString;function toSource(e){if(null!=e){try{return funcToString$1.call(e)}catch(e3){}try{return e+""}catch(e3){}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto=Function.prototype,objectProto$c=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$b=objectProto$c.hasOwnProperty,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty$b).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){return!(!isObject$2(e)||isMasked(e))&&(isFunction$1(e)?reIsNative:reIsHostCtor).test(toSource(e))}function getValue$1(e,t){return null==e?void 0:e[t]}function getNative(e,t){var r=getValue$1(e,t);return baseIsNative(r)?r:void 0}var DataView$1=getNative(root$1,"DataView"),Map$1=getNative(root$1,"Map"),Promise$1=getNative(root$1,"Promise"),Set$1=getNative(root$1,"Set"),WeakMap$1=getNative(root$1,"WeakMap"),mapTag$6="[object Map]",objectTag$3="[object Object]",promiseTag="[object Promise]",setTag$6="[object Set]",weakMapTag$2="[object WeakMap]",dataViewTag$4="[object DataView]",dataViewCtorString=toSource(DataView$1),mapCtorString=toSource(Map$1),promiseCtorString=toSource(Promise$1),setCtorString=toSource(Set$1),weakMapCtorString=toSource(WeakMap$1),getTag=baseGetTag;function isObjectLike(e){return null!=e&&"object"==typeof e}(DataView$1&&getTag(new DataView$1(new ArrayBuffer(1)))!=dataViewTag$4||Map$1&&getTag(new Map$1)!=mapTag$6||Promise$1&&getTag(Promise$1.resolve())!=promiseTag||Set$1&&getTag(new Set$1)!=setTag$6||WeakMap$1&&getTag(new WeakMap$1)!=weakMapTag$2)&&(getTag=function(e){var t=baseGetTag(e),r=t==objectTag$3?e.constructor:void 0,n=r?toSource(r):"";if(n)switch(n){case dataViewCtorString:return dataViewTag$4;case mapCtorString:return mapTag$6;case promiseCtorString:return promiseTag;case setCtorString:return setTag$6;case weakMapCtorString:return weakMapTag$2}return t});var argsTag$3="[object Arguments]";function baseIsArguments(e){return isObjectLike(e)&&baseGetTag(e)==argsTag$3}var objectProto$b=Object.prototype,hasOwnProperty$a=objectProto$b.hasOwnProperty,propertyIsEnumerable$1=objectProto$b.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike(e)&&hasOwnProperty$a.call(e,"callee")&&!propertyIsEnumerable$1.call(e,"callee")},isArray$1=Array.isArray,MAX_SAFE_INTEGER$1=9007199254740991;function isLength$1(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER$1}function isArrayLike(e){return null!=e&&isLength$1(e.length)&&!isFunction$1(e)}function stubFalse(){return!1}var freeExports$2="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$1=moduleExports$2?root$1.Buffer:void 0,nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:void 0,isBuffer$2=nativeIsBuffer||stubFalse,argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",funcTag$1="[object Function]",mapTag$5="[object Map]",numberTag$4="[object Number]",objectTag$2="[object Object]",regexpTag$3="[object RegExp]",setTag$5="[object Set]",stringTag$3="[object String]",weakMapTag$1="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$3="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(e){return isObjectLike(e)&&isLength$1(e.length)&&!!typedArrayTags[baseGetTag(e)]}function baseUnary(e){return function(t){return e(t)}}typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0,typedArrayTags[argsTag$2]=typedArrayTags[arrayTag$2]=typedArrayTags[arrayBufferTag$3]=typedArrayTags[boolTag$3]=typedArrayTags[dataViewTag$3]=typedArrayTags[dateTag$3]=typedArrayTags[errorTag$2]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$5]=typedArrayTags[numberTag$4]=typedArrayTags[objectTag$2]=typedArrayTags[regexpTag$3]=typedArrayTags[setTag$5]=typedArrayTags[stringTag$3]=typedArrayTags[weakMapTag$1]=!1;var freeExports$1="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal.process,nodeUtil=function(){try{var e=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return e||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e3){}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,mapTag$4="[object Map]",setTag$4="[object Set]",objectProto$a=Object.prototype,hasOwnProperty$9=objectProto$a.hasOwnProperty;function isEmpty(e){if(null==e)return!0;if(isArrayLike(e)&&(isArray$1(e)||"string"==typeof e||"function"==typeof e.splice||isBuffer$2(e)||isTypedArray(e)||isArguments(e)))return!e.length;var t=getTag(e);if(t==mapTag$4||t==setTag$4)return!e.size;if(isPrototype(e))return!baseKeys(e).length;for(var r in e)if(hasOwnProperty$9.call(e,r))return!1;return!0}function baseClamp(e,t,r){return e==e&&(void 0!==r&&(e=e<=r?e:r),void 0!==t&&(e=e>=t?e:t)),e}var symbolTag$3="[object Symbol]";function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&baseGetTag(e)==symbolTag$3}var NAN=NaN,reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber$2(e){if("number"==typeof e)return e;if(isSymbol(e))return NAN;if(isObject$2(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=isObject$2(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(reTrim,"");var r=reIsBinary.test(e);return r||reIsOctal.test(e)?freeParseInt(e.slice(2),r?2:8):reIsBadHex.test(e)?NAN:+e}function clamp(e,t,r){return void 0===r&&(r=t,t=void 0),void 0!==r&&(r=(r=toNumber$2(r))==r?r:0),void 0!==t&&(t=(t=toNumber$2(t))==t?t:0),baseClamp(toNumber$2(e),t,r)}function listCacheClear(){this.__data__=[],this.size=0}function eq(e,t){return e===t||e!=e&&t!=t}function assocIndexOf(e,t){for(var r=e.length;r--;)if(eq(e[r][0],t))return r;return-1}var arrayProto$1=Array.prototype,splice$1=arrayProto$1.splice;function listCacheDelete(e){var t=this.__data__,r=assocIndexOf(t,e);return!(r<0)&&(r==t.length-1?t.pop():splice$1.call(t,r,1),--this.size,!0)}function listCacheGet(e){var t=this.__data__,r=assocIndexOf(t,e);return r<0?void 0:t[r][1]}function listCacheHas(e){return assocIndexOf(this.__data__,e)>-1}function listCacheSet(e,t){var r=this.__data__,n=assocIndexOf(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}function ListCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function stackGet(e){return this.__data__.get(e)}function stackHas(e){return this.__data__.has(e)}ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet;var nativeCreate=getNative(Object,"create");function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$9=Object.prototype,hasOwnProperty$8=objectProto$9.hasOwnProperty;function hashGet(e){var t=this.__data__;if(nativeCreate){var r=t[e];return r===HASH_UNDEFINED$2?void 0:r}return hasOwnProperty$8.call(t,e)?t[e]:void 0}var objectProto$8=Object.prototype,hasOwnProperty$7=objectProto$8.hasOwnProperty;function hashHas(e){var t=this.__data__;return nativeCreate?void 0!==t[e]:hasOwnProperty$7.call(t,e)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=nativeCreate&&void 0===t?HASH_UNDEFINED$1:t,this}function Hash(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$1||ListCache),string:new Hash}}function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function getMapData(e,t){var r=e.__data__;return isKeyable(t)?r["string"==typeof t?"string":"hash"]:r.map}function mapCacheDelete(e){var t=getMapData(this,e).delete(e);return this.size-=t?1:0,t}function mapCacheGet(e){return getMapData(this,e).get(e)}function mapCacheHas(e){return getMapData(this,e).has(e)}function mapCacheSet(e,t){var r=getMapData(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}function MapCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet,MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet;var LARGE_ARRAY_SIZE=200;function stackSet(e,t){var r=this.__data__;if(r instanceof ListCache){var n=r.__data__;if(!Map$1||n.length<LARGE_ARRAY_SIZE-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new MapCache(n)}return r.set(e,t),this.size=r.size,this}function Stack(e){var t=this.__data__=new ListCache(e);this.size=t.size}Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;var defineProperty=function(){try{var e=getNative(Object,"defineProperty");return e({},"",{}),e}catch(e3){}}();function baseAssignValue$1(e,t,r){"__proto__"==t&&defineProperty?defineProperty(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer=moduleExports?root$1.Buffer:void 0,allocUnsafe=Buffer?Buffer.allocUnsafe:void 0;function cloneBuffer(e,t){if(t)return e.slice();var r=e.length,n=allocUnsafe?allocUnsafe(r):new e.constructor(r);return e.copy(n),n}var Uint8Array$1=root$1.Uint8Array;function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new Uint8Array$1(t).set(new Uint8Array$1(e)),t}function cloneTypedArray(e,t){var r=t?cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function copyArray(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var objectCreate=Object.create,baseCreate=function(){function e(){}return function(t){if(!isObject$2(t))return{};if(objectCreate)return objectCreate(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),getPrototype=overArg(Object.getPrototypeOf,Object);function initCloneObject(e){return"function"!=typeof e.constructor||isPrototype(e)?{}:baseCreate(getPrototype(e))}var objectProto$7=Object.prototype,hasOwnProperty$6=objectProto$7.hasOwnProperty;function assignValue(e,t,r){var n=e[t];hasOwnProperty$6.call(e,t)&&eq(n,r)&&(void 0!==r||t in e)||baseAssignValue$1(e,t,r)}function copyObject(e,t,r,n){var o=!r;r||(r={});for(var i=-1,a=t.length;++i<a;){var s=t[i],l=void 0;void 0===l&&(l=e[s]),o?baseAssignValue$1(r,s,l):assignValue(r,s,l)}return r}function baseTimes(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var MAX_SAFE_INTEGER=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var r=typeof e;return!!(t=null==t?MAX_SAFE_INTEGER:t)&&("number"==r||"symbol"!=r&&reIsUint.test(e))&&e>-1&&e%1==0&&e<t}var objectProto$6=Object.prototype,hasOwnProperty$5=objectProto$6.hasOwnProperty;function arrayLikeKeys(e,t){var r=isArray$1(e),n=!r&&isArguments(e),o=!r&&!n&&isBuffer$2(e),i=!r&&!n&&!o&&isTypedArray(e),a=r||n||o||i,s=a?baseTimes(e.length,String):[],l=s.length;for(var c in e)!t&&!hasOwnProperty$5.call(e,c)||a&&("length"==c||o&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||isIndex(c,l))||s.push(c);return s}function nativeKeysIn(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}var objectProto$5=Object.prototype,hasOwnProperty$4=objectProto$5.hasOwnProperty;function baseKeysIn(e){if(!isObject$2(e))return nativeKeysIn(e);var t=isPrototype(e),r=[];for(var n in e)("constructor"!=n||!t&&hasOwnProperty$4.call(e,n))&&r.push(n);return r}function keysIn$1(e){return isArrayLike(e)?arrayLikeKeys(e,!0):baseKeysIn(e)}function identity(e){return e}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(e){return this.__data__.set(e,HASH_UNDEFINED),this}function setCacheHas(e){return this.__data__.has(e)}function SetCache(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new MapCache;++t<r;)this.add(e[t])}function arraySome(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function cacheHas(e,t){return e.has(t)}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas;var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(e,t,r,n,o,i){var a=r&COMPARE_PARTIAL_FLAG$5,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=i.get(e);if(c&&i.get(t))return c==t;var u=-1,d=!0,h=r&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(i.set(e,t),i.set(t,e);++u<s;){var p=e[u],f=t[u];if(n)var g=a?n(f,p,u,t,e,i):n(p,f,u,e,t,i);if(void 0!==g){if(g)continue;d=!1;break}if(h){if(!arraySome(t,(function(e,t){if(!cacheHas(h,t)&&(p===e||o(p,e,r,n,i)))return h.push(t)}))){d=!1;break}}else if(p!==f&&!o(p,f,r,n,i)){d=!1;break}}return i.delete(e),i.delete(t),d}function mapToArray(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function setToArray(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag$2="[object Boolean]",dateTag$2="[object Date]",errorTag$1="[object Error]",mapTag$3="[object Map]",numberTag$3="[object Number]",regexpTag$2="[object RegExp]",setTag$3="[object Set]",stringTag$2="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",symbolProto$2=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf$1=symbolProto$2?symbolProto$2.valueOf:void 0;function equalByTag(e,t,r,n,o,i,a){switch(r){case dataViewTag$2:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case arrayBufferTag$2:return!(e.byteLength!=t.byteLength||!i(new Uint8Array$1(e),new Uint8Array$1(t)));case boolTag$2:case dateTag$2:case numberTag$3:return eq(+e,+t);case errorTag$1:return e.name==t.name&&e.message==t.message;case regexpTag$2:case stringTag$2:return e==t+"";case mapTag$3:var s=mapToArray;case setTag$3:var l=n&COMPARE_PARTIAL_FLAG$4;if(s||(s=setToArray),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;n|=COMPARE_UNORDERED_FLAG$2,a.set(e,t);var u=equalArrays(s(e),s(t),n,o,i,a);return a.delete(e),u;case symbolTag$2:if(symbolValueOf$1)return symbolValueOf$1.call(e)==symbolValueOf$1.call(t)}return!1}function arrayPush(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}function baseGetAllKeys(e,t,r){var n=t(e);return isArray$1(e)?n:arrayPush(n,r(e))}function arrayFilter(e,t){for(var r=-1,n=null==e?0:e.length,o=0,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[o++]=a)}return i}function stubArray(){return[]}var objectProto$4=Object.prototype,propertyIsEnumerable=objectProto$4.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(e){return null==e?[]:(e=Object(e),arrayFilter(nativeGetSymbols$1(e),(function(t){return propertyIsEnumerable.call(e,t)})))}:stubArray;function keys(e){return isArrayLike(e)?arrayLikeKeys(e):baseKeys(e)}function getAllKeys(e){return baseGetAllKeys(e,keys,getSymbols)}var COMPARE_PARTIAL_FLAG$3=1,objectProto$3=Object.prototype,hasOwnProperty$3=objectProto$3.hasOwnProperty;function equalObjects(e,t,r,n,o,i){var a=r&COMPARE_PARTIAL_FLAG$3,s=getAllKeys(e),l=s.length;if(l!=getAllKeys(t).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in t:hasOwnProperty$3.call(t,u)))return!1}var d=i.get(e);if(d&&i.get(t))return d==t;var h=!0;i.set(e,t),i.set(t,e);for(var p=a;++c<l;){var f=e[u=s[c]],g=t[u];if(n)var m=a?n(g,f,u,t,e,i):n(f,g,u,e,t,i);if(!(void 0===m?f===g||o(f,g,r,n,i):m)){h=!1;break}p||(p="constructor"==u)}if(h&&!p){var y=e.constructor,v=t.constructor;y==v||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof v&&v instanceof v||(h=!1)}return i.delete(e),i.delete(t),h}var COMPARE_PARTIAL_FLAG$2=1,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",objectTag$1="[object Object]",objectProto$2=Object.prototype,hasOwnProperty$2=objectProto$2.hasOwnProperty;function baseIsEqualDeep(e,t,r,n,o,i){var a=isArray$1(e),s=isArray$1(t),l=a?arrayTag$1:getTag(e),c=s?arrayTag$1:getTag(t),u=(l=l==argsTag$1?objectTag$1:l)==objectTag$1,d=(c=c==argsTag$1?objectTag$1:c)==objectTag$1,h=l==c;if(h&&isBuffer$2(e)){if(!isBuffer$2(t))return!1;a=!0,u=!1}if(h&&!u)return i||(i=new Stack),a||isTypedArray(e)?equalArrays(e,t,r,n,o,i):equalByTag(e,t,l,r,n,o,i);if(!(r&COMPARE_PARTIAL_FLAG$2)){var p=u&&hasOwnProperty$2.call(e,"__wrapped__"),f=d&&hasOwnProperty$2.call(t,"__wrapped__");if(p||f){var g=p?e.value():e,m=f?t.value():t;return i||(i=new Stack),o(g,m,r,n,i)}}return!!h&&(i||(i=new Stack),equalObjects(e,t,r,n,o,i))}function baseIsEqual(e,t,r,n,o){return e===t||(null==e||null==t||!isObjectLike(e)&&!isObjectLike(t)?e!=e&&t!=t:baseIsEqualDeep(e,t,r,n,baseIsEqual,o))}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(e,t,r,n){var o=r.length,i=o;if(null==e)return!i;for(e=Object(e);o--;){var a=r[o];if(a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++o<i;){var s=(a=r[o])[0],l=e[s],c=a[1];if(a[2]){if(void 0===l&&!(s in e))return!1}else{var u=new Stack;if(!baseIsEqual(c,l,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,n,u))return!1}}return!0}function isStrictComparable(e){return e==e&&!isObject$2(e)}function getMatchData(e){for(var t=keys(e),r=t.length;r--;){var n=t[r],o=e[n];t[r]=[n,o,isStrictComparable(o)]}return t}function matchesStrictComparable(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}function baseMatches(e){var t=getMatchData(e);return 1==t.length&&t[0][2]?matchesStrictComparable(t[0][0],t[0][1]):function(r){return r===e||baseIsMatch(r,e,t)}}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(e,t){if(isArray$1(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!isSymbol(e))||(reIsPlainProp.test(e)||!reIsDeepProp.test(e)||null!=t&&e in Object(t))}var FUNC_ERROR_TEXT$2="Expected a function";function memoize(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT$2);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(memoize.Cache||MapCache),r}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(e){var t=memoize(e,(function(e){return r.size===MAX_MEMOIZE_SIZE&&r.clear(),e})),r=t.cache;return t}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(rePropName,(function(e,r,n,o){t.push(n?o.replace(reEscapeChar,"$1"):r||e)})),t}));function arrayMap(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}var INFINITY$2=1/0,symbolProto$1=Symbol$1?Symbol$1.prototype:void 0,symbolToString=symbolProto$1?symbolProto$1.toString:void 0;function baseToString(e){if("string"==typeof e)return e;if(isArray$1(e))return arrayMap(e,baseToString)+"";if(isSymbol(e))return symbolToString?symbolToString.call(e):"";var t=e+"";return"0"==t&&1/e==-INFINITY$2?"-0":t}function toString$1(e){return null==e?"":baseToString(e)}function castPath(e,t){return isArray$1(e)?e:isKey(e,t)?[e]:stringToPath(toString$1(e))}var INFINITY$1=1/0;function toKey(e){if("string"==typeof e||isSymbol(e))return e;var t=e+"";return"0"==t&&1/e==-INFINITY$1?"-0":t}function baseGet(e,t){for(var r=0,n=(t=castPath(t,e)).length;null!=e&&r<n;)e=e[toKey(t[r++])];return r&&r==n?e:void 0}function get(e,t,r){var n=null==e?void 0:baseGet(e,t);return void 0===n?r:n}function baseHasIn(e,t){return null!=e&&t in Object(e)}function hasPath(e,t,r){for(var n=-1,o=(t=castPath(t,e)).length,i=!1;++n<o;){var a=toKey(t[n]);if(!(i=null!=e&&r(e,a)))break;e=e[a]}return i||++n!=o?i:!!(o=null==e?0:e.length)&&isLength$1(o)&&isIndex(a,o)&&(isArray$1(e)||isArguments(e))}function hasIn(e,t){return null!=e&&hasPath(e,t,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(e,t){return isKey(e)&&isStrictComparable(t)?matchesStrictComparable(toKey(e),t):function(r){var n=get(r,e);return void 0===n&&n===t?hasIn(r,e):baseIsEqual(t,n,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(e){return function(t){return null==t?void 0:t[e]}}function basePropertyDeep(e){return function(t){return baseGet(t,e)}}function property(e){return isKey(e)?baseProperty(toKey(e)):basePropertyDeep(e)}function baseIteratee$2(e){return"function"==typeof e?e:null==e?identity:"object"==typeof e?isArray$1(e)?baseMatchesProperty(e[0],e[1]):baseMatches(e):property(e)}function createFind(e){return function(t,r,n){var o=Object(t);if(!isArrayLike(t)){var i=baseIteratee$2(r);t=keys(t),r=function(e){return i(o[e],e,o)}}var a=e(t,r,n);return a>-1?o[i?t[a]:a]:void 0}}function baseFindIndex(e,t,r,n){for(var o=e.length,i=r+-1;++i<o;)if(t(e[i],i,e))return i;return-1}var INFINITY=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(e){return e?(e=toNumber$2(e))===INFINITY||e===-INFINITY?(e<0?-1:1)*MAX_INTEGER:e==e?e:0:0===e?e:0}function toInteger$1(e){var t=toFinite(e),r=t%1;return t==t?r?t-r:t:0}var nativeMax$2=Math.max;function findIndex(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var o=null==r?0:toInteger$1(r);return o<0&&(o=nativeMax$2(n+o,0)),baseFindIndex(e,baseIteratee$2(t),o)}var find=createFind(findIndex);function isEqual(e,t){return baseIsEqual(e,t)}function last(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}function baseSlice(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(o);++n<o;)i[n]=e[n+t];return i}function parent(e,t){return t.length<2?e:baseGet(e,baseSlice(t,0,-1))}function baseUnset(e,t){return null==(e=parent(e,t=castPath(t,e)))||delete e[toKey(last(t))]}var arrayProto=Array.prototype,splice=arrayProto.splice;function basePullAt(e,t){for(var r=e?t.length:0,n=r-1;r--;){var o=t[r];if(r==n||o!==i){var i=o;isIndex(o)?splice.call(e,o,1):baseUnset(e,o)}}return e}function remove(e,t){var r=[];if(!e||!e.length)return r;var n=-1,o=[],i=e.length;for(t=baseIteratee$2(t);++n<i;){var a=e[n];t(a,n,e)&&(r.push(a),o.push(n))}return basePullAt(e,o),r}function arrayEach(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}function baseAssign(e,t){return e&&copyObject(t,keys(t),e)}function baseAssignIn(e,t){return e&&copyObject(t,keysIn$1(t),e)}function copySymbols(e,t){return copyObject(e,getSymbols(e),t)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(e){for(var t=[];e;)arrayPush(t,getSymbols(e)),e=getPrototype(e);return t}:stubArray;function copySymbolsIn(e,t){return copyObject(e,getSymbolsIn(e),t)}function getAllKeysIn(e){return baseGetAllKeys(e,keysIn$1,getSymbolsIn)}var objectProto$1=Object.prototype,hasOwnProperty$1=objectProto$1.hasOwnProperty;function initCloneArray(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&hasOwnProperty$1.call(e,"index")&&(r.index=e.index,r.input=e.input),r}function cloneDataView(e,t){var r=t?cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var reFlags=/\w*$/;function cloneRegExp(e){var t=new e.constructor(e.source,reFlags.exec(e));return t.lastIndex=e.lastIndex,t}var symbolProto=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function cloneSymbol(e){return symbolValueOf?Object(symbolValueOf.call(e)):{}}var boolTag$1="[object Boolean]",dateTag$1="[object Date]",mapTag$2="[object Map]",numberTag$2="[object Number]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(e,t,r){var n=e.constructor;switch(t){case arrayBufferTag$1:return cloneArrayBuffer(e);case boolTag$1:case dateTag$1:return new n(+e);case dataViewTag$1:return cloneDataView(e,r);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(e,r);case mapTag$2:return new n;case numberTag$2:case stringTag$1:return new n(e);case regexpTag$1:return cloneRegExp(e);case setTag$2:return new n;case symbolTag$1:return cloneSymbol(e)}}var mapTag$1="[object Map]";function baseIsMap(e){return isObjectLike(e)&&getTag(e)==mapTag$1}var nodeIsMap=nodeUtil&&nodeUtil.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap,setTag$1="[object Set]";function baseIsSet(e){return isObjectLike(e)&&getTag(e)==setTag$1}var nodeIsSet=nodeUtil&&nodeUtil.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet,CLONE_DEEP_FLAG$1=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$1=4,argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",numberTag$1="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};function baseClone(e,t,r,n,o,i){var a,s=t&CLONE_DEEP_FLAG$1,l=t&CLONE_FLAT_FLAG,c=t&CLONE_SYMBOLS_FLAG$1;if(void 0!==a)return a;if(!isObject$2(e))return e;var u=isArray$1(e);if(u){if(a=initCloneArray(e),!s)return copyArray(e,a)}else{var d=getTag(e),h=d==funcTag||d==genTag;if(isBuffer$2(e))return cloneBuffer(e,s);if(d==objectTag||d==argsTag||h&&!o){if(a=l||h?{}:initCloneObject(e),!s)return l?copySymbolsIn(e,baseAssignIn(a,e)):copySymbols(e,baseAssign(a,e))}else{if(!cloneableTags[d])return o?e:{};a=initCloneByTag(e,d,s)}}i||(i=new Stack);var p=i.get(e);if(p)return p;if(i.set(e,a),isSet(e))return e.forEach((function(n){a.add(baseClone(n,t,r,n,e,i))})),a;if(isMap(e))return e.forEach((function(n,o){a.set(o,baseClone(n,t,r,o,e,i))})),a;var f=c?l?getAllKeysIn:getAllKeys:l?keysIn:keys,g=u?void 0:f(e);return arrayEach(g||e,(function(n,o){g&&(n=e[o=n]),assignValue(a,o,baseClone(n,t,r,o,e,i))})),a}cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[dataViewTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag]=cloneableTags[numberTag$1]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[setTag]=cloneableTags[stringTag]=cloneableTags[symbolTag]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;var CLONE_DEEP_FLAG=1,CLONE_SYMBOLS_FLAG=4;function cloneDeep(e){return baseClone(e,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG)}var rngBrowser={exports:{}},getRandomValues="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(getRandomValues){var rnds8=new Uint8Array(16);rngBrowser.exports=function(){return getRandomValues(rnds8),rnds8}}else{var rnds=new Array(16);rngBrowser.exports=function(){for(var e,t=0;t<16;t++)3&t||(e=4294967296*Math.random()),rnds[t]=e>>>((3&t)<<3)&255;return rnds}}for(var rngBrowserExports=rngBrowser.exports,byteToHex=[],i$1=0;i$1<256;++i$1)byteToHex[i$1]=(i$1+256).toString(16).substr(1);function bytesToUuid$1(e,t){var r=t||0,n=byteToHex;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}var bytesToUuid_1=bytesToUuid$1,rng=rngBrowserExports,bytesToUuid=bytesToUuid_1;function v4(e,t,r){var n=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||rng)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var i=0;i<16;++i)t[n+i]=o[i];return t||bytesToUuid(o)}var v4_1=v4;const uuid=getDefaultExportFromCjs$1(v4_1);var now=function(){return root$1.Date.now()},FUNC_ERROR_TEXT$1="Expected a function",nativeMax$1=Math.max,nativeMin$1=Math.min;function debounce(e,t,r){var n,o,i,a,s,l,c=0,u=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$1);function p(t){var r=n,i=o;return n=o=void 0,c=t,a=e.apply(i,r)}function f(e){var r=e-l;return void 0===l||r>=t||r<0||d&&e-c>=i}function g(){var e=now();if(f(e))return m(e);s=setTimeout(g,function(e){var r=t-(e-l);return d?nativeMin$1(r,i-(e-c)):r}(e))}function m(e){return s=void 0,h&&n?p(e):(n=o=void 0,a)}function y(){var e=now(),r=f(e);if(n=arguments,o=this,l=e,r){if(void 0===s)return function(e){return c=e,s=setTimeout(g,t),u?p(e):a}(l);if(d)return s=setTimeout(g,t),p(l)}return void 0===s&&(s=setTimeout(g,t)),a}return t=toNumber$2(t)||0,isObject$2(r)&&(u=!!r.leading,i=(d="maxWait"in r)?nativeMax$1(toNumber$2(r.maxWait)||0,t):i,h="trailing"in r?!!r.trailing:h),y.cancel=function(){void 0!==s&&clearTimeout(s),c=0,n=l=o=s=void 0},y.flush=function(){return void 0===s?a:m(now())},y}var nativeMax=Math.max,nativeMin=Math.min;function baseInRange(e,t,r){return e>=nativeMin(t,r)&&e<nativeMax(t,r)}function inRange(e,t,r){return t=toFinite(t),void 0===r?(r=t,t=0):r=toFinite(r),baseInRange(e=toNumber$2(e),t,r)}var numberTag="[object Number]";function isNumber$1(e){return"number"==typeof e||isObjectLike(e)&&baseGetTag(e)==numberTag}function isNil(e){return null==e}function intersectRect(e,t){return!(t[0][1]>e[1][1]||t[1][1]<e[0][1]||t[0][0]>e[1][0]||t[1][0]<e[0][0])}const emptyFn=()=>{};function cArray(e=0,t=0){return Array.from(new Array(t-e),((t,r)=>r+e))}function xTo26(e){return parseInt("".concat(e),10).toString(26).split("").reduce(((e,t)=>e+String.fromCharCode(parseInt(parseInt(t,26).toString(10),10)+65)),"")}function mergeRange(e,t){return intersectRect(e,t)?[[Math.min(e[0][0],t[0][0]),Math.min(e[0][1],t[0][1])],[Math.max(e[1][0],t[1][0]),Math.max(e[1][1],t[1][1])]]:e}function divide(e){if(e.length<=1)return[e];const t=e.replace(new RegExp(/(\r\n|\\n|\r)/g),"\n").split("\n"),r=[];return t.forEach((e=>{for(;e.length>0;){const t=e.substring(0,1);if(/[\d|A-Za-z|_]/.test(t)){const t=e.replace(/^([\d|A-Za-z|_]+).*$/,"$1");e=e.replace(t,""),r.push(t)}else r.push(t),e=e.length>0?e.substring(1,e.length):""}r.push("\n")})),r.pop(),r}function divideTextByWrapInfo(e,t){const r=[],n=t.map(((r,n)=>e.substring(0===n?0:t[n-1],r)));return n.push(e.substring(t[t.length-1])),n.forEach((e=>{e.split("/n").forEach((e=>{r.push(e)}))})),r}function between(e,t,r){return e>=t&&e<=r||e>=r&&e<=t}function getIEVersion(){let e=0;const t=navigator.userAgent.toLowerCase(),r=t.match(/(?:msie\s([\w.]+))/),n=t.match(/(?:trident.*rv:([\w.]+))/);return e=r&&n&&r[1]&&n[1]?Math.max(1*parseInt(r[1],10),1*parseInt(n[1],10)):r&&r[1]?1*parseInt(r[1],10):n&&n[1]?1*~~n[1]:0,e}function isIE(){return/(msie|trident)/i.test(navigator.userAgent.toLowerCase())}function isPointInMatrix(e,t){return e.x>=t.x&&e.x<=t.x+t.width&&e.y<=t.y+t.height&&e.y>=t.y}function isPointOnLine(e,t,r,n,o,i){return(o-e)*(n-t)==(r-e)*(i-t)&&Math.min(e,r)<=o&&o<=Math.max(e,r)&&Math.min(t,n)<=i&&i<=Math.max(t,n)}function bind$3(e,t,r){e.addEventListener(t,r)}function unbind$1(e,t,r){e.removeEventListener(t,r)}function unbindClickoutside(e){e.xclickoutside&&(unbind$1(window.document.body,"mousedown",e.xclickoutside),delete e.xclickoutside)}function bindClickoutside(e,t=e=>{e.hide()},r=!0){e.xclickoutside=n=>{2===n.detail||e.contains(n.target)||(t(e),r&&unbindClickoutside(e))},bind$3(window.document.body,"mousedown",e.xclickoutside)}function unbindMouseWhell(e){e.mouseWhell&&(unbind$1(window.document.body,"mousewheel",e.mouseWhell),delete e.mouseWhell)}function bindMouseWhell(e,t=e=>{e.hide()}){e.mouseWhell=()=>{t(e)},bind$3(window.document.body,"mousewheel",e.mouseWhell)}function blockContextMenu(e){e.addEventListener("contextmenu",(e=>e.preventDefault()))}var isColor$2={exports:{}},rgbRegex$1=function(e){return(e=e||{}).exact?/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/:/rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)/gi},rgbaRegex$1=function(e){return(e=e||{}).exact?/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d*(?:\.\d+)?)\)$/:/rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d*(?:\.\d+)?)\)/gi},hslRegex$1=function(e){return(e=e||{}).exact?/^hsl\(\s*(\d+)\s*,\s*(\d*(?:\.\d+)?%)\s*,\s*(\d*(?:\.\d+)?%)\)$/:/hsl\(\s*(\d+)\s*,\s*(\d*(?:\.\d+)?%)\s*,\s*(\d*(?:\.\d+)?%)\)/gi},hslaRegex$1=function(e){return(e=e||{}).exact?/^hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*(\d*(?:\.\d+)?)\)$/:/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*(\d*(?:\.\d+)?)\)/gi},hexColorRegex=function(e){return(e=e&&"object"==typeof e?e:{}).strict?/^#([a-f0-9]{3,4}|[a-f0-9]{4}(?:[a-f0-9]{2}){1,2})\b$/i:/#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})\b/gi};const aliceblue="#f0f8ff",antiquewhite="#faebd7",aqua="#00ffff",aquamarine="#7fffd4",azure="#f0ffff",beige="#f5f5dc",bisque="#ffe4c4",black="#000000",blanchedalmond="#ffebcd",blue="#0000ff",blueviolet="#8a2be2",brown="#a52a2a",burlywood="#deb887",cadetblue="#5f9ea0",chartreuse="#7fff00",chocolate="#d2691e",coral="#ff7f50",cornflowerblue="#6495ed",cornsilk="#fff8dc",crimson="#dc143c",cyan="#00ffff",darkblue="#00008b",darkcyan="#008b8b",darkgoldenrod="#b8860b",darkgray="#a9a9a9",darkgreen="#006400",darkgrey="#a9a9a9",darkkhaki="#bdb76b",darkmagenta="#8b008b",darkolivegreen="#556b2f",darkorange="#ff8c00",darkorchid="#9932cc",darkred="#8b0000",darksalmon="#e9967a",darkseagreen="#8fbc8f",darkslateblue="#483d8b",darkslategray="#2f4f4f",darkslategrey="#2f4f4f",darkturquoise="#00ced1",darkviolet="#9400d3",deeppink="#ff1493",deepskyblue="#00bfff",dimgray="#696969",dimgrey="#696969",dodgerblue="#1e90ff",firebrick="#b22222",floralwhite="#fffaf0",forestgreen="#228b22",fuchsia="#ff00ff",gainsboro="#dcdcdc",ghostwhite="#f8f8ff",gold="#ffd700",goldenrod="#daa520",gray="#808080",green="#008000",greenyellow="#adff2f",grey="#808080",honeydew="#f0fff0",hotpink="#ff69b4",indianred="#cd5c5c",indigo="#4b0082",ivory="#fffff0",khaki="#f0e68c",lavender="#e6e6fa",lavenderblush="#fff0f5",lawngreen="#7cfc00",lemonchiffon="#fffacd",lightblue="#add8e6",lightcoral="#f08080",lightcyan="#e0ffff",lightgoldenrodyellow="#fafad2",lightgray="#d3d3d3",lightgreen="#90ee90",lightgrey="#d3d3d3",lightpink="#ffb6c1",lightsalmon="#ffa07a",lightseagreen="#20b2aa",lightskyblue="#87cefa",lightslategray="#778899",lightslategrey="#778899",lightsteelblue="#b0c4de",lightyellow="#ffffe0",lime="#00ff00",limegreen="#32cd32",linen="#faf0e6",magenta="#ff00ff",maroon="#800000",mediumaquamarine="#66cdaa",mediumblue="#0000cd",mediumorchid="#ba55d3",mediumpurple="#9370db",mediumseagreen="#3cb371",mediumslateblue="#7b68ee",mediumspringgreen="#00fa9a",mediumturquoise="#48d1cc",mediumvioletred="#c71585",midnightblue="#191970",mintcream="#f5fffa",mistyrose="#ffe4e1",moccasin="#ffe4b5",navajowhite="#ffdead",navy="#000080",oldlace="#fdf5e6",olive="#808000",olivedrab="#6b8e23",orange="#ffa500",orangered="#ff4500",orchid="#da70d6",palegoldenrod="#eee8aa",palegreen="#98fb98",paleturquoise="#afeeee",palevioletred="#db7093",papayawhip="#ffefd5",peachpuff="#ffdab9",peru="#cd853f",pink="#ffc0cb",plum="#dda0dd",powderblue="#b0e0e6",purple="#800080",rebeccapurple="#663399",red="#ff0000",rosybrown="#bc8f8f",royalblue="#4169e1",saddlebrown="#8b4513",salmon="#fa8072",sandybrown="#f4a460",seagreen="#2e8b57",seashell="#fff5ee",sienna="#a0522d",silver="#c0c0c0",skyblue="#87ceeb",slateblue="#6a5acd",slategray="#708090",slategrey="#708090",snow="#fffafa",springgreen="#00ff7f",steelblue="#4682b4",tan="#d2b48c",teal="#008080",thistle="#d8bfd8",tomato="#ff6347",turquoise="#40e0d0",violet="#ee82ee",wheat="#f5deb3",white="#ffffff",whitesmoke="#f5f5f5",yellow="#ffff00",yellowgreen="#9acd32",require$$5={aliceblue:aliceblue,antiquewhite:antiquewhite,aqua:aqua,aquamarine:aquamarine,azure:azure,beige:beige,bisque:bisque,black:black,blanchedalmond:blanchedalmond,blue:blue,blueviolet:blueviolet,brown:brown,burlywood:burlywood,cadetblue:cadetblue,chartreuse:chartreuse,chocolate:chocolate,coral:coral,cornflowerblue:cornflowerblue,cornsilk:cornsilk,crimson:crimson,cyan:cyan,darkblue:darkblue,darkcyan:darkcyan,darkgoldenrod:darkgoldenrod,darkgray:darkgray,darkgreen:darkgreen,darkgrey:darkgrey,darkkhaki:darkkhaki,darkmagenta:darkmagenta,darkolivegreen:darkolivegreen,darkorange:darkorange,darkorchid:darkorchid,darkred:darkred,darksalmon:darksalmon,darkseagreen:darkseagreen,darkslateblue:darkslateblue,darkslategray:darkslategray,darkslategrey:darkslategrey,darkturquoise:darkturquoise,darkviolet:darkviolet,deeppink:deeppink,deepskyblue:deepskyblue,dimgray:dimgray,dimgrey:dimgrey,dodgerblue:dodgerblue,firebrick:firebrick,floralwhite:floralwhite,forestgreen:forestgreen,fuchsia:fuchsia,gainsboro:gainsboro,ghostwhite:ghostwhite,gold:gold,goldenrod:goldenrod,gray:gray,green:green,greenyellow:greenyellow,grey:grey,honeydew:honeydew,hotpink:hotpink,indianred:indianred,indigo:indigo,ivory:ivory,khaki:khaki,lavender:lavender,lavenderblush:lavenderblush,lawngreen:lawngreen,lemonchiffon:lemonchiffon,lightblue:lightblue,lightcoral:lightcoral,lightcyan:lightcyan,lightgoldenrodyellow:lightgoldenrodyellow,lightgray:lightgray,lightgreen:lightgreen,lightgrey:lightgrey,lightpink:lightpink,lightsalmon:lightsalmon,lightseagreen:lightseagreen,lightskyblue:lightskyblue,lightslategray:lightslategray,lightslategrey:lightslategrey,lightsteelblue:lightsteelblue,lightyellow:lightyellow,lime:lime,limegreen:limegreen,linen:linen,magenta:magenta,maroon:maroon,mediumaquamarine:mediumaquamarine,mediumblue:mediumblue,mediumorchid:mediumorchid,mediumpurple:mediumpurple,mediumseagreen:mediumseagreen,mediumslateblue:mediumslateblue,mediumspringgreen:mediumspringgreen,mediumturquoise:mediumturquoise,mediumvioletred:mediumvioletred,midnightblue:midnightblue,mintcream:mintcream,mistyrose:mistyrose,moccasin:moccasin,navajowhite:navajowhite,navy:navy,oldlace:oldlace,olive:olive,olivedrab:olivedrab,orange:orange,orangered:orangered,orchid:orchid,palegoldenrod:palegoldenrod,palegreen:palegreen,paleturquoise:paleturquoise,palevioletred:palevioletred,papayawhip:papayawhip,peachpuff:peachpuff,peru:peru,pink:pink,plum:plum,powderblue:powderblue,purple:purple,rebeccapurple:rebeccapurple,red:red,rosybrown:rosybrown,royalblue:royalblue,saddlebrown:saddlebrown,salmon:salmon,sandybrown:sandybrown,seagreen:seagreen,seashell:seashell,sienna:sienna,silver:silver,skyblue:skyblue,slateblue:slateblue,slategray:slategray,slategrey:slategrey,snow:snow,springgreen:springgreen,steelblue:steelblue,tan:tan,teal:teal,thistle:thistle,tomato:tomato,turquoise:turquoise,violet:violet,wheat:wheat,white:white,whitesmoke:whitesmoke,yellow:yellow,yellowgreen:yellowgreen},rgbRegex=rgbRegex$1,rgbaRegex=rgbaRegex$1,hslRegex=hslRegex$1,hslaRegex=hslaRegex$1,hexRegex$1=hexColorRegex,keywords=require$$5,isRgb=function(e){return rgbRegex({exact:!0}).test(e)},isRgba=function(e){return rgbaRegex({exact:!0}).test(e)},isHsl=function(e){return hslRegex({exact:!0}).test(e)},isHsla=function(e){return hslaRegex({exact:!0}).test(e)},isHex=function(e){return hexRegex$1({exact:!0}).test(e)},isKeyword=function(e){return keywords.hasOwnProperty(e)},isInherit=function(e){return"inherit"===e},isCurrentColor=function(e){return"currentColor"===e||"currentcolor"===e},isTransparent=function(e){return"transparent"===e},isColor=function(e){return isRgb(e)||isRgba(e)||isHsl(e)||isHsla(e)||isHex(e)||isKeyword(e)||isInherit(e)||isCurrentColor(e)||isTransparent(e)};isColor$2.exports=isColor,isColor$2.exports.isRgb=isRgb,isColor$2.exports.isRgba=isRgba,isColor$2.exports.isHsl=isHsl,isColor$2.exports.isHsla=isHsla,isColor$2.exports.isHex=isHex,isColor$2.exports.isKeyword=isKeyword,isColor$2.exports.isInherit=isInherit,isColor$2.exports.isCurrentColor=isCurrentColor,isColor$2.exports.isTransparent=isTransparent;var isColorExports=isColor$2.exports;const isColor$1=getDefaultExportFromCjs$1(isColorExports);var isBorderStyle=function(e){return/^(none|hidden|dotted|dashed|solid|double|groove|ridge|inset|outset)$/i.test(e)};const isBorderStyle$1=getDefaultExportFromCjs$1(isBorderStyle);function isLength(e){return/^(\+|-)?([0-9]*\.)?[0-9]+(em|ex|ch|rem|vh|vw|vmin|vmax|px|mm|cm|in|pt|pc|%)$/i.test(e)||/^(\+|-)?(0*\.)?0+$/.test(e)}function parseBorder(e){const t={style:"none",color:"#000000",width:0};return e.split(" ").forEach((e=>{isColor$1(e)&&(t.color=e),isLength(e)&&(t.width=parseFloat(e)),isBorderStyle$1(e)&&(t.style=e)})),t}function getFitGradient(e,t,r){e=e*Math.PI/180;const n=Math.sqrt(t*t+r*r),o=Math.atan(t/r),i=Math.cos(o-e)*n/2,a=Math.sin(e)*i,s=Math.cos(e)*i;return[[t/2-a,r/2-s],[t/2+a,r/2+s]]}const imageCache=new Map,loadingCache=new Map;function loadImage(e){const t=imageCache.get(e);if(t)return new Promise((e=>{e(t)}));const r=loadingCache.get(e)||new Promise(((t,r)=>{const n=new Image;n.src=e,n.onload=()=>{imageCache.set(e,n),t(n)},n.onerror=e=>{r(e)}}));return loadingCache.set(e,r),r}function getImageData(e){return imageCache.get(e)}var __decorate$1d=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};function digestStyle(e){const{x:t=0,y:r=0,top:n,left:o,width:i,height:a,style:s={},autoWrapInfo:l}=e,{backgroundSize:c,backgroundImage:u,backgroundColor:d="",color:h="",textAlign:p,fontWeight:f="normal",fontFamily:g="SimSun",fontSize:m="9pt",fontStyle:y="normal",verticalAlign:v,border:_="",borderTop:b="",borderBottom:C="",borderLeft:E="",borderRight:T="",rotate:S,textShadow:P,underline:w,strikeThrough:x,lineHeight:O,subscript:$,supscript:I,newLine:R,verticalText:A,verTextDirection:D,cellJust:L}=s,N={};if(N.top=n||r,N.left=o||t,N.width=i,N.height=a,N.color=new Color(h),N.textAlign=p,N.verticalAlign=v,N.fontWeight=f,N.fontSize=m,N.fontFamily=g,N.fontStyle=y,N.textShadow=P,N.underline=w,N.strikeThrough=x,N.lineHeight=O,N.subscript=$,N.supscript=I,N.backgroundColor=new Color(d),N.backgroundImage=u,N.backgroundSize=c,_){const{width:e,style:t,color:r}=parseBorder(_);N.borderLeftWidth=N.borderTopWidth=N.borderBottomWidth=N.borderRightWidth=e,N.borderLeftStyle=N.borderTopStyle=N.borderBottomStyle=N.borderRightStyle=t,N.borderLeftColor=N.borderTopColor=N.borderBottomColor=N.borderRightColor=new Color(r)}if(b){const{width:e,color:t,style:r}=parseBorder(b);N.borderTopWidth=e,N.borderTopStyle=r,N.borderTopColor=new Color(t)}if(C){const{width:e,color:t,style:r}=parseBorder(C);N.borderBottomWidth=e,N.borderBottomStyle=r,N.borderBottomColor=new Color(t)}if(E){const{width:e,color:t,style:r}=parseBorder(E);N.borderLeftWidth=e,N.borderLeftStyle=r,N.borderLeftColor=new Color(t)}if(T){const{width:e,color:t,style:r}=parseBorder(T);N.borderRightWidth=e,N.borderRightStyle=r,N.borderRightColor=new Color(t)}return N.rotate=S,N.newLine=R,N.verticalText=A,N.verTextDirection=D,N.cellJust=L,N.autoWrapInfo=l&&JSON.parse("".concat(l)),N}let AbstractWidget=(()=>{let e=class{constructor(e){this.mouseDownHandler=(e,t,r,n)=>{this.props.listeners&&this.props.listeners.forEach((o=>{var i;"CELL_MOUSE_DOWN"===o.eventName&&(null===(i=o.action)||void 0===i||i.call(this,e,t,r,n))}))},this.mouseLeaveHandler=(e,t,r,n)=>{this.props.listeners&&this.props.listeners.forEach((o=>{var i;"CELL_MOUSE_LEAVE"===o.eventName&&(null===(i=o.action)||void 0===i||i.call(this,e,t,r,n))}))},this.clickHandler=(e,t,r,n)=>{let o=!1;return this.props.listeners&&this.props.listeners.forEach((i=>{var a;"CELL_CLICK"===i.eventName&&(o=null===(a=i.action)||void 0===a?void 0:a.call(this,e,t,r,n))})),o},this.hoverHandler=(e,t,r,n)=>{this.props.listeners&&this.props.listeners.forEach((o=>{var i;"CELL_HOVER"===o.eventName&&(null===(i=o.action)||void 0===i||i.call(this,e,t,r,n))}))},this.dbClickHandler=(e,t,r,n)=>{this.props.listeners&&this.props.listeners.forEach((o=>{var i;"CELL_DOUBLE_CLICK"===o.eventName&&(null===(i=o.action)||void 0===i||i.call(this,e,t,r,n))}))},this.props=e;const{x:t=0,y:r=0,width:n,height:o,top:i,left:a}=e;this.width=n,this.height=o,this.top=i||r,this.left=a||t,this.style=digestStyle(e)}getBounds(){return{left:this.left,top:this.top,right:this.left+this.width,bottom:this.top+this.height,width:this.width,height:this.height}}getChildren(){}getStyle(){return this.style}getText(){}getRealWidth(){return this.width}};return e=__decorate$1d([widget("bi.widget")],e),e})();var __decorate$1c=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};(()=>{let e=class extends AbstractWidget{constructor(e){super(e);const{text:t}=e;this.text=t}getText(){return this.text}getRealWidth(){return measureTextByStyle(this.getText()||"",this.style).width}};e=__decorate$1c([widget("bi.label")],e)})();var __decorate$1b=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};(()=>{let e=class extends AbstractWidget{constructor(e){super(e)}getChildren(){return[createWidget({type:"bi.widget",width:5,height:8,left:this.left,top:this.top,style:{rotate:"45",borderBottom:"2px solid #000",borderRight:"2px solid #000"}})]}};e=__decorate$1b([widget("bi.checkbox")],e)})();class Layout extends AbstractWidget{getChildren(){return this.children}getRealWidth(){return this.getChildren().reduce(((e,t)=>t.getRealWidth()+e),0)}}var __decorate$1a=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};(()=>{let e=class extends Layout{constructor(e){super(e),this.clickHandler=(e,t,r,n)=>{for(let o=0;o<this.children.length;o++){const i=this.children[o].getBounds();if(i.left<=t&&i.right>t)return this.children[o].clickHandler.call(null,e,t,r,n)}return!0},this.items=e.items||[],this.children=[],this.digest()}digest(){const e=this.getBounds();let t=0;const r=e.width-this.items.reduce(((e,t)=>e+(parseFloat(t.width)||0)),0);this.children=this.items.map((n=>{const o=n.el;return o.top=e.top,o.left=e.left+t,n.width?o.width=n.width:o.width=r,o.height=e.height,t+=o.width,createWidget(o)}))}};e=__decorate$1a([widget("bi.htape")],e)})();var __decorate$19=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let Absolute=(()=>{let e=class extends Layout{constructor(e){super(e),this.clickHandler=(e,t,r,n,o)=>{let i=!1;for(let a=0;a<this.children.length;a++){const i=this.children[a].getBounds(),{x:s}=o||{x:t};if(i.left<=s&&i.right>s)return this.children[a].clickHandler.call(null,e,t,r,n)}return this.props.listeners&&this.props.listeners.forEach((o=>{"CELL_CLICK"===o.eventName&&(i=o.action.call(this,e,t,r,n))})),i},this.items=e.items||[],this.children=[],this.digest()}digest(){const e=this.getBounds();this.children=this.items.map((t=>{const r=t.el;return r.top=e.top+(t.top||0),r.left=e.left+(t.left||0),r.right=e.right-(t.right||0),r.bottom=e.bottom-(t.bottom||0),"bi.label"===r.type?(r.width=r.right-r.left,r.height=r.bottom-r.top):(r.width=e.width,r.height=e.height),createWidget(r)}))}};return e=__decorate$19([widget("bi.absolute")],e),e})();var __decorate$18=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__rest$j=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};(()=>{let e=class extends AbstractWidget{constructor(e){super(e);const t=e.icon||{},{width:r,height:n,size:o=16,backgroundColor:i,top:a,left:s}=t,l=__rest$j(t,["width","height","size","backgroundColor","top","left"]);this.iconStyle=Object.assign({width:r||o,height:n||o,size:o,backgroundColor:i||"",top:a,left:s},l)}getChildren(){if(this.children)return this.children;const e=this.iconStyle,{width:t,height:r,text:n,size:o,backgroundColor:i,top:a=0,left:s=0}=e,l=__rest$j(e,["width","height","text","size","backgroundColor","top","left"]),{left:c,right:u,height:d,top:h,bottom:p}=this.getBounds();return this.children=[createWidget({type:"bi.absolute",left:c,top:h+(d-r)/2,bottom:p-(d-r)/2,right:u,style:{backgroundColor:i},width:t,height:r,items:[{el:{type:"bi.label",style:Object.assign(Object.assign({},l),{lineHeight:r-1,fontSize:"".concat(o,"px"),verticalAlign:"middle"}),width:t,height:r,text:n},left:s,top:a,bottom:-a,right:-s,width:t,height:r}]})],this.children}getRealWidth(){return this.getChildren().reduce(((e,t)=>t.getRealWidth()+e),0)}};e=__decorate$18([widget("bi.icon")],e)})();var __decorate$17=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};class FlowLayout extends Absolute{adjustAndGenerate(e){let t=e;const r=this.getBounds();this.children=this.items.map(((e,n)=>{const o=e.el;o.top=r.top+(e.top||0),o.left=t+(e.left||0);const i=this.children[n].getRealWidth();return o.width=0===n?i:Math.min(r.width-(t-r.left)-(e.left||0),i),o.height=this.children[n].height,t+=o.width+(e.left||0),createWidget(o)}))}}(()=>{let e=class extends FlowLayout{digest(){super.digest();const e=this.getBounds().left;this.adjustAndGenerate(e)}};e=__decorate$17([widget("bi.flow_left")],e)})(),(()=>{let e=class extends FlowLayout{digest(){super.digest();const e=this.getBounds(),t=this.children.reduce(((e,t,r)=>t.getRealWidth()+this.items[r].left+e),0),r=Math.max((e.width-t)/2,0)+e.left;this.adjustAndGenerate(r)}};e=__decorate$17([widget("bi.flow_center")],e)})(),(()=>{let e=class extends FlowLayout{digest(){super.digest();const e=this.getBounds(),t=this.children.reduce(((e,t,r)=>t.getRealWidth()+this.items[r].left+e),0),r=Math.max(e.width-t,0)+e.left;this.adjustAndGenerate(r)}};e=__decorate$17([widget("bi.flow_right")],e)})();const DefaultRowSize=30,DefaultColumnSize=80,lineWidth=.5;class View{constructor(e){this.hoverCellX=-1,this.hoverCellY=-1,this.loadData(e),this.digest()}doMouseDown(e,t,r){const n=this.getMergeCell(t.ri,t.ci),o=createWidget(n);window.setTimeout((()=>{o.mouseDownHandler.call(null,e,t.x,t.y,n,r)}),0)}doMouseLeave(e,t,r){const n=this.getMergeCell(t.ri,t.ci),o=createWidget(n);window.setTimeout((()=>{o.mouseLeaveHandler.call(null,e,t.x,t.y,n,r)}),0)}doClick(e,t,r){const n=this.getMergeCell(t.ri,t.ci),o=createWidget(n);window.setTimeout((()=>{o.clickHandler.call(null,e,t.x,t.y,n,r)}),0)}doDbClick(e,t,r){const n=this.getMergeCell(t.ri,t.ci),o=createWidget(n);window.setTimeout((()=>{o.dbClickHandler&&o.dbClickHandler.call(null,e,t.x,t.y,n,r)}),0)}doHover(e,t,r){const n=this.getMergeCell(t.ri,t.ci);if(this.hoverCellX===t.ri&&this.hoverCellY===t.ci)return;this.hoverCellX=t.ri,this.hoverCellY=t.ci;const o=createWidget(n);window.setTimeout((()=>{o.hoverHandler&&o.hoverHandler.call(null,e,t.x,t.y,n,r)}),0)}disHover(){if(-1===this.hoverCellX&&-1===this.hoverCellY)return;const e=createWidget(this.getMergeCell(this.hoverCellX,this.hoverCellY));this.hoverCellX=-1,this.hoverCellY=-1,window.setTimeout((()=>{e.hoverHandler&&e.hoverHandler.call(null)}),0)}getSumHeight(e=0,t=this.rowc){let r=0;e=Math.max(0,e),t=Math.min(t,this.rowc);for(let n=e;n<t;n++)r+=this.getRowHeight(n);return r}getSumWidth(e=0,t=this.colc){let r=0;e=Math.max(0,e),t=Math.min(t,this.colc);for(let n=e;n<t;n++)r+=this.getColWidth(n);return r}getRowHeight(e){return isNil(this.rows[e])?DefaultRowSize:this.rows[e]}getColWidth(e){return isNil(this.cols[e])?DefaultColumnSize:this.cols[e]}getCellsInRange(e){const t=[],[r,n]=e;for(let o=r[1];o<=n[1];o++)for(let e=n[0];e>=r[0];e--){const r=this.getMergeCell(o,e);t.push(Object.assign(Object.assign({},r),{x:r.x+lineWidth,y:r.y+lineWidth}))}return t}getCellSquareInRange(e){const t=[],[r,n]=e;for(let o=r[1];o<=n[1];o++){const e=[];for(let t=r[0];t<=n[0];t++){const r=this.getMergeCell(o,t);e.push(Object.assign(Object.assign({},r),{x:r.x+lineWidth,y:r.y+lineWidth}))}t.push(e)}return t}getRangeBounds(e){let t=0,r=0,n=0,o=0;const[i,a]=e;for(let s=0;s<=a[1];s++)s===i[1]&&(o=t),t+=this.getRowHeight(s);for(let s=0;s<=a[0];s++)s===i[0]&&(n=r),r+=this.getColWidth(s);return{x:n,y:o,width:r-n,height:t-o}}getCellIndexs(e,t){let r=0,n=0,o=0,i=0;for(let a=0;a<this.rowc;a++){if(n+=this.getRowHeight(a),t<=n){o=a;break}o=a}for(let a=0;a<this.colc;a++){if(r+=this.getColWidth(a),e<=r){i=a;break}i=a}return[i,o]}getCellPoistion(e,t){return{x:this.getSumWidth(0,t),y:this.getSumHeight(0,e)}}getCellBounds(e,t){return{x:this.getSumWidth(0,t),y:this.getSumHeight(0,e),width:this.getColWidth(t),height:this.getRowHeight(e)}}findMergeRange(e,t){return find(this.merges,(r=>{const[n,o]=r;return e>=n[1]&&e<=o[1]&&t>=n[0]&&t<=o[0]}))||[[t,e],[t,e]]}getCellArea(e,t,r,n){return[this.getMergeCell(e,t),this.getMergeCell(r,n)]}getCell(e,t){const r=this.data[e]&&this.data[e][t]||null;return Object.assign(Object.assign(Object.assign({valid:null!==r,x:0,y:0},r),this.getCellBounds(e,t)),{ri:e,ci:t})}getViewData(){return this.data}isHoverText(e,t,r){return(e.textArea||[]).some((n=>e.x+n.x<=t&&e.y+n.y<=r&&e.x+n.x+n.width>=t&&e.y+n.y+n.height>=r))}getMergeCell(e,t){const[r,n]=this.findMergeRange(e,t);return Object.assign(Object.assign({},this.getCell(r[1],r[0])),{ri:r[1],ci:r[0],width:this.getSumWidth(r[0],n[0]+1),height:this.getSumHeight(r[1],n[1]+1),rp:n[1]-r[1],cp:n[0]-r[0]})}updateCell(e,t,r){this.data[e]&&(this.data[e][t]=r)}getStickers(){return this.stickers}setRowHeight(e,t){this.rows[e]=t,this.digest()}setColWidth(e,t){this.cols[e]=t,this.digest()}insertRows(e,t,r){const{rows:n}=r;this.rowc+=t.length,this.rows.splice(e,0,...n),this.data.splice(e,0,...t),e<this.freeze[1]&&(this.freeze[1]+=t.length),this.updateMerges(e,t.length,0,0),this.updateStickers(e,t.length,0,0),this.digest()}deleteRows(e,t){this.rowc=Math.max(e,this.rowc-t),this.rows.splice(e,t),this.data.splice(e,t),this.updateMerges(e,-t,0,0),this.updateStickers(e,-t,0,0),this.digest()}inserCols(e,t,r){const{cols:n}=r;this.colc+=t.length,this.cols.splice(e,0,...n),this.data.forEach(((r,n)=>{r.splice(e,0,...t[n])})),e<this.freeze[0]&&(this.freeze[0]+=t.length),this.updateMerges(0,0,e,t.length),this.updateStickers(0,0,e,t.length),this.digest()}deleteCols(e,t){this.colc=Math.max(e,this.colc-t),this.cols.splice(e,t),this.data.forEach((r=>{r.splice(e,t)})),this.updateMerges(0,0,e,t),this.updateStickers(0,0,e,t),this.digest()}digest(){this.totalWidth=this.getSumWidth(),this.totalHeight=this.getSumHeight(),this.freezeConfig={headWidth:this.getSumWidth(0,this.freeze[0]),headHeight:this.getSumHeight(0,this.freeze[1]),tailWidth:this.freeze[2]>this.freeze[0]?Math.max(this.getSumWidth(this.freeze[2]),this.width-this.getSumWidth(0,this.freeze[2])):0,tailHeight:this.freeze[3]>this.freeze[1]?Math.max(this.getSumHeight(this.freeze[3]),this.height-this.getSumHeight(0,this.freeze[3])):0}}loadData(e){const{colc:t,rowc:r,cols:n,rows:o,data:i,freeze:a,merges:s,styles:l,stickers:c,height:u,width:d}=e;this.colc=t,this.rowc=r,this.cols=n||[],this.rows=o||[],this.cols.length=t,this.rows.length=r,this.freeze=a||[0,0,0,0],this.data=i||[],this.merges=s||[],this.styles=l||[],this.height=u,this.width=d,this.stickers=(c||[]).map((e=>(e.id=e.id||uuid(),e))),this.digest()}updateMerges(e,t,r,n){this.merges.forEach((o=>{const[i,a]=o;i[0]>=r&&(i[0]+=n),i[1]>=e&&(i[1]+=t),a[0]>=r&&(a[0]+=n),a[1]>=e&&(a[1]+=t)}))}updateStickers(e,t,r,n){this.stickers.forEach((o=>{const{position:i}=o;"row"in i&&"col"in i&&(i.row>e&&i.row<=e-t||i.col>r&&i.col<=r-n?o.tag="delete":o.tag="normal",i.col>=r&&(i.col+=n),i.row>=e&&(i.row+=t)),"x"in i&&"y"in i&&(i.x>=r&&(i.x+=n),i.y>=e&&(i.y+=t))}))}getSelctionRange(e,t,r,n){if(!this.data[0])return[];const o=this.data[0].length,i=[];let a=t,s=e;for(;a<=n&&!(a===n&&s>r);){const e=this.getCell(a,s);e&&i.push(e),s===o?(a++,s=0):s++}return i}reset(){this.getViewData().forEach((e=>{null==e||e.forEach((e=>{(e||e.textArea)&&(e.textArea=[])}))}))}}const DEFAULT_SHEET_OPTIONS={sheet:{colc:0,rowc:0},scroll:{x:0,y:0,sr:0,sc:0,er:0,ec:0},selection:{},selectable:!1,width:0,height:0,topSequnce:{enable:!1,size:30},leftSequnce:{enable:!1,size:80},offsetX:0,offsetY:0,align:!1},DEFAULT_POINT=[-1,-1];let Selection$1=class{constructor(){this.start={x:0,y:0},this.end={x:0,y:0},this.selectedTexts=[],this.reset()}selectCell(e,t,r){this.cell=[t,e],this.range=[DEFAULT_POINT,DEFAULT_POINT],this.start=r}selectRange(e,t,r,n,o){this.cell===DEFAULT_POINT&&(this.cell=[0,0]),this.range=[[t,e],[n,r]],this.end=o}getCell(){return this.cell}getRange(){return[this.range[0]===DEFAULT_POINT?this.cell:this.range[0],this.range[1]===DEFAULT_POINT?this.cell:this.range[1]]}getPosition(){return this.start.y>this.end.y||this.start.y===this.end.y&&this.start.x>this.end.x?{start:this.end,end:this.start}:{start:this.start,end:this.end}}reset(){this.cell=DEFAULT_POINT,this.range=[DEFAULT_POINT,DEFAULT_POINT],this.start={x:0,y:0},this.end={x:0,y:0},this.setSelectedTexts([])}setSelectedTexts(e){this.selectedTexts=e}getSelectedTexts(){return this.selectedTexts}};class DataProxy{constructor(e="sheet",t){this.name=e,this.selection=new Selection$1,this.options=Object.assign(Object.assign({},cloneDeep(DEFAULT_SHEET_OPTIONS)),t),this.view=new View(this.options.sheet),this.scroll=this.options.scroll,this.scroll.x=isNaN(this.scroll.x)?0:this.scroll.x,this.scroll.y=isNaN(this.scroll.y)?0:this.scroll.y,this.repeatFill=this.options.repeatFill,this.update()}getRenderBounds(e){const{headHeight:t,headWidth:r,tailHeight:n,tailWidth:o}=this.view.freezeConfig;return"horizontal"===e?{x:r,y:0,width:this.width-r-o,height:this.options.height}:{x:0,y:t,width:this.width,height:this.options.height-t-n}}select(e,t,r,n,o){if(void 0!==r&&void 0!==n){const[[i,a],[s,l]]=this.correctSelectRange(e,t,r,n);this.selection.selectRange(a,i,l,s,o)}else this.selection.selectCell(e,t,o)}scrollTo(e,t,r){this.sc(e,t,r)}scrollX(e,t){e=clamp(e,0,this.maxScrollX),this.sc(e,this.scroll.y,t)}scrollY(e,t){e=clamp(e,0,this.maxScrollY),this.sc(this.scroll.x,e,t)}getViewRange(){return[this.view.getCellIndexs(this.scroll.x,this.scroll.y),this.view.getCellIndexs(this.scroll.x+this.width,this.scroll.y+this.height)]}getScrollRange(){const{headWidth:e,headHeight:t,tailHeight:r,tailWidth:n}=this.view.freezeConfig;return[this.view.getCellIndexs(this.scroll.x+e,this.scroll.y+t),this.view.getCellIndexs(this.scroll.x+this.width-n,this.scroll.y+this.height-r)]}getViewBounds(){return{width:this.width,height:this.height}}getScroll(){return this.scroll}getCellIndexs(e,t){const{headHeight:r,headWidth:n,tailHeight:o,tailWidth:i}=this.view.freezeConfig;e>n&&e<this.width-i&&(e+=this.scroll.x),t>r&&t<this.height-o&&(t+=this.scroll.y);const a=this.view.getCellIndexs(e,t),s=this.view.getMergeCell(a[1],a[0]);return[s.ci,s.ri]}getCellByOffset(e,t){if(e>=this.offset.offsetX&&t>=this.offset.offsetY){const{x:r,y:n}=this.getPositionByOffset(e,t),o=this.view.getCellIndexs(r,n);return this.view.getMergeCell(o[1],o[0])}}getPositionByOffset(e,t){const{headHeight:r,headWidth:n,tailHeight:o,tailWidth:i}=this.view.freezeConfig;return e-=this.offset.offsetX,t-=this.offset.offsetY,e>n&&e<this.width-i&&(e+=this.scroll.x),t>r&&t<this.height-o&&(t+=this.scroll.y),{x:e,y:t}}getRelativePositionByOffset(e,t){const{tailHeight:r,tailWidth:n}=this.view.freezeConfig;let{x:o,y:i}=this.getPositionByOffset(e,t);if(r||n){const{width:a,height:s}=this.getWholeSheetBounds4Render();e>=this.width-n&&(o=a-(this.width-e)),t>=this.height-r&&(i=s-(this.height-t))}return{x:o,y:i}}updateCell(e,t,r){this.view.updateCell(e,t,r)}getCellIndexsByOffset(e,t){const{offsetX:r,offsetY:n}=this.offset;if(e>=r&&t>=n&&(t-=n,(e-=r)<=this.view.totalWidth&&t<=this.view.totalHeight)){const[r,n]=this.getCellIndexs(e,t);return!1===this.view.getCell(n,r).valid?null:[r,n]}}getFreezeBounds(){const{headHeight:e,headWidth:t,tailHeight:r,tailWidth:n}=this.view.freezeConfig;return[{x:t,y:0,width:this.width-t-n,height:e},{x:0,y:e,width:t,height:this.height-e-r},{x:t,y:this.height-r,width:this.width-t-n,height:r},{x:this.width-n,y:e,width:n,height:this.height-e-r},{x:0,y:0,width:t,height:e},{x:this.width-n,y:0,width:n,height:e},{x:this.width-n,y:this.height-r,width:n,height:r},{x:0,y:this.height-r,width:t,height:r}]}cellIsFreezed(e){const{headHeight:t,headWidth:r,tailHeight:n,tailWidth:o}=this.view.freezeConfig;return{horizontalFreezed:e.y+e.height<=t||e.y>=this.view.totalHeight-n,verticalFreezed:e.x+e.width<=r||e.x>=this.view.totalWidth-o}}getCellsInBounds(e,t,r,n){const o=this.normalizeBounds(e,t,r,n),{sx:i,sy:a,reptx:s,repty:l}=this.getCellCorrectOffset(e,t),c=this.getCellsInAreaGrid(o,{sx:i,sy:a,reptx:s,repty:l});return this.duplicateAndTransformCells(c)}normalizeBounds(e,t,r,n){return{x:Math.max(e,0),y:Math.max(t,0),width:Math.min(r,this.width-e),height:Math.min(n,this.height-t)}}getCellsInAreaGrid(e,t){const{x:r,y:n}=e,{reptx:o,repty:i}=t,{headHeight:a,headWidth:s,tailHeight:l,tailWidth:c}=this.view.freezeConfig,u={isTop:n<a,isBottom:n>=this.height-l,isLeft:r<s,isRight:r>=this.width-c},d=this.calculateHorizontalRange(u,e,t),h=this.calculateVerticalRange(u,e,t);return[...this.view.getCellsInRange([this.view.getCellIndexs(d[0],h[0]),this.view.getCellIndexs(d[1],h[1])]).map((e=>Object.assign(Object.assign({},e),{reptx:o,repty:i}))),...this.getCrossRangeCells(d,h,t,u)]}calculateHorizontalRange(e,t,r){const{headWidth:n,tailWidth:o}=this.view.freezeConfig,{x:i,width:a}=t,{sx:s,reptx:l}=r;if(e.isLeft)return[i,n];if(e.isRight){const e=this.view.totalWidth-(this.width-i)+1;return[e,e+a]}return[s,s+a+l*(n+o)]}calculateVerticalRange(e,t,r){const{headHeight:n,tailHeight:o}=this.view.freezeConfig,{y:i,height:a}=t,{sy:s,repty:l}=r;if(e.isTop)return[i,n];if(e.isBottom){const e=this.view.totalHeight-(this.height-i)+1;return[e,e+a]}return[s,s+a+l*(n+o)]}getCrossRangeCells(e,t,r,n){return this.repeatFill?this.getRepeatCrossRangeCells(e,t,r,n):this.getNonRepeatCrossRangeCells(e,t,n)}getNonRepeatCrossRangeCells(e,t,r){const{headHeight:n,headWidth:o,tailHeight:i,tailWidth:a}=this.view.freezeConfig,{totalWidth:s,totalHeight:l}=this.view,c=this.scroll.x>this.maxScrollX,u=this.scroll.y>this.maxScrollY,d=[];return!c||r.isLeft||r.isRight||(r.isTop&&d.push(...this.view.getCellsInRange([this.view.getCellIndexs(e[0],0),this.view.getCellIndexs(s-a,n)])),r.isBottom&&d.push(...this.view.getCellsInRange([this.view.getCellIndexs(e[0],l-i),this.view.getCellIndexs(s-a,l)]))),!u||r.isTop||r.isBottom||(r.isLeft&&d.push(...this.view.getCellsInRange([this.view.getCellIndexs(0,t[0]),this.view.getCellIndexs(o,l-i)])),r.isRight&&d.push(...this.view.getCellsInRange([this.view.getCellIndexs(s-a,t[0]),this.view.getCellIndexs(s,l-i)]))),d}getRepeatCrossRangeCells(e,t,r,n){const{headHeight:o,headWidth:i,tailHeight:a,tailWidth:s}=this.view.freezeConfig,{totalWidth:l,totalHeight:c}=this.view,u=[],d=this.scroll.x-this.maxScrollX>s&&e[1]>l,h=this.scroll.y-this.maxScrollY>a&&t[1]>c,p=r.reptx+(d?1:0),f=r.repty+(h?1:0);if(d){const r=this.view.getCellsInRange([this.view.getCellIndexs(i,t[0]),this.view.getCellIndexs(e[1]-l+i+s,t[1])]);u.push(...r.map((e=>Object.assign(Object.assign({},e),{reptx:p,repty:f}))))}if(h){const r=this.view.getCellsInRange([this.view.getCellIndexs(e[0],o+1),this.view.getCellIndexs(e[1],t[1]-c+o+a)]);u.push(...r.map((e=>Object.assign(Object.assign({},e),{reptx:p,repty:f}))))}return this.handleContentAreaCells(u,e,t,n,{headHeight:o,headWidth:i,tailHeight:a,tailWidth:s,reptx:p,repty:f}),u}handleContentAreaCells(e,t,r,n,o){const{headHeight:i,headWidth:a,tailHeight:s,tailWidth:l,reptx:c,repty:u}=o,d=this.scroll.x-this.maxScrollX+l>0,h=this.scroll.y-this.maxScrollY+s>0,p=!n.isRight&&!n.isLeft,f=!n.isTop&&!n.isBottom;if(d&&p){const t=this.view.getCellsInRange([this.view.getCellIndexs(a,r[0]),this.view.getCellIndexs(a+l,r[1])]);e.push(...t.map((e=>Object.assign(Object.assign({},e),{reptx:c+1,repty:u}))))}if(h&&f){const r=this.view.getCellsInRange([this.view.getCellIndexs(t[0],i),this.view.getCellIndexs(t[1],i+s)]);e.push(...r.map((e=>Object.assign(Object.assign({},e),{reptx:c,repty:u+1}))))}}duplicateAndTransformCells(e){const t=new Set;return e.reduce(((e,r)=>{const n="".concat(r.ci,"-").concat(r.ri,"-").concat(r.reptx,"-").concat(r.repty);return t.has(n)||(t.add(n),e.push(this.correctBounds(r))),e}),[])}getCellCorrectOffset(e,t){const{height:r,width:n}=this.getWholeSheetBounds4Render();if(this.repeatFill)return{sx:(e+this.scroll.x)%n,sy:(t+this.scroll.y)%r,reptx:Math.floor((e+this.scroll.x)/n),repty:Math.floor((t+this.scroll.y)/r)};return{sx:e+this.scroll.x,sy:t+this.scroll.y,reptx:0,repty:0}}getCellBounds(e,t){const r=this.view.freeze,n=this.view.getCellBounds(e,t);return e>r[1]&&(n.y-=this.scroll.y),t>r[0]&&(n.x-=this.scroll.x),n}getCell(e,t){return Object.assign(Object.assign({},this.getCellBounds(e,t)),{ri:e,ci:t})}getMergeCells(){return this.view.merges.map((e=>{const[t]=e,r=this.view.getRangeBounds(e);return this.correctBounds(Object.assign(Object.assign(Object.assign({},this.view.getCell(t[1],t[0])),r),{x:r.x+.5,y:r.y+.5}))}))}getRangeBounds(e){return this.view.getRangeBounds(e)}correctDeltaY(e){if(!e)return e;const t=this.scroll.y+e;if(t<=0)return-this.scroll.y;if(t>=this.maxScrollY)return this.maxScrollY-this.scroll.y;if(!this.options.align)return e;const{headHeight:r}=this.view.freezeConfig,n=t+r;let o=r,i=t;for(let a=this.view.freeze[1];a<this.view.rowc;a++){const e=this.view.getRowHeight(a);if(n>=o&&n<o+e){i=n>o+e/2?o+e:o;break}o+=e}return i-this.scroll.y-r}correctDeltaX(e){if(!e)return e;const t=this.scroll.x+e;if(t<=0)return-this.scroll.x;if(t>=this.maxScrollX)return this.maxScrollX-this.scroll.x;if(!this.options.align)return e;const{headWidth:r}=this.view.freezeConfig,n=t+r;let o=r,i=t;for(let a=this.view.freeze[0];a<this.view.colc;a++){const e=this.view.getColWidth(a);if(n>=o&&n<o+e){i=n>o+e/2?o+e:o;break}o+=e}return i-this.scroll.x-r}getSequnceCells(){const[[e,t],[r,n]]=this.selection.getRange();let o=[],i=[];const[a,s]=this.view.getCellArea(t,e,n,r),l=Math.min(a.ci,s.ci),c=Math.max(a.ci+a.cp,s.ci+s.cp),u=Math.min(a.ri,s.ri),d=Math.max(a.ri+a.rp,s.ri+s.rp);return this.options.topSequnce.enable&&(o=Array.prototype.concat(cArray(this.scroll.sc,this.scroll.ec+1),cArray(0,this.view.freeze[0])).map((e=>{const t=this.getCellBounds(0,e);return Object.assign(Object.assign({},t),{x:t.x+.5,y:t.y-this.offset.offsetY+.5,width:this.view.getColWidth(e),height:this.offset.offsetY,type:"bi.label",text:xTo26(e),ri:-1,ci:e,style:{color:"#5f6368",backgroundColor:between(e,l,c)?"#e8eaed":"#f8f9fa"}})}))),this.options.leftSequnce.enable&&(i=Array.prototype.concat(cArray(this.scroll.sr,this.scroll.er+1),cArray(0,this.view.freeze[1])).map((e=>{const t=this.getCellBounds(e,0);return Object.assign(Object.assign({},t),{x:t.x-this.offset.offsetX+.5,y:t.y+.5,width:this.offset.offsetX-.5,height:this.view.getRowHeight(e)-.5,type:"bi.label",text:e+1,ci:-1,ri:e,style:{color:"#5f6368",backgroundColor:between(e,u,d)?"#e8eaed":"#f8f9fa"}})}))),Array.prototype.concat(o,i)}isInSticker(e,t){return this.getStickers().some((r=>r.left<=e&&r.left+r.width>=e&&r.top<=t&&r.top+r.height>=t))}getStickers(){return this.view.getStickers().map((e=>{const{el:t,position:r,id:n,tag:o,init:i,lazy:a}=e;let s=0,l=0,c=0,u=0;if("x"in r&&(l=r.x,s=r.y,c=r.width,u=r.height),"col"in r&&"row"in r){const[e,t]=this.view.findMergeRange(r.row,r.col),n=this.getStickerBounds(r.row,r.col);l=n.x,s=n.y,c=this.view.getSumWidth(e[0],t[0]+1),u=this.view.getSumHeight(e[1],t[1]+1)}return{id:n,top:s,left:l,width:c,height:u,el:t,tag:o,init:i,lazy:a}}))}getStickerBounds(e,t){return this.view.getCellBounds(e,t)}getResizerCell(e,t){const r=e>this.offset.offsetX,n=r?e-this.offset.offsetX:e,o=r?t:t-this.offset.offsetY,i=this.getCellIndexs(n,o),a=this.getCellBounds(i[1],i[0]);let s,l;return r?n-a.x<a.x+a.width-n?(s=[i[0],Math.max(i[1]-1,0)],l=this.getCellBounds(s[1],s[0])):(s=i,l=a):o-a.y<a.y+a.height-o?(s=[Math.max(i[0]-1,0),i[1]],l=this.getCellBounds(s[1],s[0])):(s=i,l=a),Object.assign(Object.assign({},l),{ri:s[1],ci:s[0],left:r?l.x+this.offset.offsetX:l.x,top:r?l.y:l.y+this.offset.offsetY,width:r?l.width:this.offset.offsetX,height:r?this.offset.offsetY:l.height})}getSelectCell(){const[e,t]=this.selection.getCell();return this.view.getMergeCell(t,e)}getSelectRangeCells(){return this.view.getCellSquareInRange(this.getSelectRange())}getSelectRange(){const[[e,t],[r,n]]=this.selection.getRange(),o=this.view.getMergeCell(t,e),i=this.view.getMergeCell(n,r),a=Math.min(o.ci,i.ci),s=Math.max(o.ci+o.cp,i.ci+i.cp);return[[a,Math.min(o.ri,i.ri)],[s,Math.max(o.ri+o.rp,i.ri+i.rp)]]}transformPosition(e,t,r){const[[n,o],[i,a]]=this.selection.getRange(),s=r.ci===n&&r.ri===o,l=r.ci===i&&r.ri===a,c=this.getCellPosition({row:r.ri,col:r.ci},this.view.merges);if(s&&l){return(r.textArea||[]).some((n=>r.y+n.y<=e.y&&r.y+n.y+n.height>=e.y&&r.y+n.y<=t.y&&r.y+n.y+n.height>=t.y))&&e.x>t.x?[t,e]:[e,t]}return s?(!isPointInMatrix(e,{x:r.x,y:r.y,width:c.width,height:c.height})&&([e,t]=[t,e]),[e,{x:r.x+c.width,y:r.y+r.height}]):l?(!isPointInMatrix(t,{x:r.x,y:r.y,width:c.width,height:c.height})&&([e,t]=[t,e]),[{x:r.x,y:r.y},t]):[{x:r.x,y:r.y},{x:r.x+c.width,y:r.y+c.height}]}getSelectBounds(){const[[e,t],[r,n]]=this.selection.getRange(),{start:o,end:i}=this.selection.getPosition(),a=this.view.getSelctionRange(e,t,r,n),s=[],l=new Map;return a.forEach((a=>{const c=a.ci===e&&a.ri===t,u=a.ci===r&&a.ri===n,d=c||u,h=this.offset2Absolute(o,a),p=this.offset2Absolute(i,a),[f,g]=this.transformPosition(h,p,a);let m="";(a.textArea||[]).forEach((({x:e,y:t,width:r,height:n,text:o})=>{o&&(!d||(a.y+t<f.y?a.y+t+n>f.y:a.y+t<g.y)&&(!(a.y+t<f.y)||a.x+e+r>f.x)&&(!(a.y+t+n>g.y)||a.x+e<g.x))&&(s.push([{x:e+a.x,y:t+a.y,width:r,height:n}]),m+=o)})),m&&l.set(a.y,(l.get(a.y)||[]).concat([m]))})),this.selection.setSelectedTexts(Array.from(l.values())),s}offset2Absolute({x:e,y:t},r){let[n,o]=[e,t];const{x:i,y:a}=this.getScroll(),{headHeight:s,headWidth:l}=this.view.freezeConfig,{verticalFreezed:c,horizontalFreezed:u}=this.cellIsFreezed(r),{height:d,width:h}=this.getWholeSheetBounds4Render();return u?o>=s&&(o=d-(this.height-o)):o+=a,c?n>=l&&(n=h-(this.width-n)):n+=i,{x:n,y:o}}getQuadrantBounds(e,t){const{headHeight:r,headWidth:n,tailHeight:o,tailWidth:i}=this.view.freezeConfig,a=r+1,s=n+1,l=t<a,c=e<s,u=e>this.width-i,d=t>this.height-o;let h=0,p=0,f=0,g=0;return c?(h=0,f=s,g=l?a:d?o:this.height-a-o):u?(h=this.width-i,f=i,g=l?a:d?o:this.height-a-o):(h=s,f=this.width-s-i,g=l?a:d?o:this.height-a-o),p=l?0:d?this.height-o:a,{x:h,y:p,width:f,height:g}}spliteBounds(e,t,r,n){const{headHeight:o,headWidth:i,tailHeight:a,tailWidth:s}=this.view.freezeConfig,l=[],c=this.getFreezeBounds();c.push({x:i,y:o,width:this.width-i-s,height:this.height-o-a});for(const{x:u,y:d,width:h,height:p}of c){const o=[Math.max(u,e),Math.min(u+h,r)],i=[Math.max(d,t),Math.min(d+p,n)];if(inRange(o[0],u,u+h+1)&&inRange(o[1],u,u+h+1)&&inRange(i[0],d,d+p+1)&&inRange(i[1],d,d+p+1)){const e=o[1]-o[0],t=i[1]-i[0];e>0&&t>0&&l.push({x:o[0],y:i[0],width:e,height:t})}}return l}setOffset(e){const{offsetX:t,offsetY:r}=e;this.offset=e,this.width=this.width-t,this.height=this.height-r,this.update()}setDataScroll(e){this.scroll.x=e.offsetX,this.scroll.y=e.offsetY}resizeRow(e,t){this.view.setRowHeight(e,t),this.updateMaxScroll(),this.updateScrollRange()}resizeCol(e,t){this.view.setColWidth(e,t),this.updateMaxScroll(),this.updateScrollRange()}insertRows(e,t,r){this.view.insertRows(e,t,r),this.update()}insertCols(e,t,r){this.view.inserCols(e,t,r),this.update()}deleteRows(e,t){this.view.deleteRows(e,t),this.update()}deleteCols(e,t){this.view.deleteCols(e,t),this.update()}setData(e){this.options=Object.assign(Object.assign(Object.assign({},DEFAULT_SHEET_OPTIONS),this.options),e),this.view.loadData(Object.assign(Object.assign({},this.options.sheet),{height:this.height,width:this.width})),this.scroll=this.options.scroll,this.scroll.x=isNaN(this.scroll.x)?0:this.scroll.x,this.scroll.y=isNaN(this.scroll.y)?0:this.scroll.y,this.update()}resize(e,t){this.options.width=e||this.options.width,this.options.height=t||this.options.height,this.view.reset(),this.update()}reset(){this.clearSelection()}update(){this.updateOffset(),this.updateMaxScroll(),this.updateScrollRange()}correctBounds(e){let{x:t,y:r}=e;const{reptx:n=0,repty:o=0}=e,{headHeight:i,headWidth:a,tailHeight:s,tailWidth:l}=this.view.freezeConfig,{height:c,width:u}=this.getWholeSheetBounds4Render();return t>u-l?t=this.width-(u-t):t>=a&&(t=t-this.scroll.x+n*(u-a-l)),r>c-s?r=this.height-(c-r):r>=i&&(r=r-this.scroll.y+o*(c-i-s)),Object.assign(Object.assign({},e),{x:t,y:r,ox:t,oy:r})}clearSelection(){this.selection.reset()}sc(e,t,r){const n=Object.assign({},this.scroll);this.scroll.x=e,this.scroll.y=t,this.updateScrollRange(),r&&r(this.scroll,n)}updateScrollRange(){this.scroll.x=Math.ceil(Math.min(this.scroll.x,this.maxScrollX)),this.scroll.y=Math.ceil(Math.min(this.scroll.y,this.maxScrollY));const[e,t]=this.getScrollRange();this.scroll.sr=e[1],this.scroll.sc=e[0],this.scroll.er=t[1],this.scroll.ec=t[0]}updateOffset(){this.offset={offsetX:(this.options.leftSequnce.enable?this.options.leftSequnce.size:0)+this.options.offsetX,offsetY:(this.options.topSequnce.enable?this.options.topSequnce.size:0)+this.options.offsetY},this.width=this.options.width-this.offset.offsetX,this.height=this.options.height-this.offset.offsetY}updateMaxScroll(){const{width:e,height:t}=this.getMaxScrollBounds();this.maxScrollX=Math.ceil(e),this.maxScrollY=Math.ceil(t)}getMaxScrollBounds(){let e=0,t=0;if(!this.options.align)return{width:Math.max(this.view.totalWidth-this.width,0),height:Math.max(this.view.totalHeight-this.height,0)};const{headHeight:r,headWidth:n,tailHeight:o,tailWidth:i}=this.view.freezeConfig;for(let a=this.view.rowc-1;a>=0;a--){const t=this.view.getRowHeight(a);if(e+t>this.height-r-o)break;e+=t}for(let a=this.view.colc-1;a>=0;a--){const e=this.view.getColWidth(a);if(t+e>this.width-n-i)break;t+=e}return{width:Math.max(this.view.totalWidth-n-i-t,0),height:Math.max(this.view.totalHeight-r-o-e,0)}}correctSelectRange(e,t,r,n){e>r&&([e,r]=[r,e],[t,n]=[n,t]),e===r&&t>n&&([t,n]=[n,t]);let o=[[t,e],[n,r]],i=[[t,e],[n,r]];for(;!isEqual(o,i);){o=i;let e=i;this.view.merges.forEach((t=>{e=mergeRange(e,t)})),i=e}return i}getCellPosition(e,t){const r=t.find((t=>t.findIndex((t=>2===t.length&&t[0]===e.col&&t[1]===e.row))>=0));return r?this.view.getRangeBounds(r):this.view.getCellBounds(e.row,e.col)}getWholeSheetBounds4Render(){return{height:Math.max(this.height,this.view.totalHeight),width:Math.max(this.width,this.view.totalWidth)}}}function getRotatePosition({rotate:e,x:t,y:r,width:n,height:o,textAlign:i,boundsWidth:a,baseline:s}){const l=r+o/2-a/2,c=r+o/2+a/2;return Math.abs(e)<80||"center"===i?{baseX:t+n/2-s,baseY:r+o/2,textBaseline:e>0?"top":"bottom",textAlign:"center"}:"left"===i?{baseX:t,baseY:e<0?l:c,textBaseline:e>0?"top":"bottom",textAlign:i}:"right"===i?{baseX:t+n,baseY:e<0?c:l,textBaseline:e>0?"bottom":"top",textAlign:i}:{baseX:t,baseY:r,textBaseline:"bottom",textAlign:"left"}}function resizeCanvas(e,t,r,n){return e.width=Math.round(r*t),e.height=Math.round(n*t),h$1(e).offset({width:e.width/t,height:e.height/t}),e.getContext("2d").setTransform(t,0,0,t,0,0),e}class FineCanvas{constructor(e,t){this.pixelRatio=t.minDpr?Math.max(dpr(),t.minDpr):dpr(),this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.ctx.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}drawText(e,t,r,n,o,i){this.text(e,t,r,n,o,i)}wrapText({text:e,x:t,y:r,width:n,height:o,lineHeight:i,options:a},s){this.ctx.save();const{verticalAlign:l,clip:c,fontStyle:u,fontWeight:d,fontFamily:h,verticalText:p,textAlign:f}=a;let{fontSize:g}=a;c&&(this.ctx.beginPath(),this.ctx.rect(t,r,n,o),this.ctx.clip(),this.ctx.beginPath()),setCtxFont(this.ctx,{fontFamily:h,fontSize:g,fontStyle:u,fontWeight:d}),i=i||1.2*parseFloat(g);let m=[];const y=this.makeLineTextOpts(g,e,t,r,n,o,i,a);if(m=y.textOpts,g=y.fontSize,i=y.lineHeight,"VERTICAL_TEXT"===p){const e=i*m.length;m.forEach(((t,r)=>{const{text:o,width:a,height:c,options:p}=t;let{x:y,y:v}=t;switch(f){case"left":break;case"center":y+=(n-e)/2;break;case"right":y+=n-e;break;case"distributed":y+=(n-e)/(m.length-1)*r}const _=Math.floor(c/i);switch(l){case"middle":v+=Math.floor((_-o.length)/2)*i;break;case"bottom":v+=(_-o.length)*i}if(this.textVertical(o,y,v,a,c,Object.assign(Object.assign({},p),{verticalAlign:l,fontFamily:h,fontSize:g,fontWeight:d,fontStyle:u,lineHeight:i,clip:!1}),s),0===r){const e=m.reduce(((e,t)=>Math.max(e,t.text.length)),0),r=m.length,{baseline:n}=getMetrics({fontFamily:h,fontSize:g});v=1===r?v:t.y;for(let t=0;t<e;t++)v+=i,this.drawUnderline(y,v-i/4+parseFloat(n),y+a*r,v-i/4+parseFloat(n),p),this.drawStrikeThrough(y,v-i/4+parseFloat(g)/10,y+a*r,v-i/4+parseFloat(g)/10,p)}}))}else{const e=i*m.length;m.forEach((t=>{const{text:r,x:n,width:a,height:c,options:p}=t;let{y:f}=t;switch(l){case"top":break;case"middle":f+=o-e>0?(o-e)/2:2;break;case"bottom":f+=o-e>0?o-e:2}this.text(r,n,f,a,c,Object.assign(Object.assign({},p),{verticalAlign:"middle",fontFamily:h,fontSize:g,fontWeight:d,fontStyle:u,lineHeight:i,clip:!1}),s)}))}this.ctx.restore()}drawLine(e,t,r,n,o){const{color:i,lineWidth:a,lineStyle:s,lineDash:l}=o;if(0!==a&&"none"!==s){switch(this.ctx.save(),i&&(this.ctx.strokeStyle=i),a&&(this.ctx.lineWidth=a),s){case"solid":break;case"dashed":this.ctx.setLineDash(l);break;case"dotted":this.ctx.setLineDash([1,1]);break;case"double":return this.ctx.lineWidth=a/2,this.drawDoubleLine({x:e,y:t,x1:r,y1:n}),void this.ctx.restore()}this.ctx.beginPath(),this.linePath([[e,t],[r,n]]),this.ctx.restore()}}drawDoubleLine({x:e,y:t,x1:r,y1:n}){const o=r-e,i=n-t,a=Math.sqrt(o*o+i*i),s=1*-i/a,l=1*o/a;this.ctx.beginPath(),this.linePath([[e+s,t+l],[r+s,n+l]]),this.linePath([[e-s,t-l],[r-s,n-l]])}drawRect(e,t,r,n,o){this.ctx.save();const{color:i="#fff",fillColor:a,lineWidth:s=0,linearGradient:l,radiusConfig:c}=o,u=a;if(this.ctx.beginPath(),c?this.drawRadiusRect(e,t,r,n,c):this.ctx.rect(e,t,r,n),this.ctx.closePath(),l){const{degree:o,stops:i}=l,[[a,s],[c,u]]=getFitGradient(o,r,n),d=this.ctx.createLinearGradient(e+a,t+s,e+c,t+u);return i.forEach((e=>{d.addColorStop(e.per,e.color)})),this.ctx.fillStyle=d,this.ctx.fill(),this.ctx.restore()}u&&(this.ctx.fillStyle=u,this.ctx.fill()),s&&(this.ctx.strokeStyle=i,this.ctx.lineWidth=s,this.ctx.stroke()),this.ctx.restore()}drawRadiusRect(e,t,r,n,o){const{radius:i,tlRadius:a,trRadius:s,blRadius:l,brRadius:c}=o,u=Math.floor(Math.min(n/2,i)),d=Math.floor(Math.min(r/2,i));this.ctx.moveTo(e,t+u),a?this.ctx.quadraticCurveTo(e,t,e+d,t):this.ctx.lineTo(e,t),this.ctx.lineTo(e+r-d,t),s?this.ctx.quadraticCurveTo(e+r,t,e+r,t+u):this.ctx.lineTo(e+r,t),this.ctx.lineTo(e+r,t+n-u),c?this.ctx.quadraticCurveTo(e+r,t+n,e+r-d,t+n):this.ctx.lineTo(e+r,t+n),this.ctx.lineTo(e+d,t+n),l?this.ctx.quadraticCurveTo(e,t+n,e,t+n-u):this.ctx.lineTo(e,t+n),this.ctx.lineTo(e,t+u)}drawBias(e,t,r,n,o,i,a){this.ctx.save();const{fontSize:s="9px",color:l="#000000",fontWeight:c=400,fontFamily:u="sans-serif",fontStyle:d="normal"}=a,h={fontSize:s,color:l,fontWeight:c,fontFamily:u},p=1.3*parseFloat(s),f=getBiasLines(e,t,r,n,o,i.length-1);this.ctx.beginPath(),this.ctx.rect(e,t,r,n),this.ctx.clip(),setCtxFont(this.ctx,{fontFamily:u,fontSize:s,fontStyle:d,fontWeight:c}),f.forEach(((s,c)=>{const[u,d]=s;if(this.drawLine(u[0],u[1],d[0],d[1],{color:l,lineWidth:1}),0===c){let s=p;const l=[];if(s>n)return;for(;s<=n;){let i=null;if(o){const r=Math.abs((d[0]-u[0])/(d[1]-u[1]))*(n-s);i={x:e,y:t+s-p,width:r,height:p}}else{const n=Math.abs((d[0]-u[0])/(d[1]-u[1]))*s;i={x:e+n,y:t+s-p,width:r-n,height:p}}l.push(i),s+=p}const c="".concat(i[0]).split("");let f="",g=0;const m=[];for(let e=0;e<c.length;e++){const t=f+c[e],r=this.ctx.measureText(t).width;if(this.ctx.measureText(f).width>l[g].width)break;if(r>l[g].width){if(this.text(f,l[g].x,l[g].y,l[g].width,l[g].height,Object.assign(Object.assign({},h),{textAlign:"left",verticalAlign:"middle"})),m.push(Object.assign(Object.assign({x:l[g].x,y:l[g].y+l[g].height/2},l[g]),{text:f,options:a})),f=c[e],g++,!l[g])break}else f=t}f&&l[g]&&this.ctx.measureText(f).width<=l[g].width&&this.text(f,l[g].x,l[g].y,l[g].width,l[g].height,Object.assign(Object.assign({},h),{textAlign:"left",verticalAlign:"middle"}))}if(c===f.length-1){let a=n-p;const s=[];for(;a>=0;){let n=null;if(o){const o=Math.abs((d[0]-u[0])/(d[1]-u[1]))*(a+t-d[1]);n={x:e+r-o,y:t+a,width:o,height:p}}else{const r=Math.abs((d[0]-u[0])/(d[1]-u[1]))*a;n={x:e,y:t+a,width:r,height:p}}s.push(n),a-=p}const l=this.ctx.measureText("".concat(i[i.length-1])).width;let c=Math.floor(s.length/2),f=s.length%2==1?s[c].width:s[c].width+s[s.length-c-1].width;for(;f<l&&c<s.length-1;)c++,f+=s[c].width+s[s.length-c-1].width;let g=[],m=!0;for(s.reverse();m;){const e="".concat(i[i.length-1]).split("");let t="",r=s.length-c-1;g=[];for(let n=0;n<e.length;n++){const o=t+e[n];if(this.ctx.measureText(o).width>s[r].width){if(g.push({text:t,x:s[r].x,y:s[r].y,width:s[r].width,height:s[r].height,options:Object.assign(Object.assign({},h),{textAlign:"left",verticalAlign:"middle"})}),t=e[n],r++,!s[r])break}else t=o}t&&r<s.length&&g.push({text:t,x:s[r].x,y:s[r].y,width:s[r].width,height:s[r].height,options:Object.assign(Object.assign({},h),{textAlign:"left",verticalAlign:"middle"})}),t&&r>=s.length||t&&this.ctx.measureText(t).width>s[r].width?c++:m=!1,c>=s.length&&(m=!1)}g.forEach((e=>{const{text:t,x:r,y:n,width:o,height:i,options:a}=e;this.text(t,r,n,o,i,a)}))}if(0!==c&&i.length>2){const r=f[c-1];if(o){const o=Math.atan(Math.abs((r[1][1]-r[0][1])/(r[1][0]-r[0][0]))),a=Math.atan(Math.abs((s[1][1]-s[0][1])/(s[1][0]-s[0][0]))),l=Math.abs(p/2/Math.sin((a-o)/2));this.ctx.save(),this.ctx.translate(e+Math.cos(o)*l,t+n-Math.sin(o)*l),this.ctx.rotate(-(o+(a-o)/2)),this.text("".concat(i[c]),0,0,this.ctx.measureText("".concat(i[c])).width,p,Object.assign(Object.assign({},h),{textAlign:"left",verticalAlign:"middle"})),this.ctx.restore()}else{const n=Math.atan((r[1][1]-r[0][1])/(r[1][0]-r[0][0])),o=Math.atan((s[1][1]-s[0][1])/(s[1][0]-s[0][0])),a=p/2/Math.sin((o-n)/2);this.ctx.save(),this.ctx.translate(e+Math.cos(n)*a,t+Math.sin(n)*a),this.ctx.rotate(n+(o-n)/2),this.text("".concat(i[c]),0,0,this.ctx.measureText("".concat(i[c])).width,p,Object.assign(Object.assign({},h),{textAlign:"left",verticalAlign:"middle"})),this.ctx.restore()}}})),this.ctx.restore()}drawCurrencyLine(e,t,r,n,o,i,a){const{intPart:s,deciPart:l}=o,c=s+l,u=r/c,d="#8e877e",h="#2df713",p="#fe1713",f=(e,r)=>{this.drawLine(r+u,t,r+u,t+n,{color:e,lineWidth:1})},g=i.split(".")[0];i=i.replace(".","");const m=g.length<s?s-g.length:0;for(let y=0;y<c;y++){const r=y-m;if(r>=0&&i.length>r){const o=i.substring(r,r+1);a.textAlign="center",this.text(o,e,t,u,n,a)}y+1!==c&&f(y+1===s?p:(y+1)%3==0?h:d,e),e+=u}}drawSelf(e,t,r,n,o,i){if(0===o||0===i)return;e=Math.floor(e*this.pixelRatio),t=Math.floor(t*this.pixelRatio),r=Math.floor(r*this.pixelRatio),n=Math.floor(n*this.pixelRatio),o=Math.ceil(o*this.pixelRatio),i=Math.ceil(i*this.pixelRatio),o=Math.min(o,this.canvas.width-r,this.canvas.width-e),i=Math.min(i,this.canvas.height-n,this.canvas.height-t),this.ctx.save();const a=this.getCacheCanvas(),s=this.getCacheContext();s.save(),s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,a.width,a.height),s.drawImage(this.canvas,e,t,o,i,r,n,o,i),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(r,n,o,i),this.ctx.drawImage(a,r,n,o,i,r,n,o,i),s.restore(),this.ctx.restore()}drawImage(e,t,r,n,o,i="center",a={}){switch(this.ctx.save(),this.ctx.beginPath(),a.radiusConfig?this.drawRadiusRect(t,r,n,o,a.radiusConfig):this.ctx.rect(t,r,n,o),this.ctx.clip(),"default"===i&&(i=e.width>n||e.height>o?"repeat":"center"),e.width===n&&e.height===o&&(this.ctx.imageSmoothingEnabled=!1),i){case"center":this.ctx.drawImage(e,0,0,e.width,e.height,t+(n-e.width||1)/2,r+(o-e.height||1)/2,e.width,e.height);break;case"stretch":this.ctx.drawImage(e,0,0,e.width,e.height,t,r,n,o);break;case"adapt":const i=o*(e.width/e.height),a=n*(e.height/e.width);i<=n?this.ctx.drawImage(e,t+(n-i)/2,r,i,o):a<=o&&this.ctx.drawImage(e,t,r+(o-a)/2,n,a);break;case"repeat":const s=this.ctx.createPattern(e,"repeat");this.ctx.fillStyle=s,this.ctx.translate(t,r),this.ctx.fillRect(0,0,n,o)}this.ctx.restore()}draw(e,t){const{type:r,x:n,y:o,x1:i,y1:a,text:s,width:l,height:c,image:u,imageLayout:d,options:h}=e;switch(r){case"text":const{wrap:e,lineHeight:r}=h;"wrap"===e?this.wrapText({text:s,x:n,y:o,width:l,height:c,lineHeight:parseFloat(r),options:h},t):this.drawText(s,n,o,l,c,h);break;case"rect":this.drawRect(n,o,l,c,h);break;case"line":this.drawLine(n,o,i,a,h);break;case"image":this.drawImage(u,n,o,l,c,d)}}clear(e=0,t=0,r=this.canvas.clientWidth,n=this.canvas.clientHeight){this.ctx.clearRect(e,t,r,n)}clip(e,t,r,n,o){if(0===r||0===n)return o&&o();this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(e,t,r,n),this.ctx.clip(),o&&o(),this.ctx.restore()}getDefaultFont(){const e=window.getComputedStyle(this.canvas);return"".concat(e.fontStyle," ").concat(e.fontWeight," ").concat(e.fontSize," ").concat(e.fontFamily)}resize(e,t){resizeCanvas(this.canvas,this.pixelRatio,e,t),this.cacheCanvas&&resizeCanvas(this.cacheCanvas,this.pixelRatio,e,t)}linePath(e){if(e.length>1){const[t,r]=e[0];this.ctx.moveTo(t,r);for(let n=1;n<e.length;n++)this.ctx.lineTo(e[n][0],e[n][1]);this.ctx.stroke()}}text(e,t,r,n,o,i,a){this.ctx.save();const s=r,{clip:l,color:c="",verticalAlign:u,textAlign:d,fontWeight:h=400,fontSize:p="12px",fontFamily:f="sans-serif",fontStyle:g="normal",textShadow:m,subscript:y,supscript:v,lineHeight:_,rotate:b}=i;c&&(this.ctx.fillStyle=c),setCtxFont(this.ctx,{fontFamily:f,fontSize:p,fontStyle:g,fontWeight:h}),l&&(this.ctx.beginPath(),this.ctx.rect(t,r,n,o),this.ctx.clip()),m&&(this.ctx.shadowColor=m.shadowColor,this.ctx.shadowOffsetX=m.shadowOffsetX,this.ctx.shadowOffsetY=m.shadowOffsetY,this.ctx.shadowBlur=m.shadowBlur);const C=this.ctx.measureText(e),{baseline:E}=getMetrics({fontFamily:f,fontSize:p});let T=C.width;if(b){const{baseX:i,baseY:a,textBaseline:s,textAlign:l}=getRotatePosition({x:t,y:r,width:n,height:o,rotate:b,textAlign:d,boundsWidth:C.width,baseline:E});this.ctx.textAlign=l,this.ctx.translate(i,a),this.ctx.textBaseline=s,this.ctx.rotate(-b*Math.PI/180),this.ctx.fillText(e,0,0)}else{if(v)this.ctx.textBaseline="top",r-=o/2-E;else if(y)this.ctx.textBaseline="bottom",r=r+o+(o/2-E);else switch(u){case"top":this.ctx.textBaseline="top";break;case"middle":this.ctx.textBaseline="middle",r+=o/2;break;case"bottom":this.ctx.textBaseline="bottom",r+=o}switch(d){case"center":t=t+n/2-C.width/2;break;case"left":break;case"right":t=t+n-C.width}if("distributed"===d&&e.length>1){const o=(n-C.width)/(e.length-1);let i=t;e.split("").forEach((e=>{this.ctx.fillText(e,i,r),a&&a({text:e,x:i,y:s,width:this.ctx.measureText(e).width,height:_}),i=i+this.ctx.measureText(e).width+o})),T=n}else{let n=t;"".concat(e).split("").forEach((e=>{a&&a({text:e,x:n,y:s,width:this.ctx.measureText(e).width,height:_}),n+=this.ctx.measureText(e).width})),this.ctx.fillText(e,t,r)}}this.drawUnderline(t,r+parseFloat(E),t+T,r+parseFloat(E),i),this.drawStrikeThrough(t,r+parseFloat(p)/20,t+T,r+parseFloat(p)/20,i),this.ctx.restore()}getVisualRangeText(e,t,r){if(t<=0)return"";if(this.ctx.measureText(e).width<=t)return e;const n=this;return function o(i,a){const s=Math.floor((i+a)/2),l=e.substring(0,s)+r,c=e.substring(0,s+1)+r,u=n.ctx.measureText(l).width;return u===t||0===s?l:u>t?o(i,a=s-1):n.ctx.measureText(c).width>t?l:o(i=s+1,a)}(0,e.length)}textVertical(e,t,r,n,o,i,a){this.ctx.save();const{lineHeight:s,color:l,textShadow:c}=i;l&&(this.ctx.fillStyle=l),c&&(this.ctx.shadowColor=c.shadowColor,this.ctx.shadowOffsetX=c.shadowOffsetX,this.ctx.shadowOffsetY=c.shadowOffsetY,this.ctx.shadowBlur=c.shadowBlur),e.split("").forEach((e=>{const o=this.ctx.measureText(e);r+=s,this.ctx.fillText(e,t+n/2-o.width/2,r),a&&a({word:e,x:t+n/2-o.width/2,y:r-2*s/3,width:o.width,height:s})})),this.ctx.restore()}drawUnderline(e,t,r,n,o){const{underline:i}=o;i&&i.width>0&&this.drawLine(e,t,r,n,{lineWidth:i.width,color:i.color,lineDash:i.dash,lineStyle:i.style})}drawStrikeThrough(e,t,r,n,o){const{strikeThrough:i,fontSize:a,color:s}=o;"solid"===i&&this.drawLine(e,t,r,n,{lineWidth:parseFloat(a)/10,color:s})}getCacheCanvas(){if(!this.cacheCanvas){this.cacheCanvas=document.createElement("canvas"),this.cacheCanvas.width=this.canvas.width,this.cacheCanvas.height=this.canvas.height;this.cacheCanvas.getContext("2d").setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}return this.cacheCanvas}getCacheContext(){return this.getCacheCanvas().getContext("2d")}makeLineTextOpts(e,t,r,n,o,i,a,s){const{newLine:l}=s;let c=[],u=0;switch(l){case"SINGLE_LINE_ADJUST_FONT":u=o/this.ctx.measureText(t).width*parseFloat(e),1.2*u+10>i&&(u=(i-10)/1.2),e="".concat(u,"px"),c=[{text:t,x:r,y:n,width:o,height:a=1.2*u,options:s}];break;case"MULTI_LINE_ADJUST_FONT":const l=128/72;u=parseFloat(e)/l;const d=o*l;c=this.makeTextOpts(t,r,n,d,i,a,s),a=i/c.length,c=this.makeTextOpts(t,r,n,d,i,a,s),c.forEach((e=>{e.width=o})),e="".concat(u,"px");break;default:c=this.makeTextOpts(t,r,n,o,i,a,s)}return{textOpts:c,fontSize:e,lineHeight:a}}makeVerticalWrap(e,t,r,n,o,i,a){const{newLine:s,verTextDirection:l,autoWrapInfo:c}=a,u=i,d=[];if("SINGLE_LINE"===s)return[{text:e.substring(0,c[0]),x:t,y:r,width:u,height:o,options:a}];let h=divideTextByWrapInfo(e,c);return"RIGHT_TO_LEFT"===l&&(h=h.reverse()),h.forEach((e=>{d.push({text:e,x:t,y:r,width:u,height:o,options:a}),t+=i})),d}makeVerticalOpts(e,t,r,n,o,i,a){const{newLine:s,verTextDirection:l}=a,c=Math.floor(o/i),u=[],d=i;if("SINGLE_LINE"===s)return[{text:e.substring(0,c),x:t,y:r,width:d,height:o,options:a}];let h=[];return e.split("\n").forEach((e=>{let t=e;for(;""!==t;)t.length>c?(h.push(t.substring(0,c)),t=t.substring(c)):(h.push(t),t="")})),"RIGHT_TO_LEFT"===l&&(h=h.reverse()),h.forEach((e=>{u.push({text:e,x:t,y:r,width:d,height:o,options:a}),t+=i})),u}makeSingleLineOpts(e,t,r,n,o,i,a){const{overflowHide:s,hideType:l,appendTailStr:c,hideStrLength:u}=a;let d=e.split("\\n")[0];if(s)switch(l){case"CHAR_LENGTH":d=d.length<=u?d:d.substring(0,u)+c;break;case"CELL_WIDTH":d=this.getVisualRangeText(d,n,c)}else d=this.getVisualRangeText(d,n,"");return[this.newLine(d,t,r,n,o,i,a)]}newLine(e,t,r,n,o,i,a){return{text:e,x:t,y:r,width:n,height:i,options:a}}makeTextOpts(e,t,r,n,o,i,a){const{autoWrapInfo:s}=a;return s?this.makeTextOptsByWrapInfo(e,t,r,n,o,i,a):this.makeTextOptsByWrapAuto(e,t,r,n,o,i,a)}makeTextOptsByWrapInfo(e,t,r,n,o,i,a){const{newLine:s,verticalText:l,cellJust:c,rotate:u,autoWrapInfo:d}=a;if(0!==u)return[this.newLine(e,t,r,n,o,i,a)];if("VERTICAL_TEXT"===l)return this.makeVerticalWrap(e,t,r,n,o,i,a);if("SINGLE_LINE"===s||"NONE"===c)return[this.newLine(e.substring(0,d[0]),t,r,n,o,i,a)];const h=divideTextByWrapInfo(e,d),p=[];return h.forEach((e=>{p.push(this.newLine(e,t,r,n,o,i,a)),r+=i})),p}makeTextOptsByWrapAuto(e,t,r,n,o,i,a){const{newLine:s,verticalText:l,cellJust:c,rotate:u}=a;if(0!==u)return[this.newLine(e,t,r,n,o,i,a)];if("VERTICAL_TEXT"===l)return this.makeVerticalOpts(e,t,r,n,o,i,a);if("SINGLE_LINE"===s||"NONE"===c)return this.makeSingleLineOpts(e,t,r,n,o,i,a);const d=divide(e);let h="";const p=[];return d.forEach((e=>{const s=h+e,l=this.ctx.measureText(s).width;if("\n"===e)p.push(this.newLine(h,t,r,n,o,i,a)),h="",r+=i;else if(l<=n)h=s;else if(""!==h&&(p.push(this.newLine(h,t,r,n,o,i,a)),h="",r+=i),this.ctx.measureText(e).width/n>1){const s="".concat(e).split("");for(let e=0;e<s.length;e++){const l=h+s[e];this.ctx.measureText(l).width>=n?(""!==h&&(p.push(this.newLine(h,t,r,n,o,i,a)),r+=i),h=s[e]):h=l}}else h=e})),p.push(this.newLine(h,t,r,n,o,i,a)),p}}function canvas(e,t){const r=h$1("canvas","sheet-table-canvas"),n=e.offset(),{width:o=n.width,height:i=n.height}=t,a=r.el;e.children(a);const s=t.minDpr?Math.max(dpr(),t.minDpr):dpr();return a.width=o*s,a.height=i*s,r.offset({width:o,height:i}),new FineCanvas(a,t)}function initRenderer(e,t={}){return canvas(e,t)}function drawBackground(e,t,r){const n=e.backgroundColor&&!e.backgroundColor.isTransparent(),o=e.backgroundImage&&e.backgroundSize;let i={};if(n&&(i={type:"rect",x:e.left,y:e.top,width:e.width,height:e.height,options:{fillColor:e.backgroundColor.toString()}}),o){const t=getImageData(e.backgroundImage);t?i={type:"image",x:e.left,y:e.top,width:e.width,height:e.height,image:t,imageLayout:e.backgroundSize}:loadImage(e.backgroundImage).then(debounce((()=>{r()})))}t.draw(i)}function createBorder(e,t,r,n,o){function i(e,t,r,n,o=0){o=o*Math.PI/180;const i=Math.cos,a=Math.sin;return[(e-r)*i(o)-(t-n)*a(o)+r,(e-r)*a(o)+(t-n)*i(o)+n]}if(o.rotate){const[a,s]=o.center,l=i(e,t,a,s,o.rotate),c=i(r,n,a,s,o.rotate);e=l[0],t=l[1],r=c[0],n=c[1]}return{type:"line",x:e,y:t,x1:r,y1:n,options:o}}function draweBorders(e,t){const{top:r,left:n,width:o,height:i}=e,a=[n+o/2,r+i/2],s=[];e.borderTopStyle&&!e.borderTopColor.isTransparent()&&s.push(createBorder(n,r,n+o,r,{color:e.borderTopColor.toString(),lineWidth:e.borderTopWidth,lineStyle:e.borderTopStyle,rotate:e.rotate,center:a})),e.borderBottomStyle&&!e.borderBottomColor.isTransparent()&&s.push(createBorder(n,r+i,n+o,r+i,{color:e.borderBottomColor.toString(),lineWidth:e.borderBottomWidth,lineStyle:e.borderBottomStyle,rotate:e.rotate,center:a})),e.borderLeftStyle&&!e.borderLeftColor.isTransparent()&&s.push(createBorder(n,r,n,r+i,{color:e.borderLeftColor.toString(),lineWidth:e.borderLeftWidth,lineStyle:e.borderLeftStyle,rotate:e.rotate,center:a})),e.borderRightStyle&&!e.borderRightColor.isTransparent()&&s.push(createBorder(n+o,r,n+o,r+i,{color:e.borderRightColor.toString(),lineWidth:e.borderRightWidth,lineStyle:e.borderRightStyle,rotate:e.rotate,center:a})),s.forEach((e=>{e&&t.draw(e)}))}function drawBackgroundAndBorders(e,t,r){const n=e.getStyle();drawBackground(n,t,r),draweBorders(n,t)}function getWidgetOverflowConfig(e){return e.props?e.props.overflowConfig:{}}function drawConetent(e,t,r){const n=e.getText();if(null==n||""===n)return;const o=e.getStyle(),{top:i,left:a,width:s,height:l,textAlign:c,verticalAlign:u,color:d}=o;t.draw({type:"text",text:"".concat(n),x:a,y:i,width:s,height:l,options:Object.assign(Object.assign(Object.assign({},o),{wrap:"wrap",textAlign:c||"center",verticalAlign:u||"middle",color:"".concat(d),clip:!0}),getWidgetOverflowConfig(e))},r)}function renderComponent(e,t,r,n){let o=[createWidget(e)];for(;o.length>0;){const e=o.shift();e&&(drawBackgroundAndBorders(e,t,r),drawConetent(e,t,n),o=o.concat(e.getChildren()||[]))}}class Table{constructor(e,t){this.reRender=()=>{this.renderGrid(),this.renderSequnce(),this.renderFreeze()},this.render=()=>{this.renderStickers(),this.reRender()},this.refresh=()=>{this.clear(),this.renderGrid()},this.resize=()=>{this.renderer.resize(this.data.width+this.data.offset.offsetX,this.data.height+this.data.offset.offsetY)},this.debounceRender=debounce((()=>{this.render()}),50),this.el=h$1("div","sheet-table"),this.data=e,this.container=t,this.renderer=initRenderer(this.el,{width:e.width+e.offset.offsetX,height:e.height+e.offset.offsetY,minDpr:e.options.minDpr})}renderSequnce(){const e=this.data.offset.offsetX,t=this.data.offset.offsetY;this.renderer.clear(0,0,this.data.width+e,t),this.renderer.clear(0,0,e,this.data.height+t);const r=this.data.getSequnceCells();this.clearBorderSet(),r.forEach((e=>{this.renderContent(e),this.renderBorder(e)})),this.clearBorderSet()}scroll(e,t){const r=Math.ceil(isNaN(t)?0:t),n=Math.ceil(isNaN(e)?0:e);if(!n&&!r)return;if(n!==r&&(n===(r||n)||r===(n||r))&&!this.data.options.disableScrollCache){const e=this.data.getRenderBounds(r?"vertical":"horizontal"),t={x:Math.ceil(e.x),y:Math.ceil(e.y),width:Math.ceil(e.width),height:Math.ceil(e.height)},{cacheBounds:o,canvasBounds:i,renderBounds:a}=this.getReRenderBounds(n,r,t);this.clip(t.x,t.y,t.width,t.height,(()=>{this.drawSelf(o.x,o.y,i.x,i.y,i.width,i.height),this.clip(a.x,a.y,a.width,a.height,(()=>{this.clear(),this.rerenderBounds(a.x,a.y,a.width,a.height)}))})),this.renderSequnce(),this.renderFreeze()}else this.reRender()}getReRenderBounds(e,t,r){let n,o,i;if(t<0&&(n={x:r.x,y:r.y,width:r.width,height:r.height+t},o={x:r.x,y:r.y-t,width:r.width,height:r.height+t},i={x:r.x,y:r.y,width:r.width,height:r.height-o.height+1*dpr()}),t>0){const e=clamp(r.width-r.x,0,r.width),a=clamp(r.height-r.y-t,0,r.height);n={x:r.x,y:r.y+t,width:e,height:a},o={x:r.x,y:r.y,width:e,height:a},i={x:r.x,y:o.y+o.height,width:r.width,height:r.height-o.height}}if(e<0&&(n={x:r.x,y:r.y,width:r.width+e,height:r.height},o={x:r.x-e,y:r.y,width:r.width+e,height:r.height},i={x:r.x,y:r.y,width:r.width-o.width+1*dpr(),height:r.height}),e>0){const t=clamp(r.width-r.x-e,0,r.width),a=clamp(r.height-r.y,0,r.height);n={x:r.x+e,y:r.y,width:t,height:a},o={x:r.x,y:r.y,width:t,height:a},i={x:o.x+o.width-1*dpr(),y:r.y,width:r.width-o.width+1*dpr(),height:r.height}}return{cacheBounds:n,canvasBounds:o,renderBounds:i}}clip(e,t,r,n,o){const{offsetX:i,offsetY:a}=this.data.offset;this.renderer.clip(e+i,t+a,r,n,o)}clear(e,t,r,n){const{offsetX:o,offsetY:i}=this.data.offset;this.renderer.clear(e&&e+o,t&&t+i,r,n)}drawSelf(e,t,r,n,o,i){const{offsetX:a,offsetY:s}=this.data.offset;this.renderer.drawSelf(e+a,t+s,r+a,n+s,o,i)}renderFreeze(){this.data.getFreezeBounds().forEach((({x:e,y:t,width:r,height:n})=>{if(r>0&&n>0){const o=this.data.getCellsInBounds(e,t,r,n);this.clip(e,t,r,n,(()=>{this.clear(),o.forEach((e=>{this.renderContent(e)}))})),this.clip(e,t,r+1,n+1,(()=>{this.clearBorderSet(),o.forEach((e=>{this.renderBorder(e)}))}))}}))}rerenderBounds(e,t,r,n){this.data.spliteBounds(e,t,e+r,t+n).forEach((({x:e,y:t,width:r,height:n})=>{r<=0||n<=0||this.clip(e,t,r,n,(()=>{const o=this.data.getCellsInBounds(e,t,r,n);o.forEach((e=>{this.renderContent(e)})),this.clearBorderSet(),o.forEach((e=>{this.renderBorder(e)}))}))})),this.clearBorderSet()}clearBorderSet(){this.cacheBorderSet=new Set,this.cacheBorderPosition=new Set}renderGrid(){this.clear(0,0,this.data.width,this.data.height),this.rerenderBounds(0,0,this.data.width,this.data.height)}renderContent(e){e.ci<this.data.view.colc&&e.ri<this.data.view.rowc&&this.renderCellComponent(e)}renderCell(e){const t=Object.assign(Object.assign({},e),this.data.correctBounds(e)),r=this.data.getQuadrantBounds(e.x,e.y);let n=this.data.getCell(e.ri+e.rp+1,e.ci);n=Object.assign(Object.assign(Object.assign({},n),this.data.correctBounds(n)),{borderStyle:n.borderStyle?{borderTop:n.borderStyle.borderTop}:{}});let o=this.data.getCell(e.ri,e.ci+e.cp+1);o=Object.assign(Object.assign(Object.assign({},o),this.data.correctBounds(o)),{borderStyle:o.borderStyle?{borderTop:o.borderStyle.borderLeft}:{}}),this.clip(r.x,r.y,r.width,r.height,(()=>{this.clear(t.x,t.y,t.width,t.height),this.renderContent(t),this.renderCellBorder(t),this.renderCellBorder(n),this.renderCellBorder(o)}))}renderBorder(e){e.ci<this.data.view.colc&&e.ri<this.data.view.rowc&&this.renderCellBorder(e)}renderCellComponent(e){const{width:t,height:r}=e;if(0===t||0===r)return;e.x+=this.data.offset.offsetX,e.y+=this.data.offset.offsetY;const n=[];this.renderCellBg(e),e.stick?this.container.stickCell(e.ri,e.ci,e.init):renderComponent(e,this.renderer,this.debounceRender,(t=>{const r=this.data.view.getViewData();if(r[e.ri]&&r[e.ri][e.ci]){const o=r[e.ri][e.ci],i=Object.assign(Object.assign({},t),{x:t.x-e.x,y:t.y-e.y});n.push(i),o.textArea=n}}))}renderCellBorder(e){var t;const{borderStyle:r={}}=e,n=null===(t=null==e?void 0:e.backgroundStyle)||void 0===t?void 0:t.backgroundColor,{x:o,y:i,width:a,height:s}=e;if(a<=0||s<=0)return;const{borderTop:l,borderLeft:c,borderBottom:u,borderRight:d}=r;this.renderCellBorderLine(o,i,o+a,i,l,n),this.renderCellBorderLine(o,i+s,o+a,i+s,u,n),this.renderCellBorderLine(o,i,o,i+s,c,n),this.renderCellBorderLine(o+a,i,o+a,i+s,d,n)}renderCellBorderLine(e,t,r,n,o,i){const a="".concat(e,"-").concat(t,"-").concat(r,"-").concat(n);if((null==o?void 0:o.width)>0){const i="".concat(e,"-").concat(t,"-").concat(r,"-").concat(n,"-").concat(o.width,"-").concat(o.color);this.cacheBorderSet.has(i)||(this.renderer.drawLine(e,t,r,n,{color:o.color,lineWidth:o.width,lineStyle:o.style,lineDash:o.dash}),this.cacheBorderSet.add(i),this.cacheBorderPosition.add(a))}else if(i&&!this.cacheBorderSet.has(a)){let o=!1,a=0;this.cacheBorderSet.forEach((i=>{if(o)return;const[s,l,c,u,d]=i.split("-"),h=1e4,p=Math.floor(Number(s)*h)/h,f=Math.floor(Number(l)*h)/h,g=Math.floor(Number(c)*h)/h,m=Math.floor(Number(u)*h)/h,y=Math.floor(e*h)/h,v=Math.floor(t*h)/h,_=Math.floor(r*h)/h,b=Math.floor(n*h)/h;o=isPointOnLine(p,f,g,m,y,v)&&isPointOnLine(p,f,g,m,_,b)||isPointOnLine(e,t,r,n,p,f)&&isPointOnLine(e,t,r,n,g,m);const C=isPointOnLine(p,f,g,m,y,v),E=isPointOnLine(p,f,g,m,_,b);C&&!E&&f===m&&b!==m&&(a=~~d,t+=a),!C&&E&&f===m&&v!==m&&(a=~~d,n-=a),C&&!E&&p===g&&_!==g&&(a=~~d,e+=a),!C&&E&&p===g&&y!==g&&(a=~~d,r-=a)})),o||this.renderer.drawLine(e,t,r,n,{color:i,lineWidth:1,lineStyle:"solid",lineDash:[]})}}renderCellBg(e){const{bias:t,style:r={},backgroundStyle:n={},currencyLineAttr:o,value:i}=e,{x:a,y:s,width:l,height:c}=e;if(l<=0||c<=0)return;const{backgroundColor:u,backgroundImage:d,linearGradient:h,backgroundImageLayout:p}=n;if(h)this.renderer.drawRect(a,s,l,c,{linearGradient:h,radiusConfig:n.radiusConfig});else if(d){const e=getImageData(d);e?this.renderer.drawImage(e,a,s,l,c,p,{radiusConfig:n.radiusConfig}):loadImage(d).then(this.debounceRender)}else u&&this.renderer.drawRect(a,s,l,c,{fillColor:u,radiusConfig:n.radiusConfig});t&&this.renderer.drawBias(a,s,l,c,t.backslash,t.texts,r),o&&this.renderer.drawCurrencyLine(a,s,l,c,o,i,r)}renderStickers(){this.data.getStickers().forEach((e=>{"delete"===e.tag?this.container.tearSticker(e.id):this.container.stick(e,e.init)}))}}class OB{constructor(){this.eventMap={}}on(e,t){this.eventMap[e]=this.eventMap[e]||[],this.eventMap[e].push(t)}off(e,t){this.eventMap[e]=this.eventMap[e]||[];const r=this.eventMap[e].indexOf(t);-1!==r&&this.eventMap[e].splice(r,r)}emit(e,t=[]){this.eventMap[e]&&this.eventMap[e].forEach((e=>{e.call(null,...t)}))}}var WheelMode,WheelMode2;WheelMode2=WheelMode||(WheelMode={}),WheelMode2[WheelMode2.WHEELMODE_FOCUS=0]="WHEELMODE_FOCUS",WheelMode2[WheelMode2.WHEELMODE_WHEEL=1]="WHEELMODE_WHEEL";const DEFAULT_BORDER_OPTIONS={borderTop:!1,borderBottom:!1,borderLeft:!1,borderRight:!1};class Grid extends OB{constructor(e){super(),this.focusMode=0,this.activeAreas=new Set,this.width=0,this.height=0;const{width:t=0,height:r=0,scrollTop:n=0,scrollLeft:o=0,cls:i="",totalWidth:a,totalHeight:s,top:l=0,left:c=0}=e;this.el=h$1("div","grid-container ".concat(i)),this.scrollTopDelta=0,this.scrollLeftDelta=0,this.scrollTop=n,this.scrollLeft=o,this.scrollEl=h$1("div","scrollable-grid"),this.scrollEl.offset({top:n,left:o,width:a||0,height:s||0}),this.width=t,this.height=r,this.el.offset({width:t,height:r,top:l,left:c}),this.on("wheelMode",(e=>{this.focusMode=e})),this.el.el.onscroll=()=>{this.el.el.clientHeight>0&&this.focusMode===WheelMode.WHEELMODE_FOCUS&&this.emit("focus",[this.el.el.scrollLeft,this.el.el.scrollTop])}}hideSelect(){}selectAreas(e,t){this.checkScrollElMounted(),(e||[]).forEach((e=>{this.selectArea(this.createActiveArea(),e,t)}))}selectArea(e,t,r){const{p:n,c:o,t:i,b:a,l:s,r:l}=e,{borderLeft:c,borderTop:u,borderRight:d,borderBottom:h}=Object.assign(Object.assign({},DEFAULT_BORDER_OPTIONS),r);!t||t.x<0||t.y<0||t.width<=0||t.height<=0?n.hide():(n.css({position:"absolute",top:"".concat(t.y,"px"),left:"".concat(t.x,"px"),width:"0px",height:"0px"}),o.offset({width:t.width,height:t.height}),i.offset({top:0,left:0,width:t.width}),i.css({display:u?"block":"none"}),a.offset({top:t.height,left:0,width:t.width}),a.css({display:h?"block":"none"}),s.offset({top:0,left:0,height:t.height}),s.css({display:c?"block":"none"}),l.offset({top:0,left:t.width,height:t.height}),l.css({display:d?"block":"none"}),n.show())}hideSelectAreas(){this.activeAreas.forEach((e=>{const{p:t,c:r,t:n,l:o,r:i,b:a}=e;[t,r,n,o,i,a].forEach((e=>{e&&(e.hide(),e.remove())}))})),this.activeAreas.clear()}scroll(e=this.scrollLeftDelta,t=this.scrollTopDelta){this.scrollTopDelta=t,this.scrollLeftDelta=e,this.el.scroll({top:Math.abs(t+this.scrollTop),left:Math.abs(e+this.scrollLeft)}),getComputedStyle(this.scrollEl.el).transform&&this.scrollEl.css("transform","none")}transformScrollEl(e,t){(this.scrollLeftDelta||this.scrollTopDelta)&&this.el.scroll({top:0,left:0}),this.scrollEl.css({transform:"translate(".concat(e,"px, ").concat(t,"px)")})}cloneChildEl(e){if(this.clonedScrollEl)return;const{totalWidth:t,totalHeight:r,x:n,y:o}=e,i=[],a=o||r,s=n||t;for(let l=0;l<this.scrollEl.el.children.length;l++){const e=this.scrollEl.el.children[l];if(parseInt(e.style.top,10)<a&&parseInt(e.style.left,10)<s){const a=e.cloneNode(!0);o&&(a.style.top="".concat(parseInt(a.style.top,10)+r,"px")),n&&(a.style.left="".concat(parseInt(a.style.left,10)+t,"px")),i.push(a)}}this.scrollEl.children(...i),this.clonedScrollEl=!0}cleanCloneChildEl(e){this.clonedScrollEl&&(this.scrollEl.remove(),this.scrollEl.offset({top:-e.top||0,left:-e.left||0}),this.clonedScrollEl=!1)}createActiveArea(){const e=h$1("div"),t=h$1("div","active-area"),r=h$1("div","range-border active-area-border"),n=h$1("div","range-border active-area-border"),o=h$1("div","range-border active-area-border"),i=h$1("div","range-border active-area-border");e.children(t,r,i,n,o),this.scrollEl.children(e);const a={p:e,c:t,t:r,l:n,r:o,b:i};return this.activeAreas.add(a),a}offset(e){const{width:t=0,height:r=0,scrollTop:n=0,scrollLeft:o=0,left:i=0,top:a=0}=e;this.width=t,this.height=r,this.el.offset({width:t,height:r,left:i,top:a}),this.scrollTop=n,this.scrollLeft=o,this.scroll()}updateScrollEl(e){const{totalWidth:t,totalHeight:r,top:n=0,left:o=0}=e;this.scrollEl.offset({width:t,height:r,top:n,left:o})}stick({top:e,left:t,el:r}){this.checkScrollElMounted(),this.el.removeClass("empty"),this.scrollEl.children(r),h$1(r).offset({top:e,left:t})}isStickerInRange(e){return inRange(e.top-this.scrollTop,-.25*this.height,1.25*this.height)&&inRange(e.left-this.scrollLeft,-.25*this.width,1.25*this.width)}checkScrollElMounted(){this.el.hasChild(this.scrollEl.el)||(this.el.children(this.scrollEl),0===this.scrollLeftDelta&&0===this.scrollTopDelta||this.scroll())}setWillChange(){this.scrollEl.css({willChange:"transform"})}remove(){this.scrollEl.remove()}}let Waffle=(()=>{class e extends OB{constructor(e){super(),this.el=h$1("div","grid-container"),isIE()&&getIEVersion()<=10&&this.el.addClass("ie10-below"),this.stickers={},this.digest(e),this.render()}render(){const{headWidth:e,headHeight:t,tailHeight:r,tailWidth:n}=this.freezeConfig,o=this.width-e-n,i=this.height-t-r;this.tGrid=new Grid({cls:"grid-container-top t-grid",width:this.width,height:t}),this.bGrid=new Grid({cls:"grid-container-bottom b-grid",width:this.width,height:i,top:t}),this.fGrid=new Grid({cls:"grid-container-footer f-grid",width:this.width,height:r,top:this.height-r}),this.tlGrid=new Grid({cls:"inline-grid tl-grid",width:e,height:t}),this.trGrid=new Grid({cls:"inline-grid tr-grid",width:o,height:t,scrollLeft:-e,totalWidth:this.totalWidth,totalHeight:t,left:e}),this.ttGrid=new Grid({cls:"inline-grid tt-grid",width:n,height:t}),this.blGrid=new Grid({cls:"inline-grid bl-grid",width:e,height:i,scrollTop:-t,totalWidth:this.width,totalHeight:this.totalHeight}),this.brGrid=new Grid({cls:"inline-grid br-grid",width:o,height:i,scrollLeft:-e,scrollTop:-t,totalWidth:this.totalWidth,totalHeight:this.totalHeight,left:e}),this.btGrid=new Grid({cls:"inline-grid bt-grid",width:n,height:i,scrollTop:-t,totalWidth:this.width,left:this.width-n,totalHeight:this.totalHeight}),this.flGrid=new Grid({cls:"inline-grid fl-grid",width:e,height:r}),this.frGrid=new Grid({cls:"inline-grid fr-grid",width:o,height:r,scrollLeft:-e,totalWidth:this.totalWidth-n,totalHeight:r,left:e}),this.ftGrid=new Grid({cls:"inline-grid ft-grid",width:n,height:r}),this.mountGrid(),this.on("wheelMode",(e=>{this.brGrid.emit("wheelMode",[e]),this.blGrid.emit("wheelMode",[e]),this.trGrid.emit("wheelMode",[e])})),this.brGrid.on("focus",((e,t)=>{this.emit("focus",[e,t])})),this.trGrid.on("focus",(e=>{this.emit("focus",[e])})),this.blGrid.on("focus",((e,t)=>{this.emit("focus",[void 0,t])}))}showSelectArea(e){this.hideSelectArea();const{headWidth:t,headHeight:r,tailHeight:n,tailWidth:o}=this.freezeConfig;let i=0,a=0;const{height:s,width:l}=this.wholeSheetBounds;e.forEach((e=>{const{x:c,y:u}=e[0];i=c-(l-o),a=u-(s-n),u<r?c<t?this.tlGrid.selectAreas([e[0]]):c>=l-o?this.ttGrid.selectAreas([Object.assign(Object.assign({},e[0]),{x:i})]):this.trGrid.selectAreas([e[0]]):u>=s-n?c<t?this.flGrid.selectAreas([Object.assign(Object.assign({},e[0]),{y:a})]):c>=l-o?this.ftGrid.selectAreas([Object.assign(Object.assign({},e[0]),{x:i,y:a})]):this.frGrid.selectAreas([Object.assign(Object.assign({},e[0]),{y:a})]):c<t?this.blGrid.selectAreas([e[0]]):c>=l-o?this.btGrid.selectAreas([Object.assign(Object.assign({},e[0]),{x:i})]):this.brGrid.selectAreas([e[0]])}))}hideSelectArea(){const{headWidth:e,headHeight:t,tailHeight:r,tailWidth:n}=this.freezeConfig;t&&(e&&this.tlGrid.hideSelectAreas(),this.trGrid.hideSelectAreas(),n&&this.ttGrid.hideSelectAreas()),e&&this.blGrid.hideSelectAreas(),this.brGrid.hideSelectAreas(),n&&this.btGrid.hideSelectAreas(),r&&(e&&this.flGrid.hideSelectAreas(),this.frGrid.hideSelectAreas(),n&&this.ftGrid.hideSelectAreas())}scroll(e,t){const{headWidth:r,headHeight:n,tailHeight:o,tailWidth:i}=this.freezeConfig;n&&this.trGrid.scroll(e,0),r&&this.blGrid.scroll(0,t),this.brGrid.scroll(e,t),i&&this.btGrid.scroll(0,t),o&&this.frGrid.scroll(e,0)}getGrids(){return[this.tlGrid,this.trGrid,this.ttGrid,this.blGrid,this.brGrid,this.btGrid,this.flGrid,this.frGrid,this.ftGrid]}update(e){this.digest(e);const{headWidth:t,headHeight:r,tailHeight:n,tailWidth:o}=this.freezeConfig,i=this.width-t-o,a=this.height-r-n;r&&(this.tGrid.offset({width:this.width,height:r}),t&&this.tlGrid.offset({width:t,height:r}),this.trGrid.updateScrollEl({totalWidth:this.totalWidth,totalHeight:r,left:-t}),this.trGrid.offset({width:i,height:r,left:t}),o&&this.ttGrid.offset({width:o,height:r,left:this.width-o})),this.bGrid.offset({width:this.width,height:a,top:r}),t&&this.blGrid.updateScrollEl({totalWidth:t,totalHeight:this.totalHeight,top:-r}),t&&this.blGrid.offset({width:t,height:a}),this.brGrid.updateScrollEl({totalWidth:this.totalWidth,totalHeight:this.totalHeight,top:-r,left:-t}),this.brGrid.offset({width:i,height:a,left:t}),this.btGrid.updateScrollEl({totalWidth:o,totalHeight:this.totalHeight,top:-r}),this.btGrid.offset({width:o,height:a,left:this.width-o}),n&&(this.fGrid.offset({width:this.width,height:n,top:this.height-n}),t&&this.flGrid.offset({width:t,height:n}),this.frGrid.updateScrollEl({totalHeight:n,totalWidth:this.totalWidth,left:-t}),this.frGrid.offset({width:i,height:n,left:t}),o&&this.ftGrid.offset({width:o,height:n,left:this.width-o})),this.mountGrid()}digest(e){const{width:t,height:r,freezeConfig:n,totalWidth:o,totalHeight:i,wholeSheetBounds:a}=e;this.width=t,this.height=r,this.freezeConfig=n,this.wholeSheetBounds=a,this.totalWidth=o,this.totalHeight=i}getResponseGrid(e,t){const{headWidth:r,headHeight:n,tailHeight:o,tailWidth:i}=this.freezeConfig,{width:a,height:s}=this.wholeSheetBounds;return t<n?e<r?this.tlGrid:e>=a-i?this.ttGrid:this.trGrid:t>=s-o?e<r?this.flGrid:e>=a-i?this.ftGrid:this.frGrid:e<r?this.blGrid:e>=a-i?this.btGrid:this.brGrid}stick({left:t,top:r,width:n,height:o,el:i,id:a=uuid(),lazy:s}){const l=this.getResponseGrid(t,r),c=h$1("div",e.STICKER_CONTAINER_CLASS_NAME);c.offset({width:n,height:o}),this.stickers[a]=c,i&&(isFunction$1(i)?i.call(null,c):c.html(i));const u={id:a,left:t,top:r,width:n,height:o,el:c.el},d=l.isStickerInRange(u),h=this;function p(){l.stick(h.getCorrectStick(u))}return!s&&p(),{id:a,mount:s?p:void 0,isInRange:d}}updateStick({left:e,top:t,width:r,height:n,id:o}){const i=this.getResponseGrid(e,t);return this.stickers[o]&&i.stick(this.getCorrectStick({id:o,left:e,top:t,width:r,height:n,el:this.stickers[o].el})),""}tear(e){this.stickers[e]&&(this.stickers[e].remove(),delete this.stickers[e])}getStick(e){return this.stickers[e]}clean(){this.el.hide();for(const[,e]of Object.entries(this.stickers))e.remove();this.el.show(),this.stickers={},this.tGrid.remove(),this.bGrid.remove(),this.fGrid.remove(),this.tlGrid.remove(),this.trGrid.remove(),this.ttGrid.remove(),this.blGrid.remove(),this.brGrid.remove(),this.btGrid.remove(),this.flGrid.remove(),this.frGrid.remove(),this.ftGrid.remove(),this.cleanCloneChildEl()}mountGrid(){const{headWidth:e,headHeight:t,tailHeight:r,tailWidth:n}=this.freezeConfig,o=[],i=[],a=[],s=[];t&&(e&&o.push(this.tlGrid.el),o.push(this.trGrid.el),n&&o.push(this.ttGrid.el),this.tGrid.el.children(...o),s.push(this.tGrid.el)),e&&i.push(this.blGrid.el),i.push(this.brGrid.el),n&&i.push(this.btGrid.el),this.bGrid.el.children(...i),s.push(this.bGrid.el),r&&(e&&a.push(this.flGrid.el),a.push(this.frGrid.el),n&&a.push(this.ftGrid.el),this.fGrid.el.children(...a),s.push(this.fGrid.el)),this.el.children(...s)}getCorrectStick(e){const{tailHeight:t,tailWidth:r}=this.freezeConfig,{width:n,height:o}=this.wholeSheetBounds,{left:i,top:a}=e;return i>=n-r&&(e.left=i-(n-r)),a>=o-t&&(e.top=a-(o-t)),e}transform(e,t){const{headWidth:r,headHeight:n,tailHeight:o,tailWidth:i}=this.freezeConfig;this.isWillChange||this.setWillChange(),n&&this.trGrid.transformScrollEl(e,0),r&&this.blGrid.transformScrollEl(0,t),this.brGrid.transformScrollEl(e,t),i&&this.btGrid.transformScrollEl(0,t),o&&this.frGrid.transformScrollEl(e,0)}cloneChildEl(e){const{x:t,y:r}=e;this.el.css({width:this.totalWidth+t,height:this.totalHeight+r}),this.brGrid.cloneChildEl(e)}cleanCloneChildEl(){const{headWidth:e,headHeight:t}=this.freezeConfig;this.brGrid.cleanCloneChildEl({top:t,left:e})}setWillChange(){this.brGrid.setWillChange(),this.isWillChange=!0}}return e.STICKER_CONTAINER_CLASS_NAME="waffle-borderless-sticker",e})();class ScrollBar{constructor(e){this.isOver=!1,this.autoShow=!0,this.minScrollBarLength=24,this.direction=e.direction,this.state=!1,this.position=0,this.startPosition=0,this.size=e.size,this.scrollSize=e.scrollSize,this.sliderSize=this.getScrollBarLength(),this.startTrigger=e.startScroll||emptyFn,this.scrollTrigger=e.onScoll||emptyFn,this.endTrigger=e.endScroll||emptyFn,this.el=h$1("div","sheet-scrollbar sheet-scrollbar-".concat(this.vertical()?"y":"x")),this.sliderEl=h$1("div","sheet-scrollbar-slider"),this.el.css(this.vertical()?"height":"width",px(e.size)),this.sliderEl.css(this.vertical()?"height":"width",px(this.sliderSize)),this.el.children(this.sliderEl),this._initEvent(),this.sliderEl.hide(),this.checkScrollSize()}_initEvent(){this.el.on("mousedown",(e=>{e.preventDefault()})),this.el.on("mouseover",(()=>{this.isOver=!0,this.checkScrollSize(),this.sliderEl.show()})),this.el.on("mouseleave",(()=>{this.isOver=!1,!this.state&&this._resetTimeout()})),this.sliderEl.on("mousedown",(e=>{this._startScroll(e),e.preventDefault()})),this.sliderEl.on("touchstart",(e=>{this.state=!0,this.sliderEl.show(),this._startScroll(e.targetTouches[0])})),this.sliderEl.on("mousemove",(e=>{this._scroll(e)})),this.sliderEl.on("touchmove",(e=>{this._scroll(e.targetTouches[0])})),this.sliderEl.on("touchend",(()=>{this.state=!1,this._resetTimeout()})),document.addEventListener("mousemove",(e=>{this._scroll(e)})),this.sliderEl.on("mouseup",(e=>{this._endScroll(e)})),document.addEventListener("mouseup",(e=>{this._endScroll(e)})),document.addEventListener("mouseleave",(e=>{this._endScroll(e)}))}_startScroll(e){this.startPosition=this.vertical()?e.clientY:e.clientX,this.state=!0,this.el.addClass("active"),this.startTrigger()}_scroll(e){if(!this.state)return;this.moveOutside&&(this.vertical()?this.startPosition=this.startPosition+e.clientY-this.cachePosition:this.startPosition=this.startPosition+e.clientX-this.cachePosition,this.moveOutside=!1);let t=0,r=0;this.vertical()?(r=e.clientY-this.startPosition+this.position,this.startPosition=e.clientY):(t=e.clientX-this.startPosition+this.position,this.startPosition=e.clientX),t=Math.round(Math.max(0,Math.min(t,this.size-this.sliderSize))),r=Math.round(Math.max(0,Math.min(r,this.size-this.sliderSize)));const n=this.position;this.position=t||r;const o=(this.position-n)*this.scrollSize/(this.size-this.sliderSize);this._scrollTo(t,r),0===o&&this.adjustScroll(t,r),this.scrollTrigger(this.vertical()?0:o,this.vertical()?o:0)}adjustScroll(e,t){const r=this.vertical()?t:e,n=this.vertical()?0:5,o=this.vertical()?5:0;0===r&&this.scrollTrigger(0-n,0-o),r===this.size-this.sliderSize&&this.scrollTrigger(n,o)}_endScroll(e){this.state&&(this.state=!1,this.el.removeClass("active"),this._resetTimeout(),this.endTrigger(),e.preventDefault())}_scrollTo(e=0,t=0){this.sliderEl.css({transform:"translate(".concat(px(e),", ").concat(px(t),")"),"-webkit-transform":"translate(".concat(px(e),", ").concat(px(t),")"),"-moz-transform":"translate(".concat(px(e),", ").concat(px(t),")"),"-o-transform":"translate(".concat(px(e),", ").concat(px(t),")"),"-ms-transform":"translate(".concat(px(e),", ").concat(px(t),")")})}checkScrollSize(){this.autoShow&&(this.scrollSize<=0?this.el.hide():this.el.show())}vertical(){return"vertical"===this.direction}inScrollBounds(e){const t=this.sliderSize/2,r=this.size-this.sliderSize/2,n=this.vertical()?e.clientY:e.clientX;return n>=t&&n<=r}_resetTimeout(){this.timer&&window.clearTimeout(this.timer),this.timer=this.sliderElHide()}scroll(e,t=!0){!this.isOver&&this.scrollSize>0&&t&&(this.sliderEl.show(),this._resetTimeout()),e=e*(this.size-this.sliderSize)/this.scrollSize;const r=this.vertical()?0:e,n=this.vertical()?e:0;this.position=e,this._scrollTo(r,n)}update(e){this.state=!1,this.startPosition=0,this.size=e.size,this.scrollSize=e.scrollSize,this.sliderSize=this.getScrollBarLength();const t=this.vertical()?0:Math.min(this.position,this.size-this.sliderSize),r=this.vertical()?Math.min(this.position,this.size-this.sliderSize):0;this.position=t||r,this.el.css(this.vertical()?"height":"width",px(e.size)),this.sliderEl.css(this.vertical()?"height":"width",px(this.sliderSize)),this._scrollTo(t,r),this.scrollTrigger(0,0,{force:!0}),this.checkScrollSize(),this.sliderEl.hide()}getScrollBarLength(){const e=Math.round(Math.pow(this.size,2)/(this.scrollSize+this.size));return this.size<this.minScrollBarLength?e:Math.max(e,this.minScrollBarLength)}setVisible(e){e?this.el.show():this.el.hide(),e?this.sliderEl.show():this.sliderEl.hide(),this.autoShow=!1}sliderElHide(){return window.setTimeout((()=>{!this.state&&this.autoShow&&this.sliderEl.hide()}),5e3)}}let moving=!1;class Resizer{constructor(e){this.onMouseDown=e=>{e.preventDefault(),e.stopPropagation(),moving=!0,this.prevX=0,this.prevY=0,this.distance=0,this.lineEl.show(),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp)},this.onMouseMove=e=>{if(e.preventDefault(),e.stopPropagation(),moving){const{prevX:t,prevY:r,min:n,max:o}=this,i=t?e.screenX-t:0,a=r?e.screenY-r:0;this.prevX=e.screenX,this.prevY=e.screenY,"vertical"===this.direction?(this.distance+=i,this.el.css("margin-left","".concat(clamp(this.distance,n,o),"px"))):(this.distance+=a,this.el.css("margin-top","".concat(clamp(this.distance,n,o),"px"))),e.preventDefault()}},this.onMouseUp=e=>{if(e.preventDefault(),e.stopPropagation(),moving){moving=!1,this.lineEl.hide();const e=parseFloat(this.el.css("margin-left"))||parseFloat(this.el.css("margin-top"));this.onResize&&this.onResize(this.rect,e,this.direction),this.el.css("margin-left","0px"),this.el.css("margin-top","0px"),this.distance=0,this.hide()}window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp)};const{direction:t="vertical",onResize:r}=e;this.direction=t,this.onResize=r,this.el=h$1("div","sheet-resizer ".concat(t)),this.hoverEl=h$1("div","sheet-resizer-hover"),this.lineEl=h$1("div","sheet-resizer-line"),this.el.children(this.hoverEl,this.lineEl),this.lineEl.hide(),this.hoverEl.on("mousedown",this.onMouseDown)}show(e,t,r){if(moving)return;this.rect=e;const{left:n,top:o,width:i,height:a}=e,s="vertical"===this.direction,{min:l=-1/0,max:c=1/0}=r;this.min=l,this.max=c,this.el.offset({left:s?n+i-5:n,top:s?o:o+a-5}).show();const u=s?5:i,d=s?a:5;this.hoverEl.offset({width:u,height:d}),this.lineEl.offset({top:s?a:3,left:s?3:i,width:t.width,height:t.height})}hide(){moving||this.el.offset({width:0,height:0}).hide()}}class ToolTip{constructor(){this.el=h$1("div","sheet-tooltip"),this.hideEl(),this.isShow=!1,document.body.appendChild(this.el.el)}show(e,t,r){let n=r+10,o=t+10;this.el.text(e);const i=this.el.el.clientWidth;let a=this.el.el.clientHeight;if(a>window.innerHeight){const e=t-10,i=window.innerWidth-t-10;e>i?(this.el.css("max-width","".concat(e,"px")),o=0):(this.el.css("max-width","".concat(i,"px")),o=t+10),a=this.el.el.clientHeight,n=r+10-a}else window.innerHeight-r<=a&&(n-=a+15),window.innerWidth-t<=i&&(o-=i+10);n=Math.max(n,0),o=Math.max(o,0),this.el.offset({left:o,top:n}),this.isShow||(this.isShow=!0,this.timeOut=setTimeout((()=>{this.showEl()}),900))}hide(){this.timeOut&&clearTimeout(this.timeOut),this.hideEl(),this.isShow=!1}showEl(){this.el.css("visibility","visible"),this.el.css("opacity","inherit")}hideEl(){this.el.css("visibility","hidden"),this.el.css("opacity","0")}tear(){document.body.removeChild(this.el.el)}}const MAX_SCROLL_DELTA=100;class Container extends OB{constructor(e,t){super(),this.stickerTimeouts=[],this.deltaXCache=0,this.deltaYCache=0,this.sync=!1,this.getPointByClient=(e,t)=>({x:e,y:t}),this.previousPosition=null,this.onMouseDown=e=>{const{x:t,y:r,clientX:n,clientY:o}=this.getPointInfo(e),i=this.getActiveCell(t,r);if(null===i||i.stopPropagation)return void(this.moving=0);const a=[i.ci,i.ri];if(this.moving=1,e.shiftKey){const[e]=this.data.selection.getRange();this.emit("select",[e[1],e[0],a[1],a[0],{x:t,y:r}]),this.showSelectArea()}else{if(2===e.button){if(window.setTimeout((()=>{this.emit("contextmenu",[n,o])}),0),this.moving=0,intersectRect([a,a],this.data.getSelectRange()))return;return this.emit("select",[a[1],a[0],void 0,void 0,{x:t,y:r}]),void this.showSelectArea()}this.emit("select",[a[1],a[0],void 0,void 0,{x:t,y:r}]),this.data.view.doMouseDown(e,{x:t,y:r,ri:i.ri,ci:i.ci},this.data.getPositionByOffset(t,r))}},this.onMouseMove=e=>{this.verticalScrollBar.scroll(this.data.scroll.y),this.horizontalScrollBar.scroll(this.data.scroll.x);const{x:t,y:r,clientX:n,clientY:o}=this.getPointInfo(e);if(n<=0&&o<=0)this.data.view.disHover();else{if(t<this.data.offset.offsetX||r<this.data.offset.offsetY){const e=this.data.getResizerCell(t,r);r>this.data.offset.offsetY&&(this.verticalResizer.hide(),this.horizontalResizer.show(e,{width:this.data.width,height:2},{min:-e.height})),t>this.data.offset.offsetX&&(this.verticalResizer.show(e,{width:2,height:this.data.height},{min:-e.width}),this.horizontalResizer.hide())}else{this.horizontalResizer&&this.horizontalResizer.hide(),this.verticalResizer&&this.verticalResizer.hide();const i=this.getActiveCell(t,r),a=this.data.getPositionByOffset(t,r);if(null===i)return null!==this.previousPosition&&(this.data.view.doMouseLeave(e,{x:t,y:r,ri:this.previousPosition.ri,ci:this.previousPosition.ci},a),this.previousPosition=null),this.toolTip.hide(),this.setMouseCursorByEvent(e,"default"),void this.data.view.disHover();const s={ri:i.ri,ci:i.ci};if(isEqual(this.previousPosition,s)||null===this.previousPosition||this.data.view.doMouseLeave(e,{x:t,y:r,ri:this.previousPosition.ri,ci:this.previousPosition.ci},a),this.previousPosition=s,this.moving){this.moving=2;const e=this.data.selection.getCell();this.emit("select",[e[1],e[0],i.ri,i.ci,{x:t,y:r}]),this.showSelectArea()}const l=this.data.view.getMergeCell(i.ri,i.ci);this.data.view.doHover(e,{x:t,y:r,ri:i.ri,ci:i.ci},a);const{x:c,y:u}=this.data.offset2Absolute({x:t,y:r},l),d=l.cursor||"default";this.data.view.isHoverText(l,c,u)?this.setMouseCursorByEvent(e,"default"===d?"text":d):this.setMouseCursorByEvent(e,d),l.title?this.toolTip.show(l.title,n,o):this.toolTip.hide()}this.emit("hover",[t,r])}},this.onMouseleave=e=>{const{x:t,y:r}=this.getPointInfo(e),n=this.data.getPositionByOffset(t,r);null!==this.previousPosition&&(this.data.view.doMouseLeave(e,{x:t,y:r,ri:this.previousPosition.ri,ci:this.previousPosition.ci},n),this.previousPosition=null),this.toolTip.hide()},this.onDoubleClick=e=>{this.setWheelMode(WheelMode.WHEELMODE_FOCUS);const{x:t,y:r}=this.getPointInfo(e),n=this.getActiveCell(t,r),o=this.data.getSelectCell();this.isDoubleClickable(t,r,o)||(this.emit("dblclick",[t,r]),n&&this.data.view.doDbClick(e,{x:t,y:r,ri:n.ri,ci:n.ci},this.data.getPositionByOffset(t,r)))},this.onMouseUp=e=>{this.setWheelMode(WheelMode.WHEELMODE_FOCUS);const{x:t,y:r}=this.getPointInfo(e),n=this.getActiveCell(t,r),o=this.data.selection.getCell();if(n&&(1===this.moving||2===this.moving&&n.ri===o[1]&&n.ci===o[0])&&!e.shiftKey&&2!==e.button){if(null===n||n.stopPropagation)return void(this.moving=0);2!==this.moving&&this.hideSelectArea(),this.data.view.doClick(e,{x:t,y:r,ri:n.ri,ci:n.ci},this.data.getRelativePositionByOffset(t,r))}else 0===this.moving&&(e.currentTarget===document||n||this.hideSelectArea());this.moving=0},this.resizeHandler=(e,t,r)=>{this.emit("resize",[e,t,r]),this.resize()},this.scrollHandler=(e,t,r={smooth:!1,force:!1})=>{if(0===e&&0===t&&!r.force)return!0;this.hideSelectArea(),this.scrollTimeout&&clearTimeout(this.scrollTimeout),r.smooth&&(e=Math.min(e,MAX_SCROLL_DELTA),t=Math.min(t,MAX_SCROLL_DELTA));const{x:n,y:o}=this.data.getScroll(),i=e,a=t;e+=this.deltaXCache,t+=this.deltaYCache;let s=this.data.correctDeltaX(e),l=this.data.correctDeltaY(t);s=i>0?Math.max(0,s):Math.min(0,s),l=a>0?Math.max(0,l):Math.min(0,l),this.deltaXCache=e-s,this.deltaYCache=t-l,this.scrollTimeout=setTimeout((()=>{this.deltaXCache=0,this.deltaYCache=0,this.showSelectArea()}),300);const c=Math.round(clamp(n+s,0,this.data.maxScrollX)),u=Math.round(clamp(o+l,0,this.data.maxScrollY));return(c===this.data.maxScrollX&&e>0||0===c&&e<0)&&(this.deltaXCache=0),(u===this.data.maxScrollY&&t>0||0===u&&t<0)&&(this.deltaYCache=0),Math.abs(s)>Math.abs(l)?this.emit("scroll",[c,"horizontal"]):this.emit("scroll",[u,"vertical"]),this.waffle.scroll(-c,-u),!(Math.abs(s)>Math.abs(l)?c<=0||c>=this.data.maxScrollX:u<=0||u>=this.data.maxScrollY)||0!==this.deltaXCache||0!==this.deltaYCache},this.el=h$1("div","grid-container"),this.data=e,this.cellCache=new Set,this.moving=0,this.sync=t.sync||!1,t.getPointByClient&&(this.getPointByClient=t.getPointByClient),this.supportCSSTransform=t.supportCSSTransform,this.disableWheel=t.disableWheel,this.initResizer(),this.initWaffle(),this.initScrollbar(),this.initTootip(),this.initEvent()}correctBounds(e){return Object.assign(Object.assign({},e),{x:e.x+this.data.offset.offsetX,y:e.y+this.data.offset.offsetY})}resize(){const{headHeight:e,headWidth:t,tailHeight:r,tailWidth:n}=this.data.view.freezeConfig;this.waffle.update({width:this.data.width+this.data.offset.offsetX,height:this.data.height+this.data.offset.offsetY,freezeConfig:{headHeight:e+this.data.offset.offsetY,headWidth:t+this.data.offset.offsetX,tailHeight:r,tailWidth:n},wholeSheetBounds:this.getWholeSheetBounds4Render(),totalWidth:this.data.view.totalWidth,totalHeight:this.data.view.totalHeight}),this.showSelectArea(),this.updateStickCells(),this.updateScrollBar(),this.whellScroll(0,0)}reset(){this.resize(),this.clean()}stick(e,t){const r=e.id;if(this.cellCache.has(e.id))this.waffle.updateStick(e);else if(e.width>0&&e.height>0){e.left=e.left+this.data.offset.offsetX,e.top=e.top+this.data.offset.offsetY;const{id:n,mount:o,isInRange:i}=this.waffle.stick(e);if(this.cellCache.add(n),isFunction$1(t)){if(this.sync)return t(this.waffle.getStick(n),e.width,e.height,o,i),r;const a=window.setTimeout((()=>{t(this.waffle.getStick(n),e.width,e.height,o,i)}));this.stickerTimeouts.push(a)}}return r}tearSticker(e){this.waffle.tear(e)}tear(){this.toolTip.tear()}stickCell(e,t,r){const n="".concat(e,"-").concat(t),{el:o,width:i,height:a,x:s,y:l}=this.data.view.getMergeCell(e,t);return this.stick({el:o,width:i,height:a,left:s,top:l,id:n},r),n}whellScroll(e,t){const{x:r,y:n}=this.data.getScroll(),o=Math.round(clamp(r+e,0,this.data.maxScrollX)),i=Math.round(clamp(n+t,0,this.data.maxScrollY));return this.scrollHandler(e,t,{smooth:!1,force:!1}),this.verticalScrollBar.scroll(this.data.scroll.y,!1),this.horizontalScrollBar.scroll(this.data.scroll.x,!1),{scrollX:o,scrollY:i,maxScrollX:this.data.maxScrollX,maxScrollY:this.data.maxScrollY}}updateStickCells(){this.cellCache.forEach((e=>{const[t,r]=e.split("-");this.stickCell(~~t,~~r)}))}setWheelMode(e){this.waffle.emit("wheelMode",[e])}initEvent(){this.waffle.el.on("mouseover",(()=>{this.mountResizer(),this.mountScrollbar()})),this.waffle.el.on("contextmenu",(e=>e.preventDefault())),this.waffle.el.on("mousedown",this.onMouseDown),this.waffle.el.on("mouseup",this.onMouseUp),this.waffle.el.on("mousemove",this.onMouseMove),this.waffle.el.on("dblclick",this.onDoubleClick),this.waffle.el.on("mouseleave",this.onMouseleave),this.waffle.el.on("wheel",(e=>{if(isFunction$1(this.disableWheel)?this.disableWheel():this.disableWheel)return void e.preventDefault();let t,r;1===e.deltaMode?(t=20*e.deltaX,r=20*e.deltaY):(t=e.deltaX,r=e.deltaY),this.scrollHandler(t,r,{smooth:!0,force:!1})&&e.preventDefault(),this.verticalScrollBar.scroll(this.data.scroll.y),this.horizontalScrollBar.scroll(this.data.scroll.x)}));let e=[0,0];this.waffle.el.on("touchstart",(t=>{const{x:r,y:n}=this.getPointInfo(t);e=[r,n]})),this.waffle.el.on("touchmove",(t=>{const[r,n]=e,{x:o,y:i}=this.getPointInfo(t);e=[o,i],this.scrollHandler(r-o,n-i,{smooth:!0,force:!1}),this.verticalScrollBar.scroll(this.data.scroll.y),this.horizontalScrollBar.scroll(this.data.scroll.x)})),this.waffle.el.on("mouseout",(e=>{const{x:t,y:r}=this.getPointInfo(e);(t<=0||r<=0||t>=this.data.width||r>=this.data.height)&&this.data.view.disHover()})),document.addEventListener("mouseup",this.onMouseUp),bindClickoutside(this.waffle.el,(()=>{this.hideSelectArea()}),!1),this.waffle.on("focus",((e,t)=>{this.focusHandler(e,t)}))}initResizer(){this.verticalResizer=new Resizer({direction:"vertical",onResize:this.resizeHandler}),this.horizontalResizer=new Resizer({direction:"horizontal",onResize:this.resizeHandler})}initTootip(){this.toolTip=new ToolTip}initScrollbar(){const e=this.data.getViewBounds();this.verticalScrollBar=new ScrollBar({direction:"vertical",size:e.height,scrollSize:this.data.maxScrollY,slider:{},onScoll:this.scrollHandler}),this.horizontalScrollBar=new ScrollBar({direction:"horizontal",size:e.width,scrollSize:this.data.maxScrollX,slider:{},onScoll:this.scrollHandler})}mountResizer(){this.el.hasChild(this.verticalResizer.el.el)||this.el.hasChild(this.horizontalResizer.el.el)||this.el.children(this.verticalResizer.el,this.horizontalResizer.el)}mountScrollbar(){this.el.hasChild(this.verticalScrollBar.el.el)||this.el.hasChild(this.horizontalScrollBar.el.el)||(this.el.children(this.verticalScrollBar.el),this.el.children(this.horizontalScrollBar.el))}updateScrollBar(){const e=this.data.getViewBounds();this.verticalScrollBar.update({size:e.height,scrollSize:this.data.maxScrollY}),this.horizontalScrollBar.update({size:e.width,scrollSize:this.data.maxScrollX})}initWaffle(){const{headHeight:e,headWidth:t,tailHeight:r,tailWidth:n}=this.data.view.freezeConfig,o=this.data.width+this.data.offset.offsetX,i=this.data.height+this.data.offset.offsetY,a=t+this.data.offset.offsetX,s=e+this.data.offset.offsetY;this.waffle=new Waffle({width:o,height:i,freezeConfig:{headHeight:s,headWidth:a,tailHeight:r,tailWidth:n},wholeSheetBounds:this.getWholeSheetBounds4Render(),totalWidth:this.data.view.totalWidth,totalHeight:this.data.view.totalHeight}),this.el.children(this.waffle.el)}isDoubleClickable(e,t,r){const{verticalFreezed:n,horizontalFreezed:o}=this.data.cellIsFreezed(r),i=e+(n?0:this.data.getScroll().x)-this.data.offset.offsetX,a=t+(o?0:this.data.getScroll().y)-this.data.offset.offsetY;return!1===r.dblclick&&r.left<=i&&r.left+r.width>=i&&r.top<=a&&r.top+r.height>=a||!!r.items&&r.items.some((r=>this.isDoubleClickable(e,t,r.el)))}focusHandler(e,t){const r=e,n=this.data.scroll.x,o=t,i=this.data.scroll.y;Math.abs(r-n)>1&&isNumber$1(e)&&this.whellScroll(r-n,0),Math.abs(o-i)>1&&isNumber$1(t)&&this.whellScroll(0,o-i)}showInputCell(){const e=this.data.getSelectCell();e.x=e.x+this.data.offset.offsetX,e.y=e.y+this.data.offset.offsetY}showSelectArea(){const e=this.data.getSelectBounds();this.waffle.showSelectArea(e)}hideSelectArea(){this.waffle.hideSelectArea(),this.data.clearSelection()}clean(){this.cellCache=new Set,this.stickerTimeouts.forEach((e=>{window.clearTimeout(e)})),this.stickerTimeouts=[],this.waffle.clean()}getActiveCell(e,t){const{tailHeight:r,tailWidth:n}=this.data.view.freezeConfig;if(r||n){const{offsetX:o,offsetY:i}=this.data.offset,a=this.data.width+o,s=this.data.height+i,{width:l,height:c}=this.getWholeSheetBounds4Render();e>=a-n&&(e=l-(a-e)),t>=s-r&&(t=c-(s-t))}const o=this.data.getCellByOffset(e,t);return o?!1===o.valid?null:o:null}setMouseCursorByEvent(e,t){const r=this.waffle.getGrids().map((e=>e.el.el)),n=this.waffle.el.el;let o=e.target;for(;o&&o!==n&&!r.includes(o);)o=o.parentElement;o&&(o.style.cursor=t)}getActivePosition(e,t){const{left:r,top:n}=this.el.el.getBoundingClientRect();return[e-r,t-n]}getPointInfo(e){const t=this.getClientByEvent(e),r=this.getPointByEvent(e);return{x:r.x,y:r.y,clientX:t.x,clientY:t.y}}getClientByEvent(e){let t=e;return window.TouchEvent&&e instanceof TouchEvent&&(t="touchend"===e.type?e.changedTouches[0]:e.targetTouches[0]),{x:t.clientX,y:t.clientY}}getPointByEvent(e){const t=this.waffle.getGrids().map((e=>e.el.el)),r=this.waffle.el.el,n=Waffle.STICKER_CONTAINER_CLASS_NAME;if(this.supportCSSTransform&&e instanceof MouseEvent)return{x:function(e,o){let i=e,a=o;for(;a&&a!==r&&!t.includes(a);)"".concat(a.className).includes(n)?i=e+a.offsetLeft:i+=a.offsetLeft,a=a.parentElement;return a&&(i-=a.scrollLeft-a.offsetLeft),a&&a.childNodes[0]&&(i+=new DOMMatrix(getComputedStyle(a.childNodes[0]).transform).e),i}(e.offsetX,e.target),y:function(e,o){let i=e,a=o;for(;a&&a!==r&&!t.includes(a);)"".concat(a.className).includes(n)?i=e+a.offsetTop:i+=a.offsetTop,a=a.parentElement;return a&&a.parentElement&&(i-=a.scrollTop-a.parentElement.offsetTop),a&&a.childNodes[0]&&(i+=new DOMMatrix(getComputedStyle(a.childNodes[0]).transform).f),i}(e.offsetY,e.target)};const{x:o,y:i}=this.getClientByEvent(e);return this.getPointByClient(o,i)}getWholeSheetBounds4Render(){const e=this.data.width+this.data.offset.offsetX,t=this.data.height+this.data.offset.offsetY;return{height:Math.max(t,this.data.view.totalHeight),width:Math.max(e,this.data.view.totalWidth)}}transformWaffle(e,t){this.waffle.transform(e,t)}cloneSticker(e,t){const{height:r,width:n}=this.getWholeSheetBounds4Render(),{headHeight:o,headWidth:i}=this.data.view.freezeConfig;this.waffle.cloneChildEl({totalHeight:r-o,totalWidth:n-i,x:e,y:t})}hideToolTip(){this.toolTip.hide()}}var isff="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function addEvent(e,t,r){e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent&&e.attachEvent("on".concat(t),(function(){r(window.event)}))}function getMods(e,t){for(var r=t.slice(0,t.length-1),n=0;n<r.length;n++)r[n]=e[r[n].toLowerCase()];return r}function getKeys(e){e||(e="");for(var t=(e=e.replace(/\s/g,"")).split(","),r=t.lastIndexOf("");r>=0;)t[r-1]+=",",t.splice(r,1),r=t.lastIndexOf("");return t}function compareArray(e,t){for(var r=e.length>=t.length?e:t,n=e.length>=t.length?t:e,o=!0,i=0;i<r.length;i++)-1===n.indexOf(r[i])&&(o=!1);return o}for(var _keyMap={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,"⇪":20,",":188,".":190,"/":191,"`":192,"-":isff?173:189,"=":isff?61:187,";":isff?59:186,"'":222,"[":219,"]":221,"\\":220},_modifier={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":isff?224:91,cmd:isff?224:91,command:isff?224:91},modifierMap={16:"shiftKey",18:"altKey",17:"ctrlKey"},_mods={16:!1,18:!1,17:!1},_handlers={},k$2=1;k$2<20;k$2++)_keyMap["f".concat(k$2)]=111+k$2;modifierMap[isff?224:91]="metaKey",_mods[isff?224:91]=!1;var _downKeys=[],_scope="all",elementHasBindEvent=[],code=function(e){return _keyMap[e.toLowerCase()]||_modifier[e.toLowerCase()]||e.toUpperCase().charCodeAt(0)};function setScope(e){_scope=e||"all"}function getScope(){return _scope||"all"}function getPressedKeyCodes(){return _downKeys.slice(0)}function filter(e){var t=e.target||e.srcElement,r=t.tagName,n=!0;return!t.isContentEditable&&"TEXTAREA"!==r&&("INPUT"!==r&&"TEXTAREA"!==r||t.readOnly)||(n=!1),n}function isPressed(e){return"string"==typeof e&&(e=code(e)),-1!==_downKeys.indexOf(e)}function deleteScope(e,t){var r,n;for(var o in e||(e=getScope()),_handlers)if(Object.prototype.hasOwnProperty.call(_handlers,o))for(r=_handlers[o],n=0;n<r.length;)r[n].scope===e?r.splice(n,1):n++;getScope()===e&&setScope(t||"all")}function clearModifier(e){var t=e.keyCode||e.which||e.charCode,r=_downKeys.indexOf(t);if(r>=0&&_downKeys.splice(r,1),e.key&&"meta"===e.key.toLowerCase()&&_downKeys.splice(0,_downKeys.length),93!==t&&224!==t||(t=91),t in _mods)for(var n in _mods[t]=!1,_modifier)_modifier[n]===t&&(hotkeys[n]=!1)}function unbind(e,t,r){var n,o,i=getKeys(e),a=[];"function"==typeof t&&(r=t,t="all");for(var s=0;s<i.length;s++){if(a=(n=i[s].split("+")).length>1?getMods(_modifier,n):[],e="*"===(e=n[n.length-1])?"*":code(e),t||(t=getScope()),!_handlers[e])return;for(var l=0;l<_handlers[e].length;l++){o=_handlers[e][l],(!r||o.method===r)&&o.scope===t&&compareArray(o.mods,a)&&(_handlers[e][l]={})}}}function eventHandler(e,t,r){var n;if(t.scope===r||"all"===t.scope){for(var o in n=t.mods.length>0,_mods)Object.prototype.hasOwnProperty.call(_mods,o)&&(!_mods[o]&&t.mods.indexOf(+o)>-1||_mods[o]&&-1===t.mods.indexOf(+o))&&(n=!1);(0!==t.mods.length||_mods[16]||_mods[18]||_mods[17]||_mods[91])&&!n&&"*"!==t.shortcut||!1===t.method(e,t)&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0))}}function dispatch(e){var t=_handlers["*"],r=e.keyCode||e.which||e.charCode;if(hotkeys.filter.call(this,e)){if(-1===_downKeys.indexOf(r)&&229!==r&&_downKeys.push(r),93!==r&&224!==r||(r=91),r in _mods){for(var n in _mods[r]=!0,_modifier)_modifier[n]===r&&(hotkeys[n]=!0);if(!t)return}for(var o in _mods)Object.prototype.hasOwnProperty.call(_mods,o)&&(_mods[o]=e[modifierMap[o]]);var i=getScope();if(t)for(var a=0;a<t.length;a++)t[a].scope===i&&("keydown"===e.type&&t[a].keydown||"keyup"===e.type&&t[a].keyup)&&eventHandler(e,t[a],i);if(r in _handlers)for(var s=0;s<_handlers[r].length;s++)if(("keydown"===e.type&&_handlers[r][s].keydown||"keyup"===e.type&&_handlers[r][s].keyup)&&_handlers[r][s].key){for(var l=_handlers[r][s].key.split("+"),c=[],u=0;u<l.length;u++)c.push(code(l[u]));(c=c.sort()).join("")===_downKeys.sort().join("")&&eventHandler(e,_handlers[r][s],i)}}}function isElementBind(e){return elementHasBindEvent.indexOf(e)>-1}function hotkeys(e,t,r){var n=getKeys(e),o=[],i="all",a=document,s=0,l=!1,c=!0;for(void 0===r&&"function"==typeof t&&(r=t),"[object Object]"===Object.prototype.toString.call(t)&&(t.scope&&(i=t.scope),t.element&&(a=t.element),t.keyup&&(l=t.keyup),t.keydown&&(c=t.keydown)),"string"==typeof t&&(i=t);s<n.length;s++)o=[],(e=n[s].split("+")).length>1&&(o=getMods(_modifier,e)),(e="*"===(e=e[e.length-1])?"*":code(e))in _handlers||(_handlers[e]=[]),_handlers[e].push({keyup:l,keydown:c,scope:i,mods:o,shortcut:n[s],method:r,key:n[s]});void 0!==a&&!isElementBind(a)&&window&&(elementHasBindEvent.push(a),addEvent(a,"keydown",(function(e){dispatch(e)})),addEvent(window,"focus",(function(){_downKeys=[]})),addEvent(a,"keyup",(function(e){dispatch(e),clearModifier(e)})))}var _api={setScope:setScope,getScope:getScope,deleteScope:deleteScope,getPressedKeyCodes:getPressedKeyCodes,isPressed:isPressed,filter:filter,unbind:unbind};for(var a$1 in _api)Object.prototype.hasOwnProperty.call(_api,a$1)&&(hotkeys[a$1]=_api[a$1]);if("undefined"!=typeof window){var _hotkeys=window.hotkeys;hotkeys.noConflict=function(e){return e&&window.hotkeys===hotkeys&&(window.hotkeys=_hotkeys),hotkeys},window.hotkeys=hotkeys}let HotkeysManager=(()=>{class e{constructor(e){e&&e.hotkeys&&Object.keys(e.hotkeys).forEach((t=>{this.bindHotkeys(t,e.hotkeys[t])}))}bindHotkeys(e,t){hotkeys(e,t)}unbindHotkeys(e,t){hotkeys.unbind(e,t)}}return e.KEY={COPY:"ctrl+c,command+c"},e})();class ContextMenu{constructor(e=[{key:"copy",icon:"",label:"复制",accel:""}]){this.el=h$1("div","sheet-menu").css({userSelect:"none"}).hide(),this.clickHandler=emptyFn,this.menuItems=e,this.buildItems(),blockContextMenu(this.el.el),document.body.appendChild(this.el.el)}show(e,t,r){const{width:n,height:o}=this.el.show().offset();this.configItems(r);let i=t,a=e;window.innerHeight-t<=o&&(i-=o),window.innerWidth-e<=n&&(a-=n),this.el.offset({left:a,top:i}),bindClickoutside(this.el)}hide(){this.el.hide(),unbindClickoutside(this.el)}bindHandler(e){this.clickHandler=e}tear(){document.body.removeChild(this.el.el)}configItems(e){this.menuItems.forEach((t=>{e[t.key]?this.el.childEnable(t.key):this.el.disableChild(t.key)}))}buildItems(){this.menuItems.forEach((e=>{"separator"===e.key&&this.el.children(h$1("div","sheet-menuseparator")),this.el.children(h$1("div","sheet-menuitem ".concat(e.key)).on("mousedown",(e=>{e.stopPropagation()})).on("click",(()=>{this.clickHandler(e.key),this.hide()})).children(h$1("div","sheet-menuitem-icon"),h$1("span","sheet-menuitem-label").text(e.label||""),h$1("span","sheet-menuitem-accel").text(e.accel||"")))}))}}class InputBox{constructor({data:e,editable:t=!1}){this.data=e,this.el=h$1("div","input-box").hide(),this.input=h$1("div","cell-input").attr("contenteditable","".concat(!!t)),this.el.children(this.input),document.body.appendChild(this.el.el)}show(e,t,r,n){if(r<=0||n<=0)return;this.el.css({left:"".concat(e-2,"px"),top:"".concat(t-2,"px"),maxWidth:"".concat(this.data.width-e+this.data.offset.offsetX-12,"px"),minWidth:"".concat(r+2,"px"),minHeight:"".concat(n+2,"px"),maxHeight:"".concat(this.data.height-t+this.data.offset.offsetY-12,"px")}).show(),this.input.text(""),this.text=this.text||h$1("span"),this.text.text(this.data.getSelectCell().value),this.input.children(this.text);const o=getSelection(),i=document.createRange();o.removeAllRanges(),i.selectNodeContents(this.text.el),i.setStart(i.startContainer,i.endOffset),o.addRange(i),bindClickoutside(this.el),bindMouseWhell(this.el)}hide(){this.el.hide(),unbindClickoutside(this.el),unbindMouseWhell(this.el)}tear(){document.body.removeChild(this.el.el)}}class Clipboard{constructor(){this.texts=[],this.cells=null,this.trigger=document.createElement("textarea"),this.trigger.className="trix-offscreen",this.trigger.innerText=" ",this.trigger.addEventListener("copy",(e=>{this.setClipboardData(e)})),document.body.appendChild(this.trigger)}copy(e){this.cells=e,this.isImage()?this.downloadImage():this.dispatchCopy()}copyText(e){0!==e.length&&(this.texts=e,this.dispatchCopy())}clear(){this.cells=null}tear(){document.body.removeChild(this.trigger)}isImage(){return this.cells.length>=1&&this.cells[0].length>=1&&this.cells[0][0].image}downloadImage(){const e=document.createElement("a");e.href=this.cells[0][0].image,e.download="image.png",document.body.appendChild(e),e.click(),document.body.removeChild(e)}dispatchCopy(){const e=getSelection(),t=document.createRange();e.removeAllRanges(),t.selectNodeContents(this.trigger),e.addRange(t),this.trigger.setSelectionRange(0,99999),this.trigger.focus(),document.execCommand("copy"),this.trigger.blur()}transform2HTML(){if(!this.cells)return"";const e={},t=[],r=[];return this.cells.forEach((n=>{n.forEach((n=>{const{ri:o,ci:i,width:a,height:s}=n;t[i]!==a&&(t[i]||0===t[i]?(t[i]=Math.min(t[i],a),t[i+1]=Math.max(t[i],a)-t[i]):t[i]=a),r[o]!==s&&(r[o]||0===r[o]?(r[o]=Math.min(r[o],s),r[o+1]=Math.max(r[o],s)-r[o]):r[o]=s),e["".concat(n.ci,"-").concat(n.ri)]=transformCell2HTML()}))})),""}transform2Text(){return this.texts.map((e=>e.join("\t"))).join("\n")}setClipboardData(e){var t;e.clipboardData?(e.clipboardData.setData("text/html",this.transform2HTML()),e.clipboardData.setData("text/plain",this.transform2Text())):(this.transform2HTML(),null===(t=window.clipboardData)||void 0===t||t.setData("text",this.transform2Text())),e.preventDefault()}}class Sheet{constructor(e,t={}){var r,n;this.scrollHandler=(e,t)=>{"vertical"===t?this.data.scrollY(e,this.scrollTable):this.data.scrollX(e,this.scrollTable)},this.resizeHandler=(e,t,r)=>{"vertical"===r?this.data.resizeCol(e.ci,e.width+t):this.data.resizeRow(e.ri,e.height+t),this.render()},this.scrollTable=(e,t)=>{this.container.setWheelMode(WheelMode.WHEELMODE_WHEEL);const r=e.y-t.y,n=e.x-t.x;this.table.scroll(n,r),(this.eventsMap.scroll||[]).forEach((t=>{t.call(null,{x:e.x,y:e.y,deltaX:n,deltaY:r})}))},this.selectHandler=(e,t,r,n,o)=>{this.data.select(e,t,r,n,o),this.table.renderSequnce()},this.showContextMenu=(e,t)=>{if(isFunction$1(this.disableContextMenu)?this.disableContextMenu():this.disableContextMenu)return;const r=this.data.getSelectRangeCells();let n=!1;for(const o of r)if(n=o.some((e=>!!e.canCopy)),n)break;this.contextMenu.show(e,t,{copy:n&&!isEmpty(this.data.selection.getSelectedTexts())})},this.contextMenuHandler=e=>{this.copy()},this.render=()=>{var e,t;this.table.render(),null===(t=(e=this.events).render)||void 0===t||t.call(e)},this.copy=()=>{this.clipboard.copyText(this.data.selection.getSelectedTexts())},this.events=t,this.el=h$1("div","sheet"),this.el.offset({width:e.width,height:e.height}),this.data=new DataProxy("sheet",e),this.disableContextMenu=e.disableContextMenu,this.container=new Container(this.data,{sync:e.sync,getPointByClient:this.getPointByClient.bind(this),supportCSSTransform:e.supportCSSTransform,disableWheel:e.disableWheel}),this.table=new Table(this.data,this.container),this.container.el.unshiftChildren(this.table.el),this.el.children(this.container.el),this.initEvent(),this.initHotKeys(),this.contextMenu=new ContextMenu(e.contextMenuItems),this.contextMenu.bindHandler(this.contextMenuHandler),this.inputBox=new InputBox({data:this.data}),null===(n=(r=this.events).created)||void 0===n||n.call(r),this.render()}initEvent(){this.eventsMap={},this.container.on("scroll",this.scrollHandler),this.container.on("resize",this.resizeHandler),this.container.on("select",this.selectHandler),this.container.on("contextmenu",this.showContextMenu)}initHotKeys(){this.hotkeys=new HotkeysManager,this.initCopyEvent()}initCopyEvent(){this.clipboard=new Clipboard,this.hotkeys.bindHotkeys(HotkeysManager.KEY.COPY,this.copy)}resizeEl(){this.el.offset({width:this.data.width+this.data.offset.offsetX,height:this.data.height+this.data.offset.offsetY})}addEventListener(e,t){this.eventsMap[e]=this.eventsMap[e]||[],this.eventsMap[e].includes(t)||this.eventsMap[e].push(t)}removeEventListener(e,t){this.eventsMap[e]=this.eventsMap[e]||[],remove(this.eventsMap[e],t)}loadData(e){this.data.setData(e),this.reset()}updateCell(e,t){this.data.updateCell(e.ri,e.ci,t),this.table.renderCell(e)}getCellPosition(e){return this.data.getCellPosition(e,this.data.options.sheet.merges)}whellByBounds(e){const{x:t=0,y:r=0,width:n,height:o}=e,{left:i,top:a,right:s,bottom:l}=this.getBounds();let c=0,u=0;if(t<=i||t+n>=s){c=t+n-(t+n>=s?s-n:i+2*n)}if(r<=a||r+o>=l){u=r+o-(r+o>=l?l-o:a+2*o)}this.whellScroll(c,u)}getBounds(){const{x:e,y:t}=this.data.getScroll();return{left:e,top:t,right:e+this.data.width,bottom:t+this.data.height,width:this.data.width,height:this.data.height}}insertRows(e,t,r){this.data.insertRows(e,t,r),this.render(),this.container.resize()}insertCols(e,t,r){this.data.insertCols(e,t,r),this.render(),this.container.resize()}deleteRows(e,t){this.data.deleteRows(e,t),this.render(),this.container.resize()}deleteCols(e,t){this.data.deleteCols(e,t),this.render(),this.container.resize()}reset(){this.hotkeys.unbindHotkeys(HotkeysManager.KEY.COPY,this.copy),this.data.reset(),this.container.reset(),this.table.resize(),this.render(),this.resizeEl(),this.hotkeys.bindHotkeys(HotkeysManager.KEY.COPY,this.copy)}resize(e,t){this.data.resize(e,t),this.container.resize(),this.table.resize(),this.render(),this.resizeEl()}setHScrollBarVisible(e){this.container.horizontalScrollBar.setVisible(e)}setVScrollBarVisible(e){this.container.verticalScrollBar.setVisible(e)}whellScroll(e,t){return this.container.whellScroll(e,t)}tear(){this.clipboard.tear(),this.contextMenu.tear(),this.inputBox.tear(),this.container.tear()}clear(){this.clipboard.clear(),this.contextMenu.hide(),this.inputBox.hide(),this.container.hideToolTip()}destroy(){this.tear(),this.hotkeys.unbindHotkeys(HotkeysManager.KEY.COPY,this.copy),this.container=null,this.eventsMap={},this.table=null}getPointByClient(e,t){const r=this.table.el.el.getBoundingClientRect();return{x:e-r.left,y:t-r.top}}getMaxScroll(){return{maxScrollX:this.data.maxScrollX,maxScrollY:this.data.maxScrollY}}setBoundsOffset(e){const t=e.offsetX-this.data.scroll.x,r=e.offsetY-this.data.scroll.y;this.data.setDataScroll(e),this.table.scroll(t,r),this.container.transformWaffle(-e.offsetX,-e.offsetY),this.container.horizontalScrollBar.scroll(e.offsetX,!1),this.container.verticalScrollBar.scroll(e.offsetY,!1)}setRepeatFill(e){this.data.repeatFill=e}getFreezeConfig(){return this.data.view.freezeConfig}cloneSticker(e,t){this.container.cloneSticker(e,t)}}class FineSheet{constructor(e,t,r={}){var n,o,i;if(r.beforeInit&&!r.beforeInit())return;null===(n=r.beforeCreate)||void 0===n||n.call(r),this.parent=h$1(e,"sheet-root");const{width:a,height:s}=this.parent.offset(),{tableWidth:l=a,tableHeight:c=s}=t,u=Object.assign({width:l,height:c},t.options);this.sheet=new Sheet(u,r),null===(o=r.beforeMount)||void 0===o||o.call(r),this.parent.children(this.sheet.el),null===(i=r.mounted)||void 0===i||i.call(r)}loadData(e){return this.sheet.loadData(e),this}updateData(){return this}updateCell(e,t){this.sheet.updateCell(e,t)}getCellPosition(e){return this.sheet.getCellPosition(e)}resize(e,t){const{width:r,height:n}=this.parent.offset();e=e||r,t=t||n,this.sheet.resize(e,t)}insertRows(e,t,r){this.sheet.insertRows(e,t,r)}insertCols(e,t,r){this.sheet.insertCols(e,t,r)}deleteRows(e,t){this.sheet.deleteRows(e,t)}deleteCols(e,t){this.sheet.deleteCols(e,t)}tear(){this.sheet.tear()}destroy(){this.sheet.destroy()}}const finesheet={createSheet:(e,t,r)=>new FineSheet(e,t,r)};var define_process_env_default={NODE_ENV:"production"},t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e$1(e,t){return e(t={exports:{}},t.exports),t.exports}var r=(t2=Object.freeze({__proto__:null,default:{}}),t2&&t2.default||t2),i=e$1((function(e,n){var o;e.exports=(o=o||function(e){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==t&&t.crypto&&(n=t.crypto),!n)try{n=r}catch(t2){}var o=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(t2){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(t2){}}throw new Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),a={},s=a.lib={},l=s.Base={extend:function(e){var t=i(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},c=s.WordArray=l.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||d).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,o=e.sigBytes;if(this.clamp(),n%4)for(var i=0;i<o;i++){var a=r[i>>>2]>>>24-i%4*8&255;t[n+i>>>2]|=a<<24-(n+i)%4*8}else for(var s=0;s<o;s+=4)t[n+s>>>2]=r[s>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=l.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(o());return new c.init(t,e)}}),u=a.enc={},d=u.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],o=0;o<r;o++){var i=t[o>>>2]>>>24-o%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new c.init(r,t/2)}},h=u.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],o=0;o<r;o++){var i=t[o>>>2]>>>24-o%4*8&255;n.push(String.fromCharCode(i))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new c.init(r,t)}},p=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(h.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return h.parse(unescape(encodeURIComponent(e)))}},f=s.BufferedBlockAlgorithm=l.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r,n=this._data,o=n.words,i=n.sigBytes,a=this.blockSize,s=i/(4*a),l=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*a,u=e.min(4*l,i);if(l){for(var d=0;d<l;d+=a)this._doProcessBlock(o,d);r=o.splice(0,l),n.sigBytes-=u}return new c.init(r,u)},clone:function(){var e=l.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});s.Hasher=f.extend({cfg:l.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new g.HMAC.init(e,r).finalize(t)}}});var g=a.algo={};return a}(Math),o)})),n=(e$1((function(e,t){var r,n,o,a,s,l;e.exports=(n=(r=l=i).lib,o=n.Base,a=n.WordArray,(s=r.x64={}).Word=o.extend({init:function(e,t){this.high=e,this.low=t}}),s.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,r=[],n=0;n<t;n++){var o=e[n];r.push(o.high),r.push(o.low)}return a.create(r,this.sigBytes)},clone:function(){for(var e=o.clone.call(this),t=e.words=this.words.slice(0),r=t.length,n=0;n<r;n++)t[n]=t[n].clone();return e}}),l)})),e$1((function(e,t){var r;e.exports=(r=i,function(){if("function"==typeof ArrayBuffer){var e=r.lib.WordArray,t=e.init,n=e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var r=e.byteLength,n=[],o=0;o<r;o++)n[o>>>2]|=e[o]<<24-o%4*8;t.call(this,n,r)}else t.apply(this,arguments)};n.prototype=e}}(),r.lib.WordArray)})),e$1((function(e,t){var r;e.exports=(r=i,function(){var e=r,t=e.lib.WordArray,n=e.enc;function o(e){return e<<8&4278255360|e>>>8&16711935}n.Utf16=n.Utf16BE={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],o=0;o<r;o+=2){var i=t[o>>>2]>>>16-o%4*8&65535;n.push(String.fromCharCode(i))}return n.join("")},parse:function(e){for(var r=e.length,n=[],o=0;o<r;o++)n[o>>>1]|=e.charCodeAt(o)<<16-o%2*16;return t.create(n,2*r)}},n.Utf16LE={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i+=2){var a=o(t[i>>>2]>>>16-i%4*8&65535);n.push(String.fromCharCode(a))}return n.join("")},parse:function(e){for(var r=e.length,n=[],i=0;i<r;i++)n[i>>>1]|=o(e.charCodeAt(i)<<16-i%2*16);return t.create(n,2*r)}}}(),r.enc.Utf16)})),e$1((function(e,t){var r;e.exports=(r=i,function(){var e=r,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp();for(var o=[],i=0;i<r;i+=3)for(var a=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<r;s++)o.push(n.charAt(a>>>6*(3-s)&63));var l=n.charAt(64);if(l)for(;o.length%4;)o.push(l);return o.join("")},parse:function(e){var r=e.length,n=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<n.length;i++)o[n.charCodeAt(i)]=i}var a=n.charAt(64);if(a){var s=e.indexOf(a);-1!==s&&(r=s)}return function(e,r,n){for(var o=[],i=0,a=0;a<r;a++)if(a%4){var s=n[e.charCodeAt(a-1)]<<a%4*2|n[e.charCodeAt(a)]>>>6-a%4*2;o[i>>>2]|=s<<24-i%4*8,i++}return t.create(o,i)}(e,r,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),r.enc.Base64)})),e$1((function(e,t){var r;e.exports=(r=i,function(){var e=r,t=e.lib.WordArray;e.enc.Base64url={stringify:function(e,t=!0){var r=e.words,n=e.sigBytes,o=t?this._safe_map:this._map;e.clamp();for(var i=[],a=0;a<n;a+=3)for(var s=(r[a>>>2]>>>24-a%4*8&255)<<16|(r[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|r[a+2>>>2]>>>24-(a+2)%4*8&255,l=0;l<4&&a+.75*l<n;l++)i.push(o.charAt(s>>>6*(3-l)&63));var c=o.charAt(64);if(c)for(;i.length%4;)i.push(c);return i.join("")},parse:function(e,r=!0){var n=e.length,o=r?this._safe_map:this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var a=0;a<o.length;a++)i[o.charCodeAt(a)]=a}var s=o.charAt(64);if(s){var l=e.indexOf(s);-1!==l&&(n=l)}return function(e,r,n){for(var o=[],i=0,a=0;a<r;a++)if(a%4){var s=n[e.charCodeAt(a-1)]<<a%4*2|n[e.charCodeAt(a)]>>>6-a%4*2;o[i>>>2]|=s<<24-i%4*8,i++}return t.create(o,i)}(e,n,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"}}(),r.enc.Base64url)})),e$1((function(e,t){var r;e.exports=(r=i,function(e){var t=r,n=t.lib,o=n.WordArray,i=n.Hasher,a=t.algo,s=[];!function(){for(var t=0;t<64;t++)s[t]=4294967296*e.abs(e.sin(t+1))|0}();var l=a.MD5=i.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var r=0;r<16;r++){var n=t+r,o=e[n];e[n]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i=this._hash.words,a=e[t+0],l=e[t+1],p=e[t+2],f=e[t+3],g=e[t+4],m=e[t+5],y=e[t+6],v=e[t+7],_=e[t+8],b=e[t+9],C=e[t+10],E=e[t+11],T=e[t+12],S=e[t+13],P=e[t+14],w=e[t+15],x=i[0],O=i[1],$=i[2],I=i[3];x=c(x,O,$,I,a,7,s[0]),I=c(I,x,O,$,l,12,s[1]),$=c($,I,x,O,p,17,s[2]),O=c(O,$,I,x,f,22,s[3]),x=c(x,O,$,I,g,7,s[4]),I=c(I,x,O,$,m,12,s[5]),$=c($,I,x,O,y,17,s[6]),O=c(O,$,I,x,v,22,s[7]),x=c(x,O,$,I,_,7,s[8]),I=c(I,x,O,$,b,12,s[9]),$=c($,I,x,O,C,17,s[10]),O=c(O,$,I,x,E,22,s[11]),x=c(x,O,$,I,T,7,s[12]),I=c(I,x,O,$,S,12,s[13]),$=c($,I,x,O,P,17,s[14]),x=u(x,O=c(O,$,I,x,w,22,s[15]),$,I,l,5,s[16]),I=u(I,x,O,$,y,9,s[17]),$=u($,I,x,O,E,14,s[18]),O=u(O,$,I,x,a,20,s[19]),x=u(x,O,$,I,m,5,s[20]),I=u(I,x,O,$,C,9,s[21]),$=u($,I,x,O,w,14,s[22]),O=u(O,$,I,x,g,20,s[23]),x=u(x,O,$,I,b,5,s[24]),I=u(I,x,O,$,P,9,s[25]),$=u($,I,x,O,f,14,s[26]),O=u(O,$,I,x,_,20,s[27]),x=u(x,O,$,I,S,5,s[28]),I=u(I,x,O,$,p,9,s[29]),$=u($,I,x,O,v,14,s[30]),x=d(x,O=u(O,$,I,x,T,20,s[31]),$,I,m,4,s[32]),I=d(I,x,O,$,_,11,s[33]),$=d($,I,x,O,E,16,s[34]),O=d(O,$,I,x,P,23,s[35]),x=d(x,O,$,I,l,4,s[36]),I=d(I,x,O,$,g,11,s[37]),$=d($,I,x,O,v,16,s[38]),O=d(O,$,I,x,C,23,s[39]),x=d(x,O,$,I,S,4,s[40]),I=d(I,x,O,$,a,11,s[41]),$=d($,I,x,O,f,16,s[42]),O=d(O,$,I,x,y,23,s[43]),x=d(x,O,$,I,b,4,s[44]),I=d(I,x,O,$,T,11,s[45]),$=d($,I,x,O,w,16,s[46]),x=h(x,O=d(O,$,I,x,p,23,s[47]),$,I,a,6,s[48]),I=h(I,x,O,$,v,10,s[49]),$=h($,I,x,O,P,15,s[50]),O=h(O,$,I,x,m,21,s[51]),x=h(x,O,$,I,T,6,s[52]),I=h(I,x,O,$,f,10,s[53]),$=h($,I,x,O,C,15,s[54]),O=h(O,$,I,x,l,21,s[55]),x=h(x,O,$,I,_,6,s[56]),I=h(I,x,O,$,w,10,s[57]),$=h($,I,x,O,y,15,s[58]),O=h(O,$,I,x,S,21,s[59]),x=h(x,O,$,I,g,6,s[60]),I=h(I,x,O,$,E,10,s[61]),$=h($,I,x,O,p,15,s[62]),O=h(O,$,I,x,b,21,s[63]),i[0]=i[0]+x|0,i[1]=i[1]+O|0,i[2]=i[2]+$|0,i[3]=i[3]+I|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,o=8*t.sigBytes;r[o>>>5]|=128<<24-o%32;var i=e.floor(n/4294967296),a=n;r[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),r[14+(o+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(r.length+1),this._process();for(var s=this._hash,l=s.words,c=0;c<4;c++){var u=l[c];l[c]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}return s},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,r,n,o,i,a){var s=e+(t&r|~t&n)+o+a;return(s<<i|s>>>32-i)+t}function u(e,t,r,n,o,i,a){var s=e+(t&n|r&~n)+o+a;return(s<<i|s>>>32-i)+t}function d(e,t,r,n,o,i,a){var s=e+(t^r^n)+o+a;return(s<<i|s>>>32-i)+t}function h(e,t,r,n,o,i,a){var s=e+(r^(t|~n))+o+a;return(s<<i|s>>>32-i)+t}t.MD5=i._createHelper(l),t.HmacMD5=i._createHmacHelper(l)}(Math),r.MD5)})),e$1((function(e,t){var r;e.exports=(r=i,function(){var e=r,t=e.lib,n=t.WordArray,o=t.Hasher,i=e.algo,a=[],s=i.SHA1=o.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],o=r[1],i=r[2],s=r[3],l=r[4],c=0;c<80;c++){if(c<16)a[c]=0|e[t+c];else{var u=a[c-3]^a[c-8]^a[c-14]^a[c-16];a[c]=u<<1|u>>>31}var d=(n<<5|n>>>27)+l+a[c];d+=c<20?1518500249+(o&i|~o&s):c<40?1859775393+(o^i^s):c<60?(o&i|o&s|i&s)-1894007588:(o^i^s)-899497514,l=s,s=i,i=o<<30|o>>>2,o=n,n=d}r[0]=r[0]+n|0,r[1]=r[1]+o|0,r[2]=r[2]+i|0,r[3]=r[3]+s|0,r[4]=r[4]+l|0},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=Math.floor(r/4294967296),t[15+(n+64>>>9<<4)]=r,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=o._createHelper(s),e.HmacSHA1=o._createHmacHelper(s)}(),r.SHA1)})),e$1((function(e,t){var r;e.exports=(r=i,function(e){var t=r,n=t.lib,o=n.WordArray,i=n.Hasher,a=t.algo,s=[],l=[];!function(){function t(t){for(var r=e.sqrt(t),n=2;n<=r;n++)if(!(t%n))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var n=2,o=0;o<64;)t(n)&&(o<8&&(s[o]=r(e.pow(n,.5))),l[o]=r(e.pow(n,1/3)),o++),n++}();var c=[],u=a.SHA256=i.extend({_doReset:function(){this._hash=new o.init(s.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],o=r[1],i=r[2],a=r[3],s=r[4],u=r[5],d=r[6],h=r[7],p=0;p<64;p++){if(p<16)c[p]=0|e[t+p];else{var f=c[p-15],g=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,m=c[p-2],y=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;c[p]=g+c[p-7]+y+c[p-16]}var v=n&o^n&i^o&i,_=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),b=h+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&u^~s&d)+l[p]+c[p];h=d,d=u,u=s,s=a+b|0,a=i,i=o,o=n,n=b+(_+v)|0}r[0]=r[0]+n|0,r[1]=r[1]+o|0,r[2]=r[2]+i|0,r[3]=r[3]+a|0,r[4]=r[4]+s|0,r[5]=r[5]+u|0,r[6]=r[6]+d|0,r[7]=r[7]+h|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,o=8*t.sigBytes;return r[o>>>5]|=128<<24-o%32,r[14+(o+64>>>9<<4)]=e.floor(n/4294967296),r[15+(o+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(u),t.HmacSHA256=i._createHmacHelper(u)}(Math),r.SHA256)})),e$1((function(e,t){var r,n,o,a,s,l;e.exports=(n=(r=l=i).lib.WordArray,o=r.algo,a=o.SHA256,s=o.SHA224=a.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=a._doFinalize.call(this);return e.sigBytes-=4,e}}),r.SHA224=a._createHelper(s),r.HmacSHA224=a._createHmacHelper(s),l.SHA224)})),e$1((function(e,t){var r;e.exports=(r=i,function(){var e=r,t=e.lib.Hasher,n=e.x64,o=n.Word,i=n.WordArray,a=e.algo;function s(){return o.create.apply(o,arguments)}var l=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=s()}();var u=a.SHA512=t.extend({_doReset:function(){this._hash=new i.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],o=r[1],i=r[2],a=r[3],s=r[4],u=r[5],d=r[6],h=r[7],p=n.high,f=n.low,g=o.high,m=o.low,y=i.high,v=i.low,_=a.high,b=a.low,C=s.high,E=s.low,T=u.high,S=u.low,P=d.high,w=d.low,x=h.high,O=h.low,$=p,I=f,R=g,A=m,D=y,L=v,N=_,M=b,k=C,F=E,j=T,B=S,W=P,V=w,H=x,G=O,U=0;U<80;U++){var Y,z,K=c[U];if(U<16)z=K.high=0|e[t+2*U],Y=K.low=0|e[t+2*U+1];else{var Z=c[U-15],X=Z.high,J=Z.low,Q=(X>>>1|J<<31)^(X>>>8|J<<24)^X>>>7,q=(J>>>1|X<<31)^(J>>>8|X<<24)^(J>>>7|X<<25),ee=c[U-2],te=ee.high,re=ee.low,ne=(te>>>19|re<<13)^(te<<3|re>>>29)^te>>>6,oe=(re>>>19|te<<13)^(re<<3|te>>>29)^(re>>>6|te<<26),ie=c[U-7],ae=ie.high,se=ie.low,le=c[U-16],ce=le.high,ue=le.low;z=(z=(z=Q+ae+((Y=q+se)>>>0<q>>>0?1:0))+ne+((Y+=oe)>>>0<oe>>>0?1:0))+ce+((Y+=ue)>>>0<ue>>>0?1:0),K.high=z,K.low=Y}var de,he=k&j^~k&W,pe=F&B^~F&V,fe=$&R^$&D^R&D,ge=I&A^I&L^A&L,me=($>>>28|I<<4)^($<<30|I>>>2)^($<<25|I>>>7),ye=(I>>>28|$<<4)^(I<<30|$>>>2)^(I<<25|$>>>7),ve=(k>>>14|F<<18)^(k>>>18|F<<14)^(k<<23|F>>>9),_e=(F>>>14|k<<18)^(F>>>18|k<<14)^(F<<23|k>>>9),be=l[U],Ce=be.high,Ee=be.low,Te=H+ve+((de=G+_e)>>>0<G>>>0?1:0),Se=ye+ge;H=W,G=V,W=j,V=B,j=k,B=F,k=N+(Te=(Te=(Te=Te+he+((de+=pe)>>>0<pe>>>0?1:0))+Ce+((de+=Ee)>>>0<Ee>>>0?1:0))+z+((de+=Y)>>>0<Y>>>0?1:0))+((F=M+de|0)>>>0<M>>>0?1:0)|0,N=D,M=L,D=R,L=A,R=$,A=I,$=Te+(me+fe+(Se>>>0<ye>>>0?1:0))+((I=de+Se|0)>>>0<de>>>0?1:0)|0}f=n.low=f+I,n.high=p+$+(f>>>0<I>>>0?1:0),m=o.low=m+A,o.high=g+R+(m>>>0<A>>>0?1:0),v=i.low=v+L,i.high=y+D+(v>>>0<L>>>0?1:0),b=a.low=b+M,a.high=_+N+(b>>>0<M>>>0?1:0),E=s.low=E+F,s.high=C+k+(E>>>0<F>>>0?1:0),S=u.low=S+B,u.high=T+j+(S>>>0<B>>>0?1:0),w=d.low=w+V,d.high=P+W+(w>>>0<V>>>0?1:0),O=h.low=O+G,h.high=x+H+(O>>>0<G>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[30+(n+128>>>10<<5)]=Math.floor(r/4294967296),t[31+(n+128>>>10<<5)]=r,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(u),e.HmacSHA512=t._createHmacHelper(u)}(),r.SHA512)})),e$1((function(e,t){var r,n,o,a,s,l,c,u;e.exports=(n=(r=u=i).x64,o=n.Word,a=n.WordArray,s=r.algo,l=s.SHA512,c=s.SHA384=l.extend({_doReset:function(){this._hash=new a.init([new o.init(3418070365,3238371032),new o.init(1654270250,914150663),new o.init(2438529370,812702999),new o.init(355462360,4144912697),new o.init(1731405415,4290775857),new o.init(2394180231,1750603025),new o.init(3675008525,1694076839),new o.init(1203062813,3204075428)])},_doFinalize:function(){var e=l._doFinalize.call(this);return e.sigBytes-=16,e}}),r.SHA384=l._createHelper(c),r.HmacSHA384=l._createHmacHelper(c),u.SHA384)})),e$1((function(e,t){var r;e.exports=(r=i,function(e){var t=r,n=t.lib,o=n.WordArray,i=n.Hasher,a=t.x64.Word,s=t.algo,l=[],c=[],u=[];!function(){for(var e=1,t=0,r=0;r<24;r++){l[e+5*t]=(r+1)*(r+2)/2%64;var n=(2*e+3*t)%5;e=t%5,t=n}for(e=0;e<5;e++)for(t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var o=1,i=0;i<24;i++){for(var s=0,d=0,h=0;h<7;h++){if(1&o){var p=(1<<h)-1;p<32?d^=1<<p:s^=1<<p-32}128&o?o=o<<1^113:o<<=1}u[i]=a.create(s,d)}}();var d=[];!function(){for(var e=0;e<25;e++)d[e]=a.create()}();var h=s.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var r=this._state,n=this.blockSize/2,o=0;o<n;o++){var i=e[t+2*o],a=e[t+2*o+1];i=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),(O=r[o]).high^=a,O.low^=i}for(var s=0;s<24;s++){for(var h=0;h<5;h++){for(var p=0,f=0,g=0;g<5;g++)p^=(O=r[h+5*g]).high,f^=O.low;var m=d[h];m.high=p,m.low=f}for(h=0;h<5;h++){var y=d[(h+4)%5],v=d[(h+1)%5],_=v.high,b=v.low;for(p=y.high^(_<<1|b>>>31),f=y.low^(b<<1|_>>>31),g=0;g<5;g++)(O=r[h+5*g]).high^=p,O.low^=f}for(var C=1;C<25;C++){var E=(O=r[C]).high,T=O.low,S=l[C];S<32?(p=E<<S|T>>>32-S,f=T<<S|E>>>32-S):(p=T<<S-32|E>>>64-S,f=E<<S-32|T>>>64-S);var P=d[c[C]];P.high=p,P.low=f}var w=d[0],x=r[0];for(w.high=x.high,w.low=x.low,h=0;h<5;h++)for(g=0;g<5;g++){var O=r[C=h+5*g],$=d[C],I=d[(h+1)%5+5*g],R=d[(h+2)%5+5*g];O.high=$.high^~I.high&R.high,O.low=$.low^~I.low&R.low}O=r[0];var A=u[s];O.high^=A.high,O.low^=A.low}},_doFinalize:function(){var t=this._data,r=t.words;this._nDataBytes;var n=8*t.sigBytes,i=32*this.blockSize;r[n>>>5]|=1<<24-n%32,r[(e.ceil((n+1)/i)*i>>>5)-1]|=128,t.sigBytes=4*r.length,this._process();for(var a=this._state,s=this.cfg.outputLength/8,l=s/8,c=[],u=0;u<l;u++){var d=a[u],h=d.high,p=d.low;h=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),c.push(p),c.push(h)}return new o.init(c,s)},clone:function(){for(var e=i.clone.call(this),t=e._state=this._state.slice(0),r=0;r<25;r++)t[r]=t[r].clone();return e}});t.SHA3=i._createHelper(h),t.HmacSHA3=i._createHmacHelper(h)}(Math),r.SHA3)})),e$1((function(e,t){var r;e.exports=(r=i,function(){var e=r,t=e.lib,n=t.WordArray,o=t.Hasher,i=e.algo,a=n.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),s=n.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),l=n.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),c=n.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=n.create([0,1518500249,1859775393,2400959708,2840853838]),d=n.create([1352829926,1548603684,1836072691,2053994217,0]),h=i.RIPEMD160=o.extend({_doReset:function(){this._hash=n.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=0;r<16;r++){var n=t+r,o=e[n];e[n]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i,h,_,b,C,E,T,S,P,w,x,O=this._hash.words,$=u.words,I=d.words,R=a.words,A=s.words,D=l.words,L=c.words;for(E=i=O[0],T=h=O[1],S=_=O[2],P=b=O[3],w=C=O[4],r=0;r<80;r+=1)x=i+e[t+R[r]]|0,x+=r<16?p(h,_,b)+$[0]:r<32?f(h,_,b)+$[1]:r<48?g(h,_,b)+$[2]:r<64?m(h,_,b)+$[3]:y(h,_,b)+$[4],x=(x=v(x|=0,D[r]))+C|0,i=C,C=b,b=v(_,10),_=h,h=x,x=E+e[t+A[r]]|0,x+=r<16?y(T,S,P)+I[0]:r<32?m(T,S,P)+I[1]:r<48?g(T,S,P)+I[2]:r<64?f(T,S,P)+I[3]:p(T,S,P)+I[4],x=(x=v(x|=0,L[r]))+w|0,E=w,w=P,P=v(S,10),S=T,T=x;x=O[1]+_+P|0,O[1]=O[2]+b+w|0,O[2]=O[3]+C+E|0,O[3]=O[4]+i+T|0,O[4]=O[0]+h+S|0,O[0]=x},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),e.sigBytes=4*(t.length+1),this._process();for(var o=this._hash,i=o.words,a=0;a<5;a++){var s=i[a];i[a]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return o},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function p(e,t,r){return e^t^r}function f(e,t,r){return e&t|~e&r}function g(e,t,r){return(e|~t)^r}function m(e,t,r){return e&r|t&~r}function y(e,t,r){return e^(t|~r)}function v(e,t){return e<<t|e>>>32-t}e.RIPEMD160=o._createHelper(h),e.HmacRIPEMD160=o._createHmacHelper(h)}(),r.RIPEMD160)})),e$1((function(e,t){var r,n,o;e.exports=(n=(r=i).lib.Base,o=r.enc.Utf8,void(r.algo.HMAC=n.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=o.parse(t));var r=e.blockSize,n=4*r;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),a=this._iKey=t.clone(),s=i.words,l=a.words,c=0;c<r;c++)s[c]^=1549556828,l[c]^=909522486;i.sigBytes=a.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,r=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r))}})))})),e$1((function(e,t){var r,n,o,a,s,l,c,u,d;e.exports=(o=(n=(r=d=i).lib).Base,a=n.WordArray,l=(s=r.algo).SHA1,c=s.HMAC,u=s.PBKDF2=o.extend({cfg:o.extend({keySize:4,hasher:l,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r=this.cfg,n=c.create(r.hasher,e),o=a.create(),i=a.create([1]),s=o.words,l=i.words,u=r.keySize,d=r.iterations;s.length<u;){var h=n.update(t).finalize(i);n.reset();for(var p=h.words,f=p.length,g=h,m=1;m<d;m++){g=n.finalize(g),n.reset();for(var y=g.words,v=0;v<f;v++)p[v]^=y[v]}o.concat(h),l[0]++}return o.sigBytes=4*u,o}}),r.PBKDF2=function(e,t,r){return u.create(r).compute(e,t)},d.PBKDF2)})),e$1((function(e,t){var r,n,o,a,s,l,c,u;e.exports=(o=(n=(r=u=i).lib).Base,a=n.WordArray,l=(s=r.algo).MD5,c=s.EvpKDF=o.extend({cfg:o.extend({keySize:4,hasher:l,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r,n=this.cfg,o=n.hasher.create(),i=a.create(),s=i.words,l=n.keySize,c=n.iterations;s.length<l;){r&&o.update(r),r=o.update(e).finalize(t),o.reset();for(var u=1;u<c;u++)r=o.finalize(r),o.reset();i.concat(r)}return i.sigBytes=4*l,i}}),r.EvpKDF=function(e,t,r){return c.create(r).compute(e,t)},u.EvpKDF)})),e$1((function(e,t){var r;e.exports=void((r=i).lib.Cipher||function(){var e=r,t=e.lib,n=t.Base,o=t.WordArray,i=t.BufferedBlockAlgorithm,a=e.enc;a.Utf8;var s=a.Base64,l=e.algo.EvpKDF,c=t.Cipher=i.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r),this._xformMode=e,this._key=t,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?v:m}return function(t){return{encrypt:function(r,n,o){return e(n).encrypt(t,r,n,o)},decrypt:function(r,n,o){return e(n).decrypt(t,r,n,o)}}}}()});t.StreamCipher=c.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=e.mode={},d=t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),h=u.CBC=function(){var e=d.extend();function t(e,t,r){var n,o=this._iv;o?(n=o,this._iv=undefined):n=this._prevBlock;for(var i=0;i<r;i++)e[t+i]^=n[i]}return e.Encryptor=e.extend({processBlock:function(e,r){var n=this._cipher,o=n.blockSize;t.call(this,e,r,o),n.encryptBlock(e,r),this._prevBlock=e.slice(r,r+o)}}),e.Decryptor=e.extend({processBlock:function(e,r){var n=this._cipher,o=n.blockSize,i=e.slice(r,r+o);n.decryptBlock(e,r),t.call(this,e,r,o),this._prevBlock=i}}),e}(),p=(e.pad={}).Pkcs7={pad:function(e,t){for(var r=4*t,n=r-e.sigBytes%r,i=n<<24|n<<16|n<<8|n,a=[],s=0;s<n;s+=4)a.push(i);var l=o.create(a,n);e.concat(l)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}};t.BlockCipher=c.extend({cfg:c.cfg.extend({mode:h,padding:p}),reset:function(){var e;c.reset.call(this);var t=this.cfg,r=t.iv,n=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=n.createEncryptor:(e=n.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,r&&r.words):(this._mode=e.call(n,this,r&&r.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4});var f=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),g=(e.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,r=e.salt;return(r?o.create([1398893684,1701076831]).concat(r).concat(t):t).toString(s)},parse:function(e){var t,r=s.parse(e),n=r.words;return 1398893684==n[0]&&1701076831==n[1]&&(t=o.create(n.slice(2,4)),n.splice(0,4),r.sigBytes-=16),f.create({ciphertext:r,salt:t})}},m=t.SerializableCipher=n.extend({cfg:n.extend({format:g}),encrypt:function(e,t,r,n){n=this.cfg.extend(n);var o=e.createEncryptor(r,n),i=o.finalize(t),a=o.cfg;return f.create({ciphertext:i,key:r,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,r,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),e.createDecryptor(r,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),y=(e.kdf={}).OpenSSL={execute:function(e,t,r,n){n||(n=o.random(8));var i=l.create({keySize:t+r}).compute(e,n),a=o.create(i.words.slice(t),4*r);return i.sigBytes=4*t,f.create({key:i,iv:a,salt:n})}},v=t.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:y}),encrypt:function(e,t,r,n){var o=(n=this.cfg.extend(n)).kdf.execute(r,e.keySize,e.ivSize);n.iv=o.iv;var i=m.encrypt.call(this,e,t,o.key,n);return i.mixIn(o),i},decrypt:function(e,t,r,n){n=this.cfg.extend(n),t=this._parse(t,n.format);var o=n.kdf.execute(r,e.keySize,e.ivSize,t.salt);return n.iv=o.iv,m.decrypt.call(this,e,t,o.key,n)}})}())})),e$1((function(e,t){var r;e.exports=((r=i).mode.CFB=function(){var e=r.lib.BlockCipherMode.extend();function t(e,t,r,n){var o,i=this._iv;i?(o=i.slice(0),this._iv=void 0):o=this._prevBlock,n.encryptBlock(o,0);for(var a=0;a<r;a++)e[t+a]^=o[a]}return e.Encryptor=e.extend({processBlock:function(e,r){var n=this._cipher,o=n.blockSize;t.call(this,e,r,o,n),this._prevBlock=e.slice(r,r+o)}}),e.Decryptor=e.extend({processBlock:function(e,r){var n=this._cipher,o=n.blockSize,i=e.slice(r,r+o);t.call(this,e,r,o,n),this._prevBlock=i}}),e}(),r.mode.CFB)})),e$1((function(e,t){var r,n,o;e.exports=((o=i).mode.CTR=(n=(r=o.lib.BlockCipherMode.extend()).Encryptor=r.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize,o=this._iv,i=this._counter;o&&(i=this._counter=o.slice(0),this._iv=void 0);var a=i.slice(0);r.encryptBlock(a,0),i[n-1]=i[n-1]+1|0;for(var s=0;s<n;s++)e[t+s]^=a[s]}}),r.Decryptor=n,r),o.mode.CTR)})),e$1((function(e,t){var r;e.exports=((r=i).mode.CTRGladman=function(){var e=r.lib.BlockCipherMode.extend();function t(e){if(255&~(e>>24))e+=1<<24;else{var t=e>>16&255,r=e>>8&255,n=255&e;255===t?(t=0,255===r?(r=0,255===n?n=0:++n):++r):++t,e=0,e+=t<<16,e+=r<<8,e+=n}return e}var n=e.Encryptor=e.extend({processBlock:function(e,r){var n=this._cipher,o=n.blockSize,i=this._iv,a=this._counter;i&&(a=this._counter=i.slice(0),this._iv=void 0),function(e){0===(e[0]=t(e[0]))&&(e[1]=t(e[1]))}(a);var s=a.slice(0);n.encryptBlock(s,0);for(var l=0;l<o;l++)e[r+l]^=s[l]}});return e.Decryptor=n,e}(),r.mode.CTRGladman)})),e$1((function(e,t){var r,n,o;e.exports=((o=i).mode.OFB=(n=(r=o.lib.BlockCipherMode.extend()).Encryptor=r.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize,o=this._iv,i=this._keystream;o&&(i=this._keystream=o.slice(0),this._iv=void 0),r.encryptBlock(i,0);for(var a=0;a<n;a++)e[t+a]^=i[a]}}),r.Decryptor=n,r),o.mode.OFB)})),e$1((function(e,t){var r,n;e.exports=((n=i).mode.ECB=((r=n.lib.BlockCipherMode.extend()).Encryptor=r.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),r.Decryptor=r.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),r),n.mode.ECB)})),e$1((function(e,t){var r;e.exports=((r=i).pad.AnsiX923={pad:function(e,t){var r=e.sigBytes,n=4*t,o=n-r%n,i=r+o-1;e.clamp(),e.words[i>>>2]|=o<<24-i%4*8,e.sigBytes+=o},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.pad.Ansix923)})),e$1((function(e,t){var r;e.exports=((r=i).pad.Iso10126={pad:function(e,t){var n=4*t,o=n-e.sigBytes%n;e.concat(r.lib.WordArray.random(o-1)).concat(r.lib.WordArray.create([o<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.pad.Iso10126)})),e$1((function(e,t){var r;e.exports=((r=i).pad.Iso97971={pad:function(e,t){e.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(e,t)},unpad:function(e){r.pad.ZeroPadding.unpad(e),e.sigBytes--}},r.pad.Iso97971)})),e$1((function(e,t){var r;e.exports=((r=i).pad.ZeroPadding={pad:function(e,t){var r=4*t;e.clamp(),e.sigBytes+=r-(e.sigBytes%r||r)},unpad:function(e){var t=e.words,r=e.sigBytes-1;for(r=e.sigBytes-1;r>=0;r--)if(t[r>>>2]>>>24-r%4*8&255){e.sigBytes=r+1;break}}},r.pad.ZeroPadding)})),e$1((function(e,t){var r;e.exports=((r=i).pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding)})),e$1((function(e,t){var r;e.exports=(r=i,function(){var e=r,t=e.lib.CipherParams,n=e.enc.Hex;e.format.Hex={stringify:function(e){return e.ciphertext.toString(n)},parse:function(e){var r=n.parse(e);return t.create({ciphertext:r})}}}(),r.format.Hex)})),e$1((function(e,t){var r;e.exports=(r=i,function(){var e=r,t=e.lib.BlockCipher,n=e.algo,o=[],i=[],a=[],s=[],l=[],c=[],u=[],d=[],h=[],p=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var r=0,n=0;for(t=0;t<256;t++){var f=n^n<<1^n<<2^n<<3^n<<4;f=f>>>8^255&f^99,o[r]=f,i[f]=r;var g=e[r],m=e[g],y=e[m],v=257*e[f]^16843008*f;a[r]=v<<24|v>>>8,s[r]=v<<16|v>>>16,l[r]=v<<8|v>>>24,c[r]=v,v=16843009*y^65537*m^257*g^16843008*r,u[f]=v<<24|v>>>8,d[f]=v<<16|v>>>16,h[f]=v<<8|v>>>24,p[f]=v,r?(r=g^e[e[e[y^g]]],n^=e[e[n]]):r=n=1}}();var f=[0,1,2,4,8,16,32,64,128,27,54],g=n.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,r=e.sigBytes/4,n=4*((this._nRounds=r+6)+1),i=this._keySchedule=[],a=0;a<n;a++)a<r?i[a]=t[a]:(c=i[a-1],a%r?r>6&&a%r==4&&(c=o[c>>>24]<<24|o[c>>>16&255]<<16|o[c>>>8&255]<<8|o[255&c]):(c=o[(c=c<<8|c>>>24)>>>24]<<24|o[c>>>16&255]<<16|o[c>>>8&255]<<8|o[255&c],c^=f[a/r|0]<<24),i[a]=i[a-r]^c);for(var s=this._invKeySchedule=[],l=0;l<n;l++){if(a=n-l,l%4)var c=i[a];else c=i[a-4];s[l]=l<4||a<=4?c:u[o[c>>>24]]^d[o[c>>>16&255]]^h[o[c>>>8&255]]^p[o[255&c]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,s,l,c,o)},decryptBlock:function(e,t){var r=e[t+1];e[t+1]=e[t+3],e[t+3]=r,this._doCryptBlock(e,t,this._invKeySchedule,u,d,h,p,i),r=e[t+1],e[t+1]=e[t+3],e[t+3]=r},_doCryptBlock:function(e,t,r,n,o,i,a,s){for(var l=this._nRounds,c=e[t]^r[0],u=e[t+1]^r[1],d=e[t+2]^r[2],h=e[t+3]^r[3],p=4,f=1;f<l;f++){var g=n[c>>>24]^o[u>>>16&255]^i[d>>>8&255]^a[255&h]^r[p++],m=n[u>>>24]^o[d>>>16&255]^i[h>>>8&255]^a[255&c]^r[p++],y=n[d>>>24]^o[h>>>16&255]^i[c>>>8&255]^a[255&u]^r[p++],v=n[h>>>24]^o[c>>>16&255]^i[u>>>8&255]^a[255&d]^r[p++];c=g,u=m,d=y,h=v}g=(s[c>>>24]<<24|s[u>>>16&255]<<16|s[d>>>8&255]<<8|s[255&h])^r[p++],m=(s[u>>>24]<<24|s[d>>>16&255]<<16|s[h>>>8&255]<<8|s[255&c])^r[p++],y=(s[d>>>24]<<24|s[h>>>16&255]<<16|s[c>>>8&255]<<8|s[255&u])^r[p++],v=(s[h>>>24]<<24|s[c>>>16&255]<<16|s[u>>>8&255]<<8|s[255&d])^r[p++],e[t]=g,e[t+1]=m,e[t+2]=y,e[t+3]=v},keySize:8});e.AES=t._createHelper(g)}(),r.AES)})),e$1((function(e,t){var r;e.exports=(r=i,function(){var e=r,t=e.lib,n=t.WordArray,o=t.BlockCipher,i=e.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],l=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],u=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=i.DES=o.extend({_doReset:function(){for(var e=this._key.words,t=[],r=0;r<56;r++){var n=a[r]-1;t[r]=e[n>>>5]>>>31-n%32&1}for(var o=this._subKeys=[],i=0;i<16;i++){var c=o[i]=[],u=l[i];for(r=0;r<24;r++)c[r/6|0]|=t[(s[r]-1+u)%28]<<31-r%6,c[4+(r/6|0)]|=t[28+(s[r+24]-1+u)%28]<<31-r%6;for(c[0]=c[0]<<1|c[0]>>>31,r=1;r<7;r++)c[r]=c[r]>>>4*(r-1)+3;c[7]=c[7]<<5|c[7]>>>27}var d=this._invSubKeys=[];for(r=0;r<16;r++)d[r]=o[15-r]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,r){this._lBlock=e[t],this._rBlock=e[t+1],h.call(this,4,252645135),h.call(this,16,65535),p.call(this,2,858993459),p.call(this,8,16711935),h.call(this,1,1431655765);for(var n=0;n<16;n++){for(var o=r[n],i=this._lBlock,a=this._rBlock,s=0,l=0;l<8;l++)s|=c[l][((a^o[l])&u[l])>>>0];this._lBlock=a,this._rBlock=i^s}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,h.call(this,1,1431655765),p.call(this,8,16711935),p.call(this,2,858993459),h.call(this,16,65535),h.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function h(e,t){var r=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=r,this._lBlock^=r<<e}function p(e,t){var r=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=r,this._rBlock^=r<<e}e.DES=o._createHelper(d);var f=i.TripleDES=o.extend({_doReset:function(){var e=this._key.words;if(2!==e.length&&4!==e.length&&e.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var t=e.slice(0,2),r=e.length<4?e.slice(0,2):e.slice(2,4),o=e.length<6?e.slice(0,2):e.slice(4,6);this._des1=d.createEncryptor(n.create(t)),this._des2=d.createEncryptor(n.create(r)),this._des3=d.createEncryptor(n.create(o))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=o._createHelper(f)}(),r.TripleDES)})),e$1((function(e,t){var r;e.exports=(r=i,function(){var e=r,t=e.lib.StreamCipher,n=e.algo,o=n.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,r=e.sigBytes,n=this._S=[],o=0;o<256;o++)n[o]=o;o=0;for(var i=0;o<256;o++){var a=o%r,s=t[a>>>2]>>>24-a%4*8&255;i=(i+n[o]+s)%256;var l=n[o];n[o]=n[i],n[i]=l}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=i.call(this)},keySize:8,ivSize:0});function i(){for(var e=this._S,t=this._i,r=this._j,n=0,o=0;o<4;o++){r=(r+e[t=(t+1)%256])%256;var i=e[t];e[t]=e[r],e[r]=i,n|=e[(e[t]+e[r])%256]<<24-8*o}return this._i=t,this._j=r,n}e.RC4=t._createHelper(o);var a=n.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)i.call(this)}});e.RC4Drop=t._createHelper(a)}(),r.RC4)})),e$1((function(e,t){var r;e.exports=(r=i,function(){var e=r,t=e.lib.StreamCipher,n=e.algo,o=[],i=[],a=[],s=n.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,r=0;r<4;r++)e[r]=16711935&(e[r]<<8|e[r]>>>24)|4278255360&(e[r]<<24|e[r]>>>8);var n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],o=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,r=0;r<4;r++)l.call(this);for(r=0;r<8;r++)o[r]^=n[r+4&7];if(t){var i=t.words,a=i[0],s=i[1],c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=c>>>16|4294901760&u,h=u<<16|65535&c;for(o[0]^=c,o[1]^=d,o[2]^=u,o[3]^=h,o[4]^=c,o[5]^=d,o[6]^=u,o[7]^=h,r=0;r<4;r++)l.call(this)}},_doProcessBlock:function(e,t){var r=this._X;l.call(this),o[0]=r[0]^r[5]>>>16^r[3]<<16,o[1]=r[2]^r[7]>>>16^r[5]<<16,o[2]=r[4]^r[1]>>>16^r[7]<<16,o[3]=r[6]^r[3]>>>16^r[1]<<16;for(var n=0;n<4;n++)o[n]=16711935&(o[n]<<8|o[n]>>>24)|4278255360&(o[n]<<24|o[n]>>>8),e[t+n]^=o[n]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,r=0;r<8;r++)i[r]=t[r];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,r=0;r<8;r++){var n=e[r]+t[r],o=65535&n,s=n>>>16,l=((o*o>>>17)+o*s>>>15)+s*s,c=((4294901760&n)*n|0)+((65535&n)*n|0);a[r]=l^c}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.Rabbit=t._createHelper(s)}(),r.Rabbit)})),e$1((function(e,t){var r;e.exports=(r=i,function(){var e=r,t=e.lib.StreamCipher,n=e.algo,o=[],i=[],a=[],s=n.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],n=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var o=0;o<4;o++)l.call(this);for(o=0;o<8;o++)n[o]^=r[o+4&7];if(t){var i=t.words,a=i[0],s=i[1],c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=c>>>16|4294901760&u,h=u<<16|65535&c;for(n[0]^=c,n[1]^=d,n[2]^=u,n[3]^=h,n[4]^=c,n[5]^=d,n[6]^=u,n[7]^=h,o=0;o<4;o++)l.call(this)}},_doProcessBlock:function(e,t){var r=this._X;l.call(this),o[0]=r[0]^r[5]>>>16^r[3]<<16,o[1]=r[2]^r[7]>>>16^r[5]<<16,o[2]=r[4]^r[1]>>>16^r[7]<<16,o[3]=r[6]^r[3]>>>16^r[1]<<16;for(var n=0;n<4;n++)o[n]=16711935&(o[n]<<8|o[n]>>>24)|4278255360&(o[n]<<24|o[n]>>>8),e[t+n]^=o[n]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,r=0;r<8;r++)i[r]=t[r];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,r=0;r<8;r++){var n=e[r]+t[r],o=65535&n,s=n>>>16,l=((o*o>>>17)+o*s>>>15)+s*s,c=((4294901760&n)*n|0)+((65535&n)*n|0);a[r]=l^c}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.RabbitLegacy=t._createHelper(s)}(),r.RabbitLegacy)})),e$1((function(e,t){e.exports=i}))),t2;n.mode.ECB,n.pad.Pkcs7;var u$1="0123456789abcdefghijklmnopqrstuvwxyz";function c$1(e){return u$1.charAt(e)}function f$1(e,t){return e&t}function l$1(e,t){return e|t}function p$1(e,t){return e^t}function d$1(e,t){return e&~t}function g$1(e){if(0==e)return-1;var t=0;return!(65535&e)&&(e>>=16,t+=16),!(255&e)&&(e>>=8,t+=8),!(15&e)&&(e>>=4,t+=4),!(3&e)&&(e>>=2,t+=2),!(1&e)&&++t,t}function v$1(e){for(var t=0;0!=e;)e&=e-1,++t;return t}var y$1,m$1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function b$1(e){var t,r,n="";for(t=0;t+3<=e.length;t+=3)r=parseInt(e.substring(t,t+3),16),n+=m$1.charAt(r>>6)+m$1.charAt(63&r);for(t+1==e.length?(r=parseInt(e.substring(t,t+1),16),n+=m$1.charAt(r<<2)):t+2==e.length&&(r=parseInt(e.substring(t,t+2),16),n+=m$1.charAt(r>>2)+m$1.charAt((3&r)<<4));(3&n.length)>0;)n+="=";return n}function w$1(e){var t,r="",n=0,o=0;for(t=0;t<e.length&&"="!=e.charAt(t);++t){var i=m$1.indexOf(e.charAt(t));i<0||(0==n?(r+=c$1(i>>2),o=3&i,n=1):1==n?(r+=c$1(o<<2|i>>4),o=15&i,n=2):2==n?(r+=c$1(o),r+=c$1(i>>2),o=3&i,n=3):(r+=c$1(o<<2|i>>4),r+=c$1(15&i),n=0))}return 1==n&&(r+=c$1(o<<2)),r}var S$1,T$1=function(e){var t;if(void 0===y$1){var r="0123456789ABCDEF",n=" \f\n\r\t \u2028\u2029";for(y$1={},t=0;t<16;++t)y$1[r.charAt(t)]=t;for(r=r.toLowerCase(),t=10;t<16;++t)y$1[r.charAt(t)]=t;for(t=0;t<8;++t)y$1[n.charAt(t)]=-1}var o=[],i=0,a=0;for(t=0;t<e.length;++t){var s=e.charAt(t);if("="==s)break;if(-1!=(s=y$1[s])){if(void 0===s)throw new Error("Illegal character at offset "+t);i|=s,++a>=2?(o[o.length]=i,i=0,a=0):i<<=4}}if(a)throw new Error("Hex encoding incomplete: 4 bits missing");return o},B$1={decode:function(e){var t;if(void 0===S$1){var r="= \f\n\r\t \u2028\u2029";for(S$1=Object.create(null),t=0;t<64;++t)S$1["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t)]=t;for(S$1["-"]=62,S$1._=63,t=0;t<9;++t)S$1[r.charAt(t)]=-1}var n=[],o=0,i=0;for(t=0;t<e.length;++t){var a=e.charAt(t);if("="==a)break;if(-1!=(a=S$1[a])){if(void 0===a)throw new Error("Illegal character at offset "+t);o|=a,++i>=4?(n[n.length]=o>>16,n[n.length]=o>>8&255,n[n.length]=255&o,o=0,i=0):o<<=6}}switch(i){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:n[n.length]=o>>10;break;case 3:n[n.length]=o>>16,n[n.length]=o>>8&255}return n},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(e){var t=B$1.re.exec(e);if(t)if(t[1])e=t[1];else{if(!t[2])throw new Error("RegExp out of sync");e=t[2]}return B$1.decode(e)}},x$1=1e13,E$1=function(){function e(e){this.buf=[+e||0]}return e.prototype.mulAdd=function(e,t){var r,n,o=this.buf,i=o.length;for(r=0;r<i;++r)(n=o[r]*e+t)<x$1?t=0:n-=(t=0|n/x$1)*x$1,o[r]=n;t>0&&(o[r]=t)},e.prototype.sub=function(e){var t,r,n=this.buf,o=n.length;for(t=0;t<o;++t)(r=n[t]-e)<0?(r+=x$1,e=1):e=0,n[t]=r;for(;0===n[n.length-1];)n.pop()},e.prototype.toString=function(e){if(10!=(e||10))throw new Error("only base 10 is supported");for(var t=this.buf,r=t[t.length-1].toString(),n=t.length-2;n>=0;--n)r+=(x$1+t[n]).toString().substring(1);return r},e.prototype.valueOf=function(){for(var e=this.buf,t=0,r=e.length-1;r>=0;--r)t=t*x$1+e[r];return t},e.prototype.simplify=function(){var e=this.buf;return 1==e.length?e[0]:this},e}(),D$1="…",_$1=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,A$1=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;function R$1(e,t){return e.length>t&&(e=e.substring(0,t)+D$1),e}var F$1,I$1=function(){function e(t,r){this.hexDigits="0123456789ABCDEF",t instanceof e?(this.enc=t.enc,this.pos=t.pos):(this.enc=t,this.pos=r)}return e.prototype.get=function(e){if(void 0===e&&(e=this.pos++),e>=this.enc.length)throw new Error("Requesting byte offset ".concat(e," on a stream of length ").concat(this.enc.length));return"string"==typeof this.enc?this.enc.charCodeAt(e):this.enc[e]},e.prototype.hexByte=function(e){return this.hexDigits.charAt(e>>4&15)+this.hexDigits.charAt(15&e)},e.prototype.hexDump=function(e,t,r){for(var n="",o=e;o<t;++o)if(n+=this.hexByte(this.get(o)),!0!==r)switch(15&o){case 7:n+="  ";break;case 15:n+="\n";break;default:n+=" "}return n},e.prototype.isASCII=function(e,t){for(var r=e;r<t;++r){var n=this.get(r);if(n<32||n>176)return!1}return!0},e.prototype.parseStringISO=function(e,t){for(var r="",n=e;n<t;++n)r+=String.fromCharCode(this.get(n));return r},e.prototype.parseStringUTF=function(e,t){for(var r="",n=e;n<t;){var o=this.get(n++);r+=o<128?String.fromCharCode(o):o>191&&o<224?String.fromCharCode((31&o)<<6|63&this.get(n++)):String.fromCharCode((15&o)<<12|(63&this.get(n++))<<6|63&this.get(n++))}return r},e.prototype.parseStringBMP=function(e,t){for(var r,n,o="",i=e;i<t;)r=this.get(i++),n=this.get(i++),o+=String.fromCharCode(r<<8|n);return o},e.prototype.parseTime=function(e,t,r){var n=this.parseStringISO(e,t),o=(r?_$1:A$1).exec(n);return o?(r&&(o[1]=+o[1],o[1]+=+o[1]<70?2e3:1900),n=o[1]+"-"+o[2]+"-"+o[3]+" "+o[4],o[5]&&(n+=":"+o[5],o[6]&&(n+=":"+o[6],o[7]&&(n+="."+o[7]))),o[8]&&(n+=" UTC","Z"!=o[8]&&(n+=o[8],o[9]&&(n+=":"+o[9]))),n):"Unrecognized time: "+n},e.prototype.parseInteger=function(e,t){for(var r,n=this.get(e),o=n>127,i=o?255:0,a="";n==i&&++e<t;)n=this.get(e);if(0==(r=t-e))return o?-1:0;if(r>4){for(a=n,r<<=3;!(128&(+a^i));)a=+a<<1,--r;a="("+r+" bit)\n"}o&&(n-=256);for(var s=new E$1(n),l=e+1;l<t;++l)s.mulAdd(256,this.get(l));return a+s.toString()},e.prototype.parseBitString=function(e,t,r){for(var n=this.get(e),o="("+((t-e-1<<3)-n)+" bit)\n",i="",a=e+1;a<t;++a){for(var s=this.get(a),l=a==t-1?n:0,c=7;c>=l;--c)i+=s>>c&1?"1":"0";if(i.length>r)return o+R$1(i,r)}return o+i},e.prototype.parseOctetString=function(e,t,r){if(this.isASCII(e,t))return R$1(this.parseStringISO(e,t),r);var n=t-e,o="("+n+" byte)\n";n>(r/=2)&&(t=e+r);for(var i=e;i<t;++i)o+=this.hexByte(this.get(i));return n>r&&(o+=D$1),o},e.prototype.parseOID=function(e,t,r){for(var n="",o=new E$1,i=0,a=e;a<t;++a){var s=this.get(a);if(o.mulAdd(128,127&s),i+=7,!(128&s)){if(""===n)if((o=o.simplify())instanceof E$1)o.sub(80),n="2."+o.toString();else{var l=o<80?o<40?0:1:2;n=l+"."+(o-40*l)}else n+="."+o.toString();if(n.length>r)return R$1(n,r);o=new E$1,i=0}}return i>0&&(n+=".incomplete"),n},e}(),O$1=function(){function e(e,t,r,n,o){if(!(n instanceof k$1))throw new Error("Invalid tag value.");this.stream=e,this.header=t,this.length=r,this.tag=n,this.sub=o}return e.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}},e.prototype.content=function(e){if(void 0===this.tag)return null;void 0===e&&(e=1/0);var t=this.posContent(),r=Math.abs(this.length);if(!this.tag.isUniversal())return null!==this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(t,t+r,e);switch(this.tag.tagNumber){case 1:return 0===this.stream.get(t)?"false":"true";case 2:return this.stream.parseInteger(t,t+r);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(t,t+r,e);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(t,t+r,e);case 6:return this.stream.parseOID(t,t+r,e);case 16:case 17:return null!==this.sub?"("+this.sub.length+" elem)":"(no elem)";case 12:return R$1(this.stream.parseStringUTF(t,t+r),e);case 18:case 19:case 20:case 21:case 22:case 26:return R$1(this.stream.parseStringISO(t,t+r),e);case 30:return R$1(this.stream.parseStringBMP(t,t+r),e);case 23:case 24:return this.stream.parseTime(t,t+r,23==this.tag.tagNumber)}return null},e.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},e.prototype.toPrettyString=function(e){void 0===e&&(e="");var t=e+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(t+="+"),t+=this.length,this.tag.tagConstructed?t+=" (constructed)":!this.tag.isUniversal()||3!=this.tag.tagNumber&&4!=this.tag.tagNumber||null===this.sub||(t+=" (encapsulates)"),t+="\n",null!==this.sub){e+="  ";for(var r=0,n=this.sub.length;r<n;++r)t+=this.sub[r].toPrettyString(e)}return t},e.prototype.posStart=function(){return this.stream.pos},e.prototype.posContent=function(){return this.stream.pos+this.header},e.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},e.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},e.decodeLength=function(e){var t=e.get(),r=127&t;if(r==t)return r;if(r>6)throw new Error("Length over 48 bits not supported at position "+(e.pos-1));if(0===r)return null;t=0;for(var n=0;n<r;++n)t=256*t+e.get();return t},e.prototype.getHexStringValue=function(){var e=this.toHexString(),t=2*this.header,r=2*this.length;return e.substr(t,r)},e.decode=function(t){var r;r=t instanceof I$1?t:new I$1(t,0);var n=new I$1(r),o=new k$1(r),i=e.decodeLength(r),a=r.pos,s=a-n.pos,l=null,c=function(){var t=[];if(null!==i){for(var n=a+i;r.pos<n;)t[t.length]=e.decode(r);if(r.pos!=n)throw new Error("Content size is not correct for container starting at offset "+a)}else try{for(;;){var o=e.decode(r);if(o.tag.isEOC())break;t[t.length]=o}i=a-r.pos}catch(s){throw new Error("Exception while decoding undefined length content: "+s)}return t};if(o.tagConstructed)l=c();else if(o.isUniversal()&&(3==o.tagNumber||4==o.tagNumber))try{if(3==o.tagNumber&&0!=r.get())throw new Error("BIT STRINGs with unused bits cannot encapsulate.");l=c();for(var u=0;u<l.length;++u)if(l[u].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch(d){l=null}if(null===l){if(null===i)throw new Error("We can't skip over an invalid tag with undefined length at offset "+a);r.pos=a+Math.abs(i)}return new e(n,s,i,o,l)},e}(),k$1=function(){function e(e){var t=e.get();if(this.tagClass=t>>6,this.tagConstructed=!!(32&t),this.tagNumber=31&t,31==this.tagNumber){var r=new E$1;do{t=e.get(),r.mulAdd(128,127&t)}while(128&t);this.tagNumber=r.simplify()}}return e.prototype.isUniversal=function(){return 0===this.tagClass},e.prototype.isEOC=function(){return 0===this.tagClass&&0===this.tagNumber},e}(),H$1=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],C$1=(1<<26)/H$1[H$1.length-1],P$1=function(){function e(e,t,r){null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}return e.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,o=!1,i="",a=this.t,s=this.DB-a*this.DB%t;if(a-- >0)for(s<this.DB&&(r=this[a]>>s)>0&&(o=!0,i=c$1(r));a>=0;)s<t?(r=(this[a]&(1<<s)-1)<<t-s,r|=this[--a]>>(s+=this.DB-t)):(r=this[a]>>(s-=t)&n,s<=0&&(s+=this.DB,--a)),r>0&&(o=!0),o&&(i+=c$1(r));return o?i:"0"},e.prototype.negate=function(){var t=z$1();return e.ZERO.subTo(this,t),t},e.prototype.abs=function(){return this.s<0?this.negate():this},e.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this[r]-e[r]))return t;return 0},e.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+G$1(this[this.t-1]^this.s&this.DM)},e.prototype.mod=function(t){var r=z$1();return this.abs().divRemTo(t,null,r),this.s<0&&r.compareTo(e.ZERO)>0&&t.subTo(r,r),r},e.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new V(t):new q$1(t),this.exp(e,r)},e.prototype.clone=function(){var e=z$1();return this.copyTo(e),e},e.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},e.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},e.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},e.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},e.prototype.toByteArray=function(){var e=this.t,t=[];t[0]=this.s;var r,n=this.DB-e*this.DB%8,o=0;if(e-- >0)for(n<this.DB&&(r=this[e]>>n)!=(this.s&this.DM)>>n&&(t[o++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this[e]&(1<<n)-1)<<8-n,r|=this[--e]>>(n+=this.DB-8)):(r=this[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),!!(128&r)&&(r|=-256),0==o&&(128&this.s)!=(128&r)&&++o,(o>0||r!=this.s)&&(t[o++]=r);return t},e.prototype.equals=function(e){return 0==this.compareTo(e)},e.prototype.min=function(e){return this.compareTo(e)<0?this:e},e.prototype.max=function(e){return this.compareTo(e)>0?this:e},e.prototype.and=function(e){var t=z$1();return this.bitwiseTo(e,f$1,t),t},e.prototype.or=function(e){var t=z$1();return this.bitwiseTo(e,l$1,t),t},e.prototype.xor=function(e){var t=z$1();return this.bitwiseTo(e,p$1,t),t},e.prototype.andNot=function(e){var t=z$1();return this.bitwiseTo(e,d$1,t),t},e.prototype.not=function(){for(var e=z$1(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},e.prototype.shiftLeft=function(e){var t=z$1();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},e.prototype.shiftRight=function(e){var t=z$1();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},e.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+g$1(this[e]);return this.s<0?this.t*this.DB:-1},e.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=v$1(this[r]^t);return e},e.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:!!(this[t]&1<<e%this.DB)},e.prototype.setBit=function(e){return this.changeBit(e,l$1)},e.prototype.clearBit=function(e){return this.changeBit(e,d$1)},e.prototype.flipBit=function(e){return this.changeBit(e,p$1)},e.prototype.add=function(e){var t=z$1();return this.addTo(e,t),t},e.prototype.subtract=function(e){var t=z$1();return this.subTo(e,t),t},e.prototype.multiply=function(e){var t=z$1();return this.multiplyTo(e,t),t},e.prototype.divide=function(e){var t=z$1();return this.divRemTo(e,t,null),t},e.prototype.remainder=function(e){var t=z$1();return this.divRemTo(e,null,t),t},e.prototype.divideAndRemainder=function(e){var t=z$1(),r=z$1();return this.divRemTo(e,t,r),[t,r]},e.prototype.modPow=function(e,t){var r,n,o=e.bitLength(),i=X(1);if(o<=0)return i;r=o<18?1:o<48?3:o<144?4:o<768?5:6,n=o<8?new V(t):t.isEven()?new N$1(t):new q$1(t);var a=[],s=3,l=r-1,c=(1<<r)-1;if(a[1]=n.convert(this),r>1){var u=z$1();for(n.sqrTo(a[1],u);s<=c;)a[s]=z$1(),n.mulTo(u,a[s-2],a[s]),s+=2}var d,h,p=e.t-1,f=!0,g=z$1();for(o=G$1(e[p])-1;p>=0;){for(o>=l?d=e[p]>>o-l&c:(d=(e[p]&(1<<o+1)-1)<<l-o,p>0&&(d|=e[p-1]>>this.DB+o-l)),s=r;!(1&d);)d>>=1,--s;if((o-=s)<0&&(o+=this.DB,--p),f)a[d].copyTo(i),f=!1;else{for(;s>1;)n.sqrTo(i,g),n.sqrTo(g,i),s-=2;s>0?n.sqrTo(i,g):(h=i,i=g,g=h),n.mulTo(g,a[d],i)}for(;p>=0&&!(e[p]&1<<o);)n.sqrTo(i,g),h=i,i=g,g=h,--o<0&&(o=this.DB-1,--p)}return n.revert(i)},e.prototype.modInverse=function(t){var r=t.isEven();if(this.isEven()&&r||0==t.signum())return e.ZERO;for(var n=t.clone(),o=this.clone(),i=X(1),a=X(0),s=X(0),l=X(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),r?(i.isEven()&&a.isEven()||(i.addTo(this,i),a.subTo(t,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;o.isEven();)o.rShiftTo(1,o),r?(s.isEven()&&l.isEven()||(s.addTo(this,s),l.subTo(t,l)),s.rShiftTo(1,s)):l.isEven()||l.subTo(t,l),l.rShiftTo(1,l);n.compareTo(o)>=0?(n.subTo(o,n),r&&i.subTo(s,i),a.subTo(l,a)):(o.subTo(n,o),r&&s.subTo(i,s),l.subTo(a,l))}return 0!=o.compareTo(e.ONE)?e.ZERO:l.compareTo(t)>=0?l.subtract(t):l.signum()<0?(l.addTo(t,l),l.signum()<0?l.add(t):l):l},e.prototype.pow=function(e){return this.exp(e,new M$1)},e.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var o=t.getLowestSetBit(),i=r.getLowestSetBit();if(i<0)return t;for(o<i&&(i=o),i>0&&(t.rShiftTo(i,t),r.rShiftTo(i,r));t.signum()>0;)(o=t.getLowestSetBit())>0&&t.rShiftTo(o,t),(o=r.getLowestSetBit())>0&&r.rShiftTo(o,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return i>0&&r.lShiftTo(i,r),r},e.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=H$1[H$1.length-1]){for(t=0;t<H$1.length;++t)if(r[0]==H$1[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<H$1.length;){for(var n=H$1[t],o=t+1;o<H$1.length&&n<C$1;)n*=H$1[o++];for(n=r.modInt(n);t<o;)if(n%H$1[t++]==0)return!1}return r.millerRabin(e)},e.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},e.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},e.prototype.fromString=function(t,r){var n;if(16==r)n=4;else if(8==r)n=3;else if(256==r)n=8;else if(2==r)n=1;else if(32==r)n=5;else{if(4!=r)return void this.fromRadix(t,r);n=2}this.t=0,this.s=0;for(var o=t.length,i=!1,a=0;--o>=0;){var s=8==n?255&+t[o]:W(t,o);s<0?"-"==t.charAt(o)&&(i=!0):(i=!1,0==a?this[this.t++]=s:a+n>this.DB?(this[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this[this.t++]=s>>this.DB-a):this[this.t-1]|=s<<a,(a+=n)>=this.DB&&(a-=this.DB))}8==n&&!!(128&+t[0])&&(this.s=-1,a>0&&(this[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),i&&e.ZERO.subTo(this,this)},e.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},e.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s},e.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},e.prototype.lShiftTo=function(e,t){for(var r=e%this.DB,n=this.DB-r,o=(1<<n)-1,i=Math.floor(e/this.DB),a=this.s<<r&this.DM,s=this.t-1;s>=0;--s)t[s+i+1]=this[s]>>n|a,a=(this[s]&o)<<r;for(s=i-1;s>=0;--s)t[s]=0;t[i]=a,t.t=this.t+i+1,t.s=this.s,t.clamp()},e.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,o=this.DB-n,i=(1<<n)-1;t[0]=this[r]>>n;for(var a=r+1;a<this.t;++a)t[a-r-1]|=(this[a]&i)<<o,t[a-r]=this[a]>>n;n>0&&(t[this.t-r-1]|=(this.s&i)<<o),t.t=this.t-r,t.clamp()}},e.prototype.subTo=function(e,t){for(var r=0,n=0,o=Math.min(e.t,this.t);r<o;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()},e.prototype.multiplyTo=function(t,r){var n=this.abs(),o=t.abs(),i=n.t;for(r.t=i+o.t;--i>=0;)r[i]=0;for(i=0;i<o.t;++i)r[i+n.t]=n.am(0,o[i],r,i,0,n.t);r.s=0,r.clamp(),this.s!=t.s&&e.ZERO.subTo(r,r)},e.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},e.prototype.divRemTo=function(t,r,n){var o=t.abs();if(!(o.t<=0)){var i=this.abs();if(i.t<o.t)return null!=r&&r.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=z$1());var a=z$1(),s=this.s,l=t.s,c=this.DB-G$1(o[o.t-1]);c>0?(o.lShiftTo(c,a),i.lShiftTo(c,n)):(o.copyTo(a),i.copyTo(n));var u=a.t,d=a[u-1];if(0!=d){var h=d*(1<<this.F1)+(u>1?a[u-2]>>this.F2:0),p=this.FV/h,f=(1<<this.F1)/h,g=1<<this.F2,m=n.t,y=m-u,v=null==r?z$1():r;for(a.dlShiftTo(y,v),n.compareTo(v)>=0&&(n[n.t++]=1,n.subTo(v,n)),e.ONE.dlShiftTo(u,v),v.subTo(a,a);a.t<u;)a[a.t++]=0;for(;--y>=0;){var _=n[--m]==d?this.DM:Math.floor(n[m]*p+(n[m-1]+g)*f);if((n[m]+=a.am(0,_,n,y,0,u))<_)for(a.dlShiftTo(y,v),n.subTo(v,n);n[m]<--_;)n.subTo(v,n)}null!=r&&(n.drShiftTo(u,r),s!=l&&e.ZERO.subTo(r,r)),n.t=u,n.clamp(),c>0&&n.rShiftTo(c,n),s<0&&e.ZERO.subTo(n,n)}}},e.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(!(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},e.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},e.prototype.exp=function(t,r){if(t>4294967295||t<1)return e.ONE;var n=z$1(),o=z$1(),i=r.convert(this),a=G$1(t)-1;for(i.copyTo(n);--a>=0;)if(r.sqrTo(n,o),(t&1<<a)>0)r.mulTo(o,i,n);else{var s=n;n=o,o=s}return r.revert(n)},e.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},e.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=X(r),o=z$1(),i=z$1(),a="";for(this.divRemTo(n,o,i);o.signum()>0;)a=(r+i.intValue()).toString(e).substr(1)+a,o.divRemTo(n,o,i);return i.intValue().toString(e)+a},e.prototype.fromRadix=function(t,r){this.fromInt(0),null==r&&(r=10);for(var n=this.chunkSize(r),o=Math.pow(r,n),i=!1,a=0,s=0,l=0;l<t.length;++l){var c=W(t,l);c<0?"-"==t.charAt(l)&&0==this.signum()&&(i=!0):(s=r*s+c,++a>=n&&(this.dMultiply(o),this.dAddOffset(s,0),a=0,s=0))}a>0&&(this.dMultiply(Math.pow(r,a)),this.dAddOffset(s,0)),i&&e.ZERO.subTo(this,this)},e.prototype.fromNumber=function(t,r,n){if("number"==typeof r)if(t<2)this.fromInt(1);else for(this.fromNumber(t,n),this.testBit(t-1)||this.bitwiseTo(e.ONE.shiftLeft(t-1),l$1,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(r);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(e.ONE.shiftLeft(t-1),this);else{var o=[],i=7&t;o.length=1+(t>>3),r.nextBytes(o),i>0?o[0]&=(1<<i)-1:o[0]=0,this.fromString(o,256)}},e.prototype.bitwiseTo=function(e,t,r){var n,o,i=Math.min(e.t,this.t);for(n=0;n<i;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(o=e.s&this.DM,n=i;n<this.t;++n)r[n]=t(this[n],o);r.t=this.t}else{for(o=this.s&this.DM,n=i;n<e.t;++n)r[n]=t(o,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},e.prototype.changeBit=function(t,r){var n=e.ONE.shiftLeft(t);return this.bitwiseTo(n,r,n),n},e.prototype.addTo=function(e,t){for(var r=0,n=0,o=Math.min(e.t,this.t);r<o;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()},e.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},e.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},e.prototype.multiplyLowerTo=function(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r[--n]=0;for(var o=r.t-this.t;n<o;++n)r[n+this.t]=this.am(0,e[n],r,n,0,this.t);for(o=Math.min(e.t,t);n<o;++n)this.am(0,e[n],r,n,0,t-n);r.clamp()},e.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},e.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r},e.prototype.millerRabin=function(t){var r=this.subtract(e.ONE),n=r.getLowestSetBit();if(n<=0)return!1;var o=r.shiftRight(n);(t=t+1>>1)>H$1.length&&(t=H$1.length);for(var i=z$1(),a=0;a<t;++a){i.fromInt(H$1[Math.floor(Math.random()*H$1.length)]);var s=i.modPow(o,this);if(0!=s.compareTo(e.ONE)&&0!=s.compareTo(r)){for(var l=1;l++<n&&0!=s.compareTo(r);)if(0==(s=s.modPowInt(2,this)).compareTo(e.ONE))return!1;if(0!=s.compareTo(r))return!1}}return!0},e.prototype.square=function(){var e=z$1();return this.squareTo(e),e},e.prototype.gcda=function(e,t){var r=this.s<0?this.negate():this.clone(),n=e.s<0?e.negate():e.clone();if(r.compareTo(n)<0){var o=r;r=n,n=o}var i=r.getLowestSetBit(),a=n.getLowestSetBit();if(a<0)t(r);else{i<a&&(a=i),a>0&&(r.rShiftTo(a,r),n.rShiftTo(a,n));var s=function(){(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),(i=n.getLowestSetBit())>0&&n.rShiftTo(i,n),r.compareTo(n)>=0?(r.subTo(n,r),r.rShiftTo(1,r)):(n.subTo(r,n),n.rShiftTo(1,n)),r.signum()>0?setTimeout(s,0):(a>0&&n.lShiftTo(a,n),setTimeout((function(){t(n)}),0))};setTimeout(s,10)}},e.prototype.fromNumberAsync=function(t,r,n,o){if("number"==typeof r)if(t<2)this.fromInt(1);else{this.fromNumber(t,n),this.testBit(t-1)||this.bitwiseTo(e.ONE.shiftLeft(t-1),l$1,this),this.isEven()&&this.dAddOffset(1,0);var i=this,a=function(){i.dAddOffset(2,0),i.bitLength()>t&&i.subTo(e.ONE.shiftLeft(t-1),i),i.isProbablePrime(r)?setTimeout((function(){o()}),0):setTimeout(a,0)};setTimeout(a,0)}else{var s=[],l=7&t;s.length=1+(t>>3),r.nextBytes(s),l>0?s[0]&=(1<<l)-1:s[0]=0,this.fromString(s,256)}},e}(),M$1=function(){function e(){}return e.prototype.convert=function(e){return e},e.prototype.revert=function(e){return e},e.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},e.prototype.sqrTo=function(e,t){e.squareTo(t)},e}(),V=function(){function e(e){this.m=e}return e.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},e.prototype.revert=function(e){return e},e.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},e.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},e.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},e}(),q$1=function(){function e(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}return e.prototype.convert=function(e){var t=z$1();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(P$1.ZERO)>0&&this.m.subTo(t,t),t},e.prototype.revert=function(e){var t=z$1();return e.copyTo(t),this.reduce(t),t},e.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},e.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},e.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},e}(),N$1=function(){function e(e){this.m=e,this.r2=z$1(),this.q3=z$1(),P$1.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e)}return e.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=z$1();return e.copyTo(t),this.reduce(t),t},e.prototype.revert=function(e){return e},e.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},e.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},e.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},e}();function z$1(){return new P$1(null)}function L$1(e,t){return new P$1(e,t)}var j$1="undefined"!=typeof navigator;j$1&&"Microsoft Internet Explorer"==navigator.appName?(P$1.prototype.am=function(e,t,r,n,o,i){for(var a=32767&t,s=t>>15;--i>=0;){var l=32767&this[e],c=this[e++]>>15,u=s*l+c*a;o=((l=a*l+((32767&u)<<15)+r[n]+(1073741823&o))>>>30)+(u>>>15)+s*c+(o>>>30),r[n++]=1073741823&l}return o},F$1=30):j$1&&"Netscape"!=navigator.appName?(P$1.prototype.am=function(e,t,r,n,o,i){for(;--i>=0;){var a=t*this[e++]+r[n]+o;o=Math.floor(a/67108864),r[n++]=67108863&a}return o},F$1=26):(P$1.prototype.am=function(e,t,r,n,o,i){for(var a=16383&t,s=t>>14;--i>=0;){var l=16383&this[e],c=this[e++]>>14,u=s*l+c*a;o=((l=a*l+((16383&u)<<14)+r[n]+o)>>28)+(u>>14)+s*c,r[n++]=268435455&l}return o},F$1=28),P$1.prototype.DB=F$1,P$1.prototype.DM=(1<<F$1)-1,P$1.prototype.DV=1<<F$1,P$1.prototype.FV=Math.pow(2,52),P$1.prototype.F1=52-F$1,P$1.prototype.F2=2*F$1-52;var K$1,U,Z=[];for(K$1="0".charCodeAt(0),U=0;U<=9;++U)Z[K$1++]=U;for(K$1="a".charCodeAt(0),U=10;U<36;++U)Z[K$1++]=U;for(K$1="A".charCodeAt(0),U=10;U<36;++U)Z[K$1++]=U;function W(e,t){var r=Z[e.charCodeAt(t)];return null==r?-1:r}function X(e){var t=z$1();return t.fromInt(e),t}function G$1(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}P$1.ZERO=X(0),P$1.ONE=X(1);var Y=function(){function e(){this.i=0,this.j=0,this.S=[]}return e.prototype.init=function(e){var t,r,n;for(t=0;t<256;++t)this.S[t]=t;for(r=0,t=0;t<256;++t)r=r+this.S[t]+e[t%e.length]&255,n=this.S[t],this.S[t]=this.S[r],this.S[r]=n;this.i=0,this.j=0},e.prototype.next=function(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]},e}(),$,J$1,Q$1=null;if(null==Q$1){Q$1=[],J$1=0;var tt=void 0;if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues){var et=new Uint32Array(256);for(window.crypto.getRandomValues(et),tt=0;tt<et.length;++tt)Q$1[J$1++]=255&et[tt]}var rt=0,it=function(e){if((rt=rt||0)>=256||J$1>=256)window.removeEventListener?window.removeEventListener("mousemove",it,!1):window.detachEvent&&window.detachEvent("onmousemove",it);else try{var t=e.x+e.y;Q$1[J$1++]=255&t,rt+=1}catch(r){}};"undefined"!=typeof window&&(window.addEventListener?window.addEventListener("mousemove",it,!1):window.attachEvent&&window.attachEvent("onmousemove",it))}function nt(){if(null==$){for($=new Y;J$1<256;){var e=Math.floor(65536*Math.random());Q$1[J$1++]=255&e}for($.init(Q$1),J$1=0;J$1<Q$1.length;++J$1)Q$1[J$1]=0;J$1=0}return $.next()}var st=function(){function e(){}return e.prototype.nextBytes=function(e){for(var t=0;t<e.length;++t)e[t]=nt()},e}(),ot=function(){function e(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return e.prototype.doPublic=function(e){return e.modPowInt(this.e,this.n)},e.prototype.doPrivate=function(e){if(null==this.p||null==this.q)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),r=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(r)<0;)t=t.add(this.p);return t.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)},e.prototype.setPublic=function(e,t){null!=e&&null!=t&&e.length>0&&t.length>0?(this.n=L$1(e,16),this.e=parseInt(t,16)):console.error("Invalid RSA public key")},e.prototype.encrypt=function(e){var t=this.n.bitLength()+7>>3,r=function(e,t){if(t<e.length+11)return console.error("Message too long for RSA"),null;for(var r=[],n=e.length-1;n>=0&&t>0;){var o=e.charCodeAt(n--);o<128?r[--t]=o:o>127&&o<2048?(r[--t]=63&o|128,r[--t]=o>>6|192):(r[--t]=63&o|128,r[--t]=o>>6&63|128,r[--t]=o>>12|224)}r[--t]=0;for(var i=new st,a=[];t>2;){for(a[0]=0;0==a[0];)i.nextBytes(a);r[--t]=a[0]}return r[--t]=2,r[--t]=0,new P$1(r)}(e,t);if(null==r)return null;var n=this.doPublic(r);if(null==n)return null;for(var o=n.toString(16),i=o.length,a=0;a<2*t-i;a++)o="0"+o;return o},e.prototype.setPrivate=function(e,t,r){null!=e&&null!=t&&e.length>0&&t.length>0?(this.n=L$1(e,16),this.e=parseInt(t,16),this.d=L$1(r,16)):console.error("Invalid RSA private key")},e.prototype.setPrivateEx=function(e,t,r,n,o,i,a,s){null!=e&&null!=t&&e.length>0&&t.length>0?(this.n=L$1(e,16),this.e=parseInt(t,16),this.d=L$1(r,16),this.p=L$1(n,16),this.q=L$1(o,16),this.dmp1=L$1(i,16),this.dmq1=L$1(a,16),this.coeff=L$1(s,16)):console.error("Invalid RSA private key")},e.prototype.generate=function(e,t){var r=new st,n=e>>1;this.e=parseInt(t,16);for(var o=new P$1(t,16);;){for(;this.p=new P$1(e-n,1,r),0!=this.p.subtract(P$1.ONE).gcd(o).compareTo(P$1.ONE)||!this.p.isProbablePrime(10););for(;this.q=new P$1(n,1,r),0!=this.q.subtract(P$1.ONE).gcd(o).compareTo(P$1.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var i=this.p;this.p=this.q,this.q=i}var a=this.p.subtract(P$1.ONE),s=this.q.subtract(P$1.ONE),l=a.multiply(s);if(0==l.gcd(o).compareTo(P$1.ONE)){this.n=this.p.multiply(this.q),this.d=o.modInverse(l),this.dmp1=this.d.mod(a),this.dmq1=this.d.mod(s),this.coeff=this.q.modInverse(this.p);break}}},e.prototype.decrypt=function(e){var t=L$1(e,16),r=this.doPrivate(t);return null==r?null:function(e,t){for(var r=e.toByteArray(),n=0;n<r.length&&0==r[n];)++n;if(r.length-n!=t-1||2!=r[n])return null;for(++n;0!=r[n];)if(++n>=r.length)return null;for(var o="";++n<r.length;){var i=255&r[n];i<128?o+=String.fromCharCode(i):i>191&&i<224?(o+=String.fromCharCode((31&i)<<6|63&r[n+1]),++n):(o+=String.fromCharCode((15&i)<<12|(63&r[n+1])<<6|63&r[n+2]),n+=2)}return o}(r,this.n.bitLength()+7>>3)},e.prototype.generateAsync=function(e,t,r){var n=new st,o=e>>1;this.e=parseInt(t,16);var i=new P$1(t,16),a=this,s=function(){var t=function(){if(a.p.compareTo(a.q)<=0){var e=a.p;a.p=a.q,a.q=e}var t=a.p.subtract(P$1.ONE),n=a.q.subtract(P$1.ONE),o=t.multiply(n);0==o.gcd(i).compareTo(P$1.ONE)?(a.n=a.p.multiply(a.q),a.d=i.modInverse(o),a.dmp1=a.d.mod(t),a.dmq1=a.d.mod(n),a.coeff=a.q.modInverse(a.p),setTimeout((function(){r()}),0)):setTimeout(s,0)},l=function(){a.q=z$1(),a.q.fromNumberAsync(o,1,n,(function(){a.q.subtract(P$1.ONE).gcda(i,(function(e){0==e.compareTo(P$1.ONE)&&a.q.isProbablePrime(10)?setTimeout(t,0):setTimeout(l,0)}))}))},c=function(){a.p=z$1(),a.p.fromNumberAsync(e-o,1,n,(function(){a.p.subtract(P$1.ONE).gcda(i,(function(e){0==e.compareTo(P$1.ONE)&&a.p.isProbablePrime(10)?setTimeout(l,0):setTimeout(c,0)}))}))};setTimeout(c,0)};setTimeout(s,0)},e.prototype.sign=function(e,t,r){var n=function(e,t){if(t<e.length+22)return console.error("Message too long for RSA"),null;for(var r=t-e.length-6,n="",o=0;o<r;o+=2)n+="ff";return L$1("0001"+n+"00"+e,16)}((ht[r]||"")+t(e).toString(),this.n.bitLength()/4);if(null==n)return null;var o=this.doPrivate(n);if(null==o)return null;var i=o.toString(16);return 1&i.length?"0"+i:i},e.prototype.verify=function(e,t,r){var n=L$1(t,16),o=this.doPublic(n);return null==o?null:function(e){for(var t in ht)if(ht.hasOwnProperty(t)){var r=ht[t],n=r.length;if(e.substr(0,n)==r)return e.substr(n)}return e}(o.toString(16).replace(/^1f+00/,""))==r(e).toString()},e}(),ht={md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",ripemd160:"3021300906052b2403020105000414"},at={};at.lang={extend:function(e,t,r){if(!t||!e)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var n=function(){};if(n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t),r){var o;for(o in r)e.prototype[o]=r[o];var i=function(){},a=["toString","valueOf"];try{/MSIE/.test(navigator.userAgent)&&(i=function(e,t){for(o=0;o<a.length;o+=1){var r=a[o],n=t[r];"function"==typeof n&&n!=Object.prototype[r]&&(e[r]=n)}})}catch(s){}i(e.prototype,r)}}};var ut={};void 0!==ut.asn1&&ut.asn1||(ut.asn1={}),ut.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(e){var t=e.toString(16);if("-"!=t.substr(0,1))t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t);else{var r=t.substr(1).length;r%2==1?r+=1:t.match(/^[0-7]/)||(r+=2);for(var n="",o=0;o<r;o++)n+="f";t=new P$1(n,16).xor(e).add(P$1.ONE).toString(16).replace(/^-/,"")}return t},this.getPEMStringFromHex=function(e,t){return hextopem(e,t)},this.newObject=function(e){var t=ut.asn1,r=t.DERBoolean,n=t.DERInteger,o=t.DERBitString,i=t.DEROctetString,a=t.DERNull,s=t.DERObjectIdentifier,l=t.DEREnumerated,c=t.DERUTF8String,u=t.DERNumericString,d=t.DERPrintableString,h=t.DERTeletexString,p=t.DERIA5String,f=t.DERUTCTime,g=t.DERGeneralizedTime,m=t.DERSequence,y=t.DERSet,v=t.DERTaggedObject,_=t.ASN1Util.newObject,b=Object.keys(e);if(1!=b.length)throw"key of param shall be only one.";var C=b[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+C+":"))throw"undefined key: "+C;if("bool"==C)return new r(e[C]);if("int"==C)return new n(e[C]);if("bitstr"==C)return new o(e[C]);if("octstr"==C)return new i(e[C]);if("null"==C)return new a(e[C]);if("oid"==C)return new s(e[C]);if("enum"==C)return new l(e[C]);if("utf8str"==C)return new c(e[C]);if("numstr"==C)return new u(e[C]);if("prnstr"==C)return new d(e[C]);if("telstr"==C)return new h(e[C]);if("ia5str"==C)return new p(e[C]);if("utctime"==C)return new f(e[C]);if("gentime"==C)return new g(e[C]);if("seq"==C){for(var E=e[C],T=[],S=0;S<E.length;S++){var P=_(E[S]);T.push(P)}return new m({array:T})}if("set"==C){for(E=e[C],T=[],S=0;S<E.length;S++)P=_(E[S]),T.push(P);return new y({array:T})}if("tag"==C){var w=e[C];if("[object Array]"===Object.prototype.toString.call(w)&&3==w.length){var x=_(w[2]);return new v({tag:w[0],explicit:w[1],obj:x})}var O={};if(void 0!==w.explicit&&(O.explicit=w.explicit),void 0!==w.tag&&(O.tag=w.tag),void 0===w.obj)throw"obj shall be specified for 'tag'.";return O.obj=_(w.obj),new v(O)}},this.jsonToASN1HEX=function(e){return this.newObject(e).getEncodedHex()}},ut.asn1.ASN1Util.oidHexToInt=function(e){for(var t="",r=parseInt(e.substr(0,2),16),n=(t=Math.floor(r/40)+"."+r%40,""),o=2;o<e.length;o+=2){var i=("00000000"+parseInt(e.substr(o,2),16).toString(2)).slice(-8);n+=i.substr(1,7),"0"==i.substr(0,1)&&(t=t+"."+new P$1(n,2).toString(10),n="")}return t},ut.asn1.ASN1Util.oidIntToHex=function(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},r=function(e){var r="",n=new P$1(e,10).toString(2),o=7-n.length%7;7==o&&(o=0);for(var i="",a=0;a<o;a++)i+="0";for(n=i+n,a=0;a<n.length-1;a+=7){var s=n.substr(a,7);a!=n.length-7&&(s="1"+s),r+=t(parseInt(s,2))}return r};if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var n="",o=e.split("."),i=40*parseInt(o[0])+parseInt(o[1]);n+=t(i),o.splice(0,2);for(var a=0;a<o.length;a++)n+=r(o[a]);return n},ut.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n=0,v="+this.hV;var e=this.hV.length/2,t=e.toString(16);if(t.length%2==1&&(t="0"+t),e<128)return t;var r=t.length/2;if(r>15)throw"ASN.1 length too long to represent by 8x: n = "+e.toString(16);return(128+r).toString(16)+t},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},ut.asn1.DERAbstractString=function(e){ut.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=stohex(this.s)},this.setStringHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e?this.setString(e):void 0!==e.str?this.setString(e.str):void 0!==e.hex&&this.setStringHex(e.hex))},at.lang.extend(ut.asn1.DERAbstractString,ut.asn1.ASN1Object),ut.asn1.DERAbstractTime=function(e){ut.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(e){return utc=e.getTime()+6e4*e.getTimezoneOffset(),new Date(utc)},this.formatDate=function(e,t,r){var n=this.zeroPadding,o=this.localDateToUTC(e),i=String(o.getFullYear());"utc"==t&&(i=i.substr(2,2));var a=i+n(String(o.getMonth()+1),2)+n(String(o.getDate()),2)+n(String(o.getHours()),2)+n(String(o.getMinutes()),2)+n(String(o.getSeconds()),2);if(!0===r){var s=o.getMilliseconds();if(0!=s){var l=n(String(s),3);a=a+"."+(l=l.replace(/[0]+$/,""))}}return a+"Z"},this.zeroPadding=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=stohex(e)},this.setByDateValue=function(e,t,r,n,o,i){var a=new Date(Date.UTC(e,t-1,r,n,o,i,0));this.setByDate(a)},this.getFreshValueHex=function(){return this.hV}},at.lang.extend(ut.asn1.DERAbstractTime,ut.asn1.ASN1Object),ut.asn1.DERAbstractStructured=function(e){ut.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array=e},this.appendASN1Object=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array.push(e)},this.asn1Array=new Array,void 0!==e&&void 0!==e.array&&(this.asn1Array=e.array)},at.lang.extend(ut.asn1.DERAbstractStructured,ut.asn1.ASN1Object),ut.asn1.DERBoolean=function(){ut.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},at.lang.extend(ut.asn1.DERBoolean,ut.asn1.ASN1Object),ut.asn1.DERInteger=function(e){ut.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=ut.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var t=new P$1(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.bigint?this.setByBigInteger(e.bigint):void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},at.lang.extend(ut.asn1.DERInteger,ut.asn1.ASN1Object),ut.asn1.DERBitString=function(e){if(void 0!==e&&void 0!==e.obj){var t=ut.asn1.ASN1Util.newObject(e.obj);e.hex="00"+t.getEncodedHex()}ut.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(e){this.hTLV=null,this.isModified=!0,this.hV=e},this.setUnusedBitsAndHexValue=function(e,t){if(e<0||7<e)throw"unused bits shall be from 0 to 7: u = "+e;var r="0"+e;this.hTLV=null,this.isModified=!0,this.hV=r+t},this.setByBinaryString=function(e){var t=8-(e=e.replace(/0+$/,"")).length%8;8==t&&(t=0);for(var r=0;r<=t;r++)e+="0";var n="";for(r=0;r<e.length-1;r+=8){var o=e.substr(r,8),i=parseInt(o,2).toString(16);1==i.length&&(i="0"+i),n+=i}this.hTLV=null,this.isModified=!0,this.hV="0"+t+n},this.setByBooleanArray=function(e){for(var t="",r=0;r<e.length;r++)1==e[r]?t+="1":t+="0";this.setByBinaryString(t)},this.newFalseArray=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=!1;return t},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e&&e.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(e):void 0!==e.hex?this.setHexValueIncludingUnusedBits(e.hex):void 0!==e.bin?this.setByBinaryString(e.bin):void 0!==e.array&&this.setByBooleanArray(e.array))},at.lang.extend(ut.asn1.DERBitString,ut.asn1.ASN1Object),ut.asn1.DEROctetString=function(e){if(void 0!==e&&void 0!==e.obj){var t=ut.asn1.ASN1Util.newObject(e.obj);e.hex=t.getEncodedHex()}ut.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"},at.lang.extend(ut.asn1.DEROctetString,ut.asn1.DERAbstractString),ut.asn1.DERNull=function(){ut.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},at.lang.extend(ut.asn1.DERNull,ut.asn1.ASN1Object),ut.asn1.DERObjectIdentifier=function(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},r=function(e){var r="",n=new P$1(e,10).toString(2),o=7-n.length%7;7==o&&(o=0);for(var i="",a=0;a<o;a++)i+="0";for(n=i+n,a=0;a<n.length-1;a+=7){var s=n.substr(a,7);a!=n.length-7&&(s="1"+s),r+=t(parseInt(s,2))}return r};ut.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueOidString=function(e){if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var n="",o=e.split("."),i=40*parseInt(o[0])+parseInt(o[1]);n+=t(i),o.splice(0,2);for(var a=0;a<o.length;a++)n+=r(o[a]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=n},this.setValueName=function(e){var t=ut.asn1.x509.OID.name2oid(e);if(""===t)throw"DERObjectIdentifier oidName undefined: "+e;this.setValueOidString(t)},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e?e.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(e):this.setValueName(e):void 0!==e.oid?this.setValueOidString(e.oid):void 0!==e.hex?this.setValueHex(e.hex):void 0!==e.name&&this.setValueName(e.name))},at.lang.extend(ut.asn1.DERObjectIdentifier,ut.asn1.ASN1Object),ut.asn1.DEREnumerated=function(e){ut.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=ut.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var t=new P$1(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},at.lang.extend(ut.asn1.DEREnumerated,ut.asn1.ASN1Object),ut.asn1.DERUTF8String=function(e){ut.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"},at.lang.extend(ut.asn1.DERUTF8String,ut.asn1.DERAbstractString),ut.asn1.DERNumericString=function(e){ut.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"},at.lang.extend(ut.asn1.DERNumericString,ut.asn1.DERAbstractString),ut.asn1.DERPrintableString=function(e){ut.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"},at.lang.extend(ut.asn1.DERPrintableString,ut.asn1.DERAbstractString),ut.asn1.DERTeletexString=function(e){ut.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"},at.lang.extend(ut.asn1.DERTeletexString,ut.asn1.DERAbstractString),ut.asn1.DERIA5String=function(e){ut.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"},at.lang.extend(ut.asn1.DERIA5String,ut.asn1.DERAbstractString),ut.asn1.DERUTCTime=function(e){ut.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{12}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date))},at.lang.extend(ut.asn1.DERUTCTime,ut.asn1.DERAbstractTime),ut.asn1.DERGeneralizedTime=function(e){ut.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.withMillis=!1,this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{14}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date),!0===e.millis&&(this.withMillis=!0))},at.lang.extend(ut.asn1.DERGeneralizedTime,ut.asn1.DERAbstractTime),ut.asn1.DERSequence=function(e){ut.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var e="",t=0;t<this.asn1Array.length;t++)e+=this.asn1Array[t].getEncodedHex();return this.hV=e,this.hV}},at.lang.extend(ut.asn1.DERSequence,ut.asn1.DERAbstractStructured),ut.asn1.DERSet=function(e){ut.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var e=new Array,t=0;t<this.asn1Array.length;t++){var r=this.asn1Array[t];e.push(r.getEncodedHex())}return 1==this.sortFlag&&e.sort(),this.hV=e.join(""),this.hV},void 0!==e&&void 0!==e.sortflag&&0==e.sortflag&&(this.sortFlag=!1)},at.lang.extend(ut.asn1.DERSet,ut.asn1.DERAbstractStructured),ut.asn1.DERTaggedObject=function(e){ut.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(e,t,r){this.hT=t,this.isExplicit=e,this.asn1Object=r,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=r.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,t),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.tag&&(this.hT=e.tag),void 0!==e.explicit&&(this.isExplicit=e.explicit),void 0!==e.obj&&(this.asn1Object=e.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},at.lang.extend(ut.asn1.DERTaggedObject,ut.asn1.ASN1Object);var ct,ft,lt=(ct=function(e,t){return ct=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},ct(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ct(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),pt=function(e){function t(r){var n=e.call(this)||this;return r&&("string"==typeof r?n.parseKey(r):(t.hasPrivateKeyProperty(r)||t.hasPublicKeyProperty(r))&&n.parsePropertiesFrom(r)),n}return lt(t,e),t.prototype.parseKey=function(e){try{var t=0,r=0,n=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/.test(e)?T$1(e):B$1.unarmor(e),o=O$1.decode(n);if(3===o.sub.length&&(o=o.sub[2].sub[0]),9===o.sub.length){t=o.sub[1].getHexStringValue(),this.n=L$1(t,16),r=o.sub[2].getHexStringValue(),this.e=parseInt(r,16);var i=o.sub[3].getHexStringValue();this.d=L$1(i,16);var a=o.sub[4].getHexStringValue();this.p=L$1(a,16);var s=o.sub[5].getHexStringValue();this.q=L$1(s,16);var l=o.sub[6].getHexStringValue();this.dmp1=L$1(l,16);var c=o.sub[7].getHexStringValue();this.dmq1=L$1(c,16);var u=o.sub[8].getHexStringValue();this.coeff=L$1(u,16)}else{if(2!==o.sub.length)return!1;if(o.sub[0].sub){var d=o.sub[1].sub[0];t=d.sub[0].getHexStringValue(),this.n=L$1(t,16),r=d.sub[1].getHexStringValue(),this.e=parseInt(r,16)}else t=o.sub[0].getHexStringValue(),this.n=L$1(t,16),r=o.sub[1].getHexStringValue(),this.e=parseInt(r,16)}return!0}catch(h){return!1}},t.prototype.getPrivateBaseKey=function(){var e={array:[new ut.asn1.DERInteger({int:0}),new ut.asn1.DERInteger({bigint:this.n}),new ut.asn1.DERInteger({int:this.e}),new ut.asn1.DERInteger({bigint:this.d}),new ut.asn1.DERInteger({bigint:this.p}),new ut.asn1.DERInteger({bigint:this.q}),new ut.asn1.DERInteger({bigint:this.dmp1}),new ut.asn1.DERInteger({bigint:this.dmq1}),new ut.asn1.DERInteger({bigint:this.coeff})]};return new ut.asn1.DERSequence(e).getEncodedHex()},t.prototype.getPrivateBaseKeyB64=function(){return b$1(this.getPrivateBaseKey())},t.prototype.getPublicBaseKey=function(){var e=new ut.asn1.DERSequence({array:[new ut.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new ut.asn1.DERNull]}),t=new ut.asn1.DERSequence({array:[new ut.asn1.DERInteger({bigint:this.n}),new ut.asn1.DERInteger({int:this.e})]}),r=new ut.asn1.DERBitString({hex:"00"+t.getEncodedHex()});return new ut.asn1.DERSequence({array:[e,r]}).getEncodedHex()},t.prototype.getPublicBaseKeyB64=function(){return b$1(this.getPublicBaseKey())},t.wordwrap=function(e,t){if(!e)return e;var r="(.{1,"+(t=t||64)+"})( +|$\n?)|(.{1,"+t+"})";return e.match(RegExp(r,"g")).join("\n")},t.prototype.getPrivateKey=function(){var e="-----BEGIN RSA PRIVATE KEY-----\n";return(e+=t.wordwrap(this.getPrivateBaseKeyB64())+"\n")+"-----END RSA PRIVATE KEY-----"},t.prototype.getPublicKey=function(){var e="-----BEGIN PUBLIC KEY-----\n";return(e+=t.wordwrap(this.getPublicBaseKeyB64())+"\n")+"-----END PUBLIC KEY-----"},t.hasPublicKeyProperty=function(e){return(e=e||{}).hasOwnProperty("n")&&e.hasOwnProperty("e")},t.hasPrivateKeyProperty=function(e){return(e=e||{}).hasOwnProperty("n")&&e.hasOwnProperty("e")&&e.hasOwnProperty("d")&&e.hasOwnProperty("p")&&e.hasOwnProperty("q")&&e.hasOwnProperty("dmp1")&&e.hasOwnProperty("dmq1")&&e.hasOwnProperty("coeff")},t.prototype.parsePropertiesFrom=function(e){this.n=e.n,this.e=e.e,e.hasOwnProperty("d")&&(this.d=e.d,this.p=e.p,this.q=e.q,this.dmp1=e.dmp1,this.dmq1=e.dmq1,this.coeff=e.coeff)},t}(ot),dt="undefined"!=typeof process?null===(ft=define_process_env_default)||void 0===ft?void 0:ft.npm_package_version:void 0;new(function(){function e(e){void 0===e&&(e={}),e=e||{},this.default_key_size=e.default_key_size?parseInt(e.default_key_size,10):1024,this.default_public_exponent=e.default_public_exponent||"010001",this.log=e.log||!1,this.key=null}return e.prototype.setKey=function(e){this.log&&this.key,this.key=new pt(e)},e.prototype.setPrivateKey=function(e){this.setKey(e)},e.prototype.setPublicKey=function(e){this.setKey(e)},e.prototype.decrypt=function(e){try{return this.getKey().decrypt(w$1(e))}catch(t){return!1}},e.prototype.encrypt=function(e){try{return b$1(this.getKey().encrypt(e))}catch(t){return!1}},e.prototype.sign=function(e,t,r){try{return b$1(this.getKey().sign(e,t,r))}catch(n){return!1}},e.prototype.verify=function(e,t,r){try{return this.getKey().verify(e,w$1(t),r)}catch(n){return!1}},e.prototype.getKey=function(e){if(!this.key){if(this.key=new pt,e&&"[object Function]"==={}.toString.call(e))return void this.key.generateAsync(this.default_key_size,this.default_public_exponent,e);this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},e.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},e.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},e.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},e.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},e.version=dt,e}());var bt=e$1((function(e,r){(function(){var t;function r(e,t,r){null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function n(){return new r(null)}var o="undefined"!=typeof navigator;o&&"Microsoft Internet Explorer"==navigator.appName?(r.prototype.am=function(e,t,r,n,o,i){for(var a=32767&t,s=t>>15;--i>=0;){var l=32767&this[e],c=this[e++]>>15,u=s*l+c*a;o=((l=a*l+((32767&u)<<15)+r[n]+(1073741823&o))>>>30)+(u>>>15)+s*c+(o>>>30),r[n++]=1073741823&l}return o},t=30):o&&"Netscape"!=navigator.appName?(r.prototype.am=function(e,t,r,n,o,i){for(;--i>=0;){var a=t*this[e++]+r[n]+o;o=Math.floor(a/67108864),r[n++]=67108863&a}return o},t=26):(r.prototype.am=function(e,t,r,n,o,i){for(var a=16383&t,s=t>>14;--i>=0;){var l=16383&this[e],c=this[e++]>>14,u=s*l+c*a;o=((l=a*l+((16383&u)<<14)+r[n]+o)>>28)+(u>>14)+s*c,r[n++]=268435455&l}return o},t=28),r.prototype.DB=t,r.prototype.DM=(1<<t)-1,r.prototype.DV=1<<t,r.prototype.FV=Math.pow(2,52),r.prototype.F1=52-t,r.prototype.F2=2*t-52;var i,a,s=new Array;for(i="0".charCodeAt(0),a=0;a<=9;++a)s[i++]=a;for(i="a".charCodeAt(0),a=10;a<36;++a)s[i++]=a;for(i="A".charCodeAt(0),a=10;a<36;++a)s[i++]=a;function l(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function c(e,t){var r=s[e.charCodeAt(t)];return null==r?-1:r}function u(e){var t=n();return t.fromInt(e),t}function d(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function h(e){this.m=e}function p(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function f(e,t){return e&t}function g(e,t){return e|t}function m(e,t){return e^t}function y(e,t){return e&~t}function v(e){if(0==e)return-1;var t=0;return!(65535&e)&&(e>>=16,t+=16),!(255&e)&&(e>>=8,t+=8),!(15&e)&&(e>>=4,t+=4),!(3&e)&&(e>>=2,t+=2),!(1&e)&&++t,t}function _(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function b(){}function C(e){return e}function E(e){this.r2=n(),this.q3=n(),r.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}h.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},h.prototype.revert=function(e){return e},h.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},h.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},h.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},p.prototype.convert=function(e){var t=n();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(r.ZERO)>0&&this.m.subTo(t,t),t},p.prototype.revert=function(e){var t=n();return e.copyTo(t),this.reduce(t),t},p.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},p.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},p.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},r.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},r.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},r.prototype.fromString=function(e,t){var n;if(16==t)n=4;else if(8==t)n=3;else if(256==t)n=8;else if(2==t)n=1;else if(32==t)n=5;else{if(4!=t)return void this.fromRadix(e,t);n=2}this.t=0,this.s=0;for(var o=e.length,i=!1,a=0;--o>=0;){var s=8==n?255&e[o]:c(e,o);s<0?"-"==e.charAt(o)&&(i=!0):(i=!1,0==a?this[this.t++]=s:a+n>this.DB?(this[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this[this.t++]=s>>this.DB-a):this[this.t-1]|=s<<a,(a+=n)>=this.DB&&(a-=this.DB))}8==n&&!!(128&e[0])&&(this.s=-1,a>0&&(this[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),i&&r.ZERO.subTo(this,this)},r.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},r.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s},r.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},r.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,o=this.DB-n,i=(1<<o)-1,a=Math.floor(e/this.DB),s=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t[r+a+1]=this[r]>>o|s,s=(this[r]&i)<<n;for(r=a-1;r>=0;--r)t[r]=0;t[a]=s,t.t=this.t+a+1,t.s=this.s,t.clamp()},r.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,o=this.DB-n,i=(1<<n)-1;t[0]=this[r]>>n;for(var a=r+1;a<this.t;++a)t[a-r-1]|=(this[a]&i)<<o,t[a-r]=this[a]>>n;n>0&&(t[this.t-r-1]|=(this.s&i)<<o),t.t=this.t-r,t.clamp()}},r.prototype.subTo=function(e,t){for(var r=0,n=0,o=Math.min(e.t,this.t);r<o;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()},r.prototype.multiplyTo=function(e,t){var n=this.abs(),o=e.abs(),i=n.t;for(t.t=i+o.t;--i>=0;)t[i]=0;for(i=0;i<o.t;++i)t[i+n.t]=n.am(0,o[i],t,i,0,n.t);t.s=0,t.clamp(),this.s!=e.s&&r.ZERO.subTo(t,t)},r.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},r.prototype.divRemTo=function(e,t,o){var i=e.abs();if(!(i.t<=0)){var a=this.abs();if(a.t<i.t)return null!=t&&t.fromInt(0),void(null!=o&&this.copyTo(o));null==o&&(o=n());var s=n(),l=this.s,c=e.s,u=this.DB-d(i[i.t-1]);u>0?(i.lShiftTo(u,s),a.lShiftTo(u,o)):(i.copyTo(s),a.copyTo(o));var h=s.t,p=s[h-1];if(0!=p){var f=p*(1<<this.F1)+(h>1?s[h-2]>>this.F2:0),g=this.FV/f,m=(1<<this.F1)/f,y=1<<this.F2,v=o.t,_=v-h,b=null==t?n():t;for(s.dlShiftTo(_,b),o.compareTo(b)>=0&&(o[o.t++]=1,o.subTo(b,o)),r.ONE.dlShiftTo(h,b),b.subTo(s,s);s.t<h;)s[s.t++]=0;for(;--_>=0;){var C=o[--v]==p?this.DM:Math.floor(o[v]*g+(o[v-1]+y)*m);if((o[v]+=s.am(0,C,o,_,0,h))<C)for(s.dlShiftTo(_,b),o.subTo(b,o);o[v]<--C;)o.subTo(b,o)}null!=t&&(o.drShiftTo(h,t),l!=c&&r.ZERO.subTo(t,t)),o.t=h,o.clamp(),u>0&&o.rShiftTo(u,o),l<0&&r.ZERO.subTo(o,o)}}},r.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(!(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},r.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},r.prototype.exp=function(e,t){if(e>4294967295||e<1)return r.ONE;var o=n(),i=n(),a=t.convert(this),s=d(e)-1;for(a.copyTo(o);--s>=0;)if(t.sqrTo(o,i),(e&1<<s)>0)t.mulTo(i,a,o);else{var l=o;o=i,i=l}return t.revert(o)},r.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,o=!1,i="",a=this.t,s=this.DB-a*this.DB%t;if(a-- >0)for(s<this.DB&&(r=this[a]>>s)>0&&(o=!0,i=l(r));a>=0;)s<t?(r=(this[a]&(1<<s)-1)<<t-s,r|=this[--a]>>(s+=this.DB-t)):(r=this[a]>>(s-=t)&n,s<=0&&(s+=this.DB,--a)),r>0&&(o=!0),o&&(i+=l(r));return o?i:"0"},r.prototype.negate=function(){var e=n();return r.ZERO.subTo(this,e),e},r.prototype.abs=function(){return this.s<0?this.negate():this},r.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this[r]-e[r]))return t;return 0},r.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+d(this[this.t-1]^this.s&this.DM)},r.prototype.mod=function(e){var t=n();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(r.ZERO)>0&&e.subTo(t,t),t},r.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new h(t):new p(t),this.exp(e,r)},r.ZERO=u(0),r.ONE=u(1),b.prototype.convert=C,b.prototype.revert=C,b.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},b.prototype.sqrTo=function(e,t){e.squareTo(t)},E.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=n();return e.copyTo(t),this.reduce(t),t},E.prototype.revert=function(e){return e},E.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},E.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},E.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var T,S,P,w=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],x=(1<<26)/w[w.length-1];function O(){var e;e=(new Date).getTime(),S[P++]^=255&e,S[P++]^=e>>8&255,S[P++]^=e>>16&255,S[P++]^=e>>24&255,P>=N&&(P-=N)}if(r.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},r.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),o=u(r),i=n(),a=n(),s="";for(this.divRemTo(o,i,a);i.signum()>0;)s=(r+a.intValue()).toString(e).substr(1)+s,i.divRemTo(o,i,a);return a.intValue().toString(e)+s},r.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var n=this.chunkSize(t),o=Math.pow(t,n),i=!1,a=0,s=0,l=0;l<e.length;++l){var u=c(e,l);u<0?"-"==e.charAt(l)&&0==this.signum()&&(i=!0):(s=t*s+u,++a>=n&&(this.dMultiply(o),this.dAddOffset(s,0),a=0,s=0))}a>0&&(this.dMultiply(Math.pow(t,a)),this.dAddOffset(s,0)),i&&r.ZERO.subTo(this,this)},r.prototype.fromNumber=function(e,t,n){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,n),this.testBit(e-1)||this.bitwiseTo(r.ONE.shiftLeft(e-1),g,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(r.ONE.shiftLeft(e-1),this);else{var o=new Array,i=7&e;o.length=1+(e>>3),t.nextBytes(o),i>0?o[0]&=(1<<i)-1:o[0]=0,this.fromString(o,256)}},r.prototype.bitwiseTo=function(e,t,r){var n,o,i=Math.min(e.t,this.t);for(n=0;n<i;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(o=e.s&this.DM,n=i;n<this.t;++n)r[n]=t(this[n],o);r.t=this.t}else{for(o=this.s&this.DM,n=i;n<e.t;++n)r[n]=t(o,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},r.prototype.changeBit=function(e,t){var n=r.ONE.shiftLeft(e);return this.bitwiseTo(n,t,n),n},r.prototype.addTo=function(e,t){for(var r=0,n=0,o=Math.min(e.t,this.t);r<o;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()},r.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},r.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},r.prototype.multiplyLowerTo=function(e,t,r){var n,o=Math.min(this.t+e.t,t);for(r.s=0,r.t=o;o>0;)r[--o]=0;for(n=r.t-this.t;o<n;++o)r[o+this.t]=this.am(0,e[o],r,o,0,this.t);for(n=Math.min(e.t,t);o<n;++o)this.am(0,e[o],r,o,0,t-o);r.clamp()},r.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},r.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r},r.prototype.millerRabin=function(e){var t=this.subtract(r.ONE),o=t.getLowestSetBit();if(o<=0)return!1;var i=t.shiftRight(o);(e=e+1>>1)>w.length&&(e=w.length);for(var a=n(),s=0;s<e;++s){a.fromInt(w[Math.floor(Math.random()*w.length)]);var l=a.modPow(i,this);if(0!=l.compareTo(r.ONE)&&0!=l.compareTo(t)){for(var c=1;c++<o&&0!=l.compareTo(t);)if(0==(l=l.modPowInt(2,this)).compareTo(r.ONE))return!1;if(0!=l.compareTo(t))return!1}}return!0},r.prototype.clone=function(){var e=n();return this.copyTo(e),e},r.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},r.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},r.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},r.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},r.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,o=0;if(e-- >0)for(n<this.DB&&(r=this[e]>>n)!=(this.s&this.DM)>>n&&(t[o++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this[e]&(1<<n)-1)<<8-n,r|=this[--e]>>(n+=this.DB-8)):(r=this[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),!!(128&r)&&(r|=-256),0==o&&(128&this.s)!=(128&r)&&++o,(o>0||r!=this.s)&&(t[o++]=r);return t},r.prototype.equals=function(e){return 0==this.compareTo(e)},r.prototype.min=function(e){return this.compareTo(e)<0?this:e},r.prototype.max=function(e){return this.compareTo(e)>0?this:e},r.prototype.and=function(e){var t=n();return this.bitwiseTo(e,f,t),t},r.prototype.or=function(e){var t=n();return this.bitwiseTo(e,g,t),t},r.prototype.xor=function(e){var t=n();return this.bitwiseTo(e,m,t),t},r.prototype.andNot=function(e){var t=n();return this.bitwiseTo(e,y,t),t},r.prototype.not=function(){for(var e=n(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},r.prototype.shiftLeft=function(e){var t=n();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},r.prototype.shiftRight=function(e){var t=n();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},r.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+v(this[e]);return this.s<0?this.t*this.DB:-1},r.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=_(this[r]^t);return e},r.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:!!(this[t]&1<<e%this.DB)},r.prototype.setBit=function(e){return this.changeBit(e,g)},r.prototype.clearBit=function(e){return this.changeBit(e,y)},r.prototype.flipBit=function(e){return this.changeBit(e,m)},r.prototype.add=function(e){var t=n();return this.addTo(e,t),t},r.prototype.subtract=function(e){var t=n();return this.subTo(e,t),t},r.prototype.multiply=function(e){var t=n();return this.multiplyTo(e,t),t},r.prototype.divide=function(e){var t=n();return this.divRemTo(e,t,null),t},r.prototype.remainder=function(e){var t=n();return this.divRemTo(e,null,t),t},r.prototype.divideAndRemainder=function(e){var t=n(),r=n();return this.divRemTo(e,t,r),new Array(t,r)},r.prototype.modPow=function(e,t){var r,o,i=e.bitLength(),a=u(1);if(i<=0)return a;r=i<18?1:i<48?3:i<144?4:i<768?5:6,o=i<8?new h(t):t.isEven()?new E(t):new p(t);var s=new Array,l=3,c=r-1,f=(1<<r)-1;if(s[1]=o.convert(this),r>1){var g=n();for(o.sqrTo(s[1],g);l<=f;)s[l]=n(),o.mulTo(g,s[l-2],s[l]),l+=2}var m,y,v=e.t-1,_=!0,b=n();for(i=d(e[v])-1;v>=0;){for(i>=c?m=e[v]>>i-c&f:(m=(e[v]&(1<<i+1)-1)<<c-i,v>0&&(m|=e[v-1]>>this.DB+i-c)),l=r;!(1&m);)m>>=1,--l;if((i-=l)<0&&(i+=this.DB,--v),_)s[m].copyTo(a),_=!1;else{for(;l>1;)o.sqrTo(a,b),o.sqrTo(b,a),l-=2;l>0?o.sqrTo(a,b):(y=a,a=b,b=y),o.mulTo(b,s[m],a)}for(;v>=0&&!(e[v]&1<<i);)o.sqrTo(a,b),y=a,a=b,b=y,--i<0&&(i=this.DB-1,--v)}return o.revert(a)},r.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return r.ZERO;for(var n=e.clone(),o=this.clone(),i=u(1),a=u(0),s=u(0),l=u(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),t?(i.isEven()&&a.isEven()||(i.addTo(this,i),a.subTo(e,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);for(;o.isEven();)o.rShiftTo(1,o),t?(s.isEven()&&l.isEven()||(s.addTo(this,s),l.subTo(e,l)),s.rShiftTo(1,s)):l.isEven()||l.subTo(e,l),l.rShiftTo(1,l);n.compareTo(o)>=0?(n.subTo(o,n),t&&i.subTo(s,i),a.subTo(l,a)):(o.subTo(n,o),t&&s.subTo(i,s),l.subTo(a,l))}return 0!=o.compareTo(r.ONE)?r.ZERO:l.compareTo(e)>=0?l.subtract(e):l.signum()<0?(l.addTo(e,l),l.signum()<0?l.add(e):l):l},r.prototype.pow=function(e){return this.exp(e,new b)},r.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var o=t.getLowestSetBit(),i=r.getLowestSetBit();if(i<0)return t;for(o<i&&(i=o),i>0&&(t.rShiftTo(i,t),r.rShiftTo(i,r));t.signum()>0;)(o=t.getLowestSetBit())>0&&t.rShiftTo(o,t),(o=r.getLowestSetBit())>0&&r.rShiftTo(o,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return i>0&&r.lShiftTo(i,r),r},r.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=w[w.length-1]){for(t=0;t<w.length;++t)if(r[0]==w[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<w.length;){for(var n=w[t],o=t+1;o<w.length&&n<x;)n*=w[o++];for(n=r.modInt(n);t<o;)if(n%w[t++]==0)return!1}return r.millerRabin(e)},r.prototype.square=function(){var e=n();return this.squareTo(e),e},r.prototype.Barrett=E,null==S){var $;if(S=new Array,P=0,"undefined"!=typeof window&&window.crypto)if(window.crypto.getRandomValues){var I=new Uint8Array(32);for(window.crypto.getRandomValues(I),$=0;$<32;++$)S[P++]=I[$]}else if("Netscape"==navigator.appName&&navigator.appVersion<"5"){var R=window.crypto.random(32);for($=0;$<R.length;++$)S[P++]=255&R.charCodeAt($)}for(;P<N;)$=Math.floor(65536*Math.random()),S[P++]=$>>>8,S[P++]=255&$;P=0,O()}function A(){if(null==T){for(O(),(T=new L).init(S),P=0;P<S.length;++P)S[P]=0;P=0}return T.next()}function D(){}function L(){this.i=0,this.j=0,this.S=new Array}D.prototype.nextBytes=function(e){var t;for(t=0;t<e.length;++t)e[t]=A()},L.prototype.init=function(e){var t,r,n;for(t=0;t<256;++t)this.S[t]=t;for(r=0,t=0;t<256;++t)r=r+this.S[t]+e[t%e.length]&255,n=this.S[t],this.S[t]=this.S[r],this.S[r]=n;this.i=0,this.j=0},L.prototype.next=function(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]};var N=256;e.exports={default:r,BigInteger:r,SecureRandom:D}}).call(t)}));bt.BigInteger,bt.SecureRandom;const{BigInteger:At}=bt,Rt=new At("2"),Ft=new At("3");class It{constructor(e,t){this.x=t,this.q=e}equals(e){return e===this||this.q.equals(e.q)&&this.x.equals(e.x)}toBigInteger(){return this.x}negate(){return new It(this.q,this.x.negate().mod(this.q))}add(e){return new It(this.q,this.x.add(e.toBigInteger()).mod(this.q))}subtract(e){return new It(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))}multiply(e){return new It(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))}divide(e){return new It(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))}square(){return new It(this.q,this.x.square().mod(this.q))}}class Ot{constructor(e,t,r,n){this.curve=e,this.x=t,this.y=r,this.z=null==n?At.ONE:n,this.zinv=null}getX(){return null===this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}getY(){return null===this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}equals(e){return e===this||(this.isInfinity()?e.isInfinity():e.isInfinity()?this.isInfinity():!!e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(At.ZERO)&&e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(At.ZERO))}isInfinity(){return null===this.x&&null===this.y||this.z.equals(At.ZERO)&&!this.y.toBigInteger().equals(At.ZERO)}negate(){return new Ot(this.curve,this.x,this.y.negate(),this.z)}add(e){if(this.isInfinity())return e;if(e.isInfinity())return this;const t=this.x.toBigInteger(),r=this.y.toBigInteger(),n=this.z,o=e.x.toBigInteger(),i=e.y.toBigInteger(),a=e.z,s=this.curve.q,l=t.multiply(a).mod(s),c=o.multiply(n).mod(s),u=l.subtract(c),d=r.multiply(a).mod(s),h=i.multiply(n).mod(s),p=d.subtract(h);if(At.ZERO.equals(u))return At.ZERO.equals(p)?this.twice():this.curve.infinity;const f=l.add(c),g=n.multiply(a).mod(s),m=u.square().mod(s),y=u.multiply(m).mod(s),v=g.multiply(p.square()).subtract(f.multiply(m)).mod(s),_=u.multiply(v).mod(s),b=p.multiply(m.multiply(l).subtract(v)).subtract(d.multiply(y)).mod(s),C=y.multiply(g).mod(s);return new Ot(this.curve,this.curve.fromBigInteger(_),this.curve.fromBigInteger(b),C)}twice(){if(this.isInfinity())return this;if(!this.y.toBigInteger().signum())return this.curve.infinity;const e=this.x.toBigInteger(),t=this.y.toBigInteger(),r=this.z,n=this.curve.q,o=this.curve.a.toBigInteger(),i=e.square().multiply(Ft).add(o.multiply(r.square())).mod(n),a=t.shiftLeft(1).multiply(r).mod(n),s=t.square().mod(n),l=s.multiply(e).multiply(r).mod(n),c=a.square().mod(n),u=i.square().subtract(l.shiftLeft(3)).mod(n),d=a.multiply(u).mod(n),h=i.multiply(l.shiftLeft(2).subtract(u)).subtract(c.shiftLeft(1).multiply(s)).mod(n),p=a.multiply(c).mod(n);return new Ot(this.curve,this.curve.fromBigInteger(d),this.curve.fromBigInteger(h),p)}multiply(e){if(this.isInfinity())return this;if(!e.signum())return this.curve.infinity;const t=e.multiply(Ft),r=this.negate();let n=this;for(let o=t.bitLength()-2;o>0;o--){n=n.twice();const i=t.testBit(o);i!==e.testBit(o)&&(n=n.add(i?this:r))}return n}}var kt={ECPointFp:Ot,ECCurveFp:class{constructor(e,t,r){this.q=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(r),this.infinity=new Ot(this,null,null)}equals(e){return e===this||this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)}fromBigInteger(e){return new It(this.q,e)}decodePointHex(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:const t=this.fromBigInteger(new At(e.substr(2),16));let r=this.fromBigInteger(t.multiply(t.square()).add(t.multiply(this.a)).add(this.b).toBigInteger().modPow(this.q.divide(new At("4")).add(At.ONE),this.q));return r.toBigInteger().mod(Rt).equals(new At(e.substr(0,2),16).subtract(Rt))||(r=r.negate()),new Ot(this,t,r);case 4:case 6:case 7:const n=(e.length-2)/2,o=e.substr(2,n),i=e.substr(n+2,n);return new Ot(this,this.fromBigInteger(new At(o,16)),this.fromBigInteger(new At(i,16)));default:return null}}}};const{BigInteger:Ht,SecureRandom:Ct}=bt,{ECCurveFp:Pt}=kt,Mt=new Ct,{curve:Vt,G:qt,n:Nt}=zt();function zt(){const e=new Ht("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF",16),t=new Ht("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC",16),r=new Ht("28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93",16),n=new Pt(e,t,r),o=n.decodePointHex("0432C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7BC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0");return{curve:n,G:o,n:new Ht("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123",16)}}function Lt(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e}var jt={getGlobalCurve:function(){return Vt},generateEcparam:zt,generateKeyPairHex:function(e,t,r){const n=(e?new Ht(e,t,r):new Ht(Nt.bitLength(),Mt)).mod(Nt.subtract(Ht.ONE)).add(Ht.ONE),o=Lt(n.toString(16),64),i=qt.multiply(n);return{privateKey:o,publicKey:"04"+Lt(i.getX().toBigInteger().toString(16),64)+Lt(i.getY().toBigInteger().toString(16),64)}},compressPublicKeyHex:function(e){if(130!==e.length)throw new Error("Invalid public key to compress");const t=(e.length-2)/2,r=e.substr(2,t);let n="03";return new Ht(e.substr(t+2,t),16).mod(new Ht("2")).equals(Ht.ZERO)&&(n="02"),n+r},utf8ToHex:function(e){const t=(e=unescape(encodeURIComponent(e))).length,r=[];for(let o=0;o<t;o++)r[o>>>2]|=(255&e.charCodeAt(o))<<24-o%4*8;const n=[];for(let o=0;o<t;o++){const e=r[o>>>2]>>>24-o%4*8&255;n.push((e>>>4).toString(16)),n.push((15&e).toString(16))}return n.join("")},leftPad:Lt,arrayToHex:function(e){return e.map((e=>1===(e=e.toString(16)).length?"0"+e:e)).join("")},arrayToUtf8:function(e){const t=[];let r=0;for(let o=0;o<2*e.length;o+=2)t[o>>>3]|=parseInt(e[r],10)<<24-o%8*4,r++;try{const r=[];for(let n=0;n<e.length;n++){const e=t[n>>>2]>>>24-n%4*8&255;r.push(String.fromCharCode(e))}return decodeURIComponent(escape(r.join("")))}catch(n){throw new Error("Malformed UTF-8 data")}},hexToArray:function(e){const t=[];let r=e.length;r%2!=0&&(e=Lt(e,r+1)),r=e.length;for(let n=0;n<r;n+=2)t.push(parseInt(e.substr(n,2),16));return t},verifyPublicKey:function(e){const t=Vt.decodePointHex(e);if(!t)return!1;const r=t.getX();return t.getY().square().equals(r.multiply(r.square()).add(r.multiply(Vt.a)).add(Vt.b))},comparePublicKeyHex:function(e,t){const r=Vt.decodePointHex(e);if(!r)return!1;const n=Vt.decodePointHex(t);return!!n&&r.equals(n)}};const Yt=new Uint8Array(64),$t=new Uint8Array(64);for(let _e=0;_e<64;_e++)Yt[_e]=54,$t[_e]=92;function _classCallCheck$2p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2l(n.key),n)}}function _createClass$2p(e,t,r){return t&&_defineProperties$2l(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2l(e){var t=_toPrimitive$2l(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2l(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1$(e,t,r){return t=_getPrototypeOf$1$(t),_possibleConstructorReturn$1$(e,_isNativeReflectConstruct$1$()?Reflect.construct(t,r||[],_getPrototypeOf$1$(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1$(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1$(e)}function _assertThisInitialized$1$(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1$=function(){return!!e})()}function _getPrototypeOf$1$(e){return(_getPrototypeOf$1$=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1$(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1$(e,t)}function _setPrototypeOf$1$(e,t){return(_setPrototypeOf$1$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}jt.generateEcparam();var __decorate$16=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let CopyrightMark=function(e){function t(){return _classCallCheck$2p(this,t),_callSuper$1$(this,t,arguments)}return _inherits$1$(t,BI.Widget),_createClass$2p(t,[{key:"render",value:function(){const{text:e,color:t,backgroundColor:r,alpha:n,fontSize:o,url:i}=this.options.copyright,a=index.createStyleSheet({copyright:{background:r,opacity:n,"font-size":"".concat(o,"px")},font:{color:t}}).attach();return i?{type:BI.AbsoluteLayout.xtype,cls:"report-core-copyrightmark",items:[{el:this.options.renderItem(),top:0,bottom:0,left:0,right:0},{el:{type:BI.VerticalAdaptLayout.xtype,cls:"copyright-lable ".concat(a.classes.copyright),items:[{type:BI.A.xtype,href:i,cls:"".concat(a.classes.font),text:e,fontSize:o},{type:BI.A.xtype,cls:"copyright-link",href:"https://help.fanruan.com/finereport/doc-view-281.html",text:BI.i18nText("Fine-Report_Trial_Mode"),fontSize:o}],hgap:10,vgap:10},bottom:10,right:10}]}:{type:BI.AbsoluteLayout.xtype,cls:"report-core-copyrightmark",items:[{el:{type:BI.Label.xtype,cls:"copyright-lable copyright-unreachable ".concat(a.classes.copyright," ").concat(a.classes.font),text:e,fontSize:o,hgap:10,vgap:10},bottom:10,right:10},{el:this.options.renderItem(),top:0,bottom:0,left:0,right:0}]}}}])}();function _classCallCheck$2o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2k(n.key),n)}}function _createClass$2o(e,t,r){return t&&_defineProperties$2k(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2k(e){var t=_toPrimitive$2k(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2k(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1_(e,t,r){return t=_getPrototypeOf$1_(t),_possibleConstructorReturn$1_(e,_isNativeReflectConstruct$1_()?Reflect.construct(t,r||[],_getPrototypeOf$1_(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1_(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1_(e)}function _assertThisInitialized$1_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1_(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1_=function(){return!!e})()}function _getPrototypeOf$1_(e){return(_getPrototypeOf$1_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1_(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1_(e,t)}function _setPrototypeOf$1_(e,t){return(_setPrototypeOf$1_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}CopyrightMark.xtype="report.core.copyrightmark",CopyrightMark=__decorate$16([shortcut()],CopyrightMark);var __decorate$15=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let Loading=function(e){function t(){return _classCallCheck$2o(this,t),_callSuper$1_(this,t,arguments)}return _inherits$1_(t,BI.Pane),_createClass$2o(t,[{key:"mounted",value:function(){this.loading()}},{key:"destroyed",value:function(){this.loaded()}}])}();Loading.xtype="report.main.components.loading",Loading=__decorate$15([shortcut()],Loading);var resizable={exports:{}};window,resizable.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Resizable=void 0;const n=["e","w","n","s","nw","ne","sw","se"];t.Resizable=class{constructor(e,t){this.element=e,this.document=e.ownerDocument,this.options=t||{},this.createHandles()}setPosition(e,t){this.element.style.top=e+"px",this.element.style.left=t+"px"}createHandles(){const{handles:e=n}=this.options;e.filter((e=>n.includes(e))).forEach((e=>{this.createHandle(e)}))}createHandle(e){const{threshold:t=10}=this.options;this.element.style.position="absolute";const r=this.document.createElement("div");r.className+="resizable-handle-"+e,r.style.position="absolute";const{left:n,right:o,width:i,height:a,top:s,bottom:l,cursor:c}=this.getStyleByDirection(e,t);r.style.left=n,r.style.right=o,r.style.width=i,r.style.height=a,r.style.top=s,r.style.bottom=l,r.style.cursor=c,this.element.appendChild(r),r.onmousedown=t=>{const{x:r,y:n}=t,{width:o,height:i}=this.element.style,{offsetTop:a,offsetLeft:s}=this.element;this.getChilds().forEach((e=>{e.style.pointerEvents="none"})),this.document.onmousemove=t=>{const{x:l,y:c}=t;this.resize(e,{baseX:r,baseY:n,width:o,height:i,offsetTop:a,offsetLeft:s,x:l,y:c})},this.document.onmouseup=()=>{this.document.onmousemove=null,this.document.onmouseup=null,this.getChilds().forEach((e=>{e.style.pointerEvents="auto"}))}}}getChilds(){return[].slice.call(this.element.children).filter((e=>!e.className.includes("resizable-handle")))}resize(e,t){const{baseX:r,baseY:n,width:o,height:i,x:a,y:s,offsetTop:l,offsetLeft:c}=t;e.split("").forEach((e=>{switch(e){case"e":this.element.style.width=parseFloat(o)+(a-r)+"px";break;case"w":this.element.style.width=parseFloat(o)+(r-a)+"px",this.element.style.left=c-(r-a)+"px";break;case"n":this.element.style.height=parseFloat(i)+(n-s)+"px",this.element.style.top=l-(n-s)+"px";break;case"s":this.element.style.height=parseFloat(i)+(s-n)+"px"}}))}getStyleByDirection(e,t){switch(e){case"e":return{left:"auto",right:"-".concat(t/2,"px"),width:t+"px",height:"auto",top:"0px",bottom:"0px",cursor:"e-resize"};case"w":return{left:"-".concat(t/2,"px"),right:"auto",width:t+"px",height:"auto",top:"0px",bottom:"0px",cursor:"w-resize"};case"n":return{left:"0px",right:"0px",width:"auto",height:t+"px",top:"-".concat(t/2,"px"),bottom:"auto",cursor:"n-resize"};case"s":return{left:"0px",right:"0px",width:"auto",height:t+"px",top:"auto",bottom:"-".concat(t/2,"px"),cursor:"s-resize"};case"nw":return{left:"-".concat(t/2,"px"),right:"auto",width:t+"px",height:t+"px",top:"-".concat(t/2,"px"),bottom:"auto",cursor:"nw-resize"};case"ne":return{left:"auto",right:"-".concat(t/2,"px"),width:t+"px",height:t+"px",top:"-".concat(t/2,"px"),bottom:"auto",cursor:"ne-resize"};case"sw":return{left:"-".concat(t/2,"px"),right:"auto",width:t+"px",height:t+"px",top:"auto",bottom:"-".concat(t/2,"px"),cursor:"sw-resize"};case"se":return{left:"auto",right:"-".concat(t/2,"px"),width:t+"px",height:t+"px",top:"auto",bottom:"-".concat(t/2,"px"),cursor:"se-resize"};default:return{}}}}}]);var resizableExports=resizable.exports;function getAdjustedButtonSize(){return{height:28,minWidth:48}}function _classCallCheck$2n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2j(n.key),n)}}function _createClass$2n(e,t,r){return t&&_defineProperties$2j(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2j(e){var t=_toPrimitive$2j(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2j(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1Z(e,t,r){return t=_getPrototypeOf$1Z(t),_possibleConstructorReturn$1Z(e,_isNativeReflectConstruct$1Z()?Reflect.construct(t,r||[],_getPrototypeOf$1Z(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1Z(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1Z(e)}function _assertThisInitialized$1Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1Z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1Z=function(){return!!e})()}function _superPropGet$r(e,t,r,n){var o=_get$r(_getPrototypeOf$1Z(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$r(){return _get$r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$r(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$r.apply(null,arguments)}function _superPropBase$r(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1Z(e)););return e}function _getPrototypeOf$1Z(e){return(_getPrototypeOf$1Z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1Z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1Z(e,t)}function _setPrototypeOf$1Z(e,t){return(_setPrototypeOf$1Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}BI.config("bi.button.props",(()=>({minWidth:0})));var __decorate$14=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ReportPopover=function(e){function t(){var e;return _classCallCheck$2n(this,t),(e=_callSuper$1Z(this,t,arguments)).props={baseCls:"bi-popover bi-card bi-border-radius",size:"normal",logic:{dynamic:!1},header:null,headerHeight:46,body:null,footer:null,footerHeight:44,closable:!0,bodyHgap:0,bodyTgap:0,btns:[BI.i18nText("BI-Basic_Sure"),BI.i18nText("BI-Basic_Cancel")],warningTitle:"",draggable:!0},e}return _inherits$1Z(t,BI.Popover),_createClass$2n(t,[{key:"mounted",value:function(){var e;null===(e=_superPropGet$r(t,"mounted",this,1))||void 0===e||e.call(this),this.resizable=new resizableExports.Resizable(this.element[0])}},{key:"setPosition",value:function(e){const{center:t,left:r,top:n}=e;t||this.resizable.setPosition(n||0,r||0)}}])}();ReportPopover.xtype="report.main.popover",ReportPopover=__decorate$14([shortcut()],ReportPopover);let ReportBarPopover=function(e){function t(){return _classCallCheck$2n(this,t),_callSuper$1Z(this,t,arguments)}return _inherits$1Z(t,ReportPopover),_createClass$2n(t,[{key:"beforeCreate",value:function(){const e=this.options;e.footer||(e.footer={type:BI.RightVerticalAdaptLayout.xtype,lgap:10,items:[Object.assign(Object.assign({type:BI.Button.xtype,text:this.options.btns[1],value:1},getAdjustedButtonSize()),{light:!0,level:"common",handler:e=>{this.fireEvent(BI.Popover.EVENT_CANCEL,e),this.close()}}),Object.assign(Object.assign({type:BI.Button.xtype,text:this.options.btns[0]},getAdjustedButtonSize()),{warningTitle:e.warningTitle,value:0,handler:e=>{this.fireEvent(BI.Popover.EVENT_CONFIRM,e),this.close()}})]})}}])}();function _classCallCheck$2m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2i(n.key),n)}}function _createClass$2m(e,t,r){return t&&_defineProperties$2i(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2i(e){var t=_toPrimitive$2i(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2i(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1Y(e,t,r){return t=_getPrototypeOf$1Y(t),_possibleConstructorReturn$1Y(e,_isNativeReflectConstruct$1Y()?Reflect.construct(t,r||[],_getPrototypeOf$1Y(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1Y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1Y(e)}function _assertThisInitialized$1Y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1Y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1Y=function(){return!!e})()}function _getPrototypeOf$1Y(e){return(_getPrototypeOf$1Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1Y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1Y(e,t)}function _setPrototypeOf$1Y(e,t){return(_setPrototypeOf$1Y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ReportBarPopover.xtype="report.main.bar_popover",ReportBarPopover=__decorate$14([shortcut()],ReportBarPopover);var __decorate$13=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ReportWateramrkModel=function(e){function t(){var e;return _classCallCheck$2m(this,t),(e=_callSuper$1Y(this,t,arguments)).computed={transformedWatermark:()=>e.model.watermark?Object.assign(Object.assign({},e.model.watermark),{text:htmlDecode(e.model.watermark.text),fontWeight:"normal"}):{}},e.actions={setWatermark:t=>{e.model.watermark=t}},e}return _inherits$1Y(t,Model),_createClass$2m(t,[{key:"state",value:function(){return{watermark:this.options.watermark||{}}}}])}();function _classCallCheck$2l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2h(n.key),n)}}function _createClass$2l(e,t,r){return t&&_defineProperties$2h(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2h(e){var t=_toPrimitive$2h(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2h(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1X(e,t,r){return t=_getPrototypeOf$1X(t),_possibleConstructorReturn$1X(e,_isNativeReflectConstruct$1X()?Reflect.construct(t,r||[],_getPrototypeOf$1X(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1X(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1X(e)}function _assertThisInitialized$1X(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1X(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1X=function(){return!!e})()}function _getPrototypeOf$1X(e){return(_getPrototypeOf$1X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1X(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1X(e,t)}function _setPrototypeOf$1X(e,t){return(_setPrototypeOf$1X=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ReportWateramrkModel.xtype="report.model.watermark",ReportWateramrkModel=__decorate$13([model()],ReportWateramrkModel);var __decorate$12=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ReportWateramrk=function(e){function t(){var e;return _classCallCheck$2l(this,t),(e=_callSuper$1X(this,t,arguments)).props={watermark:{}},e.watch={transformedWatermark:()=>{var t;null===(t=e.watermarkPane)||void 0===t||t.setValue(e.model.transformedWatermark)}},e}return _inherits$1X(t,BI.Widget),_createClass$2l(t,[{key:"render",value:function(){return{type:BI.AbsoluteLayout.xtype,items:[{el:{type:BI.WaterMark.xtype,ref:e=>{this.watermarkPane=e},watermark:this.model.transformedWatermark},top:0,left:0,right:0,bottom:0}]}}},{key:"setValue",value:function(e){this.store.setWatermark(e)}}])}();ReportWateramrk.xtype="report.watermark",ReportWateramrk=__decorate$12([shortcut(),store$1(ReportWateramrkModel,{props(){return{watermark:this.options.watermark}}})],ReportWateramrk);var axios$3={exports:{}},bind$2=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}},isBuffer_1=function(e){return null!=e&&(isBuffer$1(e)||isSlowBuffer(e)||!!e._isBuffer)};function isBuffer$1(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function isSlowBuffer(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&isBuffer$1(e.slice(0,0))}var bind$1=bind$2,isBuffer=isBuffer_1,toString=Object.prototype.toString;function isArray(e){return"[object Array]"===toString.call(e)}function isArrayBuffer(e){return"[object ArrayBuffer]"===toString.call(e)}function isFormData(e){return"undefined"!=typeof FormData&&e instanceof FormData}function isArrayBufferView(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function isString(e){return"string"==typeof e}function isNumber(e){return"number"==typeof e}function isUndefined(e){return void 0===e}function isObject$1(e){return null!==e&&"object"==typeof e}function isDate(e){return"[object Date]"===toString.call(e)}function isFile(e){return"[object File]"===toString.call(e)}function isBlob(e){return"[object Blob]"===toString.call(e)}function isFunction(e){return"[object Function]"===toString.call(e)}function isStream(e){return isObject$1(e)&&isFunction(e.pipe)}function isURLSearchParams(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function trim(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function isStandardBrowserEnv(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function forEach(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),isArray(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}function merge(){var e={};function t(t,r){"object"==typeof e[r]&&"object"==typeof t?e[r]=merge(e[r],t):e[r]=t}for(var r=0,n=arguments.length;r<n;r++)forEach(arguments[r],t);return e}function extend(e,t,r){return forEach(t,(function(t,n){e[n]=r&&"function"==typeof t?bind$1(t,r):t})),e}var utils$7={isArray:isArray,isArrayBuffer:isArrayBuffer,isBuffer:isBuffer,isFormData:isFormData,isArrayBufferView:isArrayBufferView,isString:isString,isNumber:isNumber,isObject:isObject$1,isUndefined:isUndefined,isDate:isDate,isFile:isFile,isBlob:isBlob,isFunction:isFunction,isStream:isStream,isURLSearchParams:isURLSearchParams,isStandardBrowserEnv:isStandardBrowserEnv,forEach:forEach,merge:merge,extend:extend,trim:trim},utils$6=utils$7,normalizeHeaderName$1=function(e,t){utils$6.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))},enhanceError,hasRequiredEnhanceError,createError,hasRequiredCreateError,settle,hasRequiredSettle,buildURL,hasRequiredBuildURL,parseHeaders,hasRequiredParseHeaders,isURLSameOrigin,hasRequiredIsURLSameOrigin,btoa_1,hasRequiredBtoa,cookies,hasRequiredCookies,xhr,hasRequiredXhr;function requireEnhanceError(){return hasRequiredEnhanceError?enhanceError:(hasRequiredEnhanceError=1,enhanceError=function(e,t,r,n,o){return e.config=t,r&&(e.code=r),e.request=n,e.response=o,e})}function requireCreateError(){if(hasRequiredCreateError)return createError;hasRequiredCreateError=1;var e=requireEnhanceError();return createError=function(t,r,n,o,i){var a=new Error(t);return e(a,r,n,o,i)}}function requireSettle(){if(hasRequiredSettle)return settle;hasRequiredSettle=1;var e=requireCreateError();return settle=function(t,r,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?r(e("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)}}function requireBuildURL(){if(hasRequiredBuildURL)return buildURL;hasRequiredBuildURL=1;var e=utils$7;function t(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}return buildURL=function(r,n,o){if(!n)return r;var i;if(o)i=o(n);else if(e.isURLSearchParams(n))i=n.toString();else{var a=[];e.forEach(n,(function(r,n){null!=r&&(e.isArray(r)?n+="[]":r=[r],e.forEach(r,(function(r){e.isDate(r)?r=r.toISOString():e.isObject(r)&&(r=JSON.stringify(r)),a.push(t(n)+"="+t(r))})))})),i=a.join("&")}return i&&(r+=(-1===r.indexOf("?")?"?":"&")+i),r}}function requireParseHeaders(){if(hasRequiredParseHeaders)return parseHeaders;hasRequiredParseHeaders=1;var e=utils$7,t=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return parseHeaders=function(r){var n,o,i,a={};return r?(e.forEach(r.split("\n"),(function(r){if(i=r.indexOf(":"),n=e.trim(r.substr(0,i)).toLowerCase(),o=e.trim(r.substr(i+1)),n){if(a[n]&&t.indexOf(n)>=0)return;a[n]="set-cookie"===n?(a[n]?a[n]:[]).concat([o]):a[n]?a[n]+", "+o:o}})),a):a},parseHeaders}function requireIsURLSameOrigin(){if(hasRequiredIsURLSameOrigin)return isURLSameOrigin;hasRequiredIsURLSameOrigin=1;var e=utils$7;return isURLSameOrigin=e.isStandardBrowserEnv()?function(){var t,r=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(e){var t=e;return r&&(n.setAttribute("href",t),t=n.href),n.setAttribute("href",t),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=o(window.location.href),function(r){var n=e.isString(r)?o(r):r;return n.protocol===t.protocol&&n.host===t.host}}():function(){return function(){return!0}}()}function requireBtoa(){if(hasRequiredBtoa)return btoa_1;hasRequiredBtoa=1;function e(){this.message="String contains an invalid character"}return e.prototype=new Error,e.prototype.code=5,e.prototype.name="InvalidCharacterError",btoa_1=function(t){for(var r,n,o=String(t),i="",a=0,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.charAt(0|a)||(s="=",a%1);i+=s.charAt(63&r>>8-a%1*8)){if((n=o.charCodeAt(a+=3/4))>255)throw new e;r=r<<8|n}return i}}function requireCookies(){if(hasRequiredCookies)return cookies;hasRequiredCookies=1;var e=utils$7;return cookies=e.isStandardBrowserEnv()?function(){return{write:function(t,r,n,o,i,a){var s=[];s.push(t+"="+encodeURIComponent(r)),e.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),e.isString(o)&&s.push("path="+o),e.isString(i)&&s.push("domain="+i),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()}function requireXhr(){if(hasRequiredXhr)return xhr;hasRequiredXhr=1;var e=utils$7,t=requireSettle(),r=requireBuildURL(),n=requireParseHeaders(),o=requireIsURLSameOrigin(),i=requireCreateError(),a="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||requireBtoa();return xhr=function(s){return new Promise((function(l,c){var u=s.data,d=s.headers;e.isFormData(u)&&delete d["Content-Type"];var h=new XMLHttpRequest,p="onreadystatechange",f=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in h||o(s.url)||(h=new window.XDomainRequest,p="onload",f=!0,h.onprogress=function(){},h.ontimeout=function(){}),s.auth){var g=s.auth.username||"",m=s.auth.password||"";d.Authorization="Basic "+a(g+":"+m)}if(h.open(s.method.toUpperCase(),r(s.url,s.params,s.paramsSerializer),!0),h.timeout=s.timeout,h[p]=function(){if(h&&(4===h.readyState||f)&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var e="getAllResponseHeaders"in h?n(h.getAllResponseHeaders()):null,r={data:s.responseType&&"text"!==s.responseType?h.response:h.responseText,status:1223===h.status?204:h.status,statusText:1223===h.status?"No Content":h.statusText,headers:e,config:s,request:h};t(l,c,r),h=null}},h.onerror=function(){c(i("Network Error",s,null,h)),h=null},h.ontimeout=function(){c(i("timeout of "+s.timeout+"ms exceeded",s,"ECONNABORTED",h)),h=null},e.isStandardBrowserEnv()){var y=requireCookies(),v=(s.withCredentials||o(s.url))&&s.xsrfCookieName?y.read(s.xsrfCookieName):void 0;v&&(d[s.xsrfHeaderName]=v)}if("setRequestHeader"in h&&e.forEach(d,(function(e,t){void 0===u&&"content-type"===t.toLowerCase()?delete d[t]:h.setRequestHeader(t,e)})),s.withCredentials&&(h.withCredentials=!0),s.responseType)try{h.responseType=s.responseType}catch(e3){if("json"!==s.responseType)throw e3}"function"==typeof s.onDownloadProgress&&h.addEventListener("progress",s.onDownloadProgress),"function"==typeof s.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",s.onUploadProgress),s.cancelToken&&s.cancelToken.promise.then((function(e){h&&(h.abort(),c(e),h=null)})),void 0===u&&(u=null),h.send(u)}))},xhr}var utils$5=utils$7,normalizeHeaderName=normalizeHeaderName$1,DEFAULT_CONTENT_TYPE={"Content-Type":"application/x-www-form-urlencoded"};function setContentTypeIfUnset(e,t){!utils$5.isUndefined(e)&&utils$5.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function getDefaultAdapter(){var e;return("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process)&&(e=requireXhr()),e}var defaults$3={adapter:getDefaultAdapter(),transformRequest:[function(e,t){return normalizeHeaderName(t,"Content-Type"),utils$5.isFormData(e)||utils$5.isArrayBuffer(e)||utils$5.isBuffer(e)||utils$5.isStream(e)||utils$5.isFile(e)||utils$5.isBlob(e)?e:utils$5.isArrayBufferView(e)?e.buffer:utils$5.isURLSearchParams(e)?(setContentTypeIfUnset(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):utils$5.isObject(e)?(setContentTypeIfUnset(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e3){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};utils$5.forEach(["delete","get","head"],(function(e){defaults$3.headers[e]={}})),utils$5.forEach(["post","put","patch"],(function(e){defaults$3.headers[e]=utils$5.merge(DEFAULT_CONTENT_TYPE)}));var defaults_1=defaults$3,utils$4=utils$7;function InterceptorManager$1(){this.handlers=[]}InterceptorManager$1.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},InterceptorManager$1.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},InterceptorManager$1.prototype.forEach=function(e){utils$4.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var InterceptorManager_1=InterceptorManager$1,utils$3=utils$7,transformData$1=function(e,t,r){return utils$3.forEach(r,(function(r){e=r(e,t)})),e},isCancel$1,hasRequiredIsCancel;function requireIsCancel(){return hasRequiredIsCancel?isCancel$1:(hasRequiredIsCancel=1,isCancel$1=function(e){return!(!e||!e.__CANCEL__)})}var isAbsoluteURL$1=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)},combineURLs$1=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e},utils$2=utils$7,transformData=transformData$1,isCancel=requireIsCancel(),defaults$2=defaults_1,isAbsoluteURL=isAbsoluteURL$1,combineURLs=combineURLs$1;function throwIfCancellationRequested(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var dispatchRequest$1=function(e){return throwIfCancellationRequested(e),e.baseURL&&!isAbsoluteURL(e.url)&&(e.url=combineURLs(e.baseURL,e.url)),e.headers=e.headers||{},e.data=transformData(e.data,e.headers,e.transformRequest),e.headers=utils$2.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),utils$2.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||defaults$2.adapter)(e).then((function(t){return throwIfCancellationRequested(e),t.data=transformData(t.data,t.headers,e.transformResponse),t}),(function(t){return isCancel(t)||(throwIfCancellationRequested(e),t&&t.response&&(t.response.data=transformData(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},defaults$1=defaults_1,utils$1=utils$7,InterceptorManager=InterceptorManager_1,dispatchRequest=dispatchRequest$1;function Axios$1(e){this.defaults=e,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}Axios$1.prototype.request=function(e){"string"==typeof e&&(e=utils$1.merge({url:arguments[0]},arguments[1])),(e=utils$1.merge(defaults$1,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[dispatchRequest,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},utils$1.forEach(["delete","get","head","options"],(function(e){Axios$1.prototype[e]=function(t,r){return this.request(utils$1.merge(r||{},{method:e,url:t}))}})),utils$1.forEach(["post","put","patch"],(function(e){Axios$1.prototype[e]=function(t,r,n){return this.request(utils$1.merge(n||{},{method:e,url:t,data:r}))}}));var Axios_1=Axios$1,Cancel_1,hasRequiredCancel,CancelToken_1,hasRequiredCancelToken,spread,hasRequiredSpread;function requireCancel(){if(hasRequiredCancel)return Cancel_1;function e(e){this.message=e}return hasRequiredCancel=1,e.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},e.prototype.__CANCEL__=!0,Cancel_1=e}function requireCancelToken(){if(hasRequiredCancelToken)return CancelToken_1;hasRequiredCancelToken=1;var e=requireCancel();function t(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var r;this.promise=new Promise((function(e){r=e}));var n=this;t((function(t){n.reason||(n.reason=new e(t),r(n.reason))}))}return t.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},t.source=function(){var e;return{token:new t((function(t){e=t})),cancel:e}},CancelToken_1=t}function requireSpread(){return hasRequiredSpread?spread:(hasRequiredSpread=1,spread=function(e){return function(t){return e.apply(null,t)}})}var utils=utils$7,bind=bind$2,Axios=Axios_1,defaults=defaults_1;function createInstance(e){var t=new Axios(e),r=bind(Axios.prototype.request,t);return utils.extend(r,Axios.prototype,t),utils.extend(r,t),r}var axios$2=createInstance(defaults);axios$2.Axios=Axios,axios$2.create=function(e){return createInstance(utils.merge(defaults,e))},axios$2.Cancel=requireCancel(),axios$2.CancelToken=requireCancelToken(),axios$2.isCancel=requireIsCancel(),axios$2.all=function(e){return Promise.all(e)},axios$2.spread=requireSpread(),axios$3.exports=axios$2,axios$3.exports.default=axios$2;var axiosExports=axios$3.exports,axios=axiosExports;const axios$1=getDefaultExportFromCjs$1(axios);function _classCallCheck$2k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2g(n.key),n)}}function _createClass$2k(e,t,r){return t&&_defineProperties$2g(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2g(e){var t=_toPrimitive$2g(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2g(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var __decorate$11=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let CrudProvider=_createClass$2k((function e(){_classCallCheck$2k(this,e),this.params={}}),[{key:"inject",value:function(e){this.params=e}},{key:"$get",value:function(){return BI.inherit(BI.OB,{params:this.params})}}]);function _classCallCheck$2j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2f(n.key),n)}}function _createClass$2j(e,t,r){return t&&_defineProperties$2f(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2f(e){var t=_toPrimitive$2f(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2f(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}CrudProvider.xtype="bi.provider.crud",CrudProvider=__decorate$11([provider()],CrudProvider);let RequestAdapterProvider=_createClass$2j((function e(){_classCallCheck$2j(this,e),this.adapterDict=new Map}),[{key:"set",value:function(e,t){this.adapterDict.set(e,t)}},{key:"handle",value:function(e){const t=e.config.url||"",r=this.adapterDict.get(t);return r?r(e):e}},{key:"handleRequestParam",value:function(e){return Object.assign(Object.assign({},e),BI.Providers.getProvider(CrudProvider.xtype).params)}}]);const requestAdapterProvider=new RequestAdapterProvider;function _createClass$2i(e,t,r){return Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck$2i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}let AbstractErrorHandler=_createClass$2i((function e(){_classCallCheck$2i(this,e)}));const SESSION_ERROR_CODE="12400007";function _classCallCheck$2h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2e(n.key),n)}}function _createClass$2h(e,t,r){return t&&_defineProperties$2e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2e(e){var t=_toPrimitive$2e(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2e(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1W(e,t,r){return t=_getPrototypeOf$1W(t),_possibleConstructorReturn$1W(e,_isNativeReflectConstruct$1W()?Reflect.construct(t,r||[],_getPrototypeOf$1W(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1W(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1W(e)}function _assertThisInitialized$1W(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1W(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1W=function(){return!!e})()}function _getPrototypeOf$1W(e){return(_getPrototypeOf$1W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1W(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1W(e,t)}function _setPrototypeOf$1W(e,t){return(_setPrototypeOf$1W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let EmptyErrorHandler=function(e){function t(){return _classCallCheck$2h(this,t),_callSuper$1W(this,t,arguments)}return _inherits$1W(t,AbstractErrorHandler),_createClass$2h(t,[{key:"handle",value:function(){}}])}();function _classCallCheck$2g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2d(n.key),n)}}function _createClass$2g(e,t,r){return t&&_defineProperties$2d(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2d(e){var t=_toPrimitive$2d(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2d(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1V(e,t,r){return t=_getPrototypeOf$1V(t),_possibleConstructorReturn$1V(e,_isNativeReflectConstruct$1V()?Reflect.construct(t,r||[],_getPrototypeOf$1V(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1V(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1V(e)}function _assertThisInitialized$1V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1V(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1V=function(){return!!e})()}function _getPrototypeOf$1V(e){return(_getPrototypeOf$1V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1V(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1V(e,t)}function _setPrototypeOf$1V(e,t){return(_setPrototypeOf$1V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let GlobalErrorHandler=function(e){function t(){return _classCallCheck$2g(this,t),_callSuper$1V(this,t,arguments)}return _inherits$1V(t,AbstractErrorHandler),_createClass$2g(t,[{key:"handle",value:function(e){const t=BI.UUID(),r=BI.Layers.create(t);BI.createWidget({type:BI.CenterAdaptLayout.xtype,cls:"bi-card",element:r,items:[Object.assign({type:ErrorTip.xtype},e)]}),BI.Layers.show(t)}}])}();function _classCallCheck$2f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2c(n.key),n)}}function _createClass$2f(e,t,r){return t&&_defineProperties$2c(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2c(e){var t=_toPrimitive$2c(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2c(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var __decorate$10=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ErrorHandlerProvider=_createClass$2f((function e(){_classCallCheck$2f(this,e),this.errorHandlerDict=new Map([[SESSION_ERROR_CODE,GlobalErrorHandler]])}),[{key:"$get",value:function(){const e=this;return _createClass$2f((function e(){_classCallCheck$2f(this,e)}),[{key:"getHandler",value:function(t){return new(e.errorHandlerDict.get(t)||EmptyErrorHandler)}},{key:"setHandler",value:function(t,r){e.errorHandlerDict.set(t,r)}},{key:"handle",value:function(e){try{const t=e.data;return(null==t?void 0:t.errorCode)&&this.getHandler(t.errorCode).handle(t),e}catch(t){throw e}}}])}},{key:"addErrorHandler",value:function(e,t){const r=BI.inherit(AbstractErrorHandler,t);this.errorHandlerDict.set(e,r)}}]);ErrorHandlerProvider.xtype="error.handle.provider",ErrorHandlerProvider=__decorate$10([provider()],ErrorHandlerProvider);const errorHandlerProvider=BI.Providers.getProvider(ErrorHandlerProvider.xtype);function _classCallCheck$2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2b(n.key),n)}}function _createClass$2e(e,t,r){return t&&_defineProperties$2b(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2b(e){var t=_toPrimitive$2b(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2b(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}let Interceptor=_createClass$2e((function e(){_classCallCheck$2e(this,e)}),[{key:"handle",value:function(e){var t;return(null===(t=e.data)||void 0===t?void 0:t.errorCode)?errorHandlerProvider.handle(e):requestAdapterProvider.handle(e)}},{key:"handleRequestParam",value:function(e){return requestAdapterProvider.handleRequestParam(e)}}]);const interceptor=new Interceptor,LAST_OPERATING_TIME="fine_last_operating_time";function stringfyParams(e){const t=BI.isString(e)?e:JSON.stringify(e);return encodeURIComponent(encodeURIComponent(t))}function paramsSerializer(e,t=stringfyParams){return Object.keys(e||{}).map((r=>{const n=e[r];if(BI.isNull(n))return"";const o=t(BI.isObject(n)?JSON.stringify(n):n);return"".concat(t(r),"=").concat(o)})).filter((e=>""!==e)).join("&")}function appendParams2Url(e,t){if(!t)return e;const r=e.includes("?")?BI.isNotEmptyObject(t)?"&":"":"?";return"".concat(e).concat(r).concat(paramsSerializer(t))}async function basicRequest(e={}){const{url:t,type:r,headers:n={},data:o,params:i={},noProgress:a=!1,cancelToken:s,baseURL:l=envProvider.ReqPrefix,executeTime:c}=e;return BI.debounce((()=>{window.localStorage&&BI.Cache.setItem(LAST_OPERATING_TIME,(new Date).getTime())}),BI.EVENT_RESPONSE_TIME)(),axios$1.request({url:t,baseURL:l||envProvider.FineServletURL,method:r,headers:Object.assign(Object.assign({},n),{"X-Requested-With":"XMLHttpRequest"}),params:Object.assign(Object.assign({},i),{_:null!=c?c:BI.getDate().getTime()}),paramsSerializer:paramsSerializer,data:o,cancelToken:s}).then((e=>interceptor.handle(e))).catch((e=>{throw e}))}async function request(e={}){const t=e.params||{};return e.params=interceptor.handleRequestParam(t),basicRequest(e).then((e=>200===e.status?BI.isString(e.data)?transformStringResponseData2JSON(e.data):e.data:{}))}function requestGet(e,t={}){const{data:r,params:n={},headers:o={},noProgress:i=!1,cancelToken:a,baseURL:s}=t;return request({url:e,type:"GET",data:r,params:Object.assign({sessionID:envProvider.SessionID},n),headers:o,noProgress:i,cancelToken:a,baseURL:s})}function requestPost(e,t={}){const{data:r,params:n={},headers:o={},noProgress:i=!1,cancelToken:a,baseURL:s,encoder:l,executeTime:c}=t;return request({url:e,type:"POST",data:paramsSerializer(r,l),params:n,headers:Object.assign({sessionID:envProvider.SessionID,"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},o),noProgress:i,cancelToken:a,baseURL:s,executeTime:c})}function transformStringResponseData2JSON(e){const t=BI.jsonDecode(e);return""===e||BI.isEmptyArray(t)?e:t}function completeUrl(e,t){const r=paramsSerializer({});return"".concat(envProvider.ReqPrefix,"/").concat(e,"?sessionID=").concat(envProvider.SessionID).concat(""===r?"":"&".concat(r))}function openUrlByPost(e,t,r="_self"){const n=document.createElement("form");n.action=e,n.target=r,n.method="post",n.style.display="none",Object.keys(t||{}).forEach((e=>{const r=t[e];if(r){const t=document.createElement("textarea");t.name=e,t.value=r,n.appendChild(t)}})),document.body.appendChild(n),n.submit(),n.remove()}function dbCommit(e,t={}){return requestPost("db/commit",{data:{__parameters__:Object.assign(Object.assign({},e),t)}})}function _classCallCheck$2d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2a(n.key),n)}}function _createClass$2d(e,t,r){return t&&_defineProperties$2a(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2a(e){var t=_toPrimitive$2a(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2a(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1U(e,t,r){return t=_getPrototypeOf$1U(t),_possibleConstructorReturn$1U(e,_isNativeReflectConstruct$1U()?Reflect.construct(t,r||[],_getPrototypeOf$1U(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1U(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1U(e)}function _assertThisInitialized$1U(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1U(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1U=function(){return!!e})()}function _getPrototypeOf$1U(e){return(_getPrototypeOf$1U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1U(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1U(e,t)}function _setPrototypeOf$1U(e,t){return(_setPrototypeOf$1U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let WidgetManager=function(e){function t(){return _classCallCheck$2d(this,t),_callSuper$1U(this,t,arguments)}return _inherits$1U(t,CoreWidgetManager),_createClass$2d(t,[{key:"dbCommit",value:function(e){dbCommit(e)}}])}();function sendMailWithPopover(e,t){const r=BI.UUID();BI.Popovers.create(r,{type:ReportPopover.xtype,width:200,height:100,header:BI.i18nText("Fine-Engine_Basic_Email"),closable:!1,bodyHgap:20,bodyTgap:10,body:{type:BI.Label.xtype,text:BI.i18nText("Fine-Engine_Basic_Email_Sending")}}).open(r),t(e).then((e=>{BI.Popovers.remove(r),"error"===e.status?BI.Msg.alert(BI.i18nText("Fine-Engine_Basic_Email_Send_Failed"),getErrorMsg(e),(()=>{})):BI.Msg.alert(BI.i18nText("Fine-Engine_Basic_Email"),BI.i18nText("Fine-Engine_Basic_Email_Send_Success"),(()=>{}))}))}function getErrorMsg(e){return e.code===ERROR_CODE.DATA_NO_AUTH?e.message:BI.i18nText("Fine-Engine_Basic_Email_Send_Error")}function _classCallCheck$2c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$29(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$29(n.key),n)}}function _createClass$2c(e,t,r){return t&&_defineProperties$29(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$29(e){var t=_toPrimitive$29(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$29(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}let AbstractCellHandler=_createClass$2c((function e(t){_classCallCheck$2c(this,e),this.externalContext=t}),[{key:"tableData",get:function(){return this.externalContext.getTableData()}},{key:"getCellById",value:function(e){if(!e)return;let t;return this.tableData.some((r=>r.some((r=>r.id===e&&(t=r,!0))))),t||void 0}}]);function encodeCacheKey(e,t){return"".concat(e,"-").concat(t)}function decodeCacheKey(e){const[t,r]=e.split("-").map((e=>parseInt(e,10)));return{x:t,y:r}}function alterRawTable(e,t,r){t.forEach((t=>{const{x:n,y:o,alterer:i}=t,a=findCellByPosition(e,n,o);a&&r(a,i)}))}function findCellByPosition(e,t,r){let n;return e.some((e=>e.some((e=>e.position.x===t&&e.position.y===r&&(n=e,!0))))),n}function findValidCellData(e,t,r){return e.reduce(((e,n)=>e.concat(n.filter((e=>r(e,t))))),[])}function _classCallCheck$2b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$28(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$28(n.key),n)}}function _createClass$2b(e,t,r){return t&&_defineProperties$28(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$28(e){var t=_toPrimitive$28(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$28(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1T(e,t,r){return t=_getPrototypeOf$1T(t),_possibleConstructorReturn$1T(e,_isNativeReflectConstruct$1T()?Reflect.construct(t,r||[],_getPrototypeOf$1T(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1T(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1T(e)}function _assertThisInitialized$1T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1T(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1T=function(){return!!e})()}function _getPrototypeOf$1T(e){return(_getPrototypeOf$1T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1T(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1T(e,t)}function _setPrototypeOf$1T(e,t){return(_setPrototypeOf$1T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let AbstractCellStyleHandler=function(e){function t(e,r){var n;_classCallCheck$2b(this,t),(n=_callSuper$1T(this,t,[e])).eventNames=["CELL_CLICK","CELL_HOVER"],n.merger="uniqe",n.clickCache=new Map,n.hoverCache=new Map,n.filterOperationMap={line:(e,t)=>e.position.y===t.y,column:(e,t)=>e.position.x===t.x,cross:(e,t)=>e.position.x===t.x||e.position.y===t.y,cell:(e,t)=>e.position.x===t.x&&e.position.y===t.y},n.canCellResetMap={row:(e,t)=>e.y===t.y,column:(e,t)=>e.x===t.x,all:(e,t)=>e.y===t.y&&e.x===t.x,cross:(e,t)=>e.y===t.y||e.x===t.x,default:()=>!0};const{type:o,hold:i="default",trigger:a}=r;return n.filter=BI.isFunction(o)?o:n.filterOperationMap[o],n.canCellReset=BI.isFunction(i)?i:n.canCellResetMap[i],n.trigger=a,n}return _inherits$1T(t,AbstractCellHandler),_createClass$2b(t,[{key:"alterTableCellStyle",value:function(e){alterRawTable(this.tableData,e.map((({x:e,y:t,style:r})=>({x:e,y:t,alterer:r}))),((e,t)=>{e.cellstyle=BI.extend(e.cellstyle||{},t)}))}},{key:"action",value:function({e:e,cell:t}){const r="mouseup"===(null==e?void 0:e.type)?"mousedown":"mouseover";if(this.eventTrigger=r,!t)return void(this.eventTrigger===this.trigger&&(this.resetTableCell(),this.updateTable()));const{x:n,y:o}=t.position,i="mousedown"===r&&this.clickCache.has(encodeCacheKey(n,o));this.eventPosition={x:n,y:o},this.resetTableCell(),r!==this.trigger&&void 0!==this.trigger||(i?this.updateTable():this.doAction(n,o))}},{key:"doAction",value:function(e,t){findValidCellData(this.tableData,{x:e,y:t},this.filter).forEach((e=>{this.alterCell(e.position.x,e.position.y)})),this.updateTable()}},{key:"updateTable",value:function(){this.externalContext.populate(this.tableData)}},{key:"alterCell",value:function(e,t){alterRawTable(this.tableData,[{x:e,y:t,alterer:this.cellStyle}],((r,n)=>{if(r.value=r.value||'{"type":"text","value":"","autoWrapInfo":"[]"}',"mousedown"===this.eventTrigger){const n=encodeCacheKey(e,t);this.clickCache.set(n,this.hoverCache.has(n)?this.hoverCache.get(n):this.transform2DeaultStyle(r.cellstyle))}else"mouseover"===this.eventTrigger&&this.hoverCache.set(encodeCacheKey(e,t),this.transform2DeaultStyle(r.cellstyle));BI.deepExtend(r,{cellstyle:n})}))}},{key:"resetTableCell",value:function(){const e=[];this.resetHoverCell(e),this.resetClickCell(e),this.alterTableCellStyle(e)}},{key:"resetHoverCell",value:function(e){"mousedown"!==this.eventTrigger&&this.hoverCache.forEach(((t,r)=>{const{x:n,y:o}=decodeCacheKey(r);this.canCellReset({x:n,y:o},this.eventPosition)&&(!this.clickCache.has(r)&&e.push({x:n,y:o,style:t}),this.hoverCache.delete(r))}))}},{key:"resetClickCell",value:function(e){"mouseover"!==this.eventTrigger&&this.clickCache.forEach(((t,r)=>{const{x:n,y:o}=decodeCacheKey(r);this.canCellReset({x:n,y:o},this.eventPosition)&&(this.hoverCache.has(r)&&this.hoverCache.delete(r),e.push({x:n,y:o,style:t}),this.clickCache.delete(r))}))}}])}();function _classCallCheck$2a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$27(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$27(n.key),n)}}function _createClass$2a(e,t,r){return t&&_defineProperties$27(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$27(e){var t=_toPrimitive$27(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$27(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1S(e,t,r){return t=_getPrototypeOf$1S(t),_possibleConstructorReturn$1S(e,_isNativeReflectConstruct$1S()?Reflect.construct(t,r||[],_getPrototypeOf$1S(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1S(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1S(e)}function _assertThisInitialized$1S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1S(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1S=function(){return!!e})()}function _getPrototypeOf$1S(e){return(_getPrototypeOf$1S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1S(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1S(e,t)}function _setPrototypeOf$1S(e,t){return(_setPrototypeOf$1S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let BackgroundColorHandler=function(e){function t(e,r){var n;_classCallCheck$2a(this,t),(n=_callSuper$1S(this,t,[e,r])).name="CHANGE_CELL_BACKGROUND";const{style:o}=r;return n.cellStyle={cellBackground:{background:{backgroundType:"ColorBackground",color:"".concat(o)}}},n}return _inherits$1S(t,AbstractCellStyleHandler),_createClass$2a(t,[{key:"transform2DeaultStyle",value:function(e){var t;return BI.deepClone({cellBackground:{background:(null===(t=null==e?void 0:e.cellBackground)||void 0===t?void 0:t.background)||{}}})}}])}();function _classCallCheck$29(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$26(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$26(n.key),n)}}function _createClass$29(e,t,r){return t&&_defineProperties$26(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$26(e){var t=_toPrimitive$26(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$26(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1R(e,t,r){return t=_getPrototypeOf$1R(t),_possibleConstructorReturn$1R(e,_isNativeReflectConstruct$1R()?Reflect.construct(t,r||[],_getPrototypeOf$1R(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1R(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1R(e)}function _assertThisInitialized$1R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1R(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1R=function(){return!!e})()}function _getPrototypeOf$1R(e){return(_getPrototypeOf$1R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1R(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1R(e,t)}function _setPrototypeOf$1R(e,t){return(_setPrototypeOf$1R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let FontStyleHandler=function(e){function t(e,r){var n;_classCallCheck$29(this,t),(n=_callSuper$1R(this,t,[e,r])).name="CHANGE_CELL_FONT_STYLE";const{style:o}=r;return n.cellStyle={fontStyle:Object.assign({fontFamily:"",underLine:{width:0,color:-16777216,style:"SOLID"}},o)},n}return _inherits$1R(t,AbstractCellStyleHandler),_createClass$29(t,[{key:"transform2DeaultStyle",value:function(e){return BI.deepClone({fontStyle:null==e?void 0:e.fontStyle})}}])}();function _classCallCheck$28(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$25(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$25(n.key),n)}}function _createClass$28(e,t,r){return t&&_defineProperties$25(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$25(e){var t=_toPrimitive$25(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$25(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1Q(e,t,r){return t=_getPrototypeOf$1Q(t),_possibleConstructorReturn$1Q(e,_isNativeReflectConstruct$1Q()?Reflect.construct(t,r||[],_getPrototypeOf$1Q(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1Q(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1Q(e)}function _assertThisInitialized$1Q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1Q(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1Q=function(){return!!e})()}function _getPrototypeOf$1Q(e){return(_getPrototypeOf$1Q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1Q(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1Q(e,t)}function _setPrototypeOf$1Q(e,t){return(_setPrototypeOf$1Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let PopupHandler=function(e){function t(e,r){var n;_classCallCheck$28(this,t),(n=_callSuper$1Q(this,t,[e])).name="HOVER_CELL_POPUP",n.eventNames=["CELL_HOVER"],n.merger="",n.useCellValue=!1;const{header:o,body:i,image:a,style:s,position:l,scopeType:c}=r;return n.position=l,n.scopeType=c,n.useCellValue=BI.isNull(i),n.attach=()=>{n.combo||n.externalContext.attach({type:BI.AbsoluteLayout.xtype,items:[{el:{type:BI.Combo.xtype,container:"body",belowMouse:!0,el:{type:BI.Layout.xtype},ref:e=>{n.combo=e},popup:{minHeight:15,cls:n.createPopupStyle(s).classes.popupContainer,hgap:1,vgap:1,el:{type:BI.VerticalLayout.xtype,cls:"bi-card bi-border-radius",extraCls:n.createPopupStyle(s).classes.popupStyle,items:[o?{el:{type:BI.Label.xtype,cls:"bi-header-background bi-font-bold",text:o,hgap:5,vgap:5,title:null}}:{},i||!a?{type:BI.Label.xtype,ref:e=>{n.textLabel=e},text:i,hgap:5,vgap:5,title:null}:{type:BI.Img.xtype,src:a,hgap:5,vgap:5}]}}}}]})},n}return _inherits$1Q(t,AbstractCellHandler),_createClass$28(t,[{key:"createPopupStyle",value:function(e={}){return index.use(jssNested()),index.createStyleSheet({popupStyle:{"&.bi-card":{color:"".concat(e.color," !important"),"background-color":"".concat(e.backgroundColor," !important")},"font-weight":e.fontWeight,"font-family":e.fontFamily,"font-size":e.fontSize,"text-decoration":"".concat(e.textDecorationLine," ").concat(e.textDecorationStyle," ").concat(e.textDecorationColor," ").concat(e.textDecorationThickness),"font-style":e.fontStyle,"text-shadow":e.textShadow,padding:e.padding,"line-height":e.lineHeight,"vertical-align":e.verticalAlign,"text-align":e.textAlign,border:e.border,"background-size":"contain","background-repeat":e.backgroundRepeat,"background-image":e.backgroundImage},popupContainer:{"& >.bi-card":{"background-color":e.backgroundColor?"transparent !important":"white"},"pointer-events":"none"}}).attach()}},{key:"action",value:function({cell:e,e:t}){if(this.combo&&this.combo.hideView(),!e)return;if(BI.isNull(this.position))return this.doAction(t,e.value);const{position:{x:r,y:n}}=e,{x:o,y:i}=this.position;let a;switch(this.scopeType){case"cell":default:a=r===o&&n===i;break;case"table":a=!0;break;case"rowcolumn":a=r===o||n===i}a&&this.doAction(t,e.value)}},{key:"doAction",value:function(e,t){var r;this.attach(),this.combo.showView(e),this.useCellValue&&(null===(r=this.textLabel)||void 0===r||r.setValue(t))}}])}();function _classCallCheck$27(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$24(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$24(n.key),n)}}function _createClass$27(e,t,r){return t&&_defineProperties$24(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$24(e){var t=_toPrimitive$24(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$24(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1P(e,t,r){return t=_getPrototypeOf$1P(t),_possibleConstructorReturn$1P(e,_isNativeReflectConstruct$1P()?Reflect.construct(t,r||[],_getPrototypeOf$1P(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1P(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1P(e)}function _assertThisInitialized$1P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1P(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1P=function(){return!!e})()}function _superPropGet$q(e,t,r,n){var o=_get$q(_getPrototypeOf$1P(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$q(){return _get$q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$q(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$q.apply(null,arguments)}function _superPropBase$q(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1P(e)););return e}function _getPrototypeOf$1P(e){return(_getPrototypeOf$1P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1P(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1P(e,t)}function _setPrototypeOf$1P(e,t){return(_setPrototypeOf$1P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let CellControllerManager=function(e){function t(){var e;return _classCallCheck$27(this,t),(e=_callSuper$1P(this,t,arguments)).uninitializedDict=new Map,e.unmountDict=new Map,e.shouldHideSelectFrame=!1,e}return _inherits$1P(t,WidgetManager),_createClass$27(t,[{key:"addUninitializedWidget",value:function(e,t,r){this.uninitializedDict.set(e,t),r&&this.unmountDict.set(e,r)}},{key:"mountWidget",value:function(e){var t;null===(t=this.unmountDict.get(e))||void 0===t||t(),this.unmountDict.delete(e)}},{key:"initializeWidget",value:function(e){var t;null===(t=this.uninitializedDict.get(e))||void 0===t||t.init(),this.uninitializedDict.delete(e)}},{key:"getUninitializedWidgetsDict",value:function(){return this.uninitializedDict}},{key:"getHideSelectFrameSign",value:function(){return this.shouldHideSelectFrame}},{key:"setHideSelectFrameSign",value:function(e){this.shouldHideSelectFrame=e}},{key:"destroy",value:function(e){e?BI.isArray(e)?e.forEach((e=>{this.controllerDict.delete(e),this.uninitializedDict.delete(e),this.unmountDict.delete(e)})):(this.controllerDict.delete(e),this.uninitializedDict.delete(e),this.unmountDict.delete(e)):this.clear()}},{key:"update",value:function(){this.controllerDict.forEach((e=>{e.blur()}))}},{key:"clear",value:function(){this.controllerDict.forEach((e=>{e.destroy()})),this.uninitializedDict.clear(),this.unmountDict.clear(),_superPropGet$q(t,"clear",this)([])}},{key:"getWidgetDependenceByCellId",value:function(e="",t=[]){const r=e.toUpperCase(),n=new Map;return this.controllerDict.forEach((e=>{const t=e.attr("dependenceMap")||{};Object.values(t).forEach((t=>{const r=n.get(t)||[],o=e.attr("cellId");o&&r.push(o.toUpperCase()),n.set(t.toUpperCase(),r)}))})),this.uninitializedDict.forEach((({dependenceMap:e,cellId:t})=>{Object.values(e).forEach((e=>{const r=n.get(e)||[];t&&r.push(t.toUpperCase()),n.set(e.toUpperCase(),r)}))})),(n.get(r)||[]).forEach((e=>{t.includes(e)||(t.push(e),this.getWidgetDependenceByCellId(e,t))})),t}}])}();function _classCallCheck$26(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$23(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$23(n.key),n)}}function _createClass$26(e,t,r){return t&&_defineProperties$23(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$23(e){var t=_toPrimitive$23(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$23(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1O(e,t,r){return t=_getPrototypeOf$1O(t),_possibleConstructorReturn$1O(e,_isNativeReflectConstruct$1O()?Reflect.construct(t,r||[],_getPrototypeOf$1O(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1O(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1O(e)}function _assertThisInitialized$1O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1O(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1O=function(){return!!e})()}function _superPropGet$p(e,t,r,n){var o=_get$p(_getPrototypeOf$1O(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$p(){return _get$p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$p(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$p.apply(null,arguments)}function _superPropBase$p(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1O(e)););return e}function _getPrototypeOf$1O(e){return(_getPrototypeOf$1O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1O(e,t)}function _setPrototypeOf$1O(e,t){return(_setPrototypeOf$1O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}CellControllerManager.NAME="CELL_CONTROLLER";let CellErrorTipManager=function(e){function t(){return _classCallCheck$26(this,t),_callSuper$1O(this,t,arguments)}return _inherits$1O(t,WidgetManager),_createClass$26(t,[{key:"destroy",value:function(){_superPropGet$p(t,"destroy",this)([])}},{key:"update",value:function(){this.destroy()}},{key:"clear",value:function(){this.controllerDict.forEach((e=>{e.destroy()})),_superPropGet$p(t,"clear",this)([])}},{key:"adjustErrorTip",value:function(e,t,r){const n=this.getWidgetByName(e);if(!n)return;let o=t.width+1,i=0;const{right:a,bottom:s,top:l,width:c}=r,u=n.element.width(),d=n.element.height();(t.x||0)+t.width+u>a&&(i=s-(t.y||0)-t.height>(t.y||0)-l?d:-d);const h=u>c/2;h&&(n.setWidth(c/2),n.setTitle(n.getText())),o=h?t.width-c/2:t.width-u,i&&n.element.css({left:o,top:i})}}])}();function fetchChartPop(e,t){return requestGet("chart/pop",{params:{ChartHyperlink_ID:e,__parameters__:t}})}async function remoteEvaluate(e){return requestPost("/remote/evaluate",{data:{expression:e}})}function sendEmail(e){return requestPost("email/send",{data:e})}function _classCallCheck$25(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$22(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$22(n.key),n)}}function _createClass$25(e,t,r){return t&&_defineProperties$22(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$22(e){var t=_toPrimitive$22(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$22(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}CellErrorTipManager.NAME="ERROR_TIP";let HyperLinkClickHandler=_createClass$25((function e(t){_classCallCheck$25(this,e),this.hyperLinks=[],this.attach=()=>{this.popup||t({type:BI.AbsoluteLayout.xtype,items:[{el:{type:BI.DownListCombo.xtype,belowMouse:!0,container:"body",trigger:"",$testId:"report-table-popup",el:{type:BI.Layout.xtype},ref:e=>{this.popup=e},listeners:[{eventName:BI.DownListCombo.EVENT_CHANGE,action:e=>{this.hyperLinks[e]&&this.hyperLinks[e].excute()}}]},top:0,left:0}]})}}),[{key:"handle",value:function(e,t){this.attach();const r=t.filter((e=>!(!e||e.silent&&(e.excute(),1))));if(0===r.length)return;if(1===r.length)return void r[0].excute();const n=r.map(((e,t)=>[{$testId:"report-table-popup-hyper-link-item",text:e.getName(),value:t}]));this.hyperLinks=r,this.popup.populate(n),this.popup.showView(e)}}]);function _createClass$24(e,t,r){return Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck$24(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}let AbstractTarget=_createClass$24((function e(t,r,n){_classCallCheck$24(this,e),this.target=t,this.url=r}));function _classCallCheck$23(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$21(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$21(n.key),n)}}function _createClass$23(e,t,r){return t&&_defineProperties$21(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$21(e){var t=_toPrimitive$21(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$21(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1N(e,t,r){return t=_getPrototypeOf$1N(t),_possibleConstructorReturn$1N(e,_isNativeReflectConstruct$1N()?Reflect.construct(t,r||[],_getPrototypeOf$1N(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1N(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1N(e)}function _assertThisInitialized$1N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1N(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1N=function(){return!!e})()}function _getPrototypeOf$1N(e){return(_getPrototypeOf$1N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1N(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1N(e,t)}function _setPrototypeOf$1N(e,t){return(_setPrototypeOf$1N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let DefaultTarget=function(e){function t(e,r,n){var o;return _classCallCheck$23(this,t),(o=_callSuper$1N(this,t,[e,r,n])).options=n,o}return _inherits$1N(t,AbstractTarget),_createClass$23(t,[{key:"handle",value:function(){return window.open(this.url,"_self")}}])}();function _classCallCheck$22(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$20(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$20(n.key),n)}}function _createClass$22(e,t,r){return t&&_defineProperties$20(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$20(e){var t=_toPrimitive$20(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$20(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1M(e,t,r){return t=_getPrototypeOf$1M(t),_possibleConstructorReturn$1M(e,_isNativeReflectConstruct$1M()?Reflect.construct(t,r||[],_getPrototypeOf$1M(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1M(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1M(e)}function _assertThisInitialized$1M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1M(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1M=function(){return!!e})()}function _getPrototypeOf$1M(e){return(_getPrototypeOf$1M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1M(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1M(e,t)}function _setPrototypeOf$1M(e,t){return(_setPrototypeOf$1M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let SelfTarget=function(e){function t(e,r,n){var o;return _classCallCheck$22(this,t),(o=_callSuper$1M(this,t,[e,r,n])).byPost=n.byPost,o.parameter=n.parameter,o}return _inherits$1M(t,AbstractTarget),_createClass$22(t,[{key:"handle",value:function(){return this.byPost?openUrlByPost(this.url,{__parameters__:this.parameter},this.target):window.open(this.url,this.target)}}])}();function _createClass$21(e,t,r){return Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck$21(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper$1L(e,t,r){return t=_getPrototypeOf$1L(t),_possibleConstructorReturn$1L(e,_isNativeReflectConstruct$1L()?Reflect.construct(t,r||[],_getPrototypeOf$1L(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1L(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1L(e)}function _assertThisInitialized$1L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1L(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1L=function(){return!!e})()}function _getPrototypeOf$1L(e){return(_getPrototypeOf$1L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1L(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1L(e,t)}function _setPrototypeOf$1L(e,t){return(_setPrototypeOf$1L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let BlankTarget=function(e){function t(){return _classCallCheck$21(this,t),_callSuper$1L(this,t,arguments)}return _inherits$1L(t,SelfTarget),_createClass$21(t)}();function _classCallCheck$20(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1$(n.key),n)}}function _createClass$20(e,t,r){return t&&_defineProperties$1$(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1$(e){var t=_toPrimitive$1$(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1$(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1K(e,t,r){return t=_getPrototypeOf$1K(t),_possibleConstructorReturn$1K(e,_isNativeReflectConstruct$1K()?Reflect.construct(t,r||[],_getPrototypeOf$1K(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1K(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1K(e)}function _assertThisInitialized$1K(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1K(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1K=function(){return!!e})()}function _getPrototypeOf$1K(e){return(_getPrototypeOf$1K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1K(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1K(e,t)}function _setPrototypeOf$1K(e,t){return(_setPrototypeOf$1K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __rest$i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};let DialogTarget=function(e){function t(e,r,n){var o;return _classCallCheck$20(this,t),(o=_callSuper$1K(this,t,[e,r,n])).options=n,o}return _inherits$1K(t,AbstractTarget),_createClass$20(t,[{key:"handle",value:function(){const{width:e=0,height:t=0,attr:r={},byPost:n,parameter:o}=this.options,{title:i}=r,a=__rest$i(r,["title"]),s=BI.UUID();return this.getHeader(i).then((r=>{const i=BI.UUID();BI.Popovers.create(s,{type:ReportPopover.xtype,width:Math.min(e,window.innerWidth),height:Math.min(t,window.innerHeight),header:r,ref:e=>{this.popover=e},body:{type:BI.AbsoluteLayout.xtype,items:[{el:{type:BI.Iframe.xtype,src:n?"":this.url,name:i},top:0,left:0,right:0,bottom:0}]},listeners:[{eventName:BI.Popover.EVENT_CLOSE,action:()=>{BI.Popovers.remove(s)}}]}).open(s),BI.isNotEmptyObject(a)&&this.popover.setPosition(a),n&&openUrlByPost(this.url,{__parameters__:o},i)})),s}},{key:"getHeader",value:async function(e){if(BI.isObject(e)){const t=await remoteEvaluate(e.value);return null==t?void 0:t.result}return e}}])}();function _classCallCheck$1$(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1_(n.key),n)}}function _createClass$1$(e,t,r){return t&&_defineProperties$1_(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1_(e){var t=_toPrimitive$1_(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1_(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var __decorate$$=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let TargetProvider=_createClass$1$((function e(){_classCallCheck$1$(this,e),this.targetDict=new Map([["_self",SelfTarget],["_blank",BlankTarget],["_dialog",DialogTarget]])}),[{key:"get",value:function(e,t,r){return new(this.targetDict.get(e)||DefaultTarget)(e,t,r)}},{key:"set",value:function(e,t){this.targetDict.set(e,t)}},{key:"handle",value:function(e,t,r){return this.get(e,t,r).handle()}},{key:"getImpl",value:function(){return DefaultTarget}}]),ReportHyperlinkTargetProvider=_createClass$1$((function e(){_classCallCheck$1$(this,e)}),[{key:"$get",value:function(){return TargetProvider}}]);ReportHyperlinkTargetProvider.xtype="report.hyperlink_target.provider",ReportHyperlinkTargetProvider=__decorate$$([provider()],ReportHyperlinkTargetProvider);const hyperLinkTargetProvider=BI.Providers.getProvider(ReportHyperlinkTargetProvider.xtype);var __rest$h=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};function openUrl(e){const{target:t,url:r}=e,n=__rest$h(e,["target","url"]);return hyperLinkTargetProvider.handle(t,r,n)}function _classCallCheck$1_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1Z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1Z(n.key),n)}}function _createClass$1_(e,t,r){return t&&_defineProperties$1Z(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1Z(e){var t=_toPrimitive$1Z(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1Z(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}let AbstractLink=_createClass$1_((function e(t,...r){_classCallCheck$1_(this,e),this.silent=!1;const{name:n}=t;this.name=n,this.init(t,r)}),[{key:"init",value:function(e,...t){}},{key:"excute",value:function(){this._excute()}},{key:"getName",value:function(){return this.name}}]);function _classCallCheck$1Z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1Y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1Y(n.key),n)}}function _createClass$1Z(e,t,r){return t&&_defineProperties$1Y(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1Y(e){var t=_toPrimitive$1Y(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1Y(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1J(e,t,r){return t=_getPrototypeOf$1J(t),_possibleConstructorReturn$1J(e,_isNativeReflectConstruct$1J()?Reflect.construct(t,r||[],_getPrototypeOf$1J(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1J(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1J(e)}function _assertThisInitialized$1J(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1J(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1J=function(){return!!e})()}function _getPrototypeOf$1J(e){return(_getPrototypeOf$1J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1J(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1J(e,t)}function _setPrototypeOf$1J(e,t){return(_setPrototypeOf$1J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let DownloadLink=function(e){function t(e){var r;_classCallCheck$1Z(this,t),r=_callSuper$1J(this,t,[e]);const{id:n}=e;return r.id=n,r}return _inherits$1J(t,AbstractLink),_createClass$1Z(t,[{key:"_excute",value:function(){window.open("".concat(envProvider.FineServletURL,"/view/report?op=fr_attach&cmd=ah_download&id=").concat(this.id))}}])}();function _classCallCheck$1Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1X(n.key),n)}}function _createClass$1Y(e,t,r){return t&&_defineProperties$1X(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1X(e){var t=_toPrimitive$1X(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1X(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1I(e,t,r){return t=_getPrototypeOf$1I(t),_possibleConstructorReturn$1I(e,_isNativeReflectConstruct$1I()?Reflect.construct(t,r||[],_getPrototypeOf$1I(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1I(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1I(e)}function _assertThisInitialized$1I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1I(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1I=function(){return!!e})()}function _getPrototypeOf$1I(e){return(_getPrototypeOf$1I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1I(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1I(e,t)}function _setPrototypeOf$1I(e,t){return(_setPrototypeOf$1I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let EmptyLink=function(e){function t(){return _classCallCheck$1Y(this,t),_callSuper$1I(this,t,arguments)}return _inherits$1I(t,AbstractLink),_createClass$1Y(t,[{key:"_excute",value:function(){}}])}();function _classCallCheck$1X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1W(n.key),n)}}function _createClass$1X(e,t,r){return t&&_defineProperties$1W(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1W(e){var t=_toPrimitive$1W(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1W(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1H(e,t,r){return t=_getPrototypeOf$1H(t),_possibleConstructorReturn$1H(e,_isNativeReflectConstruct$1H()?Reflect.construct(t,r||[],_getPrototypeOf$1H(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1H(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1H(e)}function _assertThisInitialized$1H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1H(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1H=function(){return!!e})()}function _getPrototypeOf$1H(e){return(_getPrototypeOf$1H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1H(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1H(e,t)}function _setPrototypeOf$1H(e,t){return(_setPrototypeOf$1H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let HTMLLink=function(e){function t(e){var r;_classCallCheck$1X(this,t),r=_callSuper$1H(this,t,[e]);const{targetFrame:n,url:o,width:i,height:a,parameters:s=[]}=e;return r.url=o,r.target=n,r.width=i,r.height=a,r.parameters=s,r}return _inherits$1H(t,AbstractLink),_createClass$1X(t,[{key:"_excute",value:function(){openUrl({target:this.target,url:this.url,width:this.width,height:this.height,title:this.name})}},{key:"url",get:function(){const e={};return this.parameters.forEach((t=>{e[t.name]=t.value})),appendParams2Url(this._url,e)},set:function(e){this._url=e}}])}();function _classCallCheck$1W(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1V(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1V(n.key),n)}}function _createClass$1W(e,t,r){return t&&_defineProperties$1V(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1V(e){var t=_toPrimitive$1V(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1V(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1G(e,t,r){return t=_getPrototypeOf$1G(t),_possibleConstructorReturn$1G(e,_isNativeReflectConstruct$1G()?Reflect.construct(t,r||[],_getPrototypeOf$1G(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1G(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1G(e)}function _assertThisInitialized$1G(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1G(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1G=function(){return!!e})()}function _getPrototypeOf$1G(e){return(_getPrototypeOf$1G=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1G(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1G(e,t)}function _setPrototypeOf$1G(e,t){return(_setPrototypeOf$1G=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let JSLink=function(e){function t(e){var r;_classCallCheck$1W(this,t),r=_callSuper$1G(this,t,[e]);const{jsContent:n}=e;return r.jsContent=n,r}return _inherits$1G(t,AbstractLink),_createClass$1W(t,[{key:"_excute",value:function(){new Function(this.jsContent)()}}])}();function _classCallCheck$1V(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1U(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1U(n.key),n)}}function _createClass$1V(e,t,r){return t&&_defineProperties$1U(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1U(e){var t=_toPrimitive$1U(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1U(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1F(e,t,r){return t=_getPrototypeOf$1F(t),_possibleConstructorReturn$1F(e,_isNativeReflectConstruct$1F()?Reflect.construct(t,r||[],_getPrototypeOf$1F(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1F(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1F(e)}function _assertThisInitialized$1F(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1F(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1F=function(){return!!e})()}function _getPrototypeOf$1F(e){return(_getPrototypeOf$1F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1F(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1F(e,t)}function _setPrototypeOf$1F(e,t){return(_setPrototypeOf$1F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let MailLink=function(e){function t(e){var r;return _classCallCheck$1V(this,t),(r=_callSuper$1F(this,t,[e])).mailLinkProps=e,r}return _inherits$1F(t,AbstractLink),_createClass$1V(t,[{key:"_excute",value:function(){sendMailWithPopover(this.mailLinkProps,sendEmail)}}])}();function _classCallCheck$1U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1T(n.key),n)}}function _createClass$1U(e,t,r){return t&&_defineProperties$1T(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1T(e){var t=_toPrimitive$1T(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1T(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1E(e,t,r){return t=_getPrototypeOf$1E(t),_possibleConstructorReturn$1E(e,_isNativeReflectConstruct$1E()?Reflect.construct(t,r||[],_getPrototypeOf$1E(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1E(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1E(e)}function _assertThisInitialized$1E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1E(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1E=function(){return!!e})()}function _getPrototypeOf$1E(e){return(_getPrototypeOf$1E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1E(e,t)}function _setPrototypeOf$1E(e,t){return(_setPrototypeOf$1E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let ParameterLink=function(e){function t(e){var r;_classCallCheck$1U(this,t),r=_callSuper$1E(this,t,[e]);const{parameters:n}=e;return r.parameters=n,r}return _inherits$1E(t,AbstractLink),_createClass$1U(t,[{key:"_excute",value:function(){openUrl({target:"_self",url:this.url})}},{key:"url",get:function(){const e=new URL(window.location.href);return BI.each(this.parameters,((t,r)=>{e.searchParams.has(r.name)?e.searchParams.set(r.name,r.value.toString()):e.searchParams.append(r.name,r.value.toString())})),e.href}}])}();function _classCallCheck$1T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1S(n.key),n)}}function _createClass$1T(e,t,r){return t&&_defineProperties$1S(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1S(e){var t=_toPrimitive$1S(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1S(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1D(e,t,r){return t=_getPrototypeOf$1D(t),_possibleConstructorReturn$1D(e,_isNativeReflectConstruct$1D()?Reflect.construct(t,r||[],_getPrototypeOf$1D(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1D(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1D(e)}function _assertThisInitialized$1D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1D(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1D=function(){return!!e})()}function _getPrototypeOf$1D(e){return(_getPrototypeOf$1D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1D(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1D(e,t)}function _setPrototypeOf$1D(e,t){return(_setPrototypeOf$1D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let ViewletLink=function(e){function t(e){var r;_classCallCheck$1T(this,t),r=_callSuper$1D(this,t,[e]);const{targetFrame:n,width:o,height:i,reportUrl:a,parameters:s,attr:l,showParameterInterface:c,byPost:u}=e;return r.target=n,r.width=o,r.height=i,r.url=a,r.parameters=s,r.attr=l,r.showParameterInterface=c,r.byPost=u,r}return _inherits$1D(t,AbstractLink),_createClass$1T(t,[{key:"_excute",value:function(){const e=this.byPost?decodeURIComponent(stringfyParams(this.getParameter())):"";openUrl({target:this.target,url:this.url,width:this.width,height:this.height,attr:this.attr,byPost:this.byPost,parameter:e,title:this.name})}},{key:"getParameter",value:function(){const e={__pi__:this.showParameterInterface};return this.parameters.forEach((t=>{e[t.name]=t.value})),e}},{key:"url",get:function(){return this.byPost?"".concat(this._url,"&__pi__=").concat(this.showParameterInterface):"".concat(this._url,"&").concat(paramsSerializer({__parameters__:this.getParameter(),_:BI.getDate().getTime()}))},set:function(e){this._url=e}}])}();function _classCallCheck$1S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1R(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1R(n.key),n)}}function _createClass$1S(e,t,r){return t&&_defineProperties$1R(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1R(e){var t=_toPrimitive$1R(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1R(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var __decorate$_=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__rest$g=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};const DEFAUTL_LINK_TYPE={WEB_LINK:"weblink",JAVASCRIPT:"javascript",EMAIL:"email",VIEWLET:"viewlet",PARAMETER:"parameter",CHART_POPUP:"chartpop",DOWNLOAD:"download",CHART_RELATE:"chartRelate"};let ReportLinkProvider=_createClass$1S((function e(){_classCallCheck$1S(this,e),this.linkHandlerDict=new Map([[DEFAUTL_LINK_TYPE.WEB_LINK,{link:HTMLLink}],[DEFAUTL_LINK_TYPE.JAVASCRIPT,{link:JSLink}],[DEFAUTL_LINK_TYPE.EMAIL,{link:MailLink}],[DEFAUTL_LINK_TYPE.VIEWLET,{link:ViewletLink}],[DEFAUTL_LINK_TYPE.PARAMETER,{link:ParameterLink}],[DEFAUTL_LINK_TYPE.DOWNLOAD,{link:DownloadLink}]])}),[{key:"$get",value:function(){const e=this;return _createClass$1S((function e(){_classCallCheck$1S(this,e)}),[{key:"getHandler",value:function(t){var{type:r=""}=t,n=__rest$g(t,["type"]);const{link:o,external:i}=e.linkHandlerDict.get(r)||{link:EmptyLink,external:{}};return new o(n,i)}},{key:"setHandler",value:function(t,r,n){e.linkHandlerDict.set(t,{link:r,external:n})}}])}},{key:"addHandler",value:function(e,t,r){const n=BI.inherit(AbstractLink,t);this.linkHandlerDict.set(e,{link:n,external:r})}}]);function getLinkHandlerProvider(){return BI.Providers.getProvider(ReportLinkProvider.xtype)}function instantiateXHyperLinks(e,t={}){return e.filter((e=>e.javaScript)).map((e=>getLinkHandlerProvider().getHandler(Object.assign(Object.assign({name:e.name},e.javaScript),{external:t}))))}function instantiateMergedXHyperLinks(e={},t,r={}){return t.filter((e=>e.javaScript)).map((t=>{const n=e[t.javaScript.type];if(n){const e=BI.inherit(AbstractLink,n),o=t.javaScript,i=__rest$g(o,["type"]);return new e(Object.assign(Object.assign({name:t.name},i),{external:r}),r)}return getLinkHandlerProvider().getHandler(Object.assign(Object.assign({name:t.name},t.javaScript),{external:r}))}))}ReportLinkProvider.xtype="report.link.provider",ReportLinkProvider=__decorate$_([provider()],ReportLinkProvider);const DEFAULT_BACKGROUND={type:"color"},DEFAULT_INPUT_BORDER={width:0,style:"solid",color:-1},DEFAULT_BORDER="0 solid #333",DEFAULT_SHADOW={shadowBlur:5,shadowColor:"black",shadowOffsetX:1,shadowOffsetY:1},SCROLLBAR_WIDTH=14,GRADIENT_BACKGROUND_LENGTH=150,DEFAULT_TABLE_CELL_TYPE={BIAS:"bias",SIMPLE_CHART:"simplechart",CHART_CPR_FORM_WIDGET:"chartcprformwidget",currency_LINE:"currencyLine",IMAGE:"image",WEBIMAGE:"webimage",TEXT:"text",NODE:"node",DOWNLOAD:"download"},WIDTH=80,HEIGHT=21;var CUSTOM_EVENTS,CUSTOM_EVENTS2;CUSTOM_EVENTS2=CUSTOM_EVENTS||(CUSTOM_EVENTS={}),CUSTOM_EVENTS2.STATE_CHANGE="statechange",CUSTOM_EVENTS2.EVENT_CHANGE="EVENT_CHANGE";const LimitCount=500,PopupMaxHeight=500;function setFontSize(e,t){const r="".concat(e,"-").concat(BI.UUID()),n=".".concat(r);return index.use(jssGlobal(),jssNested()),index.createStyleSheet({"@global":{["".concat(n)]:{"font-size":"".concat(t,"px")}}}).attach(),r}function getWidthPropByAdaptive(e,t=1){return e?{}:{width:"".concat(Math.floor(1/t*1e3)/10,"%")}}function getSplitorByOpts(e,t){return t?void 0:e}function getFontStyle(e){return{"font-style":e,"padding-right":"0.1em"}}function setEditorStyle({opacity:e,background:t,color:r,border:n,"border-radius":o}){index.use(jssGlobal(),jssNested());const i="report-contoller-editor-".concat(BI.UUID()),a=".".concat(i);return index.createStyleSheet({"@global":{["".concat(a)]:{opacity:e,background:t},["".concat(a," .bi-input")]:{color:r},["".concat(a," .bi-textarea")]:{color:r},["".concat(a," .bi-border")]:{border:n,"boder-radius":o}}}).attach(),i}function transformControlAttrData(e=[]){return BI.isNull(e)?[]:BI.isArray(e)?e.map((({text:e,value:t})=>({text:"".concat(e),value:"".concat(BI.isNull(t)?"":t)}))):(BI.Msg.toast(BI.i18nText(e.error)),[])}function transform2DistinctValueByValues(e,t){let r=e;for(;t.includes(r);)r="​".concat(r);return r}function setComboFontSize(e,t){const{fontSize:r}=t,n="".concat(e,"-").concat(BI.UUID());index.use(jssGlobal(),jssNested());const o=".".concat(n," .bi-trigger-icon-button.bi-icon-button"),i=r/12,a="".concat(15*i,"px !important"),s="".concat(24*i,"px !important");return index.createStyleSheet({"@global":{["".concat(o)]:{width:s,"font-size":"".concat(16*i,"px")},[".".concat(n,">.bi-trigger.bi-text-trigger >div:first-child")]:{"font-size":"".concat(r,"px")},[".".concat(n,">.bi-combo .bi-trigger .bi-searcher >div:first-child")]:{"font-size":"".concat(r,"px")},[".".concat(n,"> .bi-trigger .bi-searcher >div:first-child")]:{"font-size":"".concat(r,"px")},[".".concat(n," .bi-multi-tree-check-selected-button .x-icon")]:{"font-size":"".concat(r,"px")},[".".concat(n," .bi-multi-tree-check-selected-button .bi-icon-button")]:{width:a,height:a,"line-height":a},[".".concat(n," .bi-multi-tree-check-selected-button .bi-text")]:{"font-size":"".concat(r,"px"),"line-height":a},[".".concat(n," .bi-switcher .bi-multi-select-check-selected-button .bi-text")]:{"font-size":"".concat(r,"px")}}}).attach(),n}async function fetchParamViewValue(e,t,r,n){return r(Object.assign(Object.assign({},n),{widgetname:e})).then((e=>{if(!e)return;const r=n.__text__;if(BI.isString(e)||!("value"in e))return t&&r?{text:"".concat(r),value:"".concat(r)}:void 0;const o=e.value;return BI.isEmptyString(o)?void 0:{text:"".concat(o.text),value:"".concat(o.val)}}))}function setLineHeight(e,t){const r="".concat(e,"-").concat(BI.UUID()),n=".".concat(r);return index.use(jssGlobal(),jssNested()),index.createStyleSheet({"@global":{["".concat(n," input")]:{"line-height":"".concat(t,"px")}}}).attach(),r}function transformStr2ArrBySplitor(e,t=",",r="",n=""){let o="".concat(e);return o.substring(0,1)===r&&(o=o.substring(1)),o.substring(o.length-1)===n&&(o=o.substring(0,o.length-1)),o.split(t)}function createCommonCode(){const e={};for(let t=0;t<26;t++)t>=0&&t<=9&&(e[t]=[48+t,96+t]),e[String.fromCharCode(97+t)]=t+65;return e}const keyAlias2Code=Object.assign({backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,esc:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,del:46,numlock:144,scroll:145,f1:112,f2:113,f12:123,return:13},createCommonCode());function setStyles({fontSize:e,color:t,fontWeight:r,fontFamily:n,decoration:o,initial:i,click:a,hover:s,fontStyle:l,opacity:c,background:u,border:d,"border-radius":h},p){index.use(jssGlobal(),jssNested());const f={};e&&(f["font-size"]=BI.isNumeric(e)?"".concat(e,"px"):"".concat(e)),f.color=t,f["font-weight"]=r,f["font-family"]=n,f["text-decoration"]=o,f.background=(null==i?void 0:i.background)||"transparent",(null==i?void 0:i["background-size"])&&(f["background-size"]=null==i?void 0:i["background-size"]),(null==i?void 0:i["background-position"])&&(f["background-position"]=null==i?void 0:i["background-position"]),(null==i?void 0:i["image-rendering"])&&(f["image-rendering"]=null==i?void 0:i["image-rendering"]),f["border-radius"]="2px",f["border-width"]="1px solid transparent",c&&(f.opacity="".concat(c)),u&&(f.background="".concat(u)),d&&(f.border="".concat(d)),h&&(f["border-radius"]="".concat(h)),s&&(f["&:hover"]={background:s.background}),a&&(f["&:active"]={background:a.background}),Object.keys(f).forEach((e=>{BI.isNull(f[e])&&delete f[e]})),index.createStyleSheet({"@global":["body","#body"].reduce(((e,t)=>{const r="".concat(t," .bi-button.button-common.").concat(p);return e[r]=f,e["".concat(r," .bi-text")]=l?getFontStyle(l):{},e["".concat(r," .bi-icon-label")]={margin:"0 4px"},e}),{})}).attach()}function transform2KeyCode(e){return e in keyAlias2Code?keyAlias2Code[e]:keyAlias2Code.enter}function _classCallCheck$1R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1Q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1Q(n.key),n)}}function _createClass$1R(e,t,r){return t&&_defineProperties$1Q(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1Q(e){var t=_toPrimitive$1Q(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1Q(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1C(e,t,r){return t=_getPrototypeOf$1C(t),_possibleConstructorReturn$1C(e,_isNativeReflectConstruct$1C()?Reflect.construct(t,r||[],_getPrototypeOf$1C(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1C(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1C(e)}function _assertThisInitialized$1C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1C(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1C=function(){return!!e})()}function _superPropGet$o(e,t,r,n){var o=_get$o(_getPrototypeOf$1C(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$o(){return _get$o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$o(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$o.apply(null,arguments)}function _superPropBase$o(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1C(e)););return e}function _getPrototypeOf$1C(e){return(_getPrototypeOf$1C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1C(e,t)}function _setPrototypeOf$1C(e,t){return(_setPrototypeOf$1C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let AbstractParameterControllerWidget=function(e){function t(){var e;return _classCallCheck$1R(this,t),(e=_callSuper$1C(this,t,arguments)).bubbleName=BI.UUID(),e.silence=!1,e}return _inherits$1C(t,BI.Widget),_createClass$1R(t,[{key:"isUnavailableState",value:function(){return!this.isEnabled()||!this.isVisible()}},{key:"validate",value:function(){return!0===this.getValidation().result}},{key:"emitManualStopEditEvent",value:function(){}},{key:"setSilent",value:function(e){this.silence=e}},{key:"setValue",value:function(...e){return Promise.resolve(this.setControllerValue(...e)).then((()=>{this.hideBubble(),this.fireEvent("EVENT_SET_VALUE")}))}},{key:"setText",value:function(...e){this.setValue(...e)}},{key:"preValidateAndToast",value:function(){const e=this.preGetValidation();return!0===e.result||(BI.Msg.toast("".concat(this.attr("widgetName"),": ").concat(e.errorMsg),{level:"error"}),!1)}},{key:"getValidation",value:function(){return this.isUnavailableState()?this.preGetValidation():this.postGetValidation()}},{key:"validateAndToast",value:function(){return this.isUnavailableState()?this.preValidateAndToast():this.postValidateAndToast()}},{key:"validateAndMsgToast",value:function(e=this.attr("widgetName")||""){const t=this.getValidation();return!!t.result||(BI.Msg.toast("".concat(e,": ").concat(t.errorMsg),{level:"error"}),!1)}},{key:"showBubble",value:function(e){BI.Bubbles.show(this.bubbleName,e,this,{offsetStyle:"left"})}},{key:"hideBubble",value:function(){BI.Bubbles.hide(this.bubbleName,this,{offsetStyle:"left"})}},{key:"refresh",value:function(){}},{key:"mounted",value:function(){this.fireEvent("afterinit")}},{key:"resize",value:function(e,t){const r=this.isEnabled();this.preResize(e,t),this.setEnable(r)}},{key:"setEnable",value:function(e){_superPropGet$o(t,"setEnable",this)([e]),this.fireEvent("EVENT_ENABLED",e)}},{key:"preResize",value:function(e,r){return(this.options.width!==e||this.options.height!==r)&&(this.options.width=e,this.options.height=r,this.element.css("width",e),this.element.css("height",r),_superPropGet$o(t,"reset",this)([]),!0)}},{key:"setFontSize",value:function(e){this.options.fontSize=e}},{key:"getAdapter",value:function(){}},{key:"reloadControlAttr",value:function(){}},{key:"focus",value:function(){}},{key:"blur",value:function(){}},{key:"getType",value:function(){return this.attr("xtype")}},{key:"getSubmitValue",value:function(){const e=this.attr("widgetName");return{[e]:this.getValue()}}}])}();function _classCallCheck$1Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1P(n.key),n)}}function _createClass$1Q(e,t,r){return t&&_defineProperties$1P(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1P(e){var t=_toPrimitive$1P(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1P(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1B(e,t,r){return t=_getPrototypeOf$1B(t),_possibleConstructorReturn$1B(e,_isNativeReflectConstruct$1B()?Reflect.construct(t,r||[],_getPrototypeOf$1B(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1B(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1B(e)}function _assertThisInitialized$1B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1B(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1B=function(){return!!e})()}function _getPrototypeOf$1B(e){return(_getPrototypeOf$1B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1B(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1B(e,t)}function _setPrototypeOf$1B(e,t){return(_setPrototypeOf$1B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __decorate$Z=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterButton_1;let ParameterButton=ParameterButton_1=function(e){function t(){var e;return _classCallCheck$1Q(this,t),(e=_callSuper$1B(this,t,arguments)).btnCls="report-main-parameter-container-controller-button-".concat(BI.UUID()),e.props={baseCls:"report-main-parameter-container-controller-button",width:WIDTH,height:HEIGHT,text:"",value:"",xtype:"button",hotkeys:"",isToggle:!1,isCustomStyle:!1,icon:"",initial:void 0,over:void 0,click:void 0,disabled:!1,invisible:!1,needSubmit:!1,fontSize:12,color:"",fontweight:"",fontfamily:"",decoration:"",fontstyle:void 0,$testId:"report-main-parameter-container-controller-button",widgetName:"",allowBg:!0},e}return _inherits$1B(t,AbstractParameterControllerWidget),_createClass$1Q(t,[{key:"mounted",value:function(){var e;const{hotkeys:t}=this.options;!this.silence&&this.fireEvent("afterinit"),this.button.text.setStyle({"text-overflow":"clip"});const r=t.trim().split("+");null===(e=this.keydownListener)||void 0===e||e.remove(),this.keydownListener=BI.EventListener.listen(document,"keydown",BI.debounce((e=>{if(BI.isEmptyString(t))return;if(1===BI.size(r)){const t=transform2KeyCode(BI.first(r));return void((BI.isArray(t)&&-1!==t.indexOf(e.keyCode)||e.keyCode===t)&&this.doClick())}const n=[e.keyCode];e.ctrlKey||e.metaKey?n.unshift("ctrl"):e.altKey?n.unshift("alt"):e.shiftKey&&n.unshift("shift"),1!==n.length&&BI.isEqual([r[0],transform2KeyCode(r[1])],n)&&this.doClick()}),300))}},{key:"render",value:function(){const{iconInfo:e,fontSize:t,fontweight:r,fontfamily:n,width:o,height:i,text:a,color:s,decoration:l,initial:c,click:u,over:d,fontstyle:h,xtype:p,widgetName:f}=this.options,g=this.btnCls,m="freebutton"===p,y=m&&!(null==c?void 0:c.background);setStyles(m?{fontSize:t,color:s,fontWeight:r,fontFamily:n,decoration:l,initial:c,click:u,hover:d,fontStyle:h}:{fontSize:t,initial:{background:"inhreit"}},g);const v=e?{iconCls:getIconCls(e),iconWidth:16}:{};return Object.assign(Object.assign({type:BI.Button.xtype,ref:e=>{this.button=e},cls:"button ".concat(g),attributes:{id:"fr-btn-".concat(f)}},v),{clear:y,level:"common",width:o,textWidth:o,hgap:0,height:i,text:a,minWidth:0,block:!0,listeners:[{eventName:BI.Button.EVENT_CHANGE,action:()=>{!this.silence&&this.fireEvent(ParameterButton_1.EVENT_CLICK)}}]})}},{key:"preGetValidation",value:function(){return{result:!0}}},{key:"postGetValidation",value:function(){return{result:!0}}},{key:"postValidateAndToast",value:function(){return!0}},{key:"getValue",value:function(){return this.button.getText()}},{key:"getText",value:function(){return this.button.getText()}},{key:"reset",value:function(){this.button.setText(this.options.text)}},{key:"doClick",value:function(){BI.delay((()=>{this.button.doClick()}),2*BI.EVENT_RESPONSE_TIME)}},{key:"setControllerValue",value:async function(e){BI.isNull(e)||BI.isEmptyString(e)||this.button.setText(e)}},{key:"setInteractValue",value:function(e){this.setControllerValue(e)}},{key:"setFontSize",value:function(e){this.options.fontSize=e}},{key:"setStyle",value:function(e){setStyles(e,this.btnCls)}}])}();function transformValue2Boolean(e){let t;return t="true"===e||!0===e,t}function setCheckboxStyle(e,{opacity:t,background:r,color:n}){index.use(jssGlobal(),jssNested());const o="".concat(e,"-").concat(BI.UUID()),i={};return t&&(i.opacity="".concat(t)),r&&(i.background="".concat(r)),n&&(i.color="".concat(n)),index.createStyleSheet({"@global":{[".".concat(o)]:i}}).attach(),o}function setMultiSelectItemFontSize(e,t){const r="".concat(e,"-").concat(BI.UUID()),n=".".concat(r," .bi-checkbox .checkbox-content:after");return index.use(jssGlobal(),jssNested()),index.createStyleSheet({"@global":{["".concat(n)]:{"border-width":"".concat(2*t,"px")}}}).attach(),r}function _classCallCheck$1P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1O(n.key),n)}}function _createClass$1P(e,t,r){return t&&_defineProperties$1O(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1O(e){var t=_toPrimitive$1O(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1O(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1A(e,t,r){return t=_getPrototypeOf$1A(t),_possibleConstructorReturn$1A(e,_isNativeReflectConstruct$1A()?Reflect.construct(t,r||[],_getPrototypeOf$1A(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1A(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1A(e)}function _assertThisInitialized$1A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1A(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1A=function(){return!!e})()}function _superPropGet$n(e,t,r,n){var o=_get$n(_getPrototypeOf$1A(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$n(){return _get$n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$n(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$n.apply(null,arguments)}function _superPropBase$n(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1A(e)););return e}function _getPrototypeOf$1A(e){return(_getPrototypeOf$1A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1A(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1A(e,t)}function _setPrototypeOf$1A(e,t){return(_setPrototypeOf$1A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterButton.EVENT_CLICK="click",ParameterButton.xtype="report.main.parameter_container.controller.button",ParameterButton.widgetType="button",ParameterButton=ParameterButton_1=__decorate$Z([shortcut()],ParameterButton);var __decorate$Y=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ReportMultiSelectItem=function(e){function t(){var e;return _classCallCheck$1P(this,t),(e=_callSuper$1A(this,t,arguments)).props={extraCls:"bi-multi-select-item",height:void 0,logic:{dynamic:!1},hgap:2,rgap:void 0,text:"",keyword:"",value:"",py:"",scale:1,width:80,title:()=>e.options.text},e}return _inherits$1A(t,BI.BasicButton),_createClass$1P(t,[{key:"render",value:function(){const e=this.options,t=16*e.scale+2,r=12*e.scale;return{type:BI.TableAdaptLayout.xtype,cls:setMultiSelectItemFontSize("report-main-components-multiselect-item",e.scale),horizontalAlign:BI.HorizontalAlign.Left,verticalAlign:e.logic.dynamic?BI.VerticalAlign.Middle:void 0,columnSize:[r,""],items:[{type:BI.CenterAdaptLayout.xtype,items:[{type:BI.Checkbox.xtype,cls:"bi-card",ref:e=>{this.checkbox=e},width:r,height:r,iconWidth:r,iconHeight:r,listeners:[{eventName:BI.Controller.EVENT_CHANGE,action:e=>{e===BI.Events.CLICK&&this.setSelected(this.isSelected())}}]}],width:r,height:t},{type:BI.Label.xtype,ref:e=>{this.text=e},rgap:e.rgap,keyword:e.keyword,py:e.py,cls:"list-item-text",textAlign:"left",whiteSpace:"normal",hgap:e.hgap*e.scale,text:e.text,value:e.value}]}}},{key:"doRedMark",value:function(...e){this.text.doRedMark(e)}},{key:"unRedMark",value:function(...e){this.text.unRedMark(e)}},{key:"doClick",value:function(){_superPropGet$n(t,"doClick",this,1).apply(this,arguments),this.checkbox.setSelected(this.isSelected()),this.isValid()&&this.fireEvent(BI.MultiSelectItem.EVENT_CHANGE,this.getValue(),this)}},{key:"setSelected",value:function(e){_superPropGet$n(t,"setSelected",this,1).apply(this,arguments),this.checkbox.setSelected(e)}}])}();function _classCallCheck$1O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1N(n.key),n)}}function _createClass$1O(e,t,r){return t&&_defineProperties$1N(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1N(e){var t=_toPrimitive$1N(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1N(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1z(e,t,r){return t=_getPrototypeOf$1z(t),_possibleConstructorReturn$1z(e,_isNativeReflectConstruct$1z()?Reflect.construct(t,r||[],_getPrototypeOf$1z(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1z(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1z(e)}function _assertThisInitialized$1z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1z=function(){return!!e})()}function _superPropGet$m(e,t,r,n){var o=_get$m(_getPrototypeOf$1z(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$m(){return _get$m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$m(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$m.apply(null,arguments)}function _superPropBase$m(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1z(e)););return e}function _getPrototypeOf$1z(e){return(_getPrototypeOf$1z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1z(e,t)}function _setPrototypeOf$1z(e,t){return(_setPrototypeOf$1z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ReportMultiSelectItem.EVENT_CHANGE="EVENT_CHANGE",ReportMultiSelectItem.xtype="report.main.components.multiselect_item",ReportMultiSelectItem=__decorate$Y([shortcut()],ReportMultiSelectItem);var __decorate$X=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterCheckbox_1;let ParameterCheckbox=ParameterCheckbox_1=function(e){function t(){var e;return _classCallCheck$1O(this,t),(e=_callSuper$1z(this,t,arguments)).props={baseCls:ParameterCheckbox_1.BASE_CLS,$testId:ParameterCheckbox_1.BASE_CLS,width:WIDTH,height:HEIGHT,text:"",value:!1,disabled:!1,invisible:!1,needSubmit:!1,fontSize:12,allowBg:!0},e}return _inherits$1z(t,AbstractParameterControllerWidget),_createClass$1O(t,[{key:"render",value:function(){const{width:e,text:t,value:r,fontSize:n}=this.options,o=setFontSize(ParameterCheckbox_1.BASE_CLS,n);return{type:BI.VerticalLayout.xtype,scrolly:!0,items:[{type:ReportMultiSelectItem.xtype,cls:"".concat(o),ref:e=>{this.checkbox=e},scale:n/12,width:e,text:t,logic:{dynamic:!0},selected:transformValue2Boolean(r),iconWrapperWidth:20,listeners:[{eventName:BI.MultiSelectItem.EVENT_CHANGE,action:()=>{!1!==(!this.silence&&this.fireEvent(CUSTOM_EVENTS.STATE_CHANGE))&&this.fireEvent(CUSTOM_EVENTS.EVENT_CHANGE)}}]}]}}},{key:"postValidateAndToast",value:function(){return!0}},{key:"preGetValidation",value:function(){return{result:!0}}},{key:"postGetValidation",value:function(){return{result:!0}}},{key:"getValue",value:function(){return this.checkbox.isSelected()}},{key:"setControllerValue",value:async function(e){this.checkbox.setSelected(transformValue2Boolean(e))}},{key:"setInteractValue",value:function(e){this.setControllerValue(e)}},{key:"reset",value:function(){this.checkbox.setSelected(!1)}},{key:"resize",value:function(e,r){const n=this.checkbox.isSelected();_superPropGet$m(t,"resize",this)([e,r]),this.checkbox.setSelected(n)}},{key:"setStyle",value:function(e){this.checkbox.element.addClass(setCheckboxStyle(ParameterCheckbox_1.BASE_CLS,e))}},{key:"getText",value:function(){return this.options.text}}])}();function transformItems2Selected(e,t,r,n,o){const i=BI.isArray(t)?t.slice(0):""===t?[]:transformStr2ArrBySplitor(t,r,n,o);return e.forEach((e=>{const t=i.findIndex((t=>"".concat(t)===e.value));-1!==t&&(i.splice(t,1),e.selected=!0)})),e.forEach((e=>{const t=i.findIndex((t=>"".concat(t)===e.text));-1!==t&&(i.splice(t,1),e.selected=!0)})),e}function transformValue2CheckGroupValue(e,{delimiter:t,startSymbol:r,endSymbol:n,returnArray:o}){const i=e.filter((e=>e)),a=getSplitorByOpts(t,o);return a?"".concat(r).concat(i.join(a)).concat(n):i}function setCheckboxGroupStyle(e,{opacity:t,background:r,color:n}){index.use(jssGlobal(),jssNested());const o="".concat(e,"-").concat(BI.UUID()),i={};return t&&(i.opacity="".concat(t)),r&&(i.background="".concat(r)),n&&(i.color="".concat(n)),index.createStyleSheet({"@global":{[".".concat(o)]:i}}).attach(),o}function fetchParamBasicControlAttr(e,t={},r){return requestPost("widget/data",{data:Object.assign(Object.assign({},t),{widgetname:e}),baseURL:universalEnvProvider.ReqPrefix,cancelToken:r})}function fetchParamControlAttr(e,t={},r){return fetchParamBasicControlAttr(e,t,r)}async function fetchWidgetViewValue(e){return requestPost("widget/view/value",{data:e,baseURL:universalEnvProvider.ReqPrefix})}function fetchParamDatetimeControlAttr(e,t={}){return fetchParamBasicControlAttr(e,t)}function fetchOldParamTreeControlAttr(e,t={},r){return fetchParamBasicControlAttr(e,t,r).then((e=>e||[]))}function fetchNewParamTreeStructure(e,t={}){return fetchParamBasicControlAttr(e,Object.assign(Object.assign({},t),{fine_outlet_widget:"nx",completion:!0}))}function fetchNewParamTreeControlAttr(e,t={},r){return fetchParamBasicControlAttr(e,Object.assign(Object.assign({},t),{fine_outlet_widget:"nx"}),r)}function getDownloadFileUrl(e){return"".concat(universalEnvProvider.ReqPrefix,"/attach/download?id=").concat(e,"&sessionID=").concat(envProvider.SessionID)}function downloadFile(e){window.open(getDownloadFileUrl(e))}function deleteFile(e){return requestGet("attach/release",{params:{id:e},baseURL:universalEnvProvider.ReqPrefix})}function _classCallCheck$1N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1M(n.key),n)}}function _createClass$1N(e,t,r){return t&&_defineProperties$1M(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1M(e){var t=_toPrimitive$1M(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1M(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1y(e,t,r){return t=_getPrototypeOf$1y(t),_possibleConstructorReturn$1y(e,_isNativeReflectConstruct$1y()?Reflect.construct(t,r||[],_getPrototypeOf$1y(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1y(e)}function _assertThisInitialized$1y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1y=function(){return!!e})()}function _superPropGet$l(e,t,r,n){var o=_get$l(_getPrototypeOf$1y(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$l(){return _get$l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$l(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$l.apply(null,arguments)}function _superPropBase$l(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1y(e)););return e}function _getPrototypeOf$1y(e){return(_getPrototypeOf$1y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1y(e,t)}function _setPrototypeOf$1y(e,t){return(_setPrototypeOf$1y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterCheckbox.xtype="report.main.parameter_container.controller.checkbox",ParameterCheckbox.widgetType="checkbox",ParameterCheckbox.BASE_CLS="report-main-parameter-container-controller-checkbox",ParameterCheckbox=ParameterCheckbox_1=__decorate$X([shortcut()],ParameterCheckbox);var __decorate$W=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterCheckboxGroup_1;let ParameterCheckboxGroup=ParameterCheckboxGroup_1=function(e){function t(){var e;return _classCallCheck$1N(this,t),(e=_callSuper$1y(this,t,arguments)).selectedAllValue=BI.UUID(),e.selectedAllItem={text:BI.i18nText("BI-Select_All"),value:e.selectedAllValue,selected:!1},e.props={baseCls:ParameterCheckboxGroup_1.BASE_CLS,$testId:ParameterCheckboxGroup_1.BASE_CLS,widgetName:"",width:WIDTH,height:HEIGHT,adaptive:!1,columnsInRow:1,controlAttr:{data:[],value:""},customData:!0,directEdit:!0,autoMode:!0,mode:"remote",searchTime:200,chooseAll:!1,headChooseAll:!1,noRepeat:!0,needSubmit:!1,disabled:!1,invisible:!1,fontSize:12,value:"",delimiter:",",startSymbol:"",endSymbol:"",returnArray:!1,allowBlank:!0,errorMsg:BI.i18nText("Fine-Report_Preview_Can_Not_Null"),controlAttrFetcher:fetchParamControlAttr,extraOptsGetter:()=>({}),getDependenceByWidget:()=>[],getWidgetDependenceValueByWidget:()=>({}),allowBg:!0},e}return _inherits$1y(t,AbstractParameterControllerWidget),_createClass$1N(t,[{key:"render",value:function(){const{width:e,height:t}=this.options;return{type:BI.ButtonGroup.xtype,ref:e=>{this.lists=e},chooseType:BI.ButtonGroup.CHOOSE_TYPE_MULTI,items:this.items,layouts:[{type:BI.FloatLeftLayout.xtype,width:e,height:t,scrolly:!0}]}}},{key:"mounted",value:function(){_superPropGet$l(t,"mounted",this)([]),this.checkAllSelected()}},{key:"checkAllSelected",value:function(){const{chooseAll:e,headChooseAll:t}=this.options;if(!e)return;let r=0;const n=this.lists.getAllButtons();n.forEach(((e,o)=>{o!==(t?0:n.length-1)&&e.isSelected()&&(r+=1)}));(t?BI.first(n):BI.last(n)).setSelected(r===n.length-1)}},{key:"getValue",value:function(){const{delimiter:e,returnArray:t,startSymbol:r,endSymbol:n}=this.options,o=this.lists.getAllButtons().filter((e=>e.isSelected())).map((e=>e.getValue()));return BI.remove(o,this.selectedAllValue),transformValue2CheckGroupValue(o,{delimiter:e,returnArray:t,startSymbol:r,endSymbol:n})}},{key:"preGetValidation",value:function(){const{allowBlank:e,value:t,errorMsg:r,controlAttr:n,delimiter:o,startSymbol:i,endSymbol:a}=this.options;return e||transformItems2Selected(transformControlAttrData(n.data),t,o,i,a).some((e=>e.selected))?{result:!0}:{result:!1,errorMsg:r}}},{key:"postGetValidation",value:function(){const{allowBlank:e,errorMsg:t}=this.options;return e||this.lists.getValue().length>0?{result:!0}:{result:!1,errorMsg:t}}},{key:"postValidateAndToast",value:function(){const e=this.getValidation();return!!e.result||(this.showBubble(e.errorMsg),!1)}},{key:"setControllerValue",value:async function(e){if(this.reset(),BI.isNull(e))return;const t=this.lists.getAllButtons(),{delimiter:r,startSymbol:n,endSymbol:o}=this.options;transformItems2Selected(t.map((e=>({text:e.attr("text"),value:e.getValue()}))),e,r,n,o).forEach(((e,r)=>{t[r].setSelected(e.selected||!1)})),this.checkAllSelected()}},{key:"reset",value:function(){this.lists.getAllButtons().forEach((e=>{e.setSelected(!1)}))}},{key:"setInteractValue",value:function(e){this.options.controlAttr=e,this.options.value=e.value,this.lists.populate(this.items)}},{key:"items",get:function(){const{fontSize:e,columnsInRow:t,adaptive:r,chooseAll:n,headChooseAll:o,controlAttr:i,value:a,delimiter:s,startSymbol:l,endSymbol:c}=this.options,u=setFontSize(ParameterCheckboxGroup_1.BASE_CLS,e),d=transformItems2Selected(transformControlAttrData(i.data),a,s,l,c);return(n?o?[this.selectedAllItem,...d]:[...d,this.selectedAllItem]:d).map((({text:o,value:i,selected:a=!1})=>Object.assign(Object.assign({type:ReportMultiSelectItem.xtype,width:null,scale:e/12,cls:"".concat(u," bi-list-item-active"),$testId:"report-main-parameter-container-controller-checkbox-group-item",text:o,value:i,selected:a,logic:{dynamic:r}},getWidthPropByAdaptive(r,t)),{listeners:[{eventName:BI.MultiSelectItem.EVENT_CHANGE,action:(e,t)=>{if(!n)return;const r=t.isSelected();if(e!==this.selectedAllValue)return void this.checkAllSelected();this.lists.getAllButtons().forEach((e=>{e.setSelected(r)}))}},{eventName:BI.MultiSelectItem.EVENT_CHANGE,action:()=>{this.hideBubble();!1!==(!this.silence&&this.fireEvent(CUSTOM_EVENTS.STATE_CHANGE))&&this.fireEvent(CUSTOM_EVENTS.EVENT_CHANGE)}}]})))}},{key:"updateControlAttr",value:async function(){const{widgetName:e,controlAttrFetcher:t}=this.options;return t(e,this.getRequestOpts()).then((e=>{this.options.controlAttr={data:e,value:this.options.value}}))}},{key:"reloadControlAttr",value:function(){this.reset(),this.updateControlAttr().then((()=>{this.lists.populate(this.items)}))}},{key:"getRequestOpts",value:function(){const{getWidgetDependenceValueByWidget:e,getDependenceByWidget:t,extraOptsGetter:r}=this.options,n=e(this);return Object.assign({dependence:n,reload:BI.isNotEmptyArray(t(this))},r())}},{key:"setStyle",value:function(e){this.lists.element.addClass(setCheckboxGroupStyle(ParameterCheckboxGroup_1.BASE_CLS,e))}},{key:"getText",value:function(){const e=this.lists.getAllButtons().filter((e=>e.isSelected())).map((e=>e.getText()));return BI.remove(e,this.selectedAllItem.text),"".concat(e)}}])}();function _classCallCheck$1M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1L(n.key),n)}}function _createClass$1M(e,t,r){return t&&_defineProperties$1L(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1L(e){var t=_toPrimitive$1L(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1L(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1x(e,t,r){return t=_getPrototypeOf$1x(t),_possibleConstructorReturn$1x(e,_isNativeReflectConstruct$1x()?Reflect.construct(t,r||[],_getPrototypeOf$1x(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1x(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1x(e)}function _assertThisInitialized$1x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1x(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1x=function(){return!!e})()}function _getPrototypeOf$1x(e){return(_getPrototypeOf$1x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1x(e,t)}function _setPrototypeOf$1x(e,t){return(_setPrototypeOf$1x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterCheckboxGroup.xtype="report.main.parameter_container.controller.checkbox_group",ParameterCheckboxGroup.widgetType="checkboxgroup",ParameterCheckboxGroup.BASE_CLS="report-main-parameter-container-controller-checkbox-group",ParameterCheckboxGroup=ParameterCheckboxGroup_1=__decorate$W([shortcut()],ParameterCheckboxGroup);var __decorate$V=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ParameterSingleSelectPopupModel=function(e){function t(){var e;return _classCallCheck$1M(this,t),(e=_callSuper$1x(this,t,arguments)).computed={},e.actions={updateName4Empty:()=>{e.model.name4Empty=e.options.name4EmptyGetter()||BI.i18nText("BI-Basic_No_Select")}},e}return _inherits$1x(t,Model),_createClass$1M(t,[{key:"state",value:function(){return{name4Empty:this.options.name4EmptyGetter()||BI.i18nText("BI-Basic_No_Select")}}}])}();function _classCallCheck$1L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1K(n.key),n)}}function _createClass$1L(e,t,r){return t&&_defineProperties$1K(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1K(e){var t=_toPrimitive$1K(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1K(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1w(e,t,r){return t=_getPrototypeOf$1w(t),_possibleConstructorReturn$1w(e,_isNativeReflectConstruct$1w()?Reflect.construct(t,r||[],_getPrototypeOf$1w(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1w(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1w(e)}function _assertThisInitialized$1w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1w(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1w=function(){return!!e})()}function _getPrototypeOf$1w(e){return(_getPrototypeOf$1w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1w(e,t)}function _setPrototypeOf$1w(e,t){return(_setPrototypeOf$1w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterSingleSelectPopupModel.xtype="report.model.main.parameter_container.controller.singleselectpopup",ParameterSingleSelectPopupModel=__decorate$V([model()],ParameterSingleSelectPopupModel);var __decorate$U=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterSingleSelectPopup_1;let ParameterSingleSelectPopup=ParameterSingleSelectPopup_1=function(e){function t(){var e;return _classCallCheck$1L(this,t),(e=_callSuper$1w(this,t,arguments)).props={itemsCreator:BI.emptyFn,keywordGetter:()=>{},valueGetter:()=>{},unmatchedValueGetter:()=>[],minWidth:135,maxHeight:400,height:72,value:void 0,customData:!0,allowNoSelect:!0,repopulateGetter:()=>!1,name4EmptyGetter:()=>"",itemHeightGetter:()=>24,maxCountGetter:()=>0,popupAdjuster:()=>{},tipText:""},e.unmatchedValues=[],e.hasNext=!1,e.afterInit=!1,e}return _inherits$1w(t,BI.Widget),_createClass$1L(t,[{key:"render",value:function(){const{itemsCreator:e,itemHeightGetter:t,keywordGetter:r,value:n,allowNoSelect:o,tipText:i}=this.options;return this.value=BI.deepClone(n),{type:BI.VTapeLayout.xtype,ref:e=>{this.vtapeWrapper=e},items:[{el:{type:BI.VerticalLayout.xtype,scrolly:!1,items:[{type:BI.SingleSelectItem.xtype,cls:"bi-list-item-active",iconWrapperWidth:36,ref:e=>{this.notSelectBtn=e},text:()=>this.model.name4Empty,invisible:!o,height:t(),listeners:[{eventName:BI.SingleSelectItem.EVENT_CHANGE,action:()=>{this.fireEvent(ParameterSingleSelectPopup_1.EVENT_CLEAR),this.notSelectBtn.setSelected(!1)}}]},{type:BI.TextButton.xtype,ref:e=>{this.addTextBtn=e},invisible:!0,text:BI.i18nText("BI-Basic_Click_To_Add_Text",""),height:t(),cls:"bi-high-light",hgap:5,handler:()=>{this.fireEvent(ParameterSingleSelectPopup_1.EVENT_CHANGE,r(),r(),!0)}}]},height:t()},{type:BI.ListPane.xtype,tipText:i,ref:e=>{this.pane=e},itemsCreator:(t,n)=>{const o=r();t.keyword=o,e(t,(e=>{this.hasNext=e.hasNext,e.items=this.transformItems(e.items),n(this.createItems(e.items)),1===t.times&&(this.resizeLayout(e.items),this.resize(BI.size(e.items)>0))}))},el:{type:BI.Loader.xtype,ref:e=>{this.loader=e},el:{chooseType:BI.ButtonGroup.CHOOSE_TYPE_MULTI},layouts:[{type:BI.VerticalLayout.xtype,height:400,minHeight:400,scrolly:!0}]},hasNext:()=>this.hasNext,listeners:[{eventName:BI.Pane.EVENT_LOADED,action:()=>{this.fireEvent(ParameterSingleSelectPopup_1.EVENT_LOADED)}}]}]}}},{key:"resizeLayout",value:function(e){const{allowNoSelect:t,itemHeightGetter:r}=this.options;this.vtapeWrapper.attr("items")[0].height=0!==BI.size(e)&&t?r():0,this.vtapeWrapper.resize()}},{key:"resize",value:function(e){const{itemHeightGetter:t,allowNoSelect:r,maxCountGetter:n}=this.options,o=r?t():0,i=n()*t();BI.nextTick((()=>{this.handleResize(e,(i||this.loader.element.height()||t())+o)}))}},{key:"resetResize",value:function(e){this.handleResize(e,72)}},{key:"handleResize",value:function(e,t){if(!this.afterInit)return void(this.afterInit=!0);const{itemHeightGetter:r,allowNoSelect:n,popupAdjuster:o,keywordGetter:i}=this.options,a=n?r():0;this.pane.setTipVisible(n||0===BI.size(this.pane.getAllButtons())),i()?this.vtapeWrapper.element.css("height",""):(this.vtapeWrapper.element.css("height",t),this.vtapeWrapper.attr("items")[0].height=e?a:0,this.vtapeWrapper.resize(),o())}},{key:"transformItems",value:function(e){let t=0;for(;t<this.unmatchedValues.length;){const r=this.unmatchedValues[t],n=e.findIndex((e=>e.text===r.text&&e.value===r.value));-1!==n?(e.splice(n,1),this.unmatchedValues.splice(t,1)):t+=1}e.some((e=>{if(BI.isNull(this.value))return!0;return!(e.text!==this.value.text||e.value!==this.value.value)&&(e.selected=!0,this.value=void 0,!0)}));const r=this.value?[Object.assign(Object.assign({},this.value),{selected:!0})]:[];return this.value&&this.unmatchedValues.push(this.value),this.value=void 0,e.concat(r)}},{key:"getValue",value:function(){const e=this.pane.getAllButtons().find((e=>e.isSelected()));return e?{text:e.attr("text"),value:e.getValue()}:void 0}},{key:"getAllLeaves",value:function(){return this.pane.getAllButtons().map((e=>({text:e.attr("text"),value:e.getValue()})))}},{key:"populate",value:function(){this.pane.populate()}},{key:"setAllUnselected",value:function(){this.pane.getAllButtons().forEach((e=>{e.setSelected(!1)}))}},{key:"selectNextItem",value:function(){const e=this.pane.getAllButtons(),t=e.findIndex((e=>e.isSelected()));t+1<e.length&&(t>=0&&e[t].setSelected(!1),e[t+1].setSelected(!0))}},{key:"selectPreItem",value:function(){const e=this.pane.getAllButtons(),t=e.findIndex((e=>e.isSelected()));t>0&&(e[t].setSelected(!1),e[t-1].setSelected(!0))}},{key:"createItems",value:function(e){return BI.createItems(e,{type:BI.SingleSelectItem.xtype,cls:"bi-list-item-active",iconWrapperWidth:36,height:this.options.itemHeightGetter(),keyword:this.options.keywordGetter(),$testId:"report-main-parameter-container-controller-combo-item",listeners:[{eventName:BI.SingleSelectItem.EVENT_CHANGE,action:(e,t)=>{this.fireEvent(ParameterSingleSelectPopup_1.EVENT_CHANGE,t.attr("text"),t.getValue(),t.isSelected())}}]})}},{key:"switchState",value:function(e,t){let r=!1;this.pane.getAllButtons().forEach((n=>{r?n.setSelected(!1):(r=n.attr("text")===e&&n.getValue()===t,n.setSelected(r))})),r&&!this.options.repopulateGetter()||(this.pane.addItems(this.createItems([{text:e,value:t,selected:!0}])),this.options.repopulateGetter()?this.value={text:e,value:t}:this.unmatchedValues.push({text:e,value:t}))}},{key:"setValue",value:function(e){this.setAllUnselected(),BI.isNotNull(e)&&this.switchState(e.text,e.value)}},{key:"getUnmatchedValues",value:function(){return this.unmatchedValues}},{key:"resetState",value:function(){this.unmatchedValues=[],this.value=void 0,this.hasNext=!1}},{key:"updateName4Empty",value:function(){this.store.updateName4Empty()}}])}();ParameterSingleSelectPopup.xtype="report-single-select-popup",ParameterSingleSelectPopup.EVENT_CHANGE="EVENT_CHANGE",ParameterSingleSelectPopup.EVENT_CLEAR="EVENT_CLEAR",ParameterSingleSelectPopup.EVENT_LOADED="EVENT_LOADED",ParameterSingleSelectPopup=ParameterSingleSelectPopup_1=__decorate$U([shortcut(),store$1(ParameterSingleSelectPopupModel,{props(){return{name4EmptyGetter:this.options.name4EmptyGetter}}})],ParameterSingleSelectPopup);const COMBO_POPUP_HEIGHT=25;function _classCallCheck$1K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1J(n.key),n)}}function _createClass$1K(e,t,r){return t&&_defineProperties$1J(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1J(e){var t=_toPrimitive$1J(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1J(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1v(e,t,r){return t=_getPrototypeOf$1v(t),_possibleConstructorReturn$1v(e,_isNativeReflectConstruct$1v()?Reflect.construct(t,r||[],_getPrototypeOf$1v(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1v(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1v(e)}function _assertThisInitialized$1v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1v=function(){return!!e})()}function _getPrototypeOf$1v(e){return(_getPrototypeOf$1v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1v(e,t)}function _setPrototypeOf$1v(e,t){return(_setPrototypeOf$1v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __decorate$T=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ParameterSingleSelectSearchPopup=function(e){function t(){var e;return _classCallCheck$1K(this,t),(e=_callSuper$1v(this,t,arguments)).props={itemsCreator:BI.emptyFn,keywordGetter:()=>{},valueGetter:()=>{},unmatchedValueGetter:()=>[],minWidth:135,maxHeight:400,height:void 0,value:void 0,customData:!0,allowNoSelect:!1,repopulateGetter:()=>!1,name4EmptyGetter:()=>"",itemHeightGetter:()=>24,maxCountGetter:()=>0,popupAdjuster:()=>{},tipText:BI.i18nText("BI-No_Selected_Item")},e}return _inherits$1v(t,ParameterSingleSelectPopup),_createClass$1K(t,[{key:"transformItems",value:function(e){const{valueGetter:t,unmatchedValueGetter:r,keywordGetter:n,customData:o}=this.options,i=n()||"",a=r().slice(0);let s=t();e.forEach((e=>{let t=!1;BI.isNull(s)?t=!0:(t=s.text===e.text&&s.value===e.value,e.selected=t,t&&(s=void 0));const r=a.findIndex((t=>t.text===e.text&&t.value===e.value));-1!==r&&a.splice(r,1)})),a.forEach((e=>{let t=!1;BI.isNull(s)?t=!0:(t=s.text===e.text&&s.value===e.value,e.selected=t,t&&(s=void 0))}));const{match:l,find:c}=BI.Func.getSearchResult(a,i,"value"),u=c.concat(e,l);return 0===BI.size(u)&&o?(this.addTextBtn.setText(BI.i18nText("BI-Basic_Click_To_Add_Text",n())),this.addTextBtn.visible()):this.addTextBtn.invisible(),l.concat(e,c)}},{key:"resizeLayout",value:function(e){this.vtapeWrapper.attr("items")[0].height=0!==BI.size(e)?0:COMBO_POPUP_HEIGHT,this.vtapeWrapper.resize()}}])}();function _classCallCheck$1J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1I(n.key),n)}}function _createClass$1J(e,t,r){return t&&_defineProperties$1I(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1I(e){var t=_toPrimitive$1I(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1I(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1u(e,t,r){return t=_getPrototypeOf$1u(t),_possibleConstructorReturn$1u(e,_isNativeReflectConstruct$1u()?Reflect.construct(t,r||[],_getPrototypeOf$1u(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1u(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1u(e)}function _assertThisInitialized$1u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1u(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1u=function(){return!!e})()}function _getPrototypeOf$1u(e){return(_getPrototypeOf$1u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1u(e,t)}function _setPrototypeOf$1u(e,t){return(_setPrototypeOf$1u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterSingleSelectSearchPopup.xtype="report-single-select-search-popup",ParameterSingleSelectSearchPopup=__decorate$T([shortcut()],ParameterSingleSelectSearchPopup);var __decorate$S=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterSingleSelectTrigger_1;let ParameterSingleSelectTrigger=ParameterSingleSelectTrigger_1=function(e){function t(){var e;return _classCallCheck$1J(this,t),(e=_callSuper$1u(this,t,arguments)).props={baseCls:"bi-search-text-value-trigger bi-border bi-focus-shadow",height:24,itemsCreator:BI.emptyFn,valueGetter:()=>{},unmatchedValueGetter:()=>[],watermark:"",allowEdit:!1,customData:!0,itemHeightGetter:()=>24,value:""},e}return _inherits$1u(t,BI.Trigger),_createClass$1J(t,[{key:"render",value:function(){var e;const{height:t,itemsCreator:r,valueGetter:n,watermark:o,unmatchedValueGetter:i,customData:a,itemHeightGetter:s}=this.options;return{type:BI.HTapeLayout.xtype,items:[{el:{type:BI.Searcher.xtype,ref:e=>{this.searcher=e},isAutoSearch:!1,el:{type:BI.SignEditor.xtype,ref:e=>{this.editor=e},value:(null===(e=n())||void 0===e?void 0:e.text)||"",allowBlank:!0,watermark:o,height:t,listeners:[{eventName:BI.SignEditor.EVENT_FOCUS,action:()=>{this.editor.setValue(""),this.fireEvent(ParameterSingleSelectTrigger_1.EVENT_FOCUS)}},{eventName:BI.SignEditor.EVENT_BLUR,action:()=>{this.fireEvent(ParameterSingleSelectTrigger_1.EVENT_BLUR)}},{eventName:BI.SignEditor.EVENT_CLICK,action:()=>{this.fireEvent(ParameterSingleSelectTrigger_1.EVENT_CLICK)}},{eventName:BI.SignEditor.EVENT_KEY_DOWN,action:()=>{this.fireEvent(ParameterSingleSelectTrigger_1.EVENT_KEY_DOWN)}}]},popup:{type:ParameterSingleSelectSearchPopup.xtype,customData:a,cls:"bi-card",ref:e=>{this.popup=e},keywordGetter:()=>this.editor.getValue(),unmatchedValueGetter:i,itemsCreator:r,valueGetter:n,itemHeightGetter:s,listeners:[{eventName:ParameterSingleSelectPopup.EVENT_CHANGE,action:(e,t,r)=>{this.fireEvent(ParameterSingleSelectTrigger_1.EVENT_CHANGE,e,t,r)}}]},onSearch:(e,t)=>{t()},listeners:[{eventName:BI.Searcher.EVENT_CHANGE,action:()=>{}},{eventName:BI.Searcher.EVENT_START,action:()=>{this.fireEvent(ParameterSingleSelectTrigger_1.EVENT_START)}},{eventName:BI.Searcher.EVENT_SEARCHING,action:()=>{this.fireEvent(ParameterSingleSelectTrigger_1.EVENT_SEARCHING)}},{eventName:BI.Searcher.EVENT_STOP,action:()=>{this.fireEvent(ParameterSingleSelectTrigger_1.EVENT_STOP)}}]}},{el:{type:BI.Layout.xtype,width:24},width:24}]}}},{key:"mounted",value:function(){!this.options.allowEdit&&BI.createWidget({type:BI.AbsoluteLayout.xtype,element:this,items:[{el:{type:BI.Text.xtype,title:()=>this.editor.getValue()},left:0,right:24,top:0,bottom:0}]}),BI.EventListener.listen(this.element[0],"keydown",(e=>{if("Enter"===e.key&&this.popup){const e=this.editor.getValue();this.fireEvent(ParameterSingleSelectTrigger_1.EVENT_KEY_DOWN_ENTER,e)}}))}},{key:"setValue",value:function(e){this.editor.setValue((null==e?void 0:e.text)||"")}},{key:"stopEditing",value:function(){this.searcher.stopSearch()}},{key:"getSearcher",value:function(){return this.searcher}},{key:"getValue",value:function(){return this.popup.getValue()}},{key:"setAdapter",value:function(e){this.searcher.setAdapter(e)}},{key:"adjustPopupHeight",value:function(e){this.setAdapter(e),this.searcher.populate(),this.searcher.adjustHeight()}},{key:"isSearching",value:function(){return this.searcher.isSearching()}},{key:"focus",value:function(){this.editor.focus()}},{key:"blur",value:function(){this.editor.blur()}},{key:"setWaterMark",value:function(e){this.editor.setWaterMark(e)}},{key:"selectNextItem",value:function(){this.popup.selectNextItem()}},{key:"selectPreItem",value:function(){this.popup.selectPreItem()}}])}();function _classCallCheck$1I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1H(n.key),n)}}function _createClass$1I(e,t,r){return t&&_defineProperties$1H(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1H(e){var t=_toPrimitive$1H(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1H(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1t(e,t,r){return t=_getPrototypeOf$1t(t),_possibleConstructorReturn$1t(e,_isNativeReflectConstruct$1t()?Reflect.construct(t,r||[],_getPrototypeOf$1t(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1t(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1t(e)}function _assertThisInitialized$1t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1t(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1t=function(){return!!e})()}function _getPrototypeOf$1t(e){return(_getPrototypeOf$1t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1t(e,t)}function _setPrototypeOf$1t(e,t){return(_setPrototypeOf$1t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterSingleSelectTrigger.EVENT_SEARCHING="EVENT_SEARCHING",ParameterSingleSelectTrigger.EVENT_STOP="EVENT_STOP",ParameterSingleSelectTrigger.EVENT_START="EVENT_START",ParameterSingleSelectTrigger.EVENT_CHANGE="EVENT_CHANGE",ParameterSingleSelectTrigger.EVENT_FOCUS="EVENT_FOCUS",ParameterSingleSelectTrigger.EVENT_BLUR="EVENT_BLUR",ParameterSingleSelectTrigger.xtype="report.single_select_trigger",ParameterSingleSelectTrigger.EVENT_CLICK="EVENT_CLICK",ParameterSingleSelectTrigger.EVENT_KEY_DOWN="EVENT_KEY_DOWN",ParameterSingleSelectTrigger.EVENT_KEY_DOWN_ENTER="EVENT_KEY_DOWN_ENTER",ParameterSingleSelectTrigger=ParameterSingleSelectTrigger_1=__decorate$S([shortcut()],ParameterSingleSelectTrigger);var __decorate$R=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterSingleSelectCombo_1;let ParameterSingleSelectCombo=ParameterSingleSelectCombo_1=function(e){function t(){var e;return _classCallCheck$1I(this,t),(e=_callSuper$1t(this,t,arguments)).repopulate=!1,e.needResize=!1,e.props={baseCls:"bi-search-text-value-combo",height:24,text:"",items:[],tipType:"",warningTitle:"",attributes:{tabIndex:0},title:"",value:void 0,itemsCreator:BI.emptyFn,watermark:"",allowEdit:!1,customData:!0,allowNoSelect:!0,maxPopupHeight:PopupMaxHeight,minPopupHeight:COMBO_POPUP_HEIGHT,controlDataGetter:()=>[],name4EmptyGetter:()=>"",itemHeightGetter:()=>24,maxCountGetter:()=>0},e}return _inherits$1t(t,BI.Widget),_createClass$1I(t,[{key:"render",value:function(){const{height:e,value:t,text:r,tipType:n,warningTitle:o,title:i,itemsCreator:a,watermark:s,allowEdit:l,customData:c,allowNoSelect:u,name4EmptyGetter:d,itemHeightGetter:h,maxCountGetter:p,maxPopupHeight:f,minPopupHeight:g}=this.options;return{type:BI.AbsoluteLayout.xtype,items:[{el:{type:BI.Combo.xtype,adjustLength:2,toggle:!l,ref:e=>{this.combo=e},el:{type:ParameterSingleSelectTrigger.xtype,customData:c,watermark:s,allowEdit:l,itemHeightGetter:h,cls:"search-text-value-trigger bi-border-radius",ref:e=>{this.trigger=e},height:e-2,text:r,value:t,tipType:n,warningTitle:o,itemsCreator:a,valueGetter:()=>this.popup?this.popup.getValue():t,unmatchedValueGetter:()=>this.popup?this.popup.getUnmatchedValues():t,title:i,listeners:[{eventName:ParameterSingleSelectTrigger.EVENT_FOCUS,action:()=>{this.fireEvent(ParameterSingleSelectCombo_1.EVENT_BEFORE_EDIT)}},{eventName:ParameterSingleSelectTrigger.EVENT_CHANGE,action:(e,t)=>{this.popup.switchState(e,t),this.fireEvent(ParameterSingleSelectCombo_1.EVENT_CLICK_ITEM),this.fireEvent(ParameterSingleSelectCombo_1.EVENT_AFTER_EDIT),this.combo.hideView()}},{eventName:ParameterSingleSelectTrigger.EVENT_SEARCHING,action:()=>{this.fireEvent(ParameterSingleSelectCombo_1.EVENT_AFTER_EDIT)}},{eventName:ParameterSingleSelectTrigger.EVENT_BLUR,action:()=>{this.fireEvent(ParameterSingleSelectCombo_1.EVENT_BLUR)}},{eventName:ParameterSingleSelectTrigger.EVENT_CLICK,action:()=>{this.showView()}},{eventName:ParameterSingleSelectTrigger.EVENT_KEY_DOWN_ENTER,action:e=>{this.fireEvent(ParameterSingleSelectCombo_1.EVENT_KEY_DOWN_ENTER,e),this.combo.hideView()}}]},popup:{minWidth:135,minHeight:g,maxHeight:f,el:{type:ParameterSingleSelectPopup.xtype,name4EmptyGetter:d,itemHeightGetter:h,maxCountGetter:p,allowNoSelect:u,itemsCreator:a,customData:c,tipText:u?"":BI.i18nText("BI-No_Selected_Item"),popupAdjuster:()=>{this.combo.adjustHeight()},ref:e=>{this.popup=e,this.trigger.setAdapter(this.popup)},repopulateGetter:()=>this.repopulate,listeners:[{eventName:ParameterSingleSelectPopup.EVENT_CHANGE,action:(e,t)=>{this.setValue({value:t,text:e}),this.fireEvent(ParameterSingleSelectCombo_1.EVENT_CLICK_ITEM),this.fireEvent(ParameterSingleSelectCombo_1.EVENT_AFTER_EDIT),this.combo.hideView()}},{eventName:ParameterSingleSelectPopup.EVENT_CLEAR,action:()=>{this.reset(),this.fireEvent(ParameterSingleSelectCombo_1.EVENT_CLICK_ITEM),this.fireEvent(ParameterSingleSelectCombo_1.EVENT_AFTER_EDIT),this.combo.hideView()}},{eventName:ParameterSingleSelectPopup.EVENT_LOADED,action:()=>{BI.nextTick((()=>{this.trigger.isSearching()&&this.trigger.adjustPopupHeight(this.popup)}))}}]},value:t},listeners:[{eventName:BI.Combo.EVENT_AFTER_HIDEVIEW,action:()=>{const e=this.trigger.isSearching()?this.getAdapter().getKeyword():void 0;this.trigger.stopEditing(),this.popup&&this.setValue(this.popup.getValue()),this.fireEvent(ParameterSingleSelectCombo_1.EVENT_CONFIRM,e)}},{eventName:BI.Combo.EVENT_BEFORE_POPUPVIEW,action:()=>{this.fireEvent(ParameterSingleSelectCombo_1.EVENT_BEFORE_POPUPVIEW),this.repopulate?(this.populate([]),this.popup.resetResize(!0),this.repopulate=!1):this.needResize=!0}},{eventName:BI.Combo.EVENT_AFTER_POPUPVIEW,action:()=>{this.checkResize()}}],hideChecker:e=>0===this.triggerBtn.element.find(e.target).length},left:0,right:0,bottom:0,top:0},{el:{type:BI.TriggerIconButton.xtype,cls:"trigger-icon-button",ref:e=>{this.triggerBtn=e},width:e,height:e,handler:()=>{this.combo.isViewVisible()?this.combo.hideView():(this.showView(),this.fireEvent(ParameterSingleSelectCombo_1.EVENT_BEFORE_EDIT))}},right:0,bottom:0,top:0}]}}},{key:"mounted",value:function(){BI.EventListener.listen(this.element[0],"keydown",(e=>{var t,r;const n=this.trigger&&this.trigger.isSearching();switch(e.keyCode){case BI.KeyCode.DOWN:null===(t=n?this.trigger:this.popup)||void 0===t||t.selectNextItem();break;case BI.KeyCode.UP:null===(r=n?this.trigger:this.popup)||void 0===r||r.selectPreItem();break;case BI.KeyCode.ENTER:if(n)return;this.combo.hideView()}}))}},{key:"focus",value:function(){this.trigger.focus(),this.combo.showView(),this.checkResize()}},{key:"blur",value:function(){this.trigger.blur(),this.combo.hideView()}},{key:"setRepopulate",value:function(e){this.reset(),this.popup&&this.popup.resetState(),this.popup&&(this.combo.isViewVisible()?this.combo.populate():this.repopulate=e,this.needResize=!0)}},{key:"reset",value:function(){this.popup&&this.popup.setAllUnselected(),this.setValue()}},{key:"showView",value:function(){this.combo.showView()}},{key:"isViewVisible",value:function(){return this.combo.isViewVisible()}},{key:"checkResize",value:function(){this.popup&&this.needResize&&(this.popup.resize(!0),this.needResize=!1)}},{key:"populate",value:function(e){this.options.items=e,this.combo.populate(e)}},{key:"setValue",value:function(e){var t;this.options.value=e,this.combo.setValue(e),null===(t=this.popup)||void 0===t||t.setValue(e)}},{key:"getValue",value:function(){return this.popup?this.popup.getValue():this.options.value}},{key:"validateData",value:function(){const e=this.getValue(),t=this.options.controlDataGetter();if(BI.isEmpty(null==e?void 0:e.value))return!0;return t.some((t=>t.text===(null==e?void 0:e.text)&&t.value===(null==e?void 0:e.value)))}},{key:"getAdapter",value:function(){return this.trigger.getSearcher()}},{key:"setWaterMark",value:function(e){this.trigger.setWaterMark(e)}},{key:"updateName4Empty",value:function(){var e;null===(e=this.popup)||void 0===e||e.updateName4Empty()}},{key:"selectItem",value:function(e){const t=this.options.controlDataGetter().find((t=>t.text===e))||{text:e,value:e};this.popup.switchState(t.text,t.value),this.fireEvent(ParameterSingleSelectCombo_1.EVENT_CLICK_ITEM),this.fireEvent(ParameterSingleSelectCombo_1.EVENT_AFTER_EDIT)}}])}();function transformValue2ComboNextValue(e,t){const r=preTransformValue2ComboNextValue(e);if(BI.isNull(r))return;const n=t.slice(0);let o=n.findIndex((e=>e.value==r));return-1!==o?{text:"".concat(n[o].text),value:"".concat(n[o].value)}:(o=n.findIndex((e=>e.text==r)),-1!==o?{text:"".concat(n[o].text),value:"".concat(n[o].value)}:{text:"".concat(r),value:"".concat(r)})}function preTransformValue2ComboNextValue(e){if(BI.isNull(e)||BI.isEmptyString(e))return;if(BI.isObject(e)&&"date_milliseconds"in e)return BI.print(new Date(e.date_milliseconds),"%Y-%X-%d");return BI.isArray(e)?e.join(","):e}function setComboStyle(e,{opacity:t,background:r,color:n,border:o,"border-radius":i}){index.use(jssGlobal(),jssNested());const a="".concat(e,"-").concat(BI.UUID()),s=".".concat(a);return index.createStyleSheet({"@global":{["".concat(s)]:{opacity:t,background:r},["".concat(s," .bi-combo .bi-card")]:{background:r,color:n},["".concat(s," .bi-text")]:{color:n},["".concat(s," .bi-icon-button")]:{color:n},["".concat(s," .bi-border")]:{border:o,"boder-radius":i}}}).attach(),a}function setComboPopupStyle(e,{fontSize:t,itemHeight:r}){index.use(jssGlobal(),jssNested());const n="".concat(e,"-").concat(BI.UUID()),o=".".concat(n);return index.createStyleSheet({"@global":{["".concat(o," .bi-list-pane .bi-label")]:{"font-size":"".concat(t," !important")},["".concat(o," .bi-v .bi-label")]:{"font-size":"".concat(t," !important")},["".concat(o," .bi-list-pane .bi-tips")]:{"font-size":"".concat(t," !important"),height:"".concat(r," !important"),"line-height":"".concat(r," !important")}}}).attach(),n}function _classCallCheck$1H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1G(n.key),n)}}function _createClass$1H(e,t,r){return t&&_defineProperties$1G(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1G(e){var t=_toPrimitive$1G(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1G(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1s(e,t,r){return t=_getPrototypeOf$1s(t),_possibleConstructorReturn$1s(e,_isNativeReflectConstruct$1s()?Reflect.construct(t,r||[],_getPrototypeOf$1s(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1s(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1s(e)}function _assertThisInitialized$1s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1s(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1s=function(){return!!e})()}function _superPropGet$k(e,t,r,n){var o=_get$k(_getPrototypeOf$1s(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$k(){return _get$k="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$k(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$k.apply(null,arguments)}function _superPropBase$k(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1s(e)););return e}function _getPrototypeOf$1s(e){return(_getPrototypeOf$1s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1s(e,t)}function _setPrototypeOf$1s(e,t){return(_setPrototypeOf$1s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterSingleSelectCombo.EVENT_CHANGE="EVENT_CHANGE",ParameterSingleSelectCombo.EVENT_BEFORE_POPUPVIEW="EVENT_BEFORE_POPUPVIEW",ParameterSingleSelectCombo.EVENT_CONFIRM="EVENT_CONFIRM",ParameterSingleSelectCombo.xtype="report.single_select_combo",ParameterSingleSelectCombo.EVENT_BEFORE_EDIT="EVENT_BEFORE_EDIT",ParameterSingleSelectCombo.EVENT_AFTER_EDIT="EVENT_AFTER_EDIT",ParameterSingleSelectCombo.EVENT_CLICK_ITEM="EVENT_CLICK_ITEM",ParameterSingleSelectCombo.EVENT_BLUR="EVENT_BLUR",ParameterSingleSelectCombo.EVENT_KEY_DOWN_ENTER="EVENT_KEY_DOWN_ENTER",ParameterSingleSelectCombo=ParameterSingleSelectCombo_1=__decorate$R([shortcut()],ParameterSingleSelectCombo);var __decorate$Q=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterComboNext_1;let ParameterComboNext=ParameterComboNext_1=function(e){function t(){var e;return _classCallCheck$1H(this,t),(e=_callSuper$1s(this,t,arguments)).props={baseCls:"".concat(ParameterComboNext_1.BASE_CLS," bi-border-radius"),$testId:"report-main-parameter-container-controller-combo",width:WIDTH,height:HEIGHT,watermark:"",value:"",fontSize:12,needSubmit:!1,disabled:!1,invisible:!1,allowBlank:!0,errorMsg:BI.i18nText("Fine-Report_Preview_Can_Not_Null"),controlAttr:{data:[],value:""},customData:!1,directEdit:!0,noRepeat:!0,autoMode:!0,mode:"remote",searchTime:200,widgetName:"",getDependenceByWidget:()=>[],getWidgetDependenceValueByWidget:()=>({}),add2WaitingQueue:()=>"",removeFromWaitingQueue:()=>{},name4Empty:"",sonHeight:24,maxCount:0,controlAttrFetcher:fetchParamControlAttr,extraOptsGetter:()=>({}),viewValueFetcher:fetchWidgetViewValue,allowBg:!0,needCheckCustomData:!0,maxPopupHeight:PopupMaxHeight,itemLimitCount:LimitCount},e.ratio=2,e}return _inherits$1s(t,AbstractParameterControllerWidget),_createClass$1H(t,[{key:"editComp",get:function(){return this.combo}},{key:"setName4Empty",value:function(e){var t;this.options.name4Empty=e,null===(t=this.combo)||void 0===t||t.updateName4Empty()}},{key:"render",value:function(){const{width:e,height:t,watermark:r,fontSize:n,widgetName:o,value:i,controlAttr:a,customData:s,directEdit:l,allowBlank:c,controlAttrFetcher:u,allowBg:d,maxPopupHeight:h,itemLimitCount:p}=this.options;return{type:ParameterSingleSelectCombo.xtype,cls:"".concat(setComboFontSize(ParameterComboNext_1.BASE_CLS,{fontSize:n,width:e,height:t})," ").concat(d?"bi-card":""),ref:e=>{this.combo=e},customData:s,allowEdit:l,allowNoSelect:c,maxPopupHeight:h,value:transformValue2ComboNextValue(i,transformControlAttrData(a.data)),controlDataGetter:()=>transformControlAttrData(this.options.controlAttr.data),name4EmptyGetter:()=>this.options.name4Empty,itemHeightGetter:()=>this.options.sonHeight,maxCountGetter:()=>this.options.maxCount,itemsCreator:(e,t)=>{this.cancelTokenSource&&this.cancelTokenSource.cancel(),this.cancelTokenSource=axios$1.CancelToken.source(),u(o,Object.assign(Object.assign({startIndex:p*(e.times-1),limitIndex:p},e.keyword?{filter:e.keyword}:{}),this.getRequestOpts()),this.cancelTokenSource.token).then((e=>{this.cancelTokenSource=null,this.options.controlAttr.data=(this.options.controlAttr.data||[]).concat(e),t({items:transformControlAttrData(e),hasNext:e.length>=p})})).catch((()=>{}))},width:e,height:t,watermark:r,listeners:[{eventName:ParameterSingleSelectCombo.EVENT_CONFIRM,action:()=>{const e=!this.silence&&this.fireEvent("stopedit"),t=!BI.isEqual(this.getValue(),this.valueBeforeEdit);!1!==e&&t&&this.fireEvent(ParameterComboNext_1.EVENT_CHANGE)}},{eventName:ParameterSingleSelectCombo.EVENT_BEFORE_EDIT,action:()=>{this.hideBubble(),this.valueBeforeEdit=BI.deepClone(this.getValue()),!this.silence&&this.fireEvent("beforeedit")}},{eventName:ParameterSingleSelectCombo.EVENT_AFTER_EDIT,action:()=>{!this.silence&&this.fireEvent("afteredit")}},{eventName:ParameterSingleSelectCombo.EVENT_CLICK_ITEM,action:()=>{this.hideBubble(),!this.silence&&this.fireEvent("click")}},{eventName:ParameterSingleSelectCombo.EVENT_KEY_DOWN_ENTER,action:e=>{s&&this.combo.selectItem(e)}}]}}},{key:"mounted",value:function(){_superPropGet$k(t,"mounted",this)([]);const{fontSize:e}=this.options;this.setPopupStyle({fontSize:"".concat(e,"px"),itemHeight:"".concat(e*this.ratio,"px")})}},{key:"preGetValidation",value:function(){const{errorMsg:e,value:t,allowBlank:r}=this.options;return this.options.customData||this.combo.validateData()?r||!BI.isEmpty(t)||BI.isNumber(t)||BI.isBoolean(t)?{result:!0}:{result:!1,errorMsg:e}:{result:!1,errorMsg:BI.i18nText("Fine-Report_Preview_Not_In_List")}}},{key:"postGetValidation",value:function(){const{allowBlank:e,errorMsg:t,customData:r,needCheckCustomData:n}=this.options,o="".concat(this.getValue())||"";return r||!n||this.combo.validateData()?e||BI.isNotEmptyString(o)?{result:!0}:{result:!1,errorMsg:t}:{result:!1,errorMsg:BI.i18nText("Fine-Report_Preview_Not_In_List")}}},{key:"postValidateAndToast",value:function(){const e=this.getValidation();return!!e.result||(this.showBubble(e.errorMsg),!1)}},{key:"emitManualStopEditEvent",value:function(){this.fireEvent("stopedit")}},{key:"getValue",value:function(){const e=this.combo.getValue();return BI.isNull(e)?"":e.value}},{key:"updateControllAttrByValue",value:async function(e,t){const{add2WaitingQueue:r,removeFromWaitingQueue:n,widgetName:o,customData:i,viewValueFetcher:a}=this.options;if(!t||BI.isEmptyArray(t)){const t=preTransformValue2ComboNextValue(e);if(BI.isNull(t))return t;const s=r(),l=await fetchParamViewValue(o,i,a,Object.assign({__text__:t},this.getRequestOpts()));return this.options.controlAttr=l?{data:(this.options.controlAttr.data||[]).concat([l]),value:t}:this.options.controlAttr,n(s),l}return this.options.controlAttr={data:(this.options.controlAttr.data||[]).concat(t),value:e},transformValue2ComboNextValue(e,t||[])}},{key:"setControllerValue",value:async function(e,t){this.combo.setValue(await this.updateControllAttrByValue(e,t))}},{key:"setValue",value:function(e,t){return this.setControllerValue(e,BI.isBoolean(t)?[]:t).then((()=>{this.fireEvent("EVENT_SET_VALUE"),!this.silence&&t&&this.fireEvent("afteredit")}))}},{key:"reset",value:function(){this.setControllerValue("",[])}},{key:"reloadControlAttr",value:function(){this.reset(),this.combo.setRepopulate(!0)}},{key:"setInteractValue",value:async function(e){this.combo.setRepopulate(!0),await this.setControllerValue(e.value,e.data)}},{key:"resize",value:function(e,r){const n=this.combo.getValue();_superPropGet$k(t,"resize",this)([e,r]),this.combo.setValue(n)}},{key:"getRequestOpts",value:function(){const{getWidgetDependenceValueByWidget:e,getDependenceByWidget:t,extraOptsGetter:r}=this.options,n=e(this);return Object.assign({dependence:n,reload:BI.isNotEmptyArray(t(this))},r())}},{key:"getText",value:function(){var e;return null===(e=this.combo.getValue())||void 0===e?void 0:e.text}},{key:"getAdapter",value:function(){return this.combo.getAdapter()}},{key:"setStyle",value:function(e){this.combo.element.addClass(setComboStyle(ParameterComboNext_1.BASE_CLS,e))}},{key:"setPopupStyle",value:function(e){this.options.sonHeight=parseInt(e.itemHeight,10),this.combo.element.addClass(setComboPopupStyle(ParameterComboNext_1.BASE_CLS,e))}},{key:"setWaterMark",value:function(e){this.options.watermark=e,this.combo.setWaterMark(e)}},{key:"focus",value:function(){this.combo.focus()}},{key:"blur",value:function(){this.combo.blur()}}])}();ParameterComboNext.EVENT_CHANGE="EVENT_CHANGE",ParameterComboNext.xtype="report.main.parameter_container.controller_next.combo",ParameterComboNext.widgetType="combo",ParameterComboNext.BASE_CLS="report-main-parameter-container-controller-combo",ParameterComboNext=ParameterComboNext_1=__decorate$Q([shortcut()],ParameterComboNext);const MAX_DATE$1="2999-12-31",MIN_DATE$1="1900-01-01";function _classCallCheck$1G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1F(n.key),n)}}function _createClass$1G(e,t,r){return t&&_defineProperties$1F(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1F(e){var t=_toPrimitive$1F(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1F(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1r(e,t,r){return t=_getPrototypeOf$1r(t),_possibleConstructorReturn$1r(e,_isNativeReflectConstruct$1r()?Reflect.construct(t,r||[],_getPrototypeOf$1r(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1r(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1r(e)}function _assertThisInitialized$1r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1r(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1r=function(){return!!e})()}function _getPrototypeOf$1r(e){return(_getPrototypeOf$1r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1r(e,t)}function _setPrototypeOf$1r(e,t){return(_setPrototypeOf$1r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __decorate$P=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ParameterDatetimeModel=function(e){function t(){var e;return _classCallCheck$1G(this,t),(e=_callSuper$1r(this,t,arguments)).computed={validOperationCount:()=>e.model.operationCount>0},e.actions={setValue:t=>{e.model.value=t},setValid:t=>{e.model.valid=!!t},operationCountUp:()=>{e.model.operationCount++}},e}return _inherits$1r(t,Model),_createClass$1G(t,[{key:"state",value:function(){return{value:this.options.value,valid:!0,operationCount:0}}}])}();function parseDateTime(e,t){if(e){if(BI.isDate(e))return{date:new Date,isLegal:!0};if(BI.isString(e)||BI.isNumber(e)||BI.isArray(e)){const r=replaceDateStr("".concat(e));return needFormat(r)?t&&checkDateValid(r,t)?{date:BI.parseDateTime("".concat(r.replaceAll("-",(()=>"/"))),t.replaceAll("-",(()=>"/"))),isLegal:!0}:{date:new Date,isLegal:!1}:{date:BI.parseDateTime(r,"%Y-%X-%d %H:%M:%S %p"),isLegal:!0}}return{date:new Date("date_milliseconds"in e?e.date_milliseconds:e.__time__),isLegal:!0}}return{date:new Date,isLegal:!1}}function transformFormat$1(e){return e.replace(/yyyy/g,"%Y").replace(/MM/g,"%X").replace(/dd/g,"%d").replace(/M/g,"%x").replace(/^d/g,"%e").replace(/.d/g,(e=>"%"===e[0]?e:"".concat(e[0],"%e"))).replace(/yy/g,"%y").replace(/HH/g,"%H").replace(/mm/g,"%M").replace(/ss/g,"%S").replace(/hh/g,"%I").replace(/a/g,"%P").replace(/h/g,"%l").replace(/^H/g,"%k").replace(/.H/g,(e=>"%"===e[0]?e:"".concat(e[0],"%k")))}function format2Regex(e){let t=e;return new Map([["%Y","(?!0000)[0-9]{4}"],["%X","0[1-9]|1[0-2]"],["%d","0[1-9]|1[0-9]|2[0-9]|3[0-1]"],["%x","0?[1-9]|1[0-2]"],["%e","0?[1-9]|1[0-9]|2[0-9]|3[0-1]"],["%y","[0-9]{2}"],["%H","[01][0-9]|2[0-3]"],["%M","[0-5][0-9]"],["%S","[0-5][0-9]"],["%I","0[0-9]|1[0-2]"],["%P","am|pm"],["%l","[1-9]|1[0-2]"],["%k","2[0-3]|[0-1]?[0-9]"]]).forEach(((e,r)=>{t=t.replaceAll(r,(()=>"(".concat(e,")")))})),"^".concat(t,"$")}function checkDateValid(e,t){const r=format2Regex(t);return new RegExp(r).test(e)}function getFormatType$1(e){const t=transformFormat$1(e);return{isDateFormat:/%d|%e/g.test(t),isTimeFormat:/%H|%M|%S|%I|%l|%k/.test(t),isYearFormat:/%Y/.test(t)&&!/%[^Y]/.test(t)}}function needFormat(e){return!["yyyy/M/d","yyyy-M-d","yyyy/MM/dd","yyyy-MM-dd","yyyy/MM/dd HH:mm:ss","yyyy-MM-dd HH:mm:ss","yyyy/MM/dd HH:mm:ss a","yyyy-MM-dd HH:mm:ss a"].some((t=>new RegExp(format2Regex(transformFormat$1(t))).test(e)))}function replaceDateStr(e){let t=e;return[["上午","am"],["下午","pm"]].forEach((e=>{t=t.replaceAll(e[0],(()=>e[1]))})),t}function _classCallCheck$1F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1E(n.key),n)}}function _createClass$1F(e,t,r){return t&&_defineProperties$1E(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1E(e){var t=_toPrimitive$1E(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1E(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}ParameterDatetimeModel.xtype="report.model.main.parameter_container.controller.datetime",ParameterDatetimeModel=__decorate$P([model()],ParameterDatetimeModel);let ReportDate=_createClass$1F((function e(t,r){if(_classCallCheck$1F(this,e),this.isLegal=!1,this.isDateFormat=!0,this.isTimeFormat=!0,this.isYearFormat=!0,this.format=transformFormat$1(r||""),this.format){const{isDateFormat:e,isTimeFormat:t,isYearFormat:r}=getFormatType$1(this.format);this.isDateFormat=e,this.isTimeFormat=t,this.isYearFormat=r}const{date:n,isLegal:o}=this.formatDate(t);this.date=n,this.isLegal=o}),[{key:"getTime",value:function(){return this.date.getTime()}},{key:"toString",value:function(e=""){return BI.print(this.date,transformFormat$1(e))}},{key:"getValue",value:function(){return this.date}},{key:"toJSON",value:function(){return{year:this.date.getFullYear(),month:this.date.getMonth()+1,day:this.date.getDate(),hour:this.date.getHours(),minute:this.date.getMinutes(),second:this.date.getSeconds()}}},{key:"setFullYear",value:function(e){return this.date.setFullYear(e),this}},{key:"setMonth",value:function(e){return this.date.setMonth(e-1),this}},{key:"setDay",value:function(e){return this.date.setDate(e),this}},{key:"setHours",value:function(e){return this.date.setHours(e),this}},{key:"setMinutes",value:function(e){return this.date.setMinutes(e),this}},{key:"setSeconds",value:function(e){return this.date.setSeconds(e),this}},{key:"formatDate",value:function(e){return parseDateTime(e,this.format)}}]);function _classCallCheck$1E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1D(n.key),n)}}function _createClass$1E(e,t,r){return t&&_defineProperties$1D(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1D(e){var t=_toPrimitive$1D(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1D(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1q(e,t,r){return t=_getPrototypeOf$1q(t),_possibleConstructorReturn$1q(e,_isNativeReflectConstruct$1q()?Reflect.construct(t,r||[],_getPrototypeOf$1q(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1q(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1q(e)}function _assertThisInitialized$1q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1q(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1q=function(){return!!e})()}function _getPrototypeOf$1q(e){return(_getPrototypeOf$1q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1q(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1q(e,t)}function _setPrototypeOf$1q(e,t){return(_setPrototypeOf$1q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __decorate$O=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};const constants$1={hgap:4,vgap:2,compareFormat:"%Y-%X"};let YearMonthTrigger=function(e){function t(){var e;return _classCallCheck$1E(this,t),(e=_callSuper$1q(this,t,arguments)).props={extraCls:"bi-year-month-trigger",min:MIN_DATE$1,max:MAX_DATE$1,height:24,format:"",allowEdit:!0},e}return _inherits$1q(t,BI.Trigger),_createClass$1E(t,[{key:"render",value:function(){const{height:e,allowEdit:t,watermark:r}=this.options,{hgap:n,vgap:o}=constants$1;return this.storeTriggerValue="",{type:BI.AbsoluteLayout.xtype,items:[{el:{type:BI.SignEditor.xtype,height:e,validationChecker:e=>{const t=this.getStandardDateStr(e),r=t.match(/\d+/g);return this.dateCheck(t)&&BI.checkDateLegal(t)&&this.checkVoid({year:0|(r?r[0]:void 0),month:0|(r?r[1]:void 0)})},quitChecker:()=>!1,ref:e=>{this.editor=e},hgap:n,vgap:o,allowBlank:!0,watermark:BI.isKey(r)?r:BI.i18nText("BI-Basic_Unrestricted"),title:BI.bind(this.getFormattedTitle,this),listeners:[{eventName:"EVENT_KEY_DOWN",action:()=>{this.fireEvent("EVENT_KEY_DOWN",arguments)}},{eventName:"EVENT_FOCUS",action:()=>{this.storeTriggerValue=this.getKey(),this.fireEvent("EVENT_FOCUS")}},{eventName:"EVENT_BLUR",action:()=>{this.fireEvent("EVENT_BLUR")}},{eventName:"EVENT_STOP",action:()=>{this.fireEvent("EVENT_STOP")}},{eventName:"EVENT_VALID",action:()=>{this.fireEvent("EVENT_VALID")}},{eventName:"EVENT_ERROR",action:()=>{this.fireEvent("EVENT_ERROR")}},{eventName:"EVENT_CONFIRM",action:()=>{const e=this.editor.getValue();if(BI.isNotNull(e)&&this.editor.setState(e),BI.isNotEmptyString(e)&&!BI.isEqual(this.storeTriggerValue,this.getKey())){const t=this.getStandardDateStr(e).match(/\d+/g);this.storeValue={type:BI.DynamicDateCombo.Static,value:{year:0|(t?t[0]:void 0),month:0|(t?t[1]:void 0)}}}this.fireEvent("EVENT_CONFIRM")}},{eventName:"EVENT_START",action:()=>{this.fireEvent("EVENT_START")}},{eventName:"EVENT_CHANGE",action:()=>{this.fireEvent("EVENT_CHANGE")}}]},left:0,right:24,top:0,bottom:0},{el:{type:BI.Layout.xtype},width:24,right:24,top:0,bottom:0},{el:{type:BI.Text.xtype,invisible:t,cls:"show-text",title:BI.bind(this.getFormattedTitle,this),hgap:4},left:0,right:24,top:0,bottom:0}]}}},{key:"mounted",value:function(){this.setValue(this.options.value)}},{key:"getFormattedTitle",value:function(){const{type:e=BI.DynamicDateCombo.Static,value:t}=this.storeValue||{type:void 0,value:void 0};switch(e){case BI.DynamicDateCombo.Dynamic:const e=this.getDisplayText(t),r=BI.print(BI.DynamicDateHelper.getCalculation(t),this.getFormatString());return BI.isEmptyString(e)?r:"".concat(e,":").concat(r);case BI.DynamicDateCombo.Static:default:return BI.isNull(t)||BI.isNull(t.year)||BI.isNull(t.month)?"":BI.print(BI.getDate(t.year,t.month-1,1),this.getFormatString())}}},{key:"getStandardDateStr",value:function(e){let t=e;const{compareFormat:r}=constants$1;let n=[0,1];const o=this.getFormatString().match(/%./g);BI.each(o||[],((e,t)=>{switch(t){case"%Y":case"%y":n[0]=e;break;case"%X":case"%x":n[1]=e}}));const i=BI.parseDateTime(t,this.getFormatString());BI.print(i,this.getFormatString())===t&&(t=BI.print(i,r),n=[0,1,2]);const a=t.match(/\d+/g)||[],s=[];return BI.each(a,(e=>{s[e]=a[n[e]]})),s.length===n.length&&2===s[0].length?BI.print(BI.parseDateTime(s.join("-"),r),r):s.join("-")}},{key:"getFormatString",value:function(){return this.options.format||constants$1.compareFormat}},{key:"dateCheck",value:function(e){return BI.print(BI.parseDateTime(e,"%Y-%x"),"%Y-%x")===e||BI.print(BI.parseDateTime(e,"%Y-%X"),"%Y-%X")===e||BI.print(BI.parseDateTime(e,"%Y-%x"),"%Y-%x")===e||BI.print(BI.parseDateTime(e,"%Y-%X"),"%Y-%X")===e}},{key:"checkVoid",value:function(e){return!BI.checkDateVoid(e.year,e.month,1,this.options.min,this.options.max)[0]}},{key:"setInnerValue",value:function(e){const t=BI.print(e,this.getFormatString());this.editor.setState(t),this.editor.setValue(t)}},{key:"getDisplayText",value:function(e){let t="";return BI.isNull(e)||(BI.isNotNull(e.year)&&0!==BI.parseInt(e.year)&&(t+="".concat(Math.abs(e.year)).concat(BI.i18nText("BI-Basic_Year")).concat(e.year<0?BI.i18nText("BI-Basic_Front"):BI.i18nText("BI-Basic_Behind"))),BI.isNotNull(e.month)&&0!==BI.parseInt(e.month)&&(t+="".concat(Math.abs(e.month)).concat(BI.i18nText("BI-Basic_Month")).concat(e.month<0?BI.i18nText("BI-Basic_Front"):BI.i18nText("BI-Basic_Behind")))),t}},{key:"setValue",value:function(e){let t,r=0,n=BI.getDate();switch(this.storeValue=e,BI.isNotNull(e)&&(r=e.type||BI.DynamicDateCombo.Static,t=e.value),r){case BI.DynamicDateCombo.Dynamic:n=BI.DynamicDateHelper.getCalculation(t),this.setInnerValue(n);break;case BI.DynamicDateCombo.Static:default:if(BI.isNull(t)||BI.isNull(t.year)||BI.isNull(t.month))this.editor.setState(""),this.editor.setValue("");else{const e=BI.print(BI.getDate(t.year,t.month-1,1),this.getFormatString());this.editor.setState(e),this.editor.setValue(e)}}}},{key:"setMinDate",value:function(e){BI.isNotEmptyString(this.options.min)&&(this.options.min=e)}},{key:"setMaxDate",value:function(e){BI.isNotEmptyString(this.options.max)&&(this.options.max=e)}},{key:"getKey",value:function(){return this.editor.getValue()}},{key:"getValue",value:function(){return this.storeValue}},{key:"focus",value:function(){this.editor.focus()}},{key:"blur",value:function(){this.editor.blur()}},{key:"setWaterMark",value:function(e){this.editor.setWaterMark(e)}}])}();function _classCallCheck$1D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1C(n.key),n)}}function _createClass$1D(e,t,r){return t&&_defineProperties$1C(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1C(e){var t=_toPrimitive$1C(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1C(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1p(e,t,r){return t=_getPrototypeOf$1p(t),_possibleConstructorReturn$1p(e,_isNativeReflectConstruct$1p()?Reflect.construct(t,r||[],_getPrototypeOf$1p(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1p(e)}function _assertThisInitialized$1p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1p(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1p=function(){return!!e})()}function _getPrototypeOf$1p(e){return(_getPrototypeOf$1p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1p(e,t)}function _setPrototypeOf$1p(e,t){return(_setPrototypeOf$1p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}YearMonthTrigger.xtype="report.components.dynamic_year_month_trigger",YearMonthTrigger=__decorate$O([shortcut()],YearMonthTrigger);var __decorate$N=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};const constants={popupHeight:259,popupWidth:270,comboAdjustHeight:1,border:1};let YearMonthCombo=function(e){function t(){var e;return _classCallCheck$1D(this,t),(e=_callSuper$1p(this,t,arguments)).props={baseCls:"bi-dynamic-year-month-combo",width:80,height:21,minDate:MIN_DATE$1,maxDate:MAX_DATE$1,format:"",allowEdit:!0,isNeedAdjustWidth:!0},e}return _inherits$1p(t,BI.Single),_createClass$1D(t,[{key:"render",value:function(){const{width:e,height:t,container:r,value:n,minDate:o,maxDate:i,format:a,allowEdit:s,behaviors:l,watermark:c,isNeedAdjustWidth:u}=this.options,{comboAdjustHeight:d}=constants;this.storeTriggerValue="";const h=BI.getDate();this.storeValue=n;const p=t;return{type:BI.HTapeLayout.xtype,width:e,height:p,cls:"bi-focus-shadow",items:[{el:{type:BI.IconButton.xtype,cls:"bi-trigger-icon-button date-change-h-font",width:p,height:p,ref:e=>{this.changeIcon=e}},width:p},{type:BI.AbsoluteLayout.xtype,items:[{el:{type:BI.IconButton.xtype,cls:"bi-trigger-icon-button date-font",width:p,height:p,ref:e=>{this.triggerBtn=e}},top:0,right:0},{el:{type:BI.Combo.xtype,cls:"bi-border bi-border-radius",destroyWhenHide:!0,container:r,ref:e=>{this.combo=e},toggle:!1,isNeedAdjustHeight:!1,isNeedAdjustWidth:u,el:{type:YearMonthTrigger.xtype,min:o,max:i,watermark:c,format:a,allowEdit:s,height:p-2,value:n,ref:e=>{this.trigger=e},listeners:[{eventName:"EVENT_KEY_DOWN",action:()=>{this.combo.isViewVisible()&&this.combo.hideView(),this.fireEvent("EVENT_KEY_DOWN",arguments)}},{eventName:"EVENT_STOP",action:()=>{this.combo.isViewVisible()||this.combo.showView()}},{eventName:"EVENT_FOCUS",action:()=>{this.storeTriggerValue=this.trigger.getKey(),this.combo.isViewVisible()||this.combo.showView(),this.fireEvent("EVENT_FOCUS")}},{eventName:"EVENT_BLUR",action:()=>{this.fireEvent("EVENT_BLUR")}},{eventName:"EVENT_ERROR",action:()=>{this.storeValue={type:BI.DynamicDateCombo.Static,value:{year:h.getFullYear(),month:h.getMonth()+1}},this.fireEvent("EVENT_ERROR")}},{eventName:"EVENT_VALID",action:()=>{this.fireEvent("EVENT_VALID")}},{eventName:"EVENT_CHANGE",action:()=>{this.fireEvent("EVENT_CHANGE")}},{eventName:"EVENT_CONFIRM",action:()=>{if(this.combo.isViewVisible())return;const e=this.storeTriggerValue,t=this.trigger.getKey();BI.isNotEmptyString(t)&&!BI.isEqual(t,e)?(this.storeValue=this.trigger.getValue(),this.setValue(this.trigger.getValue())):BI.isEmptyString(t)&&(this.storeValue=void 0,this.trigger.setValue()),this.checkDynamicValue(this.storeValue),this.fireEvent("EVENT_CONFIRM")}}]},adjustLength:d,popup:{el:{type:BI.DynamicYearMonthPopup.xtype,width:u?e:void 0,behaviors:l,supportDynamic:this.options.supportDynamic,min:o,max:i,ref:e=>{this.popup=e},listeners:[{eventName:"EVENT_CHANGE",action:()=>{this.setValue(this.popup.getValue()),this.combo.hideView(),this.fireEvent("EVENT_CONFIRM")}},{eventName:"BUTTON_CLEAR_EVENT_CHANGE",action:()=>{this.setValue(),this.combo.hideView(),this.fireEvent("EVENT_CONFIRM")}},{eventName:"BUTTON_lABEL_EVENT_CHANGE",action:()=>{const e=BI.getDate();this.setValue({type:BI.DynamicDateCombo.Static,value:{year:e.getFullYear(),month:e.getMonth()+1}}),this.combo.hideView(),this.fireEvent("EVENT_CONFIRM")}},{eventName:"BUTTON_OK_EVENT_CHANGE",action:()=>{this.setValue(this.popup.getValue()),this.combo.hideView(),this.fireEvent("EVENT_CONFIRM")}}]},value:n,stopPropagation:!1},hideChecker:e=>0===this.triggerBtn.element.find(e.target).length,listeners:[{eventName:BI.Combo.EVENT_BEFORE_POPUPVIEW,action:()=>{this.combo.isViewVisible()||(this.popup.setMinDate(this.options.minDate),this.popup.setMaxDate(this.options.maxDate),this.popup.setValue(this.storeValue),this.fireEvent("EVENT_BEFORE_POPUPVIEW"))}}]},top:0,left:0,right:0,bottom:0}]}],ref:e=>{this.comboWrapper=e}}}},{key:"mounted",value:function(){this.checkDynamicValue(this.storeValue)}},{key:"checkDynamicValue",value:function(e){const t=this.options;let r;if(BI.isNotNull(e)&&(r=e.type),r===BI.DynamicDateCombo.Dynamic)this.changeIcon.setVisible(!0),this.comboWrapper.attr("items")[0].width=t.height,this.comboWrapper.resize();else this.comboWrapper.attr("items")[0].width=0,this.comboWrapper.resize(),this.changeIcon.setVisible(!1)}},{key:"setMinDate",value:function(e){this.options.minDate=e,this.trigger.setMinDate(e),this.popup&&this.popup.setMinDate(e)}},{key:"setMaxDate",value:function(e){this.options.maxDate=e,this.trigger.setMaxDate(e),this.popup&&this.popup.setMaxDate(e)}},{key:"setValue",value:function(e){this.storeValue=e,this.trigger.setValue(e),this.checkDynamicValue(e)}},{key:"getValue",value:function(){return this.storeValue}},{key:"getKey",value:function(){return this.trigger.getKey()}},{key:"hidePopupView",value:function(){this.combo.hideView()}},{key:"focus",value:function(){this.trigger.focus()}},{key:"blur",value:function(){this.trigger.blur()}},{key:"setWaterMark",value:function(e){this.trigger.setWaterMark(e)}}])}();function transformDateValue2DateMs(e){if(e.type===BI.DynamicDateCombo.Dynamic)return BI.DynamicDateHelper.getCalculation(e.value).getTime();const{year:t,month:r=1,day:n=1,hour:o=0,minute:i=0,second:a=0}=e.value;return BI.getDate(t,r-1,n,o,i,a).getTime()}function getControlTypeByFormat(e){const{isDateFormat:t,isTimeFormat:r,isYearFormat:n}=getFormatType$1(e);return n?BI.DynamicYearCombo.xtype:r?t?BI.DynamicDateTimeCombo.xtype:BI.TimeCombo.xtype:t?BI.DynamicDateCombo.xtype:YearMonthCombo.xtype}function getDateRangeByFormat(e,t,r){let n,o;const{isDateFormat:i,isTimeFormat:a,isYearFormat:s}=getFormatType$1(r),l=new ReportDate(e,r),c=new ReportDate(t,r);if(s)l.isLegal&&(n="".concat(l.toString("yyyy"),"-01-01")),c.isLegal&&(o="".concat(c.toString("yyyy"),"-12-31"));else if(a||i)a&&i?(l.isLegal&&(n="".concat(l.toString("yyyy-MM-dd")," 00:00:00")),c.isLegal&&(o="".concat(c.toString("yyyy-MM-dd")," 24:00:00"))):a&&!i||(l.isLegal&&(n=l.toString("yyyy-MM-dd")),c.isLegal&&(o=c.toString("yyyy-MM-dd")));else if(l.isLegal&&(n="".concat(l.toString("yyyy-MM"),"-01")),c.isLegal){const e=c.getValue().getMonth();o="".concat(c.toString("yyyy-MM"),"-").concat(BI.getMonthDays(c.getValue(),e))}return{minDate:n,maxDate:o}}function transformDateMs2String(e,t){return BI.isNumber(e)?new ReportDate({date_milliseconds:e}).toString(t):new ReportDate(e).toString(t)}function transformTimeValue2DateMs(e,t){const{hour:r,minute:n,second:o}=e;return t.setHours(r).setMinutes(n).setSeconds(o).getTime()}function setDatetimeComboFontSize(e,t){const r="".concat(e,"-").concat(BI.UUID()),n=".".concat(r," .bi-combo"),{fontSize:o,width:i,height:a}=t,s="".concat(24*(o/12),"px !important");return index.use(jssGlobal(),jssNested()),index.createStyleSheet({"@global":{[".".concat(r," .bi-trigger-icon-button.bi-icon-button")]:{width:s,"font-size":"".concat(Math.min(o*(16/12),i,a),"px")},["".concat(n," > div > .bi-trigger")]:{"font-size":"".concat(o,"px")},["".concat(n," > .bi-year-month-trigger, ").concat(n," > .bi-year-trigger")]:{"font-size":"".concat(o,"px")}}}).attach(),r}function isLegal(e,t,r,n){if(!e.isLegal)return!1;const o=new ReportDate(e.toString(t),t),i=new ReportDate(r,t),a=new ReportDate(n,t);return r&&i.isLegal&&new ReportDate(r,t).getTime()>o.getTime()?(BI.Msg.toast(BI.i18nText("Fine-Report_Value_Less_Than",r)),!1):!(n&&a.isLegal&&new ReportDate(n,t).getTime()<o.getTime())||(BI.Msg.toast(BI.i18nText("Fine-Report_Value_More_Than",n)),!1)}function transform2DateComboValue$1(e,t,r,n){const{minDate:o,maxDate:i}=getDateRangeByFormat(r,n,t);if(!isLegal(e,t,o,i))return;const a=!e.isDateFormat&&e.isTimeFormat,s=e.toJSON();return a?{hour:s.hour,minute:s.minute,second:s.second}:{type:1,value:s}}function setDatetimeComboStyle(e,{opacity:t,background:r,color:n,border:o,"border-radius":i}){index.use(jssGlobal(),jssNested());const a="".concat(e,"-").concat(BI.UUID()),s=".".concat(a);return index.createStyleSheet({"@global":{["".concat(s)]:{opacity:t,background:r},["".concat(s," .bi-card")]:{background:r,color:n},["".concat(s," .bi-text")]:{color:n},["".concat(s," .bi-icon-button")]:{color:n},["".concat(s," .bi-border")]:{border:o,"border-radius":i}}}).attach(),a}function setDatetimeComboPopupStyle(e,{itemHeight:t,fontSize:r}){index.use(jssGlobal(),jssNested());const n="".concat(e,"-").concat(BI.UUID()),o=".".concat(n);return index.createStyleSheet({"@global":{["".concat(o," .bi-calendar .bi-grid")]:{height:"".concat(parseInt(t,10)/24*44,"px !important")},["".concat(o," .bi-calendar .bi-grid .bi-label")]:{"line-height":"".concat(t," !important"),"font-size":"".concat(r," !important")},["".concat(o," .bi-calendar .bi-t .bi-abs")]:{height:"".concat(t," !important")},["".concat(o," .bi-calendar .bi-t .bi-abs >.bi-basic-button")]:{height:"".concat(t," !important")},["".concat(o," .bi-calendar .bi-t .bi-abs .bi-text")]:{"font-size":"".concat(r," !important")}}}).attach(),n}function _classCallCheck$1C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1B(n.key),n)}}function _createClass$1C(e,t,r){return t&&_defineProperties$1B(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1B(e){var t=_toPrimitive$1B(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1B(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1o(e,t,r){return t=_getPrototypeOf$1o(t),_possibleConstructorReturn$1o(e,_isNativeReflectConstruct$1o()?Reflect.construct(t,r||[],_getPrototypeOf$1o(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1o(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1o(e)}function _assertThisInitialized$1o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1o(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1o=function(){return!!e})()}function _superPropGet$j(e,t,r,n){var o=_get$j(_getPrototypeOf$1o(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$j(){return _get$j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$j(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$j.apply(null,arguments)}function _superPropBase$j(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1o(e)););return e}function _getPrototypeOf$1o(e){return(_getPrototypeOf$1o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1o(e,t)}function _setPrototypeOf$1o(e,t){return(_setPrototypeOf$1o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}YearMonthCombo.xtype="report.components.dynamic_year_month_combo",YearMonthCombo=__decorate$N([shortcut()],YearMonthCombo);var __decorate$M=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterDatetime_1;let ParameterDatetime=ParameterDatetime_1=function(e){function t(){var e;return _classCallCheck$1C(this,t),(e=_callSuper$1o(this,t,arguments)).props={baseCls:ParameterDatetime_1.BASE_CLS,$testId:ParameterDatetime_1.BASE_CLS,widgetName:"",width:WIDTH,height:HEIGHT,format:"yyyy-MM-dd",startDate:MIN_DATE$1,endDate:MAX_DATE$1,returnDate:!1,value:{date_milliseconds:0},directEdit:!0,disabled:!1,invisible:!1,needSubmit:!0,fontSize:12,allowBlank:!0,errorMsg:BI.i18nText("Fine-Report_Preview_Can_Not_Null"),watermark:" ",getDependenceByWidget:()=>[],getWidgetDependenceValueByWidget:()=>({}),controlAttrFetcher:fetchParamDatetimeControlAttr,extraOptsGetter:()=>({}),allowBg:!0,container:void 0,isNeedAdjustWidth:!0},e}return _inherits$1o(t,AbstractParameterControllerWidget),_createClass$1C(t,[{key:"render",value:function(){const{width:e,height:t,value:r,startDate:n,endDate:o,fontSize:i,format:a,directEdit:s,watermark:l,allowBg:c,container:u}=this.options,d=new ReportDate(r,a),h=transform2DateComboValue$1(d,a,n,o);return this.store.setValue(h),this.reportDate=d,{type:BI.VerticalLayout.xtype,cls:c?"bi-card":"",items:[Object.assign(Object.assign({width:e,height:t,watermark:l,type:getControlTypeByFormat(a),supportDynamic:!1,cls:"".concat(setDatetimeComboFontSize(ParameterDatetime_1.BASE_CLS,{fontSize:i,width:e,height:t}))},getDateRangeByFormat(n,o,a)),{format:transformFormat$1(a),isNeedAdjustWidth:!1,value:h,ref:e=>{this.combo=e,this.btn=e.element[0]},behaviors:{highlight:()=>!1},allowEdit:s,container:u,listeners:[{eventName:"EVENT_CONFIRM",action:()=>{this.hideBubble(),this.store.setValue(this.combo.getValue()),this.store.setValid(!0);!1!==(!this.silence&&this.fireEvent("stopedit"))&&this.fireEvent(ParameterDatetime_1.EVENT_CHANGE)}},{eventName:"EVENT_VALID",action:()=>{this.store.setValue(this.combo.getValue()),this.store.setValid(!0),!this.silence&&this.model.validOperationCount&&this.fireEvent("afteredit"),this.store.operationCountUp()}},{eventName:"EVENT_ERROR",action:()=>{this.store.setValid(!1),!this.silence&&this.model.validOperationCount&&this.fireEvent("afteredit"),this.store.operationCountUp()}},{eventName:"EVENT_FOCUS",action:()=>{this.hideBubble()}},{eventName:"EVENT_KEY_DOWN",action:()=>{!this.silence&&this.fireEvent("afteredit")}},{eventName:"EVENT_BLUR",action:()=>{this.store.setValue(this.combo.getValue())}}]})]}}},{key:"getValue",value:function(){const{format:e,returnDate:t}=this.options,r=this.model.value;if(""===this.model.value||BI.isNull(this.model.value))return"";if(BI.isString(this.model.value)||BI.isNumber(this.model.value))return t?{__time__:BI.getDate(this.model.value).getTime()}:this.model.value;if(BI.has(this.model.value,"date_milliseconds"))return t?{__time__:this.model.value.date_milliseconds}:transformDateMs2String(this.model.value.date_milliseconds,e);const n=transformDateMs2String(!this.reportDate.isDateFormat&&this.reportDate.isTimeFormat&&!this.reportDate.isYearFormat?transformTimeValue2DateMs(r,this.reportDate):transformDateValue2DateMs(r),e);return t?{__time__:new ReportDate(n,e).getTime()}:n}},{key:"preGetValidation",value:function(){const{allowBlank:e,value:t,errorMsg:r}=this.options;return e||!BI.isEmpty(t)?{result:!0}:{result:!1,errorMsg:r}}},{key:"postGetValidation",value:function(){const{allowBlank:e,errorMsg:t}=this.options,r=this.model.value;return BI.isNull(r)||BI.isEmptyString(r)?!0==!!e?{result:!0}:{result:!1,errorMsg:t}:this.model.valid?{result:!0}:{result:!1,errorMsg:BI.i18nText("Fine-Report_Preview_Input_Error")}}},{key:"postValidateAndToast",value:function(){const e=this.getValidation();return!!e.result||(this.showBubble(e.errorMsg),!1)}},{key:"emitManualStopEditEvent",value:function(){this.fireEvent("stopedit")}},{key:"setControllerValue",value:async function(e){const{startDate:t,endDate:r,format:n}=this.options,o=BI.isDate(e)?{date_milliseconds:e.getTime()}:e,i=transform2DateComboValue$1(new ReportDate(o,n),n,t,r);this.store.setValue(i),this.combo.setValue(i)}},{key:"setInteractValue",value:async function(e){this.reset();const{widgetName:t,getWidgetDependenceValueByWidget:r,getDependenceByWidget:n,extraOptsGetter:o,controlAttrFetcher:i}=this.options,a=r(this);if(BI.size(Object.keys(a))){const r=await i(t,Object.assign({dependence:a,reload:BI.isNotEmptyArray(n(this))},o())),{startDate:s,endDate:l}=BI.first(r);return this.setMaxAndMinDate({min:s,max:l}),this.setControllerValue("".concat(e))}}},{key:"reset",value:function(){this.combo.setValue()}},{key:"resize",value:function(e,r){const n=this.combo.getValue(),{startDate:o=MIN_DATE$1,endDate:i=MAX_DATE$1}=this.options;this.setMaxAndMinDate({min:MIN_DATE$1,max:MAX_DATE$1}),_superPropGet$j(t,"resize",this)([e,r]),this.store.setValue(n),this.combo.setValue(n),this.setMaxAndMinDate({min:o,max:i})}},{key:"getAdapter",value:function(){return this.combo}},{key:"setStyle",value:function(e){this.combo.element.addClass(setDatetimeComboStyle(ParameterDatetime_1.BASE_CLS,e))}},{key:"setPopupStyle",value:function(e){this.combo.element.addClass(setDatetimeComboPopupStyle(ParameterDatetime_1.BASE_CLS,e))}},{key:"setWaterMark",value:function(e){this.options.watermark=e,this.combo.setWaterMark(e)}},{key:"setMaxAndMinDate",value:function({max:e,min:t}){const{format:r}=this.options,{minDate:n,maxDate:o}=getDateRangeByFormat(t,e,r);this.combo.setMinDate&&this.combo.setMinDate(this.options.startDate=n||MIN_DATE$1),this.combo.setMaxDate&&this.combo.setMaxDate(this.options.endDate=o||MAX_DATE$1)}},{key:"getText",value:function(){const e=this.getValue();return BI.isNull(e)?"":BI.isNumber(e)?"".concat(e):BI.isString(e)?e:new Date(e.__time__).toString()}},{key:"focus",value:function(){this.combo.focus()}},{key:"blur",value:function(){this.combo.blur()}}])}();function _classCallCheck$1B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1A(n.key),n)}}function _createClass$1B(e,t,r){return t&&_defineProperties$1A(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1A(e){var t=_toPrimitive$1A(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1A(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1n(e,t,r){return t=_getPrototypeOf$1n(t),_possibleConstructorReturn$1n(e,_isNativeReflectConstruct$1n()?Reflect.construct(t,r||[],_getPrototypeOf$1n(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1n(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1n(e)}function _assertThisInitialized$1n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1n(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1n=function(){return!!e})()}function _getPrototypeOf$1n(e){return(_getPrototypeOf$1n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1n(e,t)}function _setPrototypeOf$1n(e,t){return(_setPrototypeOf$1n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterDatetime.EVENT_CHANGE="EVENT_CHANGE",ParameterDatetime.xtype="report.main.parameter_container.controller.datetime",ParameterDatetime.widgetType="datetime",ParameterDatetime.BASE_CLS="report-main-parameter-container-controller-datetime",ParameterDatetime=ParameterDatetime_1=__decorate$M([shortcut(),store$1(ParameterDatetimeModel,{props(){return{value:this.options.value}}})],ParameterDatetime);var __decorate$L=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ParameterEmpty=function(e){function t(){return _classCallCheck$1B(this,t),_callSuper$1n(this,t,arguments)}return _inherits$1n(t,AbstractParameterControllerWidget),_createClass$1B(t,[{key:"preGetValidation",value:function(){return{result:!0}}},{key:"postGetValidation",value:function(){return{result:!0}}},{key:"postValidateAndToast",value:function(){return!0}},{key:"reset",value:function(){}},{key:"setInteractValue",value:function(){}},{key:"setControllerValue",value:async function(){}},{key:"getValue",value:function(){return""}},{key:"setStyle",value:function(){}}])}();function _classCallCheck$1A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1z(n.key),n)}}function _createClass$1A(e,t,r){return t&&_defineProperties$1z(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1z(e){var t=_toPrimitive$1z(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1z(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1m(e,t,r){return t=_getPrototypeOf$1m(t),_possibleConstructorReturn$1m(e,_isNativeReflectConstruct$1m()?Reflect.construct(t,r||[],_getPrototypeOf$1m(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1m(e)}function _assertThisInitialized$1m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1m=function(){return!!e})()}function _getPrototypeOf$1m(e){return(_getPrototypeOf$1m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1m(e,t)}function _setPrototypeOf$1m(e,t){return(_setPrototypeOf$1m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var CONTROLLER_ATTR_ERROR_CODE,CONTROLLER_ATTR_ERROR_CODE2;ParameterEmpty.xtype="report.main.parameter_container.controller.empty",ParameterEmpty=__decorate$L([shortcut()],ParameterEmpty),CONTROLLER_ATTR_ERROR_CODE2=CONTROLLER_ATTR_ERROR_CODE||(CONTROLLER_ATTR_ERROR_CODE={}),CONTROLLER_ATTR_ERROR_CODE2.SAME_ORIGIN_ITEM="11300207",CONTROLLER_ATTR_ERROR_CODE2.HAVE_RING="11300208";let ControllerAttrErrorHandler=function(e){function t(){return _classCallCheck$1A(this,t),_callSuper$1m(this,t,arguments)}return _inherits$1m(t,AbstractErrorHandler),_createClass$1A(t,[{key:"handle",value:function(e){throw BI.Msg.toast(null==e?void 0:e.errorMsg),null}}])}();function setParamLabelStyles(e,{fontSize:t,fontFamily:r,decoration:n,color:o,fontWeight:i,fontStyle:a}){const s="".concat(e,"-").concat(BI.UUID()),l=".".concat(s);index.use(jssGlobal(),jssNested());const c=a?getFontStyle(a):{},u=i?{"font-weight":i}:{};return index.createStyleSheet({"@global":{["".concat(l)]:Object.assign(Object.assign(Object.assign({"font-size":"".concat(t,"px"),"font-family":"".concat(r)},c),u),{color:o,"text-decoration":n})}}).attach(),s}function setLabelStyle(e,{opacity:t,background:r,color:n}){index.use(jssGlobal(),jssNested());const o="".concat(e,"-").concat(BI.UUID()),i=".".concat(o);return index.createStyleSheet({"@global":{["".concat(i)]:{opacity:t,background:r,color:n}}}).attach(),o}function _classCallCheck$1z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1y(n.key),n)}}function _createClass$1z(e,t,r){return t&&_defineProperties$1y(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1y(e){var t=_toPrimitive$1y(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1y(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1l(e,t,r){return t=_getPrototypeOf$1l(t),_possibleConstructorReturn$1l(e,_isNativeReflectConstruct$1l()?Reflect.construct(t,r||[],_getPrototypeOf$1l(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1l(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1l(e)}function _assertThisInitialized$1l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1l=function(){return!!e})()}function _superPropGet$i(e,t,r,n){var o=_get$i(_getPrototypeOf$1l(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$i(){return _get$i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$i(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$i.apply(null,arguments)}function _superPropBase$i(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1l(e)););return e}function _getPrototypeOf$1l(e){return(_getPrototypeOf$1l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1l(e,t)}function _setPrototypeOf$1l(e,t){return(_setPrototypeOf$1l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __decorate$K=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterLabel_1;let ParameterLabel=ParameterLabel_1=function(e){function t(){var e;return _classCallCheck$1z(this,t),(e=_callSuper$1l(this,t,arguments)).props={baseCls:ParameterLabel_1.BASE_CLS,$testId:ParameterLabel_1.BASE_CLS,color:"rgb(0,0,0)",fontSize:12,fontfamily:"",decoration:"none",textColor:"0,0,0,1",textalign:"left",verticalcenter:!1,value:"",disabled:!1,invisible:!1,needSubmit:!1,width:WIDTH,height:HEIGHT,wrap:!1,fontweight:void 0,fontstyle:void 0,allowBg:!0},e}return _inherits$1l(t,AbstractParameterControllerWidget),_createClass$1z(t,[{key:"render",value:function(){const{width:e,height:t,value:r,wrap:n,verticalcenter:o,textalign:i,fontfamily:a,fontSize:s,decoration:l,color:c,fontweight:u,fontstyle:d}=this.options,h=n?"normal":"nowrap",p=setParamLabelStyles(ParameterLabel_1.BASE_CLS,{fontFamily:"'".concat(a,"'"),fontSize:s,decoration:l,color:c,fontWeight:u,fontStyle:d}),f={ref:e=>{this.label=e,this.editComp=e.element[0]},cls:"".concat(p),whiteSpace:h,value:"".concat(r),textWidth:e,textAlign:i};return o?{type:BI.CenterAdaptLayout.xtype,width:e,height:t,scrollx:!0,items:[Object.assign({type:BI.Text.xtype,width:e},f)]}:{type:BI.VerticalLayout.xtype,width:e,height:t,scrolly:!1,scrollable:!1,items:[Object.assign({type:BI.Text.xtype},f)]}}},{key:"setControllerValue",value:async function(e,t){this.label.setValue(e),!this.silence&&t&&this.fireEvent("change")}},{key:"preGetValidation",value:function(){return{result:!0}}},{key:"postGetValidation",value:function(){return{result:!0}}},{key:"postValidateAndToast",value:function(){return!0}},{key:"getValue",value:function(){return this.label.getValue()}},{key:"setInteractValue",value:function(e){this.setControllerValue(e)}},{key:"reset",value:function(){}},{key:"resize",value:function(e,r){const n=this.label.getValue();_superPropGet$i(t,"resize",this)([e,r]),this.label.setValue(n)}},{key:"setFontSize",value:function(e){this.options.fontSize=e}},{key:"setStyle",value:function(e){this.label.element.addClass(setLabelStyle(ParameterLabel_1.BASE_CLS,e))}},{key:"getText",value:function(){return this.label.getValue()}}])}();function _classCallCheck$1y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1x(n.key),n)}}function _createClass$1y(e,t,r){return t&&_defineProperties$1x(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1x(e){var t=_toPrimitive$1x(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1x(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1k(e,t,r){return t=_getPrototypeOf$1k(t),_possibleConstructorReturn$1k(e,_isNativeReflectConstruct$1k()?Reflect.construct(t,r||[],_getPrototypeOf$1k(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1k(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1k(e)}function _assertThisInitialized$1k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1k(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1k=function(){return!!e})()}function _getPrototypeOf$1k(e){return(_getPrototypeOf$1k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1k(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1k(e,t)}function _setPrototypeOf$1k(e,t){return(_setPrototypeOf$1k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterLabel.xtype="report.main.parameter_container.controller.label",ParameterLabel.widgetType="label",ParameterLabel.BASE_CLS="report-main-parameter-container-controller-label",__decorate$K([click()],ParameterLabel.prototype,"render",null),ParameterLabel=ParameterLabel_1=__decorate$K([shortcut()],ParameterLabel);var __decorate$J=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ParameterMultifileProgressBar=function(e){function t(){var e;return _classCallCheck$1y(this,t),(e=_callSuper$1k(this,t,arguments)).props={baseCls:"report-main-parameter-container-controller-multifile-progress-bar",width:280,height:16,value:0},e}return _inherits$1k(t,BI.Widget),_createClass$1y(t,[{key:"render",value:function(){const{value:e}=this.options;return{type:BI.AbsoluteLayout.xtype,ref:e=>{this.layer=e},items:[{el:{type:BI.Layout.xtype,cls:"progress-bar-current"},top:0,left:0,width:this.transformProgress2Percentage(e),bottom:0},{el:{type:BI.Label.xtype,ref:e=>{this.text=e},text:this.transformProgress2Percentage(e)},top:0,left:0,right:0,bottom:0}]}}},{key:"setValue",value:function(e){this.options.value=e;const t=this.transformProgress2Percentage(e);this.text.setValue(t),this.layer.attr("items")[0].width=t,this.layer.resize()}},{key:"transformProgress2Percentage",value:function(e){return"".concat((100*e).toFixed(0),"%")}}])}();function _classCallCheck$1x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1w(n.key),n)}}function _createClass$1x(e,t,r){return t&&_defineProperties$1w(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1w(e){var t=_toPrimitive$1w(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1w(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1j(e,t,r){return t=_getPrototypeOf$1j(t),_possibleConstructorReturn$1j(e,_isNativeReflectConstruct$1j()?Reflect.construct(t,r||[],_getPrototypeOf$1j(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1j(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1j(e)}function _assertThisInitialized$1j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1j(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1j=function(){return!!e})()}function _getPrototypeOf$1j(e){return(_getPrototypeOf$1j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1j(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1j(e,t)}function _setPrototypeOf$1j(e,t){return(_setPrototypeOf$1j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterMultifileProgressBar.xtype="report.main.parameter_container.controller.multifile.progress_bar",ParameterMultifileProgressBar=__decorate$J([shortcut()],ParameterMultifileProgressBar);var __decorate$I=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ParameterMultifileProgressPane=function(e){function t(){var e;return _classCallCheck$1x(this,t),(e=_callSuper$1j(this,t,arguments)).props={baseCls:"report-main-parameter-container-controller-multifile-progress-pane",queueGetter:()=>[],uploadedGetter:()=>[],value:0},e}return _inherits$1j(t,BI.Widget),_createClass$1x(t,[{key:"render",value:function(){const{queueGetter:e,value:t}=this.options,{text:r,value:n}=this.getTotalStatus();return{type:BI.VerticalLayout.xtype,tgap:2,hgap:2,bgap:5,items:[{type:BI.Label.xtype,cls:"pane-title",textAlign:"left",text:BI.i18nText("Fine-Report_Upload_Progress"),height:24},{type:BI.Label.xtype,ref:e=>{this.statusText=e},textAlign:"left",text:r},{type:BI.Label.xtype,textAlign:"left",text:BI.i18nText("Fine-Report_Overall_Uploading_Progress")},{type:ParameterMultifileProgressBar.xtype,ref:e=>{this.totalProgressBar=e},value:t},{type:BI.Label.xtype,textAlign:"left",text:BI.i18nText("Fine-Report_Current_Uploading_Progress")},{type:ParameterMultifileProgressBar.xtype,ref:e=>{this.currentProgressBar=e},value:n},{type:BI.Label.xtype,textAlign:"left",text:e().join("\n")}]}}},{key:"setValue",value:function(e){this.options.value=e;const{text:t,value:r}=this.getTotalStatus();this.statusText.setValue(t),this.totalProgressBar.setValue(r),this.currentProgressBar.setValue(e)}},{key:"getTotalStatus",value:function(){const{queueGetter:e,uploadedGetter:t,value:r}=this.options,n=BI.size(e()),o=r/n+BI.size(t())/n;return{text:BI.i18nText(1!==o?"Fine-Report_Parepare_For_Uploading":"Fine-Report_Upload_Complete"),value:o}}}])}();function _classCallCheck$1w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1v(n.key),n)}}function _createClass$1w(e,t,r){return t&&_defineProperties$1v(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1v(e){var t=_toPrimitive$1v(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1v(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1i(e,t,r){return t=_getPrototypeOf$1i(t),_possibleConstructorReturn$1i(e,_isNativeReflectConstruct$1i()?Reflect.construct(t,r||[],_getPrototypeOf$1i(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1i(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1i(e)}function _assertThisInitialized$1i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1i(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1i=function(){return!!e})()}function _getPrototypeOf$1i(e){return(_getPrototypeOf$1i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1i(e,t)}function _setPrototypeOf$1i(e,t){return(_setPrototypeOf$1i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterMultifileProgressPane.xtype="report.main.parameter_container.controller.multifile.progress_pane",ParameterMultifileProgressPane=__decorate$I([shortcut()],ParameterMultifileProgressPane);var __decorate$H=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};const DEFAULT_SIZE$2=32,DEFAULT_LABEL_SIZE=20,DEFAULT_FONT_SIZE=12;let ParameterMultifile=function(e){function t(){var e;return _classCallCheck$1w(this,t),(e=_callSuper$1i(this,t,arguments)).uploadFiles=[],e.canUpload=!0,e.props={baseCls:"report-main-parameter-container-controller-multifile",disabled:!1,invisible:!1,needSubmit:!1,fontSize:12,value:"0",width:80,height:50,accept:"",maxlength:1/0,maxSize:-1,url:"attachment/upload",allowBg:!0},e}return _inherits$1i(t,AbstractParameterControllerWidget),_createClass$1w(t,[{key:"render",value:function(){const{accept:e,width:t,height:r,maxSize:n,value:o,maxlength:i,url:a}=this.options,s=n>0?1024*n:-1,l=e?e.split("|").map((e=>".".concat(e))).join(","):"",c=this.calculatePosotion(t,r);return{type:BI.AbsoluteLayout.xtype,ref:e=>{this.wrapper=e},items:[{el:{type:BI.Label.xtype,cls:"count-label ".concat(setFontSize("count-label",c.label.fontSize)),ref:e=>{this.label=e},text:o,width:c.label.width,height:c.label.height},left:c.label.left,top:c.label.top},{el:{type:BI.BubbleCombo.xtype,ref:e=>{this.bubbleCombo=e},trigger:"hover",offsetStyle:"right",isNeedAdjustHeight:!0,isDefaultInit:!0,el:{type:BI.IconButton.xtype,ref:e=>{this.button=e},cls:"upload-trigger-background",width:c.button.width,height:c.button.height,title:()=>this.getMultifileEditorValue().map((({filename:e})=>e)).join("\n"),handler:()=>{this.canUpload&&this.multifileEditor.select()}},popup:{el:{type:BI.ButtonGroup.xtype,ref:e=>{this.uploadFileGroup=e},layouts:[{type:BI.VerticalLayout.xtype,minHeight:0}],items:[]},minWidth:200,minHeight:0,maxHeight:200}},left:c.button.left,top:c.button.top},{el:{type:BI.Combo.xtype,ref:e=>{this.progressCombo=e},hideWhenBlur:!1,trigger:"",destroyWhenHide:!0,belowMouse:!0,offsetStyle:"left",isNeedAdjustHeight:!0,el:{type:BI.Layout.xtype},popup:{el:{type:ParameterMultifileProgressPane.xtype,queueGetter:()=>this.multifileEditor.getQueue().map((({fileName:e})=>e)),uploadedGetter:()=>this.getMultifileEditorValue().map((({filename:e})=>e))},minWidth:350,minHeight:200}},left:c.button.left,top:c.button.top},{el:{type:BI.MultifileEditor.xtype,ref:e=>{this.multifileEditor=e},url:completeUrl(a),accept:l,width:t,height:r,maxSize:s,multiple:1!==i,listeners:[{eventName:BI.MultifileEditor.EVENT_CHANGE,action:()=>{this.multifileEditor.upload()}},{eventName:BI.MultifileEditor.EVENT_UPLOADSTART,action:()=>{this.progressCombo.showView(),BI.Tooltips.remove(this.multifileEditor.getName()),this.canUpload=!1}},{eventName:BI.MultifileEditor.EVENT_UPLOADED,action:async()=>{this.resetState();const e=this.uploadFiles.length-this.options.maxlength;if(this.options.maxlength!==1/0&&e>0)for(let t=0;t<e;t++)await this.deleteFile(this.uploadFiles[t].attach_id);!this.silence&&this.fireEvent("callback"),this.fireEvent("EVENT_CHANGE")}},{eventName:BI.MultifileEditor.EVENT_ERROR,action:t=>{if(this.resetState(),!this.silence&&this.fireEvent("callback"),this.fireEvent("EVENT_CHANGE"),BI.isEmptyString(e))return;const{name:r}=t.file;if(0===t.errorType){const t=r.split(".").pop();BI.Msg.toast(BI.i18nText("Fine-Report_File_Type_Error",t,e),{level:"error"})}1===t.errorType&&BI.Msg.toast(BI.i18nText("Fine-Report_File_TOO_LARGE",r,"".concat(n,"KB")),{level:"error"})}},{eventName:BI.MultifileEditor.EVENT_PROGRESS,action:e=>{this.progressCombo.isViewVisible()&&this.progressCombo.setValue(e.loaded/e.total)}}]},top:0,left:0}]}}},{key:"resetState",value:function(){this.label.setText("".concat(this.getMultifileEditorValue().length)),this.uploadFiles=[...this.uploadFiles,...this.getMultifileEditorValue()],this.hideProgressComboView(),this.renderUploadFiles(),this.multifileEditor.reset(),this.canUpload=!0}},{key:"beforeMount",value:function(){this.multifileEditor.element.on("dragover",(e=>{e.preventDefault()})),this.multifileEditor.element.on("drop",(e=>{var t;e.preventDefault();const r=null===(t=e.originalEvent.dataTransfer)||void 0===t?void 0:t.files;r&&this.multifileEditor.sendFiles(r)}))}},{key:"hideProgressComboView",value:function(){setTimeout((()=>{this.progressCombo.hideView(),this.bubbleCombo.showView()}),1e3)}},{key:"renderUploadFiles",value:function(){var e;const t=this.uploadFiles;this.label.setText("".concat(t.length)),null===(e=this.uploadFileGroup)||void 0===e||e.populate(t.map((e=>({type:BI.LeftRightVerticalAdaptLayout.xtype,cls:"bi-list-item-active cursor-pointer",height:25,items:{left:[{type:BI.TextButton.xtype,width:150,hgap:3,textAlign:"left",value:e.filename,title:e.filename,handler:()=>{this.downloadFile(e.attach_id)}}],right:[{type:BI.IconButton.xtype,width:25,cls:"delete-font",handler:async()=>{await this.deleteFile(e.attach_id),this.fireEvent("EVENT_CHANGE")}}]}}))))}},{key:"deleteFile",value:async function(e){await deleteFile(e),this.uploadFiles=this.uploadFiles.filter((t=>t.attach_id!==e)),this.renderUploadFiles()}},{key:"downloadFile",value:function(e){downloadFile(e)}},{key:"getUploadFiles",value:function(){return this.uploadFiles}},{key:"preGetValidation",value:function(){return{result:!0}}},{key:"postGetValidation",value:function(){return{result:!0}}},{key:"postValidateAndToast",value:function(){return!0}},{key:"reset",value:function(){}},{key:"setInteractValue",value:function(){}},{key:"setControllerValue",value:async function(){}},{key:"getValue",value:function(){return this.uploadFiles}},{key:"getMultifileEditorValue",value:function(){return this.multifileEditor.getValue().filter((({attach_id:e})=>e))}},{key:"calculatePosotion",value:function(e,t){const r=Math.min(e,DEFAULT_SIZE$2),n=Math.min(t,DEFAULT_SIZE$2),o=DEFAULT_LABEL_SIZE/DEFAULT_SIZE$2*r;return{label:{width:o,height:o,fontSize:DEFAULT_FONT_SIZE/DEFAULT_SIZE$2*r,left:(e+r)/2,top:(t-n)/2},button:{width:r,height:n,left:(e-r)/2,top:(t-n)/2}}}},{key:"resize",value:function(e,t){this.options.width=e,this.options.height=t,this.element.css("width",e),this.element.css("height",t);const r=this.calculatePosotion(e,t),n=this.wrapper.attr("items");n[0].left=r.label.left,n[0].top=r.label.top,n[1].left=r.button.left,n[1].top=r.button.top,this.wrapper.resize(),this.label.element.css("width",r.label.width),this.label.element.css("height",r.label.height),this.label.element.css("font-size",r.label.fontSize),this.button.element.css("width",r.button.width),this.button.element.css("height",r.button.height),this.multifileEditor.element.css("width",e),this.multifileEditor.element.css("height",t)}},{key:"getAdapter",value:function(){return this.multifileEditor}},{key:"setStyle",value:function(e){}}])}();var NUM_ERROR,NUM_ERROR2;function checkValidation(e,{allowNegative:t,allowDecimals:r,allowBlank:n,maxDecLength:o=16,maxIntLength:i=32,maxValue:a,minValue:s}){if(""===e)return n||NUM_ERROR.NOT_ALLOW_BLANK;if(!BI.isNumeric(e))return NUM_ERROR.INVALID_NUMBER;const l=parseFloat(e);if(!t&&l<0)return NUM_ERROR.NOT_ALLOW_NEGATIVE;if(!r&&Math.floor(l)!==l)return NUM_ERROR.NOT_ALLOW_DECIMALS;if(BI.size("".concat(l).split(".")[1])>o)return NUM_ERROR.TOO_MANY_DECIMALS;return BI.size("".concat(l).split(".")[0])>i?NUM_ERROR.TOO_MANY_INTEGER:BI.isNotNull(a)&&l>a?NUM_ERROR.TOO_LARGE:!(BI.isNotNull(s)&&l<s)||NUM_ERROR.TOO_SMALL}function transformValidation2ErrorMsg(e,t){const{errorMsg:r,regErrorMsg:n,maxValue:o,minValue:i}=t;switch(e){case NUM_ERROR.NOT_ALLOW_BLANK:return r;case NUM_ERROR.INVALID_NUMBER:return n||BI.i18nText("Fine-Report_Preview_Input_Must_Be_Number");case NUM_ERROR.NOT_ALLOW_NEGATIVE:return n||BI.i18nText("Fine-Report_Preview_NOT_ALLOW_NEGATIVE");case NUM_ERROR.NOT_ALLOW_DECIMALS:return n||BI.i18nText("Fine-Report_Preview_NOT_ALLOW_DECIMALS");case NUM_ERROR.TOO_MANY_DECIMALS:return n||BI.i18nText("Fine-Report_Preview_TOO_MANY_DECIMALS");case NUM_ERROR.TOO_LARGE:return n||BI.i18nText("Fine-Report_Preview_TOO_LARGE",o);case NUM_ERROR.TOO_SMALL:return n||BI.i18nText("Fine-Report_Preview_TOO_SMALL",i);default:return n||BI.i18nText("Fine-Report_Preview_Input_Error")}}function formatNumber(e,t,r){let n=e.replace(/[^-0-9\\.]/g,"");return n=t?n.replace(/^-/g,"ll").replace(/-/g,"").replace(/^ll/,"-"):n.replace(/-/g,""),n=r?n.replace(/^[.]/g,"").replace(/[.]/,"dd").replace(/[.]/g,"").replace(/dd/,".").replace(/[.]$/g,""):n.replace(/[.]/g,""),n}function _classCallCheck$1v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1u(n.key),n)}}function _createClass$1v(e,t,r){return t&&_defineProperties$1u(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1u(e){var t=_toPrimitive$1u(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1u(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1h(e,t,r){return t=_getPrototypeOf$1h(t),_possibleConstructorReturn$1h(e,_isNativeReflectConstruct$1h()?Reflect.construct(t,r||[],_getPrototypeOf$1h(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1h(e)}function _assertThisInitialized$1h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1h=function(){return!!e})()}function _superPropGet$h(e,t,r,n){var o=_get$h(_getPrototypeOf$1h(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$h(){return _get$h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$h(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$h.apply(null,arguments)}function _superPropBase$h(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1h(e)););return e}function _getPrototypeOf$1h(e){return(_getPrototypeOf$1h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1h(e,t)}function _setPrototypeOf$1h(e,t){return(_setPrototypeOf$1h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterMultifile.xtype="report.main.parameter_container.controller.multifile",ParameterMultifile.widgetType="multifile",ParameterMultifile=__decorate$H([shortcut()],ParameterMultifile),NUM_ERROR2=NUM_ERROR||(NUM_ERROR={}),NUM_ERROR2.NOT_ALLOW_BLANK="NOT_ALLOW_BLANK",NUM_ERROR2.INVALID_NUMBER="INVALID_NUMBER",NUM_ERROR2.NOT_ALLOW_NEGATIVE="NOT_ALLOW_NEGATIVE",NUM_ERROR2.NOT_ALLOW_DECIMALS="NOT_ALLOW_DECIMALS",NUM_ERROR2.TOO_MANY_DECIMALS="TOO_MANY_DECIMALS",NUM_ERROR2.TOO_MANY_INTEGER="TOO_MANY_INTEGER",NUM_ERROR2.TOO_LARGE="TOO_LARGE",NUM_ERROR2.TOO_SMALL="TOO_SMALL";var __decorate$G=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterNumber_1;let ParameterNumber=ParameterNumber_1=function(e){function t(){var e;return _classCallCheck$1v(this,t),(e=_callSuper$1h(this,t,arguments)).props={baseCls:"report-main-parameter-container-controller-number",$testId:"report-main-parameter-container-controller-number",width:WIDTH,height:HEIGHT,value:void 0,allowDecimals:!0,allowNegative:!0,maxDecLength:16,maxIntLength:32,maxValue:void 0,minValue:void 0,regErrorMsg:"",disabled:!1,invisible:!1,needSubmit:!1,fontSize:12,allowBlank:!0,errorMsg:BI.i18nText("Fine-Report_Preview_Can_Not_Null"),watermark:"",allowBg:!0},e}return _inherits$1h(t,AbstractParameterControllerWidget),_createClass$1v(t,[{key:"render",value:function(){const{width:e,height:t,value:r,fontSize:n,watermark:o,disabled:i,allowBg:a}=this.options,s=setFontSize("report-main-parameter-container-controller-number",n),l=setLineHeight("report-main-parameter-container-controller-number",t);return{type:BI.VerticalLayout.xtype,cls:a?"bi-card":"",items:[{type:BI.TextEditor.xtype,cls:"".concat(s," ").concat(l," bi-border-radius"),ref:e=>{this.editor=e},vgap:0,width:e,height:t,watermark:o,allowBlank:!0,disabled:i,value:r,listeners:[{eventName:BI.TextEditor.EVENT_FOCUS,action:()=>{this.hideBubble(),!this.silence&&this.fireEvent("beforeedit")}},{eventName:BI.TextEditor.EVENT_KEY_DOWN,action:()=>{this.hideBubble();!1!==(!this.silence&&this.fireEvent("afteredit"))&&this.fireEvent(ParameterNumber_1.EVENT_CHANGE,this.editor.getValue())}},{eventName:BI.TextEditor.EVENT_BLUR,action:()=>{!this.silence&&this.fireEvent("stopedit")}}]}]}}},{key:"setControllerValue",value:async function(e){this.getBasicValidation(e).result&&this.editor.setValue(e)}},{key:"getValue",value:function(){const{allowNegative:e,allowDecimals:t}=this.options,r=BI.parseFloat(formatNumber(this.editor.getValue(),e,t));return BI.isNaN(r)?"":r}},{key:"getBasicValidation",value:function(e){var t;void 0===e&&(e=null===(t=this.editor)||void 0===t?void 0:t.getValue());const{allowNegative:r,allowDecimals:n,allowBlank:o,maxDecLength:i,maxIntLength:a,maxValue:s,minValue:l,errorMsg:c,regErrorMsg:u}=this.options,d=checkValidation(e,{allowNegative:r,allowDecimals:n,allowBlank:o,maxDecLength:i,maxIntLength:a,maxValue:s,minValue:l});return!0===d?{result:!0}:{result:!1,errorMsg:transformValidation2ErrorMsg(d,{errorMsg:c,regErrorMsg:u,maxValue:s,minValue:l})}}},{key:"preGetValidation",value:function(){const{value:e}=this.options;return this.getBasicValidation(e)}},{key:"postGetValidation",value:function(){return this.getBasicValidation()}},{key:"postValidateAndToast",value:function(){const e=this.getValidation();return!0===e.result||(this.showBubble(e.errorMsg),!1)}},{key:"emitManualStopEditEvent",value:function(){this.fireEvent("stopedit")}},{key:"setInteractValue",value:function(e){this.setControllerValue(e)}},{key:"reset",value:function(){this.editor.setValue()}},{key:"resize",value:function(e,r){const n=this.editor.getValue();_superPropGet$h(t,"resize",this)([e,r]),this.editor.setValue(n)}},{key:"getAdapter",value:function(){return this.editor}},{key:"focus",value:function(){this.editor.focus()}},{key:"blur",value:function(){this.editor.blur()}},{key:"setStyle",value:function(e){this.editor.element.addClass(setEditorStyle(e))}},{key:"setWaterMark",value:function(e){this.editor.setWaterMark(e)}},{key:"getText",value:function(){return this.editor.getValue()}}])}();function _classCallCheck$1u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1t(n.key),n)}}function _createClass$1u(e,t,r){return t&&_defineProperties$1t(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1t(e){var t=_toPrimitive$1t(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1t(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1g(e,t,r){return t=_getPrototypeOf$1g(t),_possibleConstructorReturn$1g(e,_isNativeReflectConstruct$1g()?Reflect.construct(t,r||[],_getPrototypeOf$1g(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1g(e)}function _assertThisInitialized$1g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1g=function(){return!!e})()}function _getPrototypeOf$1g(e){return(_getPrototypeOf$1g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1g(e,t)}function _setPrototypeOf$1g(e,t){return(_setPrototypeOf$1g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterNumber.EVENT_CHANGE="EVENT_CHANGE",ParameterNumber.xtype="report.main.parameter_container.controller.number",ParameterNumber.widgetType="number",ParameterNumber=ParameterNumber_1=__decorate$G([shortcut()],ParameterNumber);var __decorate$F=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let PageFixedRowCombobox=function(e){function t(){return _classCallCheck$1u(this,t),_callSuper$1g(this,t,arguments)}return _inherits$1g(t,ParameterComboNext),_createClass$1u(t,[{key:"getSubmitValue",value:function(){return{__pageFixedRowSize__:this.getValue()}}}])}();function validateParamPassword(e,{allowBlank:t,regex:r}){return!(""===e&&!t)&&(!(""!==e||!t)||new RegExp(r).test(e))}function getParamPasswordErrorMsg(e,{allowBlank:t,errorMsg:r,regErrorMsg:n}){return""!==e||t?n:r}function _classCallCheck$1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1s(n.key),n)}}function _createClass$1t(e,t,r){return t&&_defineProperties$1s(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1s(e){var t=_toPrimitive$1s(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1s(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1f(e,t,r){return t=_getPrototypeOf$1f(t),_possibleConstructorReturn$1f(e,_isNativeReflectConstruct$1f()?Reflect.construct(t,r||[],_getPrototypeOf$1f(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1f(e)}function _assertThisInitialized$1f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1f=function(){return!!e})()}function _superPropGet$g(e,t,r,n){var o=_get$g(_getPrototypeOf$1f(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$g(){return _get$g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$g(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$g.apply(null,arguments)}function _superPropBase$g(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1f(e)););return e}function _getPrototypeOf$1f(e){return(_getPrototypeOf$1f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1f(e,t)}function _setPrototypeOf$1f(e,t){return(_setPrototypeOf$1f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}PageFixedRowCombobox.xtype="report.main.controller.page_fixed_row_combobox",PageFixedRowCombobox.widgetType="pagefixedrowcombobox",PageFixedRowCombobox=__decorate$F([shortcut()],PageFixedRowCombobox);var __decorate$E=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ParameterPassword=function(e){function t(){var e;return _classCallCheck$1t(this,t),(e=_callSuper$1f(this,t,arguments)).props={baseCls:"report-main-parameter-container-controller-password",$testId:"report-main-parameter-container-controller-password",width:WIDTH,height:HEIGHT,value:"",passwordText:!0,disabled:!1,invisible:!1,needSubmit:!1,fontSize:12,allowBlank:!0,errorMsg:BI.i18nText("Fine-Report_Preview_Can_Not_Null"),watermark:"",regex:"",regErrorMsg:BI.i18nText("Fine-Report_Preview_Input_Error"),allowBg:!0},e}return _inherits$1f(t,AbstractParameterControllerWidget),_createClass$1t(t,[{key:"render",value:function(){const{width:e,height:t,value:r,fontSize:n,watermark:o,disabled:i,allowBg:a}=this.options,s=setFontSize("report-main-parameter-container-controller-password",n);return{type:BI.VerticalLayout.xtype,cls:a?"bi-card":"",items:[{type:BI.Editor.xtype,cls:"".concat(s," bi-border bi-border-radius bi-focus-shadow"),ref:e=>{this.editor=e},width:e-2,height:t-2,disabled:i,allowBlank:!0,watermark:o,value:r,inputType:"password",listeners:[{eventName:BI.TextEditor.EVENT_FOCUS,action:()=>{this.hideBubble(),!this.silence&&this.fireEvent("beforeedit")}},{eventName:BI.TextEditor.EVENT_KEY_DOWN,action:()=>{!1!==(!this.silence&&this.fireEvent("afteredit"))&&this.fireEvent("EVENT_CHANGE",this.editor.getValue())}},{eventName:BI.TextEditor.EVENT_BLUR,action:()=>{!this.silence&&this.fireEvent("stopedit")}}]}]}}},{key:"setWaterMark",value:function(e){this.editor.setWaterMark(e)}},{key:"setControllerValue",value:async function(e){this.editor.setValue(e)}},{key:"setInteractValue",value:function(e){this.setControllerValue(e)}},{key:"getBasicValidation",value:function(e=this.editor.getValue()){const t=BI.isArray(e)?e.map((e=>"".concat(e))).join(""):e,{allowBlank:r,regex:n,errorMsg:o,regErrorMsg:i}=this.options;return validateParamPassword(t,{allowBlank:r,regex:n})?{result:!0}:{result:!1,errorMsg:getParamPasswordErrorMsg(t,{allowBlank:r,errorMsg:o,regErrorMsg:i})}}},{key:"preGetValidation",value:function(){const{value:e}=this.options;return this.getBasicValidation(e)}},{key:"postGetValidation",value:function(){return this.getBasicValidation()}},{key:"postValidateAndToast",value:function(){const e=this.getValidation();return!!e.result||(this.showBubble(e.errorMsg),!1)}},{key:"emitManualStopEditEvent",value:function(){this.fireEvent("stopedit")}},{key:"getValue",value:function(){return this.editor.getValue()}},{key:"reset",value:function(){this.editor.setValue()}},{key:"resize",value:function(e,r){const n=this.editor.getValue();_superPropGet$g(t,"resize",this)([e,r]),this.editor.setValue(n)}},{key:"getAdapter",value:function(){return this.editor}},{key:"focus",value:function(){this.editor.focus()}},{key:"blur",value:function(){this.editor.blur()}},{key:"setStyle",value:function(e){this.editor.element.addClass(setEditorStyle(e))}},{key:"getText",value:function(){return this.editor.getValue()}}])}();function setSingleSelectRadioFontSize(e,t){const r="".concat(e,"-").concat(BI.UUID()),n=".".concat(r," .bi-radio .radio-content");index.use(jssGlobal(),jssNested());const o=(t/2-1)/4*3;return index.createStyleSheet({"@global":{["".concat(n)]:{"border-radius":"50%"},["".concat(n,":after")]:{width:"".concat(o,"px"),height:"".concat(o,"px"),"border-radius":"50%"}}}).attach(),r}function setRadioGroupStyle(e,{opacity:t,background:r,color:n}){index.use(jssGlobal(),jssNested());const o="".concat(e,"-").concat(BI.UUID()),i=".".concat(o);return index.createStyleSheet({"@global":{["".concat(i)]:{opacity:t,background:r,color:n}}}).attach(),o}function _classCallCheck$1s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1r(n.key),n)}}function _createClass$1s(e,t,r){return t&&_defineProperties$1r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1r(e){var t=_toPrimitive$1r(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1r(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1e(e,t,r){return t=_getPrototypeOf$1e(t),_possibleConstructorReturn$1e(e,_isNativeReflectConstruct$1e()?Reflect.construct(t,r||[],_getPrototypeOf$1e(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1e(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1e(e)}function _assertThisInitialized$1e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1e(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1e=function(){return!!e})()}function _superPropGet$f(e,t,r,n){var o=_get$f(_getPrototypeOf$1e(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$f(){return _get$f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$f(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$f.apply(null,arguments)}function _superPropBase$f(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1e(e)););return e}function _getPrototypeOf$1e(e){return(_getPrototypeOf$1e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1e(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1e(e,t)}function _setPrototypeOf$1e(e,t){return(_setPrototypeOf$1e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterPassword.xtype="report.main.parameter_container.controller.password",ParameterPassword.widgetType="password",ParameterPassword=__decorate$E([shortcut()],ParameterPassword);var __decorate$D=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterRadioGroupSingleSelectRadioItem_1;let ParameterRadioGroupSingleSelectRadioItem=ParameterRadioGroupSingleSelectRadioItem_1=function(e){function t(){var e;return _classCallCheck$1s(this,t),(e=_callSuper$1e(this,t,arguments)).options=e.props,e.props={baseCls:"report-main-parameter-container-controller-radio-group-radio-item",$testId:"bi-single-select-radio-item",hgap:4,text:"",value:void 0,width:void 0,adaptive:!1,scale:1},e}return _inherits$1e(t,BI.BasicButton),_createClass$1s(t,[{key:"render",value:function(){const{scale:e,adaptive:t,hgap:r,text:n,value:o}=this.options,i=24*e,a=Math.floor(12*e),s=[{el:{type:BI.VerticalAdaptLayout.xtype,items:[{type:BI.Radio.xtype,ref:e=>{this.radio=e},width:a,height:a,iconWidth:a-2,iconHeight:a-2}]},width:a},{type:BI.Label.xtype,ref:e=>{this.text=e},cls:"list-item-text",textAlign:"left",whiteSpace:t?"normal":"nowrap",hgap:r*e,text:n,value:o,textHeight:t?void 0:i}],l=setSingleSelectRadioFontSize("report-main-parameter-container-controller-radio-group-radio-item",a);return t?{type:BI.TableAdaptLayout.xtype,cls:l,horizontalAlign:BI.HorizontalAlign.Left,verticalAlign:BI.VerticalAlign.Middle,columnSize:[a,""],items:s}:{type:BI.HTapeLayout.xtype,cls:l,height:i,items:s}}},{key:"doRedMark",value:function(...e){this.text.doRedMark(e)}},{key:"unRedMark",value:function(...e){this.text.unRedMark(e)}},{key:"doClick",value:function(){_superPropGet$f(t,"doClick",this,1).apply(this,arguments),this.radio.setSelected(this.isSelected()),this.isValid()&&this.fireEvent(ParameterRadioGroupSingleSelectRadioItem_1.EVENT_CHANGE,this.isSelected(),this.getValue(),this)}},{key:"setSelected",value:function(e){_superPropGet$f(t,"setSelected",this,1).apply(this,arguments),this.radio.setSelected(e)}}])}();function _classCallCheck$1r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1q(n.key),n)}}function _createClass$1r(e,t,r){return t&&_defineProperties$1q(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1q(e){var t=_toPrimitive$1q(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1q(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1d(e,t,r){return t=_getPrototypeOf$1d(t),_possibleConstructorReturn$1d(e,_isNativeReflectConstruct$1d()?Reflect.construct(t,r||[],_getPrototypeOf$1d(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1d(e)}function _assertThisInitialized$1d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1d(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1d=function(){return!!e})()}function _superPropGet$e(e,t,r,n){var o=_get$e(_getPrototypeOf$1d(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$e(){return _get$e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$e(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$e.apply(null,arguments)}function _superPropBase$e(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1d(e)););return e}function _getPrototypeOf$1d(e){return(_getPrototypeOf$1d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1d(e,t)}function _setPrototypeOf$1d(e,t){return(_setPrototypeOf$1d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterRadioGroupSingleSelectRadioItem.xtype="report.main.parameter_container.controller.radio_group.sinlge_select_radio_item",ParameterRadioGroupSingleSelectRadioItem.EVENT_CHANGE="EVENT_CHANGE",ParameterRadioGroupSingleSelectRadioItem=ParameterRadioGroupSingleSelectRadioItem_1=__decorate$D([shortcut()],ParameterRadioGroupSingleSelectRadioItem);var __decorate$C=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterRadioGroup_1;let ParameterRadioGroup=ParameterRadioGroup_1=function(e){function t(){var e;return _classCallCheck$1r(this,t),(e=_callSuper$1d(this,t,arguments)).props={baseCls:ParameterRadioGroup_1.BASE_CLS,$testId:ParameterRadioGroup_1.BASE_CLS,widgetName:"",width:WIDTH,height:HEIGHT,adaptive:!1,columnsInRow:1,controlAttr:{data:[],value:""},needSubmit:!1,disabled:!1,invisible:!1,fontSize:12,value:"",allowBlank:!0,errorMsg:BI.i18nText("Fine-Report_Preview_Can_Not_Null"),norepeat:!0,controlAttrFetcher:fetchParamControlAttr,extraOptsGetter:()=>({}),getDependenceByWidget:()=>[],getWidgetDependenceValueByWidget:()=>({}),allowBg:!0},e}return _inherits$1d(t,AbstractParameterControllerWidget),_createClass$1r(t,[{key:"render",value:function(){const{width:e,height:t,fontSize:r}=this.options;return{type:BI.ButtonGroup.xtype,ref:e=>{this.radioGroups=e,this.$container=e.element},items:this.items,chooseType:BI.ButtonGroup.CHOOSE_TYPE_MULTI,layouts:[{type:BI.FloatLeftLayout.xtype,width:e,height:t,tgap:3*r/12,scrolly:!0}]}}},{key:"setControllerValue",value:async function(e){this.options.value=e,this.radioGroups.populate(this.items)}},{key:"setInteractValue",value:function(e){this.options.controlAttr=e,this.options.value=e.value,this.radioGroups.populate(this.items),this.setControllerValue(e.value)}},{key:"preGetValidation",value:function(){const{errorMsg:e,allowBlank:t,value:r}=this.options;return t||!BI.isEmpty(r)?{result:!0}:{result:!1,errorMsg:e}}},{key:"postGetValidation",value:function(){const{allowBlank:e,errorMsg:t}=this.options;return e||!0==!!this.getValue()?{result:!0}:{result:!1,errorMsg:t}}},{key:"postValidateAndToast",value:function(){const e=this.getValidation();return!!e.result||(this.showBubble(e.errorMsg),!1)}},{key:"getValue",value:function(){const e=BI.first(this.radioGroups.getAllButtons().filter((e=>e.isSelected())).map((e=>e.getValue())));return e||""}},{key:"items",get:function(){const{adaptive:e,columnsInRow:t,controlAttr:r,fontSize:n,value:o,disabled:i}=this.options,a=transformControlAttrData(r.data),s=setFontSize(ParameterRadioGroup_1.BASE_CLS,BI.isIE()?Math.floor(n):n),l=BI.isNull(o)||BI.isEmptyString(o)?void 0:BI.isArray(o)?"".concat(BI.first(o)):"".concat(o);let c=!1;return a.some((e=>(c=e.value===l,c&&(e.selected=!0),c))),c||a.some((e=>(c=e.text===l,c&&(e.selected=!0),c))),a.map((r=>{const{text:o,value:a,selected:l=!1}=r;return Object.assign(Object.assign({type:ParameterRadioGroupSingleSelectRadioItem.xtype,disabled:i,scale:n/12,cls:"".concat(s),text:o,title:o,adaptive:e,selected:l,value:a},getWidthPropByAdaptive(e,t)),{listeners:[{eventName:ParameterRadioGroupSingleSelectRadioItem.EVENT_CHANGE,action:(e,t,r)=>{e&&this.radioGroups.getAllButtons().forEach((e=>{e!==r&&e.setSelected(!1)})),this.hideBubble();!1!==(!this.silence&&this.fireEvent("statechange"))&&this.fireEvent("EVENT_CHANGE")}}]})}))}},{key:"reset",value:function(){this.radioGroups.setValue()}},{key:"resize",value:function(e,r){this.options.value=this.getValue(),_superPropGet$e(t,"resize",this)([e,r])}},{key:"updateControlAttr",value:async function(){const{widgetName:e,controlAttrFetcher:t}=this.options;return t(e,this.getRequestOpts()).then((e=>{this.options.controlAttr={data:e,value:this.options.value}}))}},{key:"reloadControlAttr",value:function(){this.reset(),this.updateControlAttr().then((()=>{this.radioGroups.populate(this.items)}))}},{key:"getRequestOpts",value:function(){const{getWidgetDependenceValueByWidget:e,getDependenceByWidget:t,extraOptsGetter:r}=this.options,n=e(this);return Object.assign({dependence:n,reload:BI.isNotEmptyArray(t(this))},r())}},{key:"setStyle",value:function(e){this.radioGroups.element.addClass(setRadioGroupStyle(ParameterRadioGroup_1.BASE_CLS,e))}},{key:"getText",value:function(){const e=BI.first(this.radioGroups.getAllButtons().filter((e=>e.isSelected())).map((e=>e.attr("text"))));return e||""}}])}();ParameterRadioGroup.xtype="report.main.parameter_container.controller.radio_group",ParameterRadioGroup.widgetType="radiogroup",ParameterRadioGroup.BASE_CLS="report-main-parameter-container-controller-radio-group",ParameterRadioGroup=ParameterRadioGroup_1=__decorate$C([shortcut()],ParameterRadioGroup);const ICON_MAX_SIZE=28,BASE_ICON_SIZE=14;function transformValue2Arr(e,t=",",r="",n=""){return BI.isArray(e)?e.map((e=>"".concat(e))):transformStr2ArrBySplitor(e,t,r,n)}function transformControlAttrs(e=[],t=[],r){const n=t.map((e=>"".concat(e)));return Array.from(e).filter((e=>!n.includes("".concat(e.value)))).map((e=>Object.assign(Object.assign({},r?BI.isFunction(r)?r(e):r:{}),{text:"".concat(e.text),value:"".concat(e.value),title:"".concat(e.text)})))}function transformValue2TagComboNextValue(e,t,r,n,o,i,a){const s=preTransformValue2TagComboNextValue(e,r,n,i,a),l=t.slice(0);return s.forEach(((e,t)=>{const r=l.findIndex((t=>t.value===e));-1!==r&&(s[t]=l[r],l.splice(r,1))})),s.forEach(((e,t)=>{if(!BI.isString(e))return;const r=l.findIndex((t=>t.text===e));-1!==r?(s[t]=l[r],l.splice(r,1)):o&&(s[t]={text:e,value:e})})),s.filter((e=>!BI.isString(e)))}function preTransformValue2TagComboNextValue(e,t,r,n,o){return BI.isNull(e)||BI.isEmptyString(e)?[]:BI.isObject(e)&&"date_milliseconds"in e?[BI.print(BI.getDate(e.date_milliseconds),"%Y-%X-%d")]:transformValue2Arr(e,getSplitorByOpts(t,r),n,o)}function setTagComboCheckboxStyle(e,{opacity:t,background:r,color:n,border:o,"border-radius":i}){index.use(jssGlobal(),jssNested());const a="".concat(e,"-").concat(BI.UUID()),s=".".concat(a);return index.createStyleSheet({"@global":{["".concat(s)]:{opacity:t,background:r},["".concat(s," .bi-combo .bi-card")]:{background:r,color:n},["".concat(s," .bi-input")]:{color:n},["".concat(s," .bi-icon-button")]:{color:n},["".concat(s," .bi-border")]:{border:o,"boder-radius":i}}}).attach(),a}function setTagComboCheckboxPopupStyle(e,{fontSize:t,itemHeight:r}){index.use(jssGlobal(),jssNested());const n="".concat(e,"-").concat(BI.UUID()),o=".".concat(n),i=Math.min(parseInt(t,10),ICON_MAX_SIZE);return index.createStyleSheet({"@global":{["".concat(o," .bi-list-pane .bi-label")]:{"font-size":"".concat(t," !important")},["".concat(o," .bi-popup-view .bi-v-tape >.bi-v .bi-label")]:{"font-size":"".concat(t," !important")},["".concat(o," .checkbox-content")]:{width:"".concat(i,"px !important"),height:"".concat(i,"px !important")},["".concat(o," .checkbox-content:after")]:{top:"".concat(i/BASE_ICON_SIZE*6,"px !important"),left:"".concat(i/BASE_ICON_SIZE*2,"px !important"),width:"".concat(i/BASE_ICON_SIZE*6,"px !important"),height:"".concat(i/BASE_ICON_SIZE*9,"px !important")},["".concat(o," .bi-popup-view .bi-half-button")]:{width:"".concat(i,"px !important"),height:"".concat(i,"px !important")},["".concat(o," .bi-list-pane .bi-tips")]:{"font-size":"".concat(t," !important"),height:"".concat(r," !important"),"line-height":"".concat(r," !important")}}}).attach(),n}function _classCallCheck$1q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1p(n.key),n)}}function _createClass$1q(e,t,r){return t&&_defineProperties$1p(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1p(e){var t=_toPrimitive$1p(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1p(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1c(e,t,r){return t=_getPrototypeOf$1c(t),_possibleConstructorReturn$1c(e,_isNativeReflectConstruct$1c()?Reflect.construct(t,r||[],_getPrototypeOf$1c(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1c(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1c(e)}function _assertThisInitialized$1c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1c(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1c=function(){return!!e})()}function _getPrototypeOf$1c(e){return(_getPrototypeOf$1c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1c(e,t)}function _setPrototypeOf$1c(e,t){return(_setPrototypeOf$1c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __decorate$B=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterMultiSelectPopup_1;let ParameterMultiSelectPopup=ParameterMultiSelectPopup_1=function(e){function t(){var e;return _classCallCheck$1q(this,t),(e=_callSuper$1c(this,t,arguments)).props={itemsCreator:BI.emptyFn,keywordGetter:()=>{},valueGetter:void 0,unmatchedValueGetter:()=>[],itemHeightGetter:()=>24,minWidth:135,maxHeight:400,height:96,value:[],customData:!0,repopulateGetter:()=>!1,showSelectAll:!0,isBackendPagination:!1},e.unmatchedValues=[],e.values=[],e.hasNext=!1,e.dirtyItemButNotInView=new Map,e}return _inherits$1c(t,BI.Widget),_createClass$1q(t,[{key:"render",value:function(){const{itemsCreator:e,itemHeightGetter:t,keywordGetter:r,value:n,isBackendPagination:o}=this.options;let i=!1,a=1;this.values=n.slice(0);const s=t();return{type:BI.VTapeLayout.xtype,ref:e=>{this.vtapeWrapper=e},items:[{el:{type:BI.VerticalLayout.xtype,scrolly:!1,items:[{type:BI.MultiSelectBar.xtype,ref:e=>{this.allSelectButton=e},cls:"bi-list-item-active",invisible:!0,height:s,iconWrapperWidth:Math.min(1.5*this.options.itemHeightGetter(),36),listeners:[{eventName:BI.MultiSelectBar.EVENT_CHANGE,action:t=>{t?this.setAllSelected():this.setAllUnselected(),this.isAllSelected=t,!o&&t&&!i&&this.hasNext?(i=!0,e({loadTotal:!0,times:a+1,keyword:r()},(e=>{this.hasNext=e.hasNext,e.items=this.transformItems(e.items),e.items.forEach((e=>{e.selected=!0}));const t=this.createItems(e.items);this.dirtyItemButNotInView=new Map(t.map((e=>[e.el.value,e]))),this.fireEvent(ParameterMultiSelectPopup_1.EVENT_SELECT_ALL,!0)}))):this.fireEvent(ParameterMultiSelectPopup_1.EVENT_SELECT_ALL,t)}}]},{type:BI.TextButton.xtype,ref:e=>{this.addTextBtn=e},invisible:!0,text:BI.i18nText("BI-Basic_Click_To_Add_Text",""),height:s,cls:"bi-high-light",hgap:5,handler:()=>{this.fireEvent(ParameterMultiSelectPopup_1.EVENET_ADD_ITEM,r(),r(),!0)}}]},height:s},{type:BI.ListPane.xtype,ref:e=>{this.pane=e;const t=this.pane.getAllButtons.bind(this.pane);this.pane.getAllButtons=()=>{return 0===this.dirtyItemButNotInView.size?t():t().concat(((e=Array.from(this.dirtyItemButNotInView.values())).forEach((e=>{e.isSelected=()=>!!e.el.selected,e.setSelected=t=>{e.el.selected=t},e.attr=()=>e.el.text,e.getValue=()=>e.el.value})),e));var e}},itemsCreator:(t,n)=>{a=t.times;const s=r();t.keyword=s,t.loadTotal=i&&this.hasNext,e(t,(e=>{this.hasNext=e.hasNext,e.items.forEach((e=>{const t=this.dirtyItemButNotInView.get(e.value);t&&(e.selected=t.isSelected(),this.dirtyItemButNotInView.delete(e.value))})),e.items=this.transformItems(e.items),n(this.createItems(e.items)),1===t.times&&this.resize(),this.isAllSelected&&o&&this.setAllSelected(),this.checkAllSelected()}))},el:{type:BI.Loader.xtype,ref:e=>{this.loader=e},el:{chooseType:BI.ButtonGroup.CHOOSE_TYPE_MULTI},layouts:[{type:BI.VerticalLayout.xtype,height:400,minHeight:400,scrolly:!0}]},hasNext:()=>this.hasNext,listeners:[{eventName:BI.ListPane.EVENT_CHANGE,action:()=>{this.checkAllSelected()}},{eventName:BI.Pane.EVENT_LOADED,action:()=>{this.fireEvent(ParameterMultiSelectPopup_1.EVENT_LOADED)}},{eventName:BI.Pane.EVENT_LOADING,action:()=>{this.fireEvent(ParameterMultiSelectPopup_1.EVENT_LOADING)}}]},{el:{type:BI.ButtonGroup.xtype,cls:"list-view-toolbar bi-high-light bi-split-top",items:BI.createItems([{text:BI.i18nText("BI-Basic_Clears"),handler:()=>{this.fireEvent(ParameterMultiSelectPopup_1.EVENT_CLEAR)}},{text:BI.i18nText("BI-Basic_Sure"),handler:()=>{this.fireEvent(ParameterMultiSelectPopup_1.EVENT_CONFIRM)}}],{type:BI.TextButton.xtype,once:!1,shadow:!0,isShadowShowingOnSelected:!0}),layouts:[{type:BI.CenterLayout.xtype,hgap:0,vgap:0}]},height:s}]}}},{key:"transformItems",value:function(e){let t=0;for(;t<this.unmatchedValues.length;){const r=this.unmatchedValues[t],n=e.findIndex((e=>e.text===r.text&&e.value===r.value));-1!==n?(e.splice(n,1),this.unmatchedValues.splice(t,1)):t+=1}this.values.length>0&&e.forEach((e=>{const t=this.values.findIndex((t=>e.text===t.text&&e.value===t.value));-1!==t&&(e.selected=!0,this.values.splice(t,1))}));const r=this.values.map((e=>Object.assign(Object.assign({},e),{selected:!0})));return this.unmatchedValues=this.unmatchedValues.concat(this.values),this.values=[],e.concat(r)}},{key:"resize",value:function(){const{itemHeightGetter:e,keywordGetter:t,showSelectAll:r}=this.options,n=e();BI.nextTick((()=>{const e=BI.size(this.getAllButtons()),o=e>0,i=r&&o;this.allSelectButton.setVisible(i),this.pane.setTipVisible(!o);const a=t(),s=!t(),l=this.vtapeWrapper.attr("items")[0];if(a){const e=i||this.addTextBtn.isVisible();return l.height=e?n:0,void this.vtapeWrapper.resize()}if(s){const t=BI.clamp(e*n,n,1/0),r=i?n:0,o=n;let a=0;return a+=r,a+=t,a+=this.loader.next.isVisible()?n:0,a+=o,a=BI.clamp(a,0,this.options.maxHeight),l.height=r,this.vtapeWrapper.element.css("height",a),this.vtapeWrapper.resize(),void this.fireEvent(ParameterMultiSelectPopup_1.EVENT_RESIZE)}}))}},{key:"getValue",value:function(){const e=this.pane.getAllButtons();return BI.isEmptyArray(e)?this.values:e.filter((e=>e.isSelected())).map((e=>({text:e.attr("text"),value:e.getValue()})))}},{key:"getAllLeaves",value:function(){return this.pane.getAllButtons().map((e=>({text:e.attr("text"),value:e.getValue()})))}},{key:"populate",value:function(){this.pane.populate()}},{key:"setAllSelected",value:function(){this.pane.getAllButtons().forEach((e=>{e.setSelected(!0)}))}},{key:"setAllUnselected",value:function(){this.pane.getAllButtons().forEach((e=>{e.setSelected(!1)}))}},{key:"createItems",value:function(e){return BI.createItems(e,{type:BI.MultiSelectItem.xtype,cls:"bi-list-item-active",iconWrapperWidth:Math.min(1.5*this.options.itemHeightGetter(),36),height:this.options.itemHeightGetter(),keyword:this.options.keywordGetter(),listeners:[{eventName:BI.MultiSelectItem.EVENT_CHANGE,action:(e,t)=>{this.fireEvent(ParameterMultiSelectPopup_1.EVENT_CHANGE,t.attr("text"),e,t.isSelected())}}]})}},{key:"checkAllSelected",value:function(){if(!this.options.showSelectAll)return;const e=this.pane.getAllButtons().every((e=>e.isSelected())),t=(this.options.isBackendPagination||!this.hasNext)&&e;if(this.isAllSelected=t,t)return void this.allSelectButton.setSelected(!0);this.pane.getAllButtons().every((e=>!e.isSelected()))?this.allSelectButton.setSelected(!1):this.allSelectButton.setHalfSelected(!0)}},{key:"switchState",value:function(e,t,r){const n=!!BI.isNull(r)||r,o=this.pane.getAllButtons().find((o=>o.attr("text")===e&&o.getValue()===t&&(!BI.isNotNull(r)||o.isSelected()===!n)));o?o.setSelected(n):(this.pane.addItems(this.createItems([{text:e,value:t,selected:n}])),this.unmatchedValues.push({text:e,value:t})),this.resize(),this.checkAllSelected(),this.fireEvent(ParameterMultiSelectPopup_1.EVENT_SWITCH_STATE)}},{key:"switchStates",value:function(e,t){const r=e.slice(0);this.options.repopulateGetter()||this.pane.getAllButtons().forEach((e=>{const n=r.findIndex((({text:t,value:r})=>e.attr("text")===t&&e.getValue()===r));-1!==n&&(e.setSelected(t),r.splice(n,1))})),BI.size(r)>0&&(r.forEach((e=>{e.selected=t})),this.pane.addItems(this.createItems(r)),this.options.repopulateGetter()?r.forEach((e=>{this.values.some((t=>t.text===e.text&&t.value===e.value))||this.values.push(e)})):this.unmatchedValues=this.unmatchedValues.concat(r)),this.checkAllSelected(),this.fireEvent(ParameterMultiSelectPopup_1.EVENT_SWITCH_STATE)}},{key:"setValue",value:function(e){this.setAllUnselected(),this.switchStates(e,!0)}},{key:"getUnmatchedValues",value:function(){return this.unmatchedValues}},{key:"getAllButtons",value:function(){return this.pane.getAllButtons()}},{key:"resetState",value:function(){this.unmatchedValues=[],this.values=[],this.hasNext=!1}},{key:"emptySearchPane",value:function(){this.loader.empty(),this.pane.empty()}}])}();function _classCallCheck$1p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1o(n.key),n)}}function _createClass$1p(e,t,r){return t&&_defineProperties$1o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1o(e){var t=_toPrimitive$1o(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1o(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1b(e,t,r){return t=_getPrototypeOf$1b(t),_possibleConstructorReturn$1b(e,_isNativeReflectConstruct$1b()?Reflect.construct(t,r||[],_getPrototypeOf$1b(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1b(e)}function _assertThisInitialized$1b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1b=function(){return!!e})()}function _getPrototypeOf$1b(e){return(_getPrototypeOf$1b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1b(e,t)}function _setPrototypeOf$1b(e,t){return(_setPrototypeOf$1b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterMultiSelectPopup.xtype="report-multi-select-popup",ParameterMultiSelectPopup.EVENT_CHANGE="EVENT_CHANGE",ParameterMultiSelectPopup.EVENT_CONFIRM="EVENT_CONFIRM",ParameterMultiSelectPopup.EVENT_CLEAR="EVENT_CLEAR",ParameterMultiSelectPopup.EVENT_SELECT_ALL="EVENT_SELECT_ALL",ParameterMultiSelectPopup.EVENET_ADD_ITEM="EVENET_ADD_ITEM",ParameterMultiSelectPopup.EVENT_SWITCH_STATE="EVENT_SWITCH_STATE",ParameterMultiSelectPopup.EVENT_RESIZE="EVENT_RESIZE",ParameterMultiSelectPopup.EVENT_LOADED="EVENT_LOADED",ParameterMultiSelectPopup.EVENT_LOADING="EVENT_LOADING",ParameterMultiSelectPopup=ParameterMultiSelectPopup_1=__decorate$B([shortcut()],ParameterMultiSelectPopup);var __decorate$A=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ParameterMultiSelectSearchPopup=function(e){function t(){var e;return _classCallCheck$1p(this,t),(e=_callSuper$1b(this,t,arguments)).props={itemsCreator:BI.emptyFn,keywordGetter:()=>{},valueGetter:()=>[],unmatchedValueGetter:()=>[],itemHeightGetter:()=>24,minWidth:135,maxHeight:400,height:void 0,value:[],customData:!0,showSelectAll:!0,repopulateGetter:()=>!1,isBackendPagination:!1},e}return _inherits$1b(t,ParameterMultiSelectPopup),_createClass$1p(t,[{key:"transformItems",value:function(e){const{valueGetter:t,unmatchedValueGetter:r,keywordGetter:n,customData:o}=this.options,i=n()||"",a=r().slice(0),s=t();e.forEach((e=>{const t=s.findIndex((t=>t.text===e.text&&t.value===e.value));e.selected=-1!==t,e.selected&&s.splice(t,1);const r=a.findIndex((t=>t.text===e.text&&t.value===e.value));-1!==r&&a.splice(r,1)})),a.forEach((e=>{const t=s.findIndex((t=>t.text===e.text&&t.value===e.value));e.selected=-1!==t,e.selected&&s.splice(t,1)}));const{match:l,find:c}=BI.Func.getSearchResult(a,i,"value"),u=c.concat(e,l);return 0===BI.size(u)&&o?(this.addTextBtn.setText(BI.i18nText("BI-Basic_Click_To_Add_Text",n())),this.addTextBtn.visible()):this.addTextBtn.invisible(),l.concat(e,c)}}])}();function _classCallCheck$1o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1n(n.key),n)}}function _createClass$1o(e,t,r){return t&&_defineProperties$1n(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1n(e){var t=_toPrimitive$1n(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1n(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$1a(e,t,r){return t=_getPrototypeOf$1a(t),_possibleConstructorReturn$1a(e,_isNativeReflectConstruct$1a()?Reflect.construct(t,r||[],_getPrototypeOf$1a(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1a(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1a(e)}function _assertThisInitialized$1a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1a=function(){return!!e})()}function _getPrototypeOf$1a(e){return(_getPrototypeOf$1a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1a(e,t)}function _setPrototypeOf$1a(e,t){return(_setPrototypeOf$1a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterMultiSelectSearchPopup.xtype="report-multi-select-search-popup",ParameterMultiSelectSearchPopup=__decorate$A([shortcut()],ParameterMultiSelectSearchPopup);var __decorate$z=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterMultiSelectTrigger_1;let ParameterMultiSelectTrigger=ParameterMultiSelectTrigger_1=function(e){function t(){var e;return _classCallCheck$1o(this,t),(e=_callSuper$1a(this,t,arguments)).props={baseCls:"bi-search-text-value-trigger bi-border bi-focus-shadow",height:24,itemsCreator:BI.emptyFn,valueGetter:()=>[],unmatchedValueGetter:()=>[],watermark:"",allowEdit:!1,itemHeightGetter:()=>24,customData:!0,showSelectAll:!0,value:[]},e}return _inherits$1a(t,BI.Trigger),_createClass$1o(t,[{key:"render",value:function(){const{height:e,itemsCreator:t,valueGetter:r,watermark:n,unmatchedValueGetter:o,customData:i,itemHeightGetter:a,showSelectAll:s}=this.options;return{type:BI.HTapeLayout.xtype,ref:e=>{this.wrapper=e},items:[{el:{type:BI.Searcher.xtype,ref:e=>{this.searcher=e},isAutoSearch:!1,el:{type:BI.SignEditor.xtype,ref:e=>{this.editor=e},value:this.joinValues(r()),allowBlank:!0,watermark:n,height:e,listeners:[{eventName:BI.SignEditor.EVENT_FOCUS,action:()=>{this.editor.setValue(""),this.fireEvent(ParameterMultiSelectTrigger_1.EVENT_FOCUS)}},{eventName:BI.SignEditor.EVENT_BLUR,action:()=>{this.fireEvent(ParameterMultiSelectTrigger_1.EVENT_BLUR)}},{eventName:BI.SignEditor.EVENT_CLICK,action:()=>{this.fireEvent(ParameterMultiSelectTrigger_1.EVENT_CLICK)}}]},popup:{type:ParameterMultiSelectSearchPopup.xtype,itemHeightGetter:a,customData:i,showSelectAll:s,cls:"bi-card",ref:e=>{this.popup=e},keywordGetter:()=>this.editor.getValue(),unmatchedValueGetter:o,itemsCreator:t,valueGetter:r,listeners:[{eventName:ParameterMultiSelectPopup.EVENT_CHANGE,action:(e,t,r)=>{this.fireEvent(ParameterMultiSelectTrigger_1.EVENT_CHANGE,e,t,r)}},{eventName:ParameterMultiSelectPopup.EVENET_ADD_ITEM,action:(e,t,r)=>{this.fireEvent(ParameterMultiSelectTrigger_1.EVENT_CHANGE,e,t,r),this.searcher.stopSearch()}},{eventName:ParameterMultiSelectPopup.EVENT_CONFIRM,action:()=>{this.fireEvent(ParameterMultiSelectTrigger_1.EVENT_CONFIRM)}},{eventName:ParameterMultiSelectPopup.EVENT_CLEAR,action:()=>{this.fireEvent(ParameterMultiSelectTrigger_1.EVENT_CLEAR)}},{eventName:ParameterMultiSelectPopup.EVENT_SELECT_ALL,action:e=>{this.fireEvent(ParameterMultiSelectTrigger_1.EVENT_SELECT_ALL,e,this.popup.getAllLeaves())}}]},onSearch:(e,t)=>{t(),this.popup.emptySearchPane()},listeners:[{eventName:BI.Searcher.EVENT_CHANGE,action:()=>{}},{eventName:BI.Searcher.EVENT_START,action:()=>{this.fireEvent(ParameterMultiSelectTrigger_1.EVENT_START)}},{eventName:BI.Searcher.EVENT_SEARCHING,action:()=>{this.fireEvent(ParameterMultiSelectTrigger_1.EVENT_SEARCHING)}},{eventName:BI.Searcher.EVENT_STOP,action:()=>{this.fireEvent(ParameterMultiSelectTrigger_1.EVENT_STOP)}}]}},{el:{type:BI.Layout.xtype},width:0},{el:{type:BI.Layout.xtype,width:24},width:24}]}}},{key:"mounted",value:function(){!this.options.allowEdit&&BI.createWidget({type:BI.AbsoluteLayout.xtype,element:this,items:[{el:{type:BI.Text.xtype,title:()=>this.editor.getValue()},left:0,right:24,top:0,bottom:0}]}),BI.EventListener.listen(this.element[0],"keydown",(e=>{if("Enter"===e.key&&this.popup){const e=this.editor.getValue();this.fireEvent(ParameterMultiSelectTrigger_1.EVENT_KEY_DOWN_ENTER,e)}}))}},{key:"focus",value:function(){this.editor.focus()}},{key:"blur",value:function(){this.editor.blur()}},{key:"setValue",value:function(e){this.editor.setValue(this.joinValues(e))}},{key:"isSearching",value:function(){return this.searcher.isSearching()}},{key:"stopEditing",value:function(){this.searcher.stopSearch()}},{key:"getSearcher",value:function(){return this.searcher}},{key:"getValue",value:function(){return this.popup.getValue()}},{key:"setAdapter",value:function(e){this.searcher.setAdapter(e)}},{key:"adjustPopupHeight",value:function(e){this.setAdapter(e),this.searcher.populate(),this.searcher.adjustHeight()}},{key:"joinValues",value:function(e){return e.map((e=>e.text)).join(",")}},{key:"refreshPlaceHolderWidth",value:function(e){this.wrapper.attr("items")[1].width=e,this.wrapper.resize()}},{key:"setText",value:function(e){this.editor.setValue(e)}},{key:"setWaterMark",value:function(e){this.editor.setWaterMark(e)}}])}();function _classCallCheck$1n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1m(n.key),n)}}function _createClass$1n(e,t,r){return t&&_defineProperties$1m(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1m(e){var t=_toPrimitive$1m(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1m(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$19(e,t,r){return t=_getPrototypeOf$19(t),_possibleConstructorReturn$19(e,_isNativeReflectConstruct$19()?Reflect.construct(t,r||[],_getPrototypeOf$19(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$19(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$19(e)}function _assertThisInitialized$19(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$19(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$19=function(){return!!e})()}function _getPrototypeOf$19(e){return(_getPrototypeOf$19=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$19(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$19(e,t)}function _setPrototypeOf$19(e,t){return(_setPrototypeOf$19=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterMultiSelectTrigger.EVENT_SEARCHING="EVENT_SEARCHING",ParameterMultiSelectTrigger.EVENT_STOP="EVENT_STOP",ParameterMultiSelectTrigger.EVENT_START="EVENT_START",ParameterMultiSelectTrigger.EVENT_CHANGE="EVENT_CHANGE",ParameterMultiSelectTrigger.EVENT_FOCUS="EVENT_FOCUS",ParameterMultiSelectTrigger.EVENT_BLUR="EVENT_BLUR",ParameterMultiSelectTrigger.EVENT_CONFIRM="EVENT_CONFIRM",ParameterMultiSelectTrigger.EVENT_SELECT_ALL="EVENT_SELECT_ALL",ParameterMultiSelectTrigger.EVENT_CLEAR="EVENT_CLEAR",ParameterMultiSelectTrigger.xtype="report.search_text_value_trigger",ParameterMultiSelectTrigger.EVENT_CLICK="EVENT_CLICK",ParameterMultiSelectTrigger.EVENT_KEY_DOWN_ENTER="EVENT_KEY_DOWN_ENTER",ParameterMultiSelectTrigger=ParameterMultiSelectTrigger_1=__decorate$z([shortcut()],ParameterMultiSelectTrigger);var __decorate$y=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterMultiSelectCheckButton_1;let ParameterMultiSelectCheckButton=ParameterMultiSelectCheckButton_1=function(e){function t(){var e;return _classCallCheck$1n(this,t),(e=_callSuper$19(this,t,arguments)).props={baseCls:"bi-multi-select-check-selected-button",valueGetter:()=>[]},e}return _inherits$19(t,BI.Widget),_createClass$1n(t,[{key:"render",value:function(){return{type:BI.TextButton.xtype,ref:e=>{this.numberCounter=e},hgap:4,text:"0",textAlign:"center",textHeight:16,cls:"bi-high-light-background count-tip",listeners:[{eventName:"EVENT_CHANGE",action:()=>{this.fireEvent(ParameterMultiSelectCheckButton_1.EVENT_CHANGE)}}]}}},{key:"mounted",value:function(){this.numberCounter.element.hover((()=>{this.numberCounter.setTag(this.numberCounter.getText()),this.numberCounter.setText(BI.i18nText("BI-Check_Selected"))}),(()=>{this.numberCounter.setText(this.numberCounter.getTag())})),this.updateValue()}},{key:"updateValue",value:function(){const e=this.options.valueGetter().length;this.numberCounter.setText("".concat(e)),this.setVisible(e>0)}}])}();function _classCallCheck$1m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1l(n.key),n)}}function _createClass$1m(e,t,r){return t&&_defineProperties$1l(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1l(e){var t=_toPrimitive$1l(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1l(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$18(e,t,r){return t=_getPrototypeOf$18(t),_possibleConstructorReturn$18(e,_isNativeReflectConstruct$18()?Reflect.construct(t,r||[],_getPrototypeOf$18(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$18(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$18(e)}function _assertThisInitialized$18(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$18(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$18=function(){return!!e})()}function _getPrototypeOf$18(e){return(_getPrototypeOf$18=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$18(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$18(e,t)}function _setPrototypeOf$18(e,t){return(_setPrototypeOf$18=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterMultiSelectCheckButton.xtype="report-multi-select-check-button",ParameterMultiSelectCheckButton.EVENT_CHANGE="EVENT_CHANGE",ParameterMultiSelectCheckButton=ParameterMultiSelectCheckButton_1=__decorate$y([shortcut()],ParameterMultiSelectCheckButton);var __decorate$x=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterMultiSelectCheckPane_1;let ParameterMultiSelectCheckPane=ParameterMultiSelectCheckPane_1=function(e){function t(){var e;return _classCallCheck$1m(this,t),(e=_callSuper$18(this,t,arguments)).props={baseCls:"bi-multi-select-check-pane bi-background",valueGetter:()=>[],items:[],itemHeightGetter:()=>24},e}return _inherits$18(t,BI.Widget),_createClass$1m(t,[{key:"render",value:function(){const{items:e}=this.options;return{type:BI.VTapeLayout.xtype,items:[{height:12,el:{type:BI.VerticalAdaptLayout.xtype,columnSize:["auto","auto"],cls:"multi-select-continue-select",items:[{el:{type:BI.Label.xtype,title:BI.i18nText("BI-Selected_Data"),text:BI.i18nText("BI-Selected_Data")},lgap:10},{el:{type:BI.TextButton.xtype,title:BI.i18nText("BI-Continue_Select"),text:BI.i18nText("BI-Continue_Select"),cls:"multi-select-check-selected bi-high-light",listeners:[{eventName:BI.TextButton.EVENT_CHANGE,action:()=>{this.fireEvent(ParameterMultiSelectCheckPane_1.EVENT_CHANGE)}}]},lgap:10}]},tgap:10},{el:{type:BI.ListPane.xtype,ref:e=>{this.pane=e},el:{type:BI.Loader.xtype,el:{chooseType:BI.ButtonGroup.CHOOSE_TYPE_MULTI},layouts:[{type:BI.VerticalLayout.xtype,lgap:10}],items:this.createItems(e)},baseCls:"bi-display-list"},tgap:5}]}}},{key:"createItems",value:function(e){return BI.createItems(e,{type:BI.IconTextItem.xtype,cls:"cursor-default check-font icon-size-12 display-list-item bi-tips",once:!0,invalid:!0,selected:!0,height:this.options.itemHeightGetter(),logic:{dynamic:!0}})}},{key:"updateValue",value:function(){const e=this.options.valueGetter();this.pane.populate(this.createItems(e))}}])}();function _classCallCheck$1l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1k(n.key),n)}}function _createClass$1l(e,t,r){return t&&_defineProperties$1k(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1k(e){var t=_toPrimitive$1k(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1k(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$17(e,t,r){return t=_getPrototypeOf$17(t),_possibleConstructorReturn$17(e,_isNativeReflectConstruct$17()?Reflect.construct(t,r||[],_getPrototypeOf$17(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$17(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$17(e)}function _assertThisInitialized$17(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$17(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$17=function(){return!!e})()}function _getPrototypeOf$17(e){return(_getPrototypeOf$17=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$17(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$17(e,t)}function _setPrototypeOf$17(e,t){return(_setPrototypeOf$17=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterMultiSelectCheckPane.xtype="report-multi-select-check-pane",ParameterMultiSelectCheckPane.EVENT_CHANGE="EVENT_CHANGE",ParameterMultiSelectCheckPane=ParameterMultiSelectCheckPane_1=__decorate$x([shortcut()],ParameterMultiSelectCheckPane);var __decorate$w=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterMultiSelectSwitcher_1;let ParameterMultiSelectSwitcher=ParameterMultiSelectSwitcher_1=function(e){function t(){var e;return _classCallCheck$1l(this,t),(e=_callSuper$17(this,t,arguments)).props={baseCls:"bi-multi-select-check-selected-switcher",valueGetter:()=>[],popupGetter:()=>ParameterSingleSelectPopup,itemHeightGetter:()=>24},e.afterInit=!1,e.afterClick=!1,e}return _inherits$17(t,BI.Widget),_createClass$1l(t,[{key:"render",value:function(){const{valueGetter:e,itemHeightGetter:t}=this.options;return{type:BI.Switcher.xtype,ref:e=>{this.switcher=e},trigger:"",toggle:!1,el:{type:ParameterMultiSelectCheckButton.xtype,ref:e=>{this.checkButton=e},valueGetter:e,listeners:[{eventName:ParameterMultiSelectCheckButton.EVENT_CHANGE,action:()=>{this.afterClick=!0,this.afterInit&&this.showView(),this.fireEvent(ParameterMultiSelectSwitcher_1.EVENT_CHANGE)}},{eventName:BI.Events.VIEW,action:e=>{this.fireEvent(BI.Events.VIEW,e)}}]},popup:{type:ParameterMultiSelectCheckPane.xtype,ref:e=>{this.checkPane=e},valueGetter:e,itemHeightGetter:t,listeners:[{eventName:ParameterMultiSelectCheckPane.EVENT_CHANGE,action:()=>{this.switcher.hideView()}}]},listeners:[{eventName:BI.Switcher.EVENT_BEFORE_POPUPVIEW,action:()=>{this.fireEvent(ParameterMultiSelectSwitcher_1.EVENT_BEFORE_POPUPVIEW)}}]}}},{key:"setAdapter",value:function(e){this.switcher.setAdapter(e)}},{key:"showView",value:function(){this.switcher.showView()}},{key:"hideView",value:function(){this.switcher.hideView()}},{key:"updateValue",value:function(){this.checkPane&&this.checkPane.updateValue(),this.checkButton.updateValue()}},{key:"setValue",value:function(e){this.switcher.setValue(e),this.updateValue()}},{key:"initSwitcher",value:function(){this.afterInit||(this.setAdapter(this.options.popupGetter()),this.afterClick&&this.showView()),this.afterInit=!0}}])}();function _classCallCheck$1k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1j(n.key),n)}}function _createClass$1k(e,t,r){return t&&_defineProperties$1j(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1j(e){var t=_toPrimitive$1j(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1j(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$16(e,t,r){return t=_getPrototypeOf$16(t),_possibleConstructorReturn$16(e,_isNativeReflectConstruct$16()?Reflect.construct(t,r||[],_getPrototypeOf$16(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$16(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$16(e)}function _assertThisInitialized$16(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$16(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$16=function(){return!!e})()}function _getPrototypeOf$16(e){return(_getPrototypeOf$16=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$16(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$16(e,t)}function _setPrototypeOf$16(e,t){return(_setPrototypeOf$16=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterMultiSelectSwitcher.xtype="report-multi-select-switcher",ParameterMultiSelectSwitcher.EVENT_BEFORE_POPUPVIEW="EVENT_BEFORE_POPUPVIEW",ParameterMultiSelectSwitcher.EVENT_CHANGE="EVENT_CHANGE",ParameterMultiSelectSwitcher=ParameterMultiSelectSwitcher_1=__decorate$w([shortcut()],ParameterMultiSelectSwitcher);var __decorate$v=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterMultiSelectCombo_1;let ParameterMultiSelectCombo=ParameterMultiSelectCombo_1=function(e){function t(){var e;return _classCallCheck$1k(this,t),(e=_callSuper$16(this,t,arguments)).repopulate=!1,e.initialized=!1,e.needResize=!1,e.props={baseCls:"bi-search-text-value-combo",height:24,itemHeightGetter:()=>24,text:"",items:[],tipType:"",warningTitle:"",attributes:{tabIndex:0},title:"",value:[],itemsCreator:BI.emptyFn,watermark:"",allowEdit:!1,customData:!0,allowCount:!1,showSelectAll:!0,isBackendPagination:!1,maxPopupHeight:PopupMaxHeight},e}return _inherits$16(t,BI.Widget),_createClass$1k(t,[{key:"render",value:function(){const{height:e,value:t,text:r,tipType:n,warningTitle:o,title:i,itemsCreator:a,watermark:s,allowEdit:l,customData:c,itemHeightGetter:u,allowCount:d,showSelectAll:h,maxPopupHeight:p,isBackendPagination:f}=this.options;return{type:BI.AbsoluteLayout.xtype,scrollable:!1,items:[{el:{type:BI.Combo.xtype,adjustLength:2,toggle:!l,ref:e=>{this.combo=e},el:{type:ParameterMultiSelectTrigger.xtype,customData:c,watermark:s,allowEdit:l,cls:"search-text-value-trigger bi-border-radius",ref:e=>{this.trigger=e},height:e-2,text:r,value:t,tipType:n,warningTitle:o,showSelectAll:h,itemHeightGetter:u,itemsCreator:a,valueGetter:()=>this.popup?this.popup.getValue():t,unmatchedValueGetter:()=>this.popup?this.popup.getUnmatchedValues():t,title:i,listeners:[{eventName:ParameterMultiSelectTrigger.EVENT_CONFIRM,action:()=>{this.combo.hideView()}},{eventName:ParameterMultiSelectTrigger.EVENT_FOCUS,action:()=>{this.showView(),this.fireEvent(ParameterMultiSelectCombo_1.EVENT_BEFORE_EDIT)}},{eventName:ParameterMultiSelectTrigger.EVENT_CHANGE,action:(e,t,r)=>{this.popup.switchState(e,t,r),this.fireEvent(ParameterMultiSelectCombo_1.EVENT_CLICK_ITEM),this.fireEvent(ParameterMultiSelectCombo_1.EVENT_AFTER_EDIT)}},{eventName:ParameterMultiSelectTrigger.EVENT_SELECT_ALL,action:(e,t)=>{this.popup.switchStates(t,e),this.fireEvent(ParameterMultiSelectCombo_1.EVENT_AFTER_EDIT)}},{eventName:ParameterMultiSelectTrigger.EVENT_CLEAR,action:()=>{this.reset()}},{eventName:ParameterMultiSelectTrigger.EVENT_SEARCHING,action:()=>{this.fireEvent(ParameterMultiSelectCombo_1.EVENT_AFTER_EDIT)}},{eventName:ParameterMultiSelectTrigger.EVENT_BLUR,action:()=>{this.fireEvent(ParameterMultiSelectCombo_1.EVENT_BLUR)}},{eventName:ParameterMultiSelectTrigger.EVENT_CLICK,action:()=>{this.showView()}},{eventName:ParameterMultiSelectTrigger.EVENT_KEY_DOWN_ENTER,action:e=>{this.fireEvent(ParameterMultiSelectCombo_1.EVENT_KEY_DOWN_ENTER,e),this.combo.hideView()}}]},popup:{minWidth:135,el:{maxHeight:p,type:ParameterMultiSelectPopup.xtype,showSelectAll:h,itemHeightGetter:u,itemsCreator:a,isBackendPagination:f,ref:e=>{this.popup=e,this.trigger.setAdapter(this.popup)},repopulateGetter:()=>this.repopulate,listeners:[{eventName:ParameterMultiSelectPopup.EVENT_CHANGE,action:()=>{this.setStateValue(this.popup.getValue()),this.fireEvent(ParameterMultiSelectCombo_1.EVENT_CLICK_ITEM),this.fireEvent(ParameterMultiSelectCombo_1.EVENT_AFTER_EDIT)}},{eventName:ParameterMultiSelectPopup.EVENT_SELECT_ALL,action:e=>{e&&this.setValue(this.popup.getValue()),this.fireEvent(ParameterMultiSelectCombo_1.EVENT_SELECT_ALL,e),this.fireEvent(ParameterMultiSelectCombo_1.EVENT_AFTER_EDIT)}},{eventName:ParameterMultiSelectPopup.EVENT_CONFIRM,action:()=>{this.combo.hideView()}},{eventName:ParameterMultiSelectPopup.EVENT_CLEAR,action:()=>{this.reset(),this.combo.hideView()}},{eventName:ParameterMultiSelectPopup.EVENT_RESIZE,action:()=>{this.numberCounter.initSwitcher()}},{eventName:ParameterMultiSelectPopup.EVENT_SWITCH_STATE,action:()=>{this.numberCounter.updateValue()}},{eventName:ParameterMultiSelectPopup.EVENT_LOADED,action:()=>{this.initialized=!0,BI.nextTick((()=>{this.trigger.isSearching()&&this.trigger.adjustPopupHeight(this.popup)}))}},{eventName:ParameterMultiSelectPopup.EVENT_LOADING,action:()=>{this.initialized=!1}}]},value:t},listeners:[{eventName:BI.Combo.EVENT_AFTER_HIDEVIEW,action:()=>{const e=this.trigger.isSearching()?this.getAdapter().getKeyword():void 0;this.trigger.stopEditing(),this.numberCounter.hideView(),this.popup&&this.setStateValue(this.popup.getValue()),this.fireEvent(ParameterMultiSelectCombo_1.EVENT_CONFIRM,e)}},{eventName:BI.Combo.EVENT_BEFORE_POPUPVIEW,action:()=>{this.fireEvent(ParameterMultiSelectCombo_1.EVENT_BEFORE_POPUPVIEW),this.repopulate&&(this.populate([]),this.repopulate=!1)}},{eventName:BI.Combo.EVENT_AFTER_POPUPVIEW,action:()=>{this.checkResize()}}],hideChecker:e=>0===this.triggerBtn.element.find(e.target).length&&0===this.numberCounter.element.find(e.target).length},left:0,right:0,bottom:0,top:0},{el:{type:BI.TriggerIconButton.xtype,cls:"trigger-icon-button",ref:e=>{this.triggerBtn=e},width:e,height:e,handler:()=>{this.numberCounter.hideView(),this.combo.isViewVisible()?this.combo.hideView():(this.showView(),this.fireEvent(ParameterMultiSelectCombo_1.EVENT_BEFORE_EDIT))}},right:0,bottom:0,top:0},{el:{type:BI.VerticalAdaptLayout.xtype,invisible:!d,items:[{type:ParameterMultiSelectSwitcher.xtype,valueGetter:()=>this.popup?this.popup.getValue():this.options.value,popupGetter:()=>this.popup,itemHeightGetter:u,ref:e=>{this.numberCounter=e},listeners:[{eventName:ParameterMultiSelectSwitcher.EVENT_CHANGE,action:()=>{this.combo.isViewVisible()||this.combo.showView()}},{eventName:ParameterMultiSelectSwitcher.EVENT_BEFORE_POPUPVIEW,action:()=>{this.numberCounter.updateValue()}},{eventName:BI.Events.VIEW,action:e=>{BI.nextTick((()=>{e&&this.trigger.refreshPlaceHolderWidth(1.5*this.numberCounter.element.outerWidth())}))}}]}]},height:e,top:0,right:24}]}}},{key:"reset",value:function(){this.popup&&this.popup.setAllUnselected(),this.setValue([]),this.popup&&this.popup.checkAllSelected()}},{key:"showView",value:function(){this.combo.showView()}},{key:"isViewVisible",value:function(){return this.combo.isViewVisible()}},{key:"checkResize",value:function(){this.popup&&this.needResize&&(this.popup.resize(),this.needResize=!1)}},{key:"populate",value:function(e){this.options.items=e,this.combo.populate()}},{key:"setStateValue",value:function(e=[]){this.options.value=e,this.trigger.setValue(e),this.numberCounter.setValue(e)}},{key:"setValue",value:function(e=[]){this.options.value=e,this.combo.setValue(e),this.numberCounter.setValue(e)}},{key:"getValue",value:function(){return this.popup?this.popup.getValue():this.options.value}},{key:"setRepopulate",value:function(e){this.reset(),this.popup&&this.popup.resetState(),this.popup&&this.initialized&&(this.combo.isViewVisible()?this.combo.populate():this.repopulate=e,this.needResize=!0)}},{key:"focus",value:function(){this.trigger.focus(),this.combo.showView(),this.checkResize()}},{key:"blur",value:function(){this.trigger.blur(),this.combo.hideView()}},{key:"getAllButtons",value:function(){return this.popup.getAllButtons()}},{key:"getAdapter",value:function(){return this.trigger.getSearcher()}},{key:"setText",value:function(e){this.trigger.setText(e)}},{key:"addValue",value:function(e,t){this.popup.switchState(e,t),this.combo.isViewVisible()||(this.needResize=!0)}},{key:"setWaterMark",value:function(e){this.trigger.setWaterMark(e)}}])}();function _classCallCheck$1j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1i(n.key),n)}}function _createClass$1j(e,t,r){return t&&_defineProperties$1i(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1i(e){var t=_toPrimitive$1i(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1i(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$15(e,t,r){return t=_getPrototypeOf$15(t),_possibleConstructorReturn$15(e,_isNativeReflectConstruct$15()?Reflect.construct(t,r||[],_getPrototypeOf$15(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$15(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$15(e)}function _assertThisInitialized$15(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$15(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$15=function(){return!!e})()}function _superPropGet$d(e,t,r,n){var o=_get$d(_getPrototypeOf$15(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$d(){return _get$d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$d(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$d.apply(null,arguments)}function _superPropBase$d(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$15(e)););return e}function _getPrototypeOf$15(e){return(_getPrototypeOf$15=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$15(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$15(e,t)}function _setPrototypeOf$15(e,t){return(_setPrototypeOf$15=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterMultiSelectCombo.EVENT_CHANGE="EVENT_CHANGE",ParameterMultiSelectCombo.EVENT_BEFORE_POPUPVIEW="EVENT_BEFORE_POPUPVIEW",ParameterMultiSelectCombo.EVENT_CONFIRM="EVENT_CONFIRM",ParameterMultiSelectCombo.xtype="report.search_text_value_combo",ParameterMultiSelectCombo.EVENT_BEFORE_EDIT="EVENT_BEFORE_EDIT",ParameterMultiSelectCombo.EVENT_AFTER_EDIT="EVENT_AFTER_EDIT",ParameterMultiSelectCombo.EVENT_SELECT_ALL="EVENT_SELECT_ALL",ParameterMultiSelectCombo.EVENT_CLICK_ITEM="EVENT_CLICK_ITEM",ParameterMultiSelectCombo.EVENT_BLUR="EVENT_BLUR",ParameterMultiSelectCombo.EVENT_KEY_DOWN_ENTER="EVENT_KEY_DOWN_ENTER",ParameterMultiSelectCombo=ParameterMultiSelectCombo_1=__decorate$v([shortcut()],ParameterMultiSelectCombo);var __decorate$u=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterTagComboCheckboxNext_1;let ParameterTagComboCheckboxNext=ParameterTagComboCheckboxNext_1=function(e){function t(){var e;return _classCallCheck$1j(this,t),(e=_callSuper$15(this,t,arguments)).props={baseCls:ParameterTagComboCheckboxNext_1.BASE_CLS,$testId:"report-main-parameter-container-controller-tag-combo-checkbox",width:WIDTH,height:HEIGHT,watermark:"",value:"",fontSize:12,needSubmit:!1,disabled:!1,invisible:!1,allowBlank:!0,errorMsg:BI.i18nText("Fine-Report_Preview_Can_Not_Null"),controlAttr:{data:[],value:""},customData:!0,needCheckCustomData:!0,directEdit:!0,noRepeat:!0,autoMode:!0,mode:"remote",searchTime:200,widgetName:"",delimiter:"",supportTag:!0,returnArray:!0,startSymbol:"",endSymbol:"",getDependenceByWidget:()=>[],getWidgetDependenceValueByWidget:()=>({}),add2WaitingQueue:()=>"",removeFromWaitingQueue:()=>{},allowCount:!1,controlAttrFetcher:fetchParamControlAttr,extraOptsGetter:()=>({}),viewValueFetcher:fetchWidgetViewValue,allowBg:!0,sonHeight:24,showSelectAll:!0,maxPopupHeight:PopupMaxHeight,itemLimitCount:LimitCount},e.ratio=2,e.waitCtrlAttrFetch=null,e}return _inherits$15(t,AbstractParameterControllerWidget),_createClass$1j(t,[{key:"editComp",get:function(){return this.combo}},{key:"startWaitingForCtrlAttrFetch",value:function(){let e=BI.emptyFn;return this.waitCtrlAttrFetch=new Promise((t=>e=t)),()=>{e(),this.waitCtrlAttrFetch=null}}},{key:"runAfterCtrlAttrFetch",value:function(e){null!==this.waitCtrlAttrFetch?this.waitCtrlAttrFetch.then(e):e()}},{key:"render",value:function(){const{width:e,height:t,value:r,watermark:n,fontSize:o,widgetName:i,controlAttr:a,customData:s,directEdit:l,delimiter:c,returnArray:u,allowCount:d,controlAttrFetcher:h,allowBg:p,startSymbol:f,endSymbol:g,showSelectAll:m,maxPopupHeight:y,itemLimitCount:v}=this.options;return{type:ParameterMultiSelectCombo.xtype,cls:"".concat(setComboFontSize(ParameterTagComboCheckboxNext_1.BASE_CLS,{width:e,height:t,fontSize:o})," ").concat(p?"bi-card":""),ref:e=>{this.combo=e},allowEdit:l,allowCount:d,showSelectAll:m,maxPopupHeight:y,itemHeightGetter:()=>this.options.sonHeight,itemsCreator:(e,t)=>{const r=e.loadTotal?this.startWaitingForCtrlAttrFetch():BI.emptyFn;h(i,Object.assign(Object.assign({startIndex:v*(e.times-1),limitIndex:e.loadTotal?0:v},e.keyword?{filter:e.keyword}:{}),this.getRequestOpts())).then((n=>{const o=transformControlAttrData(n);this.options.controlAttr.data=(this.options.controlAttr.data||[]).concat(o),t({items:transformControlAttrs(o,[],{$testId:"report-main-parameter-container-controller-tag-combo-checkbox-item"}),hasNext:!e.loadTotal&&n.length>=v}),r()}))},width:e,height:t,value:transformValue2TagComboNextValue(r,transformControlAttrData(a.data),c,u,!0,f,g),watermark:n,customData:s,listeners:[{eventName:ParameterMultiSelectCombo.EVENT_CONFIRM,action:()=>{const e=!(!this.silence&&this.fireEvent("stopedit")),t=!BI.isEqual(this.getValue(),this.valueBeforeEdit);!e&&t&&this.runAfterCtrlAttrFetch((()=>this.fireEvent(ParameterTagComboCheckboxNext_1.EVENT_CHANGE)))}},{eventName:ParameterMultiSelectCombo.EVENT_BEFORE_EDIT,action:()=>{this.hideBubble(),this.valueBeforeEdit=BI.deepClone(this.getValue()),!this.silence&&this.fireEvent("beforeedit")}},{eventName:ParameterMultiSelectCombo.EVENT_AFTER_EDIT,action:()=>{!this.silence&&this.fireEvent("afteredit")}},{eventName:ParameterMultiSelectCombo.EVENT_CLICK_ITEM,action:()=>{this.hideBubble(),!this.silence&&this.fireEvent("click")}}]}}},{key:"mounted",value:function(){_superPropGet$d(t,"mounted",this)([]);const{fontSize:e}=this.options;this.setPopupStyle({fontSize:"".concat(e,"px"),itemHeight:"".concat(e*this.ratio,"px")})}},{key:"updateControllAttrByValue",value:async function(e,t){const{delimiter:r,returnArray:n,customData:o,add2WaitingQueue:i,removeFromWaitingQueue:a,widgetName:s,viewValueFetcher:l,startSymbol:c,endSymbol:u}=this.options;if(!t||BI.isEmptyArray(t)){const t=[],d=i();for(const i of preTransformValue2TagComboNextValue(e,r,n,c,u)){const e=await fetchParamViewValue(s,o,l,Object.assign({__text__:i},this.getRequestOpts()));BI.isNull(e)?o&&t.push({text:"".concat(i),value:"".concat(i)}):t.push(e),this.options.controlAttr.data=(this.options.controlAttr.data||[]).concat(t||[])}return a(d),t}return BI.isArray(t)&&(this.options.controlAttr.data=(this.options.controlAttr.data||[]).concat(t)),transformValue2TagComboNextValue(e,transformControlAttrData(t),r,n,o,c,u)}},{key:"setControllerValue",value:async function(e,t){this.combo.setValue(await this.updateControllAttrByValue(e,t))}},{key:"setValue",value:function(e,t){return this.setControllerValue(e,t).then((()=>{this.fireEvent("EVENT_SET_VALUE"),!this.silence&&t&&this.fireEvent("afteredit")}))}},{key:"preGetValidation",value:function(){const{allowBlank:e,value:t,errorMsg:r}=this.options;return e||!BI.isEmpty(t)?{result:!0}:{result:!1,errorMsg:r}}},{key:"validateCustomData",value:function(){const{controlAttr:e}=this.options,t=this.combo.getValue(),r=transformControlAttrData(e.data);if(BI.isEmptyArray(t))return!0;return t.every((e=>r.some((t=>e.text===t.text&&e.value===t.value))))}},{key:"postGetValidation",value:function(){const{allowBlank:e,errorMsg:t,customData:r,needCheckCustomData:n}=this.options,o=this.combo.getValue();return r||!n||this.validateCustomData()?BI.isEmptyArray(o||[])&&!e?{result:!1,errorMsg:t}:{result:!0}:{result:!1,errorMsg:BI.i18nText("Fine-Report_Preview_Not_In_List")}}},{key:"postValidateAndToast",value:function(){const e=this.getValidation();return!!e.result||(this.showBubble(e.errorMsg),!1)}},{key:"emitManualStopEditEvent",value:function(){this.fireEvent("stopedit")}},{key:"getValue",value:function(){const{delimiter:e,returnArray:t,startSymbol:r,endSymbol:n}=this.options,o=Array.from(new Set(this.combo.getValue().map((e=>e.value)).filter((e=>BI.isNotEmptyString(e)))));return t?o:"".concat(r).concat(o.join(e)).concat(n)}},{key:"reset",value:function(){this.combo.reset()}},{key:"reloadControlAttr",value:function(){this.reset(),this.combo.setRepopulate(!0)}},{key:"setInteractValue",value:function(e){this.combo.setRepopulate(!0),this.setControllerValue(e.value,e.data)}},{key:"resize",value:function(e,r){const n=this.combo.getValue();_superPropGet$d(t,"resize",this)([e,r]),this.combo.setValue(n)}},{key:"getRequestOpts",value:function(){const{getWidgetDependenceValueByWidget:e,getDependenceByWidget:t,extraOptsGetter:r}=this.options,n=e(this);return Object.assign({dependence:n,reload:BI.isNotEmptyArray(t(this))},r())}},{key:"getText",value:function(){return this.combo.getValue().map((({text:e})=>e)).join(this.options.delimiter)}},{key:"ck_el_array",get:function(){return this.combo.getAllButtons()}},{key:"getAdapter",value:function(){return this.combo.getAdapter()}},{key:"setText",value:function(e){this.combo.setText(e)}},{key:"setStyle",value:function(e){this.combo.element.addClass(setTagComboCheckboxStyle(ParameterTagComboCheckboxNext_1.BASE_CLS,e))}},{key:"setPopupStyle",value:function(e){this.options.sonHeight=parseInt(e.itemHeight,10),this.combo.element.addClass(setTagComboCheckboxPopupStyle(ParameterTagComboCheckboxNext_1.BASE_CLS,e))}},{key:"setWaterMark",value:function(e){this.options.watermark=e,this.combo.setWaterMark(e)}},{key:"focus",value:function(){this.combo.focus()}},{key:"blur",value:function(){this.combo.blur()}}])}();function validateByCustomRule(e="",t=""){if(!t)return!0;if("idcardRegex"===t)return validateIDCard(e);try{return new RegExp(t).test(e)}catch(e3){return!1}}function validateIDCard(e){const t="".concat(e);if(15===t.length)return isValidityBrithBy15IdCard(t);if(18===t.length){const e=t.split("");return isValidityBrithBy18IdCard(t)&&isTrueValidateCodeBy18IdCard(e)}return!1}function isTrueValidateCodeBy18IdCard(e){const t=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2,1];let r=0;"x"===e[17].toLowerCase()&&(e[17]="10");for(let o=0;o<17;o++)r+=t[o]*parseInt(e[o],10);const n=r%11;return e[17]==="".concat([1,0,10,9,8,7,6,5,4,3,2][n])}function isValidityBrithBy18IdCard(e){const t=parseFloat(e.substring(6,10)),r=parseFloat(e.substring(10,12)),n=parseFloat(e.substring(12,14)),o=new Date(t,r-1,n);return o.getFullYear()===t&&o.getMonth()===r-1&&o.getDate()===n}function isValidityBrithBy15IdCard(e){const t=parseFloat(e.substring(6,8)),r=parseFloat(e.substring(8,10)),n=parseFloat(e.substring(10,12)),o=new Date(t,r-1,n);return o.getFullYear()%100===t&&o.getMonth()===r-1&&o.getDate()===n}function _classCallCheck$1i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1h(n.key),n)}}function _createClass$1i(e,t,r){return t&&_defineProperties$1h(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1h(e){var t=_toPrimitive$1h(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1h(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$14(e,t,r){return t=_getPrototypeOf$14(t),_possibleConstructorReturn$14(e,_isNativeReflectConstruct$14()?Reflect.construct(t,r||[],_getPrototypeOf$14(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$14(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$14(e)}function _assertThisInitialized$14(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$14(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$14=function(){return!!e})()}function _superPropGet$c(e,t,r,n){var o=_get$c(_getPrototypeOf$14(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$c(){return _get$c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$c(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$c.apply(null,arguments)}function _superPropBase$c(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$14(e)););return e}function _getPrototypeOf$14(e){return(_getPrototypeOf$14=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$14(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$14(e,t)}function _setPrototypeOf$14(e,t){return(_setPrototypeOf$14=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterTagComboCheckboxNext.EVENT_CHANGE="EVENT_CHANGE",ParameterTagComboCheckboxNext.xtype="report.main.parameter_container.controller.tag_combo_checkbox_next",ParameterTagComboCheckboxNext.widgetType="tagcombocheckbox",ParameterTagComboCheckboxNext.BASE_CLS="report-main-parameter-container-controller-tag-combo-checkbox",ParameterTagComboCheckboxNext=ParameterTagComboCheckboxNext_1=__decorate$u([shortcut()],ParameterTagComboCheckboxNext);var __decorate$t=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ParameterText=function(e){function t(){var e;return _classCallCheck$1i(this,t),(e=_callSuper$14(this,t,arguments)).props={baseCls:"report-main-parameter-container-controller-text",$testId:"report-main-parameter-container-controller-text",width:WIDTH,height:HEIGHT,watermark:"",allowBlank:!0,errorMsg:BI.i18nText("Fine-Report_Preview_Can_Not_Null"),value:"",regex:"",regErrorMsg:BI.i18nText("Fine-Report_Preview_Input_Error"),fontSize:12,disabled:!1,invisible:!1,needSubmit:!1,allowBg:!0},e}return _inherits$14(t,AbstractParameterControllerWidget),_createClass$1i(t,[{key:"render",value:function(){const{width:e,height:t,value:r,watermark:n,fontSize:o,allowBg:i}=this.options,a=setFontSize("report-main-parameter-container-controller-text",o),s=setLineHeight("report-main-parameter-container-controller-text",t);return this.value="".concat(r),{type:BI.DefaultLayout.xtype,cls:i?"bi-card":"",items:[{type:BI.TextEditor.xtype,cls:"".concat(a," ").concat(s," bi-border-radius"),ref:e=>{this.editor=e,this.editComp=e.element},vgap:0,width:e,height:t,allowBlank:!0,value:this.value,watermark:n,listeners:[{eventName:BI.TextEditor.EVENT_FOCUS,action:()=>{!this.silence&&this.fireEvent("beforeedit"),this.hideBubble()}},{eventName:BI.TextEditor.EVENT_KEY_DOWN,action:()=>{!1!==(!this.silence&&this.fireEvent("afteredit"))&&this.fireEvent("EVENT_CHANGE",this.editor.getValue())}},{eventName:BI.TextEditor.EVENT_BLUR,action:()=>{!this.silence&&this.fireEvent("stopedit")}}]}]}}},{key:"setWaterMark",value:function(e){this.editor.setWaterMark(e)}},{key:"setControllerValue",value:async function(e,t){this.editor.setValue(e),!this.silence&&t&&this.fireEvent("afteredit")}},{key:"getBasicValidation",value:function(e=this.editor.getValue()){const{allowBlank:t,regex:r,errorMsg:n,regErrorMsg:o}=this.options;return BI.isEmptyString(e)?t?{result:!0}:{result:!1,errorMsg:n}:validateByCustomRule(e,r)?{result:!0}:{result:!1,errorMsg:o}}},{key:"preGetValidation",value:function(){return this.getBasicValidation(this.value)}},{key:"postGetValidation",value:function(){return this.getBasicValidation()}},{key:"postValidateAndToast",value:function(){const e=this.getValidation();return!!e.result||(this.showBubble(e.errorMsg),!1)}},{key:"emitManualStopEditEvent",value:function(){this.fireEvent("stopedit")}},{key:"getValue",value:function(){return this.editor.getValue()}},{key:"setInteractValue",value:function(e){this.setControllerValue(e)}},{key:"reset",value:function(){this.editor.setValue()}},{key:"resize",value:function(e,r){const n=this.editor.getValue();_superPropGet$c(t,"resize",this)([e,r]),this.editor.setValue(n)}},{key:"getAdapter",value:function(){return this.editor}},{key:"focus",value:function(){this.editor.focus()}},{key:"blur",value:function(){this.editor.blur()}},{key:"setStyle",value:function(e){this.editor.element.addClass(setEditorStyle(e))}},{key:"getText",value:function(){return this.editor.getValue()}}])}();function setTextAreaFontSize(e,t){const r="".concat(e,"-").concat(BI.UUID()),n=".".concat(r);index.use(jssGlobal(),jssNested());const o="".concat(n,".bi-textarea-editor");return index.createStyleSheet({"@global":{["".concat(o," .textarea-editor-content")]:{"font-size":"".concat(t,"px"),"line-height":"".concat(1.75*t,"px")},["".concat(o," .bi-water-mark")]:{"font-size":"".concat(t,"px"),"line-height":"".concat(1.75*t,"px")}}}).attach(),r}function _classCallCheck$1h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1g(n.key),n)}}function _createClass$1h(e,t,r){return t&&_defineProperties$1g(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1g(e){var t=_toPrimitive$1g(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1g(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$13(e,t,r){return t=_getPrototypeOf$13(t),_possibleConstructorReturn$13(e,_isNativeReflectConstruct$13()?Reflect.construct(t,r||[],_getPrototypeOf$13(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$13(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$13(e)}function _assertThisInitialized$13(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$13(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$13=function(){return!!e})()}function _superPropGet$b(e,t,r,n){var o=_get$b(_getPrototypeOf$13(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$b(){return _get$b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$b(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$b.apply(null,arguments)}function _superPropBase$b(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$13(e)););return e}function _getPrototypeOf$13(e){return(_getPrototypeOf$13=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$13(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$13(e,t)}function _setPrototypeOf$13(e,t){return(_setPrototypeOf$13=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterText.xtype="report.main.parameter_container.controller.text",ParameterText.widgetType="text",ParameterText=__decorate$t([shortcut()],ParameterText);var __decorate$s=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ParameterTextarea=function(e){function t(){var e;return _classCallCheck$1h(this,t),(e=_callSuper$13(this,t,arguments)).props={baseCls:"report-main-parameter-container-controller-textarea",$testId:"report-main-parameter-container-controller-textarea",width:WIDTH,height:WIDTH,value:"",multiline:!0,regex:"",regErrorMsg:BI.i18nText("Fine-Report_Preview_Input_Error"),disabled:!1,invisible:!1,needSubmit:!1,fontSize:12,allowBlank:!0,errorMsg:BI.i18nText("Fine-Report_Preview_Can_Not_Null"),watermark:"",allowBg:!0},e}return _inherits$13(t,AbstractParameterControllerWidget),_createClass$1h(t,[{key:"mounted",value:function(){this.element.on("keydown",(e=>{e.stopPropagation()})),!this.silence&&this.fireEvent("afterinit")}},{key:"render",value:function(){const{width:e,height:t,value:r,watermark:n,fontSize:o,allowBg:i}=this.options;return this.value="".concat(r),{type:BI.VerticalLayout.xtype,cls:i?"bi-card":"",items:[{type:BI.TextAreaEditor.xtype,cls:"".concat(setTextAreaFontSize("report-main-parameter-container-controller-textarea",o)," bi-border bi-border-radius bi-focus-shadow"),ref:e=>{this.editor=e},width:e-2,height:t-2,value:this.value,watermark:n,listeners:[{eventName:BI.TextAreaEditor.EVENT_KEY_DOWN,action:BI.debounce((()=>{!1!==(!this.silence&&this.fireEvent("afteredit"))&&this.fireEvent("EVENT_CHANGE")}),400)},{eventName:BI.TextAreaEditor.EVENT_BLUR,action:()=>{!this.silence&&this.fireEvent("stopedit")}},{eventName:BI.TextAreaEditor.EVENT_FOCUS,action:()=>{this.hideBubble(),!this.silence&&this.fireEvent("beforeedit")}}]}]}}},{key:"setControllerValue",value:async function(e){this.editor.setValue(e)}},{key:"getValue",value:function(){return this.editor.getValue()}},{key:"getBasicValidation",value:function(e=this.editor.getValue()){const{allowBlank:t,regex:r,errorMsg:n,regErrorMsg:o}=this.options;return BI.isEmptyString(e)?t?{result:!0}:{result:!1,errorMsg:n}:validateByCustomRule(e,r)?{result:!0}:{result:!1,errorMsg:o}}},{key:"preGetValidation",value:function(){return this.getBasicValidation(this.value)}},{key:"postGetValidation",value:function(){return this.getBasicValidation()}},{key:"postValidateAndToast",value:function(){const e=this.getValidation();return!!e.result||(this.showBubble(e.errorMsg),!1)}},{key:"setInteractValue",value:function(e){this.setControllerValue(e)}},{key:"emitManualStopEditEvent",value:function(){this.fireEvent("stopedit")}},{key:"reset",value:function(){this.editor.setValue()}},{key:"resize",value:function(e,r){const n=this.editor.getValue();_superPropGet$b(t,"resize",this)([e,r]),this.editor.setValue(n)}},{key:"getAdapter",value:function(){return this.editor}},{key:"focus",value:function(){this.editor.focus()}},{key:"blur",value:function(){this.editor.blur()}},{key:"setStyle",value:function(e){this.editor.element.addClass(setEditorStyle(e))}},{key:"setWaterMark",value:function(e){this.editor.setWatermark(e)}},{key:"getText",value:function(){return this.editor.getValue()}}])}();ParameterTextarea.xtype="report.main.parameter_container.controller.textarea",ParameterTextarea.widgetType="textarea",ParameterTextarea=__decorate$s([shortcut()],ParameterTextarea);const PARAMETER_TREE_BASE_CLS="report-main-parameter-container-controller-tree",fontSizeSplitValue=20;function getMultiTreeStyleByFontSize(e,t){const{height:r,fontSize:n}=t<=fontSizeSplitValue?{height:24,fontSize:Math.max(t,fontSizeSplitValue)}:{height:calcItemHeightByFontSize(t),fontSize:Math.max(t,fontSizeSplitValue)},o=(24-r)/2,i=r/24*14;return{["".concat(e," .ztree li span.button.switch")]:{width:"".concat(r,"px !important"),height:"".concat(r,"px !important"),left:"".concat(o,"px")},["".concat(e," .ztree li span.button.chk")]:{width:"".concat(i,"px !important"),height:"".concat(i,"px !important"),left:"".concat(i-14+o,"px")},["".concat(e," .ztree li a")]:{height:"".concat(r,"px !important")},["".concat(e," .ztree li a span")]:{"line-height":"".concat(r,"px !important")},["".concat(e," .ztree li ul.line:before")]:{left:"".concat(r<=24?11:n/1.5+1,"px"),"border-left-width":"".concat(r<=24?1:n/12,"px")},["".concat(e," .ztree li ul")]:{"padding-left":"".concat(r<=24?18:r+o,"px")}}}function getSingleTreeStyleByFontSize(e,t){const r=calcItemHeightByFontSize(t),n=Math.max((24-r)/2,0),o=r<=24?1:t/12;return{["".concat(e," .bi-icon-button i")]:{width:"".concat(r,"px !important"),height:"".concat(r,"px !important"),left:"".concat(n,"px")},["".concat(e," .bi-tree-node-switcher .x-icon")]:{width:"".concat(r,"px !important"),height:"".concat(r,"px !important"),left:"".concat(n,"px")},["".concat(e," .bi-tree-expander-popup.line:after ")]:{left:"-".concat(o,"px"),"border-left-width":"".concat(o,"px")},["".concat(e," .bi-node.bi-tree-node-switcher")]:{height:"".concat(r,"px !important"),width:"".concat(r,"px !important")},["".concat(e," .bi-tree-expander-popup.expander-popup")]:{left:"".concat((r-24)/2+(o-1)/2,"px")},["".concat(e," .bi-tree-expander-popup.expander-popup .bi-label.bi-text")]:{height:"".concat(r,"px !important"),"line-height":"".concat(r,"px !important")},["".concat(e," .mid-line-conn-background")]:{width:"".concat(r,"px !important"),height:"".concat(r,"px !important"),"background-size":"contain"},["".concat(e," .last-line-conn-background")]:{width:"".concat(r,"px !important"),height:"".concat(r,"px !important"),"background-size":"contain"},["".concat(e," .first-line-conn-background")]:{width:"".concat(r,"px !important"),height:"".concat(r,"px !important"),"background-size":"contain"},["".concat(e," .mid-line-conn-background + div")]:{height:"".concat(r,"px !important"),"line-height":"".concat(r,"px !important")},["".concat(e," .last-line-conn-background + div")]:{height:"".concat(r,"px !important"),"line-height":"".concat(r,"px !important")},["".concat(e," .first-line-conn-background + div")]:{height:"".concat(r,"px !important"),"line-height":"".concat(r,"px !important")},["".concat(e," .bi-multilayer-single-tree-mid-tree-leaf-item")]:{height:"".concat(r,"px !important")},["".concat(e," .bi-multilayer-single-tree-mid-tree-leaf-item .bi-mid-tree-leaf-item")]:{height:"".concat(r,"px !important")},["".concat(e," .bi-node")]:{height:"".concat(r,"px !important")},["".concat(e," .bi-mid-plus-group-node")]:{height:"".concat(r,"px !important")},["".concat(e," .bi-mid-plus-group-node .bi-label")]:{height:"".concat(r,"px !important"),"line-height":"".concat(r,"px !important")},["".concat(e," .bi-multilayer-single-tree-last-tree-leaf-item")]:{height:"".concat(r,"px !important")},["".concat(e," .bi-multilayer-single-tree-last-tree-leaf-item .bi-last-tree-leaf-item")]:{height:"".concat(r,"px !important")},["".concat(e," .bi-tree-node.bi-list-item .bi-label.bi-text")]:{height:"".concat(r,"px !important"),"line-height":"".concat(r,"px !important")}}}function setTreeFontSize(e,t){const r=setFontSize(e,t),n=".".concat(r);return index.use(jssGlobal(),jssNested()),index.createStyleSheet({"@global":Object.assign(Object.assign({},getSingleTreeStyleByFontSize(n,t)),getMultiTreeStyleByFontSize(n,t))}).attach(),r}function calcItemHeightByFontSize(e){return e>fontSizeSplitValue?1.5*e:24}function mergeTreeValue(e,t){for(const r in e)BI.isEqual(t[r],e[r])||BI.isNull(t[r])?e[r]={}:e[r]=mergeTreeValue(e[r],t[r]);return e}function transformTreeNodesToJson(e=[],t={}){return e.forEach((e=>{t[e.value]={},transformTreeNodesToJson(e.children,t[e.value])})),t}function setTreeStyle({opacity:e,background:t,color:r,border:n,"border-radius":o}){index.use(jssGlobal(),jssNested());const i="".concat(PARAMETER_TREE_BASE_CLS,"-").concat(BI.UUID()),a=".".concat(i);return index.createStyleSheet({"@global":{["".concat(a)]:{opacity:e,background:t,color:r},["".concat(a," .bi-border")]:{border:n,"boder-radius":o}}}).attach(),i}function _classCallCheck$1g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1f(n.key),n)}}function _createClass$1g(e,t,r){return t&&_defineProperties$1f(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1f(e){var t=_toPrimitive$1f(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1f(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$12(e,t,r){return t=_getPrototypeOf$12(t),_possibleConstructorReturn$12(e,_isNativeReflectConstruct$12()?Reflect.construct(t,r||[],_getPrototypeOf$12(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$12(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$12(e)}function _assertThisInitialized$12(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$12(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$12=function(){return!!e})()}function _superPropGet$a(e,t,r,n){var o=_get$a(_getPrototypeOf$12(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$a(){return _get$a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$a(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$a.apply(null,arguments)}function _superPropBase$a(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$12(e)););return e}function _getPrototypeOf$12(e){return(_getPrototypeOf$12=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$12(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$12(e,t)}function _setPrototypeOf$12(e,t){return(_setPrototypeOf$12=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __decorate$r=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let SyncTree=function(e){function t(){var e;return _classCallCheck$1g(this,t),(e=_callSuper$12(this,t,arguments)).isAutoExpand=!0,e.props={baseCls:"bi-tree-value-chooser-pane",items:null,itemsCreator:BI.emptyFn,value:void 0},e}return _inherits$12(t,BI.AbstractTreeValueChooser),_createClass$1g(t,[{key:"_init",value:function(){_superPropGet$a(t,"_init",this,1).apply(this,arguments),this.pane=BI.createWidget({type:BI.AsyncTree.xtype,element:this,itemsCreator:BI.bind(this._itemsCreator,this)}),this.pane.on(BI.MultiSelectTree.EVENT_CHANGE,(()=>{this.fireEvent("EVENT_CHANGE")}))}},{key:"setSelectedValue",value:function(e){this.options.value=this.mergeValues(e),this.pane.setSelectedValue(this.options.value||{})}},{key:"setValue",value:function(e){this.setSelectedValue(e)}},{key:"getValue",value:function(){return this.pane.getValue()}},{key:"getSelectedValue",value:function(){return this.mergeValues(this.pane.getValue())}},{key:"populate",value:function(){const e=this.options;e.itemsCreator({},(t=>{this._initData(t.items),this.nodesItems=t.items,this.setValue(e.value),this.pane.populate(),this.expandSelectedChildrenNode(this.isAutoExpand)}))}},{key:"enableAutoExpand",value:function(){this.isAutoExpand=!0}},{key:"expandSelectedChildrenNode",value:function(e){setTimeout((()=>{const t=this.pane.nodes;if(!t)return;const r=t.setting.treeId,n=!0===e?t.getNodes():null==e?void 0:e.children;n&&n.forEach((e=>{const t=this.nodesItems.find((t=>t.id===e.id));t&&((null==t?void 0:t.open)||e.checked)&&(this.expandNode(r,e),this.expandSelectedChildrenNode(e))}))}),17)}},{key:"expandNode",value:function(e,t){this.pane._beforeExpandNode(e,t)}},{key:"mergeValues",value:function(e){var t;return!e||BI.isEmptyObject(e)?e:mergeTreeValue(e,transformTreeNodesToJson(null===(t=this.tree)||void 0===t?void 0:t.toJSON()))}}])}();function _classCallCheck$1f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1e(n.key),n)}}function _createClass$1f(e,t,r){return t&&_defineProperties$1e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1e(e){var t=_toPrimitive$1e(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1e(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$11(e,t,r){return t=_getPrototypeOf$11(t),_possibleConstructorReturn$11(e,_isNativeReflectConstruct$11()?Reflect.construct(t,r||[],_getPrototypeOf$11(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$11(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$11(e)}function _assertThisInitialized$11(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$11(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$11=function(){return!!e})()}function _superPropGet$9(e,t,r,n){var o=_get$9(_getPrototypeOf$11(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$9(){return _get$9="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$9(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$9.apply(null,arguments)}function _superPropBase$9(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$11(e)););return e}function _getPrototypeOf$11(e){return(_getPrototypeOf$11=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$11(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$11(e,t)}function _setPrototypeOf$11(e,t){return(_setPrototypeOf$11=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}SyncTree.xtype="report.main.parameter_container.controller.sync_tree",SyncTree=__decorate$r([shortcut()],SyncTree);var __decorate$q=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ListSyncTree=function(e){function t(){var e;return _classCallCheck$1f(this,t),(e=_callSuper$11(this,t,arguments)).props={baseCls:"bi-tree-value-chooser-pane",items:null,itemsCreator:BI.emptyFn,value:void 0},e}return _inherits$11(t,BI.AbstractListTreeValueChooser),_createClass$1f(t,[{key:"_init",value:function(){_superPropGet$9(t,"_init",this,1).apply(this,arguments);const e=this.options;this.pane=BI.createWidget({type:BI.ListAsyncTree.xtype,element:this,itemsCreator:BI.bind(this._itemsCreator,this),value:e.value}),this.pane.on(BI.MultiSelectTree.EVENT_CHANGE,(()=>{this.fireEvent("EVENT_CHANGE")}))}},{key:"setSelectedValue",value:function(e){this.pane.setSelectedValue(e)}},{key:"setValue",value:function(e){this.setSelectedValue(e)}},{key:"getValue",value:function(){return this.pane.getValue()}},{key:"populate",value:function(){this.options.itemsCreator({},(e=>{this._initData(e.items),this.pane.populate()}))}}])}();ListSyncTree.xtype="report.main.parameter_container.controller.list_sync_tree",ListSyncTree=__decorate$q([shortcut()],ListSyncTree);var __rest$f=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};const ROOT="__root__",TREE_VIEW_TYPE="PULL_DATA",SPLITOR="__splitor__",LAYER_SPLITOR=/;|；/g,LEAF_SPLITOR=/,|，/g;async function multiAsyncTreeItemsCreator(e,t){const{reload:r,widgetName:n,dependence:o,checkState:i,id:a,parentValues:s=[],selectedValues:l,keyword:c,type:u,floors:d,notSelectedValue:h,cancelToken:p}=t,f=__rest$f(t,["reload","widgetName","dependence","checkState","id","parentValues","selectedValues","keyword","type","floors","notSelectedValue","cancelToken"]);return e(n,Object.assign({dependence:o,reload:r,id:a,value:BI.last(s),parent_values:s,notSelectedValue:h,selectedValues:l,type:u,parentValues:s,filter:c,checkState:i,floors:d},f),p).then((e=>e[0]||{items:[],resultType:"",hasNext:!1}))}async function singleAsyncTreeItemsCreator(e,t){const{reload:r,widgetName:n,dependence:o,node:i={},keyword:a,cancelToken:s}=t,l=__rest$f(t,["reload","widgetName","dependence","node","keyword","cancelToken"]);return e(n,Object.assign({id:i.id,value:getSingleTreeTextByValue(i.value||""),filter:a,dataFilter:a,fine_outlet_widget:a?"nx":void 0,dependence:o,parent_values:i.value?transformString2Array(i.value):void 0,reload:r},l),s).then((e=>({items:transformTreeControlAttr2Items(e,{pId:i.id,prefix:!!a&&""}),hasNext:!1})))}async function syncTreeItemsCreator(e,t){const{reload:r,widgetName:n,dependence:o,keyword:i,prefix:a}=t,s=__rest$f(t,["reload","widgetName","dependence","keyword","prefix"]);return e(n,Object.assign({filter:i,dependence:o,reload:r},s)).then((e=>({items:transformTreeControlAttr2Items(e,{prefix:a}),hasNext:!1})))}function getParamTreeComboBoxLayout(e,t,r,n){return e?r?t?n?BI.MultiTreeInsertCombo.xtype:BI.MultiTreeCombo.xtype:BI.MultiTreeListCombo.xtype:t?n?BI.TreeValueChooserInsertCombo.xtype:BI.TreeValueChooserCombo.xtype:BI.ListTreeValueChooserInsertCombo.xtype:t?BI.MultiLayerSingleTreeCombo.xtype:BI.MultiLayerSelectTreeCombo.xtype}function getParamTreeLayout(e,t,r){return e?t?r?BI.AsyncTree.xtype:SyncTree.xtype:r?BI.ListAsyncTree.xtype:ListSyncTree.xtype:t?BI.MultiLayerSingleTreePopup.xtype:BI.MultiLayerSelectTreePopup.xtype}function transformTreeControlAttr2Items(e=[],t={}){const{pId:r=ROOT,times:n=0,prefix:o=!1}=t,i=[];return(e||[]).forEach((e=>{const a={checked:1===e.checkstate,half:!1,halfCheck:!1,id:e.id,isParent:e.hasChildren,open:e.isexpand,pId:r,text:e.text||"​",times:n,title:e.text||"​",value:o?"".concat(o).concat(SPLITOR).concat(e.value):e.value};i.push(a),e.ChildNodes&&e.ChildNodes.length>0&&i.push(...transformTreeControlAttr2Items(e.ChildNodes,Object.assign(Object.assign({},t),{pId:e.id,prefix:!1!==o&&a.value})))})),i}async function rebuildAsyncTree(e,t,r,n={}){return t(e,r).then((e=>(traverseFillValue(e,n),{valueReference:n,data:e})))}function traverseFillValue(e,t){(e||[]).forEach((e=>{t[e.value]={},e.hasChildren&&traverseFillValue(e.ChildNodes,t[e.value])}))}function traverseValue(e,t=[ROOT]){return Object.keys(e).reduce(((r,n)=>(BI.isEmptyObject(e[n])?r.push({value:n,reference:e[n],path:t}):r.push(...traverseValue(e[n],t.concat(n))),r)),[])}async function rebuildSyncTree(e,t,r,n,o){const i=o||await r(t,n),a=Object.keys(e);if(0===a.length)for(const s of i)e[s.value]={},s.hasChildren&&await rebuildSyncTree(e[s.value],t,r,n,s.ChildNodes);for(const s of i)a.includes(s.value)&&s.hasChildren&&await rebuildSyncTree(e[s.value],t,r,n,s.ChildNodes);return e}function transformMultiTreeInsertComboValue(e,t){return t?transformMultiTreeValue2DoubleArray(e):transformMultiTreeValue2SingleArray(e)}function transformMultiTree2FormatStringValue(e,t,r,n){const o=transformDoubleArray2SingleArray(transformMultiTreeValue2DoubleArray(e));return"".concat(r).concat(o.join(t)).concat(n)}function transformSingleTreeInsertComboValue(e,t){const r=completeSingleTreeValue(e);return t?r:[BI.last(r||[])]}function completeSingleTreeValue(e){if(BI.isEmptyArray(e))return;const t=BI.last(e);return t?transformString2Array(t):void 0}function modifySingleTreeItemValue(e,t){if(!t.node)return e.value;let r=e.value,n=t.node;for(;n;)r="".concat(n.originValue).concat(SPLITOR).concat(r),n=n.pNode;return r}function transformMultiTreeValue2DoubleArray(e,t=[]){return Object.keys(e).reduce(((r,n)=>0===Object.keys(e[n]).length?(r.push([...t,n]),r):r.concat(transformMultiTreeValue2DoubleArray(e[n],[...t,n]))),[])}function transformMultiTreeValue2SingleArray(e){return transformDoubleArray2SingleArray(transformMultiTreeValue2DoubleArray(e))}function transformDoubleArray2SingleArray(e){return e.map((e=>e[e.length-1]))}function transformString2DoubleArray(e){return e.split(LAYER_SPLITOR).map((e=>e.split(LEAF_SPLITOR)))}function transformString2Array(e){return e.split(SPLITOR)}function transformTreeDefaultValue(e,t,r,n){const o=BI.isNumber(e)?"".concat(e):e;if(""!==o&&!BI.isNull(o)&&!BI.isEmptyObject(o))return BI.isString(o)?t?r?transformMultiTreeDefaultValue(o,n.textValueMap):transformMultiLeafTreeDefaultValue(o,n.textValueMap):transformSingleTreeDefaultValue(o,n.nodes):t?r?o.reduce(((e,o)=>BI.deepExtend({},e,transformTreeDefaultValue("".concat(o),t,r,n))),{}):o.reduce(((e,o)=>(e.push(...transformTreeDefaultValue("".concat(o),t,r,n)),e)),[]):transformTreeDefaultValue(o.join(SPLITOR),t,r,n)}function transformMultiTreeDefaultValue(e,t={}){return splitValue(e).reduce(((e,r)=>{let n=e;return r.split(LEAF_SPLITOR).forEach((e=>{const r=e in t?t[e]:e;n[r]||(n[r]={}),n=n[r]})),e}),{})}function transformMultiLeafTreeDefaultValue(e,t={}){return splitValue(e).reduce(((e,r)=>(e.push(r.split(LEAF_SPLITOR).map((e=>e in t?t[e]:e))),e)),[])}function transformSingleTreeDefaultValue(e,t){const r=e.split(LAYER_SPLITOR)[0];let n=[];return r.split(",").reduce(((e,r)=>{const o=t.find((t=>t.pId===e&&(t.value===r||t.text===r)));return o?n=[o.value]:n.push(r),null==o?void 0:o.id}),ROOT),n.join(SPLITOR)}function transformDataItems(e,t={}){return e.forEach((e=>{e.originValue=e.value,e.value=modifySingleTreeItemValue(e,t)})),e}function trasnformTreeControlAttr2TextValueMap(e,t){return(e||[]).reduce(((e,r)=>{const n=replaceRedMarkTag("".concat(r.text)),o=t?"".concat(t).concat(SPLITOR).concat(r.value):"".concat(r.value);return n in e||(e[n]=o),e[o]=o,r.hasChildren?Object.assign(Object.assign({},e),trasnformTreeControlAttr2TextValueMap(r.ChildNodes,!1!==t&&o)):e}),{})}function transformMultiTreeItem2TextValueMap(e){return e.reduce(((e,t)=>{const r=replaceRedMarkTag("".concat(t.text)),n="".concat(t.value);return r in e||(e[r]=n),e[n]=n,e}),{})}function replaceRedMarkTag(e){return BI.replaceAll("".concat(e).replace(/<\/?span.*?>/g,""),"&nbsp;"," ")}function splitValue(e){const t=e.split(LAYER_SPLITOR);return BI.size(t)>1&&""===BI.last(t)&&t.pop(),t}function getSingleTreeParentValueByValue(e){return e.split(SPLITOR).slice(0,-1).join(SPLITOR)}function getSingleTreeTextByValue(e,t){if(!e)return"";const r=BI.last(transformString2Array(e)),n=null==t?void 0:t.find((e=>BI.last(transformString2Array(e.value))===r));return(null==n?void 0:n.text)||r}function getSingleTreePathByValue(e){return e?transformString2Array(e).reduce(((e,t)=>(e.push(0===e.length?t:"".concat(BI.last(e)).concat(SPLITOR).concat(t)),e)),[]):[]}function transform2DistinctTreeValues(e){const t={};return e.map((e=>{t[e.pId]||(t[e.pId]=[]);const r=transform2DistinctValueByValues(e.value,t[e.pId]);return t[e.pId].push(r),Object.assign(Object.assign({},e),{value:r})}))}function _classCallCheck$1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1d(n.key),n)}}function _createClass$1e(e,t,r){return t&&_defineProperties$1d(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1d(e){var t=_toPrimitive$1d(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1d(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$10(e,t,r){return t=_getPrototypeOf$10(t),_possibleConstructorReturn$10(e,_isNativeReflectConstruct$10()?Reflect.construct(t,r||[],_getPrototypeOf$10(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$10(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$10(e)}function _assertThisInitialized$10(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$10(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$10=function(){return!!e})()}function _superPropGet$8(e,t,r,n){var o=_get$8(_getPrototypeOf$10(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$8(){return _get$8="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$8(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$8.apply(null,arguments)}function _superPropBase$8(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$10(e)););return e}function _getPrototypeOf$10(e){return(_getPrototypeOf$10=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$10(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$10(e,t)}function _setPrototypeOf$10(e,t){return(_setPrototypeOf$10=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let ParameterTreeLike=function(e){function t(){var e;return _classCallCheck$1e(this,t),(e=_callSuper$10(this,t,arguments)).singleTreeUnexpectedNodes=[],e.nodes=[],e.textValueMap={},e.singleTreeNotSelectedValue="﷐﷯",e.singleTreeNotSelectedNode={checked:!1,half:!1,isParent:!1,halfCheck:!1,id:BI.UUID(),open:!1,pId:ROOT,text:BI.i18nText("BI-Basic_No_Select"),times:0,title:BI.i18nText("BI-Basic_No_Select"),value:e.singleTreeNotSelectedValue,originValue:e.singleTreeNotSelectedValue},e.cancelTokenSourceDict=new Map,e}return _inherits$10(t,AbstractParameterControllerWidget),_createClass$1e(t,[{key:"mounted",value:async function(){_superPropGet$8(t,"mounted",this)([])}},{key:"updateControllAttr",value:async function(){return this.singleAsyncTreeItemCreator({})}},{key:"updateCacheByItems",value:function(e){this.textValueMap=Object.assign(Object.assign({},this.textValueMap),transformMultiTreeItem2TextValueMap(e)),this.nodes=this.nodes.concat(e.map((e=>Object.assign(Object.assign({},e),{text:replaceRedMarkTag(e.text)})))),e.forEach((e=>{e.$testId="report-main-parameter-container-controller-tree-item",e.$value="".concat(e.pId)}))}},{key:"updateCacheByControlAttrData",value:function(e){const{mutiSelection:t}=this.options;this.nodes=[...this.nodes,...transformDataItems(transformTreeControlAttr2Items(e||[],{prefix:!t&&""})).map((e=>Object.assign(Object.assign({},e),{text:replaceRedMarkTag(e.text)})))],this.textValueMap=Object.assign(Object.assign({},this.textValueMap),trasnformTreeControlAttr2TextValueMap(e||[],!t&&""))}},{key:"updateCacheByValue",value:async function(e){const t=await this.getInfoByValue(e);(null==t?void 0:t.nodes)&&this.updateCacheByControlAttrData(t.nodes)}},{key:"getInfoByValue",value:async function(e){const{mutiSelection:t}=this.options;if(this.isEmptyValue(e))return;const r=[],n=[];if(t){const t=BI.isString(e)?transformString2DoubleArray(e):BI.isArray(e)?e:[];for(const e of t)await this.getOneBranchInfo(e).then((e=>{r.push(...(null==e?void 0:e.controlData)||[]),n.push(...(null==e?void 0:e.resultNodes)||[])}))}else{const t=BI.isString(e)?transformString2Array(e):BI.isArray(e)?e:[];await this.getOneBranchInfo(t).then((e=>{r.push(...(null==e?void 0:e.controlData)||[]),n.push(...(null==e?void 0:e.resultNodes)||[])}))}return{controlData:r,nodes:n}}},{key:"getOneBranchInfo",value:async function(e){const{oldTreeControlAttrFetcher:t,widgetName:r}=this.options;if(this.isEmptyValue(e))return;const n=[],o=[];let i=n;const a=[];let s="",l="";for(const d of e){const e="".concat(d),n=await t(r,Object.assign(Object.assign({},BI.size(a)>0?{id:l,value:s,parent_values:a}:{}),this.getTreeOptions())),h=n.find((t=>"".concat(t.value)===e));if(!h)break;u=n,s="".concat((c=h).value),l="".concat(c.id),a.push(c.value),i.push(...u),c.ChildNodes=[],i=c.ChildNodes,o.push(...u)}var c,u;return{controlData:n,resultNodes:o}}},{key:"setControllerValue",value:async function(e,t=[]){const r=t;await this.getInfoByValue(e).then((e=>{r.push(...(null==e?void 0:e.nodes)||[])})),this.updateCacheByControlAttrData(r),this.value=transformTreeDefaultValue(e,this.options.mutiSelection,this.options.selectLeafOnly,{textValueMap:this.textValueMap,nodes:this.nodes}),this.completeMultiTreeValue=this.value,this.setTreeValue(this.value)}},{key:"setValue",value:async function(e,t){t?this.updateCacheByControlAttrData(t):await this.updateCacheByValue(e),await this.setControllerValue(e,t),this.fireEvent("EVENT_SET_VALUE")}},{key:"setTreeValue",value:function(e){this.tree.setValue(e)}},{key:"getValue",value:function(){let e=this.completeMultiTreeValue||this.tree.getValue();const{mutiSelection:t,selectLeafOnly:r,returnFullPath:n,returnArray:o,startSymbol:i="",endSymbol:a="",delimiter:s}=this.options;return this.isEmptyValue(e)?"":(BI.isString(e)&&!t&&(e=[e]),BI.isString(e)||BI.isNull(e)?e||"":t?r?o?transformMultiTreeInsertComboValue(e,n):transformMultiTree2FormatStringValue(e,s,i,a):n?e:transformDoubleArray2SingleArray(e):transformSingleTreeInsertComboValue(e,n))}},{key:"setInteractValue",value:async function(e){await this.setControllerValue("".concat(BI.isArray(e.value)?BI.isString(e.value[0])?e.value.join(","):e.value.map((e=>e.join(","))).join(";"):e.value),e.data)}},{key:"fireEventChange",value:function(){this.fireEvent("EVENT_CHANGE",this.getValue())}},{key:"rebuildAsyncMultiTree",value:async function(e,t){this.setShowMask(!0);const r=[];return traverseValue(e).forEach((e=>{const t=this.nodes.slice(0).reverse().find((t=>t.value===e.value));t&&r.push(rebuildAsyncTree(this.options.widgetName,this.options.newTreeStructureFetcher,Object.assign({value:e.value,id:t.id},this.getTreeOptions()),e.reference))})),Promise.all(r).then((r=>{r.forEach((e=>this.updateCacheByControlAttrData(e.data))),this.completeMultiTreeValue=e,t&&this.fireEventChange()})).then((()=>{this.setShowMask(!1)}))}},{key:"rebuildSyncMultiTree",value:async function(e,t){this.setShowMask(!0),await rebuildSyncTree(e,this.options.widgetName,this.options.oldTreeControlAttrFetcher,this.getTreeOptions()).then((()=>{this.completeMultiTreeValue=e,t&&this.fireEventChange()})).then((()=>{this.setShowMask(!1)}))}},{key:"rebuildMultiTreeValidator",value:function(e){const{selectLeafOnly:t,mutiSelection:r}=this.options;return!(!t||!r)&&(!BI.isEmptyObject(e)&&!BI.isNull(e)&&""!==e||(this.completeMultiTreeValue=void 0,!1))}},{key:"rebuildMultiTree",value:async function(e=this.tree.getValue(),t){const r=BI.deepClone(e);if(!this.rebuildMultiTreeValidator(r))return this.completeMultiTreeValue=void 0,void(t&&this.fireEventChange());this.isAsyncTree()?await this.rebuildAsyncMultiTree(r,t):await this.rebuildSyncMultiTree(r,t)}},{key:"syncTreeItemCreator",value:function(){const{mutiSelection:e}=this.options;return e?this.multiSyncTreeItemCreator():this.singleSyncTreeItemCreator()}},{key:"multiAsyncTreeItemCreator",value:async function(e){const{widgetName:t,newTreeControlAttrFetcher:r}=this.options,n=e.type||TREE_VIEW_TYPE;n!==BI.TreeView.REQ_TYPE_ADJUST_DATA&&n!==BI.TreeView.REQ_TYPE_SELECT_DATA||this.setShowMask(!0);const o=this.cancelTokenSourceDict.get(n);return o&&(o.cancel(),this.cancelTokenSourceDict.delete(n)),multiAsyncTreeItemsCreator(r,Object.assign(Object.assign(Object.assign({},e),{widgetName:t}),this.getTreeOptions(n))).then((e=>(this.setShowMask(!1),Array.isArray(e.items)?(this.updateCacheByItems(e.items),e):(BI.isPlainObject(e.items)&&this.updateCacheByItems(traverseValue(e.items).map((e=>({value:e.value,text:""})))),this.cancelTokenSourceDict.delete(n),e.items))))}},{key:"singleSyncTreeItemCreator",value:async function(){const{widgetName:e,oldTreeControlAttrFetcher:t,allowBlank:r}=this.options;return syncTreeItemsCreator(t,Object.assign(Object.assign({widgetName:e},this.getTreeOptions()),{prefix:""})).then((e=>(e.items=transform2DistinctTreeValues(transformDataItems(e.items,{})),!this.isTreeWidget()&&r&&e.items.unshift(this.singleTreeNotSelectedNode),e.items.push(...this.singleTreeUnexpectedNodes),this.updateCacheByItems(e.items),e)))}},{key:"multiSyncTreeItemCreator",value:async function(){const{widgetName:e,oldTreeControlAttrFetcher:t}=this.options;return syncTreeItemsCreator(t,Object.assign({widgetName:e},this.getTreeOptions())).then((e=>(e.items=transform2DistinctTreeValues(transformDataItems(e.items,{})),this.updateCacheByItems(e.items),e)))}},{key:"singleAsyncTreeItemCreator",value:async function(e){const{widgetName:t,oldTreeControlAttrFetcher:r,allowBlank:n}=this.options,o=e.type||TREE_VIEW_TYPE,i=this.cancelTokenSourceDict.get(o);return i&&(i.cancel(),this.cancelTokenSourceDict.delete(o)),singleAsyncTreeItemsCreator(r,Object.assign(Object.assign(Object.assign({},e),{widgetName:t}),this.getTreeOptions(o))).then((t=>{t.items=transformDataItems(t.items,e);const r=BI.get(e,"node.id",ROOT);return this.singleTreeUnexpectedNodes.forEach((e=>{r===e.pId&&t.items.push(e)})),this.isTreeWidget()||BI.get(e,"node")||BI.get(e,"keyword")||!n||t.items.unshift(this.singleTreeNotSelectedNode),this.updateCacheByItems(t.items),this.cancelTokenSourceDict.delete(o),t}))}},{key:"getTreeOptions",value:function(e=TREE_VIEW_TYPE){var t;const{getWidgetDependenceValueByWidget:r,getDependenceByWidget:n,extraOptsGetter:o}=this.options,i=r(this),a=BI.isNotEmptyArray(n(this));return this.cancelTokenSourceDict.set(e,axios$1.CancelToken.source()),Object.assign(Object.assign({dependence:i,reload:a},o()),{cancelToken:null===(t=this.cancelTokenSourceDict.get(e))||void 0===t?void 0:t.token})}},{key:"preGetValidation",value:function(){const{allowBlank:e,value:t,errorMsg:r}=this.options;return e||!BI.isEmpty(t)?{result:!0}:{result:!1,errorMsg:r}}},{key:"transformSyncSingleTreeItem",value:function(e){if(!this.isAsyncTree()&&!this.options.mutiSelection&&this.options.async){const t=getSingleTreePathByValue(this.value);e.forEach((e=>{t.includes(e.value)&&(e.open=!0)}))}return e}},{key:"postGetValidation",value:function(e=this.tree.getValue()){const{allowBlank:t,errorMsg:r,customData:n,needCheckCustomData:o}=this.options;return this.isEmptyValue(e)?t?{result:!0}:{result:!1,errorMsg:r}:!n&&o?this.validateCustomData(e):{result:!0}}},{key:"postValidateAndToast",value:function(){const e=this.getValidation();return!!e.result||(this.showBubble(e.errorMsg),!1)}},{key:"validateCustomData",value:function(e){const{mutiSelection:t,selectLeafOnly:r}=this.options,n=[];if(t){(r?transformMultiTreeInsertComboValue(e,!0):e).forEach((e=>{e.forEach((e=>{n.push(e)}))}))}else n.push(BI.isString(e)?e:BI.first(e));return n.every((e=>e in this.textValueMap))?{result:!0}:{result:!1,errorMsg:BI.i18nText("Fine-Report_Preview_Not_In_List")}}},{key:"isEmptyValue",value:function(e){return!!BI.isEmpty(e)||!!(BI.isEqual(e,[this.singleTreeNotSelectedValue])||BI.isEqual(e,[void 0])||BI.isEqual(e,[null])||BI.isEqual(e,[""]))}},{key:"isAsyncTree",value:function(){const{async:e,isLayerBuild:t}=this.options;return!t&&e}},{key:"reset",value:function(){const{mutiSelection:e,selectLeafOnly:t}=this.options;this.completeMultiTreeValue=void 0,e?t?this.setTreeValue({}):this.setTreeValue([]):this.setTreeValue([""])}},{key:"setShowMask",value:function(e){this.options.noGlobalMask||(e?(this.mask||BI.createWidget({type:BI.AbsoluteLayout.xtype,element:"body",items:[{el:{type:Loading.xtype,cls:"transparent mask",ref:e=>{this.mask=e},listeners:[{eventName:BI.Events.MOUNT,action:()=>{this.mask.element.mousedown((e=>{e.stopEvent()}))}}]},top:0,left:0,right:0,bottom:0}]}),this.mask.visible()):this.mask&&this.mask.invisible())}},{key:"transformSingleTreeValue2Node",value:function(e,t=!1){const r=this.nodes.find((t=>t.value===e));if(r)return r;const n=getSingleTreeTextByValue(e),o=getSingleTreeParentValueByValue(e),i=BI.isEmptyString(o)?ROOT:this.transformSingleTreeValue2Node(o,!0).id,a={checked:!1,half:!1,halfCheck:!1,id:BI.UUID(),isParent:t,open:!1,pId:i,text:n,times:0,title:n,value:e,originValue:e};return this.nodes.push(a),this.singleTreeUnexpectedNodes.push(a),a}},{key:"resize",value:function(e,t){const r=this.tree.getValue(),n=this.isEnabled();this.preResize(e,t)&&(this.tree.setValue(r),this.value=r,this.setEnable(n))}}])}();function _classCallCheck$1d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1c(n.key),n)}}function _createClass$1d(e,t,r){return t&&_defineProperties$1c(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1c(e){var t=_toPrimitive$1c(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1c(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$$(e,t,r){return t=_getPrototypeOf$$(t),_possibleConstructorReturn$$(e,_isNativeReflectConstruct$$()?Reflect.construct(t,r||[],_getPrototypeOf$$(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$$(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$$(e)}function _assertThisInitialized$$(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$$=function(){return!!e})()}function _superPropGet$7(e,t,r,n){var o=_get$7(_getPrototypeOf$$(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$7(){return _get$7="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$7(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$7.apply(null,arguments)}function _superPropBase$7(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$$(e)););return e}function _getPrototypeOf$$(e){return(_getPrototypeOf$$=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$$(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$$(e,t)}function _setPrototypeOf$$(e,t){return(_setPrototypeOf$$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __decorate$p=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterTree_1;let ParameterTree=ParameterTree_1=function(e){function t(){var e;return _classCallCheck$1d(this,t),(e=_callSuper$$(this,t,arguments)).nodes=[],e.textValueMap={},e.props={baseCls:ParameterTree_1.BASE_CLS,$testId:ParameterTree_1.BASE_CLS,width:WIDTH,height:HEIGHT,value:void 0,widgetName:"",disabled:!1,invisible:!1,needSubmit:!0,fontSize:12,controlAttr:{data:[{ChildNodes:[],isexpand:!1,hasChildren:!1,id:1,text:"",showcheck:!1,complete:!0,value:"",checkstate:0}],value:""},async:!0,mutiSelection:!0,returnFullPath:!1,selectLeafOnly:!1,delimiter:";",allowBlank:!0,errorMsg:BI.i18nText("Fine-Report_Preview_Can_Not_Null"),isLayerBuild:!1,getDependenceByWidget:()=>[],getWidgetDependenceValueByWidget:()=>({}),add2WaitingQueue:()=>"",removeFromWaitingQueue:()=>{},extraOptsGetter:()=>({}),oldTreeControlAttrFetcher:fetchOldParamTreeControlAttr,newTreeControlAttrFetcher:fetchNewParamTreeControlAttr,newTreeStructureFetcher:fetchNewParamTreeStructure,allowBg:!0,needCheckCustomData:!0,noGlobalMask:!1},e}return _inherits$$(t,ParameterTreeLike),_createClass$1d(t,[{key:"isTreeWidget",value:function(){return!0}},{key:"render",value:function(){const{width:e,height:t,mutiSelection:r,selectLeafOnly:n,controlAttr:o,value:i,fontSize:a,disabled:s,add2WaitingQueue:l,removeFromWaitingQueue:c,allowBg:u}=this.options;return this.updateCacheByControlAttrData(o.data),this.defaultTreeValue=transformTreeDefaultValue(i,r,n,{textValueMap:this.textValueMap,nodes:this.nodes}),this.value=this.defaultTreeValue,!r&&this.defaultTreeValue&&this.transformSingleTreeValue2Node(this.defaultTreeValue),this.treeClsName=setTreeFontSize(ParameterTree_1.BASE_CLS,a),{type:BI.VerticalLayout.xtype,cls:u?"bi-card":"",items:[{type:getParamTreeLayout(r,n,this.isAsyncTree()),cls:"".concat(this.treeClsName),ref:e=>{this.tree=e},width:e,height:t,itemsCreator:(e,t)=>{!this.silence&&this.fireEvent("nodeadd");(async()=>{const n=this.isAsyncTree()?r?await this.multiAsyncTreeItemCreator(e):await this.singleAsyncTreeItemCreator(e):await this.syncTreeItemCreator();"items"in n&&this.transformSyncSingleTreeItem(n.items),t(n),s&&this.setEnable(!s)})()},value:this.defaultTreeValue,listeners:[{eventName:"EVENT_CHANGE",action:()=>{this.hideBubble();const e=l();this.rebuildMultiTree(void 0,!1).then((()=>{c(e);!1!==(!this.silence&&this.fireEvent("click"))&&this.fireEventChange()}))}}],minHeight:t}]}}},{key:"setValue",value:async function(e,t){this.updateCacheByControlAttrData(t),await this.setControllerValue(e,t||[]),this.fireEvent("EVENT_SET_VALUE")}},{key:"setControllerValue",value:async function(e,r){await _superPropGet$7(t,"setControllerValue",this,3)([e,r]),this.tree.populate()}},{key:"setTreeValue",value:function(e){this.tree.setSelectedValue?this.tree.setSelectedValue(e):this.tree.setValue(e)}},{key:"mounted",value:async function(){_superPropGet$7(t,"mounted",this,3)([]),this.options.mutiSelection&&this.tree.populate(),await this.rebuildMultiTree(this.defaultTreeValue,!1)}},{key:"enableAutoExpand",value:function(){var e,t;null===(t=(e=this.tree).enableAutoExpand)||void 0===t||t.call(e,!0)}},{key:"reset",value:function(){_superPropGet$7(t,"reset",this,3)([]),this.tree.populate()}},{key:"reloadControlAttr",value:function(){this.reset()}},{key:"getSelectedValue",value:function(){return this.tree.getSelectedValue?this.tree.getSelectedValue():this.tree.getValue()}},{key:"setStyle",value:function(e){this.tree.element.addClass(setTreeStyle(e))}},{key:"getText",value:function(){return""}},{key:"resize",value:function(e,t){this.options.width===e&&this.options.height===t||(this.options.width=e,this.options.height=t,this.element.css("width",e),this.element.css("height",t),this.tree.setWidth(e),this.tree.setHeight(t),this.tree.element.removeClass(this.treeClsName),this.treeClsName=setTreeFontSize(ParameterTree_1.BASE_CLS,this.options.fontSize),this.tree.element.addClass("".concat(this.treeClsName)))}}])}();function setTreeComboBoxStyle(e,{opacity:t,background:r,color:n,border:o,"border-radius":i}){index.use(jssGlobal(),jssNested());const a="".concat(e,"-").concat(BI.UUID()),s=".".concat(a);return index.createStyleSheet({"@global":{["".concat(s)]:{opacity:t,background:r},["".concat(s," .bi-card")]:{background:r,color:n},["".concat(s," .bi-text")]:{color:n},["".concat(s," .bi-trigger")]:{color:n},["".concat(s," .bi-icon-button")]:{color:n},["".concat(s," .bi-border")]:{border:o,"boder-radius":i}}}).attach(),a}function _classCallCheck$1c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1b(n.key),n)}}function _createClass$1c(e,t,r){return t&&_defineProperties$1b(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1b(e){var t=_toPrimitive$1b(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1b(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$_(e,t,r){return t=_getPrototypeOf$_(t),_possibleConstructorReturn$_(e,_isNativeReflectConstruct$_()?Reflect.construct(t,r||[],_getPrototypeOf$_(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$_(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$_(e)}function _assertThisInitialized$_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$_(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$_=function(){return!!e})()}function _superPropGet$6(e,t,r,n){var o=_get$6(_getPrototypeOf$_(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$6(){return _get$6="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$6(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$6.apply(null,arguments)}function _superPropBase$6(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$_(e)););return e}function _getPrototypeOf$_(e){return(_getPrototypeOf$_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$_(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$_(e,t)}function _setPrototypeOf$_(e,t){return(_setPrototypeOf$_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ParameterTree.xtype="report.main.parameter_container.controller.tree",ParameterTree.widgetType="tree",ParameterTree.BASE_CLS=PARAMETER_TREE_BASE_CLS,ParameterTree=ParameterTree_1=__decorate$p([shortcut()],ParameterTree);var __decorate$o=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ParameterTreeComboBox_1;let ParameterTreeComboBox=ParameterTreeComboBox_1=function(e){function t(){var e;return _classCallCheck$1c(this,t),(e=_callSuper$_(this,t,arguments)).nodes=[],e.textValueMap={},e.afterMountedHook=[],e.isTreeShowValueComplete=!0,e.props={baseCls:"".concat(ParameterTreeComboBox_1.BASE_CLS),$testId:"report-main-parameter-container-controller-tree-combo-box",width:WIDTH,height:HEIGHT,value:"",delimiter:";",disabled:!1,invisible:!1,needSubmit:!0,fontSize:12,async:!1,mutiSelection:!1,returnFullPath:!1,selectLeafOnly:!1,widgetName:"",watermark:"",allowBlank:!0,customData:!1,errorMsg:BI.i18nText("Fine-Report_Preview_Can_Not_Null"),directEdit:!1,noRepeat:!1,autoMode:!1,mode:"remote",searchTime:200,isNeedAdjustWidth:!0,controlAttr:{data:[{ChildNodes:[],isexpand:!1,hasChildren:!1,id:1,text:"",showcheck:!1,complete:!0,value:"",checkstate:0}],value:""},isLayerBuild:!1,getDependenceByWidget:()=>[],getWidgetDependenceValueByWidget:()=>({}),add2WaitingQueue:()=>"",removeFromWaitingQueue:()=>{},extraOptsGetter:()=>({}),oldTreeControlAttrFetcher:fetchOldParamTreeControlAttr,newTreeControlAttrFetcher:fetchNewParamTreeControlAttr,newTreeStructureFetcher:fetchNewParamTreeStructure,allowBg:!0,needCheckCustomData:!0,returnArray:!0,startSymbol:"",endSymbol:"",noGlobalMask:!1},e.debounceResize=BI.debounce(((t,r)=>{const n=e.tree.getValue(),o=e.isEnabled();e.preResize(t,r)&&e.afterMountedHook.push((()=>{e.tree.setValue(n),e.setEnable(o),e.rebuildMultiTree(n,!1)}))}),300),e}return _inherits$_(t,ParameterTreeLike),_createClass$1c(t,[{key:"isTreeWidget",value:function(){return!1}},{key:"render",value:function(){const{width:e,height:t,fontSize:r,mutiSelection:n,selectLeafOnly:o,watermark:i,controlAttr:a,value:s,customData:l,directEdit:c,isNeedAdjustWidth:u,removeFromWaitingQueue:d,add2WaitingQueue:h,allowBg:p}=this.options;return this.updateCacheByControlAttrData(a.data),BI.isNull(this.tree)&&this.transformInteractValue2Node(s),{type:BI.VerticalLayout.xtype,cls:p?"bi-card":"",items:[Object.assign(Object.assign({type:getParamTreeComboBoxLayout(n,o,this.isAsyncTree(),l)},this.options.watermark?{}:{text:""}),{defaultText:this.options.watermark,watermark:i,allowSearchValue:c,cls:"".concat(setComboFontSize(ParameterTreeComboBox_1.BASE_CLS,{fontSize:r,width:e,height:t})),isNeedAdjustWidth:u,width:e,height:t,allowEdit:c,allowInsertValue:l,ref:e=>{this.tree=e},valueFormatter:e=>{if(e===this.singleTreeNotSelectedValue)return"";const t=this.nodes.find((t=>t.value===e));return t||(this.isTreeShowValueComplete=!1),(null==t?void 0:t.text)||getSingleTreeTextByValue(e,this.nodes)||""},warningTitle:"",belowMouse:!0,itemsCreator:this.isAsyncTree()?async(e,t)=>{!this.silence&&this.fireEvent("nodeadd");const r=n?await this.multiAsyncTreeItemCreator(e):await this.singleAsyncTreeItemCreator(e);this.transformSyncSingleTreeItem(r.items),t(r)}:void 0,value:this.defaultTreeValue,listeners:[{eventName:"EVENT_CLICK_ITEM",action:e=>{this.hideBubble();const t=h();this.rebuildMultiTree(e,!1).then((()=>{d(t),!this.silence&&this.fireEvent("click"),!this.silence&&this.fireEvent("afteredit")}))}},{eventName:"EVENT_CONFIRM",action:()=>{const e=h();this.rebuildMultiTree(void 0,!1).then((()=>{d(e);!1!==(!this.silence&&this.fireEvent("stopedit"))&&this.fireEventChange()}))}},{eventName:"EVENT_CHANGE",action:()=>{const e=h();this.rebuildMultiTree(void 0,!1).then((()=>{n||(!this.silence&&this.fireEvent("click"),!this.silence&&this.fireEvent("afteredit")),d(e);!1!==(!this.silence&&this.fireEvent("stopedit"))&&this.fireEventChange()}))}},{eventName:"EVENT_FOCUS",action:()=>{!this.silence&&this.fireEvent("beforeedit")}},{eventName:"EVENT_BEFORE_POPUPVIEW",action:()=>{this.hideBubble()}},{eventName:"EVENT_SEARCHING",action:()=>{!this.silence&&this.fireEvent("afteredit")}}]})]}}},{key:"mounted",value:async function(){_superPropGet$6(t,"mounted",this)([]),await this.rebuildMultiTree(this.defaultTreeValue,!1),!this.isTreeShowValueComplete&&this.isAsyncTree()&&(await this.updateCacheByValue(this.defaultTreeValue),this.setTreeValue(this.defaultTreeValue),this.isTreeShowValueComplete=!0),await this.loadSyncTree(),this.afterMountedHook.forEach((e=>e())),this.afterMountedHook=[]}},{key:"emitManualStopEditEvent",value:function(){this.fireEvent("stopedit")}},{key:"updateDefaultValue",value:function(e){this.defaultTreeValue=transformTreeDefaultValue(e,this.options.mutiSelection,this.options.selectLeafOnly,{textValueMap:this.textValueMap,nodes:this.nodes}),this.value=this.defaultTreeValue}},{key:"addDefaultValue2SingleTreeNode",value:function(e){!this.options.mutiSelection&&e&&this.transformSingleTreeValue2Node(e)}},{key:"transformInteractValue2Node",value:function(e){this.updateDefaultValue(e),this.addDefaultValue2SingleTreeNode(this.defaultTreeValue)}},{key:"setInteractValue",value:async function(e){this.updateDefaultValue(e.value),await _superPropGet$6(t,"setInteractValue",this)([e]),this.addDefaultValue2SingleTreeNode(this.defaultTreeValue),this.reloadTree()}},{key:"reloadControlAttr",value:function(){this.reset(),this.reloadTree()}},{key:"reloadTree",value:function(){this.loadSyncTree(),this.loadAsyncSingleTree()}},{key:"setControllerValue",value:async function(e,r=[]){await _superPropGet$6(t,"setControllerValue",this)([e,r]),this.reloadTree()}},{key:"loadAsyncSingleTree",value:function(){this.isAsyncTree()&&!this.options.mutiSelection&&this.tree.populate()}},{key:"loadSyncTree",value:async function(){!this.isAsyncTree()&&await this.syncTreeItemCreator().then((e=>{!this.silence&&this.fireEvent("nodeadd"),this.transformSyncSingleTreeItem(e.items),this.tree.populate(e.items),this.tree.setValue(this.value||this.defaultTreeValue)}))}},{key:"resize",value:function(e,t){this.debounceResize(e,t)}},{key:"getAdapter",value:function(){return this.tree.getSearcher()}},{key:"setStyle",value:function(e){this.tree.element.addClass(setTreeComboBoxStyle(ParameterTreeComboBox_1.BASE_CLS,e))}},{key:"setPopupStyle",value:function(){}},{key:"getText",value:function(){var e,t;return null===(t=null===(e=this.getAdapter())||void 0===e?void 0:e.editor)||void 0===t?void 0:t.getText()}},{key:"setWaterMark",value:function(e){this.options.watermark=e,this.tree.setWaterMark(e),this.tree.setValue(this.tree.getValue())}},{key:"focus",value:function(){this.tree.focus()}},{key:"blur",value:function(){this.tree.blur()}},{key:"reset",value:function(){_superPropGet$6(t,"reset",this)([]),this.defaultTreeValue=void 0}}])}();function _classCallCheck$1b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1a(n.key),n)}}function _createClass$1b(e,t,r){return t&&_defineProperties$1a(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1a(e){var t=_toPrimitive$1a(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1a(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}ParameterTreeComboBox.xtype="report.main.parameter_container.controller.editor.tree_combo_box",ParameterTreeComboBox.widgetType="treecombobox",ParameterTreeComboBox.BASE_CLS="report-main-parameter-container-controller-tree-combo-box",ParameterTreeComboBox=ParameterTreeComboBox_1=__decorate$o([shortcut()],ParameterTreeComboBox);var __decorate$n=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};errorHandlerProvider.setHandler(CONTROLLER_ATTR_ERROR_CODE.HAVE_RING,ControllerAttrErrorHandler),errorHandlerProvider.setHandler(CONTROLLER_ATTR_ERROR_CODE.SAME_ORIGIN_ITEM,ControllerAttrErrorHandler);let ControllerProvider=_createClass$1b((function e(){_classCallCheck$1b(this,e),this.controllerDict=new Map([[ParameterButton.widgetType,ParameterButton.xtype],["freebutton",ParameterButton.xtype],["formsubmit",ParameterButton.xtype],[ParameterCheckbox.widgetType,ParameterCheckbox.xtype],[ParameterCheckboxGroup.widgetType,ParameterCheckboxGroup.xtype],[ParameterComboNext.widgetType,ParameterComboNext.xtype],[ParameterDatetime.widgetType,ParameterDatetime.xtype],[ParameterLabel.widgetType,ParameterLabel.xtype],[ParameterNumber.widgetType,ParameterNumber.xtype],[ParameterPassword.widgetType,ParameterPassword.xtype],[ParameterRadioGroup.widgetType,ParameterRadioGroup.xtype],[ParameterTagComboCheckboxNext.widgetType,ParameterTagComboCheckboxNext.xtype],["combocheckbox",ParameterTagComboCheckboxNext.xtype],[ParameterText.widgetType,ParameterText.xtype],[ParameterTextarea.widgetType,ParameterTextarea.xtype],[ParameterTree.widgetType,ParameterTree.xtype],[ParameterTreeComboBox.widgetType,ParameterTreeComboBox.xtype],[ParameterMultifile.widgetType,ParameterMultifile.xtype],[PageFixedRowCombobox.widgetType,PageFixedRowCombobox.xtype]])}),[{key:"get",value:function(e){return this.controllerDict.get(e)||ParameterEmpty.xtype}},{key:"set",value:function(e,t){this.controllerDict.set(e,t)}},{key:"getImpl",value:function(){return ParameterEmpty}}]),ReportControllerProvider=_createClass$1b((function e(){_classCallCheck$1b(this,e)}),[{key:"$get",value:function(){return ControllerProvider}}]);ReportControllerProvider.xtype="report.controller.provider",ReportControllerProvider=__decorate$n([provider()],ReportControllerProvider);const controllerProvider=BI.Providers.getProvider(ReportControllerProvider.xtype);function _classCallCheck$1a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$19(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$19(n.key),n)}}function _createClass$1a(e,t,r){return t&&_defineProperties$19(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$19(e){var t=_toPrimitive$19(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$19(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$Z(e,t,r){return t=_getPrototypeOf$Z(t),_possibleConstructorReturn$Z(e,_isNativeReflectConstruct$Z()?Reflect.construct(t,r||[],_getPrototypeOf$Z(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$Z(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$Z(e)}function _assertThisInitialized$Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$Z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$Z=function(){return!!e})()}function _getPrototypeOf$Z(e){return(_getPrototypeOf$Z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$Z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$Z(e,t)}function _setPrototypeOf$Z(e,t){return(_setPrototypeOf$Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _classCallCheck$19(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$18(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$18(n.key),n)}}function _createClass$19(e,t,r){return t&&_defineProperties$18(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$18(e){var t=_toPrimitive$18(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$18(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$Y(e,t,r){return t=_getPrototypeOf$Y(t),_possibleConstructorReturn$Y(e,_isNativeReflectConstruct$Y()?Reflect.construct(t,r||[],_getPrototypeOf$Y(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$Y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$Y(e)}function _assertThisInitialized$Y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$Y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$Y=function(){return!!e})()}function _getPrototypeOf$Y(e){return(_getPrototypeOf$Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$Y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$Y(e,t)}function _setPrototypeOf$Y(e,t){return(_setPrototypeOf$Y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}!function(e){function t(){return _classCallCheck$1a(this,t),_callSuper$Z(this,t,arguments)}_inherits$Z(t,WidgetManager),_createClass$1a(t,[{key:"getWidgetDependenceValueByWidget",value:function(e){const t=this.getDependenceByWidget(e),r=this.getNeedSubmitWidgets(),n={};return r.forEach((e=>{const r=e.attr("widgetName");CoreWidgetManager.compareWidgetNameByDependences(r,t)&&e.validate()&&(n["$".concat(r)]=e.getValue())})),n}},{key:"getValidatedNeedSubmitWidgets",value:function(){return this.getNeedSubmitWidgets().filter((e=>e.validate()))}},{key:"getNeedSubmitWidgets",value:function(){return this.getWidgets().filter((e=>e.attr("needSubmit")))}},{key:"getValidatedNeedSubmitWidgetsSortByDependences",value:function(){return this.sortWidgetsByDependences(this.getValidatedNeedSubmitWidgets())}},{key:"getNeedSubmitWidgetsSortByDependences",value:function(){return this.sortWidgetsByDependences(this.getNeedSubmitWidgets())}},{key:"sortWidgetsByDependences",value:function(e){const t=new Map;return e.forEach((e=>{const r=e.attr("widgetName").toUpperCase();this.getWidgetDependenceByWidgetName(r).map((e=>e.toUpperCase())).forEach((e=>{const r=(t.get(e)||0)+1;t.set(e,r)}))})),e.sort(((e,r)=>{const n=e.attr("widgetName").toUpperCase(),o=r.attr("widgetName").toUpperCase(),i=t.get(n)||0,a=t.get(o)||0;return i<a?-1:i>a?1:0}))}},{key:"getValidatedNeedSubmitValue",value:function(){return this.getSubmitValueByWidgets(this.getValidatedNeedSubmitWidgets())}},{key:"getNeedSubmitValue",value:function(){return this.getSubmitValueByWidgets(this.getNeedSubmitWidgets())}},{key:"getNeedSubmitValueWithWidgetType",value:function(){return this.getNeedSubmitWidgets().map((e=>({name:e.attr("widgetName"),value:e.getValue(),widgetType:e.attr("xtype")})))}},{key:"getNeedSubmitValueWithWidgetTypeByNames",value:function(e){return this.getNeedSubmitWidgets().map((t=>{const r=t.attr("widgetName");return{name:r,value:e[r],widgetType:t.attr("xtype")}}))}},{key:"getSubmitValueByWidgets",value:function(e){return e.reduce(((e,t)=>{const r=t.getSubmitValue();return Object.assign(e,r),e}),{})}},{key:"getLinkageData",value:function(e){const t=this.getValidatedNeedSubmitValue(),r=this.getWidgetDependenceByWidgetName(e);for(const n in t)r.includes(n)&&(t[n]="");return{value:t,widgetNames:r}}},{key:"validateWidgets",value:function(){const e=this.getNeedSubmitWidgets().filter((e=>!e.validateAndToast()));return BI.isEmptyArray(e)}},{key:"collectionValue",value:function(){return this.getNeedSubmitValue()}},{key:"dbCommit",value:function(e){dbCommit(e,this.getValidatedNeedSubmitValue()).then((e=>e.callback&&e.callback.call({options:{form:this}},e)))}}])}();let AbstractParameterCellControllerWidget=function(e){function t(){return _classCallCheck$19(this,t),_callSuper$Y(this,t,arguments)}return _inherits$Y(t,AbstractParameterControllerWidget),_createClass$19(t,[{key:"getDependenceValue",value:function(){return this.getValue()}}])}();function _classCallCheck$18(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$17(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$17(n.key),n)}}function _createClass$18(e,t,r){return t&&_defineProperties$17(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$17(e){var t=_toPrimitive$17(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$17(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$X(e,t,r){return t=_getPrototypeOf$X(t),_possibleConstructorReturn$X(e,_isNativeReflectConstruct$X()?Reflect.construct(t,r||[],_getPrototypeOf$X(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$X(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$X(e)}function _assertThisInitialized$X(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$X(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$X=function(){return!!e})()}function _getPrototypeOf$X(e){return(_getPrototypeOf$X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$X(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$X(e,t)}function _setPrototypeOf$X(e,t){return(_setPrototypeOf$X=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __decorate$m=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__rest$e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};let CellButton=function(e){function t(){var e;return _classCallCheck$18(this,t),(e=_callSuper$X(this,t,arguments)).props={width:WIDTH,height:HEIGHT,fontSize:12,xlisteners:[],baseCls:"",text:"",key:"",xtype:"",value:""},e}return _inherits$X(t,AbstractParameterCellControllerWidget),_createClass$18(t,[{key:"render",value:function(){const e=this.options,{xlisteners:t,baseCls:r}=e,n=__rest$e(e,["xlisteners","baseCls"]);return Object.assign(Object.assign({},n),{type:ParameterButton.xtype,ref:e=>{this.button=e},text:n.text||n.value,value:n.value||n.text,listeners:t,xtype:"formsubmit"===n.key?"formsubmit":n.xtype})}},{key:"getValue",value:function(){return this.button.getValue()}},{key:"postGetValidation",value:function(){return this.button.postGetValidation()}},{key:"preGetValidation",value:function(){return this.button.preGetValidation()}},{key:"setControllerValue",value:async function(e){await this.button.setControllerValue(e)}},{key:"reset",value:function(){this.button.reset()}},{key:"postValidateAndToast",value:function(){return this.button.postValidateAndToast()}},{key:"setInteractValue",value:function(e){this.button.setInteractValue(e)}},{key:"setStyle",value:function(){}}])}();function _classCallCheck$17(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$16(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$16(n.key),n)}}function _createClass$17(e,t,r){return t&&_defineProperties$16(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$16(e){var t=_toPrimitive$16(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$16(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$W(e,t,r){return t=_getPrototypeOf$W(t),_possibleConstructorReturn$W(e,_isNativeReflectConstruct$W()?Reflect.construct(t,r||[],_getPrototypeOf$W(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$W(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$W(e)}function _assertThisInitialized$W(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$W(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$W=function(){return!!e})()}function _getPrototypeOf$W(e){return(_getPrototypeOf$W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$W(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$W(e,t)}function _setPrototypeOf$W(e,t){return(_setPrototypeOf$W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}CellButton.xtype="report.main.table_cell.controller.button",CellButton=__decorate$m([shortcut()],CellButton);var __decorate$l=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__rest$d=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};let CellCheckBox=function(e){function t(){var e;return _classCallCheck$17(this,t),(e=_callSuper$W(this,t,arguments)).props={width:WIDTH,height:HEIGHT,fontSize:12,reportIndex:0,position:{row:0,column:0},xlisteners:[],baseCls:""},e}return _inherits$W(t,AbstractParameterCellControllerWidget),_createClass$17(t,[{key:"render",value:function(){const e=this.options,{xlisteners:t,position:r,reportIndex:n,baseCls:o}=e,i=__rest$d(e,["xlisteners","position","reportIndex","baseCls"]);return Object.assign(Object.assign({},i),{type:ParameterCheckbox.xtype,ref:e=>{this.checkbox=e},listeners:t})}},{key:"postValidateAndToast",value:function(){return this.checkbox.postValidateAndToast()}},{key:"preGetValidation",value:function(){return this.checkbox.preGetValidation()}},{key:"postGetValidation",value:function(){return this.checkbox.postGetValidation()}},{key:"getValue",value:function(){return this.checkbox.getValue()}},{key:"setControllerValue",value:async function(e){await this.checkbox.setControllerValue(e)}},{key:"setInteractValue",value:function(e){this.checkbox.setInteractValue(e)}},{key:"reset",value:function(){this.checkbox.reset()}},{key:"setStyle",value:function(){}}])}();function fetchCellBasicControlAttr(e,t={}){return requestPost("cell/widget/data",{data:Object.assign(Object.assign({},t),{widgetname:e})})}function fetchCellComboControlAttr(e,t={}){return fetchCellBasicControlAttr(e,t)}function fetchCellWidgetViewValue(e){return requestGet("cell/widget/view/value",{params:e})}function fetchCellDatetimeControlAttr(e,t={}){return fetchCellBasicControlAttr(e,t)}function fetchCellGroupControlAttr(e,t={}){return fetchCellBasicControlAttr(e,t)}function fetchOldCellTreeControlAttr(e,t={}){return fetchCellBasicControlAttr(e,t)}function fetchNewCellTreeStructure(e,t={}){return fetchCellBasicControlAttr(e,Object.assign(Object.assign({},t),{fine_outlet_widget:"nx",completion:!0}))}function fetchNewCellTreeControlAttr(e,t={}){return fetchCellBasicControlAttr(e,Object.assign(Object.assign({},t),{fine_outlet_widget:"nx"}))}function fetchIframeControlAttr(e,t={}){return fetchCellBasicControlAttr(e,t)}function _classCallCheck$16(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$15(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$15(n.key),n)}}function _createClass$16(e,t,r){return t&&_defineProperties$15(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$15(e){var t=_toPrimitive$15(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$15(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$V(e,t,r){return t=_getPrototypeOf$V(t),_possibleConstructorReturn$V(e,_isNativeReflectConstruct$V()?Reflect.construct(t,r||[],_getPrototypeOf$V(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$V(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$V(e)}function _assertThisInitialized$V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$V(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$V=function(){return!!e})()}function _getPrototypeOf$V(e){return(_getPrototypeOf$V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$V(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$V(e,t)}function _setPrototypeOf$V(e,t){return(_setPrototypeOf$V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}CellCheckBox.xtype="report.main.table_cell.controller.checkbox",CellCheckBox=__decorate$l([shortcut()],CellCheckBox);var __decorate$k=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__rest$c=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};let CellCheckboxGroup=function(e){function t(){var e;return _classCallCheck$16(this,t),(e=_callSuper$V(this,t,arguments)).props={width:WIDTH,height:HEIGHT,fontSize:12,reportIndex:0,position:{row:0,column:0},xlisteners:[],baseCls:""},e}return _inherits$V(t,AbstractParameterCellControllerWidget),_createClass$16(t,[{key:"render",value:function(){const e=this.options,{xlisteners:t,position:r,reportIndex:n,baseCls:o}=e,i=__rest$c(e,["xlisteners","position","reportIndex","baseCls"]);return Object.assign(Object.assign({},i),{type:ParameterCheckboxGroup.xtype,cls:"report-hide-scrollbar",ref:e=>{this.group=e},listeners:t,controlAttrFetcher:fetchCellGroupControlAttr,extraOptsGetter:()=>({location:Object.assign(Object.assign({},r),{reportIndex:n})}),beforeRender(e){this.updateControlAttr().then((()=>e()))}})}},{key:"mounted",value:function(){}},{key:"getValue",value:function(){return this.group.getValue()}},{key:"postGetValidation",value:function(){return this.group.postGetValidation()}},{key:"preGetValidation",value:function(){return this.group.preGetValidation()}},{key:"setControllerValue",value:async function(e){await this.group.setControllerValue(e)}},{key:"reset",value:function(){this.group.reset()}},{key:"postValidateAndToast",value:function(){return this.group.postValidateAndToast()}},{key:"setInteractValue",value:function(e){this.group.setInteractValue(e)}},{key:"reloadControlAttr",value:function(){this.group.reloadControlAttr()}},{key:"setStyle",value:function(){}}])}();function _classCallCheck$15(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$14(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$14(n.key),n)}}function _createClass$15(e,t,r){return t&&_defineProperties$14(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$14(e){var t=_toPrimitive$14(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$14(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$U(e,t,r){return t=_getPrototypeOf$U(t),_possibleConstructorReturn$U(e,_isNativeReflectConstruct$U()?Reflect.construct(t,r||[],_getPrototypeOf$U(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$U(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$U(e)}function _assertThisInitialized$U(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$U(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$U=function(){return!!e})()}function _getPrototypeOf$U(e){return(_getPrototypeOf$U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$U(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$U(e,t)}function _setPrototypeOf$U(e,t){return(_setPrototypeOf$U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}CellCheckboxGroup.xtype="report.main.table_cell.controller.checkbox_group",CellCheckboxGroup=__decorate$k([shortcut()],CellCheckboxGroup);var __decorate$j=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__rest$b=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};let CellCombo=function(e){function t(){var e;return _classCallCheck$15(this,t),(e=_callSuper$U(this,t,arguments)).props={width:WIDTH,height:HEIGHT,fontSize:12,reportIndex:0,position:{row:0,column:0},xlisteners:[],baseCls:""},e}return _inherits$U(t,AbstractParameterCellControllerWidget),_createClass$15(t,[{key:"render",value:function(){const e=this.options,{xlisteners:t,position:r,reportIndex:n,baseCls:o}=e,i=__rest$b(e,["xlisteners","position","reportIndex","baseCls"]);return Object.assign(Object.assign({},i),{allowCount:!0,type:ParameterComboNext.xtype,ref:e=>{this.combo=e},listeners:t,needCheckCustomData:!1,controlAttrFetcher:fetchCellComboControlAttr,extraOptsGetter:()=>({location:Object.assign(Object.assign({},r),{reportIndex:n})}),viewValueFetcher:fetchCellWidgetViewValue,beforeRender(e){this.updateControllAttrByValue(this.options.value).then((()=>e()))}})}},{key:"mounted",value:function(){}},{key:"getValue",value:function(){return this.combo.getValue()}},{key:"postGetValidation",value:function(){return this.combo.postGetValidation()}},{key:"preGetValidation",value:function(){return this.combo.preGetValidation()}},{key:"setControllerValue",value:async function(e,t){await this.combo.setControllerValue(e,t)}},{key:"reset",value:function(){this.combo.reset()}},{key:"postValidateAndToast",value:function(){return this.combo.postValidateAndToast()}},{key:"setInteractValue",value:function(e){this.combo.setInteractValue(e)}},{key:"reloadControlAttr",value:function(){this.combo.reloadControlAttr()}},{key:"getAdapter",value:function(){return this.combo.getAdapter()}},{key:"setStyle",value:function(){}},{key:"focus",value:function(){this.combo.focus()}},{key:"blur",value:function(){this.combo.blur()}}])}();function _classCallCheck$14(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$13(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$13(n.key),n)}}function _createClass$14(e,t,r){return t&&_defineProperties$13(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$13(e){var t=_toPrimitive$13(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$13(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$T(e,t,r){return t=_getPrototypeOf$T(t),_possibleConstructorReturn$T(e,_isNativeReflectConstruct$T()?Reflect.construct(t,r||[],_getPrototypeOf$T(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$T(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$T(e)}function _assertThisInitialized$T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$T(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$T=function(){return!!e})()}function _getPrototypeOf$T(e){return(_getPrototypeOf$T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$T(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$T(e,t)}function _setPrototypeOf$T(e,t){return(_setPrototypeOf$T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}CellCombo.xtype="report.main.table_cell.controller.combo",CellCombo=__decorate$j([shortcut()],CellCombo);var __decorate$i=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__rest$a=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};let CellDatetime=function(e){function t(){var e;return _classCallCheck$14(this,t),(e=_callSuper$T(this,t,arguments)).props={width:WIDTH,height:HEIGHT,fontSize:12,reportIndex:0,position:{row:0,column:0},xlisteners:[],baseCls:""},e}return _inherits$T(t,AbstractParameterCellControllerWidget),_createClass$14(t,[{key:"render",value:function(){const e=this.options,{xlisteners:t,position:r,reportIndex:n,baseCls:o}=e,i=__rest$a(e,["xlisteners","position","reportIndex","baseCls"]);return Object.assign(Object.assign({},i),{container:"body",type:ParameterDatetime.xtype,ref:e=>{this.combo=e},listeners:t,controlAttrFetcher:fetchCellDatetimeControlAttr,extraOptsGetter:()=>({location:Object.assign(Object.assign({},r),{reportIndex:n})})})}},{key:"getValue",value:function(){return this.combo.getValue()}},{key:"postGetValidation",value:function(){return this.combo.postGetValidation()}},{key:"preGetValidation",value:function(){return this.combo.preGetValidation()}},{key:"setControllerValue",value:async function(e){await this.combo.setControllerValue(e)}},{key:"reset",value:function(){this.combo.reset()}},{key:"postValidateAndToast",value:function(){return this.combo.postValidateAndToast()}},{key:"setInteractValue",value:function(e){this.combo.setInteractValue(e)}},{key:"reloadControlAttr",value:function(){this.combo.setInteractValue("".concat(this.combo.getValue()))}},{key:"setStyle",value:function(){}},{key:"focus",value:function(){this.combo.focus()}},{key:"blur",value:function(){this.combo.blur()}}])}();function _classCallCheck$13(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$12(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$12(n.key),n)}}function _createClass$13(e,t,r){return t&&_defineProperties$12(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$12(e){var t=_toPrimitive$12(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$12(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$S(e,t,r){return t=_getPrototypeOf$S(t),_possibleConstructorReturn$S(e,_isNativeReflectConstruct$S()?Reflect.construct(t,r||[],_getPrototypeOf$S(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$S(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$S(e)}function _assertThisInitialized$S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$S(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$S=function(){return!!e})()}function _getPrototypeOf$S(e){return(_getPrototypeOf$S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$S(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$S(e,t)}function _setPrototypeOf$S(e,t){return(_setPrototypeOf$S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}CellDatetime.xtype="report.main.table_cell.controller.datetime",CellDatetime=__decorate$i([shortcut()],CellDatetime);var __decorate$h=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let CellIframe=function(e){function t(){var e;return _classCallCheck$13(this,t),(e=_callSuper$S(this,t,arguments)).props={src:"",width:WIDTH,height:HEIGHT,fontSize:12,value:"",showOverFlowX:!1,showOverFlowY:!1,widgetName:"",cellWidgetName:"",reportIndex:0,position:{row:0,column:0}},e}return _inherits$S(t,AbstractParameterCellControllerWidget),_createClass$13(t,[{key:"render",value:function(){const{src:e,width:t,height:r,showOverFlowX:n,showOverFlowY:o,cellWidgetName:i}=this.options,a=n||o?"yes":"no";return{type:BI.AbsoluteLayout.xtype,items:[{el:{type:BI.Iframe.xtype,ref:e=>{this.iframe=e},src:e,width:t,height:r,name:i,attributes:{scrolling:a}},top:0,left:0,right:0,bottom:0}]}}},{key:"beforeInit",value:function(){return this.getIframeControlAttr()}},{key:"getIframeControlAttr",value:function(){const{widgetName:e}=this.options;return fetchIframeControlAttr(e,this.getRequestOpts()).then((e=>{let t={};e.forEach((e=>{t=Object.assign(Object.assign({},t),e)})),this.options.src=appendParams2Url(this.options.src,t)}))}},{key:"getRequestOpts",value:function(){const{position:e,reportIndex:t}=this.options;return{location:Object.assign(Object.assign({},e),{reportIndex:t})}}},{key:"getValue",value:function(){return this.iframe.getSrc()}},{key:"setControllerValue",value:async function(e){this.iframe.setSrc(e)}},{key:"setInteractValue",value:function(e){this.iframe.setSrc(e)}},{key:"reset",value:function(){this.iframe.reset()}},{key:"preGetValidation",value:function(){return{result:!0}}},{key:"postGetValidation",value:function(){return{result:!0}}},{key:"postValidateAndToast",value:function(){return!0}},{key:"setStyle",value:function(){}}])}();function _classCallCheck$12(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$11(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$11(n.key),n)}}function _createClass$12(e,t,r){return t&&_defineProperties$11(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$11(e){var t=_toPrimitive$11(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$11(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$R(e,t,r){return t=_getPrototypeOf$R(t),_possibleConstructorReturn$R(e,_isNativeReflectConstruct$R()?Reflect.construct(t,r||[],_getPrototypeOf$R(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$R(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$R(e)}function _assertThisInitialized$R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$R(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$R=function(){return!!e})()}function _getPrototypeOf$R(e){return(_getPrototypeOf$R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$R(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$R(e,t)}function _setPrototypeOf$R(e,t){return(_setPrototypeOf$R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}CellIframe.xtype="report.main.table_cell.controller.iframe",CellIframe=__decorate$h([shortcut()],CellIframe);var __decorate$g=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let CellList=function(e){function t(){var e;return _classCallCheck$12(this,t),(e=_callSuper$R(this,t,arguments)).props={width:WIDTH,height:HEIGHT,fontSize:12,value:"",needSubmit:!1,disabled:!1,invisible:!1,allowBlank:!0,errorMsg:BI.i18nText("Fine-Report_Preview_Can_Not_Null"),controlAttr:{data:[],value:""},needHead:!1,widgetName:"",reportIndex:0,position:{row:0,column:0}},e}return _inherits$R(t,AbstractParameterCellControllerWidget),_createClass$12(t,[{key:"render",value:function(){const{needHead:e}=this.options;return{type:BI.AbsoluteLayout.xtype,items:[{el:{type:BI.VerticalLayout.xtype,items:[{type:BI.CenterAdaptLayout.xtype,cls:"bi-background",items:[{type:BI.ButtonGroup.xtype,layouts:[{type:BI.VerticalAdaptLayout.xtype,hgap:2}],items:[{type:BI.IconButton.xtype,cls:"list-add-font report-list-item-active icon-size-16",handler:()=>{const e=window.prompt(BI.i18nText("Fine-Report_Input"));BI.isNull(e)||BI.isEmptyString(e)?BI.Msg.toast(BI.i18nText("Fine-Report_Name_Empty")):this.addItemByValue(e)}},{type:BI.IconButton.xtype,cls:"list-delete-font report-list-item-active icon-size-16",handler:()=>{this.removeSelectedItem()}},{type:BI.IconButton.xtype,cls:"list-rename-font report-list-item-active icon-size-16",handler:()=>{const e=this.getSelectedIndex();if(-1===e)return void BI.Msg.toast(BI.i18nText("Fine-Report_Item_Not_Selected"));const t=this.pane.getAllButtons()[e],r=t.attr("text"),n=window.prompt("Rename:",r);BI.isNull(n)||BI.isEmptyString(n)?this.removeSelectedItem():(t.setText(n),this.options.controlAttr.data[e].text=n)}}],invisible:!e,height:20}]},{type:BI.ListPane.xtype,ref:e=>{this.pane=e},items:this.getGroupItems(),el:{type:BI.ButtonGroup.xtype,chooseType:BI.Selection.None,layouts:[{type:BI.VerticalLayout.xtype}]}}]},top:0,left:0,right:0,bottom:0}],invisible:!this.postGetValidation().result}}},{key:"removeSelectedItem",value:function(){const e=this.getSelectedIndex();-1!==e?(this.pane.removeItemAt(e),this.options.controlAttr.data.splice(e,1)):BI.Msg.toast(BI.i18nText("Fine-Report_Item_Not_Selected"))}},{key:"getSelectedIndex",value:function(){return this.pane.getAllButtons().findIndex((e=>e.isSelected()))}},{key:"addItemByValue",value:function(e){this.pane.addItems(this.createItems([{text:e,value:e}])),this.options.controlAttr.data.push({text:e,value:e})}},{key:"beforeInit",value:function(e){this.getGroupControlAttr().then((()=>e()))}},{key:"getGroupItems",value:function(){return this.createItems(this.options.controlAttr.data)}},{key:"getGroupControlAttr",value:function(){const{widgetName:e}=this.options;return fetchCellGroupControlAttr(e,this.getRequestOpts()).then((e=>{this.options.controlAttr={data:e,value:this.options.value}}))}},{key:"getRequestOpts",value:function(){const{position:e,reportIndex:t}=this.options;return{location:Object.assign(Object.assign({},e),{reportIndex:t})}}},{key:"getValue",value:function(){var e;return(null===(e=this.pane.getAllButtons().find((e=>e.isSelected())))||void 0===e?void 0:e.getValue())||""}},{key:"setControllerValue",value:async function(e=""){const t="".concat(e),r=this.pane.getAllButtons();r.forEach((e=>{e.setSelected(!1)}));let n=r.some((e=>"".concat(e.getValue())==="".concat(t)&&(e.setSelected(!0),!0)));n||(n=r.some((e=>"".concat(e.attr("text"))==="".concat(t)&&(e.setSelected(!0),!0)))),!n&&t&&this.addItemByValue(t)}},{key:"setInteractValue",value:function(){}},{key:"reset",value:function(){this.pane.getAllButtons().forEach((e=>{e.setSelected(!1)}))}},{key:"reloadControlAttr",value:function(){this.getGroupControlAttr().then((()=>{this.pane.populate(this.getGroupItems())}))}},{key:"preGetValidation",value:function(){return{result:!0}}},{key:"postGetValidation",value:function(){const{errorMsg:e}=this.options,t="".concat(this.getGroupItems())||"";return BI.isNull(t)||BI.isEmptyString(t)?{result:!1,errorMsg:e}:{result:!0}}},{key:"postValidateAndToast",value:function(){return!0}},{key:"createItems",value:function(e){return e.map((e=>{let t;return Object.assign(Object.assign({},e),{type:BI.SingleSelectItem.xtype,ref:e=>{t=e},cls:"bi-list-item-active2",height:12,listeners:[{eventName:BI.SingleSelectItem.EVENT_CHANGE,action:()=>{this.pane.getAllButtons().forEach((e=>{e.setSelected(!1)})),t.setSelected(!0)}}]})}))}},{key:"setStyle",value:function(){}}])}();function _classCallCheck$11(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$10(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$10(n.key),n)}}function _createClass$11(e,t,r){return t&&_defineProperties$10(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$10(e){var t=_toPrimitive$10(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$10(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$Q(e,t,r){return t=_getPrototypeOf$Q(t),_possibleConstructorReturn$Q(e,_isNativeReflectConstruct$Q()?Reflect.construct(t,r||[],_getPrototypeOf$Q(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$Q(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$Q(e)}function _assertThisInitialized$Q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$Q(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$Q=function(){return!!e})()}function _getPrototypeOf$Q(e){return(_getPrototypeOf$Q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$Q(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$Q(e,t)}function _setPrototypeOf$Q(e,t){return(_setPrototypeOf$Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}CellList.xtype="report.main.table_cell.controller.list",CellList=__decorate$g([shortcut()],CellList);var __decorate$f=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__rest$9=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};let CellMultifile=function(e){function t(){var e;return _classCallCheck$11(this,t),(e=_callSuper$Q(this,t,arguments)).props={width:WIDTH,height:HEIGHT,fontSize:12,xlisteners:[],baseCls:"",allowBlank:!0,errorMsg:""},e}return _inherits$Q(t,AbstractParameterCellControllerWidget),_createClass$11(t,[{key:"render",value:function(){const e=this.options,{xlisteners:t,baseCls:r}=e,n=__rest$9(e,["xlisteners","baseCls"]);return Object.assign(Object.assign({},n),{type:ParameterMultifile.xtype,ref:e=>{this.editor=e},listeners:t,url:"write/attachment/upload",cls:"bi-card"})}},{key:"getValue",value:function(){const e=this.editor.getUploadFiles().map((e=>Object.assign(Object.assign({},e),{attach_url:getDownloadFileUrl(e.attach_id)})));return 1===BI.size(e)?BI.first(e):e}},{key:"postGetValidation",value:function(){const{allowBlank:e,errorMsg:t}=this.options;return e||BI.size(this.editor.getUploadFiles())>0?{result:!0}:{result:!1,errorMsg:t||BI.i18nText("Fine-Report_Preview_Can_Not_Null")}}},{key:"preGetValidation",value:function(){return this.editor.preGetValidation()}},{key:"setControllerValue",value:async function(){await this.editor.setControllerValue()}},{key:"reset",value:function(){this.editor.reset()}},{key:"postValidateAndToast",value:function(){return this.editor.postValidateAndToast()}},{key:"setInteractValue",value:function(){this.editor.setInteractValue()}},{key:"setStyle",value:function(){}}])}();function _classCallCheck$10(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$$(n.key),n)}}function _createClass$10(e,t,r){return t&&_defineProperties$$(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$$(e){var t=_toPrimitive$$(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$$(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$P(e,t,r){return t=_getPrototypeOf$P(t),_possibleConstructorReturn$P(e,_isNativeReflectConstruct$P()?Reflect.construct(t,r||[],_getPrototypeOf$P(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$P(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$P(e)}function _assertThisInitialized$P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$P(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$P=function(){return!!e})()}function _getPrototypeOf$P(e){return(_getPrototypeOf$P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$P(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$P(e,t)}function _setPrototypeOf$P(e,t){return(_setPrototypeOf$P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}CellMultifile.xtype="report.main.table_cell.controller.multifile",CellMultifile=__decorate$f([shortcut()],CellMultifile);var __decorate$e=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__rest$8=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};let CellNumber=function(e){function t(){var e;return _classCallCheck$10(this,t),(e=_callSuper$P(this,t,arguments)).props={width:WIDTH,height:HEIGHT,fontSize:12,xlisteners:[],baseCls:""},e}return _inherits$P(t,AbstractParameterCellControllerWidget),_createClass$10(t,[{key:"render",value:function(){const e=this.options,{xlisteners:t,baseCls:r}=e,n=__rest$8(e,["xlisteners","baseCls"]);return Object.assign(Object.assign({},n),{type:ParameterNumber.xtype,ref:e=>{this.editor=e},listeners:t})}},{key:"getValue",value:function(){return parseFloat(this.editor.getValue())}},{key:"postGetValidation",value:function(){return this.editor.postGetValidation()}},{key:"preGetValidation",value:function(){return this.editor.preGetValidation()}},{key:"setControllerValue",value:async function(e){await this.editor.setControllerValue(e)}},{key:"reset",value:function(){this.editor.reset()}},{key:"postValidateAndToast",value:function(){return this.editor.postValidateAndToast()}},{key:"setInteractValue",value:function(e){this.editor.setInteractValue(e)}},{key:"focus",value:function(){this.editor.focus()}},{key:"blur",value:function(){this.editor.blur()}},{key:"getAdapter",value:function(){return this.editor.getAdapter()}},{key:"setStyle",value:function(){}}])}();function _classCallCheck$$(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$_(n.key),n)}}function _createClass$$(e,t,r){return t&&_defineProperties$_(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$_(e){var t=_toPrimitive$_(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$_(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$O(e,t,r){return t=_getPrototypeOf$O(t),_possibleConstructorReturn$O(e,_isNativeReflectConstruct$O()?Reflect.construct(t,r||[],_getPrototypeOf$O(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$O(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$O(e)}function _assertThisInitialized$O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$O(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$O=function(){return!!e})()}function _getPrototypeOf$O(e){return(_getPrototypeOf$O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$O(e,t)}function _setPrototypeOf$O(e,t){return(_setPrototypeOf$O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}CellNumber.xtype="report.main.table_cell.controller.number",CellNumber=__decorate$e([shortcut()],CellNumber);var __decorate$d=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__rest$7=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};let CellRadioGroup=function(e){function t(){var e;return _classCallCheck$$(this,t),(e=_callSuper$O(this,t,arguments)).props={width:WIDTH,height:HEIGHT,fontSize:12,reportIndex:0,position:{row:0,column:0},xlisteners:[],baseCls:""},e}return _inherits$O(t,AbstractParameterCellControllerWidget),_createClass$$(t,[{key:"render",value:function(){const e=this.options,{xlisteners:t,position:r,reportIndex:n,baseCls:o}=e,i=__rest$7(e,["xlisteners","position","reportIndex","baseCls"]);return Object.assign(Object.assign({},i),{type:ParameterRadioGroup.xtype,cls:"report-hide-scrollbar",ref:e=>{this.group=e},listeners:t,controlAttrFetcher:fetchCellGroupControlAttr,extraOptsGetter:()=>({location:Object.assign(Object.assign({},r),{reportIndex:n})}),beforeRender(e){this.updateControlAttr().then((()=>e()))}})}},{key:"mounted",value:function(){}},{key:"getValue",value:function(){return this.group.getValue()}},{key:"postGetValidation",value:function(){return this.group.postGetValidation()}},{key:"preGetValidation",value:function(){return this.group.preGetValidation()}},{key:"setControllerValue",value:async function(e){await this.group.setControllerValue(e)}},{key:"reset",value:function(){this.group.reset()}},{key:"postValidateAndToast",value:function(){return this.group.postValidateAndToast()}},{key:"setInteractValue",value:function(e){this.group.setInteractValue(e)}},{key:"reloadControlAttr",value:function(){this.group.reloadControlAttr()}},{key:"setStyle",value:function(){}}])}();function _classCallCheck$_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$Z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$Z(n.key),n)}}function _createClass$_(e,t,r){return t&&_defineProperties$Z(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$Z(e){var t=_toPrimitive$Z(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$Z(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$N(e,t,r){return t=_getPrototypeOf$N(t),_possibleConstructorReturn$N(e,_isNativeReflectConstruct$N()?Reflect.construct(t,r||[],_getPrototypeOf$N(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$N(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$N(e)}function _assertThisInitialized$N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$N(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$N=function(){return!!e})()}function _getPrototypeOf$N(e){return(_getPrototypeOf$N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$N(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$N(e,t)}function _setPrototypeOf$N(e,t){return(_setPrototypeOf$N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}CellRadioGroup.xtype="report.main.table_cell.controller.radio_group",CellRadioGroup=__decorate$d([shortcut()],CellRadioGroup);var __decorate$c=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__rest$6=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};let CellTagComboCheckbox=function(e){function t(){var e;return _classCallCheck$_(this,t),(e=_callSuper$N(this,t,arguments)).props={width:WIDTH,height:HEIGHT,fontSize:12,reportIndex:0,position:{row:0,column:0},xlisteners:[],baseCls:""},e}return _inherits$N(t,AbstractParameterCellControllerWidget),_createClass$_(t,[{key:"render",value:function(){const e=this.options,{xlisteners:t,position:r,reportIndex:n,baseCls:o}=e,i=__rest$6(e,["xlisteners","position","reportIndex","baseCls"]);return Object.assign(Object.assign({},i),{type:ParameterTagComboCheckboxNext.xtype,ref:e=>{this.combo=e},listeners:t,needCheckCustomData:!1,controlAttrFetcher:fetchCellComboControlAttr,extraOptsGetter:()=>({location:Object.assign(Object.assign({},r),{reportIndex:n})}),viewValueFetcher:fetchCellWidgetViewValue,beforeRender(e){this.updateControllAttrByValue(this.options.value).then((()=>e()))}})}},{key:"mounted",value:function(){}},{key:"getValue",value:function(){return this.combo.getValue()}},{key:"postGetValidation",value:function(){return this.combo.postGetValidation()}},{key:"preGetValidation",value:function(){return this.combo.preGetValidation()}},{key:"setControllerValue",value:async function(e,t){await this.combo.setControllerValue(e,t)}},{key:"reset",value:function(){this.combo.reset()}},{key:"postValidateAndToast",value:function(){return this.combo.postValidateAndToast()}},{key:"setInteractValue",value:function(e){this.combo.setInteractValue(e)}},{key:"reloadControlAttr",value:function(){this.combo.reloadControlAttr()}},{key:"getAdapter",value:function(){return this.combo.getAdapter()}},{key:"setStyle",value:function(){}},{key:"focus",value:function(){this.combo.focus()}},{key:"blur",value:function(){this.combo.blur()}}])}();function _classCallCheck$Z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$Y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$Y(n.key),n)}}function _createClass$Z(e,t,r){return t&&_defineProperties$Y(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$Y(e){var t=_toPrimitive$Y(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$Y(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$M(e,t,r){return t=_getPrototypeOf$M(t),_possibleConstructorReturn$M(e,_isNativeReflectConstruct$M()?Reflect.construct(t,r||[],_getPrototypeOf$M(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$M(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$M(e)}function _assertThisInitialized$M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$M(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$M=function(){return!!e})()}function _getPrototypeOf$M(e){return(_getPrototypeOf$M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$M(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$M(e,t)}function _setPrototypeOf$M(e,t){return(_setPrototypeOf$M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}CellTagComboCheckbox.xtype="report.main.table_cell.controller.tag_combo_checkbox",CellTagComboCheckbox=__decorate$c([shortcut()],CellTagComboCheckbox);var __decorate$b=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__rest$5=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};let CellTree=function(e){function t(){var e;return _classCallCheck$Z(this,t),(e=_callSuper$M(this,t,arguments)).props={width:WIDTH,height:HEIGHT,fontSize:12,reportIndex:0,position:{row:0,column:0},xlisteners:[],baseCls:""},e}return _inherits$M(t,AbstractParameterCellControllerWidget),_createClass$Z(t,[{key:"render",value:function(){const e=this.options,{xlisteners:t,position:r,reportIndex:n,baseCls:o}=e,i=__rest$5(e,["xlisteners","position","reportIndex","baseCls"]);return Object.assign(Object.assign({},i),{fontSize:12,type:ParameterTree.xtype,ref:e=>{this.tree=e},listeners:t,oldTreeControlAttrFetcher:fetchOldCellTreeControlAttr,newTreeControlAttrFetcher:fetchNewCellTreeControlAttr,newTreeStructureFetcher:fetchNewCellTreeStructure,extraOptsGetter:()=>({location:Object.assign(Object.assign({},r),{reportIndex:n})}),beforeRender(e){this.updateControllAttr().then((()=>e()))}})}},{key:"mounted",value:function(){}},{key:"getValue",value:function(){return this.tree.getValue()}},{key:"postGetValidation",value:function(){return this.tree.postGetValidation()}},{key:"preGetValidation",value:function(){return this.tree.preGetValidation()}},{key:"setControllerValue",value:async function(e,t){await this.tree.setControllerValue(e,t)}},{key:"reset",value:function(){this.tree.reset()}},{key:"postValidateAndToast",value:function(){return this.tree.postValidateAndToast()}},{key:"setInteractValue",value:function(e){this.tree.setInteractValue(e)}},{key:"reloadControlAttr",value:function(){this.tree.reloadControlAttr()}},{key:"setStyle",value:function(){}}])}();function _classCallCheck$Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$X(n.key),n)}}function _createClass$Y(e,t,r){return t&&_defineProperties$X(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$X(e){var t=_toPrimitive$X(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$X(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$L(e,t,r){return t=_getPrototypeOf$L(t),_possibleConstructorReturn$L(e,_isNativeReflectConstruct$L()?Reflect.construct(t,r||[],_getPrototypeOf$L(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$L(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$L(e)}function _assertThisInitialized$L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$L(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$L=function(){return!!e})()}function _getPrototypeOf$L(e){return(_getPrototypeOf$L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$L(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$L(e,t)}function _setPrototypeOf$L(e,t){return(_setPrototypeOf$L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}CellTree.xtype="report.main.table_cell.controller.tree",CellTree=__decorate$b([shortcut()],CellTree);var __decorate$a=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__rest$4=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};let CellTreeComboBox=function(e){function t(){var e;return _classCallCheck$Y(this,t),(e=_callSuper$L(this,t,arguments)).props={width:WIDTH,height:HEIGHT,fontSize:12,reportIndex:0,position:{row:0,column:0},xlisteners:[],baseCls:""},e}return _inherits$L(t,AbstractParameterCellControllerWidget),_createClass$Y(t,[{key:"render",value:function(){const e=this.options,{xlisteners:t,position:r,reportIndex:n,baseCls:o}=e,i=__rest$4(e,["xlisteners","position","reportIndex","baseCls"]);return Object.assign(Object.assign({},i),{type:ParameterTreeComboBox.xtype,ref:e=>{this.combo=e},listeners:t,oldTreeControlAttrFetcher:fetchOldCellTreeControlAttr,newTreeControlAttrFetcher:fetchNewCellTreeControlAttr,newTreeStructureFetcher:fetchNewCellTreeStructure,extraOptsGetter:()=>({location:Object.assign(Object.assign({},r),{reportIndex:n})}),beforeRender(e){const t=BI.isArray(this.options.value)?[this.options.value]:"".concat(this.options.value);t?this.getInfoByValue(t).then((t=>{(null==t?void 0:t.controlData)&&(this.options.controlAttr.data=t.controlData),e()})):e()}})}},{key:"mounted",value:function(){}},{key:"getValue",value:function(){return this.combo.getValue()}},{key:"postGetValidation",value:function(){return this.combo.postGetValidation()}},{key:"preGetValidation",value:function(){return this.combo.preGetValidation()}},{key:"setControllerValue",value:async function(e,t){await this.combo.setControllerValue(e,t)}},{key:"reset",value:function(){this.combo.reset()}},{key:"postValidateAndToast",value:function(){return this.combo.postValidateAndToast()}},{key:"setInteractValue",value:function(e){this.combo.setInteractValue(e)}},{key:"reloadControlAttr",value:function(){this.combo.reloadControlAttr()}},{key:"getAdapter",value:function(){return this.combo.getAdapter()}},{key:"setStyle",value:function(){}},{key:"focus",value:function(){this.combo.focus()}},{key:"blur",value:function(){this.combo.blur()}}])}();function _classCallCheck$X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$W(n.key),n)}}function _createClass$X(e,t,r){return t&&_defineProperties$W(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$W(e){var t=_toPrimitive$W(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$W(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}CellTreeComboBox.xtype="report.main.table_cell.controller.tree_combo_box",CellTreeComboBox=__decorate$a([shortcut()],CellTreeComboBox);var __decorate$9=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let CellControllerProvider=_createClass$X((function e(){_classCallCheck$X(this,e),this.controllerDict=new Map([["combo",{type:CellCombo.xtype,slient:!0}],["tagcombocheckbox",{type:CellTagComboCheckbox.xtype,slient:!0}],["combocheckbox",{type:CellTagComboCheckbox.xtype,slient:!0}],["button",{type:CellButton.xtype,direct:!0,slient:!0}],["freebutton",{type:CellButton.xtype,direct:!0,slient:!0}],["formsubmit",{type:CellButton.xtype,direct:!0,slient:!0}],["radiogroup",{type:CellRadioGroup.xtype,direct:!0,slient:!0}],["checkboxgroup",{type:CellCheckboxGroup.xtype,direct:!0,slient:!0}],["checkbox",{type:CellCheckBox.xtype,direct:!0,slient:!0}],["iframe",{type:CellIframe.xtype,direct:!0}],["password",{type:ParameterPassword.xtype,transformer:e=>e.replaceAll(/./g,(()=>"*"))}],["datetime",{type:CellDatetime.xtype,slient:!0}],["treecombobox",{type:CellTreeComboBox.xtype,slient:!0}],["tree",{type:CellTree.xtype,direct:!0,slient:!0}],["list",{type:CellList.xtype,direct:!0}],["number",{type:CellNumber.xtype,slient:!0}],["multifile",{type:CellMultifile.xtype,slient:!0}]]),this.controllerEventChangeDict=new Map([["combo","stopedit"],["tagcombocheckbox","stopedit"],["combocheckbox","stopedit"],["radiogroup","statechange"],["checkboxgroup","statechange"],["checkbox","statechange"],["password","afteredit"],["datetime","stopedit"],["number","afteredit"],["text","afteredit"],["textarea","afteredit"]])}),[{key:"getType",value:function(e){var t;return(null===(t=this.controllerDict.get(e))||void 0===t?void 0:t.type)||controllerProvider.get(e)}},{key:"isDirect",value:function(e){var t;return(null===(t=this.controllerDict.get(e))||void 0===t?void 0:t.direct)||!1}},{key:"set",value:function(e,t,r){this.controllerDict.set(e,{type:t,direct:r})}},{key:"getImpl",value:function(){return ParameterEmpty}},{key:"getTextTransformer",value:function(e){var t;return e&&(null===(t=this.controllerDict.get(e))||void 0===t?void 0:t.transformer)||function(e){return e}}},{key:"isSlient",value:function(e){var t;return!0===(null===(t=this.controllerDict.get(e))||void 0===t?void 0:t.slient)}},{key:"getEventChangeName",value:function(e){return this.controllerEventChangeDict.get(e)}}]),ReportCellControllerProvider=_createClass$X((function e(){_classCallCheck$X(this,e)}),[{key:"$get",value:function(){return CellControllerProvider}}]);ReportCellControllerProvider.xtype="report.cell.controller.provider",ReportCellControllerProvider=__decorate$9([provider()],ReportCellControllerProvider);const cellControllerProvider=BI.Providers.getProvider(ReportCellControllerProvider.xtype);var contentShowType,contentShowType2,hideType,hideType2,underlineStyle,underlineStyle2,borderStyle,borderStyle2,newLine,newLine2,verticalAlign,verticalAlign2,textAlign,textAlign2,verTextDirection,verTextDirection2,verticalText,verticalText2;contentShowType2=contentShowType||(contentShowType={}),contentShowType2[contentShowType2.DEFAULT=1]="DEFAULT",contentShowType2[contentShowType2.SHOW_AS_HTML=2]="SHOW_AS_HTML",contentShowType2[contentShowType2.SHOW_AS_IMAGE=3]="SHOW_AS_IMAGE",contentShowType2[contentShowType2.SHOW_AS_DOWNLOAD=4]="SHOW_AS_DOWNLOAD",hideType2=hideType||(hideType={}),hideType2[hideType2.CHAR_LENGTH=1]="CHAR_LENGTH",hideType2[hideType2.CELL_WIDTH=2]="CELL_WIDTH",underlineStyle2=underlineStyle||(underlineStyle={}),underlineStyle2[underlineStyle2.DOTTED=0]="DOTTED",underlineStyle2[underlineStyle2.DASHED=1]="DASHED",underlineStyle2[underlineStyle2.DOUBLE=2]="DOUBLE",underlineStyle2[underlineStyle2.SOLID=3]="SOLID",underlineStyle2[underlineStyle2.SLIM_SOLID=4]="SLIM_SOLID",underlineStyle2[underlineStyle2.DASH_DOT=5]="DASH_DOT",underlineStyle2[underlineStyle2.DASH_DOT_DOT=6]="DASH_DOT_DOT",underlineStyle2[underlineStyle2.HAIR=7]="HAIR",underlineStyle2[underlineStyle2.SLANTED_DASH_DOT=8]="SLANTED_DASH_DOT",underlineStyle2[underlineStyle2.HAIR2=9]="HAIR2",underlineStyle2[underlineStyle2.DOUBLE_DOT=10]="DOUBLE_DOT",underlineStyle2[underlineStyle2.LARGE=11]="LARGE",borderStyle2=borderStyle||(borderStyle={}),borderStyle2[borderStyle2.DOTTED=0]="DOTTED",borderStyle2[borderStyle2.DASHED=1]="DASHED",borderStyle2[borderStyle2.DOUBLE=2]="DOUBLE",borderStyle2[borderStyle2.SOLID=3]="SOLID",borderStyle2[borderStyle2.SLIM_SOLID=4]="SLIM_SOLID",borderStyle2[borderStyle2.DASH_DOT=5]="DASH_DOT",borderStyle2[borderStyle2.DASH_DOT_DOT=6]="DASH_DOT_DOT",borderStyle2[borderStyle2.HAIR=7]="HAIR",borderStyle2[borderStyle2.SLANTED_DASH_DOT=8]="SLANTED_DASH_DOT",borderStyle2[borderStyle2.HAIR2=9]="HAIR2",borderStyle2[borderStyle2.DOUBLE_DOT=10]="DOUBLE_DOT",borderStyle2[borderStyle2.LARGE=11]="LARGE",newLine2=newLine||(newLine={}),newLine2[newLine2.AUTO_NEWLINE=0]="AUTO_NEWLINE",newLine2[newLine2.SINGLE_LINE=1]="SINGLE_LINE",newLine2[newLine2.SINGLE_LINE_ADJUST_FONT=2]="SINGLE_LINE_ADJUST_FONT",newLine2[newLine2.MULTI_LINE_ADJUST_FONT=3]="MULTI_LINE_ADJUST_FONT",verticalAlign2=verticalAlign||(verticalAlign={}),verticalAlign2[verticalAlign2.TOP=1]="TOP",verticalAlign2[verticalAlign2.MIDDLE=0]="MIDDLE",verticalAlign2[verticalAlign2.BOTTOM=3]="BOTTOM",textAlign2=textAlign||(textAlign={}),textAlign2[textAlign2.DEFAULT=-1]="DEFAULT",textAlign2[textAlign2.LEFT=2]="LEFT",textAlign2[textAlign2.CENTER=0]="CENTER",textAlign2[textAlign2.RIGHT=4]="RIGHT",textAlign2[textAlign2.DISTRIBUTED=6]="DISTRIBUTED",verTextDirection2=verTextDirection||(verTextDirection={}),verTextDirection2[verTextDirection2.RIGHT_TO_LEFT=0]="RIGHT_TO_LEFT",verTextDirection2[verTextDirection2.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",verticalText2=verticalText||(verticalText={}),verticalText2[verticalText2.HORIZONTAL_TEXT=0]="HORIZONTAL_TEXT",verticalText2[verticalText2.VERTICAL_TEXT=1]="VERTICAL_TEXT";var __rest$3=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};const HAIR_WIDTH=.5;function getBorderStyle({width:e,style:t,color:r}){let n=t.toLocaleLowerCase(),o=e,i=[];switch(n){case"dashed":i=2===o?[8,2]:[4,2];break;case"slim_solid":n="solid",o=HAIR_WIDTH;break;case"hair":n="dashed",o=HAIR_WIDTH,i=[2,2];break;case"hair2":n="dashed",o=HAIR_WIDTH,i=[4,4];break;case"dash_dot":case"slanted_dash_dot":n="dashed",i=[8,2,2,2];break;case"dash_dot_dot":n="dashed",i=[8,2,2,2,2,2]}return{color:transformColor(r),style:n,width:o,dash:i}}function getCellStyle(e,t){if(!e)return{};const{textAlign:r="left",cellJust:n="NONE"}=t,o={},{cellBackground:i,contentStyle:a,fontStyle:s,borderStyle:l}=e;if(o.backgroundStyle=Object.assign({},DEFAULT_BACKGROUND),i){const{background:e={}}=i,{color:t,imgUrl:r,layout:n=0,backgroundType:a,startColor:s,endColor:l,begin:c=0,finish:u=0,direction:d,radiusConfig:h}=e,p=Object.assign({},DEFAULT_BACKGROUND);switch(p.radiusConfig=h,a){case"TextureBackground":case"PatternBackground":case"ImageBackground":p.backgroundImage=r,p.backgroundImageLayout=getImgLayout(n);break;case"ColorBackground":p.backgroundColor=transformColor(t);break;case"GradientBackground":p.linearGradient={degree:1===d?180:90,stops:[{per:c/GRADIENT_BACKGROUND_LENGTH,color:transformColor(s)},{per:0===u?1:u/GRADIENT_BACKGROUND_LENGTH,color:transformColor(l)}]}}o.backgroundStyle=p}if(l){const{topBorder:e=DEFAULT_INPUT_BORDER,leftBorder:t=DEFAULT_INPUT_BORDER,rightBorder:r=DEFAULT_INPUT_BORDER,bottomBorder:n=DEFAULT_INPUT_BORDER}=l;o.borderStyle={borderTop:getBorderStyle(e),borderBottom:getBorderStyle(n),borderLeft:getBorderStyle(t),borderRight:getBorderStyle(r)}}if(o.contentStyle={color:"",fontSize:"",defaultFontSize:"",fontWeight:"normal",fontStyle:"normal",fontFamily:"",textShadow:void 0,strikeThrough:"none",underline:getBorderStyle({width:0,color:0,style:""}),subscript:!1,supscript:!1,wrap:!0,rotate:0,newLine:"",verTextDirection:"",verticalText:"",textAlign:"center",verticalAlign:"middle",lineHeight:""},s){const e=s.subscript||s.supscript?5*s.fontSize/6:s.fontSize;o.contentStyle=Object.assign(Object.assign({},o.contentStyle),{color:transformColor(s.color),fontSize:"".concat(e,"px"),defaultFontSize:"".concat(e,"px"),fontWeight:transformFontWeight(s.bold),fontStyle:transformFontItalic(s.italic),fontFamily:s.fontFamily.toLocaleLowerCase(),textShadow:transformTextShadow(s.textShadow),strikeThrough:s.strikeThrough?"solid":"none",underline:getBorderStyle({width:s.underLine.width,color:s.underLine.color,style:s.underLine.style}),subscript:s.subscript,supscript:s.supscript})}return a&&(o.contentStyle=Object.assign(Object.assign({},o.contentStyle),{textAlign:"default"===a.textAlign.toLocaleLowerCase()?r:a.textAlign.toLocaleLowerCase(),lineHeight:"".concat(a.lineHeight),defaultLineHeight:"".concat(a.lineHeight),wrap:"auto_newline"===a.newLine.toLocaleLowerCase(),rotate:a.rotate,newLine:a.newLine,verTextDirection:a.verTextDirection,verticalText:a.verticalText,cellJust:n,verticalAlign:s.subscript?"bottom":s.supscript?"top":a.verticalAlign.toLowerCase(),subscript:!1,supscript:!1}),o.paddingLeft=a.paddingLeft,o.paddingRight=a.paddingRight,o.spacingAfter=a.spacingAfter,o.spacingBefore=a.spacingBefore),o}function createEmptyCell(e,t,r,n,o,i){return{celldimension:{width:r,height:n},position:{columnSpan:i,rowSpan:o,x:e,y:t},value:'{"type": "text", "value": ""}',valid:!1,cell:"",direction:0,id:-1}}function getCompleteImageUrl(e,t,r){const n=t?"&cache=true":"";return"".concat(null!=r?r:envProvider.ReqPrefix,"/attach/image?id=").concat(e).concat(n)}function adjustRows(e,t,r=!1){e[e.length-3]=0;const n=e.reduce(((e,t)=>e+t),0);return e[e.length-3]=!r&&n>t?Math.max(t-n,0):SCROLLBAR_WIDTH,e}function adjustCols(e,t,r=!1){if(e.length>=2){const n=e.reduce(((e,t)=>e+t),0);!r&&n>t?e[e.length-2]=Math.max(t-n,0):(e[e.length-2]=0,e[e.length-1]=SCROLLBAR_WIDTH)}return e}function getCellSize(e,t,r){let n=0,o=0;if(e){const{width:i,height:a}=e;n=Math.max(t||0,i),o=Math.max(r||0,a)}return{col:n,row:o}}function getCellValue(e){try{return JSON.parse(e)}catch(e3){return}}function getCellValueByCell(e){var t,r,n;if(null==e?void 0:e.value){const o=getCellValue(e.value);return null!==(n=null!==(r=null!==(t=null==o?void 0:o.cv)&&void 0!==t?t:null==o?void 0:o.value)&&void 0!==r?r:null==o?void 0:o.text)&&void 0!==n?n:e.value}}function getCellTextByCell(e){return transformCellCv(getCellValueByCell(e)).text}function getCell(e,t){const{value:r,cellhyperlink:n,celladvancedattr:o,cellstyle:i,celladjustattr:a,valid:s,widget:l,sortHeader:c}=e,u=__rest$3(e,["value","cellhyperlink","celladvancedattr","cellstyle","celladjustattr","valid","widget","sortHeader"]),d=getCellValue(r);return t.generate({style:getCellStyle(i,{textAlign:"NaN"!==(null==d?void 0:d.value)&&BI.isNaN(null==d?void 0:d.value)?"left":"right",cellJust:(null==a?void 0:a.adjustStrategy)||"HEIGHT"}),cell:Object.assign(Object.assign(Object.assign({},u),d),{valid:!!BI.isNull(s)||s}),widget:l,cellhyperlink:n,celladvancedattr:o,sortHeader:c})}function getCellStickers(e,t){return t.generator(e)}function expandHtml(e="",t,r=1){const n=Object.assign(Object.assign({},{paddingLeft:0,paddingRight:0,lineHeight:0,spacingAfter:0,spacingBefore:0,verticalAlign:"middle",textAlign:"center",color:-16777216,bold:!1,fontFamily:"SimSun",fontSize:12,italic:!0,strikeThrough:!1,textShadow:!1,underLine:{width:0,style:"",color:-16777216},height:"auto",cursor:""}),t),{paddingLeft:o,paddingRight:i,lineHeight:a,spacingAfter:s,spacingBefore:l,verticalAlign:c,textAlign:u,color:d,bold:h,fontFamily:p,italic:f,strikeThrough:g,underLine:m,textShadow:y,fontSize:v,height:_,cursor:b}=n,C=new Map([["TOP",0],["MIDDLE",50],["BOTTOM",100]]),E="translateY(-".concat(C.get(c),"%)"),T="html-cell-".concat(BI.UUID()),S=[];g&&S.push("line-through"),m.width&&S.push("underline");const P=document.createElement("style");P.innerHTML=".".concat(T," {\n        box-sizing: border-box;\n        width: 100%;\n        height: ").concat(_,";\n        text-align: ").concat(u.toLowerCase(),";\n        position: absolute;\n        top: ").concat(C.get(c),"%;\n        -ms-transform: ").concat(E,";\n        -webkit-transform: ").concat(E,";\n        -o-transform: ").concat(E,",\n        transform: ").concat(E,";\n        line-height: ").concat(a,"px;\n        padding: ").concat(l,"px ").concat(i,"px ").concat(s,"px ").concat(o,"px;\n        --font-scale: ").concat(r,";\n        color: ").concat(transformColor(d),";\n        font-weight: ").concat(transformFontWeight(h),";\n        font-family: '").concat(p,"';\n        font-style: ").concat(transformFontItalic(f),";\n        text-decoration: ").concat(S.length>0?S.join(" "):"normal",";\n        text-shadow: ").concat(BI.isNull(y)?"none":transformTextShadow2Css(y),";\n        font-size: ").concat(v*r,"px;\n        ").concat(b?"cursor: ".concat(b," !important;"):"","\n    }"),document.head.appendChild(P);return{el:'<div class="un-cssreset '.concat(T,'">').concat(e,"</div>"),initialEl:e,style:n}}function getMerge(e,t,r,n){return[[e,t],[e+r-1,t+n-1]]}function getFreeze(e){let t=[0,0,0,0];if(e&&hasLegalFrozen(e)){const{colTo:r,rowTo:n,footColFrom:o,footRowFrom:i}=e,a=r>-1?r+2:0,s=n>-1?n+3:0,l=o>-1?o+1:-1,c=i>-1?i+2:-1;t=[a,s,l>a?l:0,c>s?c:0]}return t}function getFreezeRowsAndColsCount(e){if(e&&hasLegalFrozen(e)){const{colTo:t,rowTo:r,colFrom:n,rowFrom:o,footColFrom:i,footRowFrom:a,footColTo:s,footRowTo:l}=e;return{colCount:t>-1?t-n+1:0,rowCount:r>-1?r-o+1:0,footColCount:s>-1?s-i+1:0,footRowCount:l>-1?l-a+1:0}}return{colCount:0,rowCount:0,footColCount:0,footRowCount:0}}function hasLegalFrozen(e){let t=!1;return e&&["colTo","rowTo","footRowFrom","footColFrom"].forEach((r=>{e[r]>-1&&(t=!0)})),t}function getImgLayout(e){if(BI.isString(e))return e;switch(e){case 0:return"repeat";case 1:return"default";case 3:default:return"center";case 2:return"stretch";case 4:return"adapt"}}function address2Position(e){const t=e.toLocaleUpperCase().replace(/[^a-zA-Z]/g,""),r=e.replace(/[^\d]/g,"");if(t&&r){return{x:t.split("").reverse().reduce(((e,t,r)=>e+(t.charCodeAt(0)-64)*(r>0?25*r:1)),0)-1,y:parseInt(r.toString(),10)-1}}}function fixFreezeMerge(e,t){const{rowTo:r,colTo:n}=t||{rowTo:-1,colTo:-1};for(let o=0;o<e.length;o++)if(e[o])for(let t=0;t<e[o].length;t++){const i=e[o][t];if(!i)continue;const{rowSpan:a=1,columnSpan:s=1,x:l=0,y:c=0}=i.position,u=i.value;let[d,h,p]=[0,0,!1];if(a>1&&r>=c&&c+a-1>r)d=l,h=c+r+1,e[h][d].position.rowSpan=a-r-1,i.position.rowSpan=1+r,p=!0,s>1&&(e[h][d].position.columnSpan=s);else{if(!(s>1&&n>=l&&l+s-1>n))break;d=l+n+1,h=o,e[h][d].position.columnSpan=s-n-1,i.position.columnSpan=1+n,p=!0,a>1&&(e[h][d].position.rowSpan=a)}p&&(e[h][d].value=u,e[h][d].celladjustattr=i.celladjustattr,e[h][d].cellstyle=i.cellstyle,e[h][d].celladvancedattr=i.celladvancedattr,e[h][d].cellhyperlink=i.cellhyperlink,i.value=JSON.stringify({type:"text",value:""}))}}function getSticker(e,t,r,n){var o,i;const a=r.extended?expandHtml(r.value,Object.assign(Object.assign(Object.assign(Object.assign({},null===(o=n.cellstyle)||void 0===o?void 0:o.contentStyle),null===(i=n.cellstyle)||void 0===i?void 0:i.fontStyle),r.style),{cursor:r.cursor})):r.value?{el:r.value,style:void 0,initialEl:r.value}:void 0;return{id:r.id,position:{row:t,col:e},el:null==a?void 0:a.el,extension:a,init:r.init,lazy:r.lazy}}function transformCellCv(e){let t="S",r="".concat(e);if(BI.isNull(e))return{xtype:t,value:r,text:r};if(BI.isNumber(e))return r="".concat(e),t=/\./.test(r)||/e/i.test(r)?"D":r.length>=10?"BigDecimal":"I",{xtype:t,value:r,text:r};if(BI.isArray(e))return BI.size(e)>0&&BI.has(BI.first(e),"attach_id")?(t="Attachments",r=e.map((e=>e.attach_id)).join(","),{xtype:t,value:r,text:e.map((e=>e.filename)).join(",")}):(t="A",BI.isArray(BI.first(e))?(t="AA",r=e.map((e=>"".concat(e))).join(";")):r="".concat(e),{xtype:t,value:r,text:r});if(BI.isObject(e)){if(BI.isNotNull(e.date_milliseconds))t="Date",r="".concat(e.date_milliseconds);else{if(BI.isNotNull(e.__time__))return t="Date",r="".concat(e.__time__),{xtype:t,value:r,text:"".concat(new Date(e.__time__))};if(BI.isNotNull(e.attach_id))return t="Attachments",r=e.attach_id,{xtype:t,value:r,text:e.filename};BI.isEmptyObject(r)&&(r="")}return{xtype:t,value:r,text:r}}return BI.isBoolean(e)?(t="B",{xtype:t,value:r,text:r}):{xtype:t,value:r,text:r}}function transformPosition2Id(e,t){return"".concat(e,"-").concat(t)}function transformFontWeight(e){return BI.isString(e)?e:BI.isNumber(e)?e>400?"bold":"normal":e?"bold":"normal"}function transformTextShadow(e){return BI.isBoolean(e)?e?DEFAULT_SHADOW:void 0:e}function transformTextShadow2Css(e){return BI.isBoolean(e)?e?transformTextShadow2Css(DEFAULT_SHADOW):"none":"".concat(e.shadowOffsetX,"px ").concat(e.shadowOffsetY,"px ").concat(e.shadowBlur,"px ").concat(e.shadowColor)}function transformFontItalic(e){return BI.isString(e)?e:e?"italic":"normal"}function fixRealCellPositionInMergeCell(e,t){const{x:r,y:n,rowSpan:o=1,columnSpan:i=1}=t,a=Math.min(n+o,e.length-1);let s=0;for(let l=n;l<a;l++){s=Math.min(r+i,e[l].length-1);for(let t=r;t<s;t++)BI.isNull(e[l][t].merge)||(e[l][t].sourceCellPosition={x:r,y:n})}}function transformSimplePageResult2Old(e){const t=[];return e.forEach((e=>{const r=[];e.forEach((e=>{var t;if("empty"in e){const t={cell:"",celldimension:{width:0,height:0},direction:0,position:{x:0,y:0},value:""};t.position={x:e.empty[0],y:e.empty[1],columnSpan:e.empty[2],rowSpan:e.empty[3]},t.celldimension={width:e.empty[4],height:e.empty[5]},t.value=e.value,copyPageResult(t,e),r.push(t)}else if("merge"in e){const t={cell:"",celldimension:{width:0,height:0},direction:0,position:{x:0,y:0},value:""};t.value=e.value,t.position={x:e.merge[0],y:e.merge[1],columnSpan:e.merge[2],rowSpan:e.merge[3]},t.celldimension={width:e.merge[4],height:e.merge[5]},copyPageResult(t,e),r.push(t)}else{const n={cell:"",celldimension:{width:0,height:0},direction:0,position:{x:0,y:0},value:""};e.cell&&(n.cell=e.cell),n.value=e.value,n.position={x:e.position[0],y:e.position[1],columnSpan:e.position[2],rowSpan:e.position[3]},n.celldimension={width:e.celldimension[0],height:e.celldimension[1]},n.celladjustattr={adjustStrategy:null===(t=e.celladjustattr)||void 0===t?void 0:t.adjustStrategy},copyPageResult(n,e),r.push(n)}})),t.push(r)})),t}function copyPageResult(e,t){if(t.cellstyle&&(e.cellstyle={fontStyle:{bold:!1,italic:!1,fontFamily:t.cellstyle.fontStyle.fontFamily,strikeThrough:!1,fontSize:t.cellstyle.fontStyle.fontSize,subscript:!1,underLine:{width:t.cellstyle.fontStyle.underLine.width,style:underlineStyle[t.cellstyle.fontStyle.underLine.style],color:t.cellstyle.fontStyle.underLine.color},textShadow:!1,supscript:!1,color:t.cellstyle.fontStyle.color},borderStyle:{topBorder:{width:t.cellstyle.borderStyle[0][0],style:borderStyle[t.cellstyle.borderStyle[0][1]],color:t.cellstyle.borderStyle[0][2]},rightBorder:{width:t.cellstyle.borderStyle[1][0],style:borderStyle[t.cellstyle.borderStyle[1][1]],color:t.cellstyle.borderStyle[1][2]},bottomBorder:{width:t.cellstyle.borderStyle[2][0],style:borderStyle[t.cellstyle.borderStyle[2][1]],color:t.cellstyle.borderStyle[2][2]},leftBorder:{width:t.cellstyle.borderStyle[3][0],style:borderStyle[t.cellstyle.borderStyle[3][1]],color:t.cellstyle.borderStyle[3][2]}},contentStyle:{rotate:t.cellstyle.contentStyle[0],lineHeight:t.cellstyle.contentStyle[1],paddingRight:t.cellstyle.contentStyle[2],spacingBefore:t.cellstyle.contentStyle[3],paddingLeft:t.cellstyle.contentStyle[4],spacingAfter:t.cellstyle.contentStyle[5],newLine:newLine[t.cellstyle.contentStyle[6]],verticalAlign:verticalAlign[t.cellstyle.contentStyle[7]],textAlign:textAlign[t.cellstyle.contentStyle[8]],verTextDirection:verTextDirection[t.cellstyle.contentStyle[9]],verticalText:verticalText[t.cellstyle.contentStyle[10]]},cellBackground:t.cellstyle.cellBackground},BI.isBoolean(t.cellstyle.fontStyle.italic)&&(e.cellstyle.fontStyle.italic=t.cellstyle.fontStyle.italic),BI.isBoolean(t.cellstyle.fontStyle.bold)&&(e.cellstyle.fontStyle.bold=t.cellstyle.fontStyle.bold),BI.isBoolean(t.cellstyle.fontStyle.strikeThrough)&&(e.cellstyle.fontStyle.strikeThrough=t.cellstyle.fontStyle.strikeThrough),BI.isBoolean(t.cellstyle.fontStyle.subscript)&&(e.cellstyle.fontStyle.subscript=t.cellstyle.fontStyle.subscript),BI.isBoolean(t.cellstyle.fontStyle.supscript)&&(e.cellstyle.fontStyle.supscript=t.cellstyle.fontStyle.supscript),BI.isBoolean(t.cellstyle.fontStyle.textShadow)&&(e.cellstyle.fontStyle.textShadow=t.cellstyle.fontStyle.textShadow)),t.cellhyperlink&&(e.cellhyperlink=t.cellhyperlink),BI.isBoolean(t.valid)&&(e.valid=t.valid),t.sortHeader&&(e.sortHeader=t.sortHeader),t.celladvancedattr){e.celladvancedattr={contentShowType:"DEFAULT",previewContent:!0,printBackground:!0,printContent:!0};let r="DEFAULT";switch(t.celladvancedattr.contentShowType){case 1:default:r="DEFAULT";break;case 2:r="SHOW_AS_HTML";break;case 3:r="SHOW_AS_IMAGE";break;case 4:r="SHOW_AS_DOWNLOAD"}let n="CHAR_LENGTH";switch(t.celladvancedattr.hideType){case 1:default:n="CHAR_LENGTH";break;case 2:n="CELL_WIDTH"}e.celladvancedattr.contentShowType=r,BI.isBoolean(t.celladvancedattr.previewContent)&&(e.celladvancedattr.previewContent=t.celladvancedattr.previewContent),BI.isBoolean(t.celladvancedattr.printBackground)&&(e.celladvancedattr.printBackground=t.celladvancedattr.printBackground),BI.isBoolean(t.celladvancedattr.printContent)&&(e.celladvancedattr.printContent=t.celladvancedattr.printContent),BI.isString(t.celladvancedattr.tooltipText)&&(e.celladvancedattr.tooltipText=t.celladvancedattr.tooltipText),BI.isBoolean(t.celladvancedattr.overflowHide)&&(e.celladvancedattr.overflowHide=t.celladvancedattr.overflowHide),e.celladvancedattr.hideType=n,BI.isNumber(t.celladvancedattr.hideStrLength)&&(e.celladvancedattr.hideStrLength=t.celladvancedattr.hideStrLength),BI.isString(t.celladvancedattr.appendTailStr)&&(e.celladvancedattr.appendTailStr=t.celladvancedattr.appendTailStr)}BI.isBoolean(t.dirty)&&(e.dirty=t.dirty),BI.isBoolean(t.edited)&&(e.edited=t.edited),BI.isBoolean(t.transformed)&&(e.transformed=t.transformed),BI.isString(t.errorMsg)&&(e.errorMsg=t.errorMsg),(BI.isString(t.id)||BI.isNumber(t.id))&&(e.id=t.id),BI.isNumber(t.idx)&&(e.idx=t.idx),BI.isBoolean(t.open)&&(e.open=t.open),BI.isString(t.fmt)&&(e.fmt=t.fmt),BI.isBoolean(t.frs)&&(e.frs=t.frs),BI.isBoolean(t.isShowWidgets)&&(e.isShowWidgets=t.isShowWidgets),t.direction&&(e.direction=t.direction),BI.isNumber(t.indent)&&(e.indent=t.indent),BI.isNotNull(t.widget)&&(e.widget=t.widget)}function isSimplePageResult(e){const t=BI.first(BI.first(e));return!!t&&("empty"in t||BI.isArray(t.merge)||BI.isArray(t.position))}function _classCallCheck$W(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$V(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$V(n.key),n)}}function _createClass$W(e,t,r){return t&&_defineProperties$V(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$V(e){var t=_toPrimitive$V(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$V(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$K(e,t,r){return t=_getPrototypeOf$K(t),_possibleConstructorReturn$K(e,_isNativeReflectConstruct$K()?Reflect.construct(t,r||[],_getPrototypeOf$K(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$K(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$K(e)}function _assertThisInitialized$K(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$K(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$K=function(){return!!e})()}function _getPrototypeOf$K(e){return(_getPrototypeOf$K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$K(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$K(e,t)}function _setPrototypeOf$K(e,t){return(_setPrototypeOf$K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let AbstractCellControllerHoc=function(e){function t(){return _classCallCheck$W(this,t),_callSuper$K(this,t,arguments)}return _inherits$K(t,AbstractParameterCellControllerWidget),_createClass$W(t,[{key:"setInteractValue",value:function(){}},{key:"createWatermark",value:function(){const e=this.options.el.value;return{el:{type:BI.Label.xtype,invisible:this.checkValueNotEmpty(e),value:this.options.el.watermark,textAlign:"left",cls:"bi-water-mark",ref:e=>{this.watermark=e}},top:1,left:1,right:1,bottom:1}}},{key:"checkValueNotEmpty",value:function(e){return!BI.isEmptyString(e)&&BI.isNotNull(e)}}])}();function _classCallCheck$V(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$U(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$U(n.key),n)}}function _createClass$V(e,t,r){return t&&_defineProperties$U(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$U(e){var t=_toPrimitive$U(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$U(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$J(e,t,r){return t=_getPrototypeOf$J(t),_possibleConstructorReturn$J(e,_isNativeReflectConstruct$J()?Reflect.construct(t,r||[],_getPrototypeOf$J(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$J(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$J(e)}function _assertThisInitialized$J(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$J(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$J=function(){return!!e})()}function _superPropGet$5(e,t,r,n){var o=_get$5(_getPrototypeOf$J(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$5(){return _get$5="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$5(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$5.apply(null,arguments)}function _superPropBase$5(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$J(e)););return e}function _getPrototypeOf$J(e){return(_getPrototypeOf$J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$J(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$J(e,t)}function _setPrototypeOf$J(e,t){return(_setPrototypeOf$J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __decorate$8=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let DirectCellController=function(e){function t(){var e;return _classCallCheck$V(this,t),(e=_callSuper$J(this,t,arguments)).props={baseCls:"report-main-table-cell-controller-direct",el:{},width:0,height:0,fontSize:12,slient:!1,text:"",shouldHideSelectFrame:BI.emptyFn},e}return _inherits$J(t,AbstractCellControllerHoc),_createClass$V(t,[{key:"render",value:function(){const e=this.options.el.listeners||[],t={eventName:"EVENT_CHANGE",action:()=>{var e;null===(e=this.watermark)||void 0===e||e.setVisible(!this.checkValueNotEmpty(this.controller.getValue()))}};return e.push(t,{eventName:"afterinit",action:()=>{this.initLabelLayer()}}),{type:BI.BasicButton.xtype,render:()=>Object.assign(Object.assign({},this.options.el),{xlisteners:e,listeners:this.options.slient?[t]:e,ref:e=>{this.controller=e}}),handler:()=>{this.active()}}}},{key:"initLabelLayer",value:function(){if(this.adapter)return;const e=this.controller.getAdapter();e&&BI.createWidget({type:BI.AbsoluteLayout.xtype,element:e.element,items:[{el:{type:BI.AbsoluteLayout.xtype,ref:e=>{this.adapter=e},items:[{el:{type:BI.Label.xtype,ref:e=>{this.label=e},cls:"bi-card",text:this.options.text,textAlign:"left"},top:1,bottom:1,left:1,right:1},this.createWatermark()]},top:0,bottom:0,left:0,right:0}]})}},{key:"getValue",value:function(){return this.controller.getValue()}},{key:"setValue",value:function(...e){try{this.controller.setValue(...e)}catch(e3){}}},{key:"postGetValidation",value:function(){return this.controller.postGetValidation()}},{key:"postValidateAndToast",value:function(){return this.controller.postValidateAndToast()}},{key:"preGetValidation",value:function(){return this.controller.preGetValidation()}},{key:"reset",value:function(){this.controller.reset()}},{key:"setControllerValue",value:async function(...e){await this.controller.setControllerValue(...e)}},{key:"active",value:function(){var e;null===(e=this.adapter)||void 0===e||e.invisible(),this.controller.focus()}},{key:"inactive",value:function(){var e;null===(e=this.adapter)||void 0===e||e.visible()}},{key:"isActive",value:function(){return!!this.adapter&&!this.adapter.isVisible()}},{key:"setText",value:function(e){var t;null===(t=this.label)||void 0===t||t.setText(e),this.options.text=e}},{key:"reloadControlAttr",value:function(){try{this.controller.reloadControlAttr()}catch(e3){}}},{key:"setSeleted",value:function(e){this.options.shouldHideSelectFrame()||(e?this.element.addClass("highlight-border"):this.hideHightlightBorder())}},{key:"hideHightlightBorder",value:function(){this.element.removeClass("highlight-border")}},{key:"setStyle",value:function(){}},{key:"blur",value:function(){try{this.controller.blur()}catch(e3){}}},{key:"resize",value:function(e,t){this.controller.resize(e,t)}},{key:"getValidation",value:function(){return this.controller.isEnabled()&&this.controller.isVisible()?_superPropGet$5(t,"getValidation",this)([]):{result:!0}}},{key:"getDependenceValue",value:function(){try{return this.controller instanceof AbstractParameterCellControllerWidget?this.controller.getDependenceValue():this.controller.getValue()}catch(e3){}}}])}();function _classCallCheck$U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$T(n.key),n)}}function _createClass$U(e,t,r){return t&&_defineProperties$T(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$T(e){var t=_toPrimitive$T(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$T(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$I(e,t,r){return t=_getPrototypeOf$I(t),_possibleConstructorReturn$I(e,_isNativeReflectConstruct$I()?Reflect.construct(t,r||[],_getPrototypeOf$I(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$I(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$I(e)}function _assertThisInitialized$I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$I(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$I=function(){return!!e})()}function _superPropGet$4(e,t,r,n){var o=_get$4(_getPrototypeOf$I(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$4(){return _get$4="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$4(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$4.apply(null,arguments)}function _superPropBase$4(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$I(e)););return e}function _getPrototypeOf$I(e){return(_getPrototypeOf$I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$I(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$I(e,t)}function _setPrototypeOf$I(e,t){return(_setPrototypeOf$I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}DirectCellController.xtype="report.main.table_cell.controller.direct",DirectCellController=__decorate$8([shortcut()],DirectCellController);var __decorate$7=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},IndirectCellController_1;let IndirectCellController=IndirectCellController_1=function(e){function t(){var e;return _classCallCheck$U(this,t),(e=_callSuper$I(this,t,arguments)).props={baseCls:"report-main-table-cell-controller-indirect",el:{},width:0,height:0,fontSize:12,slient:!1,shouldHideSelectFrame:BI.emptyFn},e}return _inherits$I(t,AbstractCellControllerHoc),_createClass$U(t,[{key:"render",value:function(){const e=this.options.el.listeners||[],t={eventName:"EVENT_CHANGE",action:()=>{var e;null===(e=this.watermark)||void 0===e||e.setVisible(!this.checkValueNotEmpty(this.controller.getValue()))}};return e.push(t),this.controller=BI.createWidget(Object.assign(Object.assign({},this.options.el),{listeners:this.options.slient?[t]:e,xlisteners:e})),{type:BI.Tab.xtype,ref:e=>{this.tab=e},showIndex:"inactive",cardCreator:e=>"active"===e?{type:BI.AbsoluteLayout.xtype,ref:e=>{this.controllerWrapper=e},items:[{el:this.controller,top:0,left:0,bottom:0,right:0}]}:{type:BI.AbsoluteLayout.xtype,items:[{el:Object.assign(Object.assign({},this.options.el),{ref:e=>{this.seleciontMarker=e},disabled:!1,invisible:!0,width:this.options.width-2,height:this.options.height-2,cls:"cell-selected",type:BI.DefaultLayout.xtype}),top:0,left:0,right:0,bottom:0},this.createWatermark(),{el:{type:BI.AbsoluteLayout.xtype,invisible:!0,ref:e=>{this.tip=e},items:[{el:Object.assign(Object.assign({},this.options.el),{ref:e=>{this.hightLightBorder=e},disabled:!1,width:this.options.width-2,height:this.options.height-2,cls:"bi-high-light-border",type:BI.DefaultLayout.xtype}),top:0,left:0,right:0,bottom:0},{el:{cls:"cell-edit-tip",iconWidth:16,iconHeight:16,width:16,height:16,type:BI.IconButton.xtype,stopPropagation:!0,handler:()=>{this.fireEvent(IndirectCellController_1.EVENT_OPEN)}},top:0,right:0}]},top:0,left:0,right:0,bottom:0}]}}}},{key:"mounted",value:function(){this.element.on("mouseenter",(()=>{if(this.isActive())return;const e=!this.isControllerUnusalState();this.tip.setVisible(e),this.handleControllerByState(e)})),this.element.on("mouseleave",(()=>{this.tip.invisible()}))}},{key:"isControllerRegistered",value:function(){return!!this.controllerWrapper&&this.controllerWrapper.hasWidget("0")}},{key:"handleControllerByState",value:function(e){var t;e?this.isControllerRegistered()||null===(t=this.controllerWrapper)||void 0===t||t.addWidget(this.controller):this.controller.isolate()}},{key:"setEnable",value:function(e){this.controller.setEnable(e),this.handleControllerByState(e)}},{key:"setVisible",value:function(e){this.controller.setVisible(e),this.handleControllerByState(e)}},{key:"getValue",value:function(){return this.controller?this.controller.getValue():this.options.el.value}},{key:"setValue",value:function(e){try{this.controller?this.controller.setValue(e):this.options.el.value=e}catch(e3){}}},{key:"postGetValidation",value:function(){return this.controller.postGetValidation()||{result:!0}}},{key:"postValidateAndToast",value:function(){return this.controller.postValidateAndToast()||!0}},{key:"preGetValidation",value:function(){return this.controller.preGetValidation()||{result:!0}}},{key:"reset",value:function(){this.controller.reset()}},{key:"setControllerValue",value:async function(e){this.controller?await this.controller.setControllerValue(e):this.options.el.value}},{key:"active",value:function(){this.isControllerUnusalState()||(this.tab.setSelect("active"),this.controller.focus())}},{key:"inactive",value:function(){this.tab.setSelect("inactive")}},{key:"isActive",value:function(){return"active"===this.tab.getSelect()}},{key:"setText",value:function(){}},{key:"resize",value:function(e,t){this.controller.resize(e,t),this.tab.setHeight(t),this.tab.setWidth(e),this.seleciontMarker.setWidth(e-2),this.seleciontMarker.setHeight(t-2),this.hightLightBorder.setWidth(e-2),this.hightLightBorder.setHeight(t-2)}},{key:"reloadControlAttr",value:function(){try{this.controller.reloadControlAttr()}catch(e3){}}},{key:"setSeleted",value:function(e){this.options.shouldHideSelectFrame()||this.seleciontMarker.setVisible(e)}},{key:"hideHightlightBorder",value:function(){this.seleciontMarker.setVisible(!1)}},{key:"isControllerUnusalState",value:function(){return this.controllerWrapper?!this.isControllerRegistered():!(this.controller.isEnabled()&&this.controller.isVisible())}},{key:"setStyle",value:function(){}},{key:"getValidation",value:function(){return this.isControllerUnusalState()?{result:!0}:_superPropGet$4(t,"getValidation",this)([])}},{key:"getDependenceValue",value:function(){try{return this.controller instanceof AbstractParameterCellControllerWidget?this.controller.getDependenceValue():this.controller.getValue()}catch(e3){}}}])}();function transformCell2Widget(){const{widget:e}=this.options;return e?{id:"".concat(this.id,"_cell_controllers"),init:(t,r,n,o,i)=>{const a=!!this.cellControllerManager.getWidgetByName(this.id);if(this.isDirectWidget()||a)return initWidget.apply(this,[t,r,n]),void(i?null==o||o():BI.defer((()=>{null==o||o()})));this.cellControllerManager.addUninitializedWidget(this.id,{init:()=>{initWidget.apply(this,[t,r,n])},cellId:this.id,dependenceMap:e.dependenceMap||{},cellWidgetName:e.widgetName||""},o)},value:"",lazy:!0}:void 0}function initWidget(e,t,r){const{widget:n,cell:o}=this.options;if(!n)return;e.css("overflow","visible");let i=this.cellControllerManager.getWidgetByName(this.id);const a=t-1,s=r-1,l=!!i,c=cellControllerProvider.isDirect(null==n?void 0:n.type),u=cellControllerProvider.isSlient(null==n?void 0:n.type),d=cellControllerProvider.getEventChangeName(null==n?void 0:n.type);i?(i.setText(this.getTextByCellValue()),i.resize(a,s)):(i=BI.createWidget({type:this.isDirectWidget()?DirectCellController.xtype:IndirectCellController.xtype,text:this.getTextByCellValue(),shouldHideSelectFrame:()=>this.cellControllerManager.getHideSelectFrameSign(),cellId:this.id,dependence:n.dependence,dependenceMap:n.dependenceMap,reportIndex:n.reportIndex,width:a,height:s,cellWidgetName:n.widgetName,slient:u,location:this.id,el:Object.assign(Object.assign({},n),{widgetName:"",cellWidgetName:n.widgetName,type:cellControllerProvider.getType(n.type),xtype:n.type,width:a,height:s,position:{column:o.position.x,row:o.position.y},location:this.id,value:n.value,getWidgetDependenceValueByWidget:()=>{const e=n.dependence||[],t=n.dependenceMap||{};return e.reduce(((e,r)=>{const n=t[r];if(!n)return e;const o=this.external.getDependenceValueById(n);return e[r.toUpperCase()]=o,e}),{})},getDependenceByWidget:()=>n.dependence||[],listeners:(d?[{eventName:d,action(){return this.fireEvent("EVENT_CHANGE",(()=>{this.fireEvent("_".concat(d))})),!1}}]:[]).concat((n.listeners||[]).concat([{eventName:"EVENT_CHANGE",action:e=>{if(c){!i.validateAndMsgToast(this.id)&&i.reset()}const t=this.fireEvent("CELL_WIDGET_CHANGE",{e:{},cell:{},x:o.position.x,y:o.position.y,value:i.getValue(),id:this.id,direct:c});Promise.all(t).then((()=>{BI.isFunction(e)&&e()}))}}]).map((e=>Object.assign(Object.assign({},e),{eventName:d&&e.eventName===d?"_".concat(d):e.eventName}))))}),listeners:[{eventName:IndirectCellController.EVENT_OPEN,action:()=>{this.fireEvent("CELL_DOUBLE_CLICK",{e:{},x:o.position.x,y:o.position.y,id:this.id,cell:{position:{x:o.position.x,y:o.position.y},ri:0,ci:0,x:o.position.x,y:o.position.y,width:t,height:r}})}}]}),this.cellControllerManager.register(i,this.id));const h=BI.createWidget({type:BI.DefaultLayout.xtype,element:e.el,items:[{type:BI.AbsoluteLayout.xtype,items:[l?{el:{type:BI.DefaultLayout.xtype,mounted(){BI.mount(i,this.element[0])}},top:0,left:0,right:0,bottom:0}:{el:i,top:1,left:1,right:0,bottom:0},...this.getStateWidgetJson(a,s)]}]});h.element.mousedown((e=>{(null==i?void 0:i.isActive())&&e.stopPropagation()})),h.element.mouseup((e=>{(null==i?void 0:i.isActive())&&e.stopPropagation()})),h.element.mousewheel((e=>{((null==i?void 0:i.isActive())||c)&&e.stopPropagation()}))}function _classCallCheck$T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$S(n.key),n)}}function _createClass$T(e,t,r){return t&&_defineProperties$S(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$S(e){var t=_toPrimitive$S(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$S(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$H(e,t,r){return t=_getPrototypeOf$H(t),_possibleConstructorReturn$H(e,_isNativeReflectConstruct$H()?Reflect.construct(t,r||[],_getPrototypeOf$H(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$H(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$H(e)}function _assertThisInitialized$H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$H(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$H=function(){return!!e})()}function _superPropGet$3(e,t,r,n){var o=_get$3(_getPrototypeOf$H(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$3(){return _get$3="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$3(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$3.apply(null,arguments)}function _superPropBase$3(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$H(e)););return e}function _getPrototypeOf$H(e){return(_getPrototypeOf$H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$H(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$H(e,t)}function _setPrototypeOf$H(e,t){return(_setPrototypeOf$H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}IndirectCellController.xtype="report.main.table_cell.controller.indirect",IndirectCellController.EVENT_OPEN="EVENT_OPEN",IndirectCellController=IndirectCellController_1=__decorate$7([shortcut()],IndirectCellController);let CellCacheManager=function(e){function t(){var e;return _classCallCheck$T(this,t),(e=_callSuper$H(this,t,arguments)).updatedCellValueCache=[],e}return _inherits$H(t,WidgetManager),_createClass$T(t,[{key:"addCellCache",value:function(e){this.updatedCellValueCache.push(e)}},{key:"getCellCache",value:function(){return this.updatedCellValueCache}},{key:"clearCellCache",value:function(){this.updatedCellValueCache=[]}},{key:"update",value:function(){}},{key:"clear",value:function(){this.clearCellCache(),_superPropGet$3(t,"clear",this)([])}}])}();var type2DescriptionEnum,type2DescriptionEnum2;function transformCell2Filter(){var e;if(!this.options.sortHeader||!BI.isNotEmptyArray(this.options.sortHeader.sortItems))return;const{sortItems:t,headerArea:r,sortArea:n,index:o,direction:i,currentSortItem:a}=this.options.sortHeader,s=null===(e=this.external.getExternals())||void 0===e?void 0:e.attachPrefix,l={};return{id:"".concat(this.id,"_filter"),init:e=>{var c;let u;const d="triangle-left-font",h={};let p;index.use(jssGlobal(),jssNested());const f=t.map((({iconId:e,type:t})=>{const{classes:c}=index.createStyleSheet({icon:{background:"url(".concat(getCompleteImageUrl(e,!0,s),") no-repeat center center"),"background-size":"contain"}}).attach();h[e]=c.icon;const u=BI.i18nText(type2DescriptionEnum[t]);return{type:BI.DownListGroupItem.xtype,cls:"bi-list-item-active",height:24,iconCls1:c.icon,iconCls2:"",value:e,text:u,ref:t=>{l[e]=t},logic:{dynamic:!0},seleted:a===u,listeners:[{eventName:BI.DownListGroupItem.EVENT_CHANGE,action:()=>{l[e].text._hideTooltip(),p=c.icon,this.fireEvent("CELL_FILTER_CLICK",{e:{},x:0,y:0,cell:{},id:this.id,headerArea:r,sortArea:n,sortRule:t,index:o,direction:i}),null==m||m.hideView()}}]}})),g=a?null===(c=t.find((e=>e.description===a)))||void 0===c?void 0:c.iconId:void 0;let m;p=g?h[g]:void 0,BI.createWidget({element:e.el,type:BI.AbsoluteLayout.xtype,items:[{el:{type:BI.Combo.xtype,ref:e=>{m=e},adjustLength:2,hideWhenAnotherComboOpen:!0,el:{type:BI.IconChangeButton.xtype,iconCls:p||d,cls:"icon-size-16",width:16,height:16,ref:e=>{u=e}},popup:{minWidth:80,minHeight:25,maxHeight:500,el:{type:BI.ButtonGroup.xtype,items:f,layouts:[{type:BI.VerticalLayout.xtype}]}},listeners:[{eventName:BI.Combo.EVENT_BEFORE_POPUPVIEW,action:()=>{u.setIcon(p||"triangle-down-font")}},{eventName:BI.Combo.EVENT_BEFORE_HIDEVIEW,action:()=>{u.setIcon(p||d)}}]},bottom:1,right:0,width:16,height:16}]}),null==m||m.element.mousedown((e=>{e.stopPropagation()})),null==m||m.element.mouseup((e=>{e.stopPropagation()}))},value:""}}function _classCallCheck$S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$R(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$R(n.key),n)}}function _createClass$S(e,t,r){return t&&_defineProperties$R(e.prototype,t),r&&_defineProperties$R(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$R(e){var t=_toPrimitive$R(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$R(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}CellCacheManager.NAME="CELL_CACHE",type2DescriptionEnum2=type2DescriptionEnum||(type2DescriptionEnum={}),type2DescriptionEnum2[type2DescriptionEnum2["Fine-Engine_Sort_No_Order"]=0]="Fine-Engine_Sort_No_Order",type2DescriptionEnum2[type2DescriptionEnum2["Fine-Engine_Sort_Ascending_Order"]=1]="Fine-Engine_Sort_Ascending_Order",type2DescriptionEnum2[type2DescriptionEnum2["Fine-Engine_Sort_Descending_Order"]=2]="Fine-Engine_Sort_Descending_Order";let AbstractTableCell=function(){function e(t,r){_classCallCheck$S(this,e),this.id=BI.UUID(),this.cellStickerDict=new Map([["html",this.toHtml],["state",this.toState],["widget",this.toWidget],["filter",this.toFilter]]),this.options=t,this.external=r,this.cellControllerManager=this.external.getStickerManagers().get(CellControllerManager.NAME)||new CellControllerManager,this.cellErrorTipManager=this.external.getStickerManagers().get(CellErrorTipManager.NAME)||new CellErrorTipManager,this.cellCacheManager=this.external.getStickerManagers().get(CellCacheManager.NAME)||new CellCacheManager,r.getStickerManagers().set(CellControllerManager.NAME,this.cellControllerManager),r.getStickerManagers().set(CellErrorTipManager.NAME,this.cellErrorTipManager),r.getStickerManagers().set(CellCacheManager.NAME,this.cellCacheManager),this.id=BI.isNotNull(t.cell.id)?"".concat(t.cell.id):transformPosition2Id(t.cell.position.x,t.cell.position.y)}return _createClass$S(e,[{key:"getCellStickerDict",value:function(){return this.cellStickerDict}},{key:"getTextByCellValue",value:function(t){const{cell:r,widget:n}=this.options,o=cellControllerProvider.getTextTransformer(null==n?void 0:n.type)(e.transform2CellText(r.text||t||r.value));return BI.isNull(r.cv)||BI.isNull(r.transformed)?o:BI.contentFormat(o,r.fmt)}},{key:"isDirectWidget",value:function(){const{cell:e,widget:t}=this.options;return!(!e.isShowWidgets&&!cellControllerProvider.isDirect(null==t?void 0:t.type)||!t)}},{key:"toCell",value:function(){return this.isDirectWidget()?this.toEmptyCell():this.toFullCell()}},{key:"toHtml",value:function(){}},{key:"fireEvent",value:function(e,t){const r=[];return this.options.listeners.forEach((n=>{n.eventName===e&&n.action&&r.push(Promise.resolve(n.action(t)))})),r}},{key:"toEmptyCell",value:function(){const{cell:e,celladvancedattr:t,style:r}=this.options,{borderStyle:n,backgroundStyle:o}=r;return{type:BI.AbsoluteLayout.xtype,listeners:[{eventName:"CELL_DOUBLE_CLICK",action:(e,t,r,n)=>(this.fireEvent("CELL_DOUBLE_CLICK",{e:e,x:t,y:r,cell:n,hyperLinks:[],id:this.id}),!0)},{eventName:"CELL_CLICK",action:(e,t,r,n)=>(this.fireEvent("CELL_CLICK",{e:e,x:t,y:r,cell:n,hyperLinks:[],id:this.id}),!0)},{eventName:"CELL_MOUSE_LEAVE",action:(e,t,r,n)=>{this.fireEvent("CELL_MOUSE_LEAVE",{e:e,x:t,y:r,cell:n})}},{eventName:"CELL_MOUSE_DOWN",action:(e,t,r,n)=>{this.fireEvent("CELL_MOUSE_DOWN",{e:e,x:t,y:r,cell:n})}},{eventName:"CELL_HOVER",action:(e,t,r,n)=>{this.fireEvent("CELL_HOVER",{e:e,x:t,y:r,cell:n})}}],borderStyle:n,backgroundStyle:o,canCopy:!0,cursor:void 0,valid:e.valid,title:null==t?void 0:t.tooltipText,position:e.position}}},{key:"toWidget",value:function(){return transformCell2Widget.apply(this)}},{key:"toState",value:function(){if(this.options.widget)return;const{edited:e,errorMsg:t}=this.options.cell;return e||t?{id:"".concat(this.id,"_state"),init:(e,t,r)=>{const n=t-1,o=r-1,i=this.getStateWidgetJson(n,o);BI.size(i)>0&&(e.css("overflow","visible"),BI.createWidget({type:BI.DefaultLayout.xtype,element:e.el,items:[{type:BI.AbsoluteLayout.xtype,width:n,height:o,items:i}]}))},value:""}:void 0}},{key:"getStateWidgetJson",value:function(e,t){const{edited:r,errorMsg:n}=this.options.cell,o=this,i=[];return r&&i.push({el:{type:BI.Icon.xtype,height:10,width:10,cls:"cell-edited-tip"},top:0,left:0}),n&&i.push({el:{type:BI.Icon.xtype,height:15,width:15,cls:"cell-warning-tip",title:()=>n},left:0,bottom:0},{el:{type:BI.Label.xtype,invisible:!0,cls:"report-cell-error-tip",hgap:5,vgap:5,text:n,created(){o.cellErrorTipManager.register(this,o.id)}},left:e+1,top:1}),i}},{key:"toFilter",value:function(){return transformCell2Filter.apply(this)}}],[{key:"transform2CellText",value:function(e){return BI.isObject(e)?JSON.stringify(e):BI.isNull(e)?"":"".concat(e)}},{key:"transform2String",value:function(e){return"".concat(BI.isNull(e)?"":e)}}])}();function _classCallCheck$R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$Q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$Q(n.key),n)}}function _createClass$R(e,t,r){return t&&_defineProperties$Q(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$Q(e){var t=_toPrimitive$Q(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$Q(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$G(e,t,r){return t=_getPrototypeOf$G(t),_possibleConstructorReturn$G(e,_isNativeReflectConstruct$G()?Reflect.construct(t,r||[],_getPrototypeOf$G(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$G(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$G(e)}function _assertThisInitialized$G(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$G(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$G=function(){return!!e})()}function _getPrototypeOf$G(e){return(_getPrototypeOf$G=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$G(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$G(e,t)}function _setPrototypeOf$G(e,t){return(_setPrototypeOf$G=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let BiasTableCell=function(e){function t(){return _classCallCheck$R(this,t),_callSuper$G(this,t,arguments)}return _inherits$G(t,AbstractTableCell),_createClass$R(t,[{key:"toFullCell",value:function(){const{style:e,cell:t,hyperLinks:r,celladvancedattr:n}=this.options,{texts:o=[],backslash:i=!1}=t,{contentStyle:a,borderStyle:s,backgroundStyle:l}=e,c=BI.concat(.75*parseInt(BI.get(a,"fontSize"),10),"px");return{type:BI.AbsoluteLayout.xtype,bias:{texts:o,backslash:i},style:Object.assign(Object.assign({},a),{fontSize:c,defaultFontSize:c}),borderStyle:s,backgroundStyle:l,listeners:[{eventName:"CELL_CLICK",action:(e,t,n,o)=>(this.fireEvent("CELL_CLICK",{e:e,x:t,y:n,cell:o,hyperLinks:r,id:this.id}),!0)},{eventName:"CELL_DOUBLE_CLICK",action:(e,t,n,o)=>(this.fireEvent("CELL_DOUBLE_CLICK",{e:e,x:t,y:n,cell:o,hyperLinks:r,id:this.id}),!0)},{eventName:"CELL_HOVER",action:(e,t,r,n)=>{this.fireEvent("CELL_HOVER",{e:e,x:t,y:r,cell:n})}},{eventName:"CELL_MOUSE_LEAVE",action:(e,t,r,n)=>{this.fireEvent("CELL_MOUSE_LEAVE",{e:e,x:t,y:r,cell:n})}},{eventName:"CELL_MOUSE_DOWN",action:(e,t,r,n)=>{this.fireEvent("CELL_MOUSE_DOWN",{e:e,x:t,y:r,cell:n})}}],value:(o||[]).join("|"),position:t.position,title:null==n?void 0:n.tooltipText}}},{key:"toWidget",value:function(){}},{key:"isDirectWidget",value:function(){return!1}}])}();function _classCallCheck$Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$P(n.key),n)}}function _createClass$Q(e,t,r){return t&&_defineProperties$P(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$P(e){var t=_toPrimitive$P(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$P(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$F(e,t,r){return t=_getPrototypeOf$F(t),_possibleConstructorReturn$F(e,_isNativeReflectConstruct$F()?Reflect.construct(t,r||[],_getPrototypeOf$F(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$F(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$F(e)}function _assertThisInitialized$F(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$F(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$F=function(){return!!e})()}function _superPropGet$2(e,t,r,n){var o=_get$2(_getPrototypeOf$F(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$2(){return _get$2="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$2(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$2.apply(null,arguments)}function _superPropBase$2(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$F(e)););return e}function _getPrototypeOf$F(e){return(_getPrototypeOf$F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$F(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$F(e,t)}function _setPrototypeOf$F(e,t){return(_setPrototypeOf$F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let AbstractReportChart=function(e){function t(){var e;return _classCallCheck$Q(this,t),(e=_callSuper$F(this,t,arguments)).props={chartAttrGetter:async()=>({}),autoSize:!0,instantiateXHyperLinks:e=>instantiateXHyperLinks(e),wScale:1,hScale:1,fontScale:1},e}return _inherits$F(t,BI.Widget),_createClass$Q(t,[{key:"destroy",value:function(){this.remove(),_superPropGet$2(t,"destroy",this)([])}},{key:"getChart",value:function(){return this.chart}}])}();function _classCallCheck$P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$O(n.key),n)}}function _createClass$P(e,t,r){return t&&_defineProperties$O(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$O(e){var t=_toPrimitive$O(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$O(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$E(e,t,r){return t=_getPrototypeOf$E(t),_possibleConstructorReturn$E(e,_isNativeReflectConstruct$E()?Reflect.construct(t,r||[],_getPrototypeOf$E(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$E(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$E(e)}function _assertThisInitialized$E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$E(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$E=function(){return!!e})()}function _getPrototypeOf$E(e){return(_getPrototypeOf$E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$E(e,t)}function _setPrototypeOf$E(e,t){return(_setPrototypeOf$E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}AbstractReportChart.EVENT_LOADED="EVENT_LOADED";var __decorate$6=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ReportChartAlpha_1;let ReportChartAlpha=ReportChartAlpha_1=function(e){function t(){return _classCallCheck$P(this,t),_callSuper$E(this,t,arguments)}return _inherits$E(t,AbstractReportChart),_createClass$P(t,[{key:"render",value:function(){return{type:BI.AbsoluteLayout.xtype}}},{key:"mounted",value:function(){this.options.chartAttrGetter().then((e=>{if("errorCode"in e)throw this.fireEvent("EVENT_SHOW_ERROR",e),{errorCode:e.errorCode,errorMsg:e.errorMsg};this.chartAttr=e}));const e=VanCharts.init(this.element[0]);e.setOptions(this.chartAttr),this.bind(e)}},{key:"refresh",value:function(e=this.chartAttr){const t=VanCharts.init(this.element[0]);t.clear(),t.setOptions(e),this.bind(t)}},{key:"resize",value:function(){const e=VanCharts.init(this.element[0]);e.resize(),this.bind(e)}},{key:"bind",value:function(e){e.doHyperlink=e=>{this.fireEvent(ReportChartAlpha_1.EVENT_HYPER_LINK,e)}}},{key:"changeParameter",value:function(){}},{key:"reload",value:function(){}},{key:"remove",value:function(){}}])}();ReportChartAlpha.xtype="report.chart_alpha",ReportChartAlpha.EVENT_HYPER_LINK="EVENT_HYPER_LINK",ReportChartAlpha.VERSION="1.0.0",ReportChartAlpha.BUILD_TIME="2020-8-3 09:48:57",__decorate$6([errorTip()],ReportChartAlpha.prototype,"render",null),ReportChartAlpha=ReportChartAlpha_1=__decorate$6([shortcut()],ReportChartAlpha);var __rest$2=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};function fetchChartData(e){const{chartID:t,widgetName:r=""}=e,n=__rest$2(e,["chartID","widgetName"]);return requestGet("chart/data",{params:Object.assign({chartID:t,ecName:r},n)})}function fetchChartHyperLinks(e){return requestPost("chart/calculate/hyperlink",{data:e})}function _classCallCheck$O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$N(n.key),n)}}function _createClass$O(e,t,r){return t&&_defineProperties$N(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$N(e){var t=_toPrimitive$N(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$N(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$D(e,t,r){return t=_getPrototypeOf$D(t),_possibleConstructorReturn$D(e,_isNativeReflectConstruct$D()?Reflect.construct(t,r||[],_getPrototypeOf$D(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$D(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$D(e)}function _assertThisInitialized$D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$D(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$D=function(){return!!e})()}function _superPropGet$1(e,t,r,n){var o=_get$1(_getPrototypeOf$D(e.prototype),t,r);return"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get$1(){return _get$1="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase$1(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get$1.apply(null,arguments)}function _superPropBase$1(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$D(e)););return e}function _getPrototypeOf$D(e){return(_getPrototypeOf$D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$D(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$D(e,t)}function _setPrototypeOf$D(e,t){return(_setPrototypeOf$D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let ChartManager=function(e){function t(){return _classCallCheck$O(this,t),_callSuper$D(this,t,arguments)}return _inherits$D(t,WidgetManager),_createClass$O(t,[{key:"register",value:function(e,r){_superPropGet$1(t,"register",this)([e,r.toUpperCase()])}},{key:"destroy",value:function(){this.getWidgets().forEach((e=>{e.destroy()})),_superPropGet$1(t,"destroy",this)([])}},{key:"refresh",value:function(){this.getWidgets().forEach((e=>{e.refresh()}))}},{key:"deleteWidget",value:function(e){this.getWidgetsMap().delete(e.toUpperCase())}}])}();const chartManager=new ChartManager;function _classCallCheck$N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$M(n.key),n)}}function _createClass$N(e,t,r){return t&&_defineProperties$M(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$M(e){var t=_toPrimitive$M(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$M(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$C(e,t,r){return t=_getPrototypeOf$C(t),_possibleConstructorReturn$C(e,_isNativeReflectConstruct$C()?Reflect.construct(t,r||[],_getPrototypeOf$C(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$C(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$C(e)}function _assertThisInitialized$C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$C(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$C=function(){return!!e})()}function _getPrototypeOf$C(e){return(_getPrototypeOf$C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$C(e,t)}function _setPrototypeOf$C(e,t){return(_setPrototypeOf$C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __decorate$5=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ReportChartBeta=function(e){function t(){var e;return _classCallCheck$N(this,t),(e=_callSuper$C(this,t,arguments)).hyperlinkHandler=new HyperLinkClickHandler((t=>{BI.createWidget(Object.assign(Object.assign({},t),{element:e}))})),e.props={chartAttrGetter:async()=>({}),autoSize:!0,instantiateXHyperLinks:e=>instantiateXHyperLinks(e),wScale:1,hScale:1,fontScale:1,chartHyperLinkId:"",chartHyperLinkFetcher:fetchChartHyperLinks,changeParameter:(e,t)=>{e.changeParameter(t)}},e}return _inherits$C(t,AbstractReportChart),_createClass$N(t,[{key:"render",value:function(){return VanCharts.resetGlobalScale(this.options.fontScale),{type:BI.AbsoluteLayout.xtype}}},{key:"mounted",value:function(){this.getChartAttr().then((e=>{if("errorCode"in e)throw this.fireEvent("EVENT_SHOW_ERROR",e),{errorCode:e.errorCode,errorMsg:e.errorMsg};this.chartAttr=e;const t=chartManager.getWidgetByName(this.chartAttr.chartID);t&&t.remove(),this.initChart(),this.fireEvent(AbstractReportChart.EVENT_LOADED)}))}},{key:"refresh",value:function(){const{wScale:e,hScale:t,fontScale:r}=this.options;this.resize(e,t,r)}},{key:"reload",value:async function(e){this.chartAttr=e||await this.getChartAttr(),this.initChart()}},{key:"changeParameter",value:function(e){this.options.changeParameter(this.chart,e)}},{key:"resize",value:function(e,t,r){var n;this.options.fontScale=r,VanCharts.resetGlobalScale(r),null===(n=this.chart)||void 0===n||n.resize()}},{key:"initChart",value:function(){this.remove(),this.enforceChartAttr(),this.chart=new VanChartWidget(this.chartAttr,this.element),chartManager.register(this,this.chartAttr.chartID)}},{key:"enforceChartAttr",value:function(){var e;const{fontScale:t}=this.options;(null===(e=this.chartAttr)||void 0===e?void 0:e.chartAttr)&&(this.chartAttr.chartAttr.scale=t)}},{key:"remove",value:function(){this.removeChart(),this.chartAttr&&chartManager.deleteWidget(this.chartAttr.chartID)}},{key:"removeChart",value:function(){this.chart&&this.chart.chartWrapper&&(this.chart.chartWrapper.clearAll(),this.chart.options=this.chart.chartWrapper=null)}},{key:"getChartAttr",value:async function(){const e=await this.options.chartAttrGetter();return Object.assign(Object.assign({},e),{doFineHyperlink:(e,t,r=e=>e)=>{let n=[];!t.ChartHyperlink_ID&&(t.ChartHyperlink_ID=this.options.chartHyperLinkId),this.options.chartHyperLinkFetcher(t).then((t=>{var o;const i=r((null===(o=t.nxNameJavascriptGroup)||void 0===o?void 0:o.javaScriptGroup)||[]);n=this.options.instantiateXHyperLinks(i),this.hyperlinkHandler.handle(e,n)}))}})}},{key:"destroyed",value:function(){var e,t,r,n,o,i;null===(t=null===(e=this.chart)||void 0===e?void 0:e.remove)||void 0===t||t.call(e),null===(n=null===(r=this.chart)||void 0===r?void 0:r.clear)||void 0===n||n.call(r),null===(i=null===(o=this.chart)||void 0===o?void 0:o.dispose)||void 0===i||i.call(o),this.chart=null}}])}();function _classCallCheck$M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$L(n.key),n)}}function _createClass$M(e,t,r){return t&&_defineProperties$L(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$L(e){var t=_toPrimitive$L(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$L(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$B(e,t,r){return t=_getPrototypeOf$B(t),_possibleConstructorReturn$B(e,_isNativeReflectConstruct$B()?Reflect.construct(t,r||[],_getPrototypeOf$B(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$B(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$B(e)}function _assertThisInitialized$B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$B(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$B=function(){return!!e})()}function _getPrototypeOf$B(e){return(_getPrototypeOf$B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$B(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$B(e,t)}function _setPrototypeOf$B(e,t){return(_setPrototypeOf$B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ReportChartBeta.xtype="report.chart_beta",ReportChartBeta.VERSION="1.0.0",ReportChartBeta.BUILD_TIME="2020-8-31 09:27:02",__decorate$5([errorTip()],ReportChartBeta.prototype,"render",null),ReportChartBeta=__decorate$5([shortcut()],ReportChartBeta);var __decorate$4=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ReportChartGamma=function(e){function t(){return _classCallCheck$M(this,t),_callSuper$B(this,t,arguments)}return _inherits$B(t,ReportChartBeta),_createClass$M(t,[{key:"removeChart",value:function(){var e;null===(e=this.chart)||void 0===e||e.remove()}},{key:"refresh",value:function(){var e;null===(e=this.chart)||void 0===e||e.resize()}}])}();function _classCallCheck$L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$K(n.key),n)}}function _createClass$L(e,t,r){return t&&_defineProperties$K(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$K(e){var t=_toPrimitive$K(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$K(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$A(e,t,r){return t=_getPrototypeOf$A(t),_possibleConstructorReturn$A(e,_isNativeReflectConstruct$A()?Reflect.construct(t,r||[],_getPrototypeOf$A(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$A(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$A(e)}function _assertThisInitialized$A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$A(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$A=function(){return!!e})()}function _getPrototypeOf$A(e){return(_getPrototypeOf$A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$A(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$A(e,t)}function _setPrototypeOf$A(e,t){return(_setPrototypeOf$A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}ReportChartGamma.xtype="report.chart_gamma",ReportChartGamma.VERSION="1.0.0",ReportChartGamma.BUILD_TIME="2020-11-2 17:32:05",ReportChartGamma=__decorate$4([shortcut()],ReportChartGamma);var __decorate$3=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ReportChartDelta=function(e){function t(){return _classCallCheck$L(this,t),_callSuper$A(this,t,arguments)}return _inherits$A(t,ReportChartGamma),_createClass$L(t,[{key:"resize",value:function(e,t,r){var n;t&&e&&(this.options.wScale=e,this.options.hScale=t,this.options.fontScale=r,null===(n=this.chart)||void 0===n||n.setAutoFitScale(r,e,t))}},{key:"enforceChartAttr",value:function(){var e;const{wScale:t,hScale:r,fontScale:n}=this.options;(null===(e=this.chartAttr)||void 0===e?void 0:e.chartAttr)&&(this.chartAttr.chartAttr.wScale=t,this.chartAttr.chartAttr.hScale=r,this.chartAttr.chartAttr.fontScale=n)}},{key:"refresh",value:function(){var e;null===(e=this.chart)||void 0===e||e.setAutoFitScale(this.options.fontScale,this.options.wScale,this.options.hScale)}},{key:"render",value:function(){return{type:BI.AbsoluteLayout.xtype}}}])}();function _classCallCheck$K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$J(n.key),n)}}function _createClass$K(e,t,r){return t&&_defineProperties$J(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$J(e){var t=_toPrimitive$J(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$J(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}ReportChartDelta.xtype="report.chart_delta",ReportChartDelta.VERSION="2.0.0",ReportChartDelta.BUILD_TIME="",__decorate$3([errorTip()],ReportChartDelta.prototype,"render",null),ReportChartDelta=__decorate$3([shortcut()],ReportChartDelta);let ReportChartProvider=_createClass$K((function e(){_classCallCheck$K(this,e),this.list=[ReportChartDelta,ReportChartGamma,ReportChartBeta,ReportChartAlpha]}),[{key:"initChart",value:function(){if(this.chart)return;const{version:e,buildTime:t}=VanCharts,r=this.list.find((r=>"1.0.0"===e?new Date(t)>=new Date(r.BUILD_TIME):e>=r.VERSION));this.chart=r||ReportChartBeta}},{key:"xtype",get:function(){return this.initChart(),this.chart.xtype}},{key:"hideFullScreenChart",value:function(){VanCharts.hideFullScreenChart()}}]);const reportChartProvider=new ReportChartProvider;function _classCallCheck$J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$I(n.key),n)}}function _createClass$J(e,t,r){return t&&_defineProperties$I(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$I(e){var t=_toPrimitive$I(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$I(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$z(e,t,r){return t=_getPrototypeOf$z(t),_possibleConstructorReturn$z(e,_isNativeReflectConstruct$z()?Reflect.construct(t,r||[],_getPrototypeOf$z(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$z(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$z(e)}function _assertThisInitialized$z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$z=function(){return!!e})()}function _getPrototypeOf$z(e){return(_getPrototypeOf$z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$z(e,t)}function _setPrototypeOf$z(e,t){return(_setPrototypeOf$z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let CellChartManager=function(e){function t(){var e;return _classCallCheck$J(this,t),(e=_callSuper$z(this,t,arguments)).linkageCache=new Map,e.chartLoadedCache=new Map,e}return _inherits$z(t,ChartManager),_createClass$J(t,[{key:"getWidgetByCellName",value:function(e){let t;return this.controllerDict.forEach(((r,n)=>{this.isChartIDMatchWithCellName(n,e)&&(t=r)})),t}},{key:"link",value:function(e,t){const r=this.getWidgetByCellName(t);r?r.changeParameter(e):this.linkageCache.set(t,e)}},{key:"isChartIDMatchWithCellName",value:function(e,t){return e.toUpperCase().startsWith("Cells__".concat(t).toUpperCase())}},{key:"getParameterCacheByChartID",value:function(e,t=!0){let r="";Array.from(this.linkageCache.keys()).some((t=>!!this.isChartIDMatchWithCellName(e,t)&&(r=t,!0)));const n=this.linkageCache.get(r)||{};return t&&this.linkageCache.delete(r),n}},{key:"update",value:function(){}},{key:"setCellChartload",value:function(e,t){this.chartLoadedCache.set(e,t)}},{key:"getCellChartAllLoaded",value:function(){if(0===this.chartLoadedCache.size)return!0;const e=this.chartLoadedCache.values();return Array.from(e).every((e=>!0===e))}}])}();function _classCallCheck$I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$H(n.key),n)}}function _createClass$I(e,t,r){return t&&_defineProperties$H(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$H(e){var t=_toPrimitive$H(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$H(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$y(e,t,r){return t=_getPrototypeOf$y(t),_possibleConstructorReturn$y(e,_isNativeReflectConstruct$y()?Reflect.construct(t,r||[],_getPrototypeOf$y(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$y(e)}function _assertThisInitialized$y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$y=function(){return!!e})()}function _getPrototypeOf$y(e){return(_getPrototypeOf$y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$y(e,t)}function _setPrototypeOf$y(e,t){return(_setPrototypeOf$y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}CellChartManager.NAME="CELL_CHART";let ChartNewCell=function(e){function t(e,r){var n,o;return _classCallCheck$I(this,t),(n=_callSuper$y(this,t,[e,r])).fontResizable=!1,n.cellChartManager=n.external.getStickerManagers().get(CellChartManager.NAME)||new CellChartManager,n.fontResizable=n.external.getFontResizable(),r.getStickerManagers().set(CellChartManager.NAME,n.cellChartManager),n.chartContext=(null===(o=r.getExternals())||void 0===o?void 0:o.chart)||{},n.cellChartManager.setCellChartload(n.id,!1),n.external.setCellChartLoaded(!1),n}return _inherits$y(t,AbstractTableCell),_createClass$I(t,[{key:"getChartData",value:async function(e){if(this.chartContext.chartDataFetcher)return this.chartContext.chartDataFetcher(e);const t=this.fireEvent("CELL_CHART_FETCH_DATA",{e:{},cell:{},x:this.options.cell.position.x,y:this.options.cell.position.y,id:this.id,requestParams:e});return 0===BI.size(t)?fetchChartData(e):BI.last(t)}},{key:"toFullCell",value:function(){const{style:e,cell:t,celladvancedattr:r}=this.options,{borderStyle:n,backgroundStyle:o}=e;return{type:BI.AbsoluteLayout.xtype,borderStyle:n,backgroundStyle:o,stopPropagation:!0,position:t.position,title:null==r?void 0:r.tooltipText}}},{key:"toHtml",value:function(){const{cell:e}=this.options,{chartHeight:t,chartWidth:r}=e,n=this.external.getWidgetName(),o=e.items?e.items[0].simpleChartInShowID:"";return{id:"".concat(this.id,"_html"),value:"",init:(i,a,s)=>{if(!i||this.external.getIsRowChunking())return;i.css("cursor",e.cursor||"default");const l=Math.round(a)/r,c=Math.round(s)/t,u=this.fontResizable?Math.min(l,c):1;let d=this.cellChartManager.getWidgetByName(o);const h=!!d;d||(d=BI.createWidget({type:reportChartProvider.xtype,width:a,height:s,wScale:l,hScale:c,fontScale:u,chartAttrGetter:async()=>this.getChartData({chartID:o,widgetName:n}).then((e=>Object.assign(Object.assign({},e),{chartID:o}))),instantiateXHyperLinks:e=>instantiateMergedXHyperLinks(this.external.getLinkConfig(),e,{managersGetter:()=>this.external.getStickerManagers()}),chartHyperLinkFetcher:this.chartContext.chartHyperLinkFetcher,changeParameter:this.chartContext.changeParameter,listeners:[{eventName:AbstractReportChart.EVENT_LOADED,action:()=>{const e=this.cellChartManager.getParameterCacheByChartID(o);BI.isEmptyObject(e)||undefined.changeParameter(e),this.cellChartManager.setCellChartload(this.id,!0),this.cellChartManager.getCellChartAllLoaded()&&setTimeout((()=>{this.external.setCellChartLoaded(!0)}),1500)}}]}),this.cellChartManager.register(d,o)),BI.createWidget({type:BI.DefaultLayout.xtype,element:i.el,items:[{type:BI.AbsoluteLayout.xtype,items:[h?{el:{type:BI.DefaultLayout.xtype,mounted(){BI.mount(d,this.element[0]),null==d||d.element.width(a),null==d||d.element.height(s),null==d||d.resize(l,c,u)}},top:0,left:0,right:0,bottom:0}:{el:d,top:0,left:0,right:0,bottom:0}]}]})}}}},{key:"toWidget",value:function(){}},{key:"toState",value:function(){}}])}();function _classCallCheck$H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$G(n.key),n)}}function _createClass$H(e,t,r){return t&&_defineProperties$G(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$G(e){var t=_toPrimitive$G(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$G(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$x(e,t,r){return t=_getPrototypeOf$x(t),_possibleConstructorReturn$x(e,_isNativeReflectConstruct$x()?Reflect.construct(t,r||[],_getPrototypeOf$x(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$x(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$x(e)}function _assertThisInitialized$x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$x(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$x=function(){return!!e})()}function _getPrototypeOf$x(e){return(_getPrototypeOf$x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$x(e,t)}function _setPrototypeOf$x(e,t){return(_setPrototypeOf$x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let CurrencyLineTableCell=function(e){function t(){return _classCallCheck$H(this,t),_callSuper$x(this,t,arguments)}return _inherits$x(t,AbstractTableCell),_createClass$H(t,[{key:"toFullCell",value:function(){const{style:e,cell:t,hyperLinks:r,celladvancedattr:n}=this.options,{text:o,currencyLineAttr:i}=t,a=AbstractTableCell.transform2CellText(o),{contentStyle:s,borderStyle:l,backgroundStyle:c}=e;return{type:BI.AbsoluteLayout.xtype,currencyLineAttr:a?i:void 0,style:Object.assign({},s),borderStyle:l,backgroundStyle:c,listeners:[{eventName:"CELL_CLICK",action:(e,t,n,o)=>(this.fireEvent("CELL_CLICK",{e:e,x:t,y:n,cell:o,hyperLinks:r,id:this.id}),!0)},{eventName:"CELL_DOUBLE_CLICK",action:(e,t,n,o)=>(this.fireEvent("CELL_DOUBLE_CLICK",{e:e,x:t,y:n,cell:o,hyperLinks:r,id:this.id}),!0)},{eventName:"CELL_HOVER",action:(e,t,r,n)=>{this.fireEvent("CELL_HOVER",{e:e,x:t,y:r,cell:n})}},{eventName:"CELL_MOUSE_LEAVE",action:(e,t,r,n)=>{this.fireEvent("CELL_MOUSE_LEAVE",{e:e,x:t,y:r,cell:n})}},{eventName:"CELL_MOUSE_DOWN",action:(e,t,r,n)=>{this.fireEvent("CELL_MOUSE_DOWN",{e:e,x:t,y:r,cell:n})}}],value:a,position:t.position,canCopy:!0,cursor:0===r.length?"default":"pointer",valid:t.valid,title:null==n?void 0:n.tooltipText}}}])}();function _classCallCheck$G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$F(n.key),n)}}function _createClass$G(e,t,r){return t&&_defineProperties$F(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$F(e){var t=_toPrimitive$F(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$F(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$w(e,t,r){return t=_getPrototypeOf$w(t),_possibleConstructorReturn$w(e,_isNativeReflectConstruct$w()?Reflect.construct(t,r||[],_getPrototypeOf$w(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$w(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$w(e)}function _assertThisInitialized$w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$w(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$w=function(){return!!e})()}function _getPrototypeOf$w(e){return(_getPrototypeOf$w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$w(e,t)}function _setPrototypeOf$w(e,t){return(_setPrototypeOf$w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let DownloadTableCell=function(e){function t(){return _classCallCheck$G(this,t),_callSuper$w(this,t,arguments)}return _inherits$w(t,AbstractTableCell),_createClass$G(t,[{key:"toFullCell",value:function(){var e;const{style:t,cell:r,celladvancedattr:n}=this.options,o=(null===(e=n)||void 0===e?void 0:e.fileName)||"",{contentStyle:i,borderStyle:a,backgroundStyle:s,paddingLeft:l,paddingRight:c,spacingBefore:u,spacingAfter:d}=t,h=[getLinkHandlerProvider().getHandler({type:DEFAUTL_LINK_TYPE.DOWNLOAD,name:BI.UUID(),id:r.attach_id})];return i&&(i.underline={width:1,style:"solid",color:"#0000ff",dash:[]},i.color="#0000ff"),{type:BI.AbsoluteLayout.xtype,items:[{el:{type:BI.Label.xtype,style:i,listeners:[{eventName:"CELL_CLICK",action:(e,t,r,n)=>(this.fireEvent("CELL_CLICK",{e:e,x:t,y:r,cell:n,hyperLinks:h,id:this.id}),!0)}],text:o,autoWrapInfo:r.autoWrapInfo},left:l,right:c,top:u,bottom:d}],listeners:[{eventName:"CELL_HOVER",action:(e,t,r,n)=>{this.fireEvent("CELL_HOVER",{e:e,x:t,y:r,cell:n})}},{eventName:"CELL_MOUSE_LEAVE",action:(e,t,r,n)=>{this.fireEvent("CELL_MOUSE_LEAVE",{e:e,x:t,y:r,cell:n})}},{eventName:"CELL_MOUSE_DOWN",action:(e,t,r,n)=>{this.fireEvent("CELL_MOUSE_DOWN",{e:e,x:t,y:r,cell:n})}}],backgroundStyle:s,borderStyle:a,value:o,position:r.position,canCopy:!0,cursor:"pointer",valid:r.valid,title:null==n?void 0:n.tooltipText}}},{key:"toWidget",value:function(){}}])}();function _classCallCheck$F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$E(n.key),n)}}function _createClass$F(e,t,r){return t&&_defineProperties$E(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$E(e){var t=_toPrimitive$E(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$E(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$v(e,t,r){return t=_getPrototypeOf$v(t),_possibleConstructorReturn$v(e,_isNativeReflectConstruct$v()?Reflect.construct(t,r||[],_getPrototypeOf$v(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$v(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$v(e)}function _assertThisInitialized$v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$v=function(){return!!e})()}function _getPrototypeOf$v(e){return(_getPrototypeOf$v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$v(e,t)}function _setPrototypeOf$v(e,t){return(_setPrototypeOf$v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let ImageCell=function(e){function t(){return _classCallCheck$F(this,t),_callSuper$v(this,t,arguments)}return _inherits$v(t,AbstractTableCell),_createClass$F(t,[{key:"transform2ImageCell",value:function(e,t,r){var n,o;const{cell:i,hyperLinks:a}=this.options,{borderStyle:s,backgroundStyle:l,paddingLeft:c,paddingRight:u}=e;return{type:BI.AbsoluteLayout.xtype,items:[{el:{type:BI.AbsoluteLayout.xtype,style:{backgroundImage:t,backgroundSize:r},listeners:[{eventName:"CELL_CLICK",action:(e,t,r,n)=>(this.fireEvent("CELL_CLICK",{e:e,x:t,y:r,cell:n,hyperLinks:a,id:this.id}),!0)}]},left:c,right:u,top:0,bottom:0}],listeners:[{eventName:"CELL_DOUBLE_CLICK",action:(e,t,r,n)=>(this.fireEvent("CELL_DOUBLE_CLICK",{e:e,x:t,y:r,cell:n,hyperLinks:a,id:this.id}),!0)},{eventName:"CELL_HOVER",action:(e,t,r,n)=>{this.fireEvent("CELL_HOVER",{e:e,x:t,y:r,cell:n})}},{eventName:"CELL_MOUSE_LEAVE",action:(e,t,r,n)=>{this.fireEvent("CELL_MOUSE_LEAVE",{e:e,x:t,y:r,cell:n})}},{eventName:"CELL_MOUSE_DOWN",action:(e,t,r,n)=>{this.fireEvent("CELL_MOUSE_DOWN",{e:e,x:t,y:r,cell:n})}}],borderStyle:s,backgroundStyle:l,position:i.position,image:t,canCopy:"SHOW_AS_IMAGE"===(null===(n=this.options.celladvancedattr)||void 0===n?void 0:n.contentShowType),cursor:0===this.options.hyperLinks.length?"default":"pointer",valid:i.valid,title:null===(o=this.options.celladvancedattr)||void 0===o?void 0:o.tooltipText}}}])}(),ImageTableCell=function(e){function t(){return _classCallCheck$F(this,t),_callSuper$v(this,t,arguments)}return _inherits$v(t,ImageCell),_createClass$F(t,[{key:"toFullCell",value:function(){var e;const{style:t,cell:r}=this.options,n=null===(e=this.external.getExternals())||void 0===e?void 0:e.attachPrefix,{attachid:o="",cache:i=!1,imageLayout:a=3,value:s}=r,l=getImgLayout(a);return this.transform2ImageCell(t,s?"data:image;base64,".concat(s):getCompleteImageUrl(o,i,n),l)}}])}();function _classCallCheck$E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$D(n.key),n)}}function _createClass$E(e,t,r){return t&&_defineProperties$D(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$D(e){var t=_toPrimitive$D(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$D(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$u(e,t,r){return t=_getPrototypeOf$u(t),_possibleConstructorReturn$u(e,_isNativeReflectConstruct$u()?Reflect.construct(t,r||[],_getPrototypeOf$u(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$u(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$u(e)}function _assertThisInitialized$u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$u(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$u=function(){return!!e})()}function _getPrototypeOf$u(e){return(_getPrototypeOf$u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$u(e,t)}function _setPrototypeOf$u(e,t){return(_setPrototypeOf$u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}const DEFAULT_SIZE$1=16;BI.createWidget({type:BI.DefaultLayout.xtype,items:[{type:BI.Layout.xtype,css:{"font-family":"fineui"}}],element:"body"});let NodeTableCell=function(e){function t(){return _classCallCheck$E(this,t),_callSuper$u(this,t,arguments)}return _inherits$u(t,AbstractTableCell),_createClass$E(t,[{key:"toFullCell",value:function(){const{style:e,cell:t,hyperLinks:r,celladvancedattr:n}=this.options,{value:o,id:i,indent:a=0,open:s,direction:l}=t,c=AbstractTableCell.transform2CellText(o),{contentStyle:u,borderStyle:d,backgroundStyle:h,paddingLeft:p,paddingRight:f}=e,g=u?parseInt(u.fontSize,10):DEFAULT_SIZE$1,m=g/DEFAULT_SIZE$1,y=(null==u?void 0:u.textAlign)||"left",v=10*m,_="left"===y?15*a*m+v:0;let b="";switch(y){case"center":b="bi.flow_center";break;case"right":b="bi.flow_right";break;default:b="bi.flow_left"}const C=[{eventName:"CELL_CLICK",action:(e,t,n,o)=>(this.fireEvent("CELL_CLICK",{e:e,x:t,y:n,cell:o,hyperLinks:r}),!0)},{eventName:"CELL_HOVER",action:(e,t,r,n)=>{this.fireEvent("CELL_HOVER",{e:e,x:t,y:r,cell:n})}},{eventName:"CELL_MOUSE_LEAVE",action:(e,t,r,n)=>{this.fireEvent("CELL_MOUSE_LEAVE",{e:e,x:t,y:r,cell:n})}},{eventName:"CELL_MOUSE_DOWN",action:(e,t,r,n)=>{this.fireEvent("CELL_MOUSE_DOWN",{e:e,x:t,y:r,cell:n})}}];return{type:b,items:[{el:BI.isNull(s)?{}:{type:BI.Icon.xtype,dblclick:!1,listeners:[{eventName:"CELL_CLICK",action:(e,t,r,n)=>(this.fireEvent("CELL_NODE_CLICK",{e:e,x:t,y:r,cell:n,open:s,id:i,direction:l}),!0)}],icon:Object.assign(Object.assign({},u),{text:s?"":"",textAlign:"center",color:"#ffffff",backgroundColor:"#419bf9",fontStyle:"normal",fontFamily:"fineui",rotate:0,underline:void 0,strikeThrough:"",size:g})},left:_,right:f,top:0,bottom:0},{el:{type:BI.Label.xtype,style:u,text:c,listeners:C},left:BI.isNull(s)?Math.max(p||0):v,right:f,top:0,bottom:0}],backgroundStyle:h,borderStyle:d,value:c,position:t.position,listeners:C,canCopy:!0,cursor:0===r.length?"default":"pointer",valid:t.valid,title:null==n?void 0:n.tooltipText}}},{key:"toWidget",value:function(){}}])}();function _classCallCheck$D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$C(n.key),n)}}function _createClass$D(e,t,r){return t&&_defineProperties$C(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$C(e){var t=_toPrimitive$C(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$C(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$t(e,t,r){return t=_getPrototypeOf$t(t),_possibleConstructorReturn$t(e,_isNativeReflectConstruct$t()?Reflect.construct(t,r||[],_getPrototypeOf$t(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$t(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$t(e)}function _assertThisInitialized$t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$t(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$t=function(){return!!e})()}function _superPropGet(e,t,r,n){var o=_get(_getPrototypeOf$t(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof o?function(e){return o.apply(r,e)}:o}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},_get.apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$t(e)););return e}function _getPrototypeOf$t(e){return(_getPrototypeOf$t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$t(e,t)}function _setPrototypeOf$t(e,t){return(_setPrototypeOf$t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let TextTableCell=function(e){function t(e,r){var n,o,i;_classCallCheck$D(this,t),(n=_callSuper$t(this,t,[e,r])).showAsHtml="SHOW_AS_HTML"===(null===(o=e.celladvancedattr)||void 0===o?void 0:o.contentShowType);const{style:a,cell:s,hyperLinks:l}=e;return n.cellText=n.getTextByCellValue(s.value),n.hyperLinks=n.cellText||(null===(i=null==a?void 0:a.backgroundStyle)||void 0===i?void 0:i.backgroundImage)?l:[],n.cursor=0===BI.size(n.hyperLinks)?"default":"pointer",n}return _inherits$t(t,AbstractTableCell),_createClass$D(t,[{key:"toFullCell",value:function(){const{style:e,cell:t,celladvancedattr:r}=this.options,n=this.cellText,{contentStyle:o,borderStyle:i,backgroundStyle:a,paddingLeft:s,paddingRight:l,spacingBefore:c,spacingAfter:u}=e;return{type:BI.AbsoluteLayout.xtype,items:[{el:{type:BI.Label.xtype,style:o,listeners:[{eventName:"CELL_CLICK",action:(e,t,r,n)=>(this.fireEvent("CELL_CLICK",{e:e,x:t,y:r,cell:n,hyperLinks:this.hyperLinks,id:this.id}),!0)}],text:this.showAsHtml?"":n,autoWrapInfo:t.autoWrapInfo,overflowConfig:{overflowHide:null==r?void 0:r.overflowHide,hideType:null==r?void 0:r.hideType,hideStrLength:null==r?void 0:r.hideStrLength,appendTailStr:null==r?void 0:r.appendTailStr}},left:s,right:l,top:c,bottom:u}],backgroundStyle:a,borderStyle:i,value:n,position:t.position,listeners:[{eventName:"CELL_HOVER",action:(e,t,r,n)=>{this.fireEvent("CELL_HOVER",{e:e,x:t,y:r,cell:n,id:this.id})}},{eventName:"CELL_DOUBLE_CLICK",action:(e,t,r,n)=>(this.fireEvent("CELL_DOUBLE_CLICK",{e:e,x:t,y:r,cell:n,hyperLinks:this.hyperLinks,id:this.id}),!0)},{eventName:"CELL_MOUSE_LEAVE",action:(e,t,r,n)=>{this.fireEvent("CELL_MOUSE_LEAVE",{e:e,x:t,y:r,cell:n})}},{eventName:"CELL_MOUSE_DOWN",action:(e,t,r,n)=>{this.fireEvent("CELL_MOUSE_DOWN",{e:e,x:t,y:r,cell:n})}}],canCopy:!0,cursor:this.cursor,valid:t.valid,title:null==r?void 0:r.tooltipText}}},{key:"toHtml",value:function(){const{cell:e}=this.options;return this.showAsHtml?{id:"".concat(this.id,"_html"),value:"".concat(e.value),cursor:this.cursor,extended:!0}:void 0}},{key:"toWidget",value:function(){if(!this.shouldNotShowWidget())return _superPropGet(t,"toWidget",this,3)([])}},{key:"toCell",value:function(){return this.shouldNotShowWidget()?this.toFullCell():_superPropGet(t,"toCell",this,3)([])}},{key:"shouldNotShowWidget",value:function(){return BI.size(this.hyperLinks)>0&&this.isDirectWidget()}}])}();function _classCallCheck$C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$B(n.key),n)}}function _createClass$C(e,t,r){return t&&_defineProperties$B(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$B(e){var t=_toPrimitive$B(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$B(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$s(e,t,r){return t=_getPrototypeOf$s(t),_possibleConstructorReturn$s(e,_isNativeReflectConstruct$s()?Reflect.construct(t,r||[],_getPrototypeOf$s(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$s(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$s(e)}function _assertThisInitialized$s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$s(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$s=function(){return!!e})()}function _getPrototypeOf$s(e){return(_getPrototypeOf$s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$s(e,t)}function _setPrototypeOf$s(e,t){return(_setPrototypeOf$s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var fillTypes,fillTypes2;fillTypes2=fillTypes||(fillTypes={}),fillTypes2[fillTypes2.REPEAT=0]="REPEAT",fillTypes2[fillTypes2.STRETCH=2]="STRETCH",fillTypes2[fillTypes2.AUTO=4]="AUTO";let WebImageTableCell=function(e){function t(){return _classCallCheck$C(this,t),_callSuper$s(this,t,arguments)}return _inherits$s(t,AbstractTableCell),_createClass$C(t,[{key:"toFullCell",value:function(){const{style:e,cell:t,celladvancedattr:r,hyperLinks:n}=this.options,{borderStyle:o,backgroundStyle:i}=e;return{type:BI.AbsoluteLayout.xtype,stick:!0,borderStyle:o,backgroundStyle:i,position:t.position,canCopy:!0,cursor:"default",valid:t.valid,title:null==r?void 0:r.tooltipText,listeners:[{eventName:"CELL_CLICK",action:(e,t,r,o)=>{this.fireEvent("CELL_CLICK",{e:e,x:t,y:r,cell:o,hyperLinks:n,id:this.id})}},{eventName:"CELL_DOUBLE_CLICK",action:(e,t,r,o)=>(this.fireEvent("CELL_DOUBLE_CLICK",{e:e,x:t,y:r,cell:o,hyperLinks:n,id:this.id}),!0)},{eventName:"CELL_MOUSE_LEAVE",action:(e,t,r,n)=>{this.fireEvent("CELL_MOUSE_LEAVE",{e:e,x:t,y:r,cell:n})}},{eventName:"CELL_MOUSE_DOWN",action:(e,t,r,n)=>{this.fireEvent("CELL_MOUSE_DOWN",{e:e,x:t,y:r,cell:n})}},{eventName:"CELL_HOVER",action:(e,t,r,n)=>{this.fireEvent("CELL_HOVER",{e:e,x:t,y:r,cell:n})}}]}}},{key:"toHtml",value:function(){const{style:e,cell:t}=this.options,{borderStyle:r}=e,n=BI.isNotNull(t.imageLayout)?t.imageLayout:t.layout,o=t.value.replace(/ /g,"%20");let i="",a="initial";return BI.isNull(n)?(i="url(".concat(o,")"),a="100% 100%"):n===fillTypes.REPEAT?i="url(".concat(o,") repeat"):n===fillTypes.STRETCH?(i="url(".concat(o,") no-repeat center"),a="100% 100%"):n===fillTypes.AUTO?(i="url(".concat(o,") no-repeat center"),a="contain"):i="url(".concat(o,") no-repeat center"),{id:"".concat(this.id,"_html"),value:'<div style="height: calc(100% - '.concat(null==r?void 0:r.borderTop.width,"px - ").concat(null==r?void 0:r.borderBottom.width,"px);\n                background: ").concat(i,";\n                background-size: ").concat(a,";\n                margin-top: ").concat(null==r?void 0:r.borderTop.width,"px;\n                margin-left: ").concat(null==r?void 0:r.borderLeft.width,"px;\n                margin-right: ").concat(null==r?void 0:r.borderLeft.width,'px;\n                "></div>').replace(/\s+/g," "),style:{height:"100%"}}}}])}();function _classCallCheck$B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$A(n.key),n)}}function _createClass$B(e,t,r){return t&&_defineProperties$A(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$A(e){var t=_toPrimitive$A(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$A(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function transformCellTypeByOpts(e){const{celladvancedattr:t,cell:r}=e;return"SHOW_AS_DOWNLOAD"===(null==t?void 0:t.contentShowType)?DEFAULT_TABLE_CELL_TYPE.DOWNLOAD:t&&!t.previewContent?DEFAULT_TABLE_CELL_TYPE.BIAS:r.type}let TableCellTypeProvider=_createClass$B((function e(){_classCallCheck$B(this,e),this.typeTransformer=transformCellTypeByOpts}),[{key:"transform",value:function(e){return this.typeTransformer(e)}},{key:"use",value:function(e){this.typeTransformer=e}}]);const tableCellTypeProvider=new TableCellTypeProvider;let TableCellProvider=_createClass$B((function e(){_classCallCheck$B(this,e),this.cellDict={[DEFAULT_TABLE_CELL_TYPE.BIAS]:BiasTableCell,[DEFAULT_TABLE_CELL_TYPE.SIMPLE_CHART]:ChartNewCell,[DEFAULT_TABLE_CELL_TYPE.CHART_CPR_FORM_WIDGET]:ChartNewCell,[DEFAULT_TABLE_CELL_TYPE.currency_LINE]:CurrencyLineTableCell,[DEFAULT_TABLE_CELL_TYPE.IMAGE]:ImageTableCell,[DEFAULT_TABLE_CELL_TYPE.WEBIMAGE]:WebImageTableCell,[DEFAULT_TABLE_CELL_TYPE.TEXT]:TextTableCell,[DEFAULT_TABLE_CELL_TYPE.NODE]:NodeTableCell,[DEFAULT_TABLE_CELL_TYPE.DOWNLOAD]:DownloadTableCell}}),[{key:"get",value:function(e,t){const r=tableCellTypeProvider.transform(e);return new(r in this.cellDict?this.cellDict[r]:this.cellDict.bias)(e,t)}},{key:"set",value:function(e,t){this.cellDict[e]=t}}]);const tableCellProvider=new TableCellProvider;function _classCallCheck$A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$z(n.key),n)}}function _createClass$A(e,t,r){return t&&_defineProperties$z(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$z(e){var t=_toPrimitive$z(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$z(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$r(e,t,r){return t=_getPrototypeOf$r(t),_possibleConstructorReturn$r(e,_isNativeReflectConstruct$r()?Reflect.construct(t,r||[],_getPrototypeOf$r(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$r(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$r(e)}function _assertThisInitialized$r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$r(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$r=function(){return!!e})()}function _getPrototypeOf$r(e){return(_getPrototypeOf$r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$r(e,t)}function _setPrototypeOf$r(e,t){return(_setPrototypeOf$r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let ChartNewLink=function(e){function t(e){var r,n;_classCallCheck$A(this,t),r=_callSuper$r(this,t,[e]);const{width:o,height:i,chartDigTitle:a,chartHyperLinkId:s,parameters:l,external:c}=e;return r.width=o,r.height=i,r.chartDigTitle=a,r.chartHyperLinkId=s,r.parameters=l,r.chartManager=null===(n=null==c?void 0:c.managersGetter)||void 0===n?void 0:n.call(c),r}return _inherits$r(t,AbstractLink),_createClass$A(t,[{key:"_excute",value:function(){const e=this.parameters?this.parameters.reduce(((e,{value:t,name:r})=>(e[r.toUpperCase()]=t,e)),{}):void 0;fetchChartPop(this.chartHyperLinkId,e).then((e=>{this.openChart({width:this.width,height:this.height,chartID:e.items[0].simpleChartInShowID,chartHyperLinkId:this.chartHyperLinkId})}))}},{key:"openChart",value:function(e){const t=BI.UUID(),{chartID:r,width:n,height:o,chartHyperLinkId:i}=e;return BI.Popovers.create(t,{type:ReportPopover.xtype,width:n,height:o,header:this.chartDigTitle,body:{type:reportChartProvider.xtype,chartHyperLinkId:i,instantiateXHyperLinks:e=>instantiateXHyperLinks(e,{managersGetter:()=>this.chartManager}),chartAttrGetter:async()=>{const e=await fetchChartData({chartID:r});return Object.assign(Object.assign({},e),{chartID:r})}}}).open(t),t}}])}();function _classCallCheck$z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$y(n.key),n)}}function _createClass$z(e,t,r){return t&&_defineProperties$y(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$y(e){var t=_toPrimitive$y(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$y(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$q(e,t,r){return t=_getPrototypeOf$q(t),_possibleConstructorReturn$q(e,_isNativeReflectConstruct$q()?Reflect.construct(t,r||[],_getPrototypeOf$q(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$q(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$q(e)}function _assertThisInitialized$q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$q(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$q=function(){return!!e})()}function _getPrototypeOf$q(e){return(_getPrototypeOf$q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$q(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$q(e,t)}function _setPrototypeOf$q(e,t){return(_setPrototypeOf$q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let ChartRelateLink=function(e){function t(e){var r,n;return _classCallCheck$z(this,t),(r=_callSuper$q(this,t,[e])).silent=!0,r.parameters=e.parameters,r.managersGetter=null===(n=e.external)||void 0===n?void 0:n.managersGetter,r.relateCCName=e.relateCCName,r}return _inherits$q(t,AbstractLink),_createClass$z(t,[{key:"_excute",value:function(){var e;const t=this.parameters.reduce(((e,{value:t,name:r})=>(e[r.toUpperCase()]=t,e)),{}),r=null===(e=this.managersGetter)||void 0===e?void 0:e.call(this).get(CellChartManager.NAME);r&&r.link(t,this.relateCCName)}}])}();function _classCallCheck$y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$x(n.key),n)}}function _createClass$y(e,t,r){return t&&_defineProperties$x(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$x(e){var t=_toPrimitive$x(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$x(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$p(e,t,r){return t=_getPrototypeOf$p(t),_possibleConstructorReturn$p(e,_isNativeReflectConstruct$p()?Reflect.construct(t,r||[],_getPrototypeOf$p(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$p(e)}function _assertThisInitialized$p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$p(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$p=function(){return!!e})()}function _getPrototypeOf$p(e){return(_getPrototypeOf$p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$p(e,t)}function _setPrototypeOf$p(e,t){return(_setPrototypeOf$p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}getLinkHandlerProvider().setHandler(DEFAUTL_LINK_TYPE.CHART_POPUP,ChartNewLink),getLinkHandlerProvider().setHandler(DEFAUTL_LINK_TYPE.CHART_RELATE,ChartRelateLink);let HyperLinkCellClickHandler=function(e){function t(){var e;return _classCallCheck$y(this,t),(e=_callSuper$p(this,t,arguments)).eventNames=["CELL_CLICK"],e.merger="",e.name="CELL_HYPERLINK",e.handler=new HyperLinkClickHandler(e.externalContext.attach),e}return _inherits$p(t,AbstractCellHandler),_createClass$y(t,[{key:"action",value:function({e:e,hyperLinks:t}){this.handler.handle(e,t)}}])}();function _classCallCheck$x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$w(n.key),n)}}function _createClass$x(e,t,r){return t&&_defineProperties$w(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$w(e){var t=_toPrimitive$w(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$w(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$o(e,t,r){return t=_getPrototypeOf$o(t),_possibleConstructorReturn$o(e,_isNativeReflectConstruct$o()?Reflect.construct(t,r||[],_getPrototypeOf$o(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$o(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$o(e)}function _assertThisInitialized$o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$o(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$o=function(){return!!e})()}function _getPrototypeOf$o(e){return(_getPrototypeOf$o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$o(e,t)}function _setPrototypeOf$o(e,t){return(_setPrototypeOf$o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let WidgetActiveHandler=function(e){function t(){var e;return _classCallCheck$x(this,t),(e=_callSuper$o(this,t,arguments)).eventNames=["CELL_DOUBLE_CLICK"],e.name="CELL_ACTIVE_WIDGET",e.merger="covered",e}return _inherits$o(t,AbstractCellHandler),_createClass$x(t,[{key:"action",value:async function({id:e}){const t=this.externalContext.getStickerManagers().get(CellControllerManager.NAME);t&&t.getWidgetsMap().forEach(((t,r)=>{r===e&&t.active()}))}}])}();function _classCallCheck$w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$v(n.key),n)}}function _createClass$w(e,t,r){return t&&_defineProperties$v(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$v(e){var t=_toPrimitive$v(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$v(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$n(e,t,r){return t=_getPrototypeOf$n(t),_possibleConstructorReturn$n(e,_isNativeReflectConstruct$n()?Reflect.construct(t,r||[],_getPrototypeOf$n(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$n(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$n(e)}function _assertThisInitialized$n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$n(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$n=function(){return!!e})()}function _getPrototypeOf$n(e){return(_getPrototypeOf$n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$n(e,t)}function _setPrototypeOf$n(e,t){return(_setPrototypeOf$n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let WidgetInactiveHandler=function(e){function t(){var e;return _classCallCheck$w(this,t),(e=_callSuper$n(this,t,arguments)).eventNames=["CELL_DOUBLE_CLICK","CELL_CLICK"],e.name="CELL_INACTIVE_WIDGET",e.merger="uniqe",e}return _inherits$n(t,AbstractCellHandler),_createClass$w(t,[{key:"action",value:async function({id:e}){const t=this.externalContext.getStickerManagers().get(CellControllerManager.NAME);t&&t.getWidgetsMap().forEach(((t,r)=>{r!==e&&t.inactive()}))}}])}();function _classCallCheck$v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$u(n.key),n)}}function _createClass$v(e,t,r){return t&&_defineProperties$u(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$u(e){var t=_toPrimitive$u(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$u(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}let NormalCellValueTransformer=_createClass$v((function e(t,r){_classCallCheck$v(this,e),this.externalInterface=t,this.cellData=r}),[{key:"setValue",value:function(e,t){const r=(null==t?void 0:t.cv)||"";e.cv=r;const{value:n,xtype:o,text:i}=transformCellCv(r);return e.xtype=o,e.value=n,e.text=i,new Promise((t=>{t(JSON.stringify(e))}))}},{key:"getDependenceValue",value:function(e){return e.reduce(((e,t)=>(e[t]=this.externalInterface.getCellValueById(t),e)),{})}}]);function _classCallCheck$u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$t(n.key),n)}}function _createClass$u(e,t,r){return t&&_defineProperties$t(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$t(e){var t=_toPrimitive$t(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$t(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$m(e,t,r){return t=_getPrototypeOf$m(t),_possibleConstructorReturn$m(e,_isNativeReflectConstruct$m()?Reflect.construct(t,r||[],_getPrototypeOf$m(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$m(e)}function _assertThisInitialized$m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$m=function(){return!!e})()}function _getPrototypeOf$m(e){return(_getPrototypeOf$m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$m(e,t)}function _setPrototypeOf$m(e,t){return(_setPrototypeOf$m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let TextCellValueTransformer=function(e){function t(){return _classCallCheck$u(this,t),_callSuper$m(this,t,arguments)}return _inherits$m(t,NormalCellValueTransformer),_createClass$u(t,[{key:"setValue",value:function(e,t){var r;const n=null!==(r=null==t?void 0:t.cv)&&void 0!==r?r:"";e.cv=n;const{value:o,xtype:i,text:a}=transformCellCv(n);return e.xtype=i,e.value=o,e.text=a,new Promise((t=>{t(JSON.stringify(e))}))}}])}();function _classCallCheck$t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$s(n.key),n)}}function _createClass$t(e,t,r){return t&&_defineProperties$s(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$s(e){var t=_toPrimitive$s(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$s(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}let TableCellValueTransformerProvider=_createClass$t((function e(){_classCallCheck$t(this,e),this.cellDict=new Map([["text",TextCellValueTransformer]])}),[{key:"setValue",value:function(e,t,r,n={}){const{cv:o,cellhyperlink:i}=t,a=getCellValue(e.value)||{type:"text",value:""};if(!a)return new Promise((e=>{e(!1)}));if(BI.isNull(i)&&BI.isEqual(a.cv,o))return new Promise((e=>{e(!1)}));e.edited=!0,e.transformed=!0,e.cellstyle=e.cellstyle||{fontStyle:{color:-16777216,fontFamily:"SimSun",fontSize:12,underLine:{width:0,style:"",color:-16777216}}},e.cellhyperlink=i;const s=r.getWidgetByCell(e.position.y,e.position.x);return s&&!0!==n.soft&&s.setValue(o),new(this.cellDict.get(a.type)||NormalCellValueTransformer)(r,e).setValue(a,t).then((t=>{const n=e.value!==t;if(e.value=t,n){e.errorMsg=void 0;const t=r.getStickerManagers().get(CellCacheManager.NAME);null==t||t.addCellCache(e)}return n}))}},{key:"set",value:function(e,t){this.cellDict.set(e,t)}}]);const tableCellValueTransformerProvider=new TableCellValueTransformerProvider;function _classCallCheck$s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$r(n.key),n)}}function _createClass$s(e,t,r){return t&&_defineProperties$r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$r(e){var t=_toPrimitive$r(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$r(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$l(e,t,r){return t=_getPrototypeOf$l(t),_possibleConstructorReturn$l(e,_isNativeReflectConstruct$l()?Reflect.construct(t,r||[],_getPrototypeOf$l(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$l(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$l(e)}function _assertThisInitialized$l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$l=function(){return!!e})()}function _getPrototypeOf$l(e){return(_getPrototypeOf$l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$l(e,t)}function _setPrototypeOf$l(e,t){return(_setPrototypeOf$l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let CellSetValueHandler=function(e){function t(){var e;return _classCallCheck$s(this,t),(e=_callSuper$l(this,t,arguments)).eventNames=["CELL_SET_VALUE"],e.name="CELL_SET_VALUE",e.merger="uniqe",e}return _inherits$l(t,AbstractCellHandler),_createClass$s(t,[{key:"action",value:async function({value:e,x:t,y:r}){const n=this.externalContext.getTableData()[r][t];if(!n)return!1;return await tableCellValueTransformerProvider.setValue(n,{cv:null!=e?e:"",cellhyperlink:n.cellhyperlink},this.externalContext)&&this.externalContext.populate(this.tableData),!0}}])}();function _classCallCheck$r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$q(n.key),n)}}function _createClass$r(e,t,r){return t&&_defineProperties$q(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$q(e){var t=_toPrimitive$q(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$q(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$k(e,t,r){return t=_getPrototypeOf$k(t),_possibleConstructorReturn$k(e,_isNativeReflectConstruct$k()?Reflect.construct(t,r||[],_getPrototypeOf$k(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$k(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$k(e)}function _assertThisInitialized$k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$k(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$k=function(){return!!e})()}function _getPrototypeOf$k(e){return(_getPrototypeOf$k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$k(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$k(e,t)}function _setPrototypeOf$k(e,t){return(_setPrototypeOf$k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let CellSelectHandler=function(e){function t(){var e;return _classCallCheck$r(this,t),(e=_callSuper$k(this,t,arguments)).eventNames=["CELL_CLICK","CELL_DOUBLE_CLICK"],e.name="CELL_SELECT",e.merger="uniqe",e}return _inherits$k(t,AbstractCellHandler),_createClass$r(t,[{key:"action",value:async function({id:e,cell:t}){const{position:r}=t,n=r.y,o=r.x;this.externalContext.setSelectCell({row:n,col:o,text:"".concat(getCellTextByCell(this.externalContext.getCellById(e))),cell:t});const i=this.externalContext.getStickerManagers().get(CellControllerManager.NAME);i&&(i.initializeWidget(e),i.mountWidget(e),i.getWidgetsMap().forEach(((t,r)=>{t.setSeleted(r===e)})))}}])}();function _classCallCheck$q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$p(n.key),n)}}function _createClass$q(e,t,r){return t&&_defineProperties$p(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$p(e){var t=_toPrimitive$p(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$p(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$j(e,t,r){return t=_getPrototypeOf$j(t),_possibleConstructorReturn$j(e,_isNativeReflectConstruct$j()?Reflect.construct(t,r||[],_getPrototypeOf$j(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$j(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$j(e)}function _assertThisInitialized$j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$j(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$j=function(){return!!e})()}function _getPrototypeOf$j(e){return(_getPrototypeOf$j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$j(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$j(e,t)}function _setPrototypeOf$j(e,t){return(_setPrototypeOf$j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let CellInitializeWidgetHoverHandler=function(e){function t(){var e;return _classCallCheck$q(this,t),(e=_callSuper$j(this,t,arguments)).eventNames=["CELL_HOVER"],e.merger="uniqe",e.name="EVENT_INITIALIZE_WIDGET",e}return _inherits$j(t,AbstractCellHandler),_createClass$q(t,[{key:"action",value:function({id:e}){const t=this.externalContext.getStickerManagers().get(CellControllerManager.NAME);null==t||t.initializeWidget(e),null==t||t.mountWidget(e)}}])}();function _classCallCheck$p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$o(n.key),n)}}function _createClass$p(e,t,r){return t&&_defineProperties$o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$o(e){var t=_toPrimitive$o(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$o(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$i(e,t,r){return t=_getPrototypeOf$i(t),_possibleConstructorReturn$i(e,_isNativeReflectConstruct$i()?Reflect.construct(t,r||[],_getPrototypeOf$i(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$i(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$i(e)}function _assertThisInitialized$i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$i(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$i=function(){return!!e})()}function _getPrototypeOf$i(e){return(_getPrototypeOf$i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$i(e,t)}function _setPrototypeOf$i(e,t){return(_setPrototypeOf$i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let CellSetStyleHandler=function(e){function t(){var e;return _classCallCheck$p(this,t),(e=_callSuper$i(this,t,arguments)).eventNames=["CELL_SET_STYLE"],e.name="CELL_SET_STYLE",e.merger="covered",e}return _inherits$i(t,AbstractCellHandler),_createClass$p(t,[{key:"action",value:function(e){var t;const{x:r,y:n,style:o={}}=e,i=this.transformStyle2CellStyle(o),a=this.tableData;BI.isNull(r)||BI.isNull(n)?BI.isNull(r)?a[n].forEach((e=>{BI.deepExtend(e.cellstyle,i)})):a.forEach((e=>{var t;BI.deepExtend(null===(t=e.find((e=>e.position.x===r)))||void 0===t?void 0:t.cellstyle,i)})):BI.deepExtend(null===(t=a[n].find((e=>e.position.x===r)))||void 0===t?void 0:t.cellstyle,i),this.externalContext.populate(a)}},{key:"transformStyle2CellStyle",value:function(e){return{cellBackground:{background:this.transformBackground(e)},borderStyle:this.transformBorderStyle(e),fontStyle:this.transFormFontStyle(e),contentStyle:this.transformContentStyle(e)}}},{key:"transFormFontStyle",value:function(e){const{fontWeight:t="normal",fontStyle:r="normal",fontFamily:n="",fontSize:o=12,color:i="#000",textDecorationColor:a="",textDecorationLine:s="",textDecorationStyle:l="",textDecorationThickness:c=0,textShadow:u}=e,d=(null==u?void 0:u.split(" "))||[];return{bold:t,italic:r,fontFamily:n,strikeThrough:-1!==s.indexOf("line-through"),fontSize:this.getIntValue(o),color:i,underLine:{width:-1!==s.indexOf("underline")?this.getIntValue(c):0,style:l,color:a},textShadow:{shadowBlur:this.getIntValue(d[2]),shadowColor:d[3]||"black",shadowOffsetX:this.getIntValue(d[0]),shadowOffsetY:this.getIntValue(d[1])}}}},{key:"transformContentStyle",value:function(e){const{padding:t,paddingBottom:r,paddingLeft:n,paddingRight:o,paddingTop:i,lineHeight:a=0,verticalAlign:s="",textAlign:l="",whiteSpace:c=""}=e,u=(null==t?void 0:t.split(" "))||[];return{paddingLeft:this.getIntValue(n||u[3]),paddingRight:this.getIntValue(o||u[1]),spacingAfter:this.getIntValue(r||u[2]),spacingBefore:this.getIntValue(i||u[0]),lineHeight:a,verticalAlign:s,textAlign:l,newLine:c}}},{key:"transformBackground",value:function(e){const{backgroundColor:t,backgroundImage:r,backgroundRepeat:n}=e;return Object.assign(Object.assign(Object.assign({},BI.isNull(r)?{}:this.transformBackgroundImage(r)),BI.isNull(t)?{}:{backgroundType:"ColorBackground",color:t}),{layout:n})}},{key:"transformBackgroundImage",value:function(e){const t={},r=this.transformRgb2Color(e),n=r.match(/url\((.+?)\)/g),o=r.match(/linear-gradient\((.+?)\)/g);if(BI.isNull(n)){if(!BI.isNull(o)){const e=o[0].replace(/"|'|linear-gradient|\(|\)/g,"").split(",");t.backgroundType="GradientBackground";const r=BI.size(e);t.direction=BI.size(e[0].match(/left|right/g))?0:1,t.startColor=e[r-2],t.endColor=e[r-1]}}else t.imgUrl=n[0].replace(/"|'|url|\(|\)/g,""),t.backgroundType="ImageBackground";return t}},{key:"transformBorderStyle",value:function(e){const{border:t=DEFAULT_BORDER,borderTop:r,borderBottom:n,borderLeft:o,borderRight:i}=e,a=this.transformCssBorder2XBorder(t),s=e=>BI.isNull(e)?a:this.transformCssBorder2XBorder(e);return{topBorder:s(r),bottomBorder:s(n),leftBorder:s(o),rightBorder:s(i)}}},{key:"getIntValue",value:function(e=0){return parseInt(e.toString(),10)}},{key:"transformCssBorder2XBorder",value:function(e){const t=e.split(" ");return{width:this.getIntValue(t[0]),style:t[1]||"solid",color:t[2]||-1}}},{key:"transformRgb2Color",value:function(e){var t;let r=e;return null===(t=e.match(/rgb\((.+?)\)/g))||void 0===t||t.forEach((e=>{r=r.replace(e,transformColor(e))})),r}}])}();function _classCallCheck$o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$n(n.key),n)}}function _createClass$o(e,t,r){return t&&_defineProperties$n(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$n(e){var t=_toPrimitive$n(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$n(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$h(e,t,r){return t=_getPrototypeOf$h(t),_possibleConstructorReturn$h(e,_isNativeReflectConstruct$h()?Reflect.construct(t,r||[],_getPrototypeOf$h(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$h(e)}function _assertThisInitialized$h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$h=function(){return!!e})()}function _getPrototypeOf$h(e){return(_getPrototypeOf$h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$h(e,t)}function _setPrototypeOf$h(e,t){return(_setPrototypeOf$h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var DirectionRadius,DirectionRadius2;DirectionRadius2=DirectionRadius||(DirectionRadius={}),DirectionRadius2.TL="tlRadius",DirectionRadius2.TR="trRadius",DirectionRadius2.BR="brRadius",DirectionRadius2.BL="blRadius";let CellSetRadiusHandler=function(e){function t(){var e;return _classCallCheck$o(this,t),(e=_callSuper$h(this,t,arguments)).eventNames=["CELL_SET_RADIUS"],e.name="CELL_SET_RADIUS",e.merger="uniqe",e}return _inherits$h(t,AbstractCellHandler),_createClass$o(t,[{key:"action",value:function({radius:e,range:t={},single:r}){const n=this.tableData,{row:o=[],column:i=[],cell:a=[]}=t;let[s=1,l=Number.MAX_VALUE]=o,[c=1,u=Number.MAX_VALUE]=i;if(BI.size(a)&&(s=l=a[0]||1,c=u=a[1]||1),r)n.forEach(((t,r)=>{r>=s-1&&r<l&&t.forEach(((t,r)=>{r>=c-1&&r<u&&this.setCellRadius(t,e)}))}));else{const t=BI.size(n),r=n.reduce(((e,t)=>Math.max(e,BI.size(t))),0),o=Math.min(l-1,t-1),i=Math.min(u-1,r-1),a=Math.max(s-1,0),d=Math.max(c-1,0);this.setCellRadius(n[a][d],e,DirectionRadius.TL),this.setCellRadius(n[a][i],e,DirectionRadius.TR),this.setCellRadius(n[o][d],e,DirectionRadius.BL),this.setCellRadius(n[o][i],e,DirectionRadius.BR)}this.externalContext.populate(n)}},{key:"setCellRadius",value:function(e,t,r){var n,o;const{sourceCellPosition:i}=e,a=BI.isNull(i)?e:this.tableData[i.y][i.x],s=(null===(o=null===(n=a.cellstyle)||void 0===n?void 0:n.cellBackground)||void 0===o?void 0:o.background.radiusConfig)||{},l=Object.assign({radius:t,tlRadius:!r,trRadius:!r,blRadius:!r,brRadius:!r},s);BI.deepExtend(a,{cellstyle:{cellBackground:{background:{radiusConfig:r?Object.assign(Object.assign({},l),{[r]:!0}):l}}}})}}])}();function _classCallCheck$n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$m(n.key),n)}}function _createClass$n(e,t,r){return t&&_defineProperties$m(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$m(e){var t=_toPrimitive$m(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$m(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$g(e,t,r){return t=_getPrototypeOf$g(t),_possibleConstructorReturn$g(e,_isNativeReflectConstruct$g()?Reflect.construct(t,r||[],_getPrototypeOf$g(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$g(e)}function _assertThisInitialized$g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$g=function(){return!!e})()}function _getPrototypeOf$g(e){return(_getPrototypeOf$g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$g(e,t)}function _setPrototypeOf$g(e,t){return(_setPrototypeOf$g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let CellSetSizeHandler=function(e){function t(){var e;return _classCallCheck$n(this,t),(e=_callSuper$g(this,t,arguments)).eventNames=["CELL_SET_SIZE"],e.name="CELL_SET_SIZE",e.merger="uniqe",e}return _inherits$g(t,AbstractCellHandler),_createClass$n(t,[{key:"action",value:function({x:e,y:t,width:r,height:n}){const o=this.tableData;BI.isNull(e)&&BI.isNull(t)||(BI.isNull(r)||o.forEach((t=>{t[e].celldimension.width=r})),BI.isNull(n)||o[t].forEach((e=>{e.celldimension.height=n})),this.externalContext.populate(o))}}])}();function _classCallCheck$m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$l(n.key),n)}}function _createClass$m(e,t,r){return t&&_defineProperties$l(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$l(e){var t=_toPrimitive$l(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$l(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$f(e,t,r){return t=_getPrototypeOf$f(t),_possibleConstructorReturn$f(e,_isNativeReflectConstruct$f()?Reflect.construct(t,r||[],_getPrototypeOf$f(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$f(e)}function _assertThisInitialized$f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$f=function(){return!!e})()}function _getPrototypeOf$f(e){return(_getPrototypeOf$f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$f(e,t)}function _setPrototypeOf$f(e,t){return(_setPrototypeOf$f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let BatchUpdateTableAttrHandler=function(e){function t(){var e;return _classCallCheck$m(this,t),(e=_callSuper$f(this,t,arguments)).eventNames=["BATCH_UPDATE_TABLE_ATTR"],e.name="BATCH_UPDATE_TABLE_ATTR",e.merger="uniqe",e}return _inherits$f(t,AbstractCellHandler),_createClass$m(t,[{key:"action",value:function({cellPositions:e=[],callback:t}){const r=[];let n=0;BI.each(this.tableData,((e,t)=>{if(!BI.isUndefined(t[0].id)){r.findIndex((e=>e[0].id===t[0].id))>=0?n++:r.push(t)}})),BI.isArray(e)&&!BI.isEmpty(e)&&BI.isFunction(t)&&(e.forEach((e=>{const{x:r,y:o}=e,i=o+n,a=this.tableData[i]&&this.tableData[i][r];if(a){const e=getCellValue(a.value),n=e?this.getChartIDByValue(e):void 0;this.tableData[i][r]=Object.assign(Object.assign({},a),t({cell:BI.deepClone(a),value:e,chartID:n})||{})}})),this.externalContext.populate(this.tableData))}},{key:"getChartIDByValue",value:function(e){if(DEFAULT_TABLE_CELL_TYPE.SIMPLE_CHART===e.type)return e.items?e.items[0].simpleChartInShowID:void 0}}])}();function _classCallCheck$l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$k(n.key),n)}}function _createClass$l(e,t,r){return t&&_defineProperties$k(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$k(e){var t=_toPrimitive$k(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$k(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}let TableClickHandlerProvider=_createClass$l((function e(){_classCallCheck$l(this,e),this.listeners=[HyperLinkCellClickHandler,WidgetInactiveHandler,WidgetActiveHandler,CellSetValueHandler,CellSelectHandler,CellInitializeWidgetHoverHandler,CellSetStyleHandler,CellSetRadiusHandler,CellSetSizeHandler,BatchUpdateTableAttrHandler]}),[{key:"add",value:function(e){this.listeners.push(e)}},{key:"get",value:function(){return this.listeners}}]);const tableClickHandlerProvider=new TableClickHandlerProvider;function _classCallCheck$k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$j(n.key),n)}}function _createClass$k(e,t,r){return t&&_defineProperties$j(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$j(e){var t=_toPrimitive$j(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$j(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}let TableCellGenerator=_createClass$k((function e(t){_classCallCheck$k(this,e),this.externalInterface=t,this.listeners=transformHandlers2Listeners(tableClickHandlerProvider.get().map((e=>new e(t))))}),[{key:"addHandler",value:function(e,...t){const r=new e(this.externalInterface,...t);switch(r.merger){case"uniqe":this.listeners.find((e=>e.name===r.name))||this.listeners.push(...transformHandlers2Listeners([r]));break;case"covered":for(let e=this.listeners.length-1;e>=0;e--)this.listeners[e].name===r.name&&this.listeners.splice(e,1);this.listeners.push(...transformHandlers2Listeners([r]));break;default:this.listeners.push(...transformHandlers2Listeners([r]))}}},{key:"generate",value:function(e){const{cell:t,style:r,cellhyperlink:n,celladvancedattr:o,sortHeader:i,widget:a}=e;return tableCellProvider.get({cell:t,style:r,celladvancedattr:o,sortHeader:i,hyperLinks:this.getHyperLinks(n),listeners:this.listeners,widget:a},this.externalInterface)}},{key:"getHyperLinks",value:function(e){var t;const r=(null===(t=null==e?void 0:e.nxNameJavascriptGroup)||void 0===t?void 0:t.javaScriptGroup)||[];return instantiateMergedXHyperLinks(this.externalInterface.getLinkConfig(),r,Object.assign(Object.assign({},this.externalInterface.getExternals()),{getWidgetName:()=>this.externalInterface.getWidgetName(),managersGetter:()=>this.externalInterface.getStickerManagers()}))}},{key:"getListenerByName",value:function(e){return this.listeners.find((t=>t.name===e))}}]);function transformHandlers2Listeners(e){return e.reduce(((e,t)=>e.concat(t.eventNames.map((e=>({eventName:e,name:t.name,action:e=>t.action(e)}))))),[])}var __rest$1=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};const fontScaleAttributeName="data-font-scale";function resizeStickerExtension(e,t){const r=__rest$1(t,["el"]);return Object.assign({el:t.initialEl.replaceAll(/font-size:\s*[0-9.]+/,(t=>t.replaceAll(/[0-9.]+/,(t=>parseFloat(t)*e)))).replaceAll(new RegExp("".concat(fontScaleAttributeName,'=\\s*"[0-9.]+')),(t=>t.replaceAll(/[0-9.]+/,(()=>e))))},r)}function removeColsAdjust(e){return e[e.length-1]=0,e[e.length-2]=0,e[0]=0,e}function removeRowsAdjust(e){return e[0]=0,e[e.length-3]=0,e[e.length-2]=0,e[e.length-1]=0,e}function adjustSizeByRate(e,t){let r=0;return e.map((e=>{const n=e*t+r,o=Math.round(n);return r=n-o,o}))}function resize(e,t=[],r=1){return adjustSize(e,adjustSizeByRate(t,r))}function resizeFont(e,t=0,r){r&&BI.each(r,((r,n)=>{BI.each(n,((r,n)=>{var o;(null===(o=null==n?void 0:n.style)||void 0===o?void 0:o.defaultFontSize)&&(n.style.fontSize=getResizedFontSize(n.style.defaultFontSize,e,t)),BI.each(BI.get(n,"items"),((r,n)=>{var o;if(null===(o=null==n?void 0:n.el)||void 0===o?void 0:o.style){const r=n.el.style.lineHeight;n.el.style.lineHeight=getResizedLineHeight(n.el.style.defaultLineHeight,e),n.el.style.fontSize=getResizedFontSize(n.el.style.defaultFontSize,e,t),n.left*=n.el.style.lineHeight/r,n.right*=n.el.style.lineHeight/r}}))}))}))}function getResizedFontSize(e,t,r){const n=parseInt(e,10)*t;return"".concat(Math.max(n,r),"px")}function getResizedLineHeight(e,t){return"".concat(t*parseInt(e,10))}function adjustSize(e,t=[]){const r=t.reduce(((e,t)=>e+t)),n=t.findIndex((e=>!!e));if(r>=e){r-e>2?t[t.length-1]=1:t[n]=t[n]-(r-e||1)}return t}function _classCallCheck$j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$i(n.key),n)}}function _createClass$j(e,t,r){return t&&_defineProperties$i(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$i(e){var t=_toPrimitive$i(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$i(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}let AbstractResizer=_createClass$j((function e(t={}){_classCallCheck$j(this,e),this.isAdaptive=!0,this.minResizeScale=.4,this.widthResizeScale=1,this.heightResizeScale=1;const{minFontSize:r=8}=t;this.minFontSize=r}),[{key:"resizeWidth",value:function(e,t=document.body.clientWidth,r=0){let n=r;e[e.length-1]=0,e[e.length-2]=0,e[0]=0;const o=t-3,i=[...e];if(i.pop(),!r){const e=i.reduce(((e,t)=>e+t));n=Math.max(o/e,this.minResizeScale)}for(let a=0;a<i.length;a++)e[a]*=n;return e[e.length-1]=1,e[0]=1,n}},{key:"resizeHeight",value:function(e,t,r=0){let n=r;e[0]=0,e[e.length-3]=0,e[e.length-2]=0,e[e.length-1]=0;const o=[...e];if(o.pop(),!r){const e=t-2,r=o.reduce(((e,t)=>e+t));n=Math.max(e/r,this.minResizeScale)}for(let i=0;i<o.length;i++)e[i]*=n;return e[e.length-1]=1,n}},{key:"resizeFont",value:function(e,t){t&&BI.each(t,((t,r)=>{BI.each(r,((t,r)=>{BI.each(BI.get(r,"items"),((t,r)=>{if(r&&r.el&&r.el.style){const t=parseInt(r.el.style.defaultFontSize,10),n=Math.max(t*e,this.minFontSize);r.el.style.lineHeight=r.el.style.defaultLineHeight*n/t,r.el.style.fontSize="".concat(n,"px")}}))}))}))}},{key:"resizeSticker",value:function(e,t){(t.stickers||[]).forEach((t=>{t.el=t.extension?this.expandHtml(resizeStickerExtension(e,t.extension).el,t.extension.style,e).el:t.el}))}},{key:"expandHtml",value:function(e,t,r){return BI.isNotNull(t)?expandHtml(e,Object.assign(Object.assign({},t),{lineHeight:t.lineHeight*r,paddingLeft:t.paddingLeft*this.widthResizeScale,paddingRight:t.paddingRight*this.widthResizeScale,spacingAfter:t.spacingAfter*this.heightResizeScale,spacingBefore:t.spacingBefore*this.heightResizeScale}),r):{el:e,style:t,initial:e}}},{key:"resizeFontByFontScaleAttr",value:function(e){Array.from(e.find("*[".concat(fontScaleAttributeName,"]"))).forEach((e=>{const t=window.getComputedStyle(e,null).getPropertyValue("font-size"),r=e.getAttribute(fontScaleAttributeName);e.style.fontSize="calc(".concat(r," * ").concat(t,")")}))}}]);function _classCallCheck$i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$h(n.key),n)}}function _createClass$i(e,t,r){return t&&_defineProperties$h(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$h(e){var t=_toPrimitive$h(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$h(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$e(e,t,r){return t=_getPrototypeOf$e(t),_possibleConstructorReturn$e(e,_isNativeReflectConstruct$e()?Reflect.construct(t,r||[],_getPrototypeOf$e(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$e(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$e(e)}function _assertThisInitialized$e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$e(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$e=function(){return!!e})()}function _getPrototypeOf$e(e){return(_getPrototypeOf$e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$e(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$e(e,t)}function _setPrototypeOf$e(e,t){return(_setPrototypeOf$e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let FullPaperResizer=function(e){function t(){return _classCallCheck$i(this,t),_callSuper$e(this,t,arguments)}return _inherits$e(t,AbstractResizer),_createClass$i(t,[{key:"resize",value:function(e,t){var r;const{tableWidth:n,paperWidth:o,tableHeight:i,paperHeight:a,fitAttr:{fitFont:s,minFontSize:l,fontScaleGetter:c}}=t;if(this.widthResizeScale=n/o,this.heightResizeScale=i/a,e.sheet.cols=resize(n,removeColsAdjust(e.sheet.initialCols||[]),this.widthResizeScale),e.sheet.rows=resize(i,removeRowsAdjust(e.sheet.initialRows||[]),this.heightResizeScale),s){const t=null!==(r=null==c?void 0:c())&&void 0!==r?r:Math.min(this.widthResizeScale,this.heightResizeScale);resizeFont(t,l,e.sheet.data),this.resizeSticker(t,e.sheet)}return e}}])}();function _classCallCheck$h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$g(n.key),n)}}function _createClass$h(e,t,r){return t&&_defineProperties$g(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$g(e){var t=_toPrimitive$g(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$g(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$d(e,t,r){return t=_getPrototypeOf$d(t),_possibleConstructorReturn$d(e,_isNativeReflectConstruct$d()?Reflect.construct(t,r||[],_getPrototypeOf$d(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$d(e)}function _assertThisInitialized$d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$d(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$d=function(){return!!e})()}function _getPrototypeOf$d(e){return(_getPrototypeOf$d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$d(e,t)}function _setPrototypeOf$d(e,t){return(_setPrototypeOf$d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let FullTableResizer=function(e){function t(){return _classCallCheck$h(this,t),_callSuper$d(this,t,arguments)}return _inherits$d(t,AbstractResizer),_createClass$h(t,[{key:"resize",value:function(e,t){const{tableWidth:r,tableHeight:n,fitAttr:{fitFont:o,minFontSize:i}}=t,a=removeColsAdjust(e.sheet.initialCols||[]),s=removeRowsAdjust(e.sheet.initialRows||[]);if(this.widthResizeScale=(r-1)/a.reduce(((e,t)=>e+t)),this.heightResizeScale=(n-1)/s.reduce(((e,t)=>e+t)),e.sheet.cols=resize(r,a,this.widthResizeScale),e.sheet.rows=resize(n,s,this.heightResizeScale),o){const t=Math.min(this.widthResizeScale,this.heightResizeScale);resizeFont(t,i,e.sheet.data),this.resizeSticker(t,e.sheet)}return e}}])}();function _classCallCheck$g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$f(n.key),n)}}function _createClass$g(e,t,r){return t&&_defineProperties$f(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$f(e){var t=_toPrimitive$f(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$f(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$c(e,t,r){return t=_getPrototypeOf$c(t),_possibleConstructorReturn$c(e,_isNativeReflectConstruct$c()?Reflect.construct(t,r||[],_getPrototypeOf$c(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$c(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$c(e)}function _assertThisInitialized$c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$c(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$c=function(){return!!e})()}function _getPrototypeOf$c(e){return(_getPrototypeOf$c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$c(e,t)}function _setPrototypeOf$c(e,t){return(_setPrototypeOf$c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let FullTableLimitResizer=function(e){function t(){return _classCallCheck$g(this,t),_callSuper$c(this,t,arguments)}return _inherits$c(t,AbstractResizer),_createClass$g(t,[{key:"resize",value:function(e,t){const{tableWidth:r,tableHeight:n,hasFrozen:o=!1,fitAttr:{fitFont:i},paperWidth:a}=t;e.sheet.cols=(e.sheet.initialCols||e.sheet.cols||[]).slice(0),this.widthResizeScale=this.resizeWidth(e.sheet.cols||[],r);const s=o?1:0;if(e.sheet.rows=(e.sheet.initialRows||e.sheet.rows||[]).slice(0),this.heightResizeScale=this.resizeHeight(e.sheet.rows||[],n,s),i){const t=r/a;this.resizeFont(t,e.sheet.data),this.resizeSticker(t,e.sheet)}return e}}])}();function _classCallCheck$f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$e(n.key),n)}}function _createClass$f(e,t,r){return t&&_defineProperties$e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$e(e){var t=_toPrimitive$e(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$e(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$b(e,t,r){return t=_getPrototypeOf$b(t),_possibleConstructorReturn$b(e,_isNativeReflectConstruct$b()?Reflect.construct(t,r||[],_getPrototypeOf$b(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$b(e)}function _assertThisInitialized$b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$b=function(){return!!e})()}function _getPrototypeOf$b(e){return(_getPrototypeOf$b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$b(e,t)}function _setPrototypeOf$b(e,t){return(_setPrototypeOf$b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let HorizontalPaperResizer=function(e){function t(){return _classCallCheck$f(this,t),_callSuper$b(this,t,arguments)}return _inherits$b(t,AbstractResizer),_createClass$f(t,[{key:"resize",value:function(e,t){var r;const{tableWidth:n,tableHeight:o,paperWidth:i,fitAttr:{fitFont:a,minFontSize:s,fontScaleGetter:l}}=t;if(this.widthResizeScale=n/i,this.heightResizeScale=this.widthResizeScale,e.sheet.cols=resize(n,removeColsAdjust(e.sheet.initialCols||[]),this.widthResizeScale),e.sheet.rows=resize(o,removeRowsAdjust(e.sheet.initialRows||[]),this.heightResizeScale),a){const t=null!==(r=null==l?void 0:l())&&void 0!==r?r:Math.min(this.widthResizeScale,this.heightResizeScale);resizeFont(t,s,e.sheet.data),this.resizeSticker(t,e.sheet)}return e}}])}();function _classCallCheck$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$d(n.key),n)}}function _createClass$e(e,t,r){return t&&_defineProperties$d(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$d(e){var t=_toPrimitive$d(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$d(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$a(e,t,r){return t=_getPrototypeOf$a(t),_possibleConstructorReturn$a(e,_isNativeReflectConstruct$a()?Reflect.construct(t,r||[],_getPrototypeOf$a(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$a(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$a(e)}function _assertThisInitialized$a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$a=function(){return!!e})()}function _getPrototypeOf$a(e){return(_getPrototypeOf$a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$a(e,t)}function _setPrototypeOf$a(e,t){return(_setPrototypeOf$a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let HorizontalTableResizer=function(e){function t(){return _classCallCheck$e(this,t),_callSuper$a(this,t,arguments)}return _inherits$a(t,AbstractResizer),_createClass$e(t,[{key:"resize",value:function(e,t){const{tableWidth:r,tableHeight:n,fitAttr:{fitFont:o,minFontSize:i}}=t,a=removeColsAdjust(e.sheet.initialCols||[]),s=removeRowsAdjust(e.sheet.initialRows||[]);return this.widthResizeScale=(r-1)/a.reduce(((e,t)=>e+t)),this.heightResizeScale=this.widthResizeScale,e.sheet.cols=resize(r,a,this.widthResizeScale),e.sheet.rows=resize(n,s,this.heightResizeScale),o&&(resizeFont(this.widthResizeScale,i,e.sheet.data),this.resizeSticker(this.widthResizeScale,e.sheet)),e}}])}();function _classCallCheck$d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$c(n.key),n)}}function _createClass$d(e,t,r){return t&&_defineProperties$c(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$c(e){var t=_toPrimitive$c(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$c(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$9(e,t,r){return t=_getPrototypeOf$9(t),_possibleConstructorReturn$9(e,_isNativeReflectConstruct$9()?Reflect.construct(t,r||[],_getPrototypeOf$9(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$9(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$9(e)}function _assertThisInitialized$9(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$9(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$9=function(){return!!e})()}function _getPrototypeOf$9(e){return(_getPrototypeOf$9=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$9(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$9(e,t)}function _setPrototypeOf$9(e,t){return(_setPrototypeOf$9=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let HorizontalTableLimitResizer=function(e){function t(){return _classCallCheck$d(this,t),_callSuper$9(this,t,arguments)}return _inherits$9(t,AbstractResizer),_createClass$d(t,[{key:"resize",value:function(e,t){const{tableWidth:r,tableHeight:n,hasFrozen:o=!1,fitAttr:{fitFont:i},paperWidth:a}=t;if(e.sheet.rows=(e.sheet.initialRows||e.sheet.rows||[]).slice(0),e.sheet.cols=(e.sheet.initialCols||e.sheet.cols||[]).slice(0),this.widthResizeScale=this.resizeWidth(e.sheet.cols||[],r),this.heightResizeScale=o?1:this.widthResizeScale,this.resizeHeight(e.sheet.rows||[],n,this.heightResizeScale),i){const t=r/a;this.resizeFont(r/a,e.sheet.data),this.resizeSticker(t,e.sheet)}return e}}])}();function _classCallCheck$c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$b(n.key),n)}}function _createClass$c(e,t,r){return t&&_defineProperties$b(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$b(e){var t=_toPrimitive$b(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$b(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$8(e,t,r){return t=_getPrototypeOf$8(t),_possibleConstructorReturn$8(e,_isNativeReflectConstruct$8()?Reflect.construct(t,r||[],_getPrototypeOf$8(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$8(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$8(e)}function _assertThisInitialized$8(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$8=function(){return!!e})()}function _getPrototypeOf$8(e){return(_getPrototypeOf$8=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$8(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$8(e,t)}function _setPrototypeOf$8(e,t){return(_setPrototypeOf$8=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let NoneResizer=function(e){function t(){var e;return _classCallCheck$c(this,t),(e=_callSuper$8(this,t,arguments)).isAdaptive=!1,e}return _inherits$8(t,AbstractResizer),_createClass$c(t,[{key:"resize",value:function(e,t){return e}}])}();function _classCallCheck$b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$a(n.key),n)}}function _createClass$b(e,t,r){return t&&_defineProperties$a(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$a(e){var t=_toPrimitive$a(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$a(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$7(e,t,r){return t=_getPrototypeOf$7(t),_possibleConstructorReturn$7(e,_isNativeReflectConstruct$7()?Reflect.construct(t,r||[],_getPrototypeOf$7(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$7(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$7(e)}function _assertThisInitialized$7(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$7(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$7=function(){return!!e})()}function _getPrototypeOf$7(e){return(_getPrototypeOf$7=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$7(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$7(e,t)}function _setPrototypeOf$7(e,t){return(_setPrototypeOf$7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let NoneTableResizer=function(e){function t(){var e;return _classCallCheck$b(this,t),(e=_callSuper$7(this,t,arguments)).isAdaptive=!1,e}return _inherits$7(t,AbstractResizer),_createClass$b(t,[{key:"resize",value:function(e,t){const{tableWidth:r,tableHeight:n}=t,{rows:o=[],cols:i=[]}=e.sheet;return adjustSize(n,removeRowsAdjust(o)),adjustSize(r,removeColsAdjust(i)),e}}])}();function _classCallCheck$a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$9(n.key),n)}}function _createClass$a(e,t,r){return t&&_defineProperties$9(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$9(e){var t=_toPrimitive$9(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$9(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$6(e,t,r){return t=_getPrototypeOf$6(t),_possibleConstructorReturn$6(e,_isNativeReflectConstruct$6()?Reflect.construct(t,r||[],_getPrototypeOf$6(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$6(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$6(e)}function _assertThisInitialized$6(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$6(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$6=function(){return!!e})()}function _getPrototypeOf$6(e){return(_getPrototypeOf$6=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$6(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$6(e,t)}function _setPrototypeOf$6(e,t){return(_setPrototypeOf$6=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let VerticalTableResizer=function(e){function t(){return _classCallCheck$a(this,t),_callSuper$6(this,t,arguments)}return _inherits$6(t,AbstractResizer),_createClass$a(t,[{key:"resize",value:function(e,t){var r;const{tableWidth:n,tableHeight:o,fitAttr:{fitFont:i,minFontSize:a,fontScaleGetter:s}}=t,l=removeRowsAdjust(e.sheet.initialRows||[]),c=removeColsAdjust(e.sheet.initialCols||[]);if(this.heightResizeScale=(o-1)/l.reduce(((e,t)=>e+t)),this.widthResizeScale=this.heightResizeScale,e.sheet.rows=resize(o,l,this.heightResizeScale),e.sheet.cols=resize(n,c,this.widthResizeScale),i){const t=null!==(r=null==s?void 0:s())&&void 0!==r?r:Math.min(this.widthResizeScale,this.heightResizeScale);resizeFont(t,a,e.sheet.data),this.resizeSticker(t,e.sheet)}return e}}])}();function _classCallCheck$9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$8(n.key),n)}}function _createClass$9(e,t,r){return t&&_defineProperties$8(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$8(e){var t=_toPrimitive$8(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$8(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var __decorate$2=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let ReportTableResizerProvider=_createClass$9((function e(){_classCallCheck$9(this,e),this.resizeModes=new Map([[0,HorizontalPaperResizer],[1,HorizontalPaperResizer],[2,FullPaperResizer],[3,NoneTableResizer],[4,HorizontalTableResizer],[5,FullTableResizer],[6,VerticalTableResizer],[-1,HorizontalTableLimitResizer],[-2,FullTableLimitResizer],[-3,NoneResizer]]),this.currentResizeMode=0}),[{key:"$get",value:function(){const e=this;return _createClass$9((function e(){_classCallCheck$9(this,e)}),[{key:"setResizer",value:function(t,r){e.resizeModes.set(t,r)}},{key:"getResizer",value:function(t,r){return new(e.resizeModes.get(t)||NoneResizer)(r)}},{key:"setResizeMode",value:function(t){e.currentResizeMode=t}},{key:"getResizeMode",value:function(){return e.currentResizeMode}}])}},{key:"addResizer",value:function(e,t){const r=BI.inherit(NoneResizer,t);this.resizeModes.set(e,r)}}]);ReportTableResizerProvider.xtype="report.table_resizer.provider",ReportTableResizerProvider=__decorate$2([provider()],ReportTableResizerProvider);const resizerProvider=BI.Providers.getProvider(ReportTableResizerProvider.xtype);function _classCallCheck$8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$7(n.key),n)}}function _createClass$8(e,t,r){return t&&_defineProperties$7(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$7(e){var t=_toPrimitive$7(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$7(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$5(e,t,r){return t=_getPrototypeOf$5(t),_possibleConstructorReturn$5(e,_isNativeReflectConstruct$5()?Reflect.construct(t,r||[],_getPrototypeOf$5(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$5(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$5(e)}function _assertThisInitialized$5(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$5(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$5=function(){return!!e})()}function _getPrototypeOf$5(e){return(_getPrototypeOf$5=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$5(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$5(e,t)}function _setPrototypeOf$5(e,t){return(_setPrototypeOf$5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __decorate$1=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__rest=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};let TableModel=function(e){function t(){var e;return _classCallCheck$8(this,t),(e=_callSuper$5(this,t,arguments)).computed={paperSetting:()=>e.model.reportSettingDetail.paperSetting||{orientation:0,paperWidth:0,paperHeight:0,marginLeft:0,marginRight:0,marginTop:0,marginBottom:0},paperBackground:()=>e.model.reportSettingDetail.background||{},footerHeight:()=>e.model.reportSettingDetail.footerHeight||0,headerHeight:()=>e.model.reportSettingDetail.headerHeight||0,headerBackground:()=>"",footerBackground:()=>"",paperWidth:()=>0===e.model.paperSetting.orientation?e.model.paperSetting.paperWidth:e.model.paperSetting.paperHeight,paperHeight:()=>0===e.model.paperSetting.orientation?e.model.paperSetting.paperHeight:e.model.paperSetting.paperWidth,resizeModel:()=>resizerProvider.getResizer(e.model.reportFitAttr.fitStateInPC,{minFontSize:e.model.reportFitAttr.minFontSize}),isAdaptiveTable:()=>e.model.reportFitAttr&&e.model.resizeModel.isAdaptive,hasFrozen:()=>hasLegalFrozen(e.model.frozen)},e.actions={setTableLoading:t=>{e.model.loading=t},setReportSetting:t=>{e.model.reportSettingDetail=t},setReportFitAttr:t=>{e.model.reportFitAttr=t},setViewAtCenter:t=>{e.model.viewAtCenter=t},setTableWidth:t=>{e.model.tableWidth=t},setTableHeight:t=>{e.model.tableHeight=t},setScreenWidth:t=>{e.model.screenWidth=t},setWebBackground:t=>{e.model.webBackground=t},setWidgetName:t=>{e.model.widgetName=t},setExternals:t=>{e.model.externals=Object.assign(Object.assign({},e.model.externals),t)},prePopulate:(t,r)=>{var n,o;e.options.tableData=e.transformTableData(r||[]);const i=r?r.slice():r;if(!i)return!1;if(!i.length)return e.setTableLoading(!1),!1;e.model.hasFrozen&&fixFreezeMerge(i,e.model.frozen);const a=i.reduce(((e,t)=>{var r,n;return(null===(r=e[0])||void 0===r?void 0:r.position.x)>(null===(n=t[0])||void 0===n?void 0:n.position.x)?t:e}));let s=(null===(n=a[0])||void 0===n?void 0:n.position.y)||0,l=(null===(o=a[0])||void 0===o?void 0:o.position.x)||0,c=i.length,u=i.reduce(((e,t)=>Math.max(e,t[t.length-1]?t[t.length-1].position.x+1:0)),0)-l;e.fixData(i,l,s,u,c),c+=5,u+=3,s-=2,l-=1;const d=BI.makeArray(c,0);return Object.assign({sheetData:[],rows:d,cols:[],stickers:[],merges:[],rowCount:c,columnCount:u,sx:l,sy:s,tableData:i},t)},getTableData:()=>e.options.simpleJson?e.transformTableData2SimpleJson(e.options.tableData):e.options.tableData||[],fixTableData:t=>{e.options.tableData=e.transformTableData(t)},completeLoadData:t=>{const{sheetData:r,cols:n,rows:o,tableData:i,stickers:a,merges:s,sx:l,sy:c,rowCount:u,columnCount:d,screenWidth:h,tableWidth:p,tableHeight:f}=t;i.forEach((t=>{e.transformTableRowData2SheetRowData({data:t,rows:o,cols:n,stickers:a,merges:s,sx:l,sy:c,sheetData:r})})),e.adjustAndLoadData({sheetData:r,cols:n,columnCount:d,rows:o,rowCount:u,stickers:a,merges:s,screenWidth:h,tableWidth:p,tableHeight:f,sx:l,sy:c})},rowChunkLoadData:t=>{const{sheetData:r,cols:n,rows:o,tableData:i,stickers:a,merges:s,sx:l,sy:c,rowCount:u,columnCount:d,screenWidth:h,tableWidth:p,tableHeight:f}=t,g=Math.floor(e.model.forceRowChunk.rowChunkSize);i.splice(0,g).forEach((t=>{e.transformTableRowData2SheetRowData({data:t,rows:o,cols:n,stickers:a,merges:s,sx:l,sy:c,sheetData:r})}));const m=BI.size(i)>0;e.adjustAndLoadData({sheetData:r,cols:n,columnCount:d,rows:o,rowCount:u,stickers:m?[]:a,merges:s,screenWidth:h,tableWidth:p,tableHeight:f,sx:l,sy:c}),m&&setTimeout((()=>{e.rowChunkLoadData({sheetData:r,cols:n,rows:o,tableData:i,stickers:a,merges:s,sx:l,sy:c,rowCount:u,columnCount:d,screenWidth:h,tableWidth:p,tableHeight:f})}),0)},splitLoadData:t=>{const{sheetData:r,cols:n,rows:o,tableData:i,stickers:a,merges:s,sx:l,sy:c,rowCount:u,columnCount:d,screenWidth:h,tableWidth:p,tableHeight:f}=t;i.forEach((t=>{e.transformTableRowData2SheetRowData({data:t,rows:o,cols:n,stickers:a,merges:s,sx:l,sy:c,sheetData:r})})),e.mergetSheetData({sheetData:r,cols:n,columnCount:d,rows:o,rowCount:u,stickers:a,merges:s,screenWidth:h,tableWidth:p,tableHeight:f,sx:l,sy:c})},resize:(t,r,n,o)=>{if(BI.isNull(e.data))return;let i=e.adaptTable(t,r);if(e.model.viewAtCenter&&e.data.sheet.cols&&!i){const t=e.data.sheet.cols.reduce(((e,t)=>e+t),e.model.paperSetting.marginLeft+e.model.paperSetting.marginRight-e.data.sheet.cols[0]-e.data.sheet.cols[e.data.sheet.cols.length-1]),r=o-t+e.model.paperSetting.marginLeft+e.model.paperSetting.marginRight;o<t||r/2<e.model.paperSetting.marginLeft||r/2<e.model.paperSetting.marginRight?(e.data.sheet.cols[0]=e.model.paperSetting.marginLeft,e.data.sheet.cols[e.data.sheet.cols.length-1]=e.model.paperSetting.marginRight):(e.data.sheet.cols[0]=r/2,e.data.sheet.cols[e.data.sheet.cols.length-1]=r/2),i=!0}i&&(e.options.loadData(e.data),e.model.resizeModel.resizeFontByFontScaleAttr(n))},addHandler:(t,r)=>{e.options.tableCellGenerator.addHandler(t,r)},setFrozen:t=>{e.model.frozen=t},setActiveBox:t=>{e.model.activeBox=t},setSelectedCell:t=>{e.model.selectedCell=t},refreshCellValues:t=>{t.forEach((t=>{const r=e.transformTableCellData2SheetCellArgs({cellData:t,sheetData:e.data.sheet.data||[],sx:e.data.sx,sy:e.data.sy});r&&r.cell&&getCellStickers(r.cell,e.options.tableStickerGenerator).forEach((n=>{if(!n)return;const o=getSticker(r.x,r.y,n,t);if(!e.data.sheet.stickers)return;const i=e.data.sheet.stickers.findIndex((e=>e.id===o.id));-1!==i&&e.data.sheet.stickers.splice(i,1,o)}))})),e.options.loadData(e.data)},setTableMergedRowsAndCols:t=>{e.model.tableMergedRowsAndCols=e.transformTableRowAndCol2MergedRowAndCol(t)},setTableCellChartLoaded:t=>{e.model.cellChartLoaded=t},transformSimpleTableData:t=>t?e.transformTableData2SimpleJson(t):[]},e}return _inherits$5(t,Model),_createClass$8(t,[{key:"state",value:function(){return{cellstyle:{},loading:!1,cellChartLoaded:!0,reportSettingDetail:this.options.reportSettingDetail,reportFitAttr:this.options.reportFitAttr,activeBox:this.options.activeBox,frozen:this.options.frozen,viewAtCenter:this.options.viewAtCenter,selectedCell:void 0,tableWidth:Math.round(this.options.tableWidth),tableHeight:Math.round(this.options.tableHeight),screenWidth:this.options.screenWidth,webBackground:this.options.webBackground,tableMergedRowsAndCols:this.options.tableMergedRowsAndCols,forceRowChunk:this.options.forceRowChunk,simpleJson:this.options.simpleJson,widgetName:this.options.widgetName,externals:this.options.externals}}},{key:"setData",value:function(e){this.data=e}},{key:"adaptTable",value:function(e,t){return!!(this.model.reportFitAttr&&e&&t)&&(this.model.resizeModel.resize(this.data,{tableWidth:Math.round(e),tableHeight:Math.round(t),fitAttr:this.model.reportFitAttr,hasFrozen:this.model.hasFrozen,paperWidth:this.model.paperSetting.paperWidth,paperHeight:this.model.paperSetting.paperHeight}),this.model.resizeModel.isAdaptive)}},{key:"adjustAndLoadData",value:function(e){const{sheetData:t,rows:r,rowCount:n,cols:o,columnCount:i,merges:a,stickers:s,tableHeight:l,tableWidth:c,screenWidth:u,sx:d,sy:h}=e,{tableRows:p,tableCols:f}=this.adjustRowsAndCols(r,o,u),g={sheet:{rowc:n,colc:i,data:t,rows:p,cols:f,initialRows:[...p],initialCols:[...f],merges:a,freeze:getFreeze(this.model.frozen),stickers:s},topSequnce:{enable:!1,size:0},leftSequnce:{enable:!1,size:0},activeBox:this.model.activeBox,sx:d,sy:h};this.setData(g),this.adaptTable(c,l),this.options.loadData(g),this.setTableLoading(!1)}},{key:"mergetSheetData",value:function(e){var t,r,n,o,i,a,s,l,c,u,d,h,p;const{sheetData:f,rows:g,rowCount:m,cols:y,columnCount:v,merges:_,stickers:b,tableHeight:C,tableWidth:E,screenWidth:T,sx:S,sy:P}=e,{tableRows:w,tableCols:x}=this.adjustRowsAndCols(g,y,T),O=(null===(t=this.data)||void 0===t?void 0:t.sheet.rowc)?this.data.sheet.rowc+m-5:m,$=(null===(r=this.data)||void 0===r?void 0:r.sheet.rows)?[...this.data.sheet.rows.slice(0,2),...null===(n=this.data.sheet.rows)||void 0===n?void 0:n.slice(2,-3),...w.slice(2,-3),...this.data.sheet.rows.slice(-3)]:w,I=(null===(o=this.data)||void 0===o?void 0:o.sheet.initialRows)?[...this.data.sheet.initialRows.slice(0,2),...null===(i=this.data.sheet.initialRows)||void 0===i?void 0:i.slice(2,-3),...w.slice(2,-3),...this.data.sheet.initialRows.slice(-3)]:[...w],R=(null===(a=this.data)||void 0===a?void 0:a.sheet.data)?[...this.data.sheet.data.slice(0,2),...null===(s=this.data.sheet.data)||void 0===s?void 0:s.slice(2,-3),...f.slice(2,-3),...this.data.sheet.data.slice(-3)]:f,A=(null===(l=this.data)||void 0===l?void 0:l.sheet.merges)?this.chunkBuildMerges(this.data.sheet.merges,_.slice(2,-2),R.length,y.length):_,D=(null===(c=this.data)||void 0===c?void 0:c.sheet.stickers)?this.chunkBuildStickers(this.data.sheet.stickers,b,R.length):b,L={sheet:{rowc:O,colc:v,data:R,rows:$,cols:x,initialRows:I,initialCols:[...x],merges:A,freeze:getFreeze(this.model.frozen),stickers:D},topSequnce:{enable:!1,size:0},leftSequnce:{enable:!1,size:0},activeBox:this.model.activeBox,sx:null!==(d=null===(u=this.data)||void 0===u?void 0:u.sx)&&void 0!==d?d:S,sy:null!==(p=null===(h=this.data)||void 0===h?void 0:h.sy)&&void 0!==p?p:P};this.setData(L),this.adaptTable(E,C),this.options.loadData(this.data)}},{key:"getOffsetRowChunk",value:function(e){const{rowChunkSize:t}=this.options.forceRowChunk;return(Math.ceil((e-5)/t)-1)*t}},{key:"chunkBuildStickers",value:function(e,t,r){const n=this.getOffsetRowChunk(r);return t.forEach((e=>{"row"in e.position&&(e.position.row+=n)})),[...e,...t]}},{key:"chunkBuildMerges",value:function(e=[],t=[],r=0,n){const o=this.getOffsetRowChunk(r),i=e.slice(0,-2),a=[[[1,r-2],[n-2,r-2]],[[0,r-1],[n-1,r-1]]];return t.forEach((e=>{e[0][1]+=o,e[1][1]+=o})),[...i,...t,...a]}},{key:"adjustRowsAndCols",value:function(e,t,r){const n=adjustRows(e,this.model.paperHeight,this.model.hasFrozen),o=adjustCols(t,this.model.paperWidth,this.model.hasFrozen),i=o.reduce(((e,t)=>e+t),0),a=r-i+o[0]+o[o.length-1];return this.model.viewAtCenter&&(r<i||a/2<this.model.paperSetting.marginLeft||a/2<this.model.paperSetting.marginRight?(o[0]=this.model.paperSetting.marginLeft,o[o.length-1]=this.model.paperSetting.marginRight):(o[0]=a/2,o[o.length-1]=a/2)),{tableRows:n,tableCols:o}}},{key:"transformTableRowData2SheetRowData",value:function(e){const{data:t}=e,r=__rest(e,["data"]);for(let n=0;n<t.length;n++)t[n]&&this.transformTableCellData2SheetCellData(Object.assign(Object.assign({},r),{cellData:t[n]}))}},{key:"transformTableCellData2SheetCellData",value:function(e){const{rows:t,cols:r,stickers:n,merges:o,sx:i,sy:a,sheetData:s,cellData:l,simple:c}=e,u=this.transformTableCellData2SheetCellArgs({cellData:l,sx:i,sy:a,sheetData:s});if(!u)return;const{x:d,y:h,celldimension:p,cell:f,position:g}=u,{col:m,row:y}=getCellSize(p,r[d],t[h]);if(r[d]=m,t[h]=y,!f||c)return;getCellStickers(f,this.options.tableStickerGenerator).forEach((e=>{e&&n.push(getSticker(d,h,e,l))}));const{columnSpan:v=1,rowSpan:_=1}=g;(v>1||_>1)&&o.push(getMerge(d,h,v,_))}},{key:"transformTableCellData2SheetCellArgs",value:function(e){const{sx:t,sy:r,sheetData:n,cellData:o}=e;if(o){const{value:e,celldimension:i,position:a}=o;let{x:s,y:l}=a;if(s-=t,l-=r,e){n[l]=n[l]||[];const e=getCell(o,this.options.tableCellGenerator);return n[l][s]=e.toCell(),{cell:e,x:s,y:l,celldimension:i,position:a}}return{x:s,y:l,celldimension:i,position:a}}}},{key:"fixData",value:function(e,t,r,n,o){const{marginLeft:i,marginTop:a,marginRight:s,marginBottom:l}=this.model.paperSetting;return e.push([createEmptyCell(t+n,r+o,0,0,1,1)]),e.unshift([createEmptyCell(t,r-1,0,this.model.headerHeight,1,n+1)]),e.push([createEmptyCell(t,r+o+1,0,this.model.footerHeight,1,n+1)]),e.unshift([createEmptyCell(t-1,r-2,i,a,1,n+3),createEmptyCell(t+1+n,r-2,s,a,1,1)]),e.push([createEmptyCell(t-1,r+o+2,i,l,1,n+3)]),e}},{key:"transformTableData",value:function(e){return e.forEach(((t,r)=>{t.forEach(((t,n)=>{if(!BI.isNull(t.merge))return;const{position:{rowSpan:o,columnSpan:i}}=t;(o&&o>1||i&&i>1)&&fixRealCellPositionInMergeCell(e,{rowSpan:o,columnSpan:i,x:n,y:r})}))})),e}},{key:"transformTableRowAndCol2MergedRowAndCol",value:function(e){var t,r;const n=(null===(t=e.sheet.rows)||void 0===t?void 0:t.slice())||[],o=(null===(r=e.sheet.cols)||void 0===r?void 0:r.slice())||[],i=n.slice(0,2),a=n.slice(-3),s=i.reduce(((e,t)=>e+(t||0)),0),l=a.reduce(((e,t)=>e+(t||0)),0);n[2]=(n[2]||0)+s,n.splice(0,3,n[2]),n[n.length-4]=(n[n.length-4]||0)+l,n.splice(n.length-4,4,n[n.length-4]);const c=o[0]||0,u=o.slice(-2).reduce(((e,t)=>e+(t||0)),0);return o[1]=(o[1]||0)+c,o.splice(0,2,o[1]),o[o.length-3]=(o[o.length-3]||0)+u,o.splice(o.length-3,3,o[o.length-3]),{mergedRows:n,mergedCols:o}}},{key:"transformTableData2SimpleJson",value:function(e){return e?isSimplePageResult(e)?transformSimplePageResult2Old(e):e:[]}}])}();function _classCallCheck$7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$6(n.key),n)}}function _createClass$7(e,t,r){return t&&_defineProperties$6(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$6(e){var t=_toPrimitive$6(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$6(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}TableModel.xtype="report.model.components.tool_bar.table",TableModel=__decorate$1([model()],TableModel);let MutiTableRowColumn=_createClass$7((function e(t){_classCallCheck$7(this,e),this.tableRowColumns=[],this.externalContext=t}),[{key:"setHeight",value:function(e){this.tableRowColumns.forEach((t=>t.setHeight(e)))}},{key:"getHeight",value:function(){return this.tableRowColumns.map((e=>e.getHeight()))}},{key:"setWidth",value:function(e){this.tableRowColumns.forEach((t=>t.setWidth(e)))}},{key:"getWidth",value:function(){return this.tableRowColumns.map((e=>e.getWidth()))}},{key:"getCell",value:function(e){return this.tableRowColumns.map((t=>t.getCell(e)))}},{key:"getIndex",value:function(){return this.tableRowColumns.map((e=>e.getIndex()))}},{key:"setStyle",value:function(e){this.tableRowColumns.forEach((t=>t.setStyle(e)))}},{key:"showToolTip",value:function(e){e.show&&this.tableRowColumns.forEach((t=>t.showToolTip(e)))}},{key:"createMultipleApi",value:function(e,t){let r,n;switch(e){case"row":default:r=t.y,n=r+(t.rowSpan||1);break;case"column":r=t.x,n=r+(t.columnSpan||1)}for(let i=r;i<n;i++){const t="row"===e?this.externalContext.getRow(i+1):this.externalContext.getColumn(i+1);!BI.isNull(t)&&this.tableRowColumns.push(t)}const o={};return this.tableRowColumns.forEach(((e,t)=>{o[t]=e})),Object.assign(Object.assign({},o),{length:BI.size(this.tableRowColumns),setHeight:e=>this.setHeight(e),getHeight:()=>this.getHeight(),setWidth:e=>this.setWidth(e),getWidth:()=>this.getWidth(),getCell:e=>this.getCell(e),getIndex:()=>this.getIndex(),setStyle:e=>this.setStyle(e),showToolTip:e=>this.showToolTip(e)})}}]);function _classCallCheck$6(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$5(n.key),n)}}function _createClass$6(e,t,r){return t&&_defineProperties$5(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$5(e){var t=_toPrimitive$5(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$5(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}let TableCell=_createClass$6((function e(t,r){_classCallCheck$6(this,e),this.externalContext=t,this.cellData=r}),[{key:"getPosition",value:function(){const{x:e,y:t}=this.cellData.position;return[t+1,e+1]}},{key:"getPosition4Inside",value:function(){return this.cellData.position}},{key:"getRow",value:function(){return this.getTableRowColumn("row")}},{key:"getColumn",value:function(){return this.getTableRowColumn("column")}},{key:"getTableRowColumn",value:function(e){return new MutiTableRowColumn(this.externalContext).createMultipleApi(e,this.cellData.position)}},{key:"getValue",value:function(){return this.cellData.value}},{key:"setValue",value:function(e){this.externalContext.emitCellEvent("CELL_SET_VALUE",Object.assign({value:e},this.getPosition4Inside()))}},{key:"showToolTip",value:function(e){if(!e.show)return;const{content:t,style:r}=e;this.externalContext.addHandler(PopupHandler,{position:this.getPosition4Inside(),scopeType:"cell",body:null==t?void 0:t.text,header:null==t?void 0:t.header,image:null==t?void 0:t.image,style:r})}},{key:"getCellStyle",value:function(){var e,t;const{borderStyle:r,cellBackground:n,contentStyle:o,fontStyle:i}=this.cellData.cellstyle;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},r),{backgroundColor:null===(e=null==n?void 0:n.background)||void 0===e?void 0:e.color,backgroundImage:null===(t=null==n?void 0:n.background)||void 0===t?void 0:t.imgUrl}),o),i),{textShadow:transformTextShadow2Css(i.textShadow),italic:transformFontItalic(i.italic),fontWeight:transformFontWeight(i.bold)})}},{key:"setStyle",value:function(e){this.externalContext.emitCellEvent("CELL_SET_STYLE",Object.assign({style:Object.assign(Object.assign({},this.getCellStyle()),e)},this.getPosition4Inside()))}}]);function _classCallCheck$5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$4(n.key),n)}}function _createClass$5(e,t,r){return t&&_defineProperties$4(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$4(e){var t=_toPrimitive$4(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$4(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}let TableRowColumn=_createClass$5((function e(t,r){_classCallCheck$5(this,e),this.externalContext=t,this.index=r.index,this.size=r.size,this.unifiedPosition=r.unifiedPosition}),[{key:"getWidth",value:function(){return-1}},{key:"setWidth",value:function(e){}},{key:"getHeight",value:function(){return-1}},{key:"setHeight",value:function(e){}},{key:"getIndex",value:function(){return this.index}},{key:"setStyle",value:function(e){this.externalContext.emitCellEvent("CELL_SET_STYLE",Object.assign({style:e},this.getUnifiedPosition()))}},{key:"showToolTip",value:function(e){if(!e.show)return;const{content:t,style:r}=e;this.externalContext.addHandler(PopupHandler,{position:this.getUnifiedPosition(),scopeType:"rowcolumn",body:null==t?void 0:t.text,header:null==t?void 0:t.header,image:null==t?void 0:t.image,style:r})}}]);function _classCallCheck$4(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$3(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$3(n.key),n)}}function _createClass$4(e,t,r){return t&&_defineProperties$3(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$3(e){var t=_toPrimitive$3(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$3(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$4(e,t,r){return t=_getPrototypeOf$4(t),_possibleConstructorReturn$4(e,_isNativeReflectConstruct$4()?Reflect.construct(t,r||[],_getPrototypeOf$4(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$4(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$4(e)}function _assertThisInitialized$4(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$4(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$4=function(){return!!e})()}function _getPrototypeOf$4(e){return(_getPrototypeOf$4=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$4(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$4(e,t)}function _setPrototypeOf$4(e,t){return(_setPrototypeOf$4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let TableColumn=function(e){function t(){return _classCallCheck$4(this,t),_callSuper$4(this,t,arguments)}return _inherits$4(t,TableRowColumn),_createClass$4(t,[{key:"getUnifiedPosition",value:function(){return{x:this.unifiedPosition}}},{key:"setWidth",value:function(e){this.size=e,this.externalContext.emitCellEvent("CELL_SET_SIZE",{x:this.index-1,width:e})}},{key:"getWidth",value:function(){return this.size}},{key:"getCell",value:function(e){return this.externalContext.getCell(e,this.index)}}])}();function _classCallCheck$3(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2(n.key),n)}}function _createClass$3(e,t,r){return t&&_defineProperties$2(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2(e){var t=_toPrimitive$2(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$2(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$3(e,t,r){return t=_getPrototypeOf$3(t),_possibleConstructorReturn$3(e,_isNativeReflectConstruct$3()?Reflect.construct(t,r||[],_getPrototypeOf$3(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$3(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$3(e)}function _assertThisInitialized$3(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$3=function(){return!!e})()}function _getPrototypeOf$3(e){return(_getPrototypeOf$3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$3(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$3(e,t)}function _setPrototypeOf$3(e,t){return(_setPrototypeOf$3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}let TableRow=function(e){function t(){return _classCallCheck$3(this,t),_callSuper$3(this,t,arguments)}return _inherits$3(t,TableRowColumn),_createClass$3(t,[{key:"getUnifiedPosition",value:function(){return{y:this.unifiedPosition}}},{key:"setHeight",value:function(e){this.size=e,this.externalContext.emitCellEvent("CELL_SET_SIZE",{y:this.index-1,height:e})}},{key:"getHeight",value:function(){return this.size}},{key:"getCell",value:function(e){return this.externalContext.getCell(this.index,e)}}])}();function _classCallCheck$2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1(n.key),n)}}function _createClass$2(e,t,r){return t&&_defineProperties$1(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1(e){var t=_toPrimitive$1(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive$1(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper$2(e,t,r){return t=_getPrototypeOf$2(t),_possibleConstructorReturn$2(e,_isNativeReflectConstruct$2()?Reflect.construct(t,r||[],_getPrototypeOf$2(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$2(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$2(e)}function _assertThisInitialized$2(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$2(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$2=function(){return!!e})()}function _getPrototypeOf$2(e){return(_getPrototypeOf$2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$2(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$2(e,t)}function _setPrototypeOf$2(e,t){return(_setPrototypeOf$2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __decorate=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},AxisSheet_1;let AxisSheet=AxisSheet_1=function(e){function t(){var e;return _classCallCheck$2(this,t),(e=_callSuper$2(this,t,arguments)).mouseInBounds=!1,e.isPauseCarousel=!1,e.stickerManagers=new Map,e.tableCellGenerator=new TableCellGenerator({attach:t=>BI.createWidget(Object.assign(Object.assign({},t),{element:e})),getTableData:()=>e.store.getTableData(),populate:t=>e.populate(t,{sync:!0,silent:!0,cache:!0,noChunk:!0}),partialPopulate:t=>{e.store.refreshCellValues(t)},getWidgetName:()=>e.model.widgetName,getStickerManagers:()=>e.stickerManagers,getCellValueById:t=>e.getCellValueById(t),getCellById:t=>e.getCellById(t),getCellValueByWidgetName:t=>{const[r]=e.getCellControllersByWidgetName(t);if(BI.isNull(r))return;const n=r.attr("cellId");return e.getCellValueById(n)},getWidgetByCell:(t,r)=>e.getWidgetByCell(t,r),setSelectCell:t=>{e.store.setSelectedCell({row:t.row,col:t.col}),e.fireEvent(AxisSheet_1.EVENT_SELECT_CELL,t)},getDependenceValueById:t=>e.getDependenceValueById(t),getFontResizable:()=>e.model.reportFitAttr.fitFont,getExternals:()=>e.model.externals,setCellChartLoaded:t=>{e.store.setTableCellChartLoaded(t)},getLinkConfig:()=>e.options.linkConfig,getIsRowChunking:()=>e.isRowChunking}),e.tableStickerGenerator=new TableStickerGenerator({getStickerConfig:()=>Object.assign(Object.assign({},{html:!0,widget:!0,filter:!0,state:!0}),e.options.stickerConfig)}),e.tableContext4Api={addHandler:(t,r)=>e.addHandler(t,r),emitCellEvent:(t,r)=>e.emitCellEvent(t,r),getRow:t=>e.getRow(t),getColumn:t=>e.getColumn(t),getCell:(t,r)=>e.getCell(t,r)},e.props={baseCls:"report-table",$testId:"report-table",tableData:[],reportSettingDetail:{},reportFitAttr:{fitFont:!1,fitStateInPC:3},viewAtCenter:!1,frozen:void 0,browserBg:{},widgetName:"",activeBox:!0,synchronize:!1,supportCSSTransform:!1,isDisableContextMenu:!1,isDisableWheel:!1,externals:{},stickerConfig:{html:!0,widget:!0,state:!0,filter:!0},minDpr:1,forceRowChunk:{isForceRowChunk:!1,rowChunkSize:200},linkConfig:{},disableScrollCache:!1,simpleJson:!1},e.watch={reportSettingDetail:()=>{e.reLayout()},loading:t=>{e.loading.setVisible(t)},webBackground:()=>{e.changeBackground("webBackground")},reportFitAttr:e=>{resizerProvider.setResizeMode(e.fitStateInPC)}},e}return _inherits$2(t,BI.Widget),_createClass$2(t,[{key:"mounted",value:function(){resizerProvider.setResizeMode(this.model.reportFitAttr.fitStateInPC),!this.model.tableWidth&&this.store.setTableWidth(this.table.element.width()),!this.model.tableHeight&&this.store.setTableHeight(this.table.element.height()),!this.model.screenWidth&&this.store.setScreenWidth(this.element.width());const e=this.store.getTableData();this.sheet=finesheet.createSheet(this.table.element[0],{tableWidth:this.model.tableWidth,tableHeight:this.model.tableHeight,options:{sheet:{colc:0,rowc:0},contextMenuItems:[{key:"copy",icon:"",label:BI.i18nText("Fine-Report_Copy"),accel:""}],sync:this.options.synchronize,supportCSSTransform:this.options.supportCSSTransform,disableContextMenu:()=>this.isDisableContextMenu,disableWheel:()=>this.isDisableWheel,minDpr:this.options.minDpr,disableScrollCache:this.options.disableScrollCache}});const{sheet:t}=this.sheet;t.addEventListener("scroll",(({x:e,y:t})=>{!this.model.isAdaptiveTable&&this.background.element.css("transform","translate(-".concat(e,"px, -").concat(t,"px)"))})),this.populate(e),this.table.element.on("mouseenter",(()=>{this.mouseInBounds=!0})),this.table.element.on("mouseleave",(()=>{this.mouseInBounds=!1}))}},{key:"render",value:function(){return this.sheetStyles=index.createStyleSheet({paperBackground:this.model.paperBackground,webBackground:this.model.webBackground},{link:!0}).attach(),{type:BI.AbsoluteLayout.xtype,scrollable:!1,cls:"".concat(this.sheetStyles.classes.webBackground),items:[{el:this.model.isAdaptiveTable?{type:BI.Layout.xtype,invisible:!0,cls:"".concat(this.sheetStyles.classes.paperBackground),ref:e=>{this.background=e}}:{type:BI.HorizontalLayout.xtype,scrollx:!1,horizontalAlign:this.model.viewAtCenter?BI.HorizontalAlign.Center:BI.HorizontalAlign.Left,items:[{type:BI.Layout.xtype,invisible:!0,cls:"".concat(this.sheetStyles.classes.paperBackground),ref:e=>{this.background=e},width:Math.min(this.model.paperWidth,25e3),height:Math.min(this.model.paperHeight,25e3)}]},top:0,left:0,right:0,bottom:0},{el:{type:BI.Layout.xtype,ref:e=>{this.table=e}},top:0,left:0,right:0,bottom:0},{el:{type:Loading.xtype,ref:e=>{this.loading=e},$testId:"report-table-loading",invisible:!this.model.loading},top:0,left:0,right:0,bottom:0}]}}},{key:"getPaperWidget",value:function(){return this.background}},{key:"getCellIdByPosition",value:function(e,t){const r=this.store.getTableData()[e][t];return"".concat(r.id)||transformPosition2Id(t,e)}},{key:"getWidgetByCell",value:function(e,t){const{address:r,position:n}=BI.isString(e)?{address:e,position:void 0}:BI.isNumber(e)&&BI.isNumber(t)?{address:void 0,position:{row:e,col:t}}:{address:void 0,position:void 0};if(BI.isNull(r)&&BI.isNull(n))return;const o=n?this.getCellIdByPosition(n.row,n.col):r;if(!o)return;const i=this.stickerManagers.get(CellControllerManager.NAME);if(!i)return;i.initializeWidget(o);return i.getWidgetByName(o)}},{key:"getDependenceValueById",value:function(e){const t=this.getWidgetByCell(e),r=BI.isNull(t)?this.getCellValueById(e):t.getDependenceValue(),[n]=this.getCellControllersByWidgetName(e);return BI.isNull(r)?(null==n?void 0:n.getDependenceValue())||"":r}},{key:"getCellControllersByWidgetName",value:function(e){const t=this.stickerManagers.get(CellControllerManager.NAME);if(!t)return[];t.getUninitializedWidgetsDict().forEach((({cellWidgetName:r},n)=>{r.toUpperCase()===e.toUpperCase()&&t.initializeWidget(n)}));return t.getWidgets().filter((t=>t.attr("cellWidgetName")&&t.attr("cellWidgetName").toUpperCase()===e.toUpperCase()))}},{key:"selectCell",value:function(e){const{id:t,position:r,selectedCell:n}=BI.isString(e)?{id:e,position:void 0,selectedCell:void 0}:BI.isNull(e)?{position:void 0,id:void 0,selectedCell:void 0}:"row"in e?{position:e,id:void 0,selectedCell:void 0}:{position:void 0,id:void 0,selectedCell:e};let o;const i=this.store.getTableData();if(n?o=n:t?i.some((e=>e.some((e=>e.id===t&&(o=e,!0))))):r?o=i[r.row][r.col]:i.some((e=>e.some((e=>!!e.widget&&(o=e,!0))))),o){const e=t||this.getCellIdByPosition(o.position.y,o.position.x);return this.emitCellEvent("CELL_SELECT",{id:e,cell:o}),{id:e,cell:o}}}},{key:"selectNextCell",value:function(){const{row:e,col:t}=this.model.selectedCell||{row:0,col:0};let r;this.store.getTableData().some((n=>n.some((n=>{if(n.position.y<e)return!1;const o=!!n.widget;return n.position.y>e?(o&&(r=n),o):!!(n.widget&&n.position.x>t)&&(r=n,!0)})))),this.selectCell(r)}},{key:"setSelectCell",value:function(e){const t=this.getSelectedCell();if(t){const e=this.getWidgetByCell(t.row,t.col);(null==e?void 0:e.isActive())&&this.emitCellEvent("ACTIVE_CELL_FORCE_UPDATE",{})}return this.selectCell(e)}},{key:"getSelectedCell",value:function(){return this.model.selectedCell}},{key:"getTableData",value:function(){return this.store.getTableData()}},{key:"rowChunkPopulate",value:function(e,t){if(!e)return;this.isRowChunking=!0,this.chunkCalculateData(e);const{cache:r=!1}=t||{};r?this.updateInstances():this.clearInstances(),this.fireEvent(AxisSheet_1.EVENT_LOADED,this),this.background.visible()}},{key:"chunkCalculateData",value:function(e,t=0){const{x:r,y:n}=this.getScrollOffset(),o=r>0||n>0?BI.size(e):t+this.model.forceRowChunk.rowChunkSize,i=e.slice(t,o),a=this.store.prePopulate({tableWidth:this.model.tableWidth,tableHeight:this.model.tableHeight,screenWidth:this.model.screenWidth},i);a&&(0===t?this.store.completeLoadData(a):this.store.splitLoadData(a),o<BI.size(e)?this.chunkCalculateData(e,o):(0!==t&&this.store.fixTableData(e),this.isRowChunking=!1))}},{key:"populate",value:function(e,t){const{sync:r=!1,cache:n=!1,silent:o=!1,noChunk:i=!1}=t||{};if(this.model.forceRowChunk.isForceRowChunk&&!i)return void this.rowChunkPopulate(e,t);const a=this.store.prePopulate({tableWidth:this.model.tableWidth,tableHeight:this.model.tableHeight,screenWidth:this.model.screenWidth},e);a&&(n?this.updateInstances():this.clearInstances(),this.model.isAdaptiveTable||r||this.options.synchronize?this.store.completeLoadData(a):this.store.rowChunkLoadData(a),!o&&this.fireEvent(AxisSheet_1.EVENT_LOADED,this),this.background.visible())}},{key:"setLoading",value:function(e){this.store.setTableLoading(e)}},{key:"setReportSettingDetail",value:function(e){this.store.setReportSetting(e)}},{key:"setFrozen",value:function(e){this.store.setFrozen(e)}},{key:"setReportFitAttr",value:function(e){this.store.setReportFitAttr(e),this.populate(this.store.getTableData())}},{key:"setViewAtCenter",value:function(e){this.store.setViewAtCenter(e),this.populate(this.store.getTableData())}},{key:"setActiveBox",value:function(e){this.store.setActiveBox(e),this.populate(this.store.getTableData())}},{key:"setTableWidth",value:function(e){this.store.setTableWidth(e),this.populate(this.store.getTableData())}},{key:"setTableHeight",value:function(e){this.store.setTableHeight(e),this.populate(this.store.getTableData())}},{key:"setScreenWidth",value:function(e){this.store.setScreenWidth(e),this.populate(this.store.getTableData())}},{key:"setWebBackground",value:function(e){this.store.setWebBackground(e)}},{key:"refreshTable",value:function(e){const{widgetName:t,tableData:r,loading:n,activeBox:o,viewAtCenter:i,frozen:a,reportSettingDetail:s,reportFitAttr:l,tableWidth:c,tableHeight:u,screenWidth:d,webBackground:h,externals:p}=e||{};if(BI.isNotNull(n)&&this.store.setTableLoading(n),BI.isNotNull(o)&&this.store.setActiveBox(o),BI.isNotNull(i)&&this.store.setViewAtCenter(i),BI.isNotNull(a)&&this.store.setFrozen(a),BI.isNotNull(s)&&this.store.setReportSetting(s),BI.isNotNull(l)&&this.store.setReportFitAttr(l),BI.isNotNull(d)&&this.store.setScreenWidth(d),BI.isNotNull(h)&&this.store.setWebBackground(h),BI.isNotNull(p)&&this.store.setExternals(p),BI.isNotNull(t)&&this.store.setWidgetName(t),c!==this.model.tableWidth||u!==this.model.tableHeight){const e=Math.floor(c||0),t=Math.floor(u||0);e&&this.store.setTableWidth(e),t&&this.store.setTableHeight(t),this.sheet.resize(e||this.model.tableWidth,t||this.model.tableHeight)}const f=this.getFinalTableData(r);0!==f.length?this.populate(f):this.sheet.sheet.loadData({sheet:{colc:0,rowc:0}})}},{key:"getFinalTableData",value:function(e){return e?this.model.simpleJson?this.store.transformSimpleTableData(e):e:this.store.getTableData()}},{key:"clearInteractState",value:function(){this.sheet.sheet.clear(),this.mouseInBounds=!1}},{key:"resize",value:function(e,t){const r=Math.floor(e),n=Math.floor(t);this.store.setTableWidth(r),this.store.setTableHeight(n),this.store.setScreenWidth(this.element.width()),this.updateInstances(),this.store.resize(r,n,this.element,this.model.screenWidth),this.sheet.resize(r,n)}},{key:"clearInstances",value:function(){this.stickerManagers.forEach((e=>{e.destroy()}))}},{key:"updateInstances",value:function(){this.stickerManagers.forEach((e=>{e.update()}))}},{key:"getCellPosition",value:function(e,t){return this.sheet.getCellPosition({row:e+1,col:t})}},{key:"setHScrollBarVisible",value:function(e){this.sheet.sheet.setHScrollBarVisible(e)}},{key:"setVScrollBarVisible",value:function(e){this.sheet.sheet.setVScrollBarVisible(e)}},{key:"startMarquee",value:function(e){const{offset:t=5,interval:r=.1,stopOnHover:n=!0,to:o="top"}=e||{};(()=>{const e=()=>{const i=0===this.table.element.width()||0===this.table.element.height()||this.isPauseCarousel;n&&this.mouseInBounds||i||("left"===o||"right"===o?this.whellScrollX("right"===o?0-t:t):this.whellScrollY("bottom"===o?0-t:t)),this.timer=window.setTimeout(e,1e3*r)};!this.timer&&(this.timer=window.setTimeout(e,1e3*r))})()}},{key:"startCarousel",value:function(e){var t;const{mode:r="page",speed:n=50,to:o="top",stay:i=0,joinable:a=!1,stopOnHover:s=!0}=e||{},l="left"===o||"right"===o,c="right"===o||"bottom"===o,u="page"===r,{mergedRows:d,mergedCols:h}=this.model.tableMergedRowsAndCols,{headHeight:p,headWidth:f,tailHeight:g,tailWidth:m}=this.sheet.sheet.getFreezeConfig(),{rowCount:y,colCount:v,footRowCount:_,footColCount:b}=getFreezeRowsAndColsCount(this.model.frozen),C=l?v:y,E=5===(null===(t=this.options.reportFitAttr)||void 0===t?void 0:t.fitStateInPC)?2:1;d[d.length-1]+=E,h[h.length-1]+=E;const T=u?-1:l?h.length-1-b:d.length-1-_;let S=0,P=0,w=null,x=0,O=C,$=0;this.sheet.sheet.setRepeatFill(a);const I=()=>u?l?this.model.tableWidth-f-m:this.model.tableHeight-p-g:l?h[O]:d[O],R=()=>l?this.sheet.sheet.getMaxScroll().maxScrollX:this.sheet.sheet.getMaxScroll().maxScrollY,A=()=>{const{maxScrollX:e,maxScrollY:t}=this.sheet.sheet.getMaxScroll();return l?{minMove:a?0:-this.model.tableWidth+f+m,maxMove:a||!c?e+this.model.tableWidth-f-m:e}:{minMove:a?0:-this.model.tableHeight+p+g,maxMove:a||!c?t+this.model.tableHeight-p-g:t}},D=e=>{const{left:t,top:r}=this.sheet.sheet.getBounds();this.sheet.sheet.setBoundsOffset({offsetX:l?e:t,offsetY:l?r:e})},L=(e,t)=>{const r=S>A().minMove&&S<A().maxMove;P>=e&&0!==t?(x=a||!a&&r?1e3*i:0,P=0,!u&&(O=(()=>{const e=(O+(c?-1:1)+T+1)%(T+1);return Math.max(e,C)})())):x=0},N=e=>{const t=0===this.table.element.width()||0===this.table.element.height()||this.isPauseCarousel,{maxMove:r,minMove:o}=A(),i=R();if(a&&S>i&&this.model.cellChartLoaded&&(l?this.sheet.sheet.cloneSticker(this.model.tableWidth,0):this.sheet.sheet.cloneSticker(0,this.model.tableHeight)),s&&this.mouseInBounds||t){if(w=e,this.rAFId=window.requestAnimationFrame(N),t)return;if(S>i||S<0){const e=S<0||S-i>(l?this.model.tableWidth:this.model.tableHeight)/2;D(e?0:i),S=e?0:i,O=e?C:T,P=0}return}const u=I(),d=w?e-w:0,h=((e,t)=>{let r=0;return e<.5&&e>0?($+=e,r=$>=1?Math.floor($):0,$-=r):r=Math.min(t-P,Math.round(e)),r})(n*(d-x)/1e3,u);d>=x&&(S>i&&S-h<i&&D(i),(S<o||S>r)&&(S=S<o?i>0?r:r-1:0,P=a?0:u),D(S),S+=c?0-h:h,P+=h,w=e,L(u,d)),this.rAFId=window.requestAnimationFrame(N)};this.rAFId=window.requestAnimationFrame(N)}},{key:"clearTimer",value:function(){window.clearTimeout(this.timer),this.timer=void 0}},{key:"stopCarousel",value:function(){window.cancelAnimationFrame(this.rAFId)}},{key:"pauseCarousel",value:function(){this.isPauseCarousel=!0}},{key:"continueCarousel",value:function(){this.isPauseCarousel=!1}},{key:"stopMarquee",value:function(){this.clearTimer()}},{key:"addBackgroundColorHandler",value:function(e){this.store.addHandler(BackgroundColorHandler,e)}},{key:"addHighlightRowEffect",value:function(e,t){this.addBackgroundColorHandler({style:e,type:"line",trigger:t})}},{key:"addHighlightRowHoldEffect",value:function(e,t){this.addBackgroundColorHandler({style:e,type:"line",hold:"row",trigger:t})}},{key:"addHighlightColEffect",value:function(e,t){this.addBackgroundColorHandler({style:e,type:"column",trigger:t})}},{key:"addHighlightColHoldEffect",value:function(e,t){this.addBackgroundColorHandler({style:e,type:"column",hold:"column",trigger:t})}},{key:"addHighlightCrossEffect",value:function(e,t){this.addBackgroundColorHandler({style:e,type:"cross",trigger:t})}},{key:"addHighlightCrossHoldEffect",value:function(e,t){this.addBackgroundColorHandler({style:e,type:"cross",hold:"cross",trigger:t})}},{key:"addHighlightCellEffect",value:function(e,t){this.addBackgroundColorHandler({style:e,type:"cell",trigger:t})}},{key:"addHighlightCellHoldEffect",value:function(e,t=!1,r){this.addBackgroundColorHandler({style:e,type:"cell",hold:t?"row":"all",trigger:r})}},{key:"addFontStyleHandler",value:function(e){this.store.addHandler(FontStyleHandler,e)}},{key:"addSetCellFontEffect",value:function(e,t){this.addFontStyleHandler({style:e,type:"cell",trigger:t})}},{key:"addSetCellFontHoldEffect",value:function(e,t=!1,r){this.addFontStyleHandler({style:e,type:"cell",hold:t?"row":"all",trigger:r})}},{key:"addSetRowFontEffect",value:function(e,t){this.addFontStyleHandler({style:e,type:"line",trigger:t})}},{key:"addSetRowFontHoldEffect",value:function(e,t=!1,r){this.addFontStyleHandler({style:e,type:"line",hold:t?"row":"all",trigger:r})}},{key:"addPopoverEffect",value:function(e,t){this.store.addHandler(PopupHandler,{position:address2Position(e),scopeType:t.type,body:t.text,header:t.header,image:t.image,style:t.style})}},{key:"addHandler",value:function(e,t){this.store.addHandler(e,t)}},{key:"setCellRadius",value:function(e,t,r){this.emitCellEvent("CELL_SET_RADIUS",{radius:e,range:t,single:r})}},{key:"setRowHeight",value:function(e,t){const r=this.store.getTableData();r[e-1].forEach((e=>{e.celldimension.height=t})),this.populate(r)}},{key:"setColWidth",value:function(e,t){const r=this.store.getTableData();r.forEach((r=>{r[e-1].celldimension.width=t})),this.populate(r)}},{key:"getCellValue",value:function(e,t){return BI.isNumber(e)&&BI.isNumber(t)?this.getTableCellValueByPosition(t+1,e+1):this.getTableCellValueByPosition(e,t)}},{key:"getCellVal",value:function(e,t){return this.getTableCellValueByPosition(e,t)}},{key:"getTableCellValueByPosition",value:function(e,t){const r=this.store.getTableData(),n=BI.isNumber(e)&&BI.isNumber(t)?{x:t-1,y:e-1}:BI.isString(e)?address2Position(e):void 0;if(n&&r){return getCellValueByCell(r[n.y][n.x])}}},{key:"verifyCellControllers",value:function(){const e=this.stickerManagers.get(CellControllerManager.NAME);if(!e)return[];const t=[];return e.getWidgets().forEach((e=>{const r=e.getValidation();r.result||t.push({id:e.attr("cellId"),message:r.errorMsg})})),t}},{key:"getDirtyCells",value:function(e=!0){const t=this.store.getTableData(),r=[];return t.forEach((e=>{e.forEach((e=>{if(e.dirty){const{value:t,xtype:n=""}=getCellValue(e.value)||{value:"",xtype:""};r.push({col:e.position.x,row:e.position.y,value:t,xtype:n||"S",frs:!!e.frs})}}))})),e&&this.clearDirtyCells(),r}},{key:"clearDirtyCells",value:function(){this.store.getTableData().forEach((e=>{e.forEach((e=>{e.dirty&&(e.dirty=!1)}))}))}},{key:"getEditedCells",value:function(){const e=[];return this.store.getTableData().forEach((t=>{t.forEach((t=>{t.edited&&e.push(t)}))})),e}},{key:"clearEditedCells",value:function(){this.store.getTableData().forEach((e=>{e.forEach((e=>{e.edited&&(e.edited=!1)}))}))}},{key:"setErrorCells",value:function(e){const t=this.store.getTableData(),r=e.reduce(((e,{id:t,message:r})=>(e.set(t,r),e)),new Map);return t.forEach((e=>{e.forEach((e=>{if(BI.isNull(e.id))return;const t=r.get(e.id);t&&(e.errorMsg=t)}))})),[]}},{key:"getErrorCells",value:function(){const e=this.store.getTableData(),t=[];return e.forEach((e=>{e.forEach((e=>{BI.isNull(e.id)||BI.isNotNull(e.errorMsg)&&t.push(e)}))})),t}},{key:"clearErrorCells",value:function(){return this.store.getTableData().forEach((e=>{e.forEach((e=>{e.errorMsg&&(e.errorMsg=void 0)}))})),[]}},{key:"setCellValue",value:function(e,t,r){return BI.isNumber(e)&&BI.isNumber(t)?this.setTableCellValueByPosition(t+1,e+1,r):this.setTableCellValueByPosition(e,t,r)}},{key:"setCellVal",value:function(e,t,r){return this.setTableCellValueByPosition(e,t,r)}},{key:"setTableCellValueByPosition",value:function(e,t,r){const n=BI.isNumber(e)&&BI.isNumber(t)?{x:t-1,y:e-1}:BI.isString(e)?address2Position(e):void 0,o=BI.isNaN(r)?"":BI.isNumber(e)?null!=r?r:"":null!=r?r:"".concat(null!=t?t:"");return this.setCellValueByPosition(o,n)}},{key:"setCellValueByPosition",value:function(e,t){return!!t&&(this.emitCellEvent("CELL_SET_VALUE",{value:e,x:t.x,y:t.y}),!0)}},{key:"beforeDestroy",value:function(){this.stopMarquee()}},{key:"highlightErrorCell",value:function(e,t){const r=this.stickerManagers.get(CellErrorTipManager.NAME);null==r||r.getWidgets().forEach((e=>{e.invisible()}));const n=null==r?void 0:r.getWidgetByName(e);t&&(null==n||n.setText(t)),null==n||n.visible()}},{key:"reLayout",value:function(){this.changeSize(),this.changeBackground("paperBackground")}},{key:"changeSize",value:function(){this.background.setWidth(this.model.paperSetting.paperWidth),this.background.setHeight(this.model.paperSetting.paperHeight)}},{key:"changeBackground",value:function(e){const t=this.sheetStyles.classes[e];this.sheetStyles.deleteRule(e),this.sheetStyles.addRule(e,this.model[e],{generateId:()=>t})}},{key:"emitCellEvent",value:function(e,t){var r;return Promise.resolve(null===(r=this.tableCellGenerator.getListenerByName(e))||void 0===r?void 0:r.action(t))}},{key:"whellScrollY",value:function(e,t){const{maxScrollY:r,scrollY:n}=this.sheet.sheet.whellScroll(0,e),o=BI.isFunction(t)?t:()=>!0;e<0?0===n&&o()&&this.sheet.sheet.whellScroll(0,r):n>=Math.floor(r)&&o()&&this.sheet.sheet.whellScroll(0,0-r)}},{key:"adjustCell2Visible",value:function(e){const t=this.getCellPositionById(e);if(!t)return;const r=this.getCellPosition(t.row+1,t.column+1);this.sheet.sheet.whellByBounds(r);const n=this.stickerManagers.get(CellErrorTipManager.NAME);null==n||n.adjustErrorTip(e,r,this.sheet.sheet.getBounds())}},{key:"whellScrollX",value:function(e,t){const{maxScrollX:r,scrollX:n}=this.sheet.sheet.whellScroll(e,0),o=BI.isFunction(t)?t:()=>!0;e<0?0===n&&o()&&this.sheet.sheet.whellScroll(r,0):n>=Math.floor(r)&&o()&&this.sheet.sheet.whellScroll(0-r,0)}},{key:"getCellValueById",value:function(e){return getCellValueByCell(this.getCellById(e))}},{key:"getCellById",value:function(e){let t;return e?(this.store.getTableData().some((r=>r.some((r=>"".concat(r.id||"").toUpperCase()===e.toUpperCase()&&(t=r,!0))))),t):t}},{key:"getCellPositionById",value:function(e){var t;const r=null===(t=this.getCellById(e))||void 0===t?void 0:t.position;return r?{row:r.y,column:r.x}:void 0}},{key:"getTDRow",value:function(e){const t=this.getCellPositionById(e);return null==t?void 0:t.row}},{key:"hideSelectFrame",value:function(){const e=this.stickerManagers.get(CellControllerManager.NAME);e&&(null==e||e.setHideSelectFrameSign(!0))}},{key:"getCell",value:function(e,t){const r=this.store.getTableData()[+e-1].find((e=>e.position.x===+t-1&&e.value));return BI.isNull(r)?void 0:new TableCell(this.tableContext4Api,r)}},{key:"getRow",value:function(e){const t=this.store.getTableData();if(BI.isNull(t[e-1]))return;const r=t[e-1].filter((e=>e.value));return BI.size(r)?new TableRow(this.tableContext4Api,{index:e,size:r[0].celldimension.height,unifiedPosition:r[0].position.y}):void 0}},{key:"getColumn",value:function(e){const t=this.store.getTableData().reduce(((t,r)=>{const n=r.find((t=>t.value&&t.position.x===e-1));return!BI.isNull(n)&&t.push(n),t}),[]);return BI.size(t)?new TableColumn(this.tableContext4Api,{index:e,size:t[0].celldimension.width,unifiedPosition:t[0].position.x}):void 0}},{key:"getRowCount",value:function(){const e=this.store.getTableData().reduce(((e,t)=>e+(BI.isNull(t.some((e=>e.value)))?0:1)),0);return this.model.hasFrozen&&this.model.frozen?e-this.model.frozen.rowTo-this.model.frozen.rowFrom-1:e}},{key:"getColumnCount",value:function(){return this.store.getTableData().reduce(((e,t)=>Math.max(e,t.filter((e=>e.value)).length)),0)}},{key:"createCustomEventHandler",value:function(e,t){const r=this;return function(){function n(){var t;return _classCallCheck$2(this,n),(t=_callSuper$2(this,n,arguments)).name="".concat(e,"_CUSTOM_EVENT"),t.eventNames=[e],t.merger="",t}return _inherits$2(n,AbstractCellHandler),_createClass$2(n,[{key:"action",value:function(e){const{e:n,cell:o}=e;if(!BI.isNull(o)){const{x:e,y:i}=o.position;t(n,r.getCell(i+1,e+1))}}}])}()}},{key:"addMouseEventHandler",value:function(e,t){this.store.addHandler(this.createCustomEventHandler(e,t))}},{key:"batchUpdateTableAttr",value:function(e,t){this.emitCellEvent("BATCH_UPDATE_TABLE_ATTR",{cellPositions:e,callback:t})}},{key:"createCustomHandler",value:function(e){const{eventNames:t=[],merger:r="uniqe",name:n,callback:o}=e;if(!["uniqe","covered"].includes(r)||!(BI.isString(n)&&BI.isFunction(o)&&BI.isArray(t)))return;const i=this;return function(){function e(){var o;return _classCallCheck$2(this,e),(o=_callSuper$2(this,e,arguments)).name="".concat(n,"_CUSTOM_HANDLER"),o.eventNames=BI.isEmpty(t)?[o.name]:t,o.merger=r,o}return _inherits$2(e,AbstractCellHandler),_createClass$2(e,[{key:"action",value:async function(e){const t=i.getCellById(e.id||"");return BI.isNull(t)?o(e):o(Object.assign(Object.assign({},e),{cell:BI.deepClone(t)}))}}])}()}},{key:"addCustomHandler",value:function(e){const t=this.createCustomHandler(e);t&&this.store.addHandler(t)}},{key:"emitCustomEvent",value:function(e,t){var r;return Promise.resolve(null===(r=this.tableCellGenerator.getListenerByName("".concat(e,"_CUSTOM_HANDLER")))||void 0===r?void 0:r.action(t))}},{key:"scrollTo",value:function(e,t){e&&this.whellScrollX(e),t&&this.whellScrollY(t)}},{key:"getScrollOffset",value:function(){const{left:e,top:t}=this.sheet.sheet.getBounds();return{x:e,y:t}}},{key:"addTableScrollListener",value:function(e){BI.isFunction(e)&&this.sheet.sheet.addEventListener("scroll",e)}},{key:"getMaxScroll",value:function(){return this.sheet.sheet.getMaxScroll()}},{key:"destroyed",value:function(){var e;null===(e=this.sheet)||void 0===e||e.destroy()}},{key:"disableContextMenu",value:function(e){this.isDisableContextMenu=e}},{key:"getTableSize",value:function(){return{width:this.model.tableWidth,height:this.model.tableHeight}}}])}();function _createClass$1(e,t,r){return Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck$1(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper$1(e,t,r){return t=_getPrototypeOf$1(t),_possibleConstructorReturn$1(e,_isNativeReflectConstruct$1()?Reflect.construct(t,r||[],_getPrototypeOf$1(e).constructor):t.apply(e,r))}function _possibleConstructorReturn$1(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1(e)}function _assertThisInitialized$1(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct$1=function(){return!!e})()}function _getPrototypeOf$1(e){return(_getPrototypeOf$1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$1(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1(e,t)}function _setPrototypeOf$1(e,t){return(_setPrototypeOf$1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function processRowExpandedData(e,t,r){const n=new Set,o=e.find((e=>e.map((e=>e.id)).includes(r)));if(!o)return t;let i=!1,a=BI.first(o).position.y;o.forEach((e=>{i||(i=e.id===r),i&&(a=Math.max(a,e.position.y+(e.position.rowSpan||1)-1))})),e.forEach((e=>{const t=BI.first(e).position.y;t<=a&&n.add(t)}));const s=minimize(t,"y")-n.size;return t.forEach((e=>{e.forEach((e=>{e.position.y-=s}))})),t}function _expandRow(e,t){const r=minimize(t,"y");return e.forEach((e=>{e.forEach((e=>{e.position.y>=r&&(e.position.y+=t.length)}))})),e.concat(t)}function splitPageResultsByRow(e,t,r=!0){let n,o=[],i=[],a=[];if(e.some((e=>e.some((e=>!(!e.id||e.id!==t)&&(n=e,!0))))),!n)return{expanded:[],unexpanded:e};const s=new Set,l=new Set;e.forEach((e=>{e.forEach((e=>{if(n.id&&e.pId===n.id&&l.add(e.pId),!(e.position.y!==n.position.y||e.position.x<n.position.x)&&e.position.rowSpan)for(let t=1;t<e.position.rowSpan;t++)s.add(n.position.y+t)}))})),e.forEach((e=>{if(e.some((e=>e.id===t)))return void i.push(e);e.some((e=>e.pId&&l.has(e.pId)))&&e.some((e=>!(!BI.isNotNull(e.id)||!BI.isNotNull(e.pId))&&(o=BI.uniq(o.concat([e.id])),!0))),i.push(e)})),o.forEach((e=>{const t=splitPageResultsByRow(i,e,!1);i=t.unexpanded,a=a.concat(t.expanded)})),i=i.filter((e=>{const t=e.some((e=>e.id&&o.includes(e.id)));return t&&a.push(e),!t}));const c=[];return i.forEach((e=>{e.some((e=>s.has(e.position.y)))&&!r?a.push(e):c.push(e)})),{unexpanded:c,expanded:a}}function minimize(e,t){return e.reduce(((e,r)=>Math.min(r.reduce(((e,r)=>Math.min(e,r.position[t])),1/0),e)),1/0)}function getWorkbookToolbarSetting(e){return(null!=e?e:TOOLBAR_BUTTON_STYLE.LIGHT)===TOOLBAR_BUTTON_STYLE.LIGHT?TOOLBAR_SETTINGS_LIGHT:TOOLBAR_SETTINGS_DARK}AxisSheet.xtype="report.table",AxisSheet.EVENT_LOADED="EVENT_LOADED",AxisSheet.EVENT_FETCH_DATA="EVENT_FETCH_DATA",AxisSheet.EVENT_SELECT_CELL="EVENT_SELECT_CELL",AxisSheet=AxisSheet_1=__decorate([shortcut(),store$1(TableModel,{props(){return{reportSettingDetail:this.options.reportSettingDetail,reportFitAttr:this.options.reportFitAttr,tableData:this.options.tableData,frozen:this.options.frozen,viewAtCenter:this.options.viewAtCenter,activeBox:this.options.activeBox,loadData:e=>{var t;null===(t=this.sheet)||void 0===t||t.loadData(e),this.store.setTableMergedRowsAndCols(e)},tableCellGenerator:this.tableCellGenerator,tableStickerGenerator:this.tableStickerGenerator,tableWidth:this.options.tableWidth,tableHeight:this.options.tableHeight,screenWidth:this.options.screenWidth,webBackground:this.options.browserBg,forceRowChunk:this.options.forceRowChunk,simpleJson:this.options.simpleJson,widgetName:this.options.widgetName,externals:this.options.externals}}})],AxisSheet),function(e){function t(){var e;return _classCallCheck$1(this,t),(e=_callSuper$1(this,t,arguments)).eventNames=["CELL_DOUBLE_CLICK","CELL_CLICK"],e}_inherits$1(t,WidgetActiveHandler),_createClass$1(t)}(),function(e){function t(e,r){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).eventNames=["CELL_NODE_CLICK"],n.name="NODE_CLICK",n.merger="uniqe",n.cache=new Map,n.effectEntryMap=new Map,n.nodeDataFetcher=async()=>{},n.nodeDataFetcher=(null==r?void 0:r.nodeDataFetcher)||n.nodeDataFetcher,n}_inherits(t,AbstractCellHandler),_createClass(t,[{key:"setEffectEntryMap",value:function(e){(BI.isArray(e)?e:[e]).forEach((({key:e,value:t})=>{this.effectEntryMap.set(e,t)}))}},{key:"setCache",value:function(e){(BI.isArray(e)?e:[e]).forEach((({value:e,key:t})=>{this.cache.set(t,e)}))}},{key:"clearCache",value:function(){this.cache.clear()}},{key:"attach",value:function(){this.loading||this.externalContext.attach({type:BI.AbsoluteLayout.xtype,items:[{el:{type:Loading.xtype,ref:e=>{this.loading=e},cls:"transparent"},top:0,left:0,right:0,bottom:0}]})}},{key:"action",value:async function({open:e,id:t,eventName:r,layer:n}){this.attach();let o=this.externalContext.getTableData();if(r)if("NODE_COLLAPSE"===r){let t=0;o.forEach((e=>{e.forEach((({indent:e})=>{BI.isNotNull(e)&&(t=Math.max(t,e))}))}));for(let r=t;r>=Math.max(t-n,0);r--)for(const t of o)for(const n of t)n.id&&n.indent===r&&n.open===e&&(o=await this.getPageResults(o,n,e))}else if("NODE_COLLAPSE_TO"===r)for(const i of o)for(const t of i)t.id&&t.indent===n&&t.open===e&&(o=await this.getPageResults(o,t,e));else if("NODES_CLEAR_CACHE"===r)this.clearCache();else for(let i=0;i<n;i++){let t=!1;for(const r of o)for(const n of r)n.id&&n.indent===i&&n.open===e&&(o=await this.getPageResults(o,n,e)),t=t||!!BI.isNotNull(n.indent)&&n.indent>=i;if(!t)break}else{let r;if(o.some((e=>e.some((e=>e.id===t&&(r=e,!0))))),!r)return;o=await this.getPageResults(o,r,e)}this.externalContext.populate(o),this.loading.invisible()}},{key:"getPageResults",value:async function(e,t,r){let n;return t.id?(n=r?this.collapseRow(e,t.id):await this.expandRow(e,t.id),t.open=!r,n):e}},{key:"getNodeData",value:async function(e){var t,r,n;this.loading.visible();const o=null!==(n=null===(r=null===(t=this.externalContext.getExternals())||void 0===t?void 0:t.node)||void 0===r?void 0:r.nodeDataFetcher)&&void 0!==n?n:this.nodeDataFetcher,i=this.cache.get(e);if(i)return this.cache.delete(e),i;const a=await o({layer:e});return a?(a.effectEntries&&this.effectEntryMap.set(e,a.effectEntries),a.pageResult):[]}},{key:"expandRow",value:async function(e,t){const r=processRowExpandedData(e,await this.getNodeData(t),t),n=_expandRow(e,r),o=this.getEffectEntries(r,t),i=o.map((({targetId:e})=>e));return n.forEach((e=>{e.forEach((e=>{e.id&&i.includes(e.id)&&o.forEach((({targetId:t,effectRows:r})=>{e.id===t&&(e.position.rowSpan=(e.position.rowSpan||1)+r)}))}))})),n}},{key:"collapseRow",value:function(e,t){const{expanded:r,unexpanded:n}=splitPageResultsByRow(e,t),o=minimize(r,"y");n.forEach((e=>{e.forEach((e=>{e.position.y>=o&&(e.position.y-=r.length)}))})),this.cache.set(t,r);const i=this.getEffectEntries(r,t),a=i.map((({targetId:e})=>e));return n.forEach((e=>{e.forEach((e=>{e.id&&a.includes(e.id)&&i.forEach((({targetId:t,effectRows:r})=>{e.id===t&&e.position.rowSpan&&(e.position.rowSpan-=r)}))}))})),n}},{key:"getEffectEntries",value:function(e,t){const r=[t];e.forEach((e=>{e.forEach((e=>{e.id&&e.open&&r.push(e.id)}))}));return r.reduce(((e,t)=>e.concat(this.effectEntryMap.get(t)||[])),[])}}])}();class TableElement{constructor(e,t){__publicField(this,"viewElement"),__publicField(this,"wrapperElement"),__publicField(this,"tableElement"),__publicField(this,"contentElement"),__publicField(this,"toolbarElement"),__publicField(this,"toolbarRoot"),this.viewElement=createWorkbookViewElement();const{wrapper:r,tableElement:n,content:o}=createWorkbookContentElement();this.wrapperElement=r,this.tableElement=n,this.contentElement=o,this.toolbarElement=document.createElement("div"),this.resize(t),this.viewElement.appendChild(this.toolbarElement),this.viewElement.appendChild(this.wrapperElement),e.appendChild(this.viewElement)}get el(){return this.tableElement}clearNodes(){if(this.tableElement.hasChildNodes()){const{childNodes:e}=this.tableElement;for(let t=e.length-1;t>=0;t--)this.tableElement.removeChild(e.item(t))}}renderToolbar({theme:e,pageContext:t,config:r,isZoomed:n,onExcelExport:o,onToggleZoom:i}){var a,s,l;if(r&&(null==(a=r.buttonGroups)?void 0:a.flat().some((e=>e.enable)))){this.toolbarRoot||(this.toolbarRoot=createRoot$1(this.toolbarElement)),this.toolbarElement.className="workbook-toolbar-container",setWorkbookViewClassName(this.viewElement,"workbook-wrapper-".concat(r.position));const a={"--toolbar-page-button-tying-color":e.colors.at(0),"--toolbar-background-color":r.toolbarBackground||DEFAULT_TOOLBAR_LIGHT_BACKGROUND};null==(s=this.toolbarRoot)||s.render(jsx(Toolbar$1,{isZoomed:n,disabled:!1,pageIndex:t.current,pageContext:t,buttonGroups:r.buttonGroups.map((e=>e.filter((e=>e.enable)))).filter((e=>e.length>0)),style:a,toolbarStyleSettings:getWorkbookToolbarSetting(r.toolbarButtonStyle),onExcelExport:o,onToggleZoom:i}))}else setWorkbookViewClassName(this.viewElement),null==(l=this.toolbarRoot)||l.unmount(),this.toolbarRoot=void 0,this.toolbarElement.className=""}resize(e){const t=void 0===e.height?"100%":"".concat(e.height,"px");void 0!==e.scale?(this.wrapperElement.style.width="".concat(e.width,"px"),this.wrapperElement.style.height=t,this.wrapperElement.style.transform="scale(".concat(1/e.scale,")")):(this.wrapperElement.style.removeProperty("transform"),this.wrapperElement.style.removeProperty("width"),this.wrapperElement.style.removeProperty("height")),this.contentElement.style.width="".concat(e.width,"px"),this.contentElement.style.height=t}destroy(){var e;null==(e=this.toolbarRoot)||e.unmount(),this.toolbarRoot=void 0,this.clearNodes(),this.viewElement.remove()}}function setWorkbookViewClassName(e,t){e.className=classNames$1("workbook-view",t)}function createWorkbookViewElement(){const e=document.createElement("div");return setWorkbookViewClassName(e),e}function createWorkbookContentElement(){const e=document.createElement("div");e.className="workbook-wrapper";const t=document.createElement("div");t.className="workbook-content",e.appendChild(t);const r=document.createElement("div");return r.className="d-workbook",t.appendChild(r),{wrapper:e,tableElement:r,content:t}}function getWorkbookExternals(e,t){const r=()=>Object.fromEntries(t.special.getComputedParams());return{attachPrefix:getAttachPrefix(),chart:{changeParameter:(e,t)=>e.changeParameter(mergeTableChartParams({chartParams:t,paramsGetter:r})),chartHyperLinkFetcher:n=>t.fetch.executeChartHyperlinkInWidget(e,mergeTableChartParams({chartParams:n,mergeKey:"linkParas",paramsGetter:r})),chartDataFetcher:r=>t.fetch.getChartDataInWidget(e,r)}}}class FilterClickHandler extends AbstractCellHandler{constructor(e,t){super(e),__publicField(this,"eventNames",["CELL_FILTER_CLICK"]),__publicField(this,"merger","uniqe"),__publicField(this,"name","CELL_FILTER"),__publicField(this,"reportContext"),this.reportContext=t}action({headerArea:e,sortArea:t,sortRule:r,index:n,direction:o}){const i=this.reportContext.reportName.toUpperCase();this.reportContext.updateReport({sessionHeaderSortInfo:{headerArea:e,sortArea:t,reportBlock:i,sortRule:r,index:n,direction:o}})}}function getWorkbookLinkConfig(e){return{parameter:{init(e){this.parameters=e.parameters},excute(){const t=mapValues$1(keyBy$1(this.parameters,"name"),"value");e.emit("parameterLinkage",{parameters:t})}},weblink:{init(e){const{width:t,height:r,attr:n}=e;this.parameters=e.parameters,this.target=e.targetFrame,this.url=e.url,this.title=e.name,this.byPost=e.byPost,this.extendParameters=e.extendParameters,this.modalProps={width:t,height:r,...n}},excute(){e.emit("hyperlink",{url:this.url,title:this.title,parameters:this.parameters,target:this.target,byPost:this.byPost,extendParameters:this.extendParameters,modalProps:this.modalProps})}},formHyperlink:{init(e){const{parameters:t,relatedEditorName:r}=e;this.parameters=t,this.widgetID=r,this.silent=!0},excute(){const t=mapValues$1(keyBy$1(this.parameters,"name"),"value");e.emit("parameterLinkage",{parameters:t,target:[this.widgetID]})}},viewlet:{init(e){const{width:t,height:r,name:n,attr:o,parameters:i,byPost:a,reportUrl:s="",targetFrame:l,showParameterInterface:c,extendParameters:u}=e,d=mapValues$1(keyBy$1(i,"name"),"value");this.target=isTargetType(l)?l:TARGET_TYPE.BLANK,this.title=n,this.byPost=a,this.extendParameters=u,this.modalProps={width:t,height:r,...o};const h=isUndefined$3(c)?null:{__pi__:c};this.url=h?addSearchParamToUrl(s,h):s,this.parameters={...d,...h}},excute(){e.emit("hyperlink",{url:this.url,title:this.title,parameters:{__parameters__:this.parameters},target:this.target,byPost:this.byPost,extendParameters:this.extendParameters,modalProps:this.modalProps})}}}}function isTargetType(e){return Object.values(TARGET_TYPE).includes(e)}class WorkbookWidget{constructor(e){__publicField(this,"tempState",{hidePages:new Set}),__publicField(this,"lastConfig",null),__publicField(this,"scrollAction"),this.fvs=e}static init(){setTableEnvConfig()}mount(e){return{tableElement:new TableElement(e.el,e.state)}}render({tableElement:e,config:t,state:r,theme:n}){return this.updateToolbar({tableElement:e,config:t,theme:n,state:r}),this.lastConfig&&this.lastConfig.configFile===t.configFile&&this.lastConfig.fitState===t.fitState?(this.tempState.table&&t.marquee!==this.lastConfig.marquee&&this.updateMarquee(t.marquee,this.tempState.table),this.lastConfig=t,Promise.resolve()):(this.lastConfig=t,e.clearNodes(),this.createWorkbook(e.el,r,t).then((e=>{this.tempState.table=e,this.updateMarquee(t.marquee,e)})))}refresh({tableElement:e,config:t,state:r,theme:n}){this.lastConfig=t;const{table:o}=this.tempState,i=getTableConfig(t,r,this.fvs);this.updateToolbar({tableElement:e,config:t,theme:n,state:r}),null==o||o.refreshTable(i)}resize({tableElement:e,config:t,state:r,theme:n}){const{table:o}=this.tempState,{width:i,height:a=0}=r,[s,l]=[Math.floor(i),Math.floor(a)];this.updateToolbar({tableElement:e,config:t,theme:n,state:r}),null==o||o.refreshTable({tableWidth:s,tableHeight:l,reportFitAttr:getReportFitAttr(t,r.scale)})}save(){return this.tempState}restore(e){this.tempState=e}updateToolbar({tableElement:e,config:t,theme:r,state:n}){const{hidePages:o}=t;this.tempState.hidePages=new Set(o);const i=this.createPageContext(t.configFile.pageIndex,t.configFile.totalPage);e.resize(n),e.renderToolbar({theme:r,pageContext:i,config:t.toolbar,isZoomed:this.fvs.special.isZoomed,onExcelExport:e=>{this.fvs.fetch.exportExcel({type:e,name:n.name})},onToggleZoom:()=>{var e,t;null==(t=(e=this.fvs.special).toggleZoom)||t.call(e)}})}createWorkbook(e,t,r){const n=getTableConfig(r,t,this.fvs);return new Promise((o=>{BI.createWidget({...n,type:AxisSheet.xtype,element:e,sheetIndex:0,supportCSSTransform:!0,minDpr:2,ref:e=>{e.addHandler(FilterClickHandler,{reportName:t.name,updateReport:e=>{this.fvs.refresh({pageIndex:r.configFile.pageIndex},e)}}),o(e)},viewAtCenter:!1,browserBg:{},reportActions:[],activeBox:!0,stickerConfig:{state:!1},linkConfig:getWorkbookLinkConfig(this.fvs)})}))}createPageContext(e,t){const r=this.tempState.hidePages;return new PageContext({getPages:()=>list(t-1).map((e=>({index:e+1,visible:!r.has(e+1)}))),getCurrent:()=>e},{goto:(e,t)=>{this.fvs.refresh({pageIndex:e.index},t)},setVisible:(e,t)=>{t?r.delete(e.index):r.add(e.index)}})}updateMarquee(e,t){this.clearMarquee();const r=new ScrollAction(e,t);e&&"open"in e?e.open?r.startInternal(e.options):r.stopInternal():(r.setConfig(e),r.start()),this.scrollAction=r}clearMarquee(){var e;null==(e=this.scrollAction)||e.stop(),this.scrollAction=void 0}unmount({tableElement:e}){this.lastConfig=null,this.clearMarquee(),e.destroy()}}function getTableConfig(e,t,r){const{configFile:n}=e,o=getReportFitAttr(e,t.scale);return{tableData:n.pageResult,tableWidth:t.width,tableHeight:t.height,widgetName:t.name,reportSettingDetail:{paperSetting:{orientation:0,paperWidth:t.width,paperHeight:t.height,marginLeft:0,marginRight:0,marginTop:0,marginBottom:0},verticalCenter:!1,horizontalCenter:!1,background:{background:"none"},headerHeight:0,footerHeight:0},reportFitAttr:o,frozen:n.frozen,forceRowChunk:{isForceRowChunk:getFitCode(o.fitStateInPC)===WORKBOOK_FIT_MODE.WIDTH||getFitCode(o.fitStateInPC)===WORKBOOK_FIT_MODE.NONE,rowChunkSize:50},simpleJson:r.special.simpleJson,externals:getWorkbookExternals(t.name,r)}}function getReportFitAttr(e,t){var r,n;return{fitFont:void 0!==t||e.configFile.reportFitAttr.fitFont,fitStateInPC:getFitCode(null!=(n=null!=(r=e.fitState)?r:e.configFile.reportFitAttr.fitStateInPC)?n:WORKBOOK_FIT_MODE.WIDTH)}}function useWorkBookMarquee(e){return reactExports.useMemo((()=>e.isPreview?e.marquee:{open:!1}),[e.marquee,e.isPreview])}WorkbookWidget.init();const WorkbookWidgetView$1=observer((({model:e,width:t,height:r=0,adaptiveScale:n})=>{const{isZoomed:o,renderMode:i,showToolbar:a}=e,s=reactExports.useMemo((()=>({width:t,height:r-(a?WORKBOOK_TOOLBAR_HEIGHT:0)})),[r,a,t]),l=reactExports.useMemo((()=>{if((o||"fitSize"===i)&&n)return convertAdaptiveScaleToTransformScale(n)}),[i,n,o]),c=l?{width:l*s.width,height:l*s.height}:s,u=useWorkBookMarquee(e),d=reactExports.useMemo((()=>e.options?{configFile:e.options,marquee:u,hidePages:e.hidePages}:null),[e.options,u,e.hidePages]),h=reactExports.useMemo((()=>({width:c.width,height:c.height,scale:_isNumber(l)?l:void 0})),[c.width,c.height,l]),p=useClassWidget({widgetClass:WorkbookWidget,model:e,computed:d,state:h}),f=reactExports.useMemo((()=>({...convertInnerBorderRadiusStyle(e.borderLine,e.borderRadius),position:"relative"})),[e.borderLine,e.borderRadius]);return jsxs(Fragment,{children:[jsx("div",{ref:p,style:{width:"100%",height:"100%",...f}}),!e.isPreview&&jsx("div",{className:"widget-masker"})]})})),ToolbarComponent=({isZoomed:e,pageIndex:t,pageContext:r,className:n,showPaginationButton:o,showZoomButton:i,toggleZoom:a})=>{const s=Pagination$1.usePagination(),l=r.indexToVisibleIndex(t);return jsxs("div",{className:classNames$1("workbook-toolbar",n),children:[o&&jsx(PaginationTool,{value:l,total:r.visibleTotal,pageClassName:"workbook-toolbar-page",preIcon:"fdm-hollow-triangle-up",nextIcon:"fdm-hollow-triangle-down",preDisabled:1===l,nextDisabled:l===r.visibleTotal,onPre:()=>{r.getPreviousPage().goto()},onNext:()=>{r.getNextPage().goto()},onPage:()=>{s.open({page:r.indexToVisibleIndex(t),total:r.visibleTotal,onPage:e=>{const t=r.visibleIndexToIndex(e);t&&r.getPage(t).goto()}})},size:18}),i&&jsx(Icon,{className:"toolbar-button",name:e?"fdm-zoom-out":"fdm-zoom-in",onClick:a,size:18})]})},mobileChartFetcherAdaptor=async(e,t="")=>{const r=await e,n=get$6(r,t,r);return get$6(n,"options",[n]).forEach((e=>{e.mobile=!0,e.tools=e.tools.enabled&&e.tools.sort.enabled?DEFAULT_TOOL_CONFIG:DISABLED_TOOL_CONFIG})),r};function getToolbarVisibleStatus(e,t){const r=getParamInURL(MOBILE_UNIQUE_PARAMS.FINE_WEBVIEW),n=getZoomButtonVisibleStatus(e);return(getPaginationButtonVisibleStatus(e,t)||n)&&"true"!==r}function getZoomButtonVisibleStatus(e){return null==e?void 0:e.flat().some((e=>e.type===TOOLBAR_BUTTON_TYPE$2.ZOOM&&e.enable))}function getPaginationButtonVisibleStatus(e,t){return(null==e?void 0:e.flat().some((e=>e.type===TOOLBAR_BUTTON_TYPE$2.PAGE&&e.enable)))&&t>1}function getToolbarStyle(e,t){return{"--toolbar-page-button-tying-color":first$1(e),"--toolbar-background-color":t||DEFAULT_TOOLBAR_LIGHT_BACKGROUND}}function getToolbarStyleSettings(e){return(null!=e?e:TOOLBAR_BUTTON_STYLE.LIGHT)===TOOLBAR_BUTTON_STYLE.LIGHT?TOOLBAR_SETTINGS_LIGHT:TOOLBAR_SETTINGS_DARK}const DEFAULT_TOOL_CONFIG={enabled:!0,hidden:!1,sort:{enabled:!0},fullScreen:{enabled:!1},toImage:{enabled:!1}},DISABLED_TOOL_CONFIG={enabled:!0};function createEmailHyperlinkConfig(e){return{execute(){e.fetch.sendEmail(this.emailConfig).then((({status:t})=>{"error"===t?Toast.show({icon:"fail",content:e.i18n.t("Duchamp-Send_Email_Fail")}):Toast.show({icon:"success",content:e.i18n.t("Duchamp-Send_Email_Success")})}))},init(e){this.emailConfig=e}}}function createFormHyperlinkConfig(e){return{directExecution:()=>!0,execute(){var t;e.emit("parameterLinkage",{parameters:null!=(t=this.parameters)?t:{},target:[this.widgetID]})},init(e){const{parameters:t,related:r}=e;this.parameters=t,this.widgetID=r}}}const createJavaScriptConfig=e=>({execute(){var t;const r=convertToRecord(null!=(t=this.parameters)?t:[]);e.emit("javascript",{code:this.jsContent,params:r,skipDocumentVerify:!0})},init(e){this.jsContent=e.script,this.parameters=e.parameters}}),createMobileHyperlinkPopupConfig=e=>({execute(){e.special.showMobilePopup(this.config)},init(e){const{setting:t,byPost:r}=e;"template"===e.target?this.config={parameters:e.parameters,target:e.target,extendParameters:e.extendParameters,...t,byPost:r}:this.config={parameters:e.parameters,target:e.target,extendParameters:e.extendParameters,...e.setting}}}),createParameterHyperlinkConfig=e=>({execute(){e.emit("parameterLinkage",{parameters:this.parameters})},init(e){this.parameters=e.parameters}}),createUnknownHyperlinkConfig=e=>({execute(){this.jsContent&&e.emit("javascript",{code:this.jsContent,params:{},skipDocumentVerify:!0})},init(e){const t=e.javaScript;for(const r in t){const e=t[r];if(isString$4(e)&&e.includes("FR.tc(")){this.jsContent=e;break}}}});function createViewletHyperlinkConfig(e){return{execute(){e.emit("hyperlink",{url:this.url,title:"",parameters:this.parameters,target:this.target,byPost:this.byPost,extendParameters:this.extendParameters})},async init(t){const{reportlet:r,parameters:n,target:o,method:i="GET",__pi__:a,extendParameters:s}=t,l=await e.fetch.executePathInput2Url(r),[c,u]=filterParamsWithUniqueKeys(n);this.target=o,this.byPost="POST"===i||!1,this.url=l,this.parameters={...c,__parameters__:{...u,__pi__:a}},this.extendParameters=s}}}function filterParamsWithUniqueKeys(e,t=MOBILE_UNIQUE_PARAMS){const r=Array.isArray(e)?convertToRecord(e):e,n=Object.values(t);return[pick$1(r,n),omit$2(r,n)]}function createWebLinkHyperlinkConfig(e){return{execute(){const{url:t,parameters:r,target:n,extendParameters:o}=this.config;e.emit("hyperlink",{url:t,title:"",parameters:r,target:n,extendParameters:o})},init(e){this.config={url:e.url,parameters:e.parameters,target:e.target,extendParameters:e.extendParameters}}}}const{FORM_HYPERLINK:FORM_HYPERLINK,WEB_LINK:WEB_LINK,VIEWLET:VIEWLET,JAVASCRIPT:JAVASCRIPT,MOBILE_POPUP:MOBILE_POPUP,EMAIL:EMAIL,UNKNOWN:UNKNOWN,PARAMETER:PARAMETER}=Report$1.HYPERLINK;function createHyperlinkConfig(e){return{[WEB_LINK]:createWebLinkHyperlinkConfig(e),[VIEWLET]:createViewletHyperlinkConfig(e),[JAVASCRIPT]:createJavaScriptConfig(e),[MOBILE_POPUP]:createMobileHyperlinkPopupConfig(e),[EMAIL]:createEmailHyperlinkConfig(e),[UNKNOWN]:createUnknownHyperlinkConfig(e),[FORM_HYPERLINK]:createFormHyperlinkConfig(e),[PARAMETER]:createParameterHyperlinkConfig(e)}}const EFFECT_TYPE={HIGHT_LIGHT_ROW:"highlightRow",HIGHT_LIGHT_COL:"highlightCol",HIGHT_LIGHT_CROSS:"highlightCross",HIGHT_LIGHT_CELL:"highlightCell",SET_CELL_FONT:"setCellFont",SET_ROW_FONT:"setRowFont"},TABLE_FIT_MODE={HEIGHT:6,WIDTH:1,WIDTH_HEIGHT:2,NONE:3},MOBILE_TABLE_FIT_MODE={HEIGHT:String(TABLE_FIT_MODE.HEIGHT),WIDTH:String(TABLE_FIT_MODE.WIDTH),WIDTH_HEIGHT:String(TABLE_FIT_MODE.WIDTH_HEIGHT),NONE:String(TABLE_FIT_MODE.NONE)},DEFAULT_DATA={pageResult:[],totalPage:1,pageIndex:1},FIT_STATE_TO_REPORT_FIT={[MOBILE_TABLE_FIT_MODE.HEIGHT]:{horFit:Report$1.FIT_TYPE.PORTRAIT,verFit:Report$1.FIT_TYPE.PORTRAIT},[MOBILE_TABLE_FIT_MODE.WIDTH]:{horFit:Report$1.FIT_TYPE.LANDSCAPE,verFit:Report$1.FIT_TYPE.LANDSCAPE},[MOBILE_TABLE_FIT_MODE.WIDTH_HEIGHT]:{horFit:Report$1.FIT_TYPE.CROSS,verFit:Report$1.FIT_TYPE.CROSS},[MOBILE_TABLE_FIT_MODE.NONE]:{horFit:Report$1.FIT_TYPE.NONE,verFit:Report$1.FIT_TYPE.NONE}},RICH_TEXT_CLASSNAME="unreset-cell",createMarqueeData=e=>e&&"content"in e?{mode:e.content===MARQUEE_CONTENT.ITEM?"item":"page",to:e.direction,speed:e.speed,stay:timeUnitToSecond(e.stay),stopOnHover:e.stopOnHover}:e,TableComponent=reactExports.forwardRef(((e,t)=>{const{options:r,fitState:n,tableSize:o,marquee:i,widgetName:a,lineHeight:s,scalable:l,headerSort:c,linkParamsGetter:u}=e,d=useFVS(),h=reactExports.useRef(null),p=()=>{var e,t;return null==(t=null==(e=h.current)?void 0:e.getJSAPI)?void 0:t.call(e)},f=(e,t)=>{var r;return null==(r=p())?void 0:r.getCell(e,t)},g=e=>{var t;return null==(t=p())?void 0:t.getRow(e)},m=e=>{var t;return null==(t=p())?void 0:t.getColumn(e)},y=()=>{var e;return null==(e=p())?void 0:e.getRowCount()},v=()=>{var e;return null==(e=p())?void 0:e.getColumnCount()},_=(e,t)=>{var r;return null==(r=p())?void 0:r.getCell(e,t).getValue()},b=(e,t,r)=>{var n;null==(n=p())||n.getCell(e,t).model.setValue(r)},C=(e,t)=>{var r;null==(r=p())||r.scrollTo({x:e,y:t})},E=()=>{var e;return null==(e=p())?void 0:e.getScrollOffset()},T=e=>{var t,r;return null==(r=null==(t=h.current)?void 0:t.getCell)?void 0:r.call(t,e)},S=(e,t={})=>{var r;const{color:n,style:o,single:i=!0}=t;null==(r=p())||r.addEffect(e,{color:n,style:o,single:i})},P=(e,t)=>S(EFFECT_TYPE.HIGHT_LIGHT_ROW,{color:e,single:t}),w=(e,t)=>S(EFFECT_TYPE.HIGHT_LIGHT_COL,{color:e,single:t}),x=(e,t=!0)=>S(EFFECT_TYPE.HIGHT_LIGHT_CROSS,{color:e,single:t}),O=(e,t=!0)=>S(EFFECT_TYPE.HIGHT_LIGHT_CELL,{color:e,single:t}),$=(e,t)=>S(EFFECT_TYPE.SET_CELL_FONT,{style:e,single:t}),I=(e,t)=>S(EFFECT_TYPE.SET_ROW_FONT,{style:e,single:t}),R=function(){console.info("This jsAPI is not yet supported on mobile")};reactExports.useImperativeHandle(t,(()=>({resize:R,populate:R,setReportFitAttr:R,setCellRadius:R,addMouseEventHandler:R,addPopoverEffect:R,setHScrollBarVisible:R,setVScrollBarVisible:R,setRowHeight:R,setColWidth:R,getChart:T,getCell:f,getRow:g,getColumn:m,getRowCount:y,getColumnCount:v,getCellValue:_,setCellValue:b,getCellVal:_,setCellVal:b,scrollTo:C,getScrollOffset:E,addHighlightRowEffect:P,addHighlightRowHoldEffect:e=>P(e,!1),addHighlightColEffect:w,addHighlightColHoldEffect:e=>w(e,!1),addHighlightCrossEffect:x,addHighlightCrossHoldEffect:e=>x(e,!1),addHighlightCellEffect:O,addHighlightCellHoldEffect:e=>O(e,!1),addSetCellFontEffect:$,addSetCellFontHoldEffect:e=>$(e,!1),addSetRowFontEffect:I,addSetRowFontHoldEffect:e=>I(e,!1)}))),reactExports.useEffect((()=>{var e;if(i&&r&&p())return"open"in i?i.open?setTimeout((()=>{var e;null==(e=p())||e.startMarquee(createMarqueeData(i.options))})):null==(e=p())||e.stopMarquee():i.enable&&setTimeout((()=>{var e;null==(e=p())||e.startMarquee(createMarqueeData(i))})),()=>{var e;null==(e=p())||e.stopMarquee()}}),[i,r]);const A=reactExports.useCallback((()=>Object.fromEntries(d.special.getComputedParams())),[d]);return jsx(Report$1,{ref:h,options:{fitConfig:FIT_STATE_TO_REPORT_FIT[n],data:r||{...DEFAULT_DATA},ecName:a,externals:{chart:{chartHyperLinkFetcher:e=>d.fetch.executeChartHyperlinkInWidget(a,mergeTableChartParams({chartParams:e,mergeKey:"linkParas",paramsGetter:A})),chartDataFetcher:e=>mobileChartFetcherAdaptor(d.fetch.getChartDataInWidget(a,e),"chartAttr"),chartRelatedFetcher:e=>mobileChartFetcherAdaptor(d.fetch.refreshChartInWidget(a,mergeTableChartParams({chartParams:e,mergeKey:"__parameters__",paramsGetter:u})),"relateChartList[0].chartAttr"),chartAutoRefreshFetcher:e=>mobileChartFetcherAdaptor(d.fetch.refreshChartInWidget(a,{...e,op:"chartauto",cmd:"chart_auto_refresh",sheetIndex:0}))},headerSortFetcher:c,richText:{defaultLineHeight:s,className:RICH_TEXT_CLASSNAME}},linkConfig:createHyperlinkConfig(d)},scaleable:l,scrollable:!0,style:{...o}},n)}));TableComponent.displayName="TableComponent";const REPORT_TOOLBAR_HEIGHT=32,Workbook=e=>{var t,r,n,o,i,a,s,l,c,u;const{config:d,state:h,theme:p}=e,{height:f}=h,g=useFVS(),m=useTempStorage({hidePages:new Set,table:null}),{totalPage:y,pageIndex:v}=d.configFile,_=reactExports.useRef(null),[b,C]=reactExports.useState(!1),E=useSize_1(_);reactExports.useEffect((()=>{E.width&&!b&&C(!0)}),[E.width,b]);const T=reactExports.useMemo((()=>{const e=new Set(d.hidePages);return new PageContext({getPages:()=>list(y-1).map((t=>({index:t+1,visible:!e.has(t+1)}))),getCurrent:()=>v},{goto:(e,t)=>{g.refresh({pageIndex:e.index},t)},setVisible:(e,t)=>{const r=m.get("hidePages");t?r.delete(e.index):r.add(e.index)}})}),[y,m,v,g,d.hidePages]),S=null!=(r=null==(t=d.toolbar)?void 0:t.buttonGroups)?r:[],P=getToolbarVisibleStatus(S,T.visibleTotal),w=reactExports.useMemo((()=>f?{width:E.width||0,height:P?f-REPORT_TOOLBAR_HEIGHT:f}:{width:E.width||0}),[f,P,E.width]);return jsxs("div",{ref:_,className:classNames$1("mobile-workbook-wrapper",(null==(n=d.toolbar)?void 0:n.position)&&"workbook-toolbar-position-".concat(d.toolbar.position)),style:{"--workbook-toolbar-size":"".concat(REPORT_TOOLBAR_HEIGHT,"px"),...getToolbarStyle(p.colors,null==(o=d.toolbar)?void 0:o.toolbarBackground)},children:[P&&jsx(ToolbarComponent,{className:getToolbarStyleSettings(null==(i=d.toolbar)?void 0:i.toolbarButtonStyle).toolbarClass,showPaginationButton:getPaginationButtonVisibleStatus(S,T.visibleTotal),showZoomButton:getZoomButtonVisibleStatus(S),isZoomed:g.special.isZoomed,toggleZoom:()=>{var e,t;return null==(t=(e=g.special).toggleZoom)?void 0:t.call(e)},pageIndex:v,pageContext:T}),jsx(TableComponent,{ref:e=>{e&&m.set("table",e)},options:d.configFile,marquee:null!=(a=d.marquee)?a:{open:!1},fitState:d.fitState,widgetName:h.name,headerSort:e=>{var t;const{sortRule:r,sortItems:n,sortItemType:o,reportBlock:i,...a}=e;return g.refresh((e=>e),{sessionHeaderSortInfo:{...a,reportBlock:i.toUpperCase(),sortItemType:o,sortRule:null==(t=n.find((e=>e.description===r)))?void 0:t.type}}),Promise.reject()},tableSize:w,linkParamsGetter:()=>Object.fromEntries(g.special.getComputedParams()),lineHeight:null!=(s=d.lineHeight)?s:"normal",scalable:null!=(u=null==(c=null==(l=d.previewConfig)?void 0:l.pinchToZoom)?void 0:c.enable)&&u},b?"1":"2")]})},WorkbookWidgetView=observer((({model:e,width:t,height:r})=>{const n=reactExports.useMemo((()=>({width:t,height:r,scalable:e.scalable,name:e.name})),[t,r,e.scalable,e.name]),o=useWorkBookMarquee(e);return e.options?jsxs(FVSWidgetProvider,{model:e,children:[jsx(Workbook,{theme:e.theme,state:n,config:{...e.props,marquee:o,fitState:e.fitState,configFile:e.options,hidePages:e.hidePages}}),!e.isPreview&&jsx("div",{className:"widget-masker"})]}):jsx(Fragment,{})})),reuseCompatibleWarning=e=>new Promise((t=>{switch(e.envVersionFlag){case 2:return void Alert$2.warning({title:duchampIntl.get("Duchamp-Reuse_Version_Compatible_Title"),content:duchampIntl.get("Duchamp-Reuse_Version_Compatible_Tip",e.envVersion),onOk:()=>{t(!0)}});case 3:return void Alert$2.warning({title:duchampIntl.get("Duchamp-Reuse_Version_Compatible_Title"),content:duchampIntl.get("Duchamp-Reuse_Version_Incompatible_Tip",e.envVersion),onOk:()=>{t(!1)}});default:return void t(!0)}}));function isRuleWhiteType(e,t){return"none"!==t&&(Array.isArray(t)?t.includes(e):!isRegExp(t)||t.test(e))}function isRuleBlockType(e,t){return"*"===t||(Array.isArray(t)?t.includes(e):!!isRegExp(t)&&t.test(e))}function checkRules(e,t="",r=""){for(const n of e){const{valid:e,tip:t=r}=isFunction$8(n)?n():{valid:n.validate(),tip:n.tip};if(!e)return{valid:!1,tip:t}}return{valid:!0,tip:t}}function isValidChildrenForParent(e,t,r=[]){var n,o,i;const a=null==t?void 0:t.meta,s=null==(n=null==a?void 0:a.configure)?void 0:n.acceptRule,l=null!=(o=null==t?void 0:t.type)?o:"canvas",c=(null==a?void 0:a.displayName)||"",u=t?[...t.parentWidgets||[],t].reverse():[];return checkRules([...r,...(Array.isArray(e)?e:[e]).map((e=>{var t,r,n,o,i;const[a,c]="string"==typeof e?[widgetManager.getWidgetByName(e),e]:[e.meta,e.type],d=null==(t=null==a?void 0:a.configure)?void 0:t.acceptRule;return[{validate:()=>{var e;return isRuleWhiteType(c,null==(e=null==s?void 0:s.childWhitelist)?void 0:e.rule)},tip:null==(r=null==s?void 0:s.childWhitelist)?void 0:r.tip},{validate:()=>{var e;return!isRuleBlockType(c,null==(e=null==s?void 0:s.childBlocklist)?void 0:e.rule)},tip:null==(n=null==s?void 0:s.childBlocklist)?void 0:n.tip},{validate:()=>{var e;return isRuleWhiteType(l,null==(e=null==d?void 0:d.parentWhitelist)?void 0:e.rule)},tip:null==(o=null==d?void 0:d.parentWhitelist)?void 0:o.tip},{validate:()=>{var e;return!isRuleBlockType(l,null==(e=null==d?void 0:d.parentBlocklist)?void 0:e.rule)},tip:null==(i=null==d?void 0:d.parentBlocklist)?void 0:i.tip},...u.map((t=>{var r,n,o;const i=null==(r=t.meta.configure)?void 0:r.acceptRule;return[{validate:()=>{var r,n,o;return null==(o=null==(n=null==(r=null==i?void 0:i.contextWhitelist)?void 0:r.rule)?void 0:n.call(r,e,t))||o},tip:null==(n=null==i?void 0:i.contextWhitelist)?void 0:n.tip},{validate:()=>{var r,n,o;return!(null!=(o=null==(n=null==(r=null==i?void 0:i.contextBlocklist)?void 0:r.rule)?void 0:n.call(r,e,t))&&o)},tip:null==(o=null==i?void 0:i.contextBlocklist)?void 0:o.tip}]})).flat()]})).flat()],(null==(i=null==a?void 0:a.configure)?void 0:i.acceptTip)||duchampIntl.get("Duchamp-Release_Into_The_Component",c),duchampIntl.get("Duchamp-Not_Support_The_Component_Tip",c))}function isNodeDraggable(e,t){var r,n;const o=null==(n=null==(r=e.meta)?void 0:r.configure)?void 0:n.draggable;return!!isNil$3(o)||(isFunction$8(o)?o(t):o)}function isNodeCopyable(e){var t,r,n;return null==(n=null==(r=null==(t=e.meta)?void 0:t.configure)?void 0:r.copyable)||n}var baseMerge=_baseMerge,isObject=isObject_1$1;function customDefaultsMerge$1(e,t,r,n,o,i){return isObject(e)&&isObject(t)&&(i.set(t,e),baseMerge(e,t,void 0,customDefaultsMerge$1,i),i.delete(t)),e}var _customDefaultsMerge=customDefaultsMerge$1,apply=_apply$1,baseRest=_baseRest$1,customDefaultsMerge=_customDefaultsMerge,mergeWith=mergeWith_1,defaultsDeep=baseRest((function(e){return e.push(void 0,customDefaultsMerge),apply(mergeWith,void 0,e)})),defaultsDeep_1=defaultsDeep;const defaultsDeep$1=getDefaultExportFromCjs$1(defaultsDeep_1);function splitModalAnimationAction(e){if(has$2(e,"animations")&&e.animations.length>0){const t=splitActionByProperty(e,"widget"),r=flatMap$1(t,(e=>splitActionByProperty(e,"isDelay"))),n=forEach$3(r,(e=>e.animations=handleNumberToTimeUnit(e.animations))),o=flatMap$1(n,(e=>splitActionByProperty(e,(e=>{var t;return _isNumber(e.delayTime)?e.delayTime:null==(t=e.delayTime)?void 0:t.type}))));return handleCreateUniqueAction(flatMap$1(o,(e=>splitActionByProperty(e,(e=>{var t;return _isNumber(e.delayTime)?e.delayTime:null==(t=e.delayTime)?void 0:t.value})))))}return[e]}function splitActionByProperty(e,t){return map$3(groupBy(e.animations,t),(t=>({...e,animations:t})))}function handleNumberToTimeUnit(e){return map$3(e,(e=>(_isNumber(e.delayTime)&&(e.delayTime={type:TIME_UNIT$1.MILLISECOND,value:e.delayTime}),e)))}function handleCreateUniqueAction(e){const t=[];return map$3(e,((e,r)=>{if(0===r)return e;const n=createUniqueName(t,"".concat(e.name,"_c"));return t.push(n),{...e,id:uuid$1(),name:n}}))}function getWidgetDefaultStyleProps({widgetType:e,styleType:t="default",defaultProps:r,widgetManager:n,themeVars:o}){var i;if(!n)return{};const a=n.getExtendStyle(e,t);return a?{styleType:t,styleConfig:merge$1({},r,null==a?void 0:a.props,null==(i=null==a?void 0:a.themeTransfer)?void 0:i.call(a,o))}:{}}function generateWidgetCreationData({parentWidget:e,...t},{story:r,themeVars:n}){var o,i;const a=null==widgetManager?void 0:widgetManager.getWidgetByName(t.type);if(!a)throw new Error("Widget ".concat(t.type," not found"));const s=Object.assign(Object.create(null),a,t),l=(r.widgets||[]).map((e=>e.name)),c=null==(o=a.configure)?void 0:o.defaultName,u=null!=(i=isFunction$8(c)?c(l,r,e):c)?i:createUniqueName(l,s.displayName.replace(/[\r\n]/g,""),"_".concat(r.name)),d=omit$1(s,["component","configuration","initialization","beforeCreate","model","dependencies","configure","mainGroupName","displayName","icon","iconfont","dragPreviewImage","mobileConfig"]);return handleWidgetCreationDataWithTheme({themeVars:n,widgetManager:widgetManager,widgetData:{...d,type:t.type,name:u,refresh:generateRefresh(s.refresh),props:{...getPropsFromConfig(s.configuration instanceof Array?s.configuration:[]),...s.props}}})}function handleWidgetCreationDataWithTheme({widgetData:e,themeVars:t,widgetManager:r}){if(!t)return e;if(widgetIsController(e)){const n=getWidgetDefaultStyleProps({widgetManager:r,themeVars:t,widgetType:e.type});return{...e,borderLine:{...DEFAULT_BORDER_LINE,...e.borderLine,borderColor:t.borderColorNormal},props:{...e.props,...n}}}return widgetIsQueryButton(e)?{...e,border:{type:"color",value:t.colorPrimary},props:{...e.props,color:t.fontColorHighLight}}:e}function generateRefresh(e){return!1!==e&&{open:!1,interval:DEFAULT_REFRESH_INTERVAL,...e}}const VERSION_REVERSE={"0.0.1":!0},fixImageButtonIcons=(e,t)=>{const r=get$5(e,t,[]),n=reduce(get$5(e,"mobile.".concat(t),[]),((e,t,r)=>(e[+r]=t,e)),[]);r.forEach(((e,t)=>{e.id=uuid$1();const r=n[t];r?(r.id=e.id,n[t]=r):n[t]=null})),set$3(e,t,r),set$3(e,"mobile.".concat(t),n)};class CompatibilityFactory{static oldVersionTabCardCompatibility(...[e,t]){const r="0.0.3";return isVersionCompatible(e.version,r)?(defaultsDeep$1(e.props,getCompatibilityDefaultProps(t)),e.props.tabCard=getCleanProps(e.props.tabCard),isSameVersion(e.version,r)||(VERSION_REVERSE[e.version]&&(e.children=e.children.slice().reverse()),e.version=r,e.props.tabCard.characterStyle.fontSize=get$5(e.props.tabCard,"fontSize",e.props.tabCard.characterStyle.fontSize),e.props.tabCard.selected.color=get$5(e.props.tabCard,"color",e.props.tabCard.selected.color)),e):e}static oldVersionTabPaneCompatibility(...[e,,,t]){const r="0.0.4";return isVersionCompatible(e.version,r)?(isSameVersion(e.version,r)||(e.version=r,t((({addWidget:t,getWidgets:r,getStory:n})=>{const{children:o}=e;e.children=[],o.forEach((o=>{const i=r().findIndex((e=>e.id===o));if(-1===i)return;const a=r()[i],s={...generateWidgetCreationData({type:WIDGET_TYPE.TAB_PANE,parentWidget:e},{story:n()}),id:uuid$1(),$modelType:"duchamp/Widget",children:[o],parent:e.id};s.props={...s.props,tabName:a.name},a.parent=s.id,e.children.push(s.id),t(i+1,s)}))}))),e):e}static oldVersionTabSwiperCompatibility(...[e]){const t="0.0.5";if(!isVersionCompatible(e.version,t))return e;if(!isSameVersion(e.version,t)){e.version=t;const{swiper:r=!0}=e.mobile?e.mobile.carousel||{}:{swiper:!1};e.mobile={...e.mobile,carousel:{swiperAnimation:r,swiper:r}}}return e}static buttonGroupControllerCompatibility(e,t){const r="0.0.3";if(!isVersionCompatible(e.version,r))return e;const{props:n}=e;defaultsDeep$1(n,t);const{styleType:o="default"}=n;return"default"===o&&"0.0.1"===e.version&&set$3(n,"styleConfig.fitConfig",get$5(n,"extend.fitConfig",{type:"auto"})),"graphic"===o&&(fixImageButtonIcons(e,"props.styleConfig.icons"),fixImageButtonIcons(e,"props.styleConfig.selected.icons")),e.version=r,e}static titleCompatibility(e){const t="0.0.2";if(!isVersionCompatible(e.version,t))return e;const r=e.props.value;if(isString$3(r))if(isFormulaString(r)){const t=createDynamicValue();set$3(e.props,"values",{...t,source:{type:"formula",formula:r}})}else set$3(e.props,"values",r);return e.version=t,e}static titleArrayCompatibility(e){const t="0.0.3";return isVersionCompatible(e.version,t)?(isArray$c(e.props.values)&&set$3(e.props,"values",e.props.values.join(",")),e.version=t,e):e}static workbookCompatibility(e){if(get$5(e,"mobile.props.previewConfig.pinchToZoom"))return e;const t="0.0.2";return isVersionCompatible(e.version,t)?(set$3(e,"mobile.props.previewConfig.pinchToZoom",{enable:!0}),e.version=t,e):e}static handleIframeCompatibility(e){const t="0.0.2";if(!isVersionCompatible(e.version,t))return e;if(e.props){const{path:t}=e.props,{pathType:r,value:n}=t;if(r===PATH_TYPE.URL){const e=handleFormulaValueToDynamicValue(n);set$3(t,"value",e)}}return e.version=t,e}static handleLiveVideoCompatibility(e){const t="0.0.2";if(!isVersionCompatible(e.version,t))return e;if(e.props){const t=handleFormulaValueToDynamicValue(e.props.src);set$3(e.props,"src",t)}return e.version=t,e}static handleWebUrlValueCompatibility(e){var t;const r="0.0.2";return isVersionCompatible(e.version,r)?(CompatibilityFactory.handleWebUrlValue(e.props),CompatibilityFactory.handleWebUrlValue(null==(t=e.mobile)?void 0:t.props),e.version=r,e):e}static handleImageCompatibility(e){const t="0.0.3";return isVersionCompatible(e.version,t)?CompatibilityFactory.handleColorFilterCompatibility(e,t):e}static handleLocalVideoCompatibility(e){const t="0.0.3";return isVersionCompatible(e.version,t)?CompatibilityFactory.handleColorFilterCompatibility(e,t):e}static handleColorFilterCompatibility(e,t){const r=e.props,n=["hue","saturation","brightness","contrast","opacity"];return r.colorFilter=n.reduce(((e,t)=>(t in r&&(e[t]=r[t]),e)),{}),e.props=omit$1(r,n),e.version=t,e}static handleWebUrlValue(e){if(!isNil$3(null==e?void 0:e.asset)&&e.asset.type===RESOURCE_TYPE.WEBURL&&isString$3(e.asset.value)){const t=e.asset.value;set$3(e.asset,"value",[t])}}static titleRichText(e){var t;const r="0.0.2";return isVersionCompatible(e.version,r)?(CompatibilityFactory.handleRichTextPropsValue(e.props),CompatibilityFactory.handleRichTextPropsValue(null==(t=e.mobile)?void 0:t.props),e.version=r,e):e}static handleRichTextPropsValue(e){if(isNil$3(e))return;const t=e.value;if(isArray$c(t)){const r=[];t.forEach((e=>{var t;const n=null==(t=null==e?void 0:e.insert)?void 0:t[FORMULA_EMBED_KEY];if(isNil$3(n))r.push(e);else{const t=createDefaultDynamicValue(r),{fx:o,text:i}=n;t.name=i,t.source={type:"formula",formula:o},r.push({...e,insert:{[DYNAMIC_VALUE_EMBED_KEY]:{id:t.id,fx:t}}})}})),set$3(e,"values",r)}}static handleOldWebPagePopoverAction(e,t){const{url:r}=e;return"string"!=typeof r&&void 0!==r||(e.url={value:r?[r]:[],pathType:PATH_TYPE.URL}),e.url.pathType===CONTENT_TYPE.TEXT_PROMPT?defaultsDeep$1(e,{...t,url:POPOVER_TEXT_PROMPT_DEFAULT_URL}):defaultsDeep$1(e,t),e}static convertWebPagePopover(e,t,r){return compareVersions(r,"1.19.0")?(CompatibilityFactory.handleOldWebPagePopoverAction(e,t),e.type="webPagePopover",e):e}static convertMobileConfig(e,t,r){return compareVersions(r,"2.6.0")?(CompatibilityFactory.handleOldWebPagePopoverAction(e,t),e):e}static convertFilterConfig(e,t,r){var n,o,i,a;if(!compareVersions(r,"2.7.0"))return e;const s=get$5(e,"borderHue",t.borderStyle.hue||0),l=get$5(e,"borderOpacity",t.borderStyle.opacity||85),c=get$5(e,"mobileConfig.borderHue",(null==(o=null==(n=t.mobileConfig)?void 0:n.borderStyle)?void 0:o.hue)||0),u=get$5(e,"mobileConfig.borderOpacity",(null==(a=null==(i=t.mobileConfig)?void 0:i.borderStyle)?void 0:a.opacity)||85);return set$3(e,"borderStyle",{hue:s,opacity:l,saturation:0,contrast:0,brightness:0}),set$3(e,"mobileConfig.borderStyle",{hue:c,opacity:u,saturation:0,contrast:0,brightness:0}),omit$1(e,["borderHue","borderOpacity","mobileConfig.borderHue","mobileConfig.borderOpacity"])}static handleStoreLoadConfig(e,t,r){if(isNil$3(e))return e;if(!compareVersions(r,"2.7.0"))return e;const{loadConfig:n}=e;if(!n)return e;const{widget:o}=n;if(!("hue"in o))return e;defaultsDeep$1(n,t);const i={...n,widget:t.widget};return set$3(e,"loadConfig",i),e}static customChartCompatibility(e){var t;return widgetWidthTriggers(e)&&!e.props.charts&&(e.props.charts=null==(t=e.triggers)?void 0:t.map((e=>e.value))),e}static oldVersionRoamAnimationCompatibility(e,t,r){if(!compareVersions(r,"2.10.0"))return e;const n=get$5(e,"roamData.triggerWidget",e.animationsSourceWidgetId||t.animationsSourceWidgetId||""),o=get$5(e,"roamData.roamPaths",e.animations);return o.join("").length>0?set$3(e,"animations",o):set$3(e,"animations",t.animations||[]),n.length>0&&set$3(e,"animationsSourceWidgetId",n),set$3(e,"playCommand",t.playCommand||"play"),omit$1(e,["roamData"])}static oldVersionModalAnimationCompatibility(e,t,r){if(!compareVersions(r,"2.10.0")&&!modelActionIsDeprecated(e))return e;if(modelActionIsDeprecated(e)){return splitModalAnimationAction(e).map((r=>{if(has$2(e,"animations")&&r.animations.length>0){const e=get$5(r.animations.at(0),"widget",t.animationsSourceWidgetId||""),n=get$5(r.animations.at(0),"isDelay",t.commandTiming.isDelay||!1),o=get$5(r.animations.at(0),"delayTime"),i=map$3(r.animations,"animation");set$3(r,"animations",i),set$3(r,"animationsSourceWidgetId",e),set$3(r,"commandTiming",n?{isDelay:n,delayTime:o}:{isDelay:n})}else set$3(r,"animations",t.animations),set$3(r,"commandTiming",{isDelay:t.commandTiming.isDelay});return set$3(r,"playCommand",t.playCommand||"play"),set$3(r,"playMode",t.playMode||"once"),r}))}return e}static handleWebPagePopoverURLSupportDynamicValue(e,t,r){if(!compareVersions(r,"3.2.0"))return e;const{body:n}=e,{pathType:o,value:i}=n.url;if(o===CONTENT_TYPE.URL){const e=handleFormulaValueToDynamicValue(i);set$3(n.url,"value",e)}return e}static handleWebPagePopoverTextPromptSupportDynamicValue(e,t,r){if(!compareVersions(r,"3.6.0"))return e;const{body:n}=e,{pathType:o,value:i}=n.url;if(o===CONTENT_TYPE.TEXT_PROMPT){const{value:e}=i,t=e.map((e=>{if(isFormulaOp(e)){const{fx:t,text:r}=e.insert[FORMULA_EMBED_KEY],n=uuid$1();return{...e,insert:{[DYNAMIC_VALUE_EMBED_KEY]:{id:n,fx:{id:n,source:{type:"formula",formula:t},name:r,formatter:{type:FORMATTER_TYPE.NORMAL,value:""},conditionStyles:[]}}}}}return e}));set$3(n.url,"value.value",t)}return e}}function widgetWidthTriggers(e){return Array.isArray(null==e?void 0:e.triggers)}function modelActionIsDeprecated(e){return!has$2(e,"playCommand")}const WIDGET_DEFAULT_PROPS={"d-slideshow":{defaultProps:DEFAULT_TAB_CONFIG,handle:[CompatibilityFactory.oldVersionTabCardCompatibility,CompatibilityFactory.oldVersionTabPaneCompatibility,CompatibilityFactory.oldVersionTabSwiperCompatibility]},"d-controller-radio-group":{defaultProps:{},handle:CompatibilityFactory.buttonGroupControllerCompatibility},"d-controller-check-group":{defaultProps:{},handle:CompatibilityFactory.buttonGroupControllerCompatibility},"d-text-title":{defaultProps:{},handle:[CompatibilityFactory.titleCompatibility,CompatibilityFactory.titleArrayCompatibility]},"d-text":{defaultProps:{},handle:CompatibilityFactory.titleRichText},"d-chart-CUSTOM":{defaultProps:{},handle:CompatibilityFactory.customChartCompatibility},"d-workbook":{defaultProps:{},handle:CompatibilityFactory.workbookCompatibility},"d-workbook-x":{defaultProps:{},handle:CompatibilityFactory.workbookCompatibility},"d-image":{defaultProps:{},handle:[CompatibilityFactory.handleWebUrlValueCompatibility,CompatibilityFactory.handleImageCompatibility]},"d-local-video":{defaultProps:{},handle:[CompatibilityFactory.handleWebUrlValueCompatibility,CompatibilityFactory.handleLocalVideoCompatibility]},"d-live-video":{defaultProps:{},handle:CompatibilityFactory.handleLiveVideoCompatibility},"d-iframe":{defaultProps:{},handle:CompatibilityFactory.handleIframeCompatibility}},WIDGET_ACTION_DEFAULT_PROPS={webPage:{defaultProps:WEB_PAGE_DEFAULT_CONFIG,eventHandlers:[CompatibilityFactory.convertWebPagePopover,CompatibilityFactory.convertMobileConfig,CompatibilityFactory.convertFilterConfig]},popover:{defaultProps:POPOVER_DEFAULT_CONFIG,eventHandlers:[CompatibilityFactory.convertWebPagePopover,CompatibilityFactory.convertMobileConfig,CompatibilityFactory.convertFilterConfig]},webPagePopover:{defaultProps:WEB_PAGE_POPOVER_DEFAULT_CONFIG,eventHandlers:[CompatibilityFactory.convertMobileConfig,CompatibilityFactory.convertFilterConfig],actionHandlers:[CompatibilityFactory.handleWebPagePopoverURLSupportDynamicValue,CompatibilityFactory.handleWebPagePopoverTextPromptSupportDynamicValue]},playRoamAnimation:{defaultProps:DEFAULT_ROAM_ANIMATION_CONFIG,eventHandlers:CompatibilityFactory.oldVersionRoamAnimationCompatibility},modelAnimation:{defaultProps:DEFAULT_MODAL_ANIMATION_CONFIG,eventHandlers:CompatibilityFactory.oldVersionModalAnimationCompatibility}},SIMULTANEOUSLY_ACTIONS=[DUCHAMP_ACTION_TYPE.WIDGET_LINK,DUCHAMP_ACTION_TYPE.MODEL_ANIMATION,DUCHAMP_ACTION_TYPE.JAVASCRIPT,DUCHAMP_ACTION_TYPE.VISIBLE_CONTROL];class WidgetCompatibilityLogic{constructor(e,t,r){__publicField(this,"hooks",[]),__publicField(this,"story"),this.story=e;try{const e=transformTemplateVersion(t);this.widgets.forEach((t=>{delete t.$modelId,this.compatibilityWithWidget(t,e,r)})),this.hooks.forEach((e=>{e({addWidget:(...e)=>{this.addWidget(...e)},getWidgets:()=>this.getWidgets(),getStory:()=>this.getStory()})}))}catch(e3){console.error("compatibility failure",e3)}}get widgets(){return this.story.widgets}addHook(e){this.hooks.push(e)}addWidget(e,t){this.story.widgets.splice(e,0,t)}getWidgets(){return this.widgets}getStory(){return this.story}compatibilityWithWidget(e,t,r){return e=this.widgetBorderCompatibility(e,r),e=this.controllerCompatibility(e,r),e=this.oldVersionCompatibility(e,t),e=this.oldEventCompatibility(e,t),e=this.widgetEventActionCompatibility(e),e=this.oldActionCompatibility(e,t),e=this.chartCompatibility(e)}chartCompatibility(e){return widgetIsChart(e)&&e.props&&(e.props=omit$1(e.props,"stringChartCollection")),e}oldEventCompatibility(e,t){return isWidgetWithActions(e)&&(e.actions=flatMap$1(e.actions.map((e=>{const{eventHandlers:r,defaultProps:n}=WIDGET_ACTION_DEFAULT_PROPS[e.type]||{};return r&&n?tryRunHandler(r,e,n,t):e})))),e}oldActionCompatibility(e,t){return e.widgetEvents&&(e.widgetEvents=e.widgetEvents.map((e=>({...e,events:e.events.map((e=>({...e,actions:e.actions.map((e=>{const{actionHandlers:r,defaultProps:n}=WIDGET_ACTION_DEFAULT_PROPS[e.type]||{};return r&&n?tryRunHandler(r,e,n,t):e}))})))})))),e}oldVersionCompatibility(e,t){const{handle:r,defaultProps:n}=WIDGET_DEFAULT_PROPS[e.type]||{};return r&&n&&tryRunHandler(r,e,n,t,(e=>{this.addHook(e)})),e}widgetBorderCompatibility(e,t){const r=widgetManager.getWidgetByName(e.type);return!e.borderLine&&r.borderLine&&(e.borderLine={...DEFAULT_BORDER_LINE,...r.borderLine,borderColor:widgetIsController(r)?t.borderColorNormal:r.borderLine.borderColor}),e}controllerCompatibility(e,t){return controllerCompatibility(e,t)}widgetEventActionCompatibility(e){var t;if(isWidgetWithActions(e)&&!e.widgetEvents){const r=null==(t=widgetManager.getWidgetByName(e.type).configure)?void 0:t.eventTargets,n=isFunction$8(r)?r(e.props):r;if(!n)return e;e.widgetEvents=[];const o=new Map;e.actions.forEach((({trigger:e,...t})=>{var r,i;const a=Array.isArray(n),{disable:s,id:l,name:c,type:u,...d}=t,h=getEventTarget(a,e),p=getActionTrigger(a,e),f=a?n.find((e=>isNil$3(e.value)||e.value===h)):n,g=null==(r=null==f?void 0:f.events.find((e=>e.trigger===p)))?void 0:r.text,m=null!=(i=o.get(h))?i:[],y=SIMULTANEOUSLY_ACTIONS.includes(t.type),v=p!==WIDGET_EVENT.CLICK,_=m.findIndex((e=>e.trigger===p&&(v||!!y&&e.actions.some((e=>SIMULTANEOUSLY_ACTIONS.includes(e.type)))))),b={id:l,name:c,type:u,body:d,enabled:!0!==s,condition:null};if(o.has(h)&&_>-1){const e=m[_],t=[...m];t.splice(_,1,{...e,actions:e.actions.concat([b])}),o.set(h,t)}else{const e=createEventName(m.map((e=>e.name)),t.name,{isIndependentTrigger:v,isSimultaneously:y,triggerText:g});o.set(h,m.concat({id:uuid$1(),mode:"selective",name:e,trigger:p,enabled:!0,actions:[b]}))}})),o.forEach(((t,r)=>{const n=t.filter((e=>e.trigger===WIDGET_EVENT.CLICK)),o=n.find((e=>e.actions.some((e=>SIMULTANEOUSLY_ACTIONS.includes(e.type))))),i=n.filter((e=>e!==o)),a=o&&1===i.length?t.reduce(((e,t)=>(n.includes(t)?t===o&&e.push({...t,actions:t.actions.concat(i.map((e=>e.actions)).flat())}):e.push(t),e)),[]):t;e.widgetEvents.push({target:r,events:a.map((e=>({...e,enabled:e.actions.some((e=>e.enabled))})))})}))}return e}}function isWidgetWithActions(e){return!isUndefined$3(null==e?void 0:e.actions)}function getEventTarget(e,t=""){return e?"DUCHAMP_CAROUSEL_TRIGGER"===t?"":t:""}function getActionTrigger(e,t){return e&&"DUCHAMP_CAROUSEL_TRIGGER"===t?WIDGET_EVENT.CAROUSEL:e||!t?WIDGET_EVENT.CLICK:"DUCHAMP_CAROUSEL_TRIGGER"===t?WIDGET_EVENT.CAROUSEL:t}function createEventName(e,t,r){return r.isIndependentTrigger?createUniqueName(e,duchampIntl.get("Duchamp-Trigger_Compatible_Events",r.triggerText),"","",0):r.isSimultaneously?createUniqueName(e,duchampIntl.get("Duchamp-Events_Triggered_Simultaneously"),"","",0):t}function controllerCompatibility(e,t){if(widgetIsController(e)){const{props:r}=e;if(!r.styleType&&!r.styleConfig){const n=getWidgetDefaultStyleProps({widgetManager:widgetManager,themeVars:t,widgetType:e.type,defaultProps:DEFAULT_CONTROLLER_STYLE_PROPS});r.styleType=n.styleType,r.styleConfig=n.styleConfig}isNil$3(r.relatedParams)&&(r.relatedParams={valueConfig:e.name}),r.fontSize&&set$3(r.styleConfig,"fontAttr.fontSize",r.fontSize)}return e}function tryRunHandler(e,t,...r){return(Array.isArray(e)?e:[e]).reduce(((e,t)=>{try{return t(e,...r)}catch(n){return console.error(n),e}}),t)}var __defProp$s=Object.defineProperty,__getOwnPropDesc$r=Object.getOwnPropertyDescriptor,__decorateClass$r=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$r(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$s(t,r,i),i};class ReuseWidgetModel extends BaseWidgetModel{constructor(){super(...arguments),__publicField(this,"loading",!1),__publicField(this,"error",!1)}get extraValue(){return this.widget.getExtrasValue()}onCreated(){const{currentManager:e}=this.store.widgetReuseGroup;if(e.isLocalMode)this.widget.setExtrasValue({id:e.selectedResourceId});else{const t=e.onlineCategory.getResourceById(e.selectedResourceId);t&&this.widget.setExtrasValue({uuid:t.uuid,shopId:t.id,fileName:t.name})}}calculatePosition(e,t){const r=new Transform$2(e.states.matrix);r.translate((e.states.width-t.states.width)/2,(e.states.height-t.states.height)/2);const[n,o]=r.getPosition(),[i,a]=e.position;return[t.position[0]+(i-n),t.position[1]+(a-o)]}async onInit(){const{currentManager:e}=this.store.widgetReuseGroup;if(this.setLoading(!0),e.type===REUSE_TYPE.IMAGE||e.type===REUSE_TYPE.VIDEO){const t=e.type===REUSE_TYPE.IMAGE,r=t?"d-image":"d-local-video",{story:n,scale:o}=this.store,{target:i}=this.widget,{y:a,x:s}=getMainCanvasRect(i||null),l=getCanvasContainerRect(i||null);let c=this.extraValue.id;if(e.isOnlineMode){const e=await this.fetchOnlineResource();if(!e)throw null;c=uuid$1(),this.store.resourceCenter.addResourceInfo([{id:c,name:e.imageSource,payload:{imgSlice:[],...t&&{reuseId:e.reuseId}}}])}else{const t=await this.store.reuseService.readReuseResource(this.extraValue.id,e.type);if(!t)throw null;await this.store.resourceCenter.copy(t.resources.map((t=>({...t,tags:e.type===REUSE_TYPE.IMAGE?["image"]:"video"===t.type?["video"]:[]}))),t.env)}try{const e=await n.createWidget(r,{x:round$3((l.width/2+l.x-s-DESIGNER.SCROLLBAR_WIDTH/2)/o),y:round$3((l.height/2+l.y-a-DESIGNER.SCROLLBAR_WIDTH/2)/o)});if(!e)throw null;const[t,i]=this.calculatePosition(e,this.widget);return e.setPosition(t,i),e.updateProps("asset",{type:RESOURCE_TYPE.INTERNAL,value:c}),this.remove(),e}catch(e3){return this.setLoading(!1),void this.setError(!0)}}let t=[],r=[],n={};if("shopId"in this.extraValue)try{const o=await e.applyOnlineResource({id:this.extraValue.shopId,name:this.extraValue.fileName});if(!o)throw null;const{widgetSnapshot:i,info:a,resources:s,env:l}=o;await reuseCompatibleWarning(a)&&this.widget.setExtrasValue({id:a.id}),t=JSON.parse(i),r=s,n=l}catch(e3){return this.setLoading(!1),void this.setError(!0)}else{const o=e.localCategory.getResourceById(this.extraValue.id);!(o&&await reuseCompatibleWarning(o.getResourceData()))&&this.widget.setExtrasValue({id:null}),await this.store.reuseService.applyReuseDataset(this.extraValue.id);const i=await this.store.reuseService.readReuseResource(this.extraValue.id,REUSE_TYPE.WIDGET);if(!i)throw null;const{content:a,resources:s,env:l}=i;t=a||[],r=s,n=l}if(this.extraValue.id){if(t&&this.story){const e=getSnapshot(this.story);e.widgets=t;const o=t.find((e=>e.type===WIDGET_TYPE.TAB_PANE)),i=new WidgetCompatibilityLogic(e,this.store.templateVersion,this.store.duchampServer.themeManager.themeVars).getWidgets(),[a,s]=this.widget.position,l=i.map((e=>e.id)),c=(i.length>1?i.filter((e=>!l.includes(e.parent))):i)[0];if(!c)return this.setError(!0),void this.setLoading(!1);const u=new Transform$2(c.states.matrix);u.translate((c.states.width-this.widget.states.width)/2,(c.states.height-this.widget.states.height)/2);const[d,h]=u.getPosition(),p=reimplementWidget([c.id],i,this.store),{valid:f,tip:g}=checkRules([()=>{const{valid:e,tip:t}=isValidChildrenForParent(c.type);return{valid:e,tip:e?"":duchampIntl.get("Duchamp-Operation_Error_Tip",t)}},()=>checkWidgetCountLimit(p.map((e=>e.widget.meta)),this.store.story.widgets)]);if(f){const e=await this.store.resourceCenter.copy(r,n),t=checkRules([()=>this.store.story.createWidgetCheck(p.map((e=>e.widget.meta)))]);if(!t.valid)return Message.error(t.tip),this.remove(),!0;for(const r of p){const{widget:t,fromWidgetId:n}=r,i=this.store.story.widgets.some((e=>e.name===t.name))?createUniqueName(this.store.story.widgets.map((e=>e.name)),"".concat(t.name,"_")):t.name;t.setName(i);const[l,u]=t.position;(t.type!==WIDGET_TYPE.TAB_PANE||o)&&t.setPosition(a+(l-d),s+(u-h)),await this.store.story.addAndInitWidget({type:"paste",fromWidgetId:n,widget:t,parent:t.parent?void 0:this.widget.parentWidget},e),c.id===n&&this.store.story.setCurrent(t)}}else Message.error(g)}return this.remove(),!0}this.remove()}async fetchOnlineResource(){const{currentManager:e}=this.store.widgetReuseGroup,{selectedResourceId:t}=e,r=e.onlineCategory.getResourceById(t);if(!r)return;const n=r.fileLoca.split(".").pop(),o=n===REUSE_TYPE.IMAGE?REUSE_TYPE.IMAGE:"",i="".concat(r.uuid,".").concat(n),a=await e.downloadImageResource2CurrentTpl({id:r.id,fileName:i,resourceType:o});return a?{...a,reuseId:r.uuid}:void 0}remove(){this.store.undoManager.withoutUndo((()=>{this.store.story.deleteWidget(this.widget)}))}setLoading(e){this.loading=e}setError(e){this.error=e}}__decorateClass$r([observable],ReuseWidgetModel.prototype,"loading",2),__decorateClass$r([observable],ReuseWidgetModel.prototype,"error",2),__decorateClass$r([computed],ReuseWidgetModel.prototype,"extraValue",1),__decorateClass$r([action$1],ReuseWidgetModel.prototype,"setLoading",1),__decorateClass$r([action$1],ReuseWidgetModel.prototype,"setError",1);const ReuseWidgetView=observer((({model:e,width:t,height:r})=>jsx("div",{className:classNames$1("d-reuse-wrapper",{error:e.error}),style:{width:t,height:r},children:e.loading?duchampIntl.get("Duchamp-Downloading"):e.error?duchampIntl.get("Duchamp-Download_Failed_Delete"):null}))),registerQueryButtonWidget=()=>{registerDuchampWidgetView(QUERY_BUTTON_WIDGET_META,QueryButtonModel,QueryButtonView)},registerGroupWidget=()=>{registerDuchampWidgetView(GROUP_WIDGET_MATE,GroupWidgetModel,GroupWidgetView,void 0,{configView:GroupConfig,isPanel:!0})},registerTabsWidget=()=>{registerDuchampWidgetView(TABS_WIDGET_META,TabsWidgetModel,TabsView$1,TabsView,{configView:TabsConfig})},registerTabPaneWidget=()=>{registerDuchampWidgetView(TAB_PANE_META,TabPaneWidgetModel,TabPaneView$1,TabPaneView,{configView:TabPaneConfig,isPanel:!0})},registerWorkBookXWidget=()=>{registerDuchampWidgetView(WORKBOOK_META,WorkbookXWidgetModel,WorkbookWidgetView$1,WorkbookWidgetView,{configView:WorkbookWidgetConfig})},registerWorkBookWidget=()=>{registerDuchampWidgetView({...WORKBOOK_META,type:"d-workbook",configure:{...WORKBOOK_META.configure,hide:!0}},WorkbookXWidgetModel,WorkbookWidgetView$1)},registerUnitWidget=()=>{registerDuchampWidgetView(UNITY_WIDGET_META,UnityWidgetModel,CalderView,void 0,{configView:OutSideEditConfig})},registerCalderWidget=()=>{registerDuchampWidgetView(CALDER_WIDGET_META,CalderWidgetModel,CalderView,void 0,{configView:OutSideEditConfig})},registerCalderCustomWidget=()=>{registerDuchampWidgetView(CALDER_CUSTOM_WIDGET_META,CalderCustomWidgetModel,CalderView,void 0,{configView:OutSideEditConfig})},registerRichTextWidget=()=>{registerDuchampWidgetView(RICH_TEXT_META,RichTextModel,RichText)},registerTimeWidget=()=>{registerDuchampWidgetView(TIME_WIDGET_META,TimeWidgetModel,TimeWidgetView)},registerTitleWidget=()=>{registerDuchampWidgetView(TITLE_WIDGET_META,TitleWidgetModel,TitleWidgetView)},registerLocalVideoWidget=()=>{registerDuchampWidgetView(LOCAL_VIDEO_WIDGET_META,LocalVideoModel,LocalVideoView$1,LocalVideoView)},registerIframeWidget=()=>{registerDuchampWidgetView(IFRAME_WIDGET_META,IframeModel,IframeView$1,IframeView)},registerImageWidget=()=>{registerDuchampWidgetView(IMAGE_WIDGET_META,ImageModel,ImageView)},registerReserveCanvasWidget=()=>{registerDuchampWidgetView(RESERVE_CANVAS_META,ReserveCanvasWidgetModel,ReserveCanvasView$1,ReserveCanvasView)},registerLiveVideoWidget=()=>{registerDuchampWidgetView(LIVE_VIDEO_WIDGET_META,LiveVideoModel,LiveVideo$1,LiveVideo)},registerExpandWidget=()=>{registerDuchampWidgetView(EXPAND_WIDGET_META,ExpandWidgetModel,ExpandView$1,ExpandView)},registerExpandTemplateWidget=()=>{registerDuchampWidgetView(EXPAND_TEMPLATE_WIDGET_META,ExpandTemplateWidgetModel,ExpandTemplateView,void 0,{configView:ExpandTemplateConfig,isPanel:!0})},registerAIWidget=()=>{registerDuchampWidgetView(AI_SUMMARY_META,AISummaryModel,AISummaryView)},registerRelationWidget=()=>{registerRelationComponent("RELATION-WIDGET",duchampIntl.get("Duchamp-Chart"),duchampIntl.get("Duchamp-Column_Chart_Class"))},registerReuse=()=>{registerWidget({options:{type:"d-reuse",displayName:"",version:"0.0.1",icon:"",widgetType:"reuse",model:ReuseWidgetModel,states:{width:152,height:90},configure:{acceptRule:{parentWhitelist:{rule:["canvas"]}}}},view:ReuseWidgetView})};function getBaseProperties(){const e={};return settingCenter.controllerConfig.fields.enableBind&&(e.relatedFields={title:duchampIntl.get("Duchamp-Bind_Field"),widget:"relatedFields"},e.searchAll={title:"",widget:"searchAll"}),e.relatedParams={title:duchampIntl.get("Duchamp-Bind_Parameter"),widget:"relatedParams"},e}const FORMAT_TYPE={DATE:"date"};dayjs.extend(customParseFormat);const DEFAULT_FORMAT={type:DATE_FORMAT_TYPE.YMD,value:getFormatsByDateFormatType(DATE_FORMAT_TYPE.YMD)[0]};function getDateFormatByFormatConfig(e){return(null==e?void 0:e.type)===FORMAT_TYPE.DATE?e.payload:DEFAULT_FORMAT}function getFormatDateString(e,t){return dayjs(t).locale("en").format(e)}function getDateValueWithFormat(e,t){if(isNil$3(t))return;const r=getFormatDateString(e=transformDateFormat2DayjsFormat(e),t);return dayjs(r,e,"en").valueOf()}function baseZipObject$1(e,t,r){for(var n=-1,o=e.length,i=t.length,a={};++n<o;){var s=n<i?t[n]:void 0;r(a,e[n],s)}return a}var _baseZipObject=baseZipObject$1,baseSet=_baseSet$1,baseZipObject=_baseZipObject;function zipObjectDeep(e,t){return baseZipObject(e||[],t||[],baseSet)}var zipObjectDeep_1=zipObjectDeep;const zipObjectDeep$1=getDefaultExportFromCjs$1(zipObjectDeep_1);function parameterHasBind(e,t,r,n){return""!==e&&n.some((n=>{if(!n.props.relatedParams)return!1;const o=new Map(Object.entries(n.props.relatedParams));if(n.id===r){for(const[r,n]of o)if(n===e&&r!==t)return!0;return!1}return Array.from(o.values()).includes(e)}))}function getAllParametersCanBind({fieldName:e,widgetId:t,widgets:r,crudService:n,payload:o}){return n.getAllParameters(o).then((n=>n.filter((n=>!isString$3(n)||!parameterHasBind(n,e,t,r))).map((n=>{var o;return isString$3(n)?n:{...n,children:null==(o=n.children)?void 0:o.filter((n=>!parameterHasBind(n.id,e,t,r)))}}))))}function RelatedController(e){var t,r;const n=useFocusPointTarget();if(e.showAllWidgets)return jsx(RelatedControllerTree,{...e});const o=(null!=(r=null==(t=e.controllersGetter)?void 0:t.call(e))?r:[]).map((e=>({label:e.name,value:e.id,disabled:!(!e.circulate&&e.sameTable&&e.supportBind),title:getRelatedControllerText(e)})));return jsx(Select$1,{className:"related-controller-select","data-focus-point":{id:"S236",getParam:e=>({empty:0===e.length}),getTarget:()=>n},style:{width:"100%"},multiple:!0,tags:!0,showSearch:!0,allowClear:!0,optionFilterProp:"label",value:e.value.filter((e=>o.some((t=>t.value===e&&!t.disabled)))),maxTagCount:"responsive",onChange:t=>{e.onChange(t)},options:o})}function RelatedControllerTree(e){var t,r;const n=useFocusPointTarget(),o=(null!=(r=null==(t=e.controllersGetter)?void 0:t.call(e))?r:[]).reduce(((e,t)=>{var r,n,o,i;const a=null!=(n=null==(r=t.box)?void 0:r.key)?n:"",s=e.get(a),l={key:t.id,title:jsx("div",{title:getRelatedControllerText(t),children:t.name}),searchValue:t.name,disabled:!(!t.circulate&&t.sameTable&&t.supportBind)};if(s)s.children.push(l);else{const r=null!=(i=null==(o=t.box)?void 0:o.name)?i:"";e.set(a,{key:a,title:r,searchValue:r,children:[l]})}return e}),new Map);return jsx(TreeSelect$1,{showSearch:!0,treeCheckable:!0,maxTagCount:"responsive",treeCheckRelated:!0,treeNodeFilterProp:"searchValue","data-focus-point":{id:"S236",getParam:()=>{var t;return{empty:!(null==(t=e.value)?void 0:t.length)}},getTarget:()=>n},style:{width:"100%"},value:e.value.filter((e=>Array.from(o.values()).some((t=>t.children.some((t=>t.key===e&&!t.disabled)))))),onChange:t=>{var r;const n=isArray$c(t)?t.map(toString$6):[],i=[];o.forEach((e=>{e.children.forEach((e=>{!e.disabled&&n.includes(e.key)&&i.push(e.key)}))})),null==(r=e.onChange)||r.call(e,i)},allowClear:!0,treeData:Array.from(o.values())})}function getRelatedControllerText(e){return e.configIsAuto?e.supportBind?e.circulate?duchampIntl.get("Duchamp-Controller_Linkage_Not_Support_Circulate"):e.sameTable?e.name:duchampIntl.get("Duchamp-Controller_Linkage_Not_Same_Table"):duchampIntl.get("Duchamp-Controller_Linkage_Not_Support"):duchampIntl.get("Duchamp-Controller_Linkage_Not_Auto_Analysis")}function getRelationControllers(e,t,r){return t.reduce(((t,n)=>{var o,i,a,s,l;if(n.id!==e.id){const c="date"===(null==(o=n.props.formatConfig)?void 0:o.type),u=dataConfigIsAuto(n.props.dataConfig)&&dataConfigIsAuto(e.props.dataConfig),d=!c&&u;t.push({id:n.id,name:null!=(i=n.props.name)?i:"",configIsAuto:u,supportBind:d,sameTable:isBindSameTable(null!=(a=e.props.relatedFields)?a:[],null!=(s=n.props.relatedFields)?s:[]),circulate:(null!=(l=n.props.relatedControllers)?l:[]).includes(e.id),box:r})}return t}),[])}function dataConfigIsAuto(e){return!e||"auto"===e.value.type}function getWhenOnlyBindOneTable(e){const t=union(e.map((e=>e.table)));return 1===t.length?t[0]:null}function isBindSameTable(e,t){const r=getWhenOnlyBindOneTable(e),n=getWhenOnlyBindOneTable(t);return!(!r||!n||r!==n)}function createShowWidgetTreeData(e,t,r,n,o){const i=getTreeTables(e,t,o);return n?i.forEach((e=>{e.children=getPageNodes(r,e.widgets)})):i.forEach((e=>{e.children=e.widgets.map((e=>getTreeWidgetNode(r.story.widgets,e.id,e.isDeleted)))})),i}function getPageNodes(e,t){const r=new Map;return t.forEach((t=>{var n,o;const{id:i,isDeleted:a}=t,s=findWidgetInStore(e,i),l=null!=(n=null==s?void 0:s.id)?n:"deleted",c=r.get(l);c?(c.children.push(getWidgetNode(i,null==s?void 0:s.widget,a)),c.widgets.push(i)):r.set(l,{title:null!=(o=null==s?void 0:s.name)?o:duchampIntl.get("Duchamp-Page_Deleted"),key:l,isPage:!0,deleted:!s,widgets:[i],children:[getWidgetNode(i,null==s?void 0:s.widget,a)]})})),Array.from(r.values())}function findWidgetInStore(e,t){for(const r of e.stories)for(const e of r.widgets)if(e.id===t)return{name:r.name,id:r.id,widget:e};return null}function getWidgetNode(e,t,r){return t&&!r?{title:t.name,key:e,type:t.type,isWidget:!0,deleted:!1}:{title:duchampIntl.get("Duchamp-Components_Deleted"),key:e,type:"",isWidget:!0,deleted:!0}}function getTreeWidgetNode(e,t,r){const n=e.find((e=>e.id===t));return getWidgetNode(t,n,r)}function getTreeTables(e,t,r){var n;const o=new Map;for(const i of e){const{table:e,field:a,widget:s}=i,l=null==r?void 0:r[s],c=t.find((t=>t.id===e));if(!c)continue;const u=null==(n=c.fields.find((e=>e.id===a)))?void 0:n.name,d=e+a,h=o.get(d);if(h)h.widgets.push({id:i.widget,isDeleted:!l});else{let t=null!=u?u:duchampIntl.get("Duchamp-Field_Deleted");c.name&&(t="".concat(c.name,"-").concat(t)),o.set(d,{table:e,field:a,title:t,key:d,deleted:!u,widgets:[{id:i.widget,isDeleted:!l}],children:[],isTable:!0})}}return Array.from(o.values())}function useRelationWidgets(e){const t=useStore();return reactExports.useMemo((()=>(e?t.allWidgets:t.story.widgets).map((e=>e.getInstance())).filter(isRelationWidget).map((e=>{var t,r;const{relationMeta:n}=e;return{id:e.id,relationWidgetId:n.wId,table:n.tableId,name:e.name,type:e.type,storyIndex:e.storyIndex,storyName:null!=(r=null==(t=e.story)?void 0:t.name)?r:""}}))),[e,t])}function useRelationWidgetsWithSameTable(e,t){const r=useRelationWidgets(t),{crudService:n}=useService();return useAsync((async()=>{var t;const o=new Set(r.map((e=>e.relationWidgetId))),i=await n.getTableRelations(Array.from(o),[e]),a=[],{filterRelations:s}=i;if(isEmpty$3(s))throw new Error("relations get error");const l=null!=(t=s[e])?t:[];return r.forEach((t=>{(l.includes(t.relationWidgetId)||isRelationWidgetTable(t,e))&&a.push(t)})),a}),[e])}function isRelationWidgetTable(e,t){return t==="widget:".concat(e.relationWidgetId)}function getFieldCount(e){return uniqWith$1(e,((e,t)=>e.table===t.table&&e.field===t.field)).length}function SingleLineEllipsis({children:e,className:t}){return jsx(Typography.Text,{ellipsis:!0,className:t,children:e})}function sortByDataType(e,t){var r;if("date"===t){return[...e.filter((e=>e.type&&["date","composeDate"].includes(e.type))),...e.filter((e=>!e.type||!["date","composeDate"].includes(e.type)))]}const n=null!=(r=SORT_MAP[t])?r:[];return n.length>0?e.filter((e=>e.type&&n.includes(e.type))).sort(((e,t)=>{var r,o;const i=n.indexOf(null!=(r=e.type)?r:"");return n.indexOf(null!=(o=t.type)?o:"")-i})):e}const SORT_MAP={string:["number","string"],date:["date"]};function useSearchTables(e,t,r){const{crudService:n}=useService();return useAsync((async()=>{if(isEmpty$3(e)||0===t.length)return[];return(await n.searchTables(e,t)).reduce(((e,t)=>(!t.error&&e.push(createTableData(t,r)),e)),[])}),[e,t])}function createTableData(e,t){return{key:e.id,title:e.name,selectable:!1,isLeaf:!1,error:e.error,disabled:!!e.error,children:getTableFieldListToTree(e,t)}}function useTableField(e,t,r){var n;const{crudService:o}=useService(),[i,a]=reactExports.useState(!0),[s,l]=reactExports.useState(!1),[c,u]=reactExports.useState([]);reactExports.useEffect((()=>{if(e)if(isString$3(e))o.getTableInfo(e).then((e=>{u([createTableData(e,t)]),a(!1)}));else{const r=!1!==e.showParent;o.getTableWithAncestors(e).then((e=>{const n=r?flattenTables(e):[{key:e.id,title:e.name,selectable:!1,isLeaf:!1}];Promise.all(n.map((e=>o.getTableInfo(e.key)))).then((e=>{e.forEach((e=>{n.forEach((r=>(r.key===e.id&&(r.error=e.error,r.disabled=!!e.error,r.children=getTableFieldListToTree(e,t)),r)))})),u(n),a(!1)}))})).catch((()=>{l(!0),a(!1)}))}else a(!1)}),[o,e,t]);const d=reactExports.useMemo((()=>c.map((e=>e.key))),[c]),h=useSearchTables(null!=r?r:"",d,t),p=r&&h.loading;return{tables:isEmpty$3(r)?c:null!=(n=h.value)?n:[],loading:i||p,error:s,loadChildren:e=>awaitAppendWidgetTables(c,e,o.getTableInfo,t).then((e=>{u(e)}))}}function flattenTables(e){const t=[e],r=[];for(;t.length;){const e=t.pop();e&&(r.some((t=>t.key===e.id))||(r.push({key:e.id,title:e.name,selectable:!1,isLeaf:!1}),e.parents&&t.push(...e.parents)))}return r}async function awaitAppendWidgetTables(e,t,r,n){const o=e.find((e=>e.key===t));if(!isEmpty$3(null==o?void 0:o.children))return e;const i=await r(t);return e.map((e=>e.key===t?{...e,children:getTableFieldListToTree(i,n)}:e))}function getTableFieldListToTree(e,t){return sortByDataType(e.fields.map((t=>({key:getTableFiledKey(e.id,t.id),title:t.name,type:t.type,selectable:!0,isLeaf:!0}))),t)}function getTableFiledKey(e,t){return"".concat(e,".").concat(t)}function getOriginalFieldId(e,t){return e.replace("".concat(t,"."),"")}function getTypeIcon(e){switch(e){case"number":return"icon-integer";case"date":return"icon-date-type";default:return"icon-character-string"}}function NodeSwitcher({value:e}){return jsx(e?CaretDownFilled:CaretRightFilled,{})}function TreeNode$1({node:e,toolbarRender:t,iconRender:r=TreeNodeIcon$1,suffixRender:n}){var o;const i=r,a=null!=t?t:()=>null,s=null!=n?n:()=>null,l={marginLeft:"".concat(15*e.level+4,"px")};return jsxs("div",{className:"field-tree-node",children:[e.isLeaf?jsx("span",{className:"node-indent",style:l}):jsx("span",{style:l,id:"fvs-node-switcher",className:"node-switcher",children:jsx(NodeSwitcher,{value:null!=(o=e.expanded)&&o})}),jsxs("div",{className:"tree-title",children:[jsxs("div",{className:"tree-title-content",children:[e.isLeaf&&"type"in e.data?jsx(i,{type:toString$6(e.data.type)}):null,jsxs("div",{className:"tree-title-content-item",children:[e.data.error?jsx("div",{className:"tree-node-error",children:duchampIntl.get("Duchamp-Data_Error")}):jsx(SingleLineEllipsis,{className:classNames$1({"tree-node-error":e.data.deleted}),children:e.data.title}),jsx(s,{node:e})]})]}),jsx("div",{className:"tree-toolbar",children:jsx(a,{node:e})})]})]})}function TreeNodeIcon$1(e){return isObject$e(e)&&"type"in e?jsx(Icon$2,{type:getTypeIcon(toString$6(e.type))}):null}function TableFiledSelector({value:e,onChange:t,table:r,dataType:n,search:o,nodeSuffixRender:i}){var a,s;const{loading:l,tables:c,loadChildren:u,error:d}=useTableField(r,n,o);if(l)return jsx("div",{className:"duchamp-table-field-selector",children:jsx(Spin$1,{})});if(o&&0===c.length)return jsx("div",{className:"empty-bg",children:jsx(Empty$1,{image:"/assets/system/empty_layer.svg"})});if(d)return jsx("div",{className:"empty-bg",children:jsx(Empty$1,{image:"/assets/system/empty_layer.svg",description:duchampIntl.get("Duchamp-Chart_Missing")})});const h=o?c.reduce(((e,t)=>(t.children&&e.push(t.key),e)),[]):(null==e?void 0:e.field)?[e.table]:[null!=(s=null==(a=c.at(0))?void 0:a.key)?s:""];return jsx("div",{className:"duchamp-table-field-selector",children:jsx(Tree,{defaultExpandedKeys:h,treeData:c,selectable:!0,selectedKeys:e&&e.field?[getTableFiledKey(e.table,e.field)]:[],onLoadData:async e=>{const t=toString$6(e.key);return u(t)},onClick:e=>{var r;if(e.isLeaf){const n=toString$6(e.key);for(const e of c){const o=null==(r=e.children)?void 0:r.find((e=>e.key===n));o&&(null==t||t({table:e.key,field:getOriginalFieldId(o.key,e.key)}))}}},treeNodeRender:e=>jsx(TreeNode$1,{node:e,suffixRender:i})})})}function useSyncState(e){const[t,r]=reactExports.useState(e);return reactExports.useEffect((()=>{r(e)}),[e]),[t,r]}var createAggregator$1=_createAggregator,partition=createAggregator$1((function(e,t,r){e[r?0:1].push(t)}),(function(){return[[],[]]})),partition_1=partition;const partition$1=getDefaultExportFromCjs$1(partition_1);function sortByPartition(e,t){const[r,n]=partition$1(e,t);return concat(r,n)}function getWidgetIconCode(e){const t=widgetManager.getWidgetByName(e).mainGroupName;return t?WIDGET_CONTAINER_TYPE[t]:"icon-warning-circle-fill"}function RelatedFieldConfigModal(e){var t;const[r,n]=useSyncState(null!=(t=e.value)?t:[]),o=useFocusPointTarget();return jsx(FVSDialog,{visible:e.visible,width:920,height:630,title:duchampIntl.get("Duchamp-Bind_Field"),"data-focus-point":{id:"S234",trigger:"onOk",getTarget:()=>o},onOk:()=>{e.onOk(r)},onCancel:()=>{var t;e.onCancel(),n(null!=(t=e.value)?t:[])},maskClosable:!1,children:jsx(RelatedFieldConfigView,{value:r,showAllWidgets:e.showAllWidgets,dataType:e.dataType,onChange:n})})}function AddRelatedFieldConfigDialog({visible:e,value:t,showAllWidgets:r,dataType:n,onOk:o,onCancel:i}){const[a,s]=reactExports.useState(t),[l,c]=reactExports.useState(new Map),u=useFocusPointTarget();return jsx(FVSDialog,{visible:e,width:920,height:630,title:duchampIntl.get("Duchamp-Bind_Field"),"data-focus-point":{id:"S233",trigger:"onOk",getTarget:()=>u},onOk:()=>{o(getValueWithRecommend(a,l))},onCancel:i,maskClosable:!1,children:jsx("div",{className:"related-field-config",children:jsx(RelatedFieldEditView,{showAllWidgets:r,dataType:n,value:a,onChange:s,recommend:l,onRecommendChange:c,onBack:()=>{s(t)}})})})}function EditRelatedFieldConfigDialog({visible:e,value:t,showAllWidgets:r,dataType:n,onOk:o,onCancel:i,editTable:a,editField:s,onEdit:l}){const[c,u]=reactExports.useState(t),[d,h]=reactExports.useState(new Map);return a&&s?jsx(FVSDialog,{visible:e,width:920,height:630,title:duchampIntl.get("Duchamp-Bind_Field"),onOk:()=>{o(getValueWithRecommend(c,d))},onCancel:i,maskClosable:!1,children:jsx(RelatedFieldConfigEditView,{value:c,dataType:n,editTable:a,editField:s,onBack:i,showAllWidgets:r,onChange:u,recommend:d,onEdit:l,onRecommendChange:h})}):null}function RelatedFieldConfigView({value:e,showAllWidgets:t,dataType:r,onChange:n}){const[o,i]=reactExports.useState(!1),[a,s]=reactExports.useState(null),l=(e,t)=>{s({table:e,field:t})};return jsxs(Fragment,{children:[o?jsx(AddRelatedFieldConfigDialog,{visible:o,value:e,showAllWidgets:t,dataType:r,onOk:e=>{n(e),i(!1)},onCancel:()=>{i(!1)}}):null,a?jsx(EditRelatedFieldConfigDialog,{visible:!!a,value:e,editTable:null==a?void 0:a.table,editField:null==a?void 0:a.field,dataType:r,showAllWidgets:t,onEdit:l,onCancel:()=>{s(null)},onOk:e=>{n(e),s(null)}}):null,jsx("div",{className:"related-field-config",children:jsx(RelatedFieldList,{value:e,showAllWidgets:t,onAdd:()=>{i(!0)},onChange:n,onEdit:l})})]})}function RelatedFieldConfigEditView({value:e,editTable:t,editField:r,onEdit:n,onChange:o,onBack:i,showAllWidgets:a,dataType:s,recommend:l,onRecommendChange:c}){const u=useRelationWidgets(a),[d]=reactExports.useState(e.reduce(((e,n)=>(n.table===t&&n.field===r&&e.push(n.widget),e)),[]));return jsx("div",{className:"related-field-config",children:jsxs("div",{className:"related-field-edit-view",children:[jsx(RelatedFieldSelector,{value:{table:t,field:r},widget:{...getEditingTable(t,u),name:"",showParent:!1},dataType:s,onChange:r=>{c(new Map),n(r.table,r.field),o(e.map((e=>e.table===t&&d.includes(e.widget)?{table:r.table,field:r.field,widget:e.widget}:e)))},onBack:i}),jsx(Divider,{className:"divider",direction:"vertical"}),jsx(WidgetRecommendView,{value:{table:t,field:r},selectedWidget:"",showAllWidgets:a,relatedFields:e,recommend:l,onRecommendChange:c})]})})}const RelatedFieldEditView=observer((({value:e,showAllWidgets:t,dataType:r,onChange:n,recommend:o,onRecommendChange:i,onBack:a})=>{var s,l;const c=useRelationWidgets(t),[u,d]=reactExports.useState(null),[h,p]=reactExports.useState(null);reactExports.useEffect((()=>{const t=e.find((e=>e.widget===(null==u?void 0:u.id)));t&&p({table:t.table,field:t.field})}),[u,e]);const f=null!=(s=null==u?void 0:u.id)?s:"",g=reactExports.useMemo((()=>{var t,r;if(u)return{table:null!=(r=null==(t=e.find((e=>e.widget===u.id)))?void 0:t.table)?r:u.table,field:h?h.field:""}}),[h,u,e]),m=u?jsx(RelatedFieldSelector,{value:g,widget:u,dataType:r,onChange:t=>{p({table:t.table,field:t.field}),i(new Map);e.findIndex((e=>e.widget===f))<0?n([...e,{table:t.table,field:t.field,widget:f}]):n(e.map((e=>e.widget===f?{table:t.table,field:t.field,widget:f}:e)))},onBack:()=>{d(null),p(null),a()}}):jsx(RelatedWidgetSelector,{widgets:c,showAllWidgets:t,onSelected:d});return jsxs("div",{className:"related-field-edit-view",children:[m,jsx(Divider,{className:"divider",direction:"vertical"}),jsx(WidgetRecommendView,{value:h,relatedFields:e,showAllWidgets:t,selectedWidget:null!=(l=null==u?void 0:u.id)?l:"",recommend:o,onRecommendChange:i})]})}));function WidgetRecommendView({value:e,selectedWidget:t,relatedFields:r,showAllWidgets:n,recommend:o,onRecommendChange:i}){return e&&e.field?jsx(WidgetRecommendViewList,{table:e.table,field:e.field,showAllWidgets:n,selectedWidget:t,relatedFields:r,recommend:o,onRecommendChange:i}):jsx("div",{className:"empty-bg",children:jsx(Empty$1,{image:"/assets/system/empty_controller.svg",description:duchampIntl.get("Duchamp-Select_Field_Tips")})})}function WidgetRecommendViewList({table:e,field:t,showAllWidgets:r,selectedWidget:n,relatedFields:o,recommend:i,onRecommendChange:a}){const{value:s,error:l}=useRelationWidgetsWithSameTable(e,r),c=sortByPartition(s,(e=>e.id===n)),[u,d]=reactExports.useMemo((()=>{const r=o.filter((r=>r.table!==e||r.field!==t)),n=c.reduce(((e,t)=>{const n=r.find((e=>e.widget===t.id));return n&&e.push({...t,field:n.field,originalTable:n.table}),e}),[]);return[c.filter((e=>!n.some((t=>t.id===e.id)))),n]}),[t,e,o,c]);useUpdateEffect$2((()=>{s&&(o.forEach((r=>{const n=l||!s.some((e=>e.id===r.widget));r.table===e&&r.field===t&&n&&i.set(r.widget,null)})),a(i))}),[t,o,e,s,l]);const h=getSelectedWidgets(o.filter((e=>u.some((t=>t.id===e.widget)))).map((e=>e.widget)),i);return l?jsx("div",{className:"recommend-content empty",children:jsx("div",{className:"empty-bg",children:jsx(Empty$1,{image:"/assets/system/empty_layer.svg",description:duchampIntl.get("Duchamp-Chart_Missing")})})}):jsxs("div",{className:classNames$1("recommend-content",{"single-recommend":0===u.length||0===d.length}),children:[jsx("div",{className:"related-field-title",children:duchampIntl.get("Duchamp-Widget_linked_By_Fields")}),u.length>0&&jsx(RecommendWithSameField,{sameFieldWidgets:h,field:t,table:e,showAllWidgets:r,recommend:i,relationWidgetsWithSameField:u,onRecommendChange:a}),d.length>0&&jsx(RecommendWithOtherField,{field:t,table:e,showAllWidgets:r,recommend:i,relationWidgetsWithOtherField:d,onRecommendChange:a})]})}function RecommendWidgetTree({value:e,widgets:t,onChange:r}){const n=t.reduce(((e,t)=>{const r=e.get(t.storyIndex),n={key:t.id,title:t.originalTable&&t.field?jsxs("div",{className:"recommend-widget-item",children:[jsx(SingleLineEllipsis,{children:t.name}),jsx(FieldHelp,{table:t.originalTable,field:t.field})]}):t.name,type:t.type};return r?r.children.push(n):e.set(t.storyIndex,{key:"".concat(t.storyIndex),title:t.storyName,children:[n]}),e}),new Map),o=reactExports.useMemo((()=>0===e.length?0:e.length<t.length?1:2),[e,t]);return jsxs("div",{className:"widget-tree-list",children:[jsx(Checkbox$4,{value:o>0,indeterminate:1===o,onChange:()=>{r(o<2?t.map((e=>e.id)):[])},children:duchampIntl.get("Duchamp-Select_All")}),jsx(Tree,{selectable:!0,checkable:!0,isCheckRelated:!0,treeData:Array.from(n.values()),checkedKeys:e,contentEllipsis:!0,icon:e=>e.data&&"type"in e.data?jsx(Icon$2,{type:getWidgetIconCode(toString$6(e.data.type))}):null,onCheck:e=>{r(t.reduce(((t,r)=>(isArray$c(e)&&e.includes(r.id)&&t.push(r.id),t)),[]))}})]})}function RecommendWithSameField({table:e,field:t,recommend:r,showAllWidgets:n,relationWidgetsWithSameField:o,sameFieldWidgets:i,onRecommendChange:a}){const s=i.filter((e=>o.some((t=>t.id===e)))),l=n=>{const o=s.filter((e=>!n.some((t=>t===e)))),i=new Map(r);n.forEach((r=>{i.set(r,{table:e,field:t,widget:r})})),o.forEach((e=>{i.set(e,null)})),a(i)},c=n?jsx(RecommendWidgetTree,{value:s,widgets:o,onChange:l}):jsx(CheckboxGroup,{value:s,onChange:l,options:o.map((e=>({label:jsxs("div",{className:"recommend-widget-item",children:[jsx(Icon$2,{type:getWidgetIconCode(e.type)}),jsx(SingleLineEllipsis,{className:"widget-item-text",children:e.name})]}),value:e.id})))});return jsxs("div",{className:"recommend-widget-tree",children:[jsx("div",{className:"recommend-hint",children:duchampIntl.get("Duchamp-Widget_linked_By_Fields_Tip")}),jsx("div",{className:"recommend-widget-tree-item",children:c})]})}function RecommendWithOtherField({table:e,field:t,recommend:r,showAllWidgets:n,relationWidgetsWithOtherField:o,onRecommendChange:i}){const a=Array.from(r.values()).reduce(((r,n)=>(n&&n.table===e&&n.field===t&&o.some((e=>e.id===n.widget))&&r.push(n.widget),r)),[]),s=n=>{const o=a.filter((e=>!n.some((t=>t===e)))),s=new Map(r);n.forEach((r=>{s.set(r,{table:e,field:t,widget:r})})),o.forEach((e=>{s.set(e,null)})),i(s)},l=n?jsx(RecommendWidgetTree,{value:a,widgets:o,onChange:s}):jsx(CheckboxGroup,{options:o.map((e=>({label:jsxs("div",{className:"recommend-widget-item",children:[jsx(Icon$2,{type:getWidgetIconCode(e.type)}),jsx(SingleLineEllipsis,{className:"widget-item-text",children:e.name})]}),value:e.id,extra:jsx(FieldHelp,{table:e.originalTable,field:e.field})}))),value:a,onChange:s});return jsxs("div",{className:"recommend-widget-tree",children:[jsx("div",{className:"recommend-hint",children:duchampIntl.get("Duchamp-Widget_linked_By_Fields_Repeated_Tip")}),jsx("div",{className:"recommend-widget-tree-item",children:l})]})}function RelatedFieldSelector({value:e,widget:t,dataType:r,onBack:n,onChange:o}){const[i,a]=reactExports.useState(""),s=reactExports.useMemo((()=>""===t.relationWidgetId?t.table:{widget:t.relationWidgetId,table:t.table,showParent:t.showParent}),[t.relationWidgetId,t.table,t.showParent]);return jsxs("div",{className:"related-field-selector",children:[jsx("div",{className:"related-field-title",children:duchampIntl.get("Duchamp-Select_Field")}),jsxs("div",{className:"back-btn",children:[jsx(Icon$2,{type:"icon-left",onClick:n,toolIcon:!0,placement:"bottom"}),jsx(SingleLineEllipsis,{children:t.name})]}),jsx(Search,{placeholder:duchampIntl.get("Duchamp-Reuse_Search_Field"),onChange:e=>{a(e)}}),jsx(TableFiledSelector,{search:i,value:e,table:s,dataType:r,onChange:o,nodeSuffixRender:({node:e})=>e.data.key===t.table?jsx("div",{className:"table-node-suffix",children:duchampIntl.get("Duchamp-Current_Table")}):isRelationWidgetTable(t,e.data.key)?jsx("div",{className:"table-node-suffix",children:duchampIntl.get("Duchamp-Current_Chart")}):null})]})}function RelatedWidgetSelector({showAllWidgets:e,widgets:t,onSelected:r}){const[n,o]=reactExports.useState(""),i=reactExports.useMemo((()=>""===n?t:t.filter((e=>e.name.includes(n)))),[n,t]);return jsxs("div",{className:"related-widget-selector",children:[jsx("div",{className:"related-field-title",children:duchampIntl.get("Duchamp-Select_Field")}),jsx(Search,{placeholder:duchampIntl.get("Duchamp-Reuse_Search_Widget"),onChange:e=>{o(e)}}),jsx(RelatedWidgetList,{showAllWidgets:e,widgets:i,onClick:r})]})}function RelatedFieldList({value:e,showAllWidgets:t,onAdd:r,onChange:n,onEdit:o}){const i=useFocusPointTarget(),a=getFieldCount(e)<10;return jsxs("div",{className:"related-field-list",children:[jsx("div",{children:jsx(Tooltip$1,{placement:"right",content:a?null:duchampIntl.get("Duchamp-Add_Field_Limit_Tips",10),children:jsx(IconTextButton,{icon:"icon-add",disabled:!a,text:duchampIntl.get("Duchamp-Add_Field"),onClick:r,"data-focus-point":{id:"S231",getTarget:()=>i}})})}),jsx("div",{className:"field-list",children:e.length>0?jsx(RelatedFieldListDetail,{value:e,showAllWidgets:t,onChange:n,onEdit:o}):jsx("div",{className:"empty-bg",children:jsx(Empty$1,{image:"/assets/system/empty_controller.svg",description:duchampIntl.get("Duchamp-Add_Field_Tips")})})})]})}function RelatedFieldListDetail({value:e,showAllWidgets:t,onChange:r,onEdit:n}){const{crudService:o}=useService(),i=useStore(),a=useRelationWidgets(t),s=useFocusPointTarget(),{loading:l,value:c=[]}=useAsync((async()=>{const r=await Promise.all(union(e.map((e=>e.table))).map((e=>o.getTableInfo(e).catch((()=>({id:e,name:"",error:!0,fields:[]})))))),n=Array.from(new Set(a.map((e=>e.relationWidgetId)))),s=new Map,l=Array.from(new Set(e.map((e=>e.table)))),c=await o.getTableRelations(n,l),{tableRelations:u}=c;for(const t of e){const{table:e,widget:r}=t;s.has(r)||s.set(r,a.some((t=>{var n;const o=null!=(n=u&&u[t.table])?n:[];return t.id===r&&(o.includes(e)||t.table===e||isRelationWidgetTable(t,e))})))}return createShowWidgetTreeData(e,r,i,t,Object.fromEntries(s))}),[e]);if(l&&0===c.length)return jsx(Spin$1,{});const u=({node:t})=>{const{table:o,field:i,key:a,isWidget:l,isPage:c,widgets:u=[]}=t.data;return l?jsx("div",{className:"table-toolbar",children:jsx(Icon$2,{type:"icon-delete",title:duchampIntl.get("Duchamp-Delete"),onClick:t=>{r(e.filter((e=>e.widget!==a))),t.stopPropagation()}})}):c?jsx("div",{className:"table-toolbar",children:jsx(Icon$2,{type:"icon-delete",title:duchampIntl.get("Duchamp-Delete"),onClick:t=>{r(e.filter((e=>!u.includes(e.widget)))),t.stopPropagation()}})}):jsxs("div",{className:"table-toolbar",children:[jsx(Icon$2,{type:"icon-edit",title:duchampIntl.get("Duchamp-Edit"),onClick:e=>{n(o,i),e.stopPropagation()}}),jsx(Icon$2,{type:"icon-delete",title:duchampIntl.get("Duchamp-Delete"),"data-focus-point":{id:"S232",getTarget:()=>s},onClick:t=>{r(e.filter((e=>e.table!==o||e.field!==i))),t.stopPropagation()}})]})};return jsx(Tree,{treeData:c.filter((t=>e.some((e=>e.table===t.table)))),treeNodeRender:e=>jsx(TreeNode$1,{node:e,iconRender:TreeNodeIcon,toolbarRender:u})})}function TreeNodeIcon({type:e}){if(!e)return null;const t=getWidgetIconCode(e);return jsx(Icon$2,{type:t})}function RelatedWidgetList({widgets:e,showAllWidgets:t,onClick:r}){return 0===e.length?jsx("div",{className:"tip",children:duchampIntl.get("Duchamp-No_Components")}):t?jsx(Tree,{treeData:getWidgetsWithGroup(e),treeNodeRender:e=>jsx(TreeNode$1,{node:e,iconRender:TreeNodeIcon}),onClick:t=>{const n=e.find((e=>e.id===t.key));n&&r(n)}}):jsx("div",{className:"duchamp-widget-selector",children:e.map((e=>jsxs("div",{className:"widget-item",onClick:()=>{r(e)},children:[jsx(Icon$2,{type:getWidgetIconCode(e.type)}),jsx(SingleLineEllipsis,{className:"widget-item-text",children:e.name})]},e.id)))})}function getEditingTable(e,t){const r=t.find((t=>isRelationWidgetTable(t,e)));return r?{table:r.table,relationWidgetId:r.relationWidgetId}:{table:e,relationWidgetId:""}}function getWidgetsWithGroup(e){const t=new Map;return e.forEach((e=>{const r=t.get(e.storyIndex);r?r.widgets.push(e):t.set(e.storyIndex,{name:e.storyName,widgets:[e]})})),Array.from(t).map((([e,t])=>({title:t.name,key:"".concat(e),children:t.widgets.map((e=>({title:e.name,key:e.id,type:e.type})))})))}function FieldHelp({table:e,field:t}){const{crudService:r}=useService(),{value:n}=useAsync((()=>r.getTableInfo(e)),[e]);if(!n)return null;const o=n.fields.find((e=>e.id===t));return o?jsx(IconPopover,{arrow:{pointAtCenter:!0},icon:"icon-help",placement:"top-left",autoAdjustOverflow:!0,overlayInnerStyle:{maxWidth:"250px"},className:"fvs-field-help",text:jsxs("div",{className:"fvs-field-help-tip",children:[jsx("div",{children:duchampIntl.get("Duchamp-Bind")}),jsx("div",{className:"field-name",children:" [".concat(n.name,"-").concat(o.name,"] ")}),jsx("div",{children:duchampIntl.get("Duchamp-Field")})]})}):null}function getSelectedWidgets(e,t){const r=new Set(e);return t.forEach(((e,t)=>{e?r.add(t):r.delete(t)})),Array.from(r)}function getValueWithRecommend(e,t){const r=new Map(t),n=e.reduce(((e,n)=>{if(t.has(n.widget)){const r=t.get(n.widget);r&&e.push(r)}else e.push(n);return r.delete(n.widget),e}),[]);return r.size>0&&Array.from(r).forEach((([e,t])=>{t&&n.push(t)})),n}function RelatedField(e){var t,r;const n=useFocusPointTarget(),[o,i]=reactExports.useState(!1);return jsxs(Fragment,{children:[jsx(Button$4,{block:!0,"data-focus-point":{id:"S230",getTarget:()=>n},onClick:()=>{i(!0)},children:duchampIntl.get("Duchamp-Set_Up")}),jsx(RelatedFieldConfigModal,{value:e.value,visible:o,dataType:null!=(t=e.dataType)?t:"string",showAllWidgets:null!=(r=e.showAllWidgets)&&r,onCancel:()=>{i(!1)},onOk:t=>{i(!1),e.onChange(t)}})]})}const SearchAllConfig=({value:e,onChange:t})=>jsx(Checkbox$4,{value:e,onChange:e=>{t(e)},children:duchampIntl.get("Duchamp-Search_All_When_Empty")}),AuthorityConfig=observer((({value:e,onChange:t})=>jsx(Checkbox$4,{value:e,onChange:e=>{t(e)},children:duchampIntl.get("Duchamp-Enable_On_Preview")})));var baseIteratee$1=_baseIteratee,baseUniq=_baseUniq;function uniqBy(e,t){return e&&e.length?baseUniq(e,baseIteratee$1(t)):[]}var uniqBy_1=uniqBy;const uniqBy$1=getDefaultExportFromCjs$1(uniqBy_1),InputItem=reactExports.forwardRef(((e,t)=>{const[r,n]=reactExports.useState(!1),{value:o,setIsItemEdit:i,sortValue:a,setSortValue:s,defaultValue:l,setDefaultValue:c}=e;return jsx(Tooltip$1,{trigger:"focus",placement:"top-left",effect:"light",overlayClassName:"fvs-custom-sort-item-tooltip",content:duchampIntl.get("Duchamp-Data_Dictionary_Add_Custom_Sort_Warning"),arrow:!1,visible:r,children:jsxs("div",{className:"custom-sort-item",ref:t,children:[jsx(Icon$2,{type:"icon-drag-horizontal"}),jsx(Input$2,{autoFocus:!0,value:o.value,status:r?"error":void 0,placeholder:duchampIntl.get("Duchamp-Data_Dictionary_Sort_Input_Tip"),onBlur:()=>{i(!1)},onKeyUp:e=>{const t=get$5(e,"target.value");find$2(a,(e=>e.value===t))&&""!==t?n(!0):n(!1)},onKeyDown:e=>{"Enter"===e.key&&i(!1)},onChange:e=>{const t=[...a],n=[...l],i=findIndex$3(t,(e=>e.id===o.id));if(-1!==i)if(isEmpty$3(e)||r)t.splice(i,1);else{const r=find$2(n,(t=>t.value===e));r&&(r.visible=!1,c(n)),t[i]={id:o.id,value:e,visible:!0}}s(t)}})]})})}));InputItem.displayName="InputItem";const CUSTOM_VALUE_SORT_ITEM="custom-value-sort-item",CustomValueSortableItem=({id:e,value:t,onSort:r,children:n,isCustomValue:o=!1,className:i})=>{const[,a]=useDrop((()=>({accept:CUSTOM_VALUE_SORT_ITEM,canDrop:()=>!1,hover:e=>{const n=e.value;n!==t&&r(n)},collect:e=>({isOver:e.isOver()})})),[t,r]),[,s]=useDrag$2((()=>({type:CUSTOM_VALUE_SORT_ITEM,item:{id:e,value:t},collect:e=>({isDragging:e.isDragging()}),canDrag:()=>!o,end:(e,t)=>{const{value:n}=e;t.didDrop()||r(n)}})),[e,r]);return jsx("div",{className:classNames$1(i,"sortable-pane-item"),ref:e=>s(a(e)),children:n})},SortedValueList=observer((e=>{const{className:t,itemClassName:r,defaultValue:n,sortValue:o,sortLengthText:i,isItemEdit:a,inputContainer:s,renderItem:l,setDefaultValue:c,setSortValue:u,setIsItemEdit:d}=e,[{canDrop:h,isDragging:p},f]=useDrop((()=>({accept:CUSTOM_VALUE_SORT_ITEM,canDrop:()=>o.length<MAX_DATA_LENGTH,collect:e=>({isOver:e.isOver(),canDrop:e.canDrop(),isDragging:!!e.getItem()})}))),g=()=>{const e={id:uuid$2(),value:"",visible:!0,isCustomItem:!0},t=[...o];t.push(e),d(!0),u(t),setTimeout((()=>{null==s||s.scrollIntoView({behavior:"smooth"})}),10)};return jsxs("div",{className:"custom-value-sort-list",children:[jsxs("div",{className:"custom-value-sort-list-title",children:[jsx("div",{className:"sort-list-title-content",children:duchampIntl.get("Duchamp-Data_Dictionary_Customary_Sort_Item",i)}),(null==o?void 0:o.length)>0&&!a&&jsx(Icon$2,{type:"icon-delete",className:"icon-delete",title:duchampIntl.get("Duchamp-Empty"),onClick:()=>{const e=[...n];forEach$3(o,(t=>{const r=findIndex$3(e,(e=>e.value===t.value));-1!==r&&(e[r].visible=!0)})),c(e),u([])}}),o.length>=MAX_DATA_LENGTH?jsx(Tooltip$1,{content:duchampIntl.get("Duchamp-Data_Dictionary_Sort_Warning_Tip",MAX_DATA_LENGTH),placement:"bottom-left",arrow:!1,effect:"dark",children:jsx("div",{children:jsx(Button$4,{type:"text",disabled:o.length>=MAX_DATA_LENGTH,onClick:g,icon:jsx(Icon$2,{type:"icon-enlarge",className:"icon-enlarge disabled"}),children:duchampIntl.get("Duchamp-Data_Dictionary_Add_Sort_Items")})})}):jsx(Button$4,{type:"text",disabled:o.length>=MAX_DATA_LENGTH,onClick:g,icon:jsx(Icon$2,{type:"icon-enlarge",className:"icon-enlarge"}),children:duchampIntl.get("Duchamp-Data_Dictionary_Add_Sort_Items")})]}),jsx("div",{ref:e=>{f(e)},className:classNames$1(t,"value-sort-item-list",{dragging:h}),children:isEmpty$3(o)?jsx(Empty$1,{className:"sort-empty-tip",image:"/assets/system/empty_drag_item.svg",description:duchampIntl.get("Duchamp-Data_Dictionary_Sort_Add_Tip")}):map$3(o,((e,t)=>jsx(CustomValueSortableItem,{id:e.id,value:e.value,isCustomValue:e.isCustomItem,onSort:e=>{const r=[...o],i=o.findIndex((t=>t.value===e));if(o.find((e=>-1===e.id))){const t=n.find((t=>t.value===e));t&&(r[i]={...t,id:uuid$2(),visible:!0,selected:!0})}arrayMove(r,i,t),u(r)},className:r,children:l(e,!1,p)},e.id)))}),o.length>=MAX_DATA_LENGTH&&jsx("div",{className:"exceed-tip",children:duchampIntl.get("Duchamp-Data_Dictionary_Sort_Warning_Tip",MAX_DATA_LENGTH)})]})})),CustomValueDraggableItem=({onDrag:e,item:t,children:r,className:n,sortedValue:o,deleteValueItem:i,multiSelectedValueArr:a,clearMultiSelectedValueArr:s})=>{const[,l]=useDrag$2((()=>({type:CUSTOM_VALUE_SORT_ITEM,canDrag:()=>o.length<MAX_DATA_LENGTH,item:()=>(o.find((e=>-1===e.id||e.value===t.value))||e([{value:t.value,id:-1},...o]),t),collect:e=>({isDragging:e.isDragging()}),end:(r,n)=>{const l=o.findIndex((e=>e.value===r.value)),c=[...o];if(n.didDrop()&&-1!==l)if(a.length>0){const e=MAX_DATA_LENGTH-c.length+1,t=a.slice(0,e);c.splice(l,1,...t),s(),forEach$3(t,(e=>{i(e.value)}))}else c.splice(l,1,{...n.getItem(),visible:!0,id:uuid$2()}),i(t.value);else c.splice(l,1);e(c)}})),[t.id,e]);return jsx("div",{className:classNames$1(n,"sortable-pane-item"),ref:e=>l(e),children:r})},UnSortValueList=observer((e=>{const{className:t,itemClassName:r,dragValue:n,defaultValue:o,itemRender:i,addSortItems:a,...s}=e,l=reactExports.useMemo((()=>o.filter((e=>e.visible)).length),[o]);return jsxs("div",{className:"custom-value-sort-list",children:[jsxs("div",{className:"custom-value-sort-list-title",children:[jsx("div",{className:"sort-list-title-content",children:duchampIntl.get("Duchamp-Data_Dictionary_Uncustomary_Sort_Item")}),l>0&&jsx(Button$4,{type:"text",onClick:a,children:duchampIntl.get("Duchamp-Data_Dictionary_Sort_Items")})]}),0!==o.length&&find$2(o,(e=>null==e?void 0:e.visible))?jsx("div",{className:classNames$1(t,"value-sort-item-list"),children:n.map((e=>createElement(CustomValueDraggableItem,{...s,key:e.id,item:e,className:r},i(e,!0))))}):jsx(Empty$1,{image:"/assets/system/empty_drag_item.svg",className:"sort-empty-tip",description:duchampIntl.get("Duchamp-Data_Dictionary_UnSort_Tip")}),l>=MAX_DATA_LENGTH&&jsx("div",{className:"unsort-exceed-tip",children:duchampIntl.get("Duchamp-Data_Dictionary_Sort_Warning",MAX_DATA_LENGTH)})]})})),MAX_DATA_LENGTH=100,getDefaultSortValue=e=>isEmpty$3(e)?[]:uniq(e).map((e=>({id:uuid$2(),value:e}))),CustomValueSortConfig=e=>{const{defaultSortedValue:t,dataDictionaryValueArr:r,baseClassName:n,onChange:o}=e,[i,a]=reactExports.useState([]),[s,l]=reactExports.useState(getDefaultSortValue(t)),[c,u]=reactExports.useState([]),[d,h]=reactExports.useState(!1),p=reactExports.useRef([]),f=reactExports.useRef(null),g=reactExports.useRef(null);reactExports.useEffect((()=>{if(isEmpty$3(r)&&isEmpty$3(i))return;const e=getDefaultSortValue(t),n=uniqBy$1(r.map((t=>({id:uuid$2(),value:t,visible:!find$2(e,(e=>e.value===t))}))),"value");p.current=n.slice(0,MAX_DATA_LENGTH),a(n.slice(0,MAX_DATA_LENGTH)),l(e)}),[r]),reactExports.useEffect((()=>{isEmpty$3(t)&&isEmpty$3(s)||o(s)}),[s]);const m=(e,t,r)=>e.isCustomItem&&!t?jsx(InputItem,{ref:f,value:e,defaultValue:i,setDefaultValue:a,setIsItemEdit:h,sortValue:s,setSortValue:l}):jsxs("div",{className:classNames$1("custom-sort-item",!e.visible&&t&&"inVisible",e.selected&&t&&"selected"),onClick:r=>{if(!t)return;const n=[...i];if(isCtrlOrCmdKeyDown(r)){const t=[...c];t.push(e),u(t)}else u([e]),n.forEach((e=>{e.selected=!1}));const o=findIndex$3(n,(t=>t.value===e.value));-1!==o&&(n[o].selected=!0),a(n)},children:[!t&&jsx(Icon$2,{type:"icon-drag-horizontal"}),r?jsx(Typography.Text,{className:"custom-sort-item-content",children:e.value}):jsx(Tooltip$1,{content:e.value,placement:"top-left",effect:"light",children:jsx(Typography.Text,{className:"custom-sort-item-content",children:e.value})}),!t&&jsx(Icon$2,{className:"hover-icon",type:"icon-delete",disabled:t,title:duchampIntl.get("Duchamp-Delete"),onClick:t=>{(e=>{const t=[...s],r=findIndex$3(t,(t=>t.value===e.value));l(t),t.splice(r,1);const n=[...i];if(find$2(n,(t=>t.value===e.value))){const t=findIndex$3(n,(t=>t.value===e.value));-1!==t&&(n[t].visible=!0),a(n)}})(e),t.stopPropagation()}})]});return jsx(DndProvider,{backend:HTML5Backend,options:{rootElement:g.current},context:window,children:jsxs("div",{className:classNames$1("custom-value-sort-pane",n),ref:g,children:[jsx(UnSortValueList,{className:"custom-value-sort-list-content",dragValue:i,sortedValue:s,itemRender:m,onDrag:e=>{l(e)},clearMultiSelectedValueArr:()=>u([]),multiSelectedValueArr:c,addSortItems:()=>(()=>{const e=[...s],t=[...i];let{length:r}=e;forEach$3(t,(t=>{r>=MAX_DATA_LENGTH||!t.visible||(t.visible=!1,e.push(t),r++)})),a(t),l(e)})(),defaultValue:i,deleteValueItem:e=>{const t=[...i],r=findIndex$3(t,(t=>t.value===e));-1!==r&&(t[r].selected=!1,t[r].visible=!1),a(t)}}),jsx(SortedValueList,{inputContainer:f.current,sortLengthText:(null==s?void 0:s.length)>0?duchampIntl.get("Duchamp-Data_Dictionary_Sort_Item_Count",d?s.length-1:s.length):"",defaultValue:i,sortValue:s,isItemEdit:d,setSortValue:l,setDefaultValue:a,setIsItemEdit:h,renderItem:m})]})})},DATA_DICTIONARY_TYPE={CUSTOM:{type:"customData",label:duchampIntl.get("Duchamp-Customize")},QUERY:{type:"dataQuery",label:duchampIntl.get("Duchamp-Data_Query")},TABLE:{type:"dataTable",label:duchampIntl.get("Duchamp-Database_table")},FORMULA:{type:"formula",label:duchampIntl.get("Duchamp-Formula")},AUTO:{type:"auto",label:duchampIntl.get("Duchamp-Automatic_Parse")},FIELD:{type:"widgetField",label:duchampIntl.get("Duchamp-Component_Field")}},VALUE_SORT_TYPE={DEFAULT:"default",ASC:"asc",DESC:"desc",CUSTOM:"custom"},VALUE_TYPE={ACTUAL_VALUE:0,DISPLAY_VALUE:1};function ValueSortConfig(e){const{value:t,onChange:r,fetchData:n,baseClassName:o,dataDictionaryValue:i}=e,[a,s]=reactExports.useState([]),l=reactExports.useRef([]);return reactExports.useEffect((()=>{t.type===VALUE_SORT_TYPE.CUSTOM&&n?n().then((e=>{isEqual$4(e,l.current)||0===e.length||(l.current=e,s(e))})):(l.current=[],s([]))}),[t.type,i]),jsxs(Fragment,{children:[jsx(LineItem,{label:duchampIntl.get("Duchamp-Data_Dictionary_Sort"),children:jsx(RadioGroup$1,{block:!1,optionType:"default",direction:"horizontal",value:t.type||VALUE_SORT_TYPE.DEFAULT,options:[{label:duchampIntl.get("Duchamp-Default"),value:VALUE_SORT_TYPE.DEFAULT},{label:duchampIntl.get("Duchamp-Data_Dictionary_Sort_Asc"),value:VALUE_SORT_TYPE.ASC},{label:duchampIntl.get("Duchamp-Data_Dictionary_Sort_Desc"),value:VALUE_SORT_TYPE.DESC},{label:duchampIntl.get("Duchamp-Customize"),value:VALUE_SORT_TYPE.CUSTOM}],onChange:e=>{r({...t,type:e,item:[]})}})}),"custom"===t.type&&jsx(CustomValueSortConfig,{defaultSortedValue:t.item||[],baseClassName:o,dataDictionaryValueArr:a,onChange:e=>{const n=e.map((e=>e.value));r({...t,item:n})}})]})}const DataAutoConfig=observer((e=>{const{value:t=e.defaultValue,sortConfig:r={},fetchData:n}=e;return jsx(ValueSortConfig,{value:r,fetchData:n,baseClassName:"data-auto-config",dataDictionaryValue:t,onChange:r=>{var n;null==(n=e.onChange)||n.call(e,t,r)}})})),CustomView=e=>{const t=e.value||[],r=settingCenter.controllerConfig.displayValue;return jsxs("div",{className:"data-dict-custom",children:[r&&jsxs(Row$1,{children:[jsx(Col,{span:12,children:duchampIntl.get("Duchamp-Actual_Value")}),jsx(Col,{span:12,children:duchampIntl.get("Duchamp-Display_Value")})]}),jsxs("div",{className:"custom-data-panel",children:[t.map(((n,o)=>jsxs("div",{className:"custom-item",children:[jsx(Input$2,{className:"custom-input",value:n.value,placeholder:r?duchampIntl.get("Duchamp-Actual_Value_Placeholder"):duchampIntl.get("Duchamp-Please_Enter"),onChange:n=>{var i;null==(i=e.onChange)||i.call(e,t.map(((e,t)=>o===t?{...e,value:n,text:r?e.text:n}:e)))}}),r&&jsx(Input$2,{className:"custom-input",value:n.text,placeholder:duchampIntl.get("Duchamp-Display_Value_Placeholder"),onChange:r=>{var n;null==(n=e.onChange)||n.call(e,t.map(((e,t)=>o===t?{...e,text:r}:e)))}}),jsx(Icon$2,{className:"data-dict-icon",type:"icon-delete",title:duchampIntl.get("Duchamp-Delete"),onClick:()=>{var r;const n=[...t];n.splice(o,1),null==(r=e.onChange)||r.call(e,n)}})]},o))),jsx("div",{className:"add-data-item",onClick:()=>{var r;null==(r=e.onChange)||r.call(e,t.concat({text:"",value:""}))},children:jsx(IconTextButton,{icon:"icon-add",text:duchampIntl.get("Duchamp-Add_Data_Item")})})]})]})};function DataCustomConfig(e){const{value:t=e.defaultValue,onChange:r}=e;return jsx(CustomView,{value:t.value,onChange:e=>{null==r||r({...t,value:e})}})}const DataFieldConfig=observer((e=>{var t,r;const{value:n=e.defaultValue,showAllWidgets:o=!1,sortConfig:i={},fetchData:a}=e,s=useStore(),l=reactExports.useMemo((()=>o?getAllRelationWidgets(s):getRelationWidgets(s.story)),[o,s]),c=reactExports.useMemo((()=>{if(!n.widget)return null;const e=l.find((e=>e.id===n.widget));if(!e)return n.table||null;const{relationMeta:t}=e;return{table:t.tableId,widget:t.wId}}),[n.widget,l,n.table]),{tables:u,loading:d,loadChildren:h,error:p}=useTableField(c,"string"),f=n.field?getTableFiledKey(n.table,n.field):"",g=p||n.field&&!d&&!(null==(r=null==(t=u.find((e=>e.key===n.table)))?void 0:t.children)?void 0:r.find((e=>e.key===f)));return jsxs(Fragment,{children:[jsx(LineItem,{label:duchampIntl.get("Duchamp-Component"),children:jsx(o?WidgetTreeSelector:WidgetSelector,{value:n,onChange:t=>{var r;null==(r=e.onChange)||r.call(e,t)}})}),jsx(LineItem,{label:duchampIntl.get("Duchamp-Field"),children:jsx(TreeSelect$1,{showSearch:!0,className:classNames$1({error:g}),style:{width:"100%"},value:p||u.length>0?g?duchampIntl.get("Duchamp-Field_Deleted"):f:"",treeDefaultExpandedKeys:n.table?[n.table]:[],onChange:t=>{var r,o,i;if(t)for(const a of u){const r=null==(o=a.children)?void 0:o.find((e=>e.key===t));if(r)return void(null==(i=e.onChange)||i.call(e,{...n,table:a.key,field:getOriginalFieldId(r.key,a.key)}))}else null==(r=e.onChange)||r.call(e,{...n,table:"",field:""})},allowClear:!0,treeData:u.map((e=>({key:e.key,title:e.error?jsx("div",{className:"data-node-error-tip",children:duchampIntl.get("Duchamp-Data_Error")}):e.title,selectable:!1,children:e.children}))),treeIcon:TreeNodeIcon$1,treeExpandArea:"node",onLoadData:async e=>{const t=toString$6(e.key);return h(t)}})}),jsx(ValueSortConfig,{value:i,fetchData:a,dataDictionaryValue:n,onChange:t=>{var r;null==(r=e.onChange)||r.call(e,n,t)}})]})}));function WidgetSelector({value:e,onChange:t}){const r=useStore(),n=reactExports.useMemo((()=>getRelationWidgets(r.story)),[r]),o=e.widget&&!n.find((t=>t.id===e.widget));return jsx(Select$1,{style:{width:"100%"},className:classNames$1({error:o}),value:o?duchampIntl.get("Duchamp-Components_Deleted"):e.widget,options:n.map((e=>({icon:jsx(Icon$2,{type:getWidgetIconCode(e.type)}),label:e.name,value:e.id}))),onChange:r=>{null==t||t({...e,widget:r,table:"",field:""})}})}function WidgetTreeSelector({value:e,onChange:t}){const r=useStore(),n=reactExports.useMemo((()=>r.stories.reduce(((e,t)=>(t.widgets.length>0&&e.push({name:t.name,id:t.id,widgets:getRelationWidgets(t)}),e)),[])),[r]),o=reactExports.useMemo((()=>n.map((e=>({key:e.id,title:e.name,selectable:!1,children:e.widgets.map((e=>({key:e.id,title:e.name,type:e.type})))})))),[n]),i=e.widget&&!n.some((t=>t.widgets.some((t=>t.id===e.widget)))),a={width:"100%",...i?{color:"red"}:{}},s=reactExports.useMemo((()=>{if(i||!e.widget)return[];const t=o.find((t=>t.children.some((t=>t.key===e.widget))));return t?[t.key]:[]}),[i,e.widget,o]);return jsx(TreeSelect$1,{showSearch:!0,treeDefaultExpandedKeys:s,style:a,value:i?duchampIntl.get("Duchamp-Components_Deleted"):e.widget,onChange:r=>{null==t||t({...e,widget:toString$6(r),table:"",field:""})},status:i?"error":"success",allowClear:!0,treeExpandArea:"node",treeData:o,treeIcon:TreeWidgetNodeIcon})}function TreeWidgetNodeIcon(e){return isObject$e(e)&&"type"in e?jsx(Icon$2,{type:getWidgetIconCode(toString$6(e.type))}):null}function FormulaConfig(e){return jsx(LineItem,{label:e.label,children:jsx(FormulaInput,{directInput:!0,value:e.value.value,onChange:t=>{e.onChange({...e.value,value:t})}})})}function DataFormulaConfig(e){const{value:t=e.defaultValue,sortConfig:r={},fetchData:n}=e;return jsxs(Fragment,{children:[jsx(FormulaConfig,{label:duchampIntl.get("Duchamp-Actual_Value"),value:t.itemValue,onChange:r=>{var n;null==(n=e.onChange)||n.call(e,{...t,itemValue:r})}}),jsx(FormulaConfig,{label:duchampIntl.get("Duchamp-Display_Value"),value:t.itemText,onChange:r=>{var n;null==(n=e.onChange)||n.call(e,{...t,itemText:r})}}),jsx(ValueSortConfig,{value:r,fetchData:n,dataDictionaryValue:t,onChange:r=>{var n;null==(n=e.onChange)||n.call(e,t,r)}})]})}function useAsyncColNumber(e){return useAsyncFn((async()=>(await e()).map(((e,t)=>({text:String(t+1),value:String(t+1)})))),[e])}function useAsyncColName(e){return useAsyncFn((async()=>(await e()).map((e=>({text:e,value:e})))),[e])}const{Option:Option$5}=Select$1;function SelectWithAsyncLoad(e){var t;const{style:r,value:n,onFetch:o,result:i,onChange:a,showSearch:s,...l}=e;return jsx(Select$1,{showSearch:s,style:{width:"100%",...r},value:n,onDropdownVisibleChange:e=>{e&&(null==o||o())},onChange:e=>{null==a||a(e)},notFoundContent:i.loading?jsx(Spin$1,{size:"small"}):null,...l,children:null==(t=i.value)?void 0:t.map((e=>jsx(Option$5,{value:e.value,children:e.text},e.value)))})}function ActualValueConfig(e){const{value:t,columnFetcher:r}=e,[n,o]=useAsyncColName(r),[i,a]=useAsyncColNumber(r);return jsxs(Fragment,{children:[jsx(LineItem,{label:duchampIntl.get("Duchamp-Actual_Value"),children:jsx(RadioGroup$1,{block:!1,value:t.type,options:[{label:duchampIntl.get("Duchamp-Column_Name"),value:"name"},{label:duchampIntl.get("Duchamp-Column_Number"),value:"index"}],onChange:r=>{e.onChange({...t,type:r,value:"index"===r?0:""})}})}),jsxs(LineItem,{label:"",children:["name"===t.type&&jsx(SelectWithAsyncLoad,{value:t.value,style:{width:"100%"},onFetch:o,result:n,onChange:r=>{e.onChange({...t,value:r})}}),"index"===t.type&&jsx(SelectWithAsyncLoad,{value:"".concat(toNumber$7(t.value)+1),style:{width:"100%"},onFetch:a,result:i,onChange:r=>{e.onChange({...t,value:toNumber$7(r)-1})}})]})]})}function DisplayValueConfig(e){const{value:t,columnFetcher:r}=e,[n,o]=useAsyncColName(r),[i,a]=useAsyncColNumber(r);return jsxs(Fragment,{children:[jsx(LineItem,{label:duchampIntl.get("Duchamp-Display_Value"),children:jsx(RadioGroup$1,{block:!1,value:t.type,options:[{label:duchampIntl.get("Duchamp-Column_Name"),value:"name"},{label:duchampIntl.get("Duchamp-Column_Number"),value:"index"},{label:duchampIntl.get("Duchamp-Formula"),value:"formula"}],onChange:r=>{e.onChange({...t,type:r,value:"index"===r?0:""})}})}),jsxs(LineItem,{label:"",children:["name"===t.type&&jsx(SelectWithAsyncLoad,{value:t.value,style:{width:"100%"},onFetch:o,result:n,onChange:r=>{e.onChange({...t,value:r})}}),"index"===t.type&&jsx(SelectWithAsyncLoad,{value:"".concat(toNumber$7(t.value)+1),style:{width:"100%"},onFetch:a,result:i,onChange:r=>{e.onChange({...t,value:toNumber$7(r)-1})}}),"formula"===t.type&&jsx(FormulaInput,{directInput:!0,value:t.value,onChange:r=>{e.onChange({...t,value:r})}})]})]})}const DataQueryConfig=observer((e=>{const{value:t=e.defaultValue,defaultValue:r,sortConfig:n={index:VALUE_TYPE.DISPLAY_VALUE},fetchData:o}=e,{crudService:i}=useService(),[a,s]=useAsyncFn((async()=>(await i.getTables()).map((e=>({text:e.name,value:e.id})))),[]),l=reactExports.useCallback((()=>i.getTableInfo(t.datasetName).then((e=>e.fields.map((e=>e.id))))),[t.datasetName]);return jsxs(Fragment,{children:[jsx(LineItem,{label:duchampIntl.get("Duchamp-Data_Set"),children:jsxs("div",{style:{display:"flex"},children:[jsx(SelectWithAsyncLoad,{style:{flex:1},value:t.datasetName,onFetch:s,result:a,onChange:t=>{var n;null==(n=e.onChange)||n.call(e,{...r,datasetName:t})}}),jsx(Icon$2,{className:"data-dict-icon",type:"icon-view-data",title:duchampIntl.get("Duchamp-Preview"),onClick:()=>{t.datasetName&&i.openDatasetTablePreview(t.datasetName)}})]})}),jsx(ActualValueConfig,{value:t.itemValue,onChange:r=>{var n;null==(n=e.onChange)||n.call(e,{...t,itemValue:r})},columnFetcher:l}),jsx(DisplayValueConfig,{value:t.itemText,onChange:r=>{var n;null==(n=e.onChange)||n.call(e,{...t,itemText:r})},columnFetcher:l}),jsx(ValueSortConfig,{value:n,fetchData:o,dataDictionaryValue:t,onChange:r=>{var n;null==(n=e.onChange)||n.call(e,t,r)}})]})})),DataTableConfig=observer((e=>{const{crudService:t}=useService(),{value:r=e.defaultValue,defaultValue:n,sortConfig:o={index:VALUE_TYPE.DISPLAY_VALUE},fetchData:i}=e,[a,s]=useAsyncFn((async()=>(await t.getDBSchemas(r.database)).map((e=>({text:e,value:e})))),[r.database]),[l,c]=useAsyncFn((async()=>(await t.getDBConnections()).map((e=>({text:e,value:e})))),[]),[u,d]=useAsyncFn((async e=>(await t.getDBTables(r.database,r.schema,e)).map((e=>({text:e,value:e})))),[r.database,r.schema]),h=reactExports.useCallback((()=>t.getDBTableColumns(r.database,r.schema,r.tableName)),[r.database,r.schema,r.tableName]);return jsxs(Fragment,{children:[jsx(LineItem,{label:duchampIntl.get("Duchamp-Database"),children:jsx(SelectWithAsyncLoad,{value:r.database,onFetch:c,result:l,onChange:t=>{var r;null==(r=e.onChange)||r.call(e,{...n,database:t})}})}),jsx(LineItem,{label:duchampIntl.get("Duchamp-Schema"),children:jsx(SelectWithAsyncLoad,{onFetch:s,result:a,value:r.schema,onChange:t=>{var o;null==(o=e.onChange)||o.call(e,{...n,database:r.database,schema:t})}})}),jsx(LineItem,{label:duchampIntl.get("Duchamp-Database_table"),children:jsxs("div",{style:{display:"flex"},children:[jsx(SelectWithAsyncLoad,{style:{flex:1},showSearch:!0,onFetch:()=>{d(!1)},result:u,value:r.tableName,onChange:t=>{var o;null==(o=e.onChange)||o.call(e,{...n,database:r.database,schema:r.schema,tableName:t})}}),jsx(Icon$2,{className:"data-dict-icon",type:"icon-whirl",title:duchampIntl.get("Duchamp-Refresh_Database"),onClick:()=>{c(),s(),d(!0)}}),jsx(Icon$2,{className:"data-dict-icon",type:"icon-view-data",title:duchampIntl.get("Duchamp-Preview"),onClick:()=>{t.openDBTablePreview(r.database,r.schema,r.tableName)}})]})}),jsx(ActualValueConfig,{value:r.itemValue,onChange:t=>{var n;null==(n=e.onChange)||n.call(e,{...r,itemValue:t})},columnFetcher:h}),jsx(DisplayValueConfig,{value:r.itemText,onChange:t=>{var n;null==(n=e.onChange)||n.call(e,{...r,itemText:t})},columnFetcher:h}),jsx(ValueSortConfig,{value:o,fetchData:i,dataDictionaryValue:r,onChange:t=>{var n;null==(n=e.onChange)||n.call(e,r,t)}})]})}));function DataDictionarySelectorOption(e){return jsx(Fragment,{})}function DataDictionarySelector(e){var t;const{children:r,value:n,onChange:o}=e,i=Array.isArray(r)?r:[r];let a=null==(t=i.find((e=>e.props.value===n.type)))?void 0:t.props.children;return a&&a.props&&(a=reactExports.cloneElement(a,{...a.props,value:n,onChange:o})),jsxs(GridItem,{children:[jsx(LineItem,{label:duchampIntl.get("Duchamp-Type_Settings"),children:jsx(Select$1,{style:{width:"100%"},onChange:e=>{var t,r;o(null==(r=null==(t=i.find((t=>t.props.value===e)))?void 0:t.props.children)?void 0:r.props.defaultValue)},value:isCanUseConfigType(n.type)?n.type:void 0,children:i.map((e=>jsx(Select$1.Option,{text:e.props.label,value:e.props.value,children:e.props.label},e.props.value)))})}),a]})}function createDefaultDataCustomConfig(){return{type:DATA_DICTIONARY_TYPE.CUSTOM.type,value:[{text:"",value:""}]}}function createDefaultDataFormulaConfig(){return{type:DATA_DICTIONARY_TYPE.FORMULA.type,itemValue:{type:"formula",value:""},itemText:{type:"formula",value:""}}}function createDefaultDataQueryConfig(){return{type:DATA_DICTIONARY_TYPE.QUERY.type,datasetName:"",itemValue:{type:"name",value:""},itemText:{type:"name",value:""}}}function createDefaultDataTableConfig(){return{type:DATA_DICTIONARY_TYPE.TABLE.type,database:"",schema:"",tableName:"",itemValue:{type:"name",value:""},itemText:{type:"name",value:""}}}DataDictionarySelector.Option=DataDictionarySelectorOption;const{Option:Option$4}=DataDictionarySelector,DATA_DICTIONARY_CONFIG_LIST=[{type:DATA_DICTIONARY_TYPE.AUTO.type,label:DATA_DICTIONARY_TYPE.AUTO.label,config:DataAutoConfig,filter:SETTING_CONTROLLER_SOURCE_TYPE.AUTO,defaultValue:{type:DATA_DICTIONARY_TYPE.AUTO.type}},{type:DATA_DICTIONARY_TYPE.TABLE.type,label:DATA_DICTIONARY_TYPE.TABLE.label,config:DataTableConfig,filter:SETTING_CONTROLLER_SOURCE_TYPE.DATA_TABLE,defaultValue:createDefaultDataTableConfig()},{type:DATA_DICTIONARY_TYPE.FIELD.type,label:DATA_DICTIONARY_TYPE.FIELD.label,config:DataFieldConfig,filter:SETTING_CONTROLLER_SOURCE_TYPE.CHART,defaultValue:{type:DATA_DICTIONARY_TYPE.FIELD.type,table:"",field:""}},{type:DATA_DICTIONARY_TYPE.QUERY.type,label:DATA_DICTIONARY_TYPE.QUERY.label,config:DataQueryConfig,filter:SETTING_CONTROLLER_SOURCE_TYPE.DATA_QUERY,defaultValue:createDefaultDataQueryConfig()},{type:DATA_DICTIONARY_TYPE.CUSTOM.type,label:DATA_DICTIONARY_TYPE.CUSTOM.label,config:DataCustomConfig,filter:SETTING_CONTROLLER_SOURCE_TYPE.CUSTOM,defaultValue:createDefaultDataCustomConfig()},{type:DATA_DICTIONARY_TYPE.FORMULA.type,label:DATA_DICTIONARY_TYPE.FORMULA.label,config:DataFormulaConfig,filter:"formula",defaultValue:createDefaultDataFormulaConfig()}];function DataDictionary(e){const{value:t,onChange:r}=e;return jsx(DataDictionarySelector,{value:t,onChange:r,children:getConfigListCanUse().map((t=>jsx(Option$4,{label:t.label,value:t.type,children:jsx(t.config,{defaultValue:t.defaultValue,showAllWidgets:e.showAllWidgets,repeatable:e.repeatable,relatedFields:e.relatedFields,sortConfig:e.sortConfig,fetchData:e.fetchData})},t.type)))})}function getConfigListCanUseFilter(){const e=settingCenter.controllerConfig.source;return settingCenter.app.service.formula.enable&&e.push("formula"),e}function getConfigListCanUse(){const e=getConfigListCanUseFilter();return DATA_DICTIONARY_CONFIG_LIST.filter((t=>e.includes(t.filter)))}function getDataDictionaryLabel(e){var t,r;return null!=(r=null==(t=DATA_DICTIONARY_CONFIG_LIST.find((t=>t.type===e)))?void 0:t.label)?r:""}function isCanUseConfigType(e){var t,r;const n=getConfigListCanUseFilter(),o=null!=(r=null==(t=DATA_DICTIONARY_CONFIG_LIST.find((t=>t.type===e)))?void 0:t.filter)?r:"";return n.includes(o)}function getDataDictionaryDefaultValue(){const e=first(getConfigListCanUse());return e?e.defaultValue:createDefaultDataTableConfig()}function DataDictionaryModal(e){const[t,r]=useSyncState(e.value),[n,o]=useSyncState(e.sortConfig),i=useStore(),{repeatable:a=!1,relatedFields:s=[]}=e;return jsx(FVSDialog,{visible:e.visible,title:duchampIntl.get("Duchamp-Option_Source"),onOk:()=>{e.onOk(t,n)},onCancel:()=>{e.onCancel(),r(e.value),o(e.sortConfig)},maskClosable:!1,children:jsx(DataDictionary,{value:t,repeatable:e.repeatable,sortConfig:n,showAllWidgets:e.showAllWidgets,fetchData:async()=>{var e;if(t){const r=getDataFieldConfig({value:t,repeatable:a},s,!0),n="".concat(uuid$1(),".DataDictionary"),o=getDataValue((await i.calculateCenter.calculateFieldConfigs(new Map([[n,r]]),!1,!1)).get(n));return uniq(null!=(e=null==o?void 0:o.map((e=>e.text)))?e:[])}return[]},onChange:(e,t)=>{r(e),t?o(t):(null==n?void 0:n.type)===VALUE_SORT_TYPE.CUSTOM&&o({...n,item:[]})}})})}const DataItems=observer((e=>{var t;const{value:r=getDataDictionaryDefaultValue(),repeatable:n=!1,sortConfig:o}=null!=(t=e.value)?t:{},[i,a]=reactExports.useState(!1),{allowDuplicateRemoval:s}=settingCenter.controllerConfig;return jsxs("div",{className:"fvs-dataset-config",children:[jsx(LabelInnerItem,{isBottom:!s,children:jsxs("div",{className:"fvs-dataset-config-input",children:[jsx(Input$2,{disabled:!0,value:isCanUseConfigType(r.type)?getDataDictionaryLabel(r.type):duchampIntl.get("Duchamp-Deleted")}),jsx(Icon$2,{className:"dataset-icon",type:"icon-popup",title:duchampIntl.get("Duchamp-Option_Source"),onClick:()=>{a(!0)}})]})}),s?jsx(LabelInnerItem,{isBottom:!0,children:jsx(Checkbox$4,{value:!n,onChange:t=>e.onChange({value:r,repeatable:!t}),children:duchampIntl.get("Duchamp-Remove_Duplicates")})}):null,jsx(DataDictionaryModal,{visible:i,value:toJS(r),showAllWidgets:e.showAllWidgets,relatedFields:e.relatedFields,sortConfig:o,repeatable:n,onCancel:()=>{a(!1)},onOk:(t,r)=>{a(!1),e.onChange({value:t,sortConfig:r,repeatable:n})}})]})}));formItemManager.register("dataConfig",DataItems);const DataConfig=observer((({value:e,onChange:t,showAllWidgets:r,relatedFields:n})=>jsx(DataItems,{value:e,onChange:t,showAllWidgets:r,relatedFields:n}))),TreeDataConfig=observer((({value:e,onChange:t,text:r=""})=>jsxs("div",{className:"fvs-dataset-config-input",children:[jsx(Input$2,{disabled:!0,value:r}),jsx(Icon$2,{className:"dataset-icon",type:"icon-popup",title:duchampIntl.get("Duchamp-Option_Source"),onClick:()=>{fvsService.openTreeDataDictionaryConfig(e,(e=>{t(e)}))}})]}))),DATE_VALUE_TYPE={NONE:"none",DATE:"date",FORMULA:"formula"},VALUE_SOURCES=[{type:DATE_VALUE_TYPE.NONE,text:duchampIntl.get("Duchamp-Unlimited")},{type:DATE_VALUE_TYPE.DATE,text:duchampIntl.get("Duchamp-Customize")},{type:DATE_VALUE_TYPE.FORMULA,text:duchampIntl.get("Duchamp-Formula")}],DateConfig=observer((e=>{const{value:t,format:r}=e;return jsx("div",{className:"controller-value-config",children:jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,children:[jsx(LabelItem$1,{children:jsx(Select$1,{value:t.type||VALUE_SOURCES[0].type,style:{width:"100%"},onChange:t=>{switch(t){case DATE_VALUE_TYPE.NONE:e.onChange({type:DATE_VALUE_TYPE.NONE});break;case DATE_VALUE_TYPE.DATE:e.onChange({type:DATE_VALUE_TYPE.DATE,payload:{date:getDateValueWithFormat(r.value,new Date)}});break;case DATE_VALUE_TYPE.FORMULA:e.onChange({type:DATE_VALUE_TYPE.FORMULA,payload:{formula:""}})}},children:VALUE_SOURCES.map((e=>jsx(Select$1.Option,{value:e.type,children:e.text},e.type)))})}),t.type===DATE_VALUE_TYPE.DATE&&jsx(DateTime$2,{hasClear:!1,showTimeLabel:!0,placeholder:"".concat(duchampIntl.get("Duchamp-Please_Choose")).concat(duchampIntl.get("Duchamp-Date")),format:r.value,onChange:t=>{e.onChange({type:DATE_VALUE_TYPE.DATE,payload:{date:getDateValueWithFormat(r.value,null==t?void 0:t.valueOf())}})},value:dayjs(t.payload.date)}),t.type===DATE_VALUE_TYPE.FORMULA&&jsx(FormulaInput,{value:t.payload.formula,onChange:t=>{e.onChange({type:DATE_VALUE_TYPE.FORMULA,payload:{formula:t}})}})]})})})),DateRangeConfig=observer((({value:e={start:{type:DATE_VALUE_TYPE.NONE},end:{type:DATE_VALUE_TYPE.NONE}},onChange:t,formatConfig:r={type:FORMAT_TYPE.DATE,payload:DEFAULT_FORMAT}})=>{const n=getDateFormatByFormatConfig(r);return jsxs("div",{className:"controller-date-range-config",children:[jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Start_Date"),children:jsx(DateConfig,{format:n,value:e.start||DATE_VALUE_TYPE.NONE,onChange:r=>{t({...e,start:r})}})}),jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-End_Date"),children:jsx(DateConfig,{format:n,value:e.end||DATE_VALUE_TYPE.NONE,onChange:r=>{t({...e,end:r})}})})]})})),DateIntervalWatermarkConfig=observer((({value:e,onChange:t})=>jsxs(Fragment,{children:[jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Start_Date"),children:jsx(Input$2.TextArea,{value:null==e?void 0:e.start,rows:3,placeholder:duchampIntl.get("Duchamp-Please_Input_Default_Value"),onChange:r=>{t({...e,start:r})}})}),jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-End_Date"),children:jsx(Input$2.TextArea,{value:null==e?void 0:e.end,rows:3,placeholder:duchampIntl.get("Duchamp-Please_Input_Default_Value"),onChange:r=>{t({...e,end:r})}})})]}))),FormatConfig=observer((({value:e={type:FORMAT_TYPE.DATE,payload:DEFAULT_FORMAT},onChange:t,dateFormatList:r,supportDateFormatType:n})=>e.type!==FORMAT_TYPE.DATE?null:jsx("div",{className:"controller-format-config",children:jsx(DateFormatConfig,{value:e.payload,onChange:e=>{t({type:FORMAT_TYPE.DATE,payload:e})},dateFormatList:r,supportDateFormatType:n})}))),MultiSelectConfig=observer((({value:e,onChange:t})=>jsx(Checkbox$4,{value:e,onChange:e=>{t(e)},children:duchampIntl.get("Duchamp-Controller_Tree_Options_MultiSection")}))),DATE_INTERVAL_KEY={StartDateValueConfig:"startDateValueConfig",EndDateValueConfig:"endDateValueConfig"},getSubItem=(e,t)=>{switch(e){case DATE_INTERVAL_KEY.StartDateValueConfig:return jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Start_Date"),children:t});case DATE_INTERVAL_KEY.EndDateValueConfig:return jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-End_Date"),children:t});default:return t}},getDataFocusPoint=e=>{switch(e){case DATE_INTERVAL_KEY.StartDateValueConfig:return"S237";case DATE_INTERVAL_KEY.EndDateValueConfig:return"S238";default:return"S235"}},ParameterConfig=observer((({value:e,onChange:t,parametersGetter:r=()=>Promise.resolve([]),repeatValidator:n=()=>!0,canInput:o=!0,dataType:i})=>{const a=useFocusPointTarget();return jsx(Fragment,{children:Array.from(Object.entries(e)).map((([s,l])=>{const c=jsx(ParameterItemConfig,{value:l,"data-focus-point":{id:getDataFocusPoint(s),getTarget:()=>a},canInput:o,dataType:i,onChange:r=>{t({...e,[s]:r})},originValue:e,repeatValidator:e=>n(e,s),parametersGetter:()=>r(s)},s);return getSubItem(s,c)}))})})),ParameterItemConfig=observer((e=>e.canInput?jsx(ParameterItemConfigWithInput,{...e,parametersGetter:async()=>{var t;return(await(null==(t=e.parametersGetter)?void 0:t.call(e))).map((e=>toString$6(e)))}}):jsx(ParameterItemConfigWithDropdown,{...e}))),ParameterItemConfigWithDropdown=observer((({value:e,onChange:t,dataType:r,originValue:n,parametersGetter:o=()=>Promise.resolve([])})=>{const[i,a]=reactExports.useState(null);reactExports.useEffect((()=>{o().then((e=>{a(coverKeyTitle(e,r))}))}),[n]);const s=i&&e&&!valueInTreeData(e,i),l={width:"100%",...s?{color:"red"}:{}};return jsx(TreeSelect$1,{className:"widget-parameter-container",showSearch:!0,style:l,value:i?s?duchampIntl.get("Duchamp-Parameter_Deleted"):e:"",onChange:e=>{t(toString$6(e))},status:s?"error":"success",allowClear:!0,treeDefaultExpandAll:!0,treeExpandArea:"node",treeData:null!=i?i:[],treeIcon:TreeNodeIcon$1})})),ParameterItemConfigWithInput=observer((({value:e,onChange:t,parametersGetter:r=()=>Promise.resolve([]),repeatValidator:n=()=>!0})=>{const o=reactExports.useRef(null),[i,a]=useUpdateValue$1(e,[e]),[s,l]=reactExports.useState([]),c=useValidation(i,[{validate:n,message:duchampIntl.get("Duchamp-Duplicate_Parameter_Exists_Tip")}]),u=e=>{a(e)};return jsxs("div",{className:"widget-parameter-container",ref:o,children:[jsx(AutoComplete,{options:s.filter((t=>i===e||t.includes(i))).map((e=>({value:e,label:e}))),style:{width:"100%"},value:i,onFocus:()=>{r().then((e=>{l(e)}))},onSearch:u,onSelect:u,onBlur:()=>{const r=c?isUndefined$3(c.defaultValue)?e:c.defaultValue:i;a(r),null==t||t(r)},status:c&&"error"}),c?jsx(Tooltip$1,{arrow:{pointAtCenter:!0},content:c.message,placement:"top-right",destroyTooltipOnHide:!0,effect:"error",children:jsx(Icon$2,{className:"err-tip-icon",type:"icon-help"})}):null]})}));function coverKeyTitle(e,t="string"){return e.map((e=>{var r;return isString$3(e)?{key:e,title:e}:{key:e.id,title:e.name,selectable:!1,children:sortByDataType((null!=(r=e.children)?r:[]).map((e=>({key:e.id,title:e.name,type:e.type}))),t)}}))}function valueInTreeData(e,t){return t.some((t=>{var r;return null==(r=t.children)?void 0:r.some((t=>t.key===e))}))}const SPLITOR_OPTIONS=[{value:",",label:duchampIntl.get("Duchamp-Comma")},{value:";",label:duchampIntl.get("Duchamp-Semicolon")},{value:":",label:duchampIntl.get("Duchamp-Colon")}],SIDE_OPTIONS=[{value:"'",label:duchampIntl.get("Duchamp-Single_Quote")},{value:'"',label:duchampIntl.get("Duchamp-Double_Quote")}],LIST_VALUE_SOURCE=[{label:duchampIntl.get("Duchamp-Type_Array"),value:"array"},{label:duchampIntl.get("Duchamp-Type_String"),value:"string"}],DATE_VALUE_SOURCE=[{label:duchampIntl.get("Duchamp-Controller_Date"),value:"date"},{label:duchampIntl.get("Duchamp-Type_String"),value:"string"}],ParseDateValueConfig=observer((({value:e="date",onChange:t})=>jsx(RadioGroup$1,{value:e,options:DATE_VALUE_SOURCE,onChange:e=>{t(e)}}))),ParseListValueConfig=observer((({value:e={type:"array"},onChange:t,hide:r})=>{const{type:n}=e,o=r=>{"string"===e.type&&t({type:"string",payload:{...e.payload,...r}})};return jsxs(GridItem,{hide:r,children:[jsx(LineItem,{label:duchampIntl.get("Duchamp-Parse_Value_Config"),children:jsx(RadioGroup$1,{value:n,options:LIST_VALUE_SOURCE,onChange:e=>{"array"===e&&t({type:e}),"string"===e&&t({type:e,payload:{startSymbol:"",endSymbol:"",splitor:","}})}})}),(()=>{if("string"===n){const t=e;return jsxs(Fragment,{children:[jsx(LineItem,{label:duchampIntl.get("Duchamp-Separator"),children:jsx(AutoComplete,{options:SPLITOR_OPTIONS,value:t.payload.splitor,onChange:e=>{o({splitor:e})}})}),jsx(LineItem,{label:duchampIntl.get("Duchamp-Start_Chart"),children:jsx(AutoComplete,{options:SIDE_OPTIONS,value:t.payload.startSymbol,onChange:e=>{o({startSymbol:e})}})}),jsx(LineItem,{label:duchampIntl.get("Duchamp-End_Chart"),children:jsx(AutoComplete,{options:SIDE_OPTIONS,value:t.payload.endSymbol,onChange:e=>{o({endSymbol:e})}})})]})}return null})()]})})),ParseTreeValueConfig=observer((({value:e={async:!0,multiSelection:!1,returnFullPath:!1,selectLeafOnly:!0},onChange:t})=>{const[r,n]=reactExports.useState(e);useDeepCompareEffect$1((()=>{n({...e})}),[e]);const o=e=>o=>{n({...r,[e]:o}),t({...r,[e]:o})};return jsxs(Fragment,{children:[jsx(LabelInnerItem,{children:jsx(Checkbox$4,{value:r.multiSelection,onChange:o("multiSelection"),children:duchampIntl.get("Duchamp-Controller_Tree_Options_MultiSection")})}),jsx(LabelInnerItem,{children:jsx(Checkbox$4,{value:r.async,onChange:o("async"),children:duchampIntl.get("Duchamp-Controller_Tree_Options_Async_Expand_Leaf")})}),jsx(LabelInnerItem,{children:jsx(Checkbox$4,{value:r.selectLeafOnly,onChange:o("selectLeafOnly"),children:duchampIntl.get("Duchamp-Controller_Tree_Options_Return_Leaf_Only")})}),jsx(LabelInnerItem,{isBottom:!0,children:jsx(Checkbox$4,{value:r.returnFullPath,onChange:o("returnFullPath"),children:duchampIntl.get("Duchamp-Controller_Tree_Options_Return_Full_Path")})})]})})),DATE_QUICK_CONFIGURATION_TYPE={YESTERDAY:0,THIS_DAY:1,TOMORROW:2,LAST_7_DAYS:3,LAST_15_DAYS:4,LAST_MONTH:5,LAST_YEAR:6,SINCE_START_OF_MONTH:7,SINCE_START_OF_QUARTER:8,SINCE_START_OF_YEAR:9},DATE_QUICK_CONFIGURATION_LIST=[{value:DATE_QUICK_CONFIGURATION_TYPE.YESTERDAY,label:i18n.t("Duchamp-Date_Range_Yesterday")},{value:DATE_QUICK_CONFIGURATION_TYPE.THIS_DAY,label:i18n.t("Duchamp-Date_Range_ThisDay")},{value:DATE_QUICK_CONFIGURATION_TYPE.TOMORROW,label:i18n.t("Duchamp-Date_Range_Tomorrow")},{value:DATE_QUICK_CONFIGURATION_TYPE.LAST_7_DAYS,label:i18n.t("Duchamp-Date_Range_Last7Days")},{value:DATE_QUICK_CONFIGURATION_TYPE.LAST_15_DAYS,label:i18n.t("Duchamp-Date_Range_Last15Days")},{value:DATE_QUICK_CONFIGURATION_TYPE.LAST_MONTH,label:i18n.t("Duchamp-Date_Range_LastMonth")},{value:DATE_QUICK_CONFIGURATION_TYPE.LAST_YEAR,label:i18n.t("Duchamp-Date_Range_LastYear")},{value:DATE_QUICK_CONFIGURATION_TYPE.SINCE_START_OF_MONTH,label:i18n.t("Duchamp-Date_Range_SinceMonth")},{value:DATE_QUICK_CONFIGURATION_TYPE.SINCE_START_OF_QUARTER,label:i18n.t("Duchamp-Date_Range_SinceQuarter")},{value:DATE_QUICK_CONFIGURATION_TYPE.SINCE_START_OF_YEAR,label:i18n.t("Duchamp-Date_Range_SinceYear")}],QUICK_CONFIGURATION_VALUES=[{start:{type:2,value:{day:-1,position:1}},end:{type:2,value:{day:-1,position:1}}},{start:{type:2,value:{day:0,position:1}},end:{type:2,value:{day:0,position:1}}},{start:{type:2,value:{day:1,position:1}},end:{type:2,value:{day:1,position:1}}},{start:{type:2,value:{day:-7,position:1}},end:{type:2,value:{day:-1,position:1}}},{start:{type:2,value:{day:-15,position:1}},end:{type:2,value:{day:-1,position:1}}},{start:{type:2,value:{month:-1,position:1}},end:{type:2,value:{day:-1,position:1}}},{start:{type:2,value:{year:-1,position:1}},end:{type:2,value:{day:-1,position:1}}},{start:{type:2,value:{month:0,position:2}},end:{type:2,value:{month:0,position:1}}},{start:{type:2,value:{quarter:0,position:2}},end:{type:2,value:{quarter:0,position:1}}},{start:{type:2,value:{year:0,position:2}},end:{type:2,value:{year:0,position:1}}}],RangeSelector=observer((({value:e,onChange:t,dateConfigurationList:r=DATE_QUICK_CONFIGURATION_LIST})=>{const n=useFocusPointTarget();return jsx("div",{className:"controller-range-config",children:jsx(LabelItem$1,{children:jsx(Select$1,{className:"date-interval-range-selector",allowClear:!0,value:e,style:{width:"100%"},onChange:t,optionFilterProp:"label",multiple:!0,tags:!0,tagRender:e=>jsx("div",{className:"selection-item",children:e.label}),"data-focus-point":{id:"S239",getParam:e=>({empty:0===e.length}),getTarget:()=>n},options:r})})})})),SelectAllConfig=observer((({value:e,onChange:t,hide:r})=>jsx(GridItem,{hide:r,children:jsx(LineItem,{label:"",children:jsx(Checkbox$4,{value:e,onChange:e=>{t(e)},children:duchampIntl.get("Duchamp-Show_Select_All")})})}))),ErrorTipInput=observer((e=>jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Calibration_Prompt_Text"),children:jsx(Input$2,{value:e.value,onChange:t=>{e.onChange(t)}})}))),CustomValueValidation=observer((({value:e,onChange:t,showErrorTip:r})=>jsxs(Fragment,{children:[jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Custom_Value_Validation"),children:jsx(Checkbox$4,{value:e.open,onChange:r=>{t({open:r,errorTip:e.errorTip})},children:duchampIntl.get("Duchamp-Allow_Custom_Value")})}),!e.open&&r&&jsx(ErrorTipInput,{value:e.errorTip,onChange:r=>{t({open:e.open,errorTip:r})}})]}))),EmptyValidation=({value:e,onChange:t})=>jsxs(Fragment,{children:[jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Calibration_Empty"),children:jsx(Checkbox$4,{value:e.open,onChange:r=>{t({open:r,errorTip:e.errorTip})},children:duchampIntl.get("Duchamp-Empty_Allowed")})}),!e.open&&jsx(ErrorTipInput,{value:e.errorTip,onChange:r=>{t({open:e.open,errorTip:r})}})]}),{Option:Option$3}=Select$1,VALUE_SOURCE=[{label:duchampIntl.get("Duchamp-Without"),value:"none"},{label:duchampIntl.get("Duchamp-Length"),value:"length"},{label:duchampIntl.get("Duchamp-Email"),value:"email"},{label:duchampIntl.get("Duchamp-Id_Card"),value:"idCard"},{label:duchampIntl.get("Duchamp-Postal_Code"),value:"postalCode"},{label:duchampIntl.get("Duchamp-Phone"),value:"phone"},{label:duchampIntl.get("Duchamp-Mobile"),value:"mobile"},{label:duchampIntl.get("Duchamp-Customize"),value:"regex"}],RenderValidationItem=e=>{var t,r;const{value:n}=e;switch(n.type){case"none":default:return jsx(Fragment,{});case"length":return jsx(LengthValidation,{value:n.payload||DEFAULT_VALIDATION_WITH_PAYLOAD[n.type].payload,onChange:t=>{e.onChange({type:n.type,errorTip:n.errorTip,payload:t})}});case"phone":return jsx(PhoneValidation,{value:(null==(t=n.payload)?void 0:t.regex)||DEFAULT_VALIDATION_WITH_PAYLOAD[n.type].payload.regex,onChange:t=>{e.onChange({type:n.type,errorTip:n.errorTip,payload:{regex:t}})}});case"regex":return jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Regular_Expression"),children:jsx(Input$2,{value:(null==(r=n.payload)?void 0:r.regex)||DEFAULT_VALIDATION_WITH_PAYLOAD[n.type].payload.regex,placeholder:duchampIntl.get("Duchamp-Please_Enter"),onChange:t=>{e.onChange({type:n.type,errorTip:n.errorTip,payload:{regex:t}})}})})}},PHONE_DATA_TYPE=[{label:"".concat(duchampIntl.get("Duchamp-Area_Code"),"-").concat(duchampIntl.get("Duchamp-Code_Number")),regex:"^\\d{3,4}-\\d{7,8}$",example:"025-8888888"},{label:"".concat(duchampIntl.get("Duchamp-Area_Code")).concat(duchampIntl.get("Duchamp-Code_Number")),regex:"^\\d{11}$",example:"0258888888"},{label:"".concat(duchampIntl.get("Duchamp-Area_Code")," ").concat(duchampIntl.get("Duchamp-Code_Number")),regex:"^\\d{3,4} \\d{7,8}$",example:"025 8888888"}],LENGTH_DEFAULT_PAYLOAD={min:0,max:0},PHONE_DEFAULT_PAYLOAD={regex:PHONE_DATA_TYPE[0].regex},REGEX_DEFAULT_PAYLOAD={regex:""},DEFAULT_VALIDATION_WITH_PAYLOAD={length:{type:"length",errorTip:"",payload:LENGTH_DEFAULT_PAYLOAD},phone:{type:"phone",errorTip:"",payload:PHONE_DEFAULT_PAYLOAD},regex:{type:"regex",errorTip:"",payload:REGEX_DEFAULT_PAYLOAD}},PhoneValidation=e=>{var t;return jsxs(VerticalItem$1,{label:duchampIntl.get("Duchamp-Data_Type"),children:[jsx(Select$1,{style:{width:"100%"},value:e.value,onChange:t=>{e.onChange(t)},children:PHONE_DATA_TYPE.map((e=>jsx(Option$3,{value:e.regex,children:e.label},e.regex)))}),jsxs("div",{className:"subtitle",children:[duchampIntl.get("Duchamp-Example"),":",null==(t=PHONE_DATA_TYPE.find((t=>t.regex===e.value)))?void 0:t.example]})]})},LengthValidation=e=>jsxs("div",{className:"fvs-length-validation",children:[jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Min_Length"),className:"fvs-length-validation-subtitle-item",children:jsx(NumberInput$1,{min:0,width:75,value:e.value.min,onChange:t=>{e.onChange({min:t,max:e.value.max})}})}),jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Max_Length"),children:jsx(NumberInput$1,{min:0,width:75,value:e.value.max,onChange:t=>{e.onChange({max:t,min:e.value.min})}})})]}),StringFormatValidationConfig=observer((e=>jsxs(Fragment,{children:[jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Format_Validation"),children:jsx(Select$1,{style:{width:"100%"},value:e.value.type,onChange:t=>{t in DEFAULT_VALIDATION_WITH_PAYLOAD?e.onChange(DEFAULT_VALIDATION_WITH_PAYLOAD[t]):e.onChange({type:t,errorTip:""})},children:VALUE_SOURCE.map((e=>jsx(Option$3,{value:e.value,children:e.label},e.value)))})}),jsx(RenderValidationItem,{...e}),"none"!==e.value.type&&jsx(ErrorTipInput,{value:e.value.errorTip,onChange:t=>{"none"!==e.value.type&&e.onChange({...e.value,errorTip:t})}})]}))),ValidationConfig=observer((({value:e={},onChange:t,validation:r="empty",showCustomValueErrorTip:n=!0})=>{const o={format:e.format||{type:"none"},allowEmpty:e.allowEmpty||{open:!0,errorTip:""},customValue:isUndefined$3(e.customValue)?{open:!0,errorTip:""}:e.customValue},i=Array.isArray(r)?r:[r],a={};return i.includes("stringFormat")&&(a.format=o.format),i.includes("empty")&&(a.allowEmpty=o.allowEmpty),i.includes("customValue")&&(a.customValue=o.customValue),jsx("div",{className:"controller-validation-config",children:i.map((e=>{switch(e){case"stringFormat":return jsx(StringFormatValidationConfig,{value:o.format,onChange:e=>{t({...a,format:e})}},e);case"empty":return jsx(EmptyValidation,{value:o.allowEmpty,onChange:e=>{t({...a,allowEmpty:e})}},e);case"customValue":return jsx(CustomValueValidation,{showErrorTip:n,value:o.customValue,onChange:e=>{t({...a,customValue:e})}},e);default:return null}}))})})),CONTROLLER_CONFIG_KEY={DATE_RANGE:"dateRange",GROUP_FIT:"fitConfig"},FormulaValueConfig=e=>{const{value:t="",options:r,format:n,onChange:o}=e;return settingCenter.supportAppService(DUCHAMP_APP_SERVICE.FORMULA)?jsx(FormulaInput,{value:t,onChange:e=>{o&&o({type:CONTROLLER_VALUE_TYPE.FORMULA,payload:{formula:e}})}}):includes(r,CONTROLLER_VALUE_TYPE.STRING)?jsx(TextArea,{value:t,rows:3,placeholder:duchampIntl.get("Duchamp-Please_Input_Default_Value"),onChange:e=>{o&&o({type:CONTROLLER_VALUE_TYPE.STRING,payload:{value:e}})}}):includes(r,CONTROLLER_VALUE_TYPE.DATE)?jsx(DateTime$2,{showTimeLabel:!0,placeholder:"".concat(duchampIntl.get("Duchamp-Please_Choose")).concat(duchampIntl.get("Duchamp-Date")),format:n.value,onChange:e=>{o&&o({type:CONTROLLER_VALUE_TYPE.DATE,payload:{date:getDateValueWithFormat(n.value,null==e?void 0:e.valueOf())}})}}):jsx(TextArea,{value:t,rows:3,placeholder:duchampIntl.get("Duchamp-Please_Input_Default_Value"),onChange:e=>{o&&o({type:CONTROLLER_VALUE_TYPE.STRING,payload:{value:e}})}})},{Option:Option$2}=Select$1,DatasetConfig=e=>{const{crudService:t}=useService();return jsx(DatasetConfig$1,{...e,fetcher:{getTableInfo:t.getTableInfo,getTableNodeList:t.getTables,searchTable:t.searchTable}})},ValueConfig=({options:e,onChange:t,value:r,formatConfig:n,dataType:o,quickConfigurationList:i=[]})=>{if(reactExports.useEffect((()=>{var o;if(0===e.length)return;const i=get$5(null==r?void 0:r.payload,"startDate",{type:CONTROLLER_VALUE_TYPE.DATE,payload:{date:getDateValueWithFormat(DEFAULT_FORMAT.value,new Date)}});a===CONTROLLER_VALUE_TYPE.DATE_RANGE&&i.type===CONTROLLER_VALUE_TYPE.DATE_RANGE&&(null==(o=null==n?void 0:n.payload)?void 0:o.type)!==DATE_FORMAT_TYPE.YMD&&t({type:CONTROLLER_VALUE_TYPE.DATE_RANGE,payload:{startDate:{type:CONTROLLER_VALUE_TYPE.DATE,payload:{date:void 0}},endDate:{type:CONTROLLER_VALUE_TYPE.DATE,payload:{date:void 0}}}})}),[n]),0===e.length)return jsx(Fragment,{});const{type:a}=r||{type:e[0]},s=getDateFormatByFormatConfig(n);if(o===CONTROLLER_VALUE_TYPE.DATE_RANGE){const n=get$5(null==r?void 0:r.payload,"startDate",{type:CONTROLLER_VALUE_TYPE.DATE,payload:{date:getDateValueWithFormat(DEFAULT_FORMAT.value,new Date)}}),o=get$5(null==r?void 0:r.payload,"endDate",{type:CONTROLLER_VALUE_TYPE.DATE,payload:{date:getDateValueWithFormat(DEFAULT_FORMAT.value,new Date)}}),a=(e,r)=>{e!==DATE_RANGE_TYPE.END_DATE?r.type===CONTROLLER_VALUE_TYPE.DATE_RANGE?t({type:CONTROLLER_VALUE_TYPE.DATE_RANGE,payload:{startDate:r,endDate:{type:CONTROLLER_VALUE_TYPE.DATE,payload:{date:void 0}}}}):t({type:CONTROLLER_VALUE_TYPE.DATE_RANGE,payload:{startDate:r,endDate:o}}):t({type:CONTROLLER_VALUE_TYPE.DATE_RANGE,payload:{startDate:n,endDate:r}})};return jsxs("div",{className:"controller-value-config",children:[jsxs(VerticalItem$1,{label:duchampIntl.get("Duchamp-Start_Date"),children:[e.length>1&&jsx(LabelInnerItem,{children:jsx(Select$1,{value:n.type,style:{width:"100%"},onChange:e=>{switch(e){case CONTROLLER_VALUE_TYPE.STRING:a(DATE_RANGE_TYPE.START_DATE,{type:CONTROLLER_VALUE_TYPE.STRING,payload:{value:""}});break;case CONTROLLER_VALUE_TYPE.FIELD:a(DATE_RANGE_TYPE.START_DATE,{type:CONTROLLER_VALUE_TYPE.FIELD,payload:{dataSet:"",field:""}});break;case CONTROLLER_VALUE_TYPE.FORMULA:a(DATE_RANGE_TYPE.START_DATE,{type:CONTROLLER_VALUE_TYPE.FORMULA,payload:{formula:""}});break;case CONTROLLER_VALUE_TYPE.DATE:a(DATE_RANGE_TYPE.START_DATE,{type:CONTROLLER_VALUE_TYPE.DATE,payload:{date:getDateValueWithFormat(s.value,new Date)}});break;case CONTROLLER_VALUE_TYPE.DATE_RANGE:a(DATE_RANGE_TYPE.START_DATE,{type:CONTROLLER_VALUE_TYPE.DATE_RANGE,payload:{dateRange:void 0}});break;default:return}},children:VALUE_SOURCE$1.filter((t=>e.includes(t.type))).map((e=>jsx(Option$2,{value:e.type,children:e.text},e.type)))})}),jsx(LabelInnerItem,{isBottom:!0,children:(()=>{var t,r,o,l,c,u,d;switch(n.type){case CONTROLLER_VALUE_TYPE.STRING:return jsx(TextArea,{value:(null==(t=n.payload)?void 0:t.value)||"",rows:3,placeholder:duchampIntl.get("Duchamp-Please_Input_Default_Value"),onChange:e=>{a(DATE_RANGE_TYPE.START_DATE,{type:CONTROLLER_VALUE_TYPE.DATE,payload:{value:e}})}});case CONTROLLER_VALUE_TYPE.FIELD:return jsx(DatasetConfig,{value:{dataSet:(null==(r=n.payload)?void 0:r.dataSet)||"",field:(null==(o=n.payload)?void 0:o.field)||""},onChange:e=>{a(DATE_RANGE_TYPE.START_DATE,{type:CONTROLLER_VALUE_TYPE.FIELD,payload:{dataSet:e.dataSet,field:e.field}})}});case CONTROLLER_VALUE_TYPE.FORMULA:return jsx(FormulaValueConfig,{value:null==(l=n.payload)?void 0:l.formula,format:s,options:e,onChange:e=>{a(DATE_RANGE_TYPE.START_DATE,{type:e.type,payload:e.payload})}});case CONTROLLER_VALUE_TYPE.DATE:return jsx(DateTime$2,{showTimeLabel:!0,placeholder:"".concat(duchampIntl.get("Duchamp-Please_Choose")).concat(duchampIntl.get("Duchamp-Date")),format:s.value,value:(null==(c=n.payload)?void 0:c.date)?dayjs(null==(u=n.payload)?void 0:u.date):void 0,onChange:e=>{a(DATE_RANGE_TYPE.START_DATE,{type:CONTROLLER_VALUE_TYPE.DATE,payload:{date:getDateValueWithFormat(s.value,null==e?void 0:e.valueOf())}})}});case CONTROLLER_VALUE_TYPE.DATE_RANGE:return jsx(Select$1,{value:null==(d=n.payload)?void 0:d.dateRange,style:{width:"100%"},onChange:e=>{a(DATE_RANGE_TYPE.START_DATE,{type:CONTROLLER_VALUE_TYPE.DATE_RANGE,payload:{dateRange:e}})},children:i.map((e=>jsx(Option$2,{value:e.value,children:e.label},e.value)))});default:return null}})()})]}),jsxs(VerticalItem$1,{label:duchampIntl.get("Duchamp-End_Date"),children:[e.length>1&&jsx(LabelInnerItem,{children:jsx(Select$1,{disabled:n.type===CONTROLLER_VALUE_TYPE.DATE_RANGE,value:n.type===CONTROLLER_VALUE_TYPE.DATE_RANGE?void 0:o.type,style:{width:"100%"},onChange:e=>{switch(e){case CONTROLLER_VALUE_TYPE.STRING:a(DATE_RANGE_TYPE.END_DATE,{type:CONTROLLER_VALUE_TYPE.STRING,payload:{value:""}});break;case CONTROLLER_VALUE_TYPE.FIELD:a(DATE_RANGE_TYPE.END_DATE,{type:CONTROLLER_VALUE_TYPE.FIELD,payload:{dataSet:"",field:""}});break;case CONTROLLER_VALUE_TYPE.FORMULA:a(DATE_RANGE_TYPE.END_DATE,{type:CONTROLLER_VALUE_TYPE.FORMULA,payload:{formula:""}});break;case CONTROLLER_VALUE_TYPE.DATE:a(DATE_RANGE_TYPE.END_DATE,{type:CONTROLLER_VALUE_TYPE.DATE,payload:{date:getDateValueWithFormat(s.value,new Date)}});break;default:return}},children:VALUE_SOURCE$1.filter((t=>e.includes(t.type)&&t.type!==CONTROLLER_VALUE_TYPE.DATE_RANGE)).map((e=>jsx(Option$2,{value:e.type,children:e.text},e.type)))})}),jsx(LabelInnerItem,{isBottom:!0,children:(()=>{var t,r,i,l,c,u;if(n.type===CONTROLLER_VALUE_TYPE.DATE_RANGE)return null;switch(o.type){case CONTROLLER_VALUE_TYPE.STRING:return jsx(TextArea,{value:(null==(t=o.payload)?void 0:t.value)||"",rows:3,placeholder:duchampIntl.get("Duchamp-Please_Input_Default_Value"),onChange:e=>{a(DATE_RANGE_TYPE.END_DATE,{type:CONTROLLER_VALUE_TYPE.STRING,payload:{value:e}})}});case CONTROLLER_VALUE_TYPE.FIELD:return jsx(DatasetConfig,{value:{dataSet:(null==(r=o.payload)?void 0:r.dataSet)||"",field:(null==(i=o.payload)?void 0:i.field)||""},onChange:e=>{a(DATE_RANGE_TYPE.END_DATE,{type:CONTROLLER_VALUE_TYPE.FIELD,payload:{dataSet:e.dataSet,field:e.field}})}});case CONTROLLER_VALUE_TYPE.FORMULA:return jsx(FormulaValueConfig,{value:null==(l=o.payload)?void 0:l.formula,format:s,options:e,onChange:e=>{a(DATE_RANGE_TYPE.END_DATE,e)}});case CONTROLLER_VALUE_TYPE.DATE:return jsx(DateTime$2,{showTimeLabel:!0,placeholder:"".concat(duchampIntl.get("Duchamp-Please_Choose")).concat(duchampIntl.get("Duchamp-Date")),format:s.value,value:(null==(c=o.payload)?void 0:c.date)?dayjs(null==(u=o.payload)?void 0:u.date):void 0,onChange:e=>{a(DATE_RANGE_TYPE.END_DATE,{type:CONTROLLER_VALUE_TYPE.DATE,payload:{date:getDateValueWithFormat(s.value,null==e?void 0:e.valueOf())}})}});default:return null}})()})]})]})}return jsxs("div",{className:"controller-value-config",children:[e.length>1&&jsx(LabelInnerItem,{children:jsx(Select$1,{value:a,style:{width:"100%"},onChange:e=>{switch(e){case CONTROLLER_VALUE_TYPE.STRING:t({type:e,payload:{value:""}});break;case CONTROLLER_VALUE_TYPE.FIELD:t({type:e,payload:{dataSet:"",field:""}});break;case CONTROLLER_VALUE_TYPE.FORMULA:t({type:e,payload:{formula:""}});break;case CONTROLLER_VALUE_TYPE.DATE:t({type:e,payload:{date:getDateValueWithFormat(s.value,new Date)}})}},children:VALUE_SOURCE$1.filter((t=>e.includes(t.type))).map((e=>jsx(Option$2,{value:e.type,children:e.text},e.type)))})}),jsx(LabelInnerItem,{isBottom:!0,children:(()=>{switch(a){case CONTROLLER_VALUE_TYPE.STRING:return jsx(TextArea,{value:(null==r?void 0:r.payload.value)||"",rows:3,placeholder:duchampIntl.get("Duchamp-Please_Input_Default_Value"),onChange:e=>{t({type:CONTROLLER_VALUE_TYPE.STRING,payload:{value:e}})}});case CONTROLLER_VALUE_TYPE.FIELD:return jsx(DatasetConfig,{value:(null==r?void 0:r.payload)||{dataSet:"",field:""},onChange:e=>{t({type:CONTROLLER_VALUE_TYPE.FIELD,payload:e})}});case CONTROLLER_VALUE_TYPE.FORMULA:return jsx(FormulaValueConfig,{value:null==r?void 0:r.payload.formula,format:s,options:e,onChange:e=>{t(e)}});case CONTROLLER_VALUE_TYPE.DATE:{const e=r;return jsx(DateTime$2,{showTimeLabel:!0,placeholder:"".concat(duchampIntl.get("Duchamp-Please_Choose")).concat(duchampIntl.get("Duchamp-Date")),format:s.value,value:(null==e?void 0:e.payload.date)?dayjs(e.payload.date):void 0,onChange:e=>{t({type:CONTROLLER_VALUE_TYPE.DATE,payload:{date:getDateValueWithFormat(s.value,null==e?void 0:e.valueOf())}})}})}default:return null}})()})]})},StringValueConfig=e=>{const{value:t,onChange:r}=e;return jsx(ValueConfig,{options:[CONTROLLER_VALUE_TYPE.STRING,CONTROLLER_VALUE_TYPE.FIELD,CONTROLLER_VALUE_TYPE.FORMULA],value:t,onChange:r})};formItemManager.register("valueConfig",StringValueConfig);const DefaultValueConfig=observer((({value:e,formatConfig:t,onChange:r=()=>{},dataType:n="string",rangeSelectorList:o=[]})=>{var i;const a=isString$3(n)?(e=>{switch(e){case"string":return[CONTROLLER_VALUE_TYPE.STRING];case"date":case"dateRange":return[CONTROLLER_VALUE_TYPE.DATE];default:return[]}})(n):n;return settingCenter.controllerConfig.defaultValue.includes("fields")&&a.push(CONTROLLER_VALUE_TYPE.FIELD),settingCenter.app.service.formula.enable&&a.push(CONTROLLER_VALUE_TYPE.FORMULA),(null==(i=null==t?void 0:t.payload)?void 0:i.type)===DATE_FORMAT_TYPE.YMD&&"dateRange"===n&&a.push(CONTROLLER_VALUE_TYPE.DATE_RANGE),jsx("div",{className:"controller-value-config",children:jsx(ValueConfig,{options:a,value:e,formatConfig:t,onChange:r,dataType:isString$3(n)?n:n[0],quickConfigurationList:(null==o?void 0:o.length)>0?o.map((e=>DATE_QUICK_CONFIGURATION_LIST[e])):[]})})})),WatermarkConfig=observer((({value:e,onChange:t})=>jsx(Input$2.TextArea,{value:e,rows:3,placeholder:duchampIntl.get("Duchamp-Please_Input_Default_Value"),onBlur:t}))),{Option:Option$1}=Select$1,StyleConfig=observer((({onChange:e,value:t={styleType:"",styleConfig:DEFAULT_CONTROLLER_STYLE_PROPS},controllerType:r="",styles:n=[],...o})=>{var i;const a=useStore(),s=n.find((e=>e.type===(t.styleType||"default")));return jsx(CollapseGroup,{defaultActiveKey:["1"],items:[{key:"1",label:duchampIntl.get("Duchamp-Content_Style"),children:jsxs(GridItem,{children:[n.length>1&&jsx(PlatformLineItem,{label:duchampIntl.get("Duchamp-Template_Type"),children:jsx(Select$1,{value:null==s?void 0:s.type,style:{width:"100%"},onChange:n=>{const{styleConfig:o}=getWidgetDefaultStyleProps({widgetManager:widgetManager,widgetType:r,styleType:n,defaultProps:DEFAULT_CONTROLLER_STYLE_PROPS,themeVars:a.duchampServer.themeManager.themeVars});if(!o)return;const{fontFamily:i,fontAttr:s}=t.styleConfig;e({styleType:n,styleConfig:{...o,fontFamily:i,fontAttr:s}})},children:n.map((e=>jsx(Option$1,{value:e.type,children:e.displayName},e.displayName)))})}),null==(i=null==s?void 0:s.configuration)?void 0:i.map((r=>{const{beforeRender:n,optionsFilter:i,...a}=r;return"select"===r.type&&i&&set$3(a,"options",i(o)),jsx(ConfigItem,{config:a,value:t.styleConfig||{},beforeRender:()=>null==n?void 0:n(o),displayProps:o,onChange:(r,n)=>{const o=t.styleConfig||clone$3(DEFAULT_CONTROLLER_STYLE_PROPS);set$3(o,r,n),e({name:r,styleType:null==s?void 0:s.type,styleConfig:o})}},r.name)}))]})}]})})),CONTROLLER_PROPERTY_CONFIG={name:NameConfigInput,relatedParams:ParameterConfig,relatedFields:RelatedField,relatedControllers:RelatedController,formatConfig:FormatConfig,defaultValue:DefaultValueConfig,dataConfig:DataConfig,treeDataConfig:TreeDataConfig,dateRange:DateRangeConfig,watermark:WatermarkConfig,authority:AuthorityConfig,validation:ValidationConfig,selectAll:SelectAllConfig,searchAll:SearchAllConfig,parseDataValue:ParseDateValueConfig,parseValueConfig:ParseListValueConfig,parseTreeValueConfig:ParseTreeValueConfig,multiSelect:MultiSelectConfig,rangeSelector:RangeSelector,dateIntervalWatermarkConfig:DateIntervalWatermarkConfig,style:StyleConfig},PropertyConfig=observer((({schema:e,value:t,onChange:r,options:n={}})=>{const o=(e,t)=>{const{properties:r}=e;r&&each$3(r,((e,n)=>{set$3(r,n,{...e,props:{...(null==e?void 0:e.props)||{},...get$5(t,n)}}),r[n].properties&&get$5(t,n)&&o(r[n],get$5(t,n))}))};return o(e,n),jsx(SchemaForm,{value:cloneDeep$2(t),schema:e,widgets:CONTROLLER_PROPERTY_CONFIG,onChange:r})}));function getDataType(e){var t;return null!=(t=null==e?void 0:e.type)?t:"string"}const ControllerConfig=observer((({model:e,schema:t})=>{const r=useStore(),{widgets:n}=r.story,o=(widgetManager.getExtendStyles(e.type)||[]).filter((t=>{var n,o;return(!t.platforms||t.platforms.includes(r.platform.platformType))&&!(null==(o=null==(n=null==t?void 0:t.beforeRender)?void 0:n.call(t,e.props))?void 0:o.hide)})),i=e=>({id:e.id,type:e.type,props:{...e.props,name:e.name,dataConfig:e.props.dataDictionaryConfig}}),a=n.reduce(((e,t)=>{const r=t.getInstance();return isControllerModel(r)&&e.push(i(r)),e}),[]),s=getDataType(e.formatConfig);return jsx("div",{style:{width:"100%",height:"100%"},children:jsx(PropertyConfig,{schema:t,value:e.getConfigurationConfig(),onChange:(t,r,n)=>{e.setConfigurationConfig(zipObjectDeep$1(r,[n]))},options:{relatedParams:{repeatValidator:(t,r)=>!parameterHasBind(t,r,e.id,a),parametersGetter:t=>{const n=getAllRelationTables(r);return getAllParametersCanBind({fieldName:t,widgetId:e.id,widgets:a,crudService:r.crudService,payload:n})},canInput:settingCenter.parameterCanInput,dataType:s},relatedFields:{dataType:s},dataConfig:{relatedFields:e.relatedFields},relatedControllers:{controllersGetter:()=>getRelationControllers(i(e),a)},style:{styles:o},...e.getControllerConfigOptions()}})})})),ControllerContainer=observer((e=>{const{fontStyle:t}=e.model,r={...t,"--font-size":"".concat(t.fontSize,"px"),"--text-color":t.color,"--font-weight":t.fontWeight,"--font-style":t.fontStyle,"--fvs-controller-icon-color":t.iconColor},n=reactExports.useMemo((()=>({...convertInnerBorderRadiusStyle(e.model.borderLine,e.model.borderRadius),position:"relative"})),[e.model.borderLine,e.model.borderRadius]);return jsx("div",{className:classNames$1({"fvs-controller-container":!e.model.isMobile,"fvs-mobile-controller-container":e.model.isMobile,error:e.model.warning,disabled:!e.model.enable}),style:{...r,pointerEvents:e.model.isPreview&&e.model.enable?"auto":"none",...n},children:e.children})})),DEFAULT_CONTROLLER_STATES={width:160,height:28};function createControllerView(e){const t=observer(e);return function(e){const r=(e.model.isMobile,ControllerContainer);return jsx(r,{...e,children:jsx(t,{...e})})}}function registerController({meta:e,view:t,mobileView:r,model:n,mobileModel:o}){var i,a;const s=settingCenter.controllerConfig.returnValue?[]:["parseValueConfig","parseDataValue"];settingCenter.controllerConfig.fields.enableBind||s.push("relatedControllers"),settingCenter.controllerConfig.defaultValueRange||s.push("dateRange");const l={...e.configuration,properties:{...omit$1(e.configuration.properties,s),style:{widget:"style",props:{...(null==(a=null==(i=e.configuration.properties)?void 0:i.style)?void 0:a.props)||{},controllerType:e.type,value:{styleType:"default",styleConfig:{}}}}}};registerWidget({options:{...merge$1({dependencies:[],clickActions:[],events:settingCenter.supportAppService(DUCHAMP_APP_SERVICE.JS)?[{type:"MOUNTED"},{type:"EDIT_FINISH"}]:[],refresh:!1,...e,widgetType:"controller",props:{...DEFAULT_CONTROLLER_PROPS,...e.props||{}},states:{...DEFAULT_CONTROLLER_STATES,...e.states||{}},configuration:e=>{const t=e.widget.getInstance();return t instanceof ControllerModel?jsx(ControllerConfig,{model:t,schema:l}):jsx(Fragment,{})},configure:{mobile:{fluidHeightGrid:FLUID_LINE_PARTS},eventTargets:{events:[{trigger:WIDGET_EVENT.MOUNTED,text:WIDGET_EVENT_MAP.MOUNTED,actions:[{action:DUCHAMP_ACTION_TYPE.JAVASCRIPT}]},{trigger:WIDGET_EVENT.EDIT_FINISH,text:WIDGET_EVENT_MAP.EDIT_FINISH,actions:[{action:DUCHAMP_ACTION_TYPE.JAVASCRIPT}]}]},...e.configure},initialization:async t=>{const{widget:r}=t;return r.getInstance().initializationRelatedParams(),!e.initialization||await e.initialization(t)}},settingCenter.getComponentConfigMeta(e.type)),model:n||ControllerModel,mobileConfig:{model:o}},view:createControllerView(t),mobileView:r&&createControllerView(r)}),!widgetManager.getExtendStyle(e.type)&&registerControllerStyle(e.type,DEFAULT_CONTROLLER_STYLE_META,t),widgetManager.registerConfigurationSchema(e.type,l)}function registerControllerStyle(e,t,r,n){widgetManager.registerExtendStyle(e,{...t,props:merge$1({},DEFAULT_CONTROLLER_STYLE_PROPS,t.props),component:renderWidgetView(createControllerView(r)),mobile:n?{component:renderWidgetView(createControllerView(n))}:void 0})}const COMBO_CLS="fvs-controller-combo-base",COMBO_POPUP_CLS="fvs-controller-combo-popup-view-base",COMBO_EVENT={EVENT_CONFIRM:"EVENT_CONFIRM",EVENT_BEFORE_EDIT:"EVENT_BEFORE_EDIT",EVENT_BEFORE_POPUPVIEW:"EVENT_BEFORE_POPUPVIEW",EVENT_KEY_DOWN_ENTER:"EVENT_KEY_DOWN_ENTER"},MULTI_COMBO_EVENT={EVENT_CONFIRM:"EVENT_CONFIRM",EVENT_SELECT_ALL:"EVENT_SELECT_ALL",EVENT_BEFORE_POPUPVIEW:"EVENT_BEFORE_POPUPVIEW"},DEFAULT_MAX_POPUP_HEIGHT=500,getPopupMaxHeight=()=>Math.min(DEFAULT_MAX_POPUP_HEIGHT,window.innerHeight/2),transformComboValue2Value=e=>isNil$4(e)?null:(null==e?void 0:e.value)||"",transformValue2ComboValue=(e,t)=>{if(!isNil$4(e)&&"".concat(e))return findValueWithData("".concat(e),t,!0)};function findValueWithData(e,t,r){var n;if(!isArray$d(e)){const o=null!=(n=t.find((t=>t.value==e)))?n:t.find((t=>t.text==e));return o?{text:"".concat(o.text),value:"".concat(o.value)}:r?{text:"".concat(e),value:"".concat(e)}:void 0}const o=new Map(t.map(((e,t)=>[e.value,t]))),i=new Map(t.map(((e,t)=>[e.text,t])));return e.map((e=>{var n;const a=null!=(n=o.get(e))?n:i.get(e);if(void 0!==a){const e=t[a];return{text:"".concat(e.text),value:"".concat(e.value)}}return r?{text:"".concat(e),value:"".concat(e)}:void 0}))}function transformValue2MultiComboValue(e,t){return e?findValueWithData(e,t,!0):[]}function transformMultiComboValue2Value(e,t){return isArray$d(e)?t?e.map((e=>e.value)):e.map((e=>e.value)).filter((e=>!isNilOrEmptyString(e))):[]}function transformData2RadioGroupData(e,t){const r=isNilOrEmptyString(e)?void 0:e;return t.map((e=>e.value===r||e.text===r?{...e,selected:!0}:e))}function transformData2CheckboxGroupData(e,t){const r=e.slice(),n=t.map((e=>({...e})));return n.forEach((e=>{const t=r.findIndex((t=>t===e.value));-1!==t&&(r.splice(t,1),e.selected=!0)})),n.forEach((e=>{const t=r.findIndex((t=>t===e.text));-1!==t&&(r.splice(t,1),e.selected=!0)})),n}function isNilOrEmptyString(e){return isNil$4(e)||Number.isNaN(e)||""===e}function getStyleConfig(e){const{color:t,border:r,fillColor:n,selected:{color:o,fillColor:i,border:a}}=e;return{color:t,border:r,background:n,selectedColor:o,selectedBorder:a,selectedBackground:i}}function getFormatType(e){const t=transformFormat(transformFormat(e)),r=/%d|%e/g.test(t),n=/%H|%M|%S|%I|%l|%k/.test(t),o=/%Y|%q|%y/.test(t)&&!/%[^Yqy]/.test(t);return{isDateFormat:r,isTimeFormat:n,isMonthFormat:/%Y|%X|%y/.test(t)&&!/%[^YXy]/.test(t),isQuarterFormat:o,isYearFormat:/%Y|%y/.test(t)&&!/%[^Yy]/.test(t)}}function transformFormat(e){return e.replace(/yyyy/g,"%Y").replace(/MM/g,"%X").replace(/Q/g,"%q").replace(/dd/g,"%d").replace(/M/g,"%x").replace(/^d/g,"%e").replace(/.d/g,(e=>"%"===e[0]?e:"".concat(e[0],"%e"))).replace(/yy/g,"%y").replace(/HH/g,"%H").replace(/mm/g,"%M").replace(/ss/g,"%S").replace(/hh/g,"%I").replace(/a/g,"%P").replace(/h/g,"%l").replace(/^H/g,"%k").replace(/.H/g,(e=>"%"===e[0]?e:"".concat(e[0],"%k")))}function renderTextWithDateCustom(e,t){return dayjs(t).format(transformDateFormat2DayjsFormat$1(e))}var toInteger=toInteger_1,FUNC_ERROR_TEXT="Expected a function";function before$1(e,t){var r;if("function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT);return e=toInteger(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=void 0),r}}var before_1=before$1,before=before_1;function once(e){return before(2,e)}var once_1=once;const once$1=getDefaultExportFromCjs$1(once_1),resolveFineUIPopupDislocation=once$1((e=>{BI.config("bi.combo.props",((e,t)=>{{const{hideChecker:e}=t;return delete t.hideChecker,{hideChecker:function(t){const r=e&&e(t);if(!isHasPreviewId(this.element[0]))return r;if(!1===r)return!1;const n=BI.$(t.target).parents(".bi-popup-view"),o=BI.$(t.target).parents(".bi-dynamic-date-popup, .bi-year-quarter-popup");return!(n.length>0&&0===o.length)}}}})),BI.getReference("bi.combo",(e=>{if(isHasPreviewId(e.element[0])){const t=getClosetPortal(e.element[0]);t&&(e.options.container=t)}})),BI.getReference("bi.searcher",(e=>{var t,r,n,o;isHasPreviewId(e.element[0])&&(e.options.masker={...null==(t=e.options)?void 0:t.masker,container:null!=(o=getClosetPortal(e.element[0]))?o:null==(n=null==(r=e.options)?void 0:r.masker)?void 0:n.container})})),BI.config("bi.combo",(t=>(t.beforeInit=function(t){this.adjustWidth=t=>{if(!this.popupView)return;const r=this.options;if(!0===r.isNeedAdjustWidth){this.resetListWidth("");const e=this.popupView.element.outerWidth();let t=this.element.outerWidth()||r.width;t<500&&(e>=500?t=500:e>t&&(t=e+1)),this.resetListWidth(t<10?10:t)}if(getClosetPortal(this.element[0])&&!isInPanelDrawer(this.element[0])){const t=this.popupView.element[0];t.querySelector(".bi-dynamic-date-popup, .bi-year-quarter-popup, .bi-year-month-popup, .bi-dynamic-year-popup, .bi-dynamic-date-time-popup, .bi-date-time-popup")&&e()<1?(t.style.transform="scale(1)",t.style.transformOrigin="0 0"):(t.style.transform="scale(".concat(e(),")"),t.style.transformOrigin="0 0")}},t()},t)))})),resolveYearMonthDynamic=once$1((()=>{BI.config("bi.dynamic_year_month_popup.props",(()=>({supportDynamic:!1})))}));function resolveFineUIDateIntervalI18n(){BI.i18n["BI-Basic_Later"]||BI.extend(BI.i18n,{"BI-Basic_Later":BI.i18n["BI-Basic_Behind"]})}function isHasPreviewId(e){if(!e)return!1;let t=e.parentElement;for(;t;){if("preview"===t.id)return!0;t=t.parentElement}return!1}function getClosetPortal(e){if(!e)return window.document.body;let t=e.parentElement;for(;t;){if(t.className.includes("bi-popup-view"))return!1;if(t.className.includes(PORTAL_CLASS.MAIN)){t=Array.from(t.children).find((e=>!!e.className&&e.className.includes(PORTAL_CLASS.PORTAL)));break}t=t.parentElement}return t}function isInPanelDrawer(e){if(!e)return!1;let t=e.parentElement;for(;t;){if(t.className.includes("controller-panel-drawer"))return!0;t=t.parentElement}return!1}function resolveFineUIComboPopupViewFit(e,t,r,n){const{combo:o}=e;o.on("EVENT_BEFORE_POPUPVIEW",(()=>{var e;const n=o.getView().element;null==n||n.addClass(t),null==(e=n[0])||e.style.setProperty("--font-size","".concat(r,"px"))}));const{searcher:i}=e.trigger;i.on("EVENT_SEARCHING",(()=>{var e,o,a;const s=i.getView().element;null==s||s.addClass(t),null==(e=s[0])||e.style.setProperty("--font-size","".concat(r,"px")),getClosetPortal(i.element[0])&&!isInPanelDrawer(i.element[0])&&(null==(o=s[0])||o.style.setProperty("transform","scale(".concat(n(),")")),null==(a=s[0])||a.style.setProperty("transform-origin","0 0"))}))}function resolveFineUITreeComboPopupViewFit(e,t,r){var n;const{combo:o}=e.tree;o.on("EVENT_BEFORE_POPUPVIEW",(()=>{var e,r;const n=null!=(r=null==(e=o.getView)?void 0:e.call(o).element)?r:o.combo.getView().element;null==n||n.addClass(t)}));const{searcher:i}=null!=(n=e.tree.trigger)?n:e.tree.combo.trigger;i.on("EVENT_START",(()=>{var e,n,o,a;const s=null!=(n=null==(e=i.getView)?void 0:e.call(i).element)?n:i.searcher.getView().element;null==s||s.addClass(t),getClosetPortal(i.element[0])&&!isInPanelDrawer(i.element[0])&&(null==(o=s[0])||o.style.setProperty("transform","scale(".concat(r(),")")),null==(a=s[0])||a.style.setProperty("transform-origin","0 0"))}))}function resolveFineUIComboPopupViewItemHeight(e){return 2*Math.max(e,12)}const MAX_DATE="2999-12-31",MIN_DATE="1900-01-01",SHORTCUTS_TYPE={NONE:"none",DAY:"day",WEEK:"week",MONTH:"month",YEAR:"year"},SHORTCUTS_TYPE_MAP={[SHORTCUTS_TYPE.NONE]:[DATE_FORMAT_TYPE.YMD,DATE_FORMAT_TYPE.YM,DATE_FORMAT_TYPE.YY],[SHORTCUTS_TYPE.DAY]:[DATE_FORMAT_TYPE.YMD],[SHORTCUTS_TYPE.WEEK]:[DATE_FORMAT_TYPE.YMD],[SHORTCUTS_TYPE.MONTH]:[DATE_FORMAT_TYPE.YMD,DATE_FORMAT_TYPE.YM],[SHORTCUTS_TYPE.YEAR]:[DATE_FORMAT_TYPE.YMD,DATE_FORMAT_TYPE.YM,DATE_FORMAT_TYPE.YY]},SHORTCUTS_LABELS={[SHORTCUTS_TYPE.NONE]:[i18n.t("Duchamp-Without")],[SHORTCUTS_TYPE.DAY]:[i18n.t("Duchamp-Pre_Day"),i18n.t("Duchamp-Next_Day")],[SHORTCUTS_TYPE.WEEK]:[i18n.t("Duchamp-Pre_Week"),i18n.t("Duchamp-Next_Week")],[SHORTCUTS_TYPE.MONTH]:[i18n.t("Duchamp-Pre_Month"),i18n.t("Duchamp-Next_Month")],[SHORTCUTS_TYPE.YEAR]:[i18n.t("Duchamp-Pre_Year"),i18n.t("Duchamp-Next_Year")]},SHORTCUTS_BUTTON_OPTIONS=Object.values(SHORTCUTS_TYPE).map((e=>({label:SHORTCUTS_LABELS[e].join(" | "),value:e,type:SHORTCUTS_TYPE_MAP[e]}))),CALENDAR_STATUS={EXPAND:"expand",COLLAPSE:"collapse"},CALENDAR_STATUS_OPTIONS=[{label:i18n.t("Duchamp-Default_Collapse"),value:CALENDAR_STATUS.COLLAPSE},{label:i18n.t("Duchamp-Default_Expand"),value:CALENDAR_STATUS.EXPAND}],DATE_STYLE_TYPE={DEFAULT:"default",CALENDAR:"calendar",WEEK_CALENDAR:"week-calendar"},FOCUS_POINT_STYLE_TYPE_MAP={default:"default",calendar:"simplecalendar","week-calendar":"navigationcalendar"};dayjs.extend(quarterOfYear),dayjs.extend(isoWeek),dayjs.extend(isLeapYear$1),dayjs.extend(advancedFormat);const DATE_OFFSET=[0,-1,-2,-3,-4,-5,-6],OFFSET={CURRENT:1,BEGIN:2,END:3};function isDateLegal(e,t,r){if(!e)return!1;return(!t||e>=t)&&(!r||e<=r)}function toDateJson(e,t){const r=new Date(e);return isDate$3(r)?t?{hour:r.getHours(),minute:r.getMinutes(),second:r.getSeconds()}:{type:1,value:{year:r.getFullYear(),month:r.getMonth()+1,quarter:dayjs(r).quarter(),day:r.getDate(),hour:r.getHours(),minute:r.getMinutes(),second:r.getSeconds()}}:{}}function json2DateTime(e,t=dayjs()){if(!isNil$4(e.year)){const r=e.month||toFloat(e.quarter)>=1&&3*(toFloat(e.quarter)-1)+1||1;t=t.year(toFloat(e.year)>=1?toFloat(e.year):(new Date).getFullYear()).month(r-1).date(e.day||1)}return(t=t.hour(e.hour||0).minute(e.minute||0).second(e.second||0).millisecond(0)).toDate().getTime()}function calculateInitialDate(e){const{year:t,month:r,quarter:n,week:o,day:i}=e;let{workDay:a,position:s}=e,l=dayjs().startOf("day");if(a)if(a=+a,a<0){const e=()=>{l=l.subtract(1,"days")};for(let t=0;t>a;t--)e()}else{const e=()=>{l=l.add(1,"days")};for(let t=0;t<a;t++)e()}else{if(t&&(l=l.add(toFloat(t),"years")),n&&(l=l.add(toFloat(n),"quarters")),r&&(l=l.add(r,"months")),o&&(l=l.add(o,"weeks")),i&&(l=l.add(i,"days")),s=Number.parseInt(s,10),s===OFFSET.CURRENT)return l.toDate().getTime();if(s===OFFSET.BEGIN)if(i)l=l.date(1);else if(isNil$4(o))if(isNil$4(r))if(isNil$4(n))isNil$4(t)||(l=l.month(0).date(1));else{const e=3*(l.quarter()-1);l=l.month(e).date(1)}else l=l.date(1);else{const e=l.isoWeekday()%7,t=DATE_OFFSET[e<1?7+e-1:e-1];l=l.add(t,"days")}else if(s===OFFSET.END)if(i&&(l=l.date(l.daysInMonth())),o){const e=l.isoWeekday()%7,t=DATE_OFFSET[e<1?7+e-1:e-1]+6;l=l.add(t,"days")}else if(isNil$4(r))if(isNil$4(n))isNil$4(t)||(l=l.month(11).date(31));else{const e=3*l.quarter()-1;l=l.month(e).date(l.daysInMonth())}else l=l.date(l.daysInMonth())}return l.toDate().getTime()}function transform2DateComboValue(e,t,r,n){if(isDateLegal(e,t,r))return toDateJson(e,n)}function transformDateComboValue2Value(e){if(e)return isNumber$5(e)?e:e.type?1===e.type?json2DateTime(e.value):calculateInitialDate(e.value):json2DateTime(e)}function transform2YMDFormat(e,t){if(e){return dayjs(e).format("YYYY-MM-DD")}return t||""}function formatDate(e,t){return isNil$4(e)?"":dayjs(e).format(t)}function getDatetimeTypeByFormat(e){const{isTimeFormat:t,isDateFormat:r,isYearFormat:n,isQuarterFormat:o}=getFormatType(e);return n?BI.DynamicYearCombo.xtype:o?BI.DynamicYearQuarterCombo.xtype:t?r?BI.DynamicDateTimeCombo.xtype:BI.TimeCombo.xtype:r?BI.DynamicDateCombo.xtype:"report.components.dynamic_year_month_combo"}function getDateIntervalTypeByFormat(e){const{isTimeFormat:t,isMonthFormat:r,isYearFormat:n}=getFormatType(e);return n?BI.YearInterval.xtype:r?BI.YearMonthInterval.xtype:t?BI.TimeInterval.xtype:BI.DateInterval.xtype}function getBeforeTime(e,t){return dayjs(e).subtract(1,t).valueOf()}function getDynamicTimeByShortcuts(e,t,r){const n=r?-1:1;switch(t){case SHORTCUTS_TYPE.YEAR:return{...e,value:{...e.value,year:isNumber$5(e.value.year)?e.value.year+n:n}};case SHORTCUTS_TYPE.MONTH:return{...e,value:{...e.value,month:isNumber$5(e.value.month)?e.value.month+n:n}};case SHORTCUTS_TYPE.DAY:return{...e,value:{...e.value,day:isNumber$5(e.value.day)?e.value.day+n:n}};case SHORTCUTS_TYPE.WEEK:return{...e,value:{...e.value,week:isNumber$5(e.value.week)?e.value.week+n:n}};default:return e}}function getAfterTime(e,t){return dayjs(e).add(1,t).valueOf()}const showCalendar=({formatConfig:e})=>({hide:e.payload.type!==DATE_FORMAT_TYPE.YMD}),showShortcuts=({formatConfig:e})=>{const{type:t}=e.payload;return{hide:[DATE_FORMAT_TYPE.HMS,DATE_FORMAT_TYPE.YMD_HMS,DATE_FORMAT_TYPE.YQ].includes(t)}},showShortcutsFontConfig=({style:e})=>{const{shortcutsType:t}=e.styleConfig;return{hide:!t||t===SHORTCUTS_TYPE.NONE}},filterShortcutsOptions=({formatConfig:e})=>{const{type:t}=e.payload;return SHORTCUTS_BUTTON_OPTIONS.filter((e=>e.type.includes(t)))},MIN_WIDTH=100,PADDING_SIZE=12;class DateTimeWidget{constructor(){__publicField(this,"datetime",null),__publicField(this,"dynamicValue",null),__publicField(this,"value"),__publicField(this,"scale",1)}mount({el:e,state:t}){return this.setScale(t.scale),resolveFineUIPopupDislocation((()=>this.scale)),resolveYearMonthDynamic(),resolveFineUIDateIntervalI18n(),{element:e}}render(e){var t;const{element:r,config:n,state:o,runtime:i}=e,{width:a,height:s,scale:l}=o,{styleConfig:c}=n,{shortcutsType:u,fontAttr:d}=c,{value:h,min:p,max:f}=this.getDateValueWithFormat(n);this.setScale(l),null==(t=this.datetime)||t.destroy(),r.innerHTML="";const g=document.createElement("div");r.appendChild(g);const m=()=>{var e,t,r,n;const o=null==(t=null==(e=this.datetime)?void 0:e.getValue)?void 0:t.call(e);isObject$f(o)&&"type"in o&&2===o.type?this.dynamicValue=o:this.dynamicValue=null,null==(n=null==(r=i.events)?void 0:r.onFinish)||n.call(r,transformDateComboValue2Value(o))};if(!u||"none"===u)return new Promise((t=>{BI.createWidget({element:g,ref:e=>{this.datetime=e,t()},...getDatetimeConfig(e,{height:s,value:h,maxDate:f,minDate:p},m)})}));const[y,v]=SHORTCUTS_LABELS[u];return new Promise((t=>BI.createWidget({type:"bi.horizontal_fill",width:a,height:s,css:{alignItems:"center"},element:g,columnSize:["","fill",""],items:[getShortcutsButtonConfig({context:e,text:y,css:{paddingLeft:PADDING_SIZE},action:()=>{var t,r;this.value&&(this.dynamicValue&&(this.dynamicValue=getDynamicTimeByShortcuts(this.dynamicValue,u,!0)),null==(r=null==(t=e.runtime.events)?void 0:t.onFinish)||r.call(t,getBeforeTime(this.value,u)))}}),getDatetimeConfig(e,{value:h,maxDate:f,minDate:p,css:{display:"flex",justifyContent:"center",minWidth:this.dynamicValue?getMinWidth(d.fontSize)+2*d.fontSize:getMinWidth(d.fontSize)},extraCls:"duchamp-shortcuts-wrapper-datetime",ref:e=>{this.datetime=e,t()}},m),getShortcutsButtonConfig({context:e,text:v,css:{paddingRight:PADDING_SIZE},action:()=>{var t,r;this.value&&(this.dynamicValue&&(this.dynamicValue=getDynamicTimeByShortcuts(this.dynamicValue,u,!1)),null==(r=null==(t=e.runtime.events)?void 0:t.onFinish)||r.call(t,getAfterTime(this.value,u)))}})]})))}refresh({config:e}){var t,r,n,o,i;const{value:a,min:s,max:l}=this.getDateValueWithFormat(e);null==(t=this.datetime)||t.setValue(a),null==(n=null==(r=this.datetime)?void 0:r.setMinDate)||n.call(r,s),null==(i=null==(o=this.datetime)?void 0:o.setMaxDate)||i.call(o,l)}getDateValueWithFormat(e){var t;const{valueConfig:r,dateRange:n,formatConfig:o}=e,i=configKit.format.getDateFormat(o).value;this.value=configKit.format.getDateValueWithFormat(r,i);return{value:null!=(t=this.dynamicValue)?t:transform2DateComboValue(this.value,configKit.format.getDateValueWithFormat(n.start,i),configKit.format.getDateValueWithFormat(n.end,i),dateModeMatcher.isTimeMode(i)),min:transform2YMDFormat(configKit.format.getDateValueWithFormat(n.start,i),MIN_DATE),max:transform2YMDFormat(configKit.format.getDateValueWithFormat(n.end,i),MAX_DATE)}}unmount(){var e;null==(e=this.datetime)||e.destroy(),this.datetime=null}save(){return this.dynamicValue}restore(e){this.dynamicValue=e}setScale(e){this.scale=null!=e?e:1}}const getMinWidth=e=>Math.max(5*e+40,MIN_WIDTH);function getDatetimeConfig(e,t,r){const{config:n,state:o}=e,{formatConfig:i,enable:a,placeholder:s=" "}=n,l=configKit.format.getDateFormat(i).value;return{...t,type:getDatetimeTypeByFormat(l),supportDynamic:!getFormatType(l).isTimeFormat,supportWorkDay:!1,height:o.height,disabled:!a,watermark:s,format:transformFormat(l),isNeedAdjustWidth:!1,behaviors:{highlight:()=>!1},allowEditor:!0,listeners:[{eventName:"EVENT_CONFIRM",action:r}]}}function getShortcutsButtonConfig({context:e,text:t,css:r,action:n}){var o,i;const{state:a}=e,{height:s}=a,{shortcutsFontConfig:l}=e.config.styleConfig,c={type:"bi.text_button",height:s,text:t,css:r,handler:n,debounce:!1,title:()=>""};if(l&&l.fontAttr){const{color:e,fontFamily:t,fontAttr:n}=l;c.css={...r,color:e,fontFamily:t,fontSize:n.fontSize,fontStyle:null!=(o=n.fontStyle)?o:"normal",fontWeight:null!=(i=n.fontWeight)?i:"normal"}}return c}const useControllerState=(e,t)=>reactExports.useMemo((()=>({width:e.width,height:e.height,scale:t.store.platform.scale})),[e.width,e.height,t.store.platform.scale]),useControllerFieldConfig=e=>reactExports.useMemo((()=>e.verificationSuccess?e.value?{valueConfig:e.value}:e.isUnset?{valueConfig:null}:null:{valueConfig:null}),[e.value,e.verificationSuccess,e.isUnset]),BASE_CLS$3="fvs-controller-datetime",DateTimeComboController$1=({model:e,width:t,height:r=0})=>{const n=useControllerState({width:t,height:r},e),o=useControllerFieldConfig(e),i=reactExports.useMemo((()=>({start:e.dateRange.start,end:e.dateRange.end})),[e.dateRange.start,e.dateRange.end]),a=reactExports.useMemo((()=>({...o,dateRange:i})),[o,i]),s=useClassWidget({widgetClass:DateTimeWidget,model:e,computed:a,state:n,runtime:{events:{onFinish:t=>{e.onFinish(t)}}}});return jsx("div",{className:classNames$1("fvs-controller",COMBO_CLS,BASE_CLS$3),ref:s})};function DatetimeWidget(e){var t,r,n,o;const{config:i,events:a}=e,{shortcutsType:s,shortcutsFontConfig:l}=i.styleConfig,{valueConfig:c,formatConfig:u,dateRange:d,enable:h,placeholder:p,validation:f}=i,g=configKit.format.getDateFormat(u).value,m=transformDateComboValue2Value(transform2DateComboValue(configKit.format.getDateValueWithFormat(c,g),d.start,d.end,dateModeMatcher.isTimeMode(g)));return jsx("div",{className:"fvs-date-time-controller default-date-time",children:jsx(DateTime,{date:m,onConfirm:(e,t)=>{var r;null==(r=null==a?void 0:a.onFinish)||r.call(a,t?dayjs(t).valueOf():void 0)},onCancel:()=>{var e;null==(e=null==a?void 0:a.onFinish)||e.call(a,void 0)},renderTextWithDate:e=>renderTextWithDateCustom(g,e),minDate:transform2YMDFormat(d.start,MIN_DATE),maxDate:transform2YMDFormat(d.end,MAX_DATE),disabled:!h,watermark:p,enableOffsetPicker:!0,offsetPickerOptions:{enable:!0,includeWorkday:!1},format:transformDateFormat2DayjsFormat$1(g),isRequired:!f.config.allowEmpty.open,invalid:!f.result.success,fastButtonType:s,fastButtonStyle:l?{color:l.color,fontFamily:l.fontFamily,fontStyle:null!=(r=null==(t=l.fontAttr)?void 0:t.fontStyle)?r:"normal",fontWeight:null!=(o=null==(n=l.fontAttr)?void 0:n.fontWeight)?o:"normal",...l.fontAttr}:{}})})}function CalendarWidget(e){var t,r,n,o;const{config:i,events:a,state:s}=e,{valueConfig:l,formatConfig:c,dateRange:u,enable:d,placeholder:h,validation:p,styleConfig:f}=i,g=configKit.format.getDateFormat(c).value,m=configKit.format.getDateValueWithFormat(l,g),{calendarColor:y,shortcutsType:v,shortcutsFontConfig:_,autoFold:b,showCalendarHeader:C,autoEditorShow:E}=f,T=reactExports.useMemo((()=>isNil$4(s.height)?{}:{"--date-widget-height":"".concat(s.height,"px")}),[s.height]),S=transformDateComboValue2Value(transform2DateComboValue(m,u.start,u.end,dateModeMatcher.isTimeMode(g)));return jsx("div",{className:"fvs-date-time-controller",children:jsx(DateTime,{style:{"--fdm-color-theme":y,...T},date:S,onConfirm:(e,t)=>{var r;null==(r=null==a?void 0:a.onFinish)||r.call(a,t?dayjs(t).valueOf():void 0)},onCancel:()=>{var e;null==(e=null==a?void 0:a.onFinish)||e.call(a,void 0)},renderTextWithDate:e=>renderTextWithDateCustom(g,e),minDate:transform2YMDFormat(u.start,MIN_DATE),maxDate:transform2YMDFormat(u.end,MAX_DATE),disabled:!d,watermark:h,format:transformDateFormat2DayjsFormat$1(g),isRequired:!p.config.allowEmpty.open,invalid:!p.result.success,type:"calendar",fastButtonType:v,autoFold:b,showCalendarHeader:C,autoEditorShow:E===CALENDAR_STATUS.EXPAND,fastButtonStyle:_?{color:_.color,fontFamily:_.fontFamily,fontStyle:null!=(r=null==(t=_.fontAttr)?void 0:t.fontStyle)?r:"normal",fontWeight:null!=(o=null==(n=_.fontAttr)?void 0:n.fontWeight)?o:"normal",..._.fontAttr}:{}})})}function WeekCalendarWidget(e){const{config:t,events:r}=e,{valueConfig:n,formatConfig:o,dateRange:i,enable:a,placeholder:s,validation:l,styleConfig:c}=t,u=configKit.format.getDateFormat(o).value,d=configKit.format.getDateValueWithFormat(n,u),{calendarColor:h,autoFold:p,showCalendarHeader:f,autoEditorShow:g}=c,m=transformDateComboValue2Value(transform2DateComboValue(d,i.start,i.end,dateModeMatcher.isTimeMode(u)));return jsx(DateTime,{style:{"--fdm-color-theme":h},date:m,onConfirm:(e,t)=>{var n;null==(n=null==r?void 0:r.onFinish)||n.call(r,t?dayjs(t).valueOf():void 0)},onCancel:()=>{var e;null==(e=null==r?void 0:r.onFinish)||e.call(r,void 0)},minDate:transform2YMDFormat(i.start,MIN_DATE),maxDate:transform2YMDFormat(i.end,MAX_DATE),disabled:!a,watermark:s,format:transformDateFormat2DayjsFormat$1(u),isRequired:!l.config.allowEmpty.open,invalid:!l.result.success,type:"week-calendar",autoFold:p,showCalendarHeader:f,autoEditorShow:g===CALENDAR_STATUS.EXPAND})}function useDatetimeProps(e,t,r){var n,o,i,a,s;const l={width:t,height:r,name:e.name},c={config:e.props.validation,result:isNil$4(e.warning)?{success:!0}:{success:!1,...e.warning}};return{state:l,events:{onEdit:t=>{e.onEdit(t)},onFinish:t=>{e.onFinish(t)}},config:{...e.props,valueConfig:null!=(n=e.value)?n:null,searchAllWhenEmpty:null==(o=e.props.searchAllWhenEmpty)||o,placeholder:null!=(i=e.props.placeholder)?i:"",validation:c,formatConfig:null!=(a=e.formatConfig)?a:{type:"date",payload:DEFAULT_FORMAT},parseDateConfig:null!=(s=e.props.parseDateConfig)?s:{type:"date"},dateRange:{start:e.startDate,end:e.endDate}}}}function DateTimeComboController({model:e,width:t,height:r}){const{state:n,events:o,config:i}=useDatetimeProps(e,t,r);return jsx(FVSWidgetProvider,{model:e,children:jsx(DatetimeWidget,{theme:e.theme,state:n,config:i,events:o})})}function hasShortcutsFontConfig(e){return isNil$3(null==e?void 0:e.shortcutsFontConfig)}var __defProp$r=Object.defineProperty,__getOwnPropDesc$q=Object.getOwnPropertyDescriptor,__decorateClass$q=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$q(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$r(t,r,i),i};const DATE_TIME_CONTROLLER_SIZE=2.75,CALENDAR_DEFAULT_HEIGHT=44;class DateTimeModel extends ControllerModel{constructor(){super(...arguments),__publicField(this,"dataType","date"),__publicField(this,"ref",reactExports.createRef()),__publicField(this,"dynamicTempValue")}get value(){return getDateValueWithFormat(this.format,this.parse(this.calculation.value))}get fieldConfigs(){const e=getFieldConfigs(this);if(this.props.extend){const t=getDateRangeConfig(this.props.extend.dateRange.start),r=getDateRangeConfig(this.props.extend.dateRange.end);t&&e.set("startDate",t),r&&e.set("endDate",r)}return e}getFilterValueWithField(e,t){var r;return{...super.getFilterValueWithField(e,t),format:null==(r=this.props.formatConfig)?void 0:r.payload.type}}parse(e){return isString$3(e)?getDateValueWithFormat(this.format,e):parse2Date(e)}async setFieldValues(e,t){var r;const n=e.get("valueConfig"),o=e.get("startDate"),i=e.get("endDate"),{dateRange:a}=this;!isUndefined$3(o)&&(a.start=parse2Date(getCalculateSingleValue(o))),!isUndefined$3(i)&&(a.end=parse2Date(getCalculateSingleValue(i)));const{start:s,end:l}=(null==(r=this.props.extend)?void 0:r.dateRange)||{};o||(null==s?void 0:s.type)!==DATE_VALUE_TYPE.NONE||(a.start=void 0),i||(null==l?void 0:l.type)!==DATE_VALUE_TYPE.NONE||(a.end=void 0),this.setExtendValue({[CONTROLLER_CONFIG_KEY.DATE_RANGE]:a}),isUndefined$3(n)||("init"===t.type?await this.setValueWithoutValidate(getCalculateSingleValue(n)):await this.setValue(getCalculateSingleValue(n),!1))}get dateRange(){return this.extendValue[CONTROLLER_CONFIG_KEY.DATE_RANGE]||{}}get dateRangeConfig(){var e;return(null==(e=this.props.extend)?void 0:e.dateRange)||{start:{type:DATE_VALUE_TYPE.NONE},end:{type:DATE_VALUE_TYPE.NONE}}}get startDate(){return getDateValueWithFormat(this.format,this.dateRange.start)}get endDate(){return getDateValueWithFormat(this.format,this.dateRange.end)}get placeholder(){return this.props.placeholder||" "}get format(){return getDateFormatByFormatConfig(this.props.formatConfig).value}setDateRange(e){this.setExtend({dateRange:e},!0)}getErrorResult(e,t){return{success:!1,errorMessage:duchampIntl.get(t,dayjs(e).format(transformDateFormat2DayjsFormat(this.format))),valueChanged:!0,value:void 0}}async validateData(e){const t=getDateValueWithFormat(this.format,e);return!isNil$3(this.startDate)&&!isNil$3(t)&&t<this.startDate?this.getErrorResult(this.startDate,"Duchamp-Value_Less_Than_Min_Value"):!isNil$3(this.endDate)&&!isNil$3(t)&&t>this.endDate?this.getErrorResult(this.endDate,"Duchamp-Value_More_Than_Max_Value"):{success:!0}}setPropsValueConfig(e){var t;e.type===CONTROLLER_VALUE_TYPE.STRING?this.setProps({valueConfig:{type:CONTROLLER_VALUE_TYPE.DATE,payload:{date:null!=(t=parse2Date(e.payload.value))?t:0}}}):this.setProps({valueConfig:e})}getValue(){var e;if(isNilOrEmptyString$1(this.value))return"";if("string"===(null==(e=this.props.parseDateConfig)?void 0:e.type)){const e=getDateFormatByFormatConfig(this.props.formatConfig).value;return formatDate(this.value,transformDateFormat2DayjsFormat(e))}return new Date(this.value)}get dateValue(){return transformDateComboValue2Value(transform2DateComboValue(this.value,this.startDate,this.endDate,dateModeMatcher.isTimeMode(this.format)))}get dateValueFormatDateType(){if(this.value)return dayjs(this.dateValue).toDate()}get minDate(){return transform2YMDFormat(this.startDate,MIN_DATE)}get maxDate(){return transform2YMDFormat(this.endDate,MAX_DATE)}get minDateFormatDateType(){return dayjs(transform2YMDFormat(this.startDate,MIN_DATE)).toDate()}get maxDateFormatDateType(){return dayjs(transform2YMDFormat(this.endDate,MAX_DATE)).toDate()}get autoHeight(){return this.style.styleType===DATE_STYLE_TYPE.CALENDAR||this.style.styleType===DATE_STYLE_TYPE.WEEK_CALENDAR}getMobileWidgetHeight(e){return this.store.controllerPanel.widgets.find((e=>e.id===this.id))?CALENDAR_DEFAULT_HEIGHT:isFluidLayout(this.store.platform.mobile.layoutConfig)?void 0:this.store.isMagneticLayout?e:this.fontSize*DATE_TIME_CONTROLLER_SIZE}resetStyleConfigWhenFormatChange(e){var t;this.setProps({styleConfig:{...this.widget.props.styleConfig,shortcutsType:SHORTCUTS_TYPE.NONE}}),this.setMobileProps({styleType:"default",styleConfig:{...null==(t=this.widget.mobile.props)?void 0:t.styleConfig,shortcutsType:SHORTCUTS_TYPE.NONE}})}collectFonts(){var e;const t=super.collectFonts(),{styleConfig:r}=this.props;return hasShortcutsFontConfig(r)&&t.push((null==(e=r.shortcutsFontConfig)?void 0:e.fontFamily)||""),t}getControllerConfigOptions(){return{formatConfig:{dateFormatList:get$5(settingCenter.getComponentConfig(this.widget.type),"dateFormatList",DATE_FORMAT_LISTS)}}}replaceData(e){super.replaceData(e);const{replacement:t}=e,{extend:r}=this.props;if(r){const e=replaceDateConfigData(r.dateRange.start,t),n=replaceDateConfigData(r.dateRange.end,t);this.setProps({extend:{...r,dateRange:{...r.dateRange,start:e,end:n}}})}}get dynamicValue(){return this.dynamicTempValue}setDynamicValue(e){this.dynamicTempValue=e}getText(){return void 0===this.value?"":configKit$1.dateTimeFormat.utils.getFormattedDateTime(new Date(this.value),this.format)}getValueByJsApi(){const e=this.getValue();return isDateTimeType(e)?new Date(e.value):e}setMaxAndMinDate({min:e,max:t}){var r;const n=dayjs(e),o=dayjs(t).endOf("day");n.isValid()&&o.isValid()&&!n.isAfter(o)&&(null==(r=this.props.formatConfig)?void 0:r.payload.type)!==DATE_FORMAT_TYPE.HMS&&this.setExtendValue({[CONTROLLER_CONFIG_KEY.DATE_RANGE]:{start:getDateValueWithFormat(this.format,n),end:getDateValueWithFormat(this.format,o)}})}}__decorateClass$q([content("dateRange")],DateTimeModel.prototype,"dateRangeConfig"),__decorateClass$q([jsApi()],DateTimeModel.prototype,"getText"),__decorateClass$q([jsApi("getValue")],DateTimeModel.prototype,"getValueByJsApi"),__decorateClass$q([jsApi()],DateTimeModel.prototype,"setMaxAndMinDate");const registerControllerDatetime=()=>{registerController({meta:{type:"d-controller-datetime",displayName:duchampIntl.get("Duchamp-Controller_Datetime"),version:"0.0.1",iconfont:"icon-date-components",dragPreviewImage:"/assets/widget/controller_datetime.svg",groupName:duchampIntl.get("Duchamp-Controller_Date"),borderLine:DEFAULT_CONTROLLER_BORDER_LINE,props:{valueConfig:{type:CONTROLLER_VALUE_TYPE.DATE,payload:{date:getDateValueWithFormat(DEFAULT_FORMAT.value,new Date)}},formatConfig:{type:FORMAT_TYPE.DATE,payload:DEFAULT_FORMAT},parseDateConfig:{type:"date"}},configuration:{type:"object",properties:{formatConfig:{title:duchampIntl.get("Duchamp-Format"),widget:"formatConfig"},...getBaseProperties(),relatedControllers:{title:duchampIntl.get("Duchamp-Controller_Linkage"),widget:"relatedControllers"},defaultValue:{title:duchampIntl.get("Duchamp-Default_Value"),widget:"defaultValue",props:{dataType:"date",formatConfig:"{{ formData.formatConfig }}"}},parseDataValue:{title:duchampIntl.get("Duchamp-Parse_Value_Config"),widget:"parseDataValue"},watermark:{title:duchampIntl.get("Duchamp-Watermark"),widget:"watermark"},dateRange:{title:duchampIntl.get("Duchamp-Controller_Date_Range"),widget:"dateRange",props:{formatConfig:"{{ formData.formatConfig }}"}},authority:{title:duchampIntl.get("Duchamp-Permission"),widget:"authority"},validation:{title:duchampIntl.get("Duchamp-Calibration"),widget:"validation"},style:{widget:"style",props:{formatConfig:"{{ formData.formatConfig }}",style:"{{ formData.style }}"}}}}},view:DateTimeComboController$1,mobileView:DateTimeComboController,model:DateTimeModel})};function CalendarTimeController({model:e,width:t}){const r=reactExports.useMemo((()=>e.getMobileWidgetHeight(e.height)),[e]),{state:n,events:o,config:i}=useDatetimeProps(e,t,r);return jsx(FVSWidgetProvider,{model:e,children:jsx(CalendarWidget,{theme:e.theme,state:n,config:i,events:o})})}const registerDatetimeCalendar=()=>{registerControllerStyle("d-controller-datetime",{type:DATE_STYLE_TYPE.CALENDAR,displayName:duchampIntl.get("Duchamp-Calendar_Normal"),platforms:["mobile"],beforeRender:showCalendar,configuration:[{name:"shortcutsType",displayName:duchampIntl.get("Duchamp-Shortcut_Button"),type:"select",value:SHORTCUTS_TYPE.DAY,options:SHORTCUTS_BUTTON_OPTIONS,style:{width:"100%"},platforms:["pc","mobile"],beforeRender:showShortcuts,optionsFilter:filterShortcutsOptions},{type:"verticalLayout",displayName:duchampIntl.get("Duchamp-Font_Style"),children:[{name:"fontFamily",title:duchampIntl.get("Duchamp-Controller_Calendar"),value:DEFAULT_CONTROLLER_STYLE_PROPS.fontFamily,type:"fontSelect"},{name:"fontAttr",value:DEFAULT_CONTROLLER_STYLE_PROPS.fontAttr,showTypes:{bold:!0,italic:!0},mobileProperties:["fontSize"],type:"title-style"},{name:"color",value:DEFAULT_CONTROLLER_STYLE_PROPS.color,type:"colorSelect"},{name:"shortcutsFontConfig.fontFamily",title:duchampIntl.get("Duchamp-Shortcut_Button"),value:DEFAULT_CONTROLLER_STYLE_PROPS.fontFamily,type:"fontSelect",beforeRender:showShortcutsFontConfig},{name:"shortcutsFontConfig.fontAttr",title:"",value:DEFAULT_CONTROLLER_STYLE_PROPS.fontAttr,showTypes:{bold:!0,italic:!0},prefixIcon:jsx(PlatformPopoverIcon,{}),type:"title-style",mobileProperties:["fontSize"],beforeRender:showShortcutsFontConfig},{name:"shortcutsFontConfig.color",value:DEFAULT_CONTROLLER_STYLE_PROPS.color,type:"colorSelect",beforeRender:showShortcutsFontConfig}]},{name:"iconColor",displayName:duchampIntl.get("Duchamp-Template_Icon_Color"),value:DEFAULT_SINGLE_COLOR$1,type:"colorSelect"},{type:"verticalLayout",displayName:duchampIntl.get("Duchamp-Calendar"),children:[{name:"calendarColor",title:duchampIntl.get("Duchamp-Colorway"),type:"colorSelect",value:DEFAULT_CONTROLLER_STYLE_PROPS.color},{name:"autoEditorShow",title:duchampIntl.get("Duchamp-State"),type:"select",value:CALENDAR_STATUS.COLLAPSE,options:CALENDAR_STATUS_OPTIONS,style:{width:"100%"}},{name:"autoFold",type:"checkbox",value:!1,text:duchampIntl.get("Duchamp-Calendar_Auto_Fold")},{name:"showCalendarHeader",title:duchampIntl.get("Duchamp-Navigation"),type:"checkbox",value:!1,text:duchampIntl.get("Duchamp-Calendar_Show_Navigation")}]}],props:{shortcutsType:SHORTCUTS_TYPE.DAY,calendarColor:DEFAULT_CONTROLLER_STYLE_PROPS.color,autoFold:!1,showCalendarHeader:!1,autoEditorShow:CALENDAR_STATUS.COLLAPSE,shortcutsFontConfig:DEFAULT_CONTROLLER_STYLE_PROPS,...DEFAULT_CONTROLLER_STYLE_PROPS},themeTransfer:e=>({color:e.fontColorNormal,calendarColor:e.colorPrimary,shortcutsFontConfig:{color:e.colorPrimary}})},DateTimeComboController$1,CalendarTimeController)},registerDatetimeDefault=()=>{registerControllerStyle("d-controller-datetime",{type:DATE_STYLE_TYPE.DEFAULT,displayName:duchampIntl.get("Duchamp-Default_Style"),platforms:["pc","mobile"],configuration:[{name:"shortcutsType",displayName:duchampIntl.get("Duchamp-Shortcut_Button"),type:"select",value:SHORTCUTS_TYPE.NONE,options:SHORTCUTS_BUTTON_OPTIONS,style:{width:"100%"},platforms:["pc","mobile"],beforeRender:showShortcuts,optionsFilter:filterShortcutsOptions},{type:"verticalLayout",displayName:duchampIntl.get("Duchamp-Font_Style"),children:[{name:"fontFamily",title:duchampIntl.get("Duchamp-Controller_Value"),value:DEFAULT_CONTROLLER_STYLE_PROPS.fontFamily,type:"fontSelect"},{name:"fontAttr",value:DEFAULT_CONTROLLER_STYLE_PROPS.fontAttr,showTypes:{bold:!0,italic:!0},prefixIcon:jsx(PlatformPopoverIcon,{}),type:"title-style",mobileProperties:["fontSize"]},{name:"color",value:DEFAULT_CONTROLLER_STYLE_PROPS.color,type:"colorSelect"},{name:"shortcutsFontConfig.fontFamily",title:duchampIntl.get("Duchamp-Shortcut_Button"),value:DEFAULT_CONTROLLER_STYLE_PROPS.fontFamily,type:"fontSelect",beforeRender:showShortcutsFontConfig},{name:"shortcutsFontConfig.fontAttr",value:DEFAULT_CONTROLLER_STYLE_PROPS.fontAttr,showTypes:{bold:!0,italic:!0},prefixIcon:jsx(PlatformPopoverIcon,{}),type:"title-style",mobileProperties:["fontSize"],showPlatform:!0,beforeRender:showShortcutsFontConfig},{name:"shortcutsFontConfig.color",value:DEFAULT_CONTROLLER_STYLE_PROPS.color,type:"colorSelect",beforeRender:showShortcutsFontConfig}]},{name:"iconColor",displayName:duchampIntl.get("Duchamp-Template_Icon_Color"),value:DEFAULT_SINGLE_COLOR$1,type:"colorSelect"}],props:{shortcutsType:"none",shortcutsFontConfig:DEFAULT_CONTROLLER_STYLE_PROPS,...DEFAULT_CONTROLLER_STYLE_PROPS},themeTransfer:e=>({color:e.fontColorNormal,shortcutsFontConfig:{color:e.colorPrimary}})},DateTimeComboController$1,DateTimeComboController)};function WeekCalendarTimeController({model:e,height:t,width:r}){const{state:n,events:o,config:i}=useDatetimeProps(e,r,t);return jsx(FVSWidgetProvider,{model:e,children:jsx(WeekCalendarWidget,{theme:e.theme,state:n,config:i,events:o})})}const registerDatetimeWeekCalendar=()=>{registerControllerStyle("d-controller-datetime",{type:DATE_STYLE_TYPE.WEEK_CALENDAR,displayName:duchampIntl.get("Duchamp-Calendar_Week"),platforms:["mobile"],beforeRender:showCalendar,configuration:[...DEFAULT_CONTROLLER_STYLE_META.configuration,{type:"verticalLayout",displayName:duchampIntl.get("Duchamp-Calendar"),children:[{name:"calendarColor",title:duchampIntl.get("Duchamp-Colorway"),type:"colorSelect",value:DEFAULT_CONTROLLER_STYLE_PROPS.color},{name:"autoEditorShow",title:duchampIntl.get("Duchamp-State"),type:"select",value:CALENDAR_STATUS.COLLAPSE,options:CALENDAR_STATUS_OPTIONS,style:{width:"100%"}},{name:"autoFold",type:"checkbox",value:!1,text:duchampIntl.get("Duchamp-Calendar_Auto_Fold")},{name:"showCalendarHeader",title:duchampIntl.get("Duchamp-Navigation"),type:"checkbox",value:!0,text:duchampIntl.get("Duchamp-Calendar_Show_Navigation")}]}],props:{calendarColor:"#E0E0E0",autoEditorShow:CALENDAR_STATUS.COLLAPSE,autoFold:!1,showCalendarHeader:!0,...DEFAULT_CONTROLLER_STYLE_PROPS},themeTransfer:e=>({color:e.fontColorNormal,calendarColor:e.colorPrimary})},DateTimeComboController$1,WeekCalendarTimeController)},BASE_SINGLE_SELECT_CLS="fvs-controller-combo",BASE_MULTI_SELECT_CLS="fvs-controller-combo-checkbox";class SelectWidget{constructor(e){__publicField(this,"scale",1),__publicField(this,"singleSelect",null),__publicField(this,"multiSelect",null),__publicField(this,"isSelectAll",!1),this.fvs=e}mount({el:e,state:t}){return this.setScale(t.scale),resolveFineUIPopupDislocation((()=>this.scale)),{element:e}}render(e){const{element:t,state:r,config:n}=e,{scale:o}=r;this.setScale(o),this.unmount(),t.innerHTML="";const i=document.createElement("div");t.appendChild(i);return(n.multiSelect?this.renderMultiSelect.bind(this):this.renderSingleSelect.bind(this))(i,e).then((e=>{resolveFineUIComboPopupViewFit(e,classNames$1(COMBO_POPUP_CLS,"".concat(n.multiSelect?BASE_MULTI_SELECT_CLS:BASE_SINGLE_SELECT_CLS,"-popup-view")),n.styleConfig.fontAttr.fontSize,(()=>this.scale))}))}refresh(e){var t,r,n,o;const{state:i,config:a}=e,{valueConfig:s,dataDictionaryConfig:l}=a,{scale:c}=i;if(this.setScale(c),a.multiSelect){const e=transformValue2MultiComboValue(s,l);null==(t=this.multiSelect)||t.setRepopulate(!0),null==(r=this.multiSelect)||r.setValue(e)}else{const e=isArray$d(s)?null==s?void 0:s.at(0):s,t=transformValue2ComboValue(isNil$4(e)?null:String(e),l);null==(n=this.singleSelect)||n.setRepopulate(!0),null==(o=this.singleSelect)||o.setValue(t)}}getFuiSelectConfig(e,t){var r;const{config:n,state:o}=t,{validation:i,placeholder:a,enable:s}=n,{width:l,height:c}=o,{fontSize:u}=n.styleConfig.fontAttr;return{element:e,height:c,width:l,disabled:!s,watermark:a,customData:!!(null==(r=i.config.customValue)?void 0:r.open),allowNoSelect:i.config.allowEmpty.open,maxPopupHeight:getPopupMaxHeight(),allowEdit:!0,itemHeightGetter:()=>resolveFineUIComboPopupViewItemHeight(u),itemsCreator:(e,t)=>{var r,n;null==(n=(r=this.fvs.special).getDataDictionary)||n.call(r,e).then(t)}}}renderMultiSelect(e,t){const{config:r,runtime:n}=t,{validation:o,valueConfig:i,showSelectAll:a}=r,s=r.dataDictionaryConfig,l=i;return new Promise((r=>{BI.createWidget({type:"report.search_text_value_combo",ref:e=>{this.multiSelect=e,r(e)},allowBlank:o.config.allowEmpty.open,showSelectAll:a,value:transformValue2MultiComboValue(l,s),...this.getFuiSelectConfig(e,t),listeners:[{eventName:MULTI_COMBO_EVENT.EVENT_CONFIRM,action:()=>{var e,t,r,o,i,a,s;const l=null==(e=this.multiSelect)?void 0:e.getAllButtons(),c=transformMultiComboValue2Value(null!=(r=null==(t=this.multiSelect)?void 0:t.getValue())?r:[],!1);if(0===c.length&&(this.isSelectAll=!1),this.isSelectAll&&isArray$d(l)){const e=l.reduce(((e,t)=>(isObject$f(t)&&"isSelected"in t&&isFunction$9(t.isSelected)&&"getValue"in t&&isFunction$9(t.getValue)&&!t.isSelected()&&e.push(String(t.getValue())),e)),[]);null==(i=null==(o=n.events)?void 0:o.onFinish)||i.call(o,{isSelectedAll:!0,selected:e,value:c})}else null==(s=null==(a=n.events)?void 0:a.onFinish)||s.call(a,{isSelectedAll:!1,value:c})}},{eventName:MULTI_COMBO_EVENT.EVENT_SELECT_ALL,action:e=>{this.isSelectAll=e}}]})}))}renderSingleSelect(e,t){var r;const{config:n,runtime:o}=t,{validation:i,valueConfig:a}=n,s=!!(null==(r=i.config.customValue)?void 0:r.open),l=isArray$d(a)?null==a?void 0:a.at(0):a,c=isNil$4(l)?null:String(l),u=n.dataDictionaryConfig;return new Promise((r=>{BI.createWidget({type:"report.single_select_combo",ref:e=>{this.singleSelect=e,r(e)},value:transformValue2ComboValue(c,u),controlDataGetter:()=>u,...this.getFuiSelectConfig(e,t),listeners:[{eventName:COMBO_EVENT.EVENT_CONFIRM,action:()=>{var e,t,r;null==(r=null==(e=o.events)?void 0:e.onFinish)||r.call(e,{value:transformComboValue2Value(null==(t=this.singleSelect)?void 0:t.getValue())})}},{eventName:COMBO_EVENT.EVENT_KEY_DOWN_ENTER,action:e=>{var t;s&&(null==(t=this.singleSelect)||t.selectItem(e))}}]})}))}unmount(){var e,t;null==(e=this.singleSelect)||e.destroy(),this.singleSelect=null,null==(t=this.multiSelect)||t.destroy(),this.multiSelect=null}setScale(e){this.scale=null!=e?e:1}}function useControllerComputed(e,t,r){const n=useLatest$3(t),o=reactExports.useRef(!0),[i,a]=reactExports.useState((()=>isEmpty$4(e.calculation)?null:n.current(e))),s=reactExports.useMemo((()=>{const t=isNil$3(e.warning)?{success:!0}:{success:!1,...e.warning};return{config:e.props.validation,result:t}}),[e.props.validation,e.warning]),l=useLatest$3(s);reactExports.useEffect((()=>{const t=()=>{a(n.current(e))};return!o.current&&t(),e.addEventListener(CONTROLLER_REFRESHED,t),()=>{e.removeEventListener(CONTROLLER_REFRESHED,t)}}),[e,n]),reactExports.useEffect((()=>(o.current=!1,()=>{o.current=!0})),[]);return reactExports.useMemo((()=>i?{validation:l.current,...i,...r}:null),[i,l,r])}function DefaultSingleComboController$1({model:e,width:t,height:r=0}){const n=useControllerState({width:t,height:r},e),o=useControllerComputed(e,(e=>({valueConfig:e.value,dataDictionaryConfig:e.data}))),i=reactExports.useMemo((()=>{if(e.props.multiSelect&&o){const{valueConfig:e}=o;return{...o,valueConfig:isArray$d(e)?e:[e]}}return o}),[o,e.props.multiSelect]),a=useClassWidget({widgetClass:SelectWidget,model:e,computed:i,state:n,runtime:{events:{onFinish:t=>{isObject$f(t)&&"value"in t?e.onFinish(t.value):e.onFinish(t)}}}});return jsx("div",{className:classNames$1("fvs-controller",COMBO_CLS,{[BASE_SINGLE_SELECT_CLS]:!e.props.multiSelect,[BASE_MULTI_SELECT_CLS]:e.props.multiSelect}),ref:a})}const useComboController=e=>{const{items:t,canCustomValue:r,onSearch:n,onConfirm:o}=e,[i,a]=reactExports.useState(""),{value:s=[]}=useAsync((async()=>i?n(i):[]),[i]);return{searchItems:reactExports.useMemo((()=>i?r?s.some((e=>e.text===i))?s:[...s,{text:i,value:i,custom:!0}]:s:t),[r,t,s,i]),searchText:i,setSearchText:a,handleConfirm:e=>{null==o||o(e),a("")}}},useControllerThemeStyle=e=>{const{iconColor:t,highlightColor:r}=e.widget.controller.content.styleConfig;return{"--fvs-controller-icon-color":t,"--fvs-controller-highlight-color":r}},Select=observer((e=>{const[t,r]=reactExports.useState(!1),{model:n,onConfirm:o,...i}=e,{styleConfig:a}=useStore(),s=useControllerThemeStyle(a),{setSearchText:l,searchItems:c,handleConfirm:u}=useComboController({items:n.data,onSearch:e=>n.searchData(e),onConfirm:o,canCustomValue:n.customValue});return jsx(DropMenu,{items:c,onConfirm:u,onSearchChange:l,popupClassName:"fvs-combo-popup",popupStyle:s,beforeEditorShow:()=>{r(!0),n.fetchData().finally((()=>{r(!1)}))},isLoading:t,watermark:n.placeholder,disabled:!n.enable,isRequired:!n.allowEmpty,invalid:!!n.warning,...i})})),DefaultMultiComboController=observer((({model:e})=>{const t=transformValue2MultiComboValue(e.value,e.data);return jsx(Select,{multiple:!0,model:e,value:t,text:t.map((e=>e.text)).join(","),showSelectAll:e.showSelectAll,onItemSelect:(t,r)=>{r&&t.custom&&e.customValue&&!e.data.some((e=>e.text===t.text))&&e.addData(String(t.value))},onConfirm:t=>{e.onFinish(transformMultiComboValue2Value(t,settingCenter.controllerConfig.sourceAllowEmptyValues))}})})),DefaultSingleComboController=({model:e,...t})=>e.multiSelect?jsx(DefaultMultiComboController,{model:e,...t}):jsx(DefaultSingleComboControllerView,{model:e,...t}),DefaultSingleComboControllerView=observer((({model:e})=>{const t=transformValue2ComboValue(e.value,e.data);return jsx(Select,{multiple:!1,model:e,value:t||[],text:t?t.text:"",onConfirm:t=>{e.onFinish(transformComboValue2Value(null==t?void 0:t[0]))}})})),registerComboDefault=()=>{registerControllerStyle("d-controller-combo",{type:"default",displayName:duchampIntl.get("Duchamp-Default_Style"),configuration:[...DEFAULT_CONTROLLER_STYLE_META.configuration,{name:"iconColor",displayName:duchampIntl.get("Duchamp-Template_Icon_Color"),value:DEFAULT_SINGLE_COLOR$1,type:"colorSelect"}],themeTransfer:e=>({color:e.fontColorNormal,selected:{color:e.fontColorSelected}})},DefaultSingleComboController$1,DefaultSingleComboController)},SimpleMultiComboController=observer((({model:e})=>{const t=transformValue2MultiComboValue(e.value,e.data);return jsx(Select,{simple:!0,multiple:!0,value:t,text:t.map((e=>e.text)).join(","),model:e,showSelectAll:e.showSelectAll,onConfirm:t=>{e.onFinish(transformMultiComboValue2Value(t,settingCenter.controllerConfig.sourceAllowEmptyValues))},onItemSelect:(t,r)=>{r&&t.custom&&e.customValue&&!e.data.some((e=>e.text===t.text))&&e.addData(String(t.value))}})})),SimpleSingleCombController=({model:e,...t})=>e.multiSelect?jsx(SimpleMultiComboController,{model:e,...t}):jsx(SimpleSingleCombControllerView,{model:e,...t}),SimpleSingleCombControllerView=observer((({model:e})=>{const t=transformValue2ComboValue(e.value,e.data);return jsx(Select,{simple:!0,multiple:!1,model:e,value:t||[],text:t?t.text:"",onConfirm:t=>{e.onFinish(transformComboValue2Value(null==t?void 0:t[0]))}})})),registerComboSimple=()=>{registerControllerStyle("d-controller-combo",{type:"simple",displayName:duchampIntl.get("Duchamp-Simple_DropDown"),configuration:[...DEFAULT_CONTROLLER_STYLE_META.configuration,{name:"iconColor",displayName:duchampIntl.get("Duchamp-Template_Icon_Color"),value:DEFAULT_SINGLE_COLOR$1,type:"colorSelect"}],platforms:["mobile"],themeTransfer:e=>({color:e.fontColorNormal,selected:{color:e.fontColorSelected}})},DefaultSingleComboController$1,SimpleSingleCombController)},registerControllerCombo=()=>{registerController({meta:{type:"d-controller-combo",displayName:duchampIntl.get("Duchamp-Controller_Combo"),version:"0.0.1",iconfont:"icon-drop-down-box-components",dragPreviewImage:"/assets/widget/controller_combo.svg",groupName:duchampIntl.get("Duchamp-Controller_List"),borderLine:DEFAULT_CONTROLLER_BORDER_LINE,props:{multiSelect:!1,validation:{allowEmpty:{open:!0,errorTip:""},customValue:{open:!0,errorTip:""}}},configuration:{type:"object",properties:{...getBaseProperties(),dataConfig:{title:duchampIntl.get("Duchamp-Option_Source"),widget:"dataConfig"},multiSelect:{title:duchampIntl.get("Duchamp-Option"),widget:"multiSelect"},selectAll:{widget:"selectAll"},parseValueConfig:{widget:"parseValueConfig"},relatedControllers:{title:duchampIntl.get("Duchamp-Controller_Linkage"),widget:"relatedControllers"},defaultValue:{title:duchampIntl.get("Duchamp-Default_Value"),widget:"defaultValue"},watermark:{title:duchampIntl.get("Duchamp-Watermark"),widget:"watermark"},authority:{title:duchampIntl.get("Duchamp-Permission"),widget:"authority"},validation:{title:duchampIntl.get("Duchamp-Calibration"),widget:"validation",props:{validation:["empty","customValue"]}}}}},view:DefaultSingleComboController$1,mobileView:DefaultSingleComboController,model:ListControllerModel})};function getValueByFormat(e,t,r){if(null!==t){if(isNumber$5(t))return QUICK_CONFIGURATION_VALUES[t];if(isObject$f(t))return t}const n=configKit.format.getDateFormat(e.formatConfig).value,o=dateModeMatcher.isTimeMode(n),{start:i,end:a}=getDateRange(e,n,r),s=configKit.format.getDateValueWithFormat(e.dateRange.start,n),l=configKit.format.getDateValueWithFormat(e.dateRange.end,n);return{start:transform2DateComboValue(i,s,l,o),end:transform2DateComboValue(a,s,l,o)}}function getDateRange(e,t,r){const{valueConfig:n}=e,{start:o,end:i}=n;if(!isNil$4(r)){const e=Number(r)||0,t=QUICK_CONFIGURATION_VALUES[e];return{start:transformDateComboValue2Value(t.start),end:transformDateComboValue2Value(t.end)}}const a=e=>isString$4(e)?getDateValueWithFormat$1(t,e):configKit.dateRange.parse2Date(e);return{start:a(o),end:a(i)}}const MOBILE_YMD_FORMAT="YYYY-MM-DD",transform2ValidDate=(e,t,r)=>isNil$4(e)||t&&!(e>=t)||r&&!(e<=r)?null:e;function DateRangeWidget$1(e){const{config:t,events:r}=e,{formatConfig:n,rangeSelector:o,startPlaceholder:i,endPlaceholder:a,styleConfig:s,enable:l,validation:c,valueConfig:u}=t,{fontAttr:d}=s,h=o.length>=1&&n.payload.type===DATE_FORMAT_TYPE.YMD,p=configKit.format.getDateFormat(n).value,f=getDateRange(t,p,null),g=configKit.format.getDateValueWithFormat(t.dateRange.start,p),m=configKit.format.getDateValueWithFormat(t.dateRange.end,p),y=transform2ValidDate(f.start,g,m),v=transform2ValidDate(f.end,g,m);return jsx("div",{className:classNames$1("fvs-date-interval-controller",{"default-date-interval":!h}),children:jsx(RangeDate,{watermarkMin:i,watermarkMax:a,className:"date-interval-container",style:{"--font-size":"".concat(d.fontSize,"px")},showErrorToast:!1,value:[y,v],disabled:!l,isRequiredMin:!c.config.allowEmpty.open&&!v,isRequiredMax:!c.config.allowEmpty.open&&!y,onChange:e=>{var t;const n=isDate$3(e[0])?dayjs(e[0]).valueOf():e[0],o=isDate$3(e[1])?dayjs(e[1]).valueOf():e[1];null==(t=null==r?void 0:r.onFinish)||t.call(r,{start:n,end:o})},rangeMin:g,rangeMax:m,propsBoth:{enableOffsetPicker:!0,offsetPickerOptions:{enable:!0,includeWorkday:!1},renderTextWithDate:e=>renderTextWithDateCustom(p,e)},format:n.payload.type===DATE_FORMAT_TYPE.YMD?MOBILE_YMD_FORMAT:transformDateFormat2DayjsFormat$1(p),quickRangeOptions:h?o:[],defaultQuickRange:h?u.quickButton:null})})}function useValueConfig(e){const{valueConfig:t}=useControllerFieldConfig(e)||{};if(!t)return{start:void 0,end:void 0};const r=getDateRangeInStartDateConfig(e);return{start:t.start,end:t.end,quickButton:null==r?void 0:r.value}}function getDateRangeInStartDateConfig(e){var t;const{payload:r}=e.props.valueConfig;if("startDate"in r&&"dateRange"===r.startDate.type)return{type:"dateRange",value:null!=(t=r.startDate.payload.dateRange)?t:0}}function DateIntervalController$1({model:e,width:t,height:r=0}){var n,o,i,a,s,l,c,u,d,h,p;const f=reactExports.useMemo((()=>({width:t,height:r,name:e.name})),[t,r,e.name]),g=reactExports.useMemo((()=>{const t=isNil$4(e.warning)?{success:!0}:{success:!1,...e.warning};return{config:e.props.validation,result:t}}),[e.props.validation,e.warning]),m=reactExports.useMemo((()=>({onEdit:t=>{e.onEdit(t)},onFinish:t=>{e.onFinish(t)}})),[e]),y=reactExports.useMemo((()=>({start:e.dateRange.start,end:e.dateRange.end})),[e.dateRange.start,e.dateRange.end]),v=useValueConfig(e);return jsx(FVSWidgetProvider,{model:e,children:jsx(DateRangeWidget$1,{theme:e.theme,state:f,events:m,config:{...e.props,dateRange:y,rangeSelector:null!=(o=null==(n=e.props.extend)?void 0:n.rangeSelector)?o:[],valueConfig:v,startPlaceholder:null!=(s=null==(a=null==(i=e.props.extend)?void 0:i.dateIntervalWatermarkConfig)?void 0:a.start)?s:"",endPlaceholder:null!=(u=null==(c=null==(l=e.props.extend)?void 0:l.dateIntervalWatermarkConfig)?void 0:c.end)?u:"",validation:g,formatConfig:null!=(d=e.formatConfig)?d:{type:"date",payload:DEFAULT_FORMAT},parseDateConfig:null!=(h=e.props.parseDateConfig)?h:{type:"date"},searchAllWhenEmpty:null==(p=e.props.searchAllWhenEmpty)||p}})})}function isDateIntervalUnset(e){var t,r,n,o,i;return e.type===CONTROLLER_VALUE_TYPE.STRING?""===(null==(t=null==e?void 0:e.payload)?void 0:t.value):e.type===CONTROLLER_VALUE_TYPE.FIELD?""===(null==(r=null==e?void 0:e.payload)?void 0:r.field):e.type===CONTROLLER_VALUE_TYPE.FORMULA?""===(null==(n=null==e?void 0:e.payload)?void 0:n.formula):e.type===CONTROLLER_VALUE_TYPE.DATE?isNil$3(null==(o=null==e?void 0:e.payload)?void 0:o.date):e.type===CONTROLLER_VALUE_TYPE.DATE_RANGE&&isNil$3(null==(i=null==e?void 0:e.payload)?void 0:i.dateRange)}function getDateIntervalFieldConfig(e,t=!1){return e.type===CONTROLLER_VALUE_TYPE.STRING?{type:"static",value:[e.payload.value]}:"date"===e.type?{type:"static",value:[e.payload.date]}:"dateRange"===e.type?{type:"static",value:{dateRange:e.payload.dateRange}}:"field"===e.type?{type:"dataset",datasetName:e.payload.dataSet,columns:[{name:e.payload.field,summary:"first"}],payload:{repeatable:t}}:"formula"===e.type?{type:"formula",columns:[{formula:e.payload.formula}]}:{type:e.type,payload:e.payload}}var __defProp$q=Object.defineProperty,__getOwnPropDesc$p=Object.getOwnPropertyDescriptor,__decorateClass$p=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$p(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$q(t,r,i),i};class DateIntervalModel extends ControllerModel{constructor(){super(...arguments),__publicField(this,"dataType","dateRange"),__publicField(this,"ref",reactExports.createRef())}get value(){const e=this.parse(this.calculation.value);return{start:getDateValueWithFormat(this.format,e.start),end:getDateValueWithFormat(this.format,e.end)}}get fieldConfigs(){var e,t;const r=new Map,n=this.props.dataDictionaryConfig;if(this.props.valueConfig.type===CONTROLLER_VALUE_TYPE.DATE_RANGE){const e=this.props.valueConfig.payload.startDate,t=this.props.valueConfig.payload.endDate;isDateIntervalUnset(e)?r.set("startDateValueConfig",{type:"static",value:""}):r.set("startDateValueConfig",getDateIntervalFieldConfig(e,!!(null==n?void 0:n.repeatable))),isDateIntervalUnset(t)?r.set("endDateValueConfig",{type:"static",value:"dateRange"===e.type?[e.payload.dateRange]:""}):r.set("endDateValueConfig",getDateIntervalFieldConfig(t,!!(null==n?void 0:n.repeatable)))}if(n&&n&&r.set("dataDictionaryConfig",getDataFieldConfig(n,this.relatedFields)),null==(t=null==(e=this.props)?void 0:e.extend)?void 0:t.dateRange){const e=getDateRangeConfig(this.props.extend.dateRange.start),t=getDateRangeConfig(this.props.extend.dateRange.end);e&&r.set("startDate",e),t&&r.set("endDate",t)}return r}getFilterValueWithField(e,t){var r;return{...super.getFilterValueWithField(e,t),format:null==(r=this.props.formatConfig)?void 0:r.payload.type}}parse(e){const t=e instanceof Object?Object.keys(e):[];if(includes(t,"dateRange")){const t=e.dateRange||0,r=QUICK_CONFIGURATION_VALUES[t];return{start:transformDateComboValue2Value(r.start),end:transformDateComboValue2Value(r.end)}}return{start:isString$3(null==e?void 0:e.start)?getDateValueWithFormat(this.format,null==e?void 0:e.start):parse2Date(null==e?void 0:e.start),end:isString$3(null==e?void 0:e.end)?getDateValueWithFormat(this.format,null==e?void 0:e.end):parse2Date(null==e?void 0:e.end)}}async setFieldValues(e,t){const r=e.get("startDateValueConfig"),n=e.get("endDateValueConfig"),o=e.get("startDate"),i=e.get("endDate"),{dateRange:a}=this;if(a.start=parse2Date(getCalculateSingleValue(o)),a.end=parse2Date(getCalculateSingleValue(i)),this.setExtendValue({[CONTROLLER_CONFIG_KEY.DATE_RANGE]:a}),!isUndefined$3(r)||!isUndefined$3(n)){const o=r instanceof Object?Object.keys(r):[];if(includes(o,"dateRange"))"init"===t.type?await this.setValueWithoutValidate(r):await this.setValue(r,!1);else{const o={start:e.has("startDateValueConfig")?getCalculateSingleValue(r):this.value.start,end:e.has("endDateValueConfig")?getCalculateSingleValue(n):this.value.end};"init"===t.type?await this.setValueWithoutValidate(o):await this.setValue(o,!1)}}}isValueEmpty(e){return isNilOrEmptyString$1(e)||isNilOrEmptyString$1(null==e?void 0:e.start)&&isNilOrEmptyString$1(null==e?void 0:e.end)}get dateRange(){return this.extendValue[CONTROLLER_CONFIG_KEY.DATE_RANGE]||{}}get dateRangeConfig(){var e;return(null==(e=this.props.extend)?void 0:e.dateRange)||{start:{type:DATE_VALUE_TYPE.NONE},end:{type:DATE_VALUE_TYPE.NONE}}}get rangeSelector(){var e;return(null==(e=this.props.extend)?void 0:e.rangeSelector)||[]}get dateIntervalWatermarkConfig(){var e;return(null==(e=this.props.extend)?void 0:e.dateIntervalWatermarkConfig)||{start:"",end:""}}get startDate(){return getDateValueWithFormat(this.format,this.dateRange.start)}get endDate(){return getDateValueWithFormat(this.format,this.dateRange.end)}get dateIntervalValue(){var e;const{valueConfig:t}=this.props;if(t.type===CONTROLLER_VALUE_TYPE.DATE_RANGE){const r=t.payload.startDate;if((null==r?void 0:r.type)===CONTROLLER_VALUE_TYPE.DATE_RANGE)return null==(e=r.payload)?void 0:e.dateRange}}get format(){return getDateFormatByFormatConfig(this.props.formatConfig).value}get dateFormatType(){var e,t;return null==(t=null==(e=this.props.formatConfig)?void 0:e.payload)?void 0:t.type}setDateRange(e){this.setExtend({...this.props.extend,dateRange:e},!0)}setRangeSelector(e){this.setExtend({...this.props.extend,rangeSelector:e},!0)}setDateIntervalWatermarkConfig(e){this.setExtend({...this.props.extend,dateIntervalWatermarkConfig:e},!1)}getErrorResult(e,t){return{success:!1,errorMessage:duchampIntl.get(t,dayjs(e).format(transformDateFormat2DayjsFormat(this.format))),valueChanged:!0,value:void 0}}async validateData(e){const t=getDateValueWithFormat(this.format,null==e?void 0:e.start),r=getDateValueWithFormat(this.format,null==e?void 0:e.end);return!isNil$3(this.startDate)&&!isNil$3(t)&&!isNil$3(r)&&Math.min(t,r)<this.startDate?this.getErrorResult(this.startDate,"Duchamp-Value_Less_Than_Min_Value"):!isNil$3(this.endDate)&&!isNil$3(t)&&!isNil$3(r)&&Math.max(t,r)>this.endDate?this.getErrorResult(this.endDate,"Duchamp-Value_More_Than_Max_Value"):{success:!0}}getValue(){var e;const{value:t}=this;if(isNilOrEmptyString$1(t))return"";if("string"===(null==(e=this.props.parseDateConfig)?void 0:e.type)){const e=getDateFormatByFormatConfig(this.props.formatConfig).value;return{start:formatDate(t.start,transformDateFormat2DayjsFormat(e)),end:formatDate(t.end,transformDateFormat2DayjsFormat(e))}}return{start:isNilOrEmptyString$1(t.start)?"":new Date(t.start),end:isNilOrEmptyString$1(t.end)?"":new Date(t.end)}}get minDate(){return transform2YMDFormat(this.startDate,MIN_DATE)}get maxDate(){return transform2YMDFormat(this.endDate,MAX_DATE)}getText(){return{start:void 0===this.value.start?"":configKit$1.dateTimeFormat.utils.getFormattedDateTime(new Date(this.value.start),this.format),end:void 0===this.value.end?"":configKit$1.dateTimeFormat.utils.getFormattedDateTime(new Date(this.value.end),this.format)}}getValueByJsApi(){return this.getValue()}setMaxAndMinDate({min:e,max:t}){var r;const n=dayjs(e),o=dayjs(t).endOf("day");n.isValid()&&o.isValid()&&!n.isAfter(o)&&(null==(r=this.props.formatConfig)?void 0:r.payload.type)!==DATE_FORMAT_TYPE.HMS&&this.setExtendValue({[CONTROLLER_CONFIG_KEY.DATE_RANGE]:{start:getDateValueWithFormat(this.format,n),end:getDateValueWithFormat(this.format,o)}})}get isFullWidthInControllerPanel(){return!0}}__decorateClass$p([content("dateRange")],DateIntervalModel.prototype,"dateRangeConfig"),__decorateClass$p([content("rangeSelector")],DateIntervalModel.prototype,"rangeSelector"),__decorateClass$p([content("dateIntervalWatermarkConfig")],DateIntervalModel.prototype,"dateIntervalWatermarkConfig"),__decorateClass$p([jsApi()],DateIntervalModel.prototype,"getText"),__decorateClass$p([jsApi("getValue")],DateIntervalModel.prototype,"getValueByJsApi"),__decorateClass$p([jsApi()],DateIntervalModel.prototype,"setMaxAndMinDate");const DATE_RANGE_QUICK_BUTTON_CONTAINER_CLASS="fvs-date-interval-wrapper";class DateRangeWidget{constructor(){__publicField(this,"scale",1),__publicField(this,"dateRange",null),__publicField(this,"container",null),__publicField(this,"quickButton",null),__publicField(this,"lastDataRangeConfig",null),__publicField(this,"dynamicValue",null),__publicField(this,"selectedQuickButton",null)}mount({el:e,state:t}){return this.setScale(t.scale),resolveFineUIPopupDislocation((()=>this.scale)),resolveFineUIDateIntervalI18n(),{element:e}}render(e){var t;const{element:r,config:n,state:o,runtime:i}=e,{rangeSelector:a,formatConfig:s,styleConfig:l,valueConfig:c}=n,{fontAttr:u}=l,{scale:d,width:h,height:p}=o,f=a.length>=1&&s.payload.type===DATE_FORMAT_TYPE.YMD,g=(u.fontSize||12)/12*28;this.unmount(),r.innerHTML="",f?r.classList.add(DATE_RANGE_QUICK_BUTTON_CONTAINER_CLASS):r.classList.remove(DATE_RANGE_QUICK_BUTTON_CONTAINER_CLASS);const m=document.createElement("div");r.appendChild(m),this.setScale(d);const y=getValueByFormat(n,this.dynamicValue,null!=(t=c.quickButton)?t:null);if(f){if(!isNil$4(c.quickButton)){const e=Number(c.quickButton)||0;this.lastDataRangeConfig!==e&&(this.selectedQuickButton=e,this.dynamicValue=QUICK_CONFIGURATION_VALUES[e],this.lastDataRangeConfig=e)}return new Promise((t=>{BI.createWidget({type:"bi.flex_vertical",ref:e=>{this.container=e},element:m,verticalAlign:"middle",value:y,height:"100%",rowSize:["100%",g],items:[this.getQuickButtonsConfig(n,(e=>{var t,r;null==(r=null==(t=i.events)?void 0:t.onFinish)||r.call(t,e)})),this.getDateIntervalConfig(e,{height:g,width:h,value:y,ref:e=>{this.dateRange=e,t()}})]})}))}return new Promise((t=>{BI.createWidget(this.getDateIntervalConfig(e,{element:m,width:h,height:p,value:y,ref:e=>{this.dateRange=e,t()}}))}))}refresh({config:e}){var t,r,n,o,i,a,s,l;const{formatConfig:c,dateRange:u}=e,d=configKit.format.getDateFormat(c).value;null==(r=null==(t=this.quickButton)?void 0:t.setValue)||r.call(t,this.selectedQuickButton),null==(o=null==(n=this.dateRange)?void 0:n.setValue)||o.call(n,getValueByFormat(e,this.dynamicValue,this.selectedQuickButton)),null==(a=null==(i=this.dateRange)?void 0:i.setMinDate)||a.call(i,transform2YMDFormat(configKit.format.getDateValueWithFormat(u.start,d),MIN_DATE)),null==(l=null==(s=this.dateRange)?void 0:s.setMaxDate)||l.call(s,transform2YMDFormat(configKit.format.getDateValueWithFormat(u.end,d),MAX_DATE))}unmount(){var e,t,r;null==(e=this.quickButton)||e.destroy(),this.quickButton=null,null==(t=this.container)||t.destroy(),this.container=null,null==(r=this.dateRange)||r.destroy(),this.dateRange=null}save(){return{dynamicValue:this.dynamicValue,selectedQuickButton:this.selectedQuickButton,lastDataRangeConfig:this.lastDataRangeConfig}}restore(e){this.dynamicValue=e.dynamicValue,this.selectedQuickButton=e.selectedQuickButton,this.lastDataRangeConfig=e.lastDataRangeConfig}setScale(e){this.scale=null!=e?e:1}getDateIntervalConfig(e,t){const{config:r,runtime:n}=e,{dateRange:o,formatConfig:i,startPlaceholder:a,endPlaceholder:s}=r,l=configKit.format.getDateFormat(i).value;return{...t,type:getDateIntervalTypeByFormat(l),supportDynamic:!getFormatType(l).isTimeFormat,supportWorkDay:!1,watermark:{start:null!=a?a:"",end:null!=s?s:""},format:transformFormat(l),maxDate:transform2YMDFormat(configKit.format.getDateValueWithFormat(o.end,l),MAX_DATE),minDate:transform2YMDFormat(configKit.format.getDateValueWithFormat(o.start,l),MIN_DATE),behaviors:{highlight:()=>!1},allowEditor:!0,listeners:[{eventName:"EVENT_CHANGE",action:()=>{var e,t,r,o,i;const a=null==(e=this.dateRange)?void 0:e.getValue();2===(null==(t=null==a?void 0:a.start)?void 0:t.type)||2===(null==(r=null==a?void 0:a.end)?void 0:r.type)?this.dynamicValue=a:this.dynamicValue=null,isNumber$5(this.selectedQuickButton)&&!isEqual$5(QUICK_CONFIGURATION_VALUES[this.selectedQuickButton],a)&&(this.selectedQuickButton=null);const s=transformDateComboValue2Value(null==a?void 0:a.start),l=transformDateComboValue2Value(null==a?void 0:a.end);null==(i=null==(o=n.events)?void 0:o.onFinish)||i.call(o,{start:s,end:l})}}]}}getQuickButtonsConfig(e,t){const{rangeSelector:r}=e,n=arrify(r).filterMap((e=>{const t=DATE_QUICK_CONFIGURATION_LIST.find((t=>t.value===e));return t?{value:t.value,text:t.label}:null})).collect();return{type:"bi.segment",value:this.selectedQuickButton,height:"",css:{marginBottom:8,display:"flex",flexWrap:"wrap"},ref:e=>{this.quickButton=e},items:n,listeners:[{eventName:"EVENT_CHANGE",action:e=>{if(isNumber$5(e)){if(this.selectedQuickButton===e)return this.selectedQuickButton=null,this.dynamicValue=null,void t({start:void 0,end:void 0});this.selectedQuickButton=e;const r=QUICK_CONFIGURATION_VALUES[e];this.dynamicValue=r;const n=transformDateComboValue2Value(r.start),o=transformDateComboValue2Value(r.end);t({start:n,end:o})}}}]}}}const BASE_CLS$2="fvs-controller-datetime-interval",DateIntervalController=({model:e,width:t,height:r=0})=>{const n=useControllerState({width:t,height:r},e),o=useValueConfig(e),i=reactExports.useMemo((()=>({start:e.dateRange.start,end:e.dateRange.end})),[e.dateRange.start,e.dateRange.end]),a=reactExports.useMemo((()=>{var t,r,n,a,s,l,c;return{dateRange:i,rangeSelector:null==(t=e.props.extend)?void 0:t.rangeSelector,valueConfig:o,startPlaceholder:null!=(a=null==(n=null==(r=e.props.extend)?void 0:r.dateIntervalWatermarkConfig)?void 0:n.start)?a:"",endPlaceholder:null!=(c=null==(l=null==(s=e.props.extend)?void 0:s.dateIntervalWatermarkConfig)?void 0:l.end)?c:""}}),[e.props,i,o]),s=useClassWidget({widgetClass:DateRangeWidget,model:e,computed:a,state:n,runtime:{events:{onFinish:t=>{e.onFinish(t)}}}});return jsx("div",{className:classNames$1("fvs-controller",BASE_CLS$2),ref:s})},DATE_CONTROLLER_STATES={width:344,height:28},registerControllerDateInterval=()=>{registerController({meta:{type:"d-controller-date-interval",displayName:duchampIntl.get("Duchamp-Date_Interval"),version:"0.0.1",iconfont:"icon-date-range-components",dragPreviewImage:"/assets/widget/controller_date_interval.svg",groupName:duchampIntl.get("Duchamp-Controller_Date"),borderLine:DEFAULT_CONTROLLER_BORDER_LINE,props:{valueConfig:{type:CONTROLLER_VALUE_TYPE.DATE_RANGE,payload:{startDate:{type:CONTROLLER_VALUE_TYPE.DATE,payload:{date:getDateValueWithFormat(DEFAULT_FORMAT.value,new Date)}},endDate:{type:CONTROLLER_VALUE_TYPE.DATE,payload:{date:getDateValueWithFormat(DEFAULT_FORMAT.value,new Date)}}}},formatConfig:{type:FORMAT_TYPE.DATE,payload:DEFAULT_FORMAT},parseDateConfig:{type:"date"},relatedParams:{startDateValueConfig:"",endDateValueConfig:""},extend:{rangeSelector:[],dateIntervalWatermarkConfig:{}}},states:{...DATE_CONTROLLER_STATES},configuration:{type:"object",properties:{formatConfig:{title:duchampIntl.get("Duchamp-Format"),widget:"formatConfig",props:{dateFormatList:filter$1(DATE_FORMAT_LISTS,(e=>includes([DATE_FORMAT_TYPE.YMD,DATE_FORMAT_TYPE.YMD_HMS,DATE_FORMAT_TYPE.YM],e.type))),supportDateFormatType:[DATE_FORMAT_TYPE.YMD,DATE_FORMAT_TYPE.YMD_HMS]}},...getBaseProperties(),relatedControllers:{title:duchampIntl.get("Duchamp-Controller_Linkage"),widget:"relatedControllers"},rangeSelector:{title:duchampIntl.get("Duchamp-Date_Range_Selector"),widget:"rangeSelector",props:{formatConfig:"{{ formData.formatConfig }}"},hidden:'{{ formData.formatConfig?.payload?.type !== "'.concat(DATE_FORMAT_TYPE.YMD,'" }}')},defaultValue:{title:duchampIntl.get("Duchamp-Default_Value"),widget:"defaultValue",props:{dataType:"dateRange",formatConfig:"{{ formData.formatConfig }}",rangeSelectorList:"{{ formData.rangeSelector }}"}},parseDataValue:{title:duchampIntl.get("Duchamp-Parse_Value_Config"),widget:"parseDataValue"},dateIntervalWatermarkConfig:{title:duchampIntl.get("Duchamp-Watermark"),widget:"dateIntervalWatermarkConfig"},dateRange:{title:duchampIntl.get("Duchamp-Controller_Date_Range"),widget:"dateRange",props:{formatConfig:"{{ formData.formatConfig }}"}},authority:{title:duchampIntl.get("Duchamp-Permission"),widget:"authority"},validation:{title:duchampIntl.get("Duchamp-Calibration"),widget:"validation"},style:{widget:"style",props:{dateFormatType:"{{ formData.formatConfig?.payload?.type }}",curStyleConfig:"{{ formData.style.styleConfig }}"}}}}},view:DateIntervalController,mobileView:DateIntervalController$1,model:DateIntervalModel})},registerDateIntervalStyle=()=>{registerControllerStyle("d-controller-date-interval",{...DEFAULT_CONTROLLER_STYLE_META,configuration:[...DEFAULT_CONTROLLER_FONT_CONFIGURATION,{name:"color",displayName:"",value:DEFAULT_CONTROLLER_STYLE_PROPS.color,type:"colorSelect"},{name:"iconColor",displayName:duchampIntl.get("Duchamp-Template_Icon_Color"),value:DEFAULT_SINGLE_COLOR,type:"colorSelect"}]},DateIntervalController,DateIntervalController$1)},{Option:Option}=Select$1,FIT_SOURCE=[{text:duchampIntl.get("Duchamp-Group_Fit_Auto"),value:BUTTON_GROUP_FIT_MODE.AUTO},{text:duchampIntl.get("Duchamp-Group_Fit_Fixed_Column"),value:BUTTON_GROUP_FIT_MODE.FIXED_COLUMN},{text:duchampIntl.get("Duchamp-Group_Fit_Fixed_Row"),value:BUTTON_GROUP_FIT_MODE.FIXED_ROW}],GroupFitConfig=observer((({value:e={type:BUTTON_GROUP_FIT_MODE.AUTO},onChange:t})=>jsxs(GridItem,{children:[jsx(Select$1,{value:e.type,style:{width:"100%"},onChange:e=>{switch(e){case BUTTON_GROUP_FIT_MODE.AUTO:t({type:e});break;case BUTTON_GROUP_FIT_MODE.FIXED_COLUMN:case BUTTON_GROUP_FIT_MODE.FIXED_ROW:t({type:e,payload:{count:1}})}},children:FIT_SOURCE.map((e=>jsx(Option,{value:e.value,children:e.text},e.value)))}),e&&e.type!==BUTTON_GROUP_FIT_MODE.AUTO&&jsx(LineItem,{className:"fit-config-number-input-wrapper",children:jsx(NumberInput$1,{value:e.payload.count,min:1,precision:0,onChange:r=>{t({type:e.type,payload:{count:r}})}})})]}))),updateControllerSize=(e,t,r)=>{const n=e.current;if(n){const e=n.options;if(e.width===t&&e.height===r)return;e.width=t,e.height=r;const o=n.getValue();n.empty(),n._init(),n.setValue(o)}};function useControllerSize(e,t,r){reactExports.useEffect((()=>{r?r():updateControllerSize(e,t.width,t.height)}),[t.width,t.height])}function useControllerWaterMark(e,t){reactExports.useEffect((()=>{var r,n;null==(n=null==(r=e.current)?void 0:r.setWaterMark)||n.call(r,t.placeholder)}),[t.placeholder])}function useControllerEnable(e,t){reactExports.useEffect((()=>{var r,n;null==(n=null==(r=e.current)?void 0:r.setEnable)||n.call(r,t.enable)}),[t.enable])}function useControllerValueChange(e,t,r){useDeepCompareEffect$1((()=>{null==r||r()}),[t.value])}function useControllerFontSize(e,t){reactExports.useEffect((()=>{var r;const n=e.current;n&&(null==(r=n.css)||r.call(n,"fontSize",t.fontSize),n.element[0].style.setProperty("--font-size","".concat(t.fontSize,"px")))}),[t.fontSize])}function useControllerUpdate(e,t,r,n){useControllerWaterMark(e,t),useControllerSize(e,r,null==n?void 0:n.onResize),useControllerEnable(e,t),useControllerFontSize(e,t),useControllerValueChange(e,t,null==n?void 0:n.valueChange)}const EVENT_CHANGE$1="EVENT_CHANGE";function getButtonWidthByCols(e){return e>0?{width:"".concat((1/e*100).toFixed(0),"%")}:{}}function getSelectedValues(e){return(e||[]).filter((e=>e.isSelected())).map((e=>e.getValue()))}function getAllButtons(e){var t;return(null==(t=e.current)?void 0:t.getAllButtons())||[]}function getValue(e){return getSelectedValues(getAllButtons(e))[0]||""}function createGroup(e){BI.createWidget({type:BI.ButtonGroup.xtype,element:e.element,ref:e.ref,items:e.itemCreator,chooseType:BI.ButtonGroup.CHOOSE_TYPE_MULTI,layouts:[{type:BI.FloatLeftLayout.xtype,width:"100%",height:"100%",tgap:3*e.model.fontSize/12,scrolly:!0}]})}const EVENT_CHANGE="EVENT_CHANGE",_createSelectedAllItem=once$1((()=>({text:duchampIntl.get("Duchamp-Select_All"),value:v4$1()})));function createSelectedAllItem(){return _createSelectedAllItem()}function checkAllSelected(e){var t;const r=e.slice(1),n=r.length>0&&r.every((e=>e.isSelected()));null==(t=e.at(0))||t.setSelected(n)}const CheckGroupController$1=observer((({model:e,width:t,height:r=0})=>{const n=reactExports.useRef(null),o=reactExports.useRef(),{isAdaptive:i,cols:a}=useFitConfig(e.styleConfig.fitConfig,e.count),s=useLatest$3((()=>{e.showSelectAll&&checkAllSelected(getAllButtons(o))})),l=useLatest$3((()=>getSelectedValues(getAllButtons(o).slice(e.showSelectAll?1:0)))),c=()=>{const t=createSelectedAllItem();return[...e.showSelectAll?[t]:[],...transformData2CheckboxGroupData(e.value,e.data)].map((r=>{const{text:n,value:c,selected:u=!1}=r;return{type:"report.main.components.multiselect_item",cls:"checkbox-group-item",css:e.fontStyle,disabled:!e.enable,scale:e.fontSize/12,text:n,title:n,selected:u,value:c,logic:{dynamic:i},width:null,...getButtonWidthByCols(a),listeners:[{eventName:EVENT_CHANGE,action:(r,n)=>{r===t.value?getAllButtons(o).forEach((e=>{e.setSelected(n.isSelected())})):s.current();const i=l.current();e.onEdit(i),e.onFinish(i)}}]}}))};return useMount$1((()=>{(()=>{var t;const r=getTargetElement$2(n);if(!r)return;null==(t=o.current)||t.destroy();const i=document.createElement("div");r.appendChild(i),createGroup({element:i,ref:e=>{o.current=e},itemCreator:c,model:e})})(),s.current()})),useUnmount$2((()=>{var e;null==(e=o.current)||e.destroy(),o.current=void 0})),useControllerUpdate(o,e,{width:t,height:r},{valueChange:()=>{var t;const r=l.current();isEqual$4(e.value,r)||(null==(t=o.current)||t.setValue(e.value),s.current())}}),reactExports.useEffect((()=>{var e;null==(e=o.current)||e.populate(c()),s.current()}),[e.data,e.props.extend,e.fontStyle,e.enable,t,r,e.showSelectAll,a]),jsx("div",{className:"fvs-controller fvs-controller-checkbox-group",ref:n})})),RadioGroupController$1=({model:e,...t})=>e.multiSelect?jsx(CheckGroupController$1,{model:e,...t}):jsx(RadioGroupControllerView$1,{model:e,...t}),RadioGroupControllerView$1=observer((({model:e,width:t,height:r=0})=>{const n=reactExports.useRef(null),o=reactExports.useRef(),{isAdaptive:i,cols:a}=useFitConfig(e.styleConfig.fitConfig,e.data.length),s=useLatest$3((()=>getValue(o))),l=()=>transformData2RadioGroupData(e.value,e.data).map((t=>{const{text:r,value:n,selected:l=!1}=t;return{type:"report.main.parameter_container.controller.radio_group.sinlge_select_radio_item",css:e.fontStyle,disabled:!e.enable,scale:e.fontSize/12,text:r,title:r,adaptive:i,selected:l,value:n,...getButtonWidthByCols(a),listeners:[{eventName:EVENT_CHANGE$1,action:(t,r,n)=>{getAllButtons(o).forEach((e=>{e.setSelected(e===n&&t)}));const i=s.current();e.onEdit(i),e.onFinish(i),e.setOriginalValue(getSelectedValues(getAllButtons(o)).at(0))}}]}}));return useMount$1((()=>{(()=>{var t;const r=getTargetElement$2(n);if(!r)return;null==(t=o.current)||t.destroy();const i=document.createElement("div");r.appendChild(i),createGroup({element:i,ref:e=>{o.current=e},itemCreator:l,model:e})})()})),useUnmount$2((()=>{var e;null==(e=o.current)||e.destroy(),o.current=void 0})),reactExports.useEffect((()=>{var e;null==(e=o.current)||e.populate(l())}),[e.data,e.props.extend,e.fontSize,e.fontStyle,a,e.enable]),useControllerUpdate(o,e,{width:t,height:r},{valueChange:()=>{var t;const r=s.current();isEqual$4(e.value,r)||null==(t=o.current)||t.setValue(e.value)},onResize:()=>{var e;updateControllerSize(o,t,r),null==(e=o.current)||e.populate(l())}}),jsx("div",{className:"fvs-controller fvs-controller-radio-group",ref:n})})),BUTTON_HEIGHT_FONT_RATE=2.3,NODE_STATUS={UNLOAD:"UNLOAD",LOADING:"LOADING",LOADED:"LOADED"};function useGroupButtonStyle(e,t){return{"--icon-size":"".concat(e.fontSize,"px"),"--font-size":"".concat(e.fontSize,"px"),...t?{"--height":"".concat(e.fontSize*BUTTON_HEIGHT_FONT_RATE,"px")}:{}}}function useDefaultTypeGroupButtonStyle(e,t){return{...useGroupButtonStyle(e,t),minHeight:"".concat(e.fontSize*BUTTON_HEIGHT_FONT_RATE,"px"),lineHeight:BUTTON_HEIGHT_FONT_RATE/2}}const CHECKBOX_ALL=uuid$2();function useCheckGroupController(e){const t=reactExports.useMemo((()=>transformData2CheckboxGroupData(e.value,e.data)),[e.value,e.data]),r=reactExports.useMemo((()=>!isEmpty$3(t)&&t.every((e=>e.selected))),[t]);return{checkboxData:t,isSelectedAll:r,onChange:n=>{!r||n.includes(CHECKBOX_ALL)?r||!n.includes(CHECKBOX_ALL)?e.onFinish(n.filter((e=>e!==CHECKBOX_ALL))):e.onFinish(t.map((e=>e.value))):e.onFinish([])},CHECKBOX_ALL:CHECKBOX_ALL}}const CheckGroupController=observer((({model:e,height:t})=>{var r;const n=useDefaultTypeGroupButtonStyle(e,t),{cols:o}=useFitConfig(e.styleConfig.fitConfig,e.count),{checkboxData:i,isSelectedAll:a,onChange:s,CHECKBOX_ALL:l}=useCheckGroupController(e);return jsx("div",{className:"fvs-controller fvs-controller-checkbox-group",children:jsx(Checkbox.Group,{className:"fvs-checkbox-group-default",value:a?[l,...e.value]:e.value,cols:o,onChange:s,disabled:!e.enable,invalid:!!(null==(r=e.warning)?void 0:r.message),children:(e.showSelectAll?[jsx(Checkbox,{value:l,style:n,children:duchampIntl.get("Duchamp-Select_All")},l)]:[]).concat(i.map((e=>jsx(Checkbox,{value:e.value,style:n,children:e.text},e.value))))})})})),RadioGroupController=e=>{const{model:t}=e;return t.multiSelect?jsx(CheckGroupController,{...e}):jsx(RadioGroupControllerView,{...e})},RadioGroupControllerView=observer((({model:e,height:t})=>{var r;const{cols:n}=useFitConfig(e.styleConfig.fitConfig,e.count),o=useDefaultTypeGroupButtonStyle(e,t);return jsx("div",{className:"fvs-controller fvs-controller-radio-group",style:{width:"100%"},children:jsx(Radio.Group,{className:"fvs-radio-group-default",value:e.value,cols:n,onChange:t=>{e.onFinish(t===e.value?"":t)},invalid:!!(null==(r=e.warning)?void 0:r.message),disabled:!e.enable,children:e.data.map((e=>jsx(Radio,{value:e.value,style:o,children:e.text},e.value)))})})}));formItemManager.register("group-fit",GroupFitConfig);const registerRadioGroupDefault=()=>{registerControllerStyle("d-controller-radio-group",{...DEFAULT_CONTROLLER_STYLE_META,configuration:[{name:"fitConfig",displayName:duchampIntl.get("Duchamp-Layout"),type:"group-fit",value:{type:"auto"},platforms:["pc","mobile"]},DEFAULT_CONTROLLER_AUTO_HEIGHT_CONFIG,...DEFAULT_CONTROLLER_STYLE_META.configuration],props:{fitConfig:{type:"auto"}}},RadioGroupController$1,RadioGroupController)};function getIconImageWidgetStyle({resourceCenter:e,fillType:t,asset:r,baseUrl:n}){return convertBackgroundStyle({imageSource:"default"!==(null==r?void 0:r.type)?getImageWidgetSrc(e,r):r.value,backgroundFillType:t,urlParser:e=>createResourceURL(e,n)})}const getIconImageUrl=(e,t)=>"default"===(null==t?void 0:t.type)?t.value:getImageWidgetSrc(e,t),isImageTextButtonGroupProps=e=>e&&void 0!==(null==e?void 0:e.icons);class ButtonGroupModel extends ListControllerModel{constructor(){super(...arguments),__publicField(this,"showDataOnInit",!0)}async onInit(){this.fieldConfigs.has("dataDictionaryConfig")||this.setData([1,2].map((e=>{const t=duchampIntl.get("Duchamp-Option")+e;return{text:t,value:t}})))}get count(){return this.multiSelect&&this.showSelectAll?this.data.length+1:this.data.length}get autoHeight(){var e;return null==(e=this.props.styleConfig.autoHeight)||e}triggerMultiSelectReaction(e){var t;if(e&&includes(["graphic","rowing"],this.style.styleType)){const{styleConfig:e}=getWidgetDefaultStyleProps({widgetManager:widgetManager,widgetType:this.type,styleType:"default",defaultProps:DEFAULT_CONTROLLER_STYLE_PROPS,themeVars:this.duchampServer.themeManager.themeVars});if(!e)return;const{fontFamily:r,fontAttr:n}=this.style.styleConfig,o={styleType:"default",styleConfig:{...e,fontFamily:r,fontAttr:n}};this.setMobileProps({styleType:"",styleConfig:{}}),this.setProps({...o,fontSize:null==(t=null==e?void 0:e.fontAttr)?void 0:t.fontSize})}}collectResourceIDs(){let e=super.collectResourceIDs();const t=(e,t=[])=>[...e,...t].filter((e=>!!e&&(e.type===RESOURCE_TYPE.INTERNAL||e.type===RESOURCE_TYPE.CUSTOM))).map((e=>e.value));if("graphic"===this.style.styleType){const{styleConfig:r}=this.props;if(isImageTextButtonGroupProps(r)){const{icons:n=[],selected:{icons:o=[]}={}}=r;e=e.concat(t(n,o))}}if("graphic"===this.mobile.props.styleType){const{styleConfig:r}=this.mobile.props;if(r){const{icons:r=[],selected:{icons:n=[]}={}}=this.mobile.props.styleConfig;e=e.concat(t(r,n))}}return e}get isFullWidthInControllerPanel(){return!0}}const registerControllerRadioGroup=()=>{registerController({meta:{type:"d-controller-radio-group",displayName:duchampIntl.get("Duchamp-Controller_Radio_Check_Group"),version:"0.0.3",iconfont:"icon-button-components",dragPreviewImage:"/assets/widget/controller_radio_group.svg",groupName:duchampIntl.get("Duchamp-Controller_List"),props:{multiSelect:!1},configuration:{type:"object",properties:{...getBaseProperties(),dataConfig:{title:duchampIntl.get("Duchamp-Option_Source"),widget:"dataConfig"},multiSelect:{title:duchampIntl.get("Duchamp-Option"),widget:"multiSelect"},selectAll:{widget:"selectAll"},parseValueConfig:{widget:"parseValueConfig"},relatedControllers:{title:duchampIntl.get("Duchamp-Controller_Linkage"),widget:"relatedControllers"},defaultValue:{title:duchampIntl.get("Duchamp-Default_Value"),widget:"defaultValue"},authority:{title:duchampIntl.get("Duchamp-Permission"),widget:"authority"},validation:{title:duchampIntl.get("Duchamp-Calibration"),widget:"validation"}}},configure:{eventTargets:{events:[{trigger:WIDGET_EVENT.MOUNTED,text:WIDGET_EVENT_MAP.MOUNTED,actions:[{action:DUCHAMP_ACTION_TYPE.JAVASCRIPT}]},{trigger:WIDGET_EVENT.EDIT_FINISH,text:WIDGET_EVENT_MAP.EDIT_FINISH,actions:[{action:DUCHAMP_ACTION_TYPE.JAVASCRIPT}]}]}}},view:RadioGroupController$1,mobileView:RadioGroupController,model:ButtonGroupModel})};uuid$1();const CapsuleCheckGroupView$1=observer((({model:e})=>{const{fontFamily:t,fontAttr:r,borderRadius:n,fitConfig:o}=e.styleConfig,{isAdaptive:i,cols:a}=useFitConfig(o,e.count),{checkboxData:s,isSelectedAll:l,onChange:c,CHECKBOX_ALL:u}=useCheckGroupController(e);return jsx("div",{className:"fvs-controller fvs-controller-checkbox-group",children:jsx(ButtonGroup,{type:BUTTON_GROUP_TYPE.CAPSULE,layout:i?BUTTON_GROUP_LAYOUT.AUTO:BUTTON_GROUP_LAYOUT.FIXED,disabled:!e.enable,value:l?[u,...e.value]:e.value,onChange:e=>{c(e)},num:a,multiple:!0,style:getButtonGroupCssVariables({type:BUTTON_GROUP_TYPE.CAPSULE,fontSize:r.fontSize,borderRadius:n,extendsCommonStyle:{...r,fontFamily:t},...getStyleConfig(e.styleConfig)}),children:(e.showSelectAll?[jsx(Button,{value:u,children:duchampIntl.get("Duchamp-Select_All")},u)]:[]).concat(s.map(((e,t)=>jsx(Button,{value:e.value,children:e.text},"".concat(e.value,"-").concat(t)))))})})})),CapsuleRadioGroupView$1=({model:e,...t})=>e.multiSelect?jsx(CapsuleCheckGroupView$1,{model:e,...t}):jsx(CapsuleRadioGroupContentView$1,{model:e,...t}),CapsuleRadioGroupContentView$1=observer((({model:e})=>{const{fontAttr:t,borderRadius:r,fitConfig:n}=e.styleConfig,{isAdaptive:o,cols:i}=useFitConfig(n,e.data.length);return jsx("div",{className:"fvs-controller fvs-controller-radio-group",children:jsx(ButtonGroup,{type:BUTTON_GROUP_TYPE.CAPSULE,layout:o?BUTTON_GROUP_LAYOUT.AUTO:BUTTON_GROUP_LAYOUT.FIXED,value:e.value,disabled:!e.enable,onChange:t=>{e.onEdit(t),e.onFinish(t)},num:i,allowDeselect:!0,style:getButtonGroupCssVariables({type:BUTTON_GROUP_TYPE.CAPSULE,fontSize:t.fontSize,borderRadius:r,extendsCommonStyle:t,...getStyleConfig(e.styleConfig)}),children:e.data.map(((e,t)=>jsx(Button,{value:e.value,children:e.text},"".concat(e.value,"-").concat(t))))})})}));function getButtonStyle(e){const{fillColor:t,border:r,selected:n}=e;return{"--background":hexToRgba(t),"--border-width":"".concat(r.borderWidth,"px"),"--border-style":r.borderStyle,"--border-color":hexToRgba(r.borderColor),"--active-text-color":hexToRgba(n.color),"--active-background":hexToRgba(n.fillColor),"--active-border-width":"".concat(n.border.borderWidth,"px"),"--active-border-style":n.border.borderStyle,"--active-border-color":hexToRgba(n.border.borderColor)}}const CapsuleCheckGroupView=observer((({model:e})=>{const{isAdaptive:t,cols:r}=useFitConfig(e.styleConfig.fitConfig,e.count),{checkboxData:n,isSelectedAll:o,onChange:i,CHECKBOX_ALL:a}=useCheckGroupController(e),{borderRadius:s}=e.styleConfig,l={...getButtonStyle(e.styleConfig),"--border-radius":"".concat(s.value).concat(s.type)};return jsx("div",{className:"fvs-controller fvs-controller-checkbox-group",style:{width:"100%"},children:jsx(ButtonGroup$1,{className:"fvs-checkbox-group-capsule",value:o?[a,...e.value]:e.value,disabled:!e.enable,buttonType:"capsule",layout:t?"auto":"fixed",cols:r,multiple:!0,onChange:i,children:(e.showSelectAll?[jsx(ButtonGroup$1.Button,{value:a,style:l,children:duchampIntl.get("Duchamp-Select_All")},a)]:[]).concat(n.map((e=>jsx(ButtonGroup$1.Button,{value:e.value,style:l,children:e.text},e.value))))})})})),CapsuleRadioGroupView=({model:e,...t})=>e.multiSelect?jsx(CapsuleCheckGroupView,{model:e,...t}):jsx(CapsuleRadioGroupContentView,{model:e,...t}),CapsuleRadioGroupContentView=observer((({model:e})=>{const{isAdaptive:t,cols:r}=useFitConfig(e.styleConfig.fitConfig,e.count),{borderRadius:n}=e.styleConfig,o={...getButtonStyle(e.styleConfig),"--border-radius":"".concat(n.value).concat(n.type)};return jsx("div",{className:"fvs-controller fvs-controller-radio-group",style:{width:"100%"},children:jsx(ButtonGroup$1,{className:"fvs-radio-group-capsule",value:e.value,disabled:!e.enable,buttonType:"capsule",layout:t?"auto":"fixed",cols:r,onChange:t=>{e.onFinish(t)},children:e.data.map((e=>jsx(ButtonGroup$1.Button,{value:e.value,style:o,children:e.text},e.value)))})})})),registerRadioGroupCapsule=()=>{registerControllerStyle("d-controller-radio-group",{type:"capsule",displayName:duchampIntl.get("Duchamp-Capsule_Button"),configuration:[{name:"fitConfig",displayName:duchampIntl.get("Duchamp-Layout"),type:"group-fit",value:{type:"auto"},platforms:["pc","mobile"]},DEFAULT_CONTROLLER_AUTO_HEIGHT_CONFIG,...DEFAULT_CONTROLLER_FONT_CONFIGURATION,{type:"toggleLayout",displayName:duchampIntl.get("Duchamp-Button_Style"),options:[{label:duchampIntl.get("Duchamp-Unselected"),value:""},{label:duchampIntl.get("Duchamp-Selected"),value:"selected"}],children:[{type:"verticalLayout",children:[{type:"colorSelect",name:"color",title:duchampIntl.get("Duchamp-Font_Color"),value:"#808080"},{type:"colorSelect",name:"fillColor",title:duchampIntl.get("Duchamp-Fill_Color"),value:"#FFFFFF00"},{type:"line",name:"border",title:duchampIntl.get("Duchamp-Border_Line"),allowNone:!0,value:{borderStyle:"none",borderWidth:1,borderColor:"#ADADAD80"},showPlatform:!0,mobileProperties:["borderWidth"]}]}]},{type:"borderRadius",displayName:duchampIntl.get("Duchamp-Rounded_Corner"),name:"borderRadius",value:{type:"px",value:15},platforms:["pc","mobile"]}],props:{color:"#808080",fitConfig:{type:"auto"},fillColor:"#FFFFFF00",border:{borderStyle:"solid",borderWidth:1,borderColor:"#ADADAD80"},selected:{color:getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.TEXT),fillColor:getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.ONE),border:{borderStyle:"none",borderWidth:1,borderColor:getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.ONE)}},borderRadius:{type:"px",value:14}}},CapsuleRadioGroupView$1,CapsuleRadioGroupView)};function IconImageResourceSelector({value:e,onChange:t}){const r=transformIcon2Image(e),{defaultResource:n,value:o}=r;return jsx(ImageResourceSelector,{value:o,onChange:t,supportEmpty:!0,defaultResource:n})}const transformIcon2Image=e=>e.type===RESOURCE_TYPE.DEFAULT?{defaultResource:{id:"",name:"__from__reuse__/bc896f0b-6709-4a36-b8dc-58c651610569.png"},value:{type:RESOURCE_TYPE.INTERNAL,value:""}}:{defaultResource:{id:"",name:""},value:e},IconListSelector=observer((({value:e,onChange:t,defaultSize:r={width:24,height:24},defaultKeepRatio:n=!1})=>{const[o,i]=reactExports.useState(),a=reactExports.useMemo((()=>isNil$3(o)?null:e[o]),[o,e]),{resourceCenter:s,duchampServer:l}=useStore();return jsx("div",{className:"icon-list-selector",children:jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,children:[jsx(LineItem,{children:jsx("div",{className:"icon-list-container",children:jsxs("div",{className:"icon-list",children:[e.map(((r,n)=>jsxs("div",{className:classNames$1("list-icon",{selected:o===n}),onClick:()=>{i(n)},children:[jsx("div",{className:"icon-image",style:getIconImageWidgetStyle({resourceCenter:s,fillType:BACKGROUND_FILL_TYPE.AUTO,asset:r,baseUrl:l.resourceBaseUrl})}),jsx(Icon$2,{type:"icon-close-nocircle-tabs-1",title:duchampIntl.get("Duchamp-Delete"),onClick:r=>{r.stopPropagation(),null==t||t(e.filter(((e,t)=>t!==n)))}})]},n))),jsx(Icon$2,{type:"icon-add",className:"list-icon",onClick:()=>{i(e.length),null==t||t([...e,{id:uuid$1(),type:"empty",size:r,keepRatio:n}])}})]})})}),!isNil$3(o)&&a&&jsx(IconImageResourceSelector,{value:a,onChange:i=>{e[o]={size:r,keepRatio:n,...e[o],...i},null==t||t([...e])}}),!isNil$3(o)&&a&&"empty"!==(null==a?void 0:a.type)&&jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Icon_Size"),prefix:jsx(PlatformPopoverIcon,{}),children:jsx(SizeInput,{width:a.size.width,height:a.size.height,keepRatio:a.keepRatio,onChange:r=>{e[o]={...e[o],size:r},null==t||t([...e])},onKeepRatioChange:r=>{e[o]={...e[o],keepRatio:r},null==t||t([...e])}})})]})})})),ImageTextRadioGroupView$1=({model:e})=>{const{icons:t,color:r,selected:{icons:n,color:o},fitConfig:i,fontAttr:a}=e.styleConfig,{resourceCenter:s}=e.store,{isAdaptive:l,cols:c}=useFitConfig(i,e.data.length),u=t=>{const r=getIconImageUrl(s,t);return{src:r?createResourceURL(r,e.duchampServer.resourceBaseUrl):void 0,width:null==t?void 0:t.size.width,height:null==t?void 0:t.size.height}};return jsx("div",{className:"fvs-controller fvs-controller-radio-group",children:jsx(ButtonGroup,{type:BUTTON_GROUP_TYPE.IMAGE_TEXT,layout:l?BUTTON_GROUP_LAYOUT.AUTO:BUTTON_GROUP_LAYOUT.FIXED,value:e.value,onChange:t=>{e.onEdit(t),e.onFinish(t)},num:c,allowDeselect:!0,disabled:!e.enable,style:getCommonStyle({fontSize:a.fontSize,extendsCommonStyle:a,color:r,selectedColor:o}),children:e.data.map(((e,r)=>jsx(Button,{value:e.value,image:u(null==t?void 0:t[r]),activeImage:u(null==n?void 0:n[r]),children:e.text},"".concat(e.value,"-").concat(r))))})})},ImageTextRadioGroupView=({model:e})=>{const{isAdaptive:t,cols:r}=useFitConfig(e.styleConfig.fitConfig,e.count),{icons:n,selected:o}=e.styleConfig,{resourceCenter:i}=e.store,a={"--theme-color":o.color};return jsx("div",{className:"fvs-controller fvs-controller-radio-group",style:{width:"100%"},children:jsx(ButtonGroup$1,{value:e.value,disabled:!e.enable,buttonType:"image-text",layout:t?"auto":"fixed",cols:r,onChange:t=>{e.onFinish(t)},style:a,children:e.data.map(((t,r)=>{const a=e.value===t.value?o.icons[r]:n[r],s=getIconImageUrl(i,a);return jsx(ButtonGroup$1.Button,{value:t.value,image:{src:s&&createResourceURL(s,e.duchampServer.resourceBaseUrl),width:null==a?void 0:a.size.width,height:null==a?void 0:a.size.height},children:t.text},t.value)}))})})};formItemManager.register("iconListSelector",IconListSelector);const getDefaultIcon=()=>{var e;return{size:{width:24,height:24},keepRatio:!1,...settingCenter.supportAppService(DUCHAMP_APP_SERVICE.REUSE)&&(null==(e=settingCenter.getResourceConfig())?void 0:e.resourceEnable)?{type:"default",value:"__from__reuse__/bc896f0b-6709-4a36-b8dc-58c651610569.png"}:{type:"custom",value:""}}},splitIconValue=e=>({content:omit$1(e,["size","keepRatio"]),size:pick(e,["id","size","keepRatio"])}),createDefaultIcon=()=>({id:uuid$1(),...getDefaultIcon()}),registerRadioGroupGraphic=()=>{registerControllerStyle("d-controller-radio-group",{type:"graphic",displayName:duchampIntl.get("Duchamp-Image_Text_Button"),configuration:[{name:"fitConfig",displayName:duchampIntl.get("Duchamp-Layout"),type:"group-fit",value:{type:"auto"},platforms:["pc","mobile"]},DEFAULT_CONTROLLER_AUTO_HEIGHT_CONFIG,...DEFAULT_CONTROLLER_FONT_CONFIGURATION,{type:"toggleLayout",displayName:duchampIntl.get("Duchamp-Button_Style"),options:[{label:duchampIntl.get("Duchamp-Unselected"),value:""},{label:duchampIntl.get("Duchamp-Selected"),value:"selected"}],children:[{type:"verticalLayout",children:[{type:"colorSelect",name:"color",title:duchampIntl.get("Duchamp-Font_Color"),value:"#000000A6"},{type:"iconListSelector",name:"icons",title:duchampIntl.get("Duchamp-Button_Icon"),value:[],platforms:["pc","mobile"],mobileValueTransfer:({value:e,lastPCValue:t,lastMobileValue:r=e.map((()=>null)),isMobile:n})=>{var o;const i=(null==(o=r[0])?void 0:o.type)||r.length!==t.length;if(n){if(i||e.length!==t.length||e.some(((e,r)=>!isEqual$4(splitIconValue(e).content,splitIconValue(t[r]).content))))return{mobile:e};if(e.some(((e,n)=>{const o=t[n],i=r[n],a=splitIconValue(e),s=splitIconValue(o);return(!isNil$3(i)||!isEqual$4(a.size,s.size))&&(r[n]=a.size,!0)})))return{mobile:r}}return i?{pc:e}:{pc:e,mobile:e.map((e=>r.find((t=>e.id===(null==t?void 0:t.id)))))}}}]}]}],props:{fitConfig:{type:"auto"},border:{borderStyle:"none",borderWidth:1,borderColor:"#0000001A"},selected:{color:"#FFFFFFFF",icons:[createDefaultIcon(),createDefaultIcon()]},icons:[createDefaultIcon(),createDefaultIcon()]},themeTransfer:e=>({color:e.fontColorNormal,selected:{color:e.colorPrimary}}),mergeProps:(e,t)=>mergeWith$2(e,t,((e,t,r)=>{var n;if("icons"===r&&t)return(null==(n=t[0])?void 0:n.type)||e.length!==t.length?t:t.map(((t,r)=>({...e[r],mv:t})))})),beforeRender:({multiSelect:e})=>({hide:e})},ImageTextRadioGroupView$1,ImageTextRadioGroupView)},BUTTON_SIZE_MULTIPLE=2.3,SolidRadioGroupView$1=({model:e})=>{const{fitConfig:t,fontAttr:r,borderRadius:n}=e.styleConfig,[o,i]=reactExports.useState(!0),a=getButtonGroupCssVariables({type:BUTTON_GROUP_TYPE.BUTTON,alignItem:"center",fontSize:r.fontSize,borderRadius:n,extendsCommonStyle:{...r,"--group-arrow-size":"".concat(max$1([(.8*r.fontSize).toFixed(0),10]),"px")},...getStyleConfig(e.styleConfig)});return jsx("div",{className:"fvs-controller fvs-controller-radio-group",style:{width:"100%"},children:jsx(ButtonGroup,{type:BUTTON_GROUP_TYPE.BUTTON,layout:t,value:e.value,disabled:!e.enable,onChange:t=>{e.onEdit(t),e.onFinish(t)},allowDeselect:!0,leftIcon:jsx(Arrow,{hide:!o,direction:"left",type:"button"}),rightIcon:jsx(Arrow,{hide:!o,direction:"right",type:"button"}),onButtonOverflow:i,horizontalScroll:!0,style:a,children:e.data.map(((e,t)=>jsx(Button,{value:e.value,style:{height:r.fontSize*BUTTON_SIZE_MULTIPLE},children:e.text},"".concat(e.value,"-").concat(t))))})})},SolidRadioGroupView=({model:e})=>{const{borderRadius:t}=e.styleConfig,r="".concat(t.value).concat(t.type);return jsx("div",{className:"fvs-controller fvs-controller-radio-group",style:{width:"100%"},children:jsx(ButtonGroup$1,{className:"fvs-radio-group-solid",value:e.value,disabled:!e.enable,buttonType:"solid-button",layout:e.styleConfig.fitConfig,onChange:t=>{e.onFinish(t)},children:e.data.map(((t,n)=>jsx(ButtonGroup$1.Button,{value:t.value,style:{...getButtonStyle(e.styleConfig),...0===n?{borderTopLeftRadius:r,borderBottomLeftRadius:r}:n===e.data.length-1?{borderTopRightRadius:r,borderBottomRightRadius:r}:{}},children:t.text},t.value)))})})},LAYOUT_TYPE={EQUAL:"equal",INITIAL:"initial"},registerRadioGroupRowingConfig=()=>{registerControllerStyle("d-controller-radio-group",{type:"rowing",displayName:duchampIntl.get("Duchamp-Solid_Button"),configuration:[{name:"fitConfig",displayName:duchampIntl.get("Duchamp-Layout"),type:"select",value:LAYOUT_TYPE.EQUAL,style:{width:"100%"},options:[{label:duchampIntl.get("Duchamp-Natural_Layout"),value:LAYOUT_TYPE.INITIAL},{label:duchampIntl.get("Duchamp-Divided_Layout"),value:LAYOUT_TYPE.EQUAL}],platforms:["pc","mobile"]},DEFAULT_CONTROLLER_AUTO_HEIGHT_CONFIG,...DEFAULT_CONTROLLER_FONT_CONFIGURATION,{type:"toggleLayout",displayName:duchampIntl.get("Duchamp-Button_Style"),options:[{label:duchampIntl.get("Duchamp-Unselected"),value:""},{label:duchampIntl.get("Duchamp-Selected"),value:"selected"}],children:[{type:"verticalLayout",children:[{type:"colorSelect",name:"color",title:duchampIntl.get("Duchamp-Font_Color"),value:"#808080"},{type:"colorSelect",name:"fillColor",title:duchampIntl.get("Duchamp-Fill_Color"),value:"#FFFFFF00"},{type:"line",name:"border",title:duchampIntl.get("Duchamp-Border_Line"),allowNone:!0,value:{borderStyle:"solid",borderWidth:1,borderColor:"#ADADAD80"},showPlatform:!0,mobileProperties:["borderWidth"]}]}]},{type:"borderRadius",displayName:duchampIntl.get("Duchamp-Rounded_Corner"),name:"borderRadius",value:{type:"px",value:2},platforms:["pc","mobile"]}],props:{color:"#808080",fitConfig:LAYOUT_TYPE.EQUAL,fillColor:"#FFFFFF00",border:{borderStyle:"solid",borderWidth:1,borderColor:"#ADADAD80"},selected:{color:getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.TEXT),fillColor:getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.ONE),border:{borderStyle:"solid",borderWidth:1,borderColor:getTemplateThemeDefaultColor(TEMPLATE_THEME_DEFAULT_COLOR_TYPE_KEY.ONE)}},borderRadius:{type:"px",value:2}},beforeRender:({multiSelect:e})=>({hide:e})},SolidRadioGroupView$1,SolidRadioGroupView)};let InputWidget$1=class{constructor(){__publicField(this,"input",null)}mount({el:e}){return{element:e}}render({element:e,config:t,state:r,runtime:n}){var o;const{enable:i,placeholder:a,valueConfig:s,styleConfig:l}=t,{fontAttr:c}=l;null==(o=this.input)||o.destroy(),e.innerHTML="";const u=document.createElement("div");return e.appendChild(u),new Promise((e=>{BI.createWidget({type:BI.TextEditor.xtype,element:u,ref:t=>{this.input=t,e()},css:{fontSize:c.fontSize},height:r.height,width:r.width,value:s,disabled:!i,allowBlank:!0,watermark:a,listeners:[{eventName:BI.TextEditor.EVENT_CHANGE,action:()=>{var e,t;this.input&&(null==(t=null==(e=n.events)?void 0:e.onEdit)||t.call(e,this.input.getValue()))}},{eventName:BI.TextEditor.EVENT_BLUR,action:()=>{var e,t;this.input&&(null==(t=null==(e=n.events)?void 0:e.onFinish)||t.call(e,this.input.getValue()))}}]})}))}refresh({config:e}){var t;null==(t=this.input)||t.setValue(e.valueConfig)}unmount(){var e;null==(e=this.input)||e.destroy(),this.input=null}};const TextController$1=({model:e,width:t,height:r=0})=>{const n=useControllerState({width:t,height:r},e),o=useControllerComputed(e,(e=>({valueConfig:e.value}))),i=useClassWidget({widgetClass:InputWidget$1,model:e,computed:o,state:n,runtime:{events:{onEdit:t=>{e.onEdit(t)},onFinish:t=>{e.onFinish(t)}}}});return jsx("div",{className:classNames$1("fvs-controller fvs-controller-input"),ref:i})};function InputWidget(e){const{config:t,events:r}=e,{placeholder:n,enable:o,styleConfig:i,valueConfig:a,validation:s}=t,l=a?a.toString():"",[c,u]=useUpdateValue$1(l,[l]);return jsx(TextInput,{className:"fvs-controller-text-input",placeholder:n,style:{"--font-size":"".concat(i.fontAttr.fontSize,"px")},disabled:!o,value:c,invalid:!s.result.success,onChange:e=>{var t;null==(t=null==r?void 0:r.onEdit)||t.call(r,e),u(e)},onBlur:e=>{var t;null==(t=null==r?void 0:r.onFinish)||t.call(r,e.target.value)}})}function TextController({model:e,width:t,height:r=0}){var n,o;const i=reactExports.useMemo((()=>({width:t,height:r,scalable:!1,name:e.name})),[t,r,e.name]),a=reactExports.useMemo((()=>{const t=isNil$4(e.warning)?{success:!0}:{success:!1,...e.warning};return{config:e.props.validation,result:t}}),[e.props.validation,e.warning]),s=reactExports.useMemo((()=>({onEdit:t=>{e.onEdit(t)},onFinish:t=>{e.onFinish(t)}})),[e]);return jsx(FVSWidgetProvider,{model:e,children:jsx(InputWidget,{theme:e.theme,state:i,config:{...e.props,valueConfig:e.value,searchAllWhenEmpty:null==(n=e.props.searchAllWhenEmpty)||n,placeholder:null!=(o=e.props.placeholder)?o:"",validation:a},events:s})})}const registerControllerText=()=>{registerController({meta:{type:"d-controller-input",displayName:duchampIntl.get("Duchamp-Controller_Input"),version:"0.0.1",iconfont:"icon-text-box-components",dragPreviewImage:"/assets/widget/controller_input.svg",groupName:duchampIntl.get("Duchamp-Controller_Input_Text"),borderLine:DEFAULT_CONTROLLER_BORDER_LINE,configuration:{type:"object",properties:{...getBaseProperties(),relatedControllers:{title:duchampIntl.get("Duchamp-Controller_Linkage"),widget:"relatedControllers"},defaultValue:{title:duchampIntl.get("Duchamp-Default_Value"),widget:"defaultValue"},watermark:{title:duchampIntl.get("Duchamp-Watermark"),widget:"watermark"},authority:{title:duchampIntl.get("Duchamp-Permission"),widget:"authority"},validation:{title:duchampIntl.get("Duchamp-Calibration"),widget:"validation",props:{validation:["stringFormat","empty"]}}}}},view:TextController$1,mobileView:TextController})},PATH_SPLIT_SYMBOL=",",VALUE_SPLIT_SYMBOL=";",LEVEL_SPLIT_SYMBOL=":";function getTreeValue(e,t){const{multiSelection:r}=t,n=isArray$c(e)&&1===e.length?e[0]:e;if(isArray$c(n)&&r)return n.every(isArray$c)?n.map((e=>last$2(e))):n;return isArray$c(n)&&n.every(isArray$c)?n.map((e=>last$2(e))):n.toString().split(VALUE_SPLIT_SYMBOL).map((e=>last$2(e.split(PATH_SPLIT_SYMBOL)))).slice(r?0:-1)}function getTreeValueFromData(e,t,r){const{needResultType:n,multiSelection:o,returnFullPath:i,selectLeafOnly:a,returnArray:s,startSymbol:l,endSymbol:c,delimiter:u,async:d,params:h}=r,p=Array.isArray(t)?t:[],f=getTreeValue(e,{multiSelection:o}),g=(e,t,r)=>{if(e)for(const n of t){if(n.value===e||n.text===e){const e=[...r||[],n.value].join(PATH_SPLIT_SYMBOL);return{path:e,value:i?e:n.value}}const t=g(e,n.ChildNodes||[],[...r||[],n.value]);if(t)return t}},m=[],y=f.reduce(((e,t)=>{const r=g(t,p);return r&&(m.push(r.path),e.push(r.value)),e}),[]);const v=isEmpty$3(y)?[]:function(){var e;if(o)return a&&!s?"".concat(l).concat(y.join(u)).concat(c):i?y.map((e=>e?e.split(PATH_SPLIT_SYMBOL):[])):null!=y?y:[];if(i){const t=y.map((e=>e?e.split(PATH_SPLIT_SYMBOL):[]));return null!=(e=first(t))?e:[]}return null!=y?y:[]}();return{dataset:treeDataHasResultType(p)&&n&&h&&"fine_outlet_widget"in h&&"nx"===h.fine_outlet_widget&&d?[{resultType:"tree",items:p}]:p,selectedValue:m.join(VALUE_SPLIT_SYMBOL),actualValue:v}}function treeDataHasResultType(e){return e&&isArray$c(e)&&1===e.length&&isObject$e(e[0])&&"resultType"in e[0]}var validator$2={},util$3={};!function(e){const t=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",r="["+t+"]["+(t+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040")+"]*",n=new RegExp("^"+r+"$");e.isExist=function(e){return void 0!==e},e.isEmptyObject=function(e){return 0===Object.keys(e).length},e.merge=function(e,t,r){if(t){const n=Object.keys(t),o=n.length;for(let i=0;i<o;i++)e[n[i]]="strict"===r?[t[n[i]]]:t[n[i]]}},e.getValue=function(t){return e.isExist(t)?t:""},e.isName=function(e){const t=n.exec(e);return!(null==t)},e.getAllMatches=function(e,t){const r=[];let n=t.exec(e);for(;n;){const o=[];o.startIndex=t.lastIndex-n[0].length;const i=n.length;for(let e=0;e<i;e++)o.push(n[e]);r.push(o),n=t.exec(e)}return r},e.nameRegexp=r}(util$3);const util$2=util$3,defaultOptions$2={allowBooleanAttributes:!1,unpairedTags:[]};function isWhiteSpace(e){return" "===e||"\t"===e||"\n"===e||"\r"===e}function readPI(e,t){const r=t;for(;t<e.length;t++)if("?"!=e[t]&&" "!=e[t]);else{const n=e.substr(r,t-r);if(t>5&&"xml"===n)return getErrorObject("InvalidXml","XML declaration allowed only at the start of the document.",getLineNumberForPosition(e,t));if("?"==e[t]&&">"==e[t+1]){t++;break}}return t}function readCommentAndCDATA(e,t){if(e.length>t+5&&"-"===e[t+1]&&"-"===e[t+2]){for(t+=3;t<e.length;t++)if("-"===e[t]&&"-"===e[t+1]&&">"===e[t+2]){t+=2;break}}else if(e.length>t+8&&"D"===e[t+1]&&"O"===e[t+2]&&"C"===e[t+3]&&"T"===e[t+4]&&"Y"===e[t+5]&&"P"===e[t+6]&&"E"===e[t+7]){let r=1;for(t+=8;t<e.length;t++)if("<"===e[t])r++;else if(">"===e[t]&&(r--,0===r))break}else if(e.length>t+9&&"["===e[t+1]&&"C"===e[t+2]&&"D"===e[t+3]&&"A"===e[t+4]&&"T"===e[t+5]&&"A"===e[t+6]&&"["===e[t+7])for(t+=8;t<e.length;t++)if("]"===e[t]&&"]"===e[t+1]&&">"===e[t+2]){t+=2;break}return t}validator$2.validate=function(e,t){t=Object.assign({},defaultOptions$2,t);const r=[];let n=!1,o=!1;"\ufeff"===e[0]&&(e=e.substr(1));for(let i=0;i<e.length;i++)if("<"===e[i]&&"?"===e[i+1]){if(i+=2,i=readPI(e,i),i.err)return i}else{if("<"!==e[i]){if(isWhiteSpace(e[i]))continue;return getErrorObject("InvalidChar","char '"+e[i]+"' is not expected.",getLineNumberForPosition(e,i))}{let a=i;if(i++,"!"===e[i]){i=readCommentAndCDATA(e,i);continue}{let s=!1;"/"===e[i]&&(s=!0,i++);let l="";for(;i<e.length&&">"!==e[i]&&" "!==e[i]&&"\t"!==e[i]&&"\n"!==e[i]&&"\r"!==e[i];i++)l+=e[i];if(l=l.trim(),"/"===l[l.length-1]&&(l=l.substring(0,l.length-1),i--),!validateTagName(l)){let t;return t=0===l.trim().length?"Invalid space after '<'.":"Tag '"+l+"' is an invalid name.",getErrorObject("InvalidTag",t,getLineNumberForPosition(e,i))}const c=readAttributeStr(e,i);if(!1===c)return getErrorObject("InvalidAttr","Attributes for '"+l+"' have open quote.",getLineNumberForPosition(e,i));let u=c.value;if(i=c.index,"/"===u[u.length-1]){const r=i-u.length;u=u.substring(0,u.length-1);const o=validateAttributeString(u,t);if(!0!==o)return getErrorObject(o.err.code,o.err.msg,getLineNumberForPosition(e,r+o.err.line));n=!0}else if(s){if(!c.tagClosed)return getErrorObject("InvalidTag","Closing tag '"+l+"' doesn't have proper closing.",getLineNumberForPosition(e,i));if(u.trim().length>0)return getErrorObject("InvalidTag","Closing tag '"+l+"' can't have attributes or invalid starting.",getLineNumberForPosition(e,a));if(0===r.length)return getErrorObject("InvalidTag","Closing tag '"+l+"' has not been opened.",getLineNumberForPosition(e,a));{const t=r.pop();if(l!==t.tagName){let r=getLineNumberForPosition(e,t.tagStartPos);return getErrorObject("InvalidTag","Expected closing tag '"+t.tagName+"' (opened in line "+r.line+", col "+r.col+") instead of closing tag '"+l+"'.",getLineNumberForPosition(e,a))}0==r.length&&(o=!0)}}else{const s=validateAttributeString(u,t);if(!0!==s)return getErrorObject(s.err.code,s.err.msg,getLineNumberForPosition(e,i-u.length+s.err.line));if(!0===o)return getErrorObject("InvalidXml","Multiple possible root nodes found.",getLineNumberForPosition(e,i));-1!==t.unpairedTags.indexOf(l)||r.push({tagName:l,tagStartPos:a}),n=!0}for(i++;i<e.length;i++)if("<"===e[i]){if("!"===e[i+1]){i++,i=readCommentAndCDATA(e,i);continue}if("?"!==e[i+1])break;if(i=readPI(e,++i),i.err)return i}else if("&"===e[i]){const t=validateAmpersand(e,i);if(-1==t)return getErrorObject("InvalidChar","char '&' is not expected.",getLineNumberForPosition(e,i));i=t}else if(!0===o&&!isWhiteSpace(e[i]))return getErrorObject("InvalidXml","Extra text at the end",getLineNumberForPosition(e,i));"<"===e[i]&&i--}}}return n?1==r.length?getErrorObject("InvalidTag","Unclosed tag '"+r[0].tagName+"'.",getLineNumberForPosition(e,r[0].tagStartPos)):!(r.length>0)||getErrorObject("InvalidXml","Invalid '"+JSON.stringify(r.map((e=>e.tagName)),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):getErrorObject("InvalidXml","Start tag expected.",1)};const doubleQuote='"',singleQuote="'";function readAttributeStr(e,t){let r="",n="",o=!1;for(;t<e.length;t++){if(e[t]===doubleQuote||e[t]===singleQuote)""===n?n=e[t]:n!==e[t]||(n="");else if(">"===e[t]&&""===n){o=!0;break}r+=e[t]}return""===n&&{value:r,index:t,tagClosed:o}}const validAttrStrRegxp=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function validateAttributeString(e,t){const r=util$2.getAllMatches(e,validAttrStrRegxp),n={};for(let o=0;o<r.length;o++){if(0===r[o][1].length)return getErrorObject("InvalidAttr","Attribute '"+r[o][2]+"' has no space in starting.",getPositionFromMatch(r[o]));if(void 0!==r[o][3]&&void 0===r[o][4])return getErrorObject("InvalidAttr","Attribute '"+r[o][2]+"' is without value.",getPositionFromMatch(r[o]));if(void 0===r[o][3]&&!t.allowBooleanAttributes)return getErrorObject("InvalidAttr","boolean attribute '"+r[o][2]+"' is not allowed.",getPositionFromMatch(r[o]));const e=r[o][2];if(!validateAttrName(e))return getErrorObject("InvalidAttr","Attribute '"+e+"' is an invalid name.",getPositionFromMatch(r[o]));if(n.hasOwnProperty(e))return getErrorObject("InvalidAttr","Attribute '"+e+"' is repeated.",getPositionFromMatch(r[o]));n[e]=1}return!0}function validateNumberAmpersand(e,t){let r=/\d/;for("x"===e[t]&&(t++,r=/[\da-fA-F]/);t<e.length;t++){if(";"===e[t])return t;if(!e[t].match(r))break}return-1}function validateAmpersand(e,t){if(";"===e[++t])return-1;if("#"===e[t])return validateNumberAmpersand(e,++t);let r=0;for(;t<e.length;t++,r++)if(!(e[t].match(/\w/)&&r<20)){if(";"===e[t])break;return-1}return t}function getErrorObject(e,t,r){return{err:{code:e,msg:t,line:r.line||r,col:r.col}}}function validateAttrName(e){return util$2.isName(e)}function validateTagName(e){return util$2.isName(e)}function getLineNumberForPosition(e,t){const r=e.substring(0,t).split(/\r?\n/);return{line:r.length,col:r[r.length-1].length+1}}function getPositionFromMatch(e){return e.startIndex+e[1].length}var OptionsBuilder={};const defaultOptions$1={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(e,t,r){return e}},buildOptions$1=function(e){return Object.assign({},defaultOptions$1,e)};OptionsBuilder.buildOptions=buildOptions$1,OptionsBuilder.defaultOptions=defaultOptions$1;class XmlNode{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){"__proto__"===e&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e){"__proto__"===e.tagname&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child})}}var xmlNode$1=XmlNode;const util$1=util$3;function readDocType$1(e,t){const r={};if("O"!==e[t+3]||"C"!==e[t+4]||"T"!==e[t+5]||"Y"!==e[t+6]||"P"!==e[t+7]||"E"!==e[t+8])throw new Error("Invalid Tag instead of DOCTYPE");{t+=9;let n=1,o=!1,i=!1,a="";for(;t<e.length;t++)if("<"!==e[t]||i)if(">"===e[t]){if(i?"-"===e[t-1]&&"-"===e[t-2]&&(i=!1,n--):n--,0===n)break}else"["===e[t]?o=!0:a+=e[t];else{if(o&&isEntity(e,t))t+=7,[entityName,val,t]=readEntityExp(e,t+1),-1===val.indexOf("&")&&(r[validateEntityName(entityName)]={regx:RegExp("&".concat(entityName,";"),"g"),val:val});else if(o&&isElement(e,t))t+=8;else if(o&&isAttlist(e,t))t+=8;else if(o&&isNotation(e,t))t+=9;else{if(!isComment)throw new Error("Invalid DOCTYPE");i=!0}n++,a=""}if(0!==n)throw new Error("Unclosed DOCTYPE")}return{entities:r,i:t}}function readEntityExp(e,t){let r="";for(;t<e.length&&"'"!==e[t]&&'"'!==e[t];t++)r+=e[t];if(r=r.trim(),-1!==r.indexOf(" "))throw new Error("External entites are not supported");const n=e[t++];let o="";for(;t<e.length&&e[t]!==n;t++)o+=e[t];return[r,o,t]}function isComment(e,t){return"!"===e[t+1]&&"-"===e[t+2]&&"-"===e[t+3]}function isEntity(e,t){return"!"===e[t+1]&&"E"===e[t+2]&&"N"===e[t+3]&&"T"===e[t+4]&&"I"===e[t+5]&&"T"===e[t+6]&&"Y"===e[t+7]}function isElement(e,t){return"!"===e[t+1]&&"E"===e[t+2]&&"L"===e[t+3]&&"E"===e[t+4]&&"M"===e[t+5]&&"E"===e[t+6]&&"N"===e[t+7]&&"T"===e[t+8]}function isAttlist(e,t){return"!"===e[t+1]&&"A"===e[t+2]&&"T"===e[t+3]&&"T"===e[t+4]&&"L"===e[t+5]&&"I"===e[t+6]&&"S"===e[t+7]&&"T"===e[t+8]}function isNotation(e,t){return"!"===e[t+1]&&"N"===e[t+2]&&"O"===e[t+3]&&"T"===e[t+4]&&"A"===e[t+5]&&"T"===e[t+6]&&"I"===e[t+7]&&"O"===e[t+8]&&"N"===e[t+9]}function validateEntityName(e){if(util$1.isName(e))return e;throw new Error("Invalid entity name ".concat(e))}var DocTypeReader=readDocType$1;const hexRegex=/^[-+]?0x[a-fA-F0-9]+$/,numRegex=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const consider={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function toNumber$1(e,t={}){if(t=Object.assign({},consider,t),!e||"string"!=typeof e)return e;let r=e.trim();if(void 0!==t.skipLike&&t.skipLike.test(r))return e;if(t.hex&&hexRegex.test(r))return Number.parseInt(r,16);{const n=numRegex.exec(r);if(n){const o=n[1],i=n[2];let a=trimZeros(n[3]);const s=n[4]||n[6];if(!t.leadingZeros&&i.length>0&&o&&"."!==r[2])return e;if(!t.leadingZeros&&i.length>0&&!o&&"."!==r[1])return e;{const n=Number(r),l=""+n;return-1!==l.search(/[eE]/)||s?t.eNotation?n:e:-1!==r.indexOf(".")?"0"===l&&""===a||l===a||o&&l==="-"+a?n:e:i?a===l||o+a===l?n:e:r===l||r===o+l?n:e}}return e}}function trimZeros(e){return e&&-1!==e.indexOf(".")?("."===(e=e.replace(/0+$/,""))?e="0":"."===e[0]?e="0"+e:"."===e[e.length-1]&&(e=e.substr(0,e.length-1)),e):e}var strnum=toNumber$1;function getIgnoreAttributesFn$2(e){return"function"==typeof e?e:Array.isArray(e)?t=>{for(const r of e){if("string"==typeof r&&t===r)return!0;if(r instanceof RegExp&&r.test(t))return!0}}:()=>!1}var ignoreAttributes=getIgnoreAttributesFn$2;const util=util$3,xmlNode=xmlNode$1,readDocType=DocTypeReader,toNumber=strnum,getIgnoreAttributesFn$1=ignoreAttributes;let OrderedObjParser$1=class{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(e,t)=>String.fromCharCode(Number.parseInt(t,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(e,t)=>String.fromCharCode(Number.parseInt(t,16))}},this.addExternalEntities=addExternalEntities,this.parseXml=parseXml,this.parseTextData=parseTextData,this.resolveNameSpace=resolveNameSpace,this.buildAttributesMap=buildAttributesMap,this.isItStopNode=isItStopNode,this.replaceEntitiesValue=replaceEntitiesValue$1,this.readStopNodeData=readStopNodeData,this.saveTextToParentTag=saveTextToParentTag,this.addChild=addChild,this.ignoreAttributesFn=getIgnoreAttributesFn$1(this.options.ignoreAttributes)}};function addExternalEntities(e){const t=Object.keys(e);for(let r=0;r<t.length;r++){const n=t[r];this.lastEntities[n]={regex:new RegExp("&"+n+";","g"),val:e[n]}}}function parseTextData(e,t,r,n,o,i,a){if(void 0!==e&&(this.options.trimValues&&!n&&(e=e.trim()),e.length>0)){a||(e=this.replaceEntitiesValue(e));const n=this.options.tagValueProcessor(t,e,r,o,i);if(null==n)return e;if(typeof n!=typeof e||n!==e)return n;if(this.options.trimValues)return parseValue(e,this.options.parseTagValue,this.options.numberParseOptions);return e.trim()===e?parseValue(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function resolveNameSpace(e){if(this.options.removeNSPrefix){const t=e.split(":"),r="/"===e.charAt(0)?"/":"";if("xmlns"===t[0])return"";2===t.length&&(e=r+t[1])}return e}const attrsRegx=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function buildAttributesMap(e,t,r){if(!0!==this.options.ignoreAttributes&&"string"==typeof e){const r=util.getAllMatches(e,attrsRegx),n=r.length,o={};for(let e=0;e<n;e++){const n=this.resolveNameSpace(r[e][1]);if(this.ignoreAttributesFn(n,t))continue;let i=r[e][4],a=this.options.attributeNamePrefix+n;if(n.length)if(this.options.transformAttributeName&&(a=this.options.transformAttributeName(a)),"__proto__"===a&&(a="#__proto__"),void 0!==i){this.options.trimValues&&(i=i.trim()),i=this.replaceEntitiesValue(i);const e=this.options.attributeValueProcessor(n,i,t);o[a]=null==e?i:typeof e!=typeof i||e!==i?e:parseValue(i,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(o[a]=!0)}if(!Object.keys(o).length)return;if(this.options.attributesGroupName){const e={};return e[this.options.attributesGroupName]=o,e}return o}}const parseXml=function(e){e=e.replace(/\r\n?/g,"\n");const t=new xmlNode("!xml");let r=t,n="",o="";for(let i=0;i<e.length;i++){if("<"===e[i])if("/"===e[i+1]){const t=findClosingIndex(e,">",i,"Closing Tag is not closed.");let a=e.substring(i+2,t).trim();if(this.options.removeNSPrefix){const e=a.indexOf(":");-1!==e&&(a=a.substr(e+1))}this.options.transformTagName&&(a=this.options.transformTagName(a)),r&&(n=this.saveTextToParentTag(n,r,o));const s=o.substring(o.lastIndexOf(".")+1);if(a&&-1!==this.options.unpairedTags.indexOf(a))throw new Error("Unpaired tag can not be used as closing tag: </".concat(a,">"));let l=0;s&&-1!==this.options.unpairedTags.indexOf(s)?(l=o.lastIndexOf(".",o.lastIndexOf(".")-1),this.tagsNodeStack.pop()):l=o.lastIndexOf("."),o=o.substring(0,l),r=this.tagsNodeStack.pop(),n="",i=t}else if("?"===e[i+1]){let t=readTagExp(e,i,!1,"?>");if(!t)throw new Error("Pi Tag is not closed.");if(n=this.saveTextToParentTag(n,r,o),this.options.ignoreDeclaration&&"?xml"===t.tagName||this.options.ignorePiTags);else{const e=new xmlNode(t.tagName);e.add(this.options.textNodeName,""),t.tagName!==t.tagExp&&t.attrExpPresent&&(e[":@"]=this.buildAttributesMap(t.tagExp,o,t.tagName)),this.addChild(r,e,o)}i=t.closeIndex+1}else if("!--"===e.substr(i+1,3)){const t=findClosingIndex(e,"--\x3e",i+4,"Comment is not closed.");if(this.options.commentPropName){const a=e.substring(i+4,t-2);n=this.saveTextToParentTag(n,r,o),r.add(this.options.commentPropName,[{[this.options.textNodeName]:a}])}i=t}else if("!D"===e.substr(i+1,2)){const t=readDocType(e,i);this.docTypeEntities=t.entities,i=t.i}else if("!["===e.substr(i+1,2)){const t=findClosingIndex(e,"]]>",i,"CDATA is not closed.")-2,a=e.substring(i+9,t);n=this.saveTextToParentTag(n,r,o);let s=this.parseTextData(a,r.tagname,o,!0,!1,!0,!0);null==s&&(s=""),this.options.cdataPropName?r.add(this.options.cdataPropName,[{[this.options.textNodeName]:a}]):r.add(this.options.textNodeName,s),i=t+2}else{let a=readTagExp(e,i,this.options.removeNSPrefix),s=a.tagName;const l=a.rawTagName;let c=a.tagExp,u=a.attrExpPresent,d=a.closeIndex;this.options.transformTagName&&(s=this.options.transformTagName(s)),r&&n&&"!xml"!==r.tagname&&(n=this.saveTextToParentTag(n,r,o,!1));const h=r;if(h&&-1!==this.options.unpairedTags.indexOf(h.tagname)&&(r=this.tagsNodeStack.pop(),o=o.substring(0,o.lastIndexOf("."))),s!==t.tagname&&(o+=o?"."+s:s),this.isItStopNode(this.options.stopNodes,o,s)){let t="";if(c.length>0&&c.lastIndexOf("/")===c.length-1)"/"===s[s.length-1]?(s=s.substr(0,s.length-1),o=o.substr(0,o.length-1),c=s):c=c.substr(0,c.length-1),i=a.closeIndex;else if(-1!==this.options.unpairedTags.indexOf(s))i=a.closeIndex;else{const r=this.readStopNodeData(e,l,d+1);if(!r)throw new Error("Unexpected end of ".concat(l));i=r.i,t=r.tagContent}const n=new xmlNode(s);s!==c&&u&&(n[":@"]=this.buildAttributesMap(c,o,s)),t&&(t=this.parseTextData(t,s,o,!0,u,!0,!0)),o=o.substr(0,o.lastIndexOf(".")),n.add(this.options.textNodeName,t),this.addChild(r,n,o)}else{if(c.length>0&&c.lastIndexOf("/")===c.length-1){"/"===s[s.length-1]?(s=s.substr(0,s.length-1),o=o.substr(0,o.length-1),c=s):c=c.substr(0,c.length-1),this.options.transformTagName&&(s=this.options.transformTagName(s));const e=new xmlNode(s);s!==c&&u&&(e[":@"]=this.buildAttributesMap(c,o,s)),this.addChild(r,e,o),o=o.substr(0,o.lastIndexOf("."))}else{const e=new xmlNode(s);this.tagsNodeStack.push(r),s!==c&&u&&(e[":@"]=this.buildAttributesMap(c,o,s)),this.addChild(r,e,o),r=e}n="",i=d}}else n+=e[i]}return t.child};function addChild(e,t,r){const n=this.options.updateTag(t.tagname,r,t[":@"]);!1===n||("string"==typeof n?(t.tagname=n,e.addChild(t)):e.addChild(t))}const replaceEntitiesValue$1=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){const r=this.docTypeEntities[t];e=e.replace(r.regx,r.val)}for(let t in this.lastEntities){const r=this.lastEntities[t];e=e.replace(r.regex,r.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){const r=this.htmlEntities[t];e=e.replace(r.regex,r.val)}e=e.replace(this.ampEntity.regex,this.ampEntity.val)}return e};function saveTextToParentTag(e,t,r,n){return e&&(void 0===n&&(n=0===Object.keys(t.child).length),void 0!==(e=this.parseTextData(e,t.tagname,r,!1,!!t[":@"]&&0!==Object.keys(t[":@"]).length,n))&&""!==e&&t.add(this.options.textNodeName,e),e=""),e}function isItStopNode(e,t,r){const n="*."+r;for(const o in e){const r=e[o];if(n===r||t===r)return!0}return!1}function tagExpWithClosingIndex(e,t,r=">"){let n,o="";for(let i=t;i<e.length;i++){let t=e[i];if(n)t===n&&(n="");else if('"'===t||"'"===t)n=t;else if(t===r[0]){if(!r[1])return{data:o,index:i};if(e[i+1]===r[1])return{data:o,index:i}}else"\t"===t&&(t=" ");o+=t}}function findClosingIndex(e,t,r,n){const o=e.indexOf(t,r);if(-1===o)throw new Error(n);return o+t.length-1}function readTagExp(e,t,r,n=">"){const o=tagExpWithClosingIndex(e,t+1,n);if(!o)return;let i=o.data;const a=o.index,s=i.search(/\s/);let l=i,c=!0;-1!==s&&(l=i.substring(0,s),i=i.substring(s+1).trimStart());const u=l;if(r){const e=l.indexOf(":");-1!==e&&(l=l.substr(e+1),c=l!==o.data.substr(e+1))}return{tagName:l,tagExp:i,closeIndex:a,attrExpPresent:c,rawTagName:u}}function readStopNodeData(e,t,r){const n=r;let o=1;for(;r<e.length;r++)if("<"===e[r])if("/"===e[r+1]){const i=findClosingIndex(e,">",r,"".concat(t," is not closed"));if(e.substring(r+2,i).trim()===t&&(o--,0===o))return{tagContent:e.substring(n,r),i:i};r=i}else if("?"===e[r+1]){r=findClosingIndex(e,"?>",r+1,"StopNode is not closed.")}else if("!--"===e.substr(r+1,3)){r=findClosingIndex(e,"--\x3e",r+3,"StopNode is not closed.")}else if("!["===e.substr(r+1,2)){r=findClosingIndex(e,"]]>",r,"StopNode is not closed.")-2}else{const n=readTagExp(e,r,">");if(n){(n&&n.tagName)===t&&"/"!==n.tagExp[n.tagExp.length-1]&&o++,r=n.closeIndex}}}function parseValue(e,t,r){if(t&&"string"==typeof e){const t=e.trim();return"true"===t||"false"!==t&&toNumber(e,r)}return util.isExist(e)?e:""}var OrderedObjParser_1=OrderedObjParser$1,node2json={};function prettify$1(e,t){return compress(e,t)}function compress(e,t,r){let n;const o={};for(let i=0;i<e.length;i++){const a=e[i],s=propName$1(a);let l="";if(l=void 0===r?s:r+"."+s,s===t.textNodeName)void 0===n?n=a[s]:n+=""+a[s];else{if(void 0===s)continue;if(a[s]){let e=compress(a[s],t,l);const r=isLeafTag(e,t);a[":@"]?assignAttributes(e,a[":@"],l,t):1!==Object.keys(e).length||void 0===e[t.textNodeName]||t.alwaysCreateTextNode?0===Object.keys(e).length&&(t.alwaysCreateTextNode?e[t.textNodeName]="":e=""):e=e[t.textNodeName],void 0!==o[s]&&o.hasOwnProperty(s)?(Array.isArray(o[s])||(o[s]=[o[s]]),o[s].push(e)):t.isArray(s,l,r)?o[s]=[e]:o[s]=e}}}return"string"==typeof n?n.length>0&&(o[t.textNodeName]=n):void 0!==n&&(o[t.textNodeName]=n),o}function propName$1(e){const t=Object.keys(e);for(let r=0;r<t.length;r++){const e=t[r];if(":@"!==e)return e}}function assignAttributes(e,t,r,n){if(t){const o=Object.keys(t),i=o.length;for(let a=0;a<i;a++){const i=o[a];n.isArray(i,r+"."+i,!0,!0)?e[i]=[t[i]]:e[i]=t[i]}}}function isLeafTag(e,t){const{textNodeName:r}=t,n=Object.keys(e).length;return 0===n||!(1!==n||!e[r]&&"boolean"!=typeof e[r]&&0!==e[r])}node2json.prettify=prettify$1;const{buildOptions:buildOptions}=OptionsBuilder,OrderedObjParser=OrderedObjParser_1,{prettify:prettify}=node2json,validator$1=validator$2;let XMLParser$1=class{constructor(e){this.externalEntities={},this.options=buildOptions(e)}parse(e,t){if("string"==typeof e);else{if(!e.toString)throw new Error("XML data is accepted in String or Bytes[] form.");e=e.toString()}if(t){!0===t&&(t={});const r=validator$1.validate(e,t);if(!0!==r)throw Error("".concat(r.err.msg,":").concat(r.err.line,":").concat(r.err.col))}const r=new OrderedObjParser(this.options);r.addExternalEntities(this.externalEntities);const n=r.parseXml(e);return this.options.preserveOrder||void 0===n?n:prettify(n,this.options)}addEntity(e,t){if(-1!==t.indexOf("&"))throw new Error("Entity value can't have '&'");if(-1!==e.indexOf("&")||-1!==e.indexOf(";"))throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if("&"===t)throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=t}};var XMLParser_1=XMLParser$1;const EOL="\n";function toXml(e,t){let r="";return t.format&&t.indentBy.length>0&&(r=EOL),arrToStr(e,t,"",r)}function arrToStr(e,t,r,n){let o="",i=!1;for(let a=0;a<e.length;a++){const s=e[a],l=propName(s);if(void 0===l)continue;let c="";if(c=0===r.length?l:"".concat(r,".").concat(l),l===t.textNodeName){let e=s[l];isStopNode(c,t)||(e=t.tagValueProcessor(l,e),e=replaceEntitiesValue(e,t)),i&&(o+=n),o+=e,i=!1;continue}if(l===t.cdataPropName){i&&(o+=n),o+="<![CDATA[".concat(s[l][0][t.textNodeName],"]]>"),i=!1;continue}if(l===t.commentPropName){o+=n+"\x3c!--".concat(s[l][0][t.textNodeName],"--\x3e"),i=!0;continue}if("?"===l[0]){const e=attr_to_str(s[":@"],t),r="?xml"===l?"":n;let a=s[l][0][t.textNodeName];a=0!==a.length?" "+a:"",o+=r+"<".concat(l).concat(a).concat(e,"?>"),i=!0;continue}let u=n;""!==u&&(u+=t.indentBy);const d=attr_to_str(s[":@"],t),h=n+"<".concat(l).concat(d),p=arrToStr(s[l],t,c,u);-1!==t.unpairedTags.indexOf(l)?t.suppressUnpairedNode?o+=h+">":o+=h+"/>":p&&0!==p.length||!t.suppressEmptyNode?p&&p.endsWith(">")?o+=h+">".concat(p).concat(n,"</").concat(l,">"):(o+=h+">",p&&""!==n&&(p.includes("/>")||p.includes("</"))?o+=n+t.indentBy+p+n:o+=p,o+="</".concat(l,">")):o+=h+"/>",i=!0}return o}function propName(e){const t=Object.keys(e);for(let r=0;r<t.length;r++){const n=t[r];if(e.hasOwnProperty(n)&&":@"!==n)return n}}function attr_to_str(e,t){let r="";if(e&&!t.ignoreAttributes)for(let n in e){if(!e.hasOwnProperty(n))continue;let o=t.attributeValueProcessor(n,e[n]);o=replaceEntitiesValue(o,t),!0===o&&t.suppressBooleanAttributes?r+=" ".concat(n.substr(t.attributeNamePrefix.length)):r+=" ".concat(n.substr(t.attributeNamePrefix.length),'="').concat(o,'"')}return r}function isStopNode(e,t){let r=(e=e.substr(0,e.length-t.textNodeName.length-1)).substr(e.lastIndexOf(".")+1);for(let n in t.stopNodes)if(t.stopNodes[n]===e||t.stopNodes[n]==="*."+r)return!0;return!1}function replaceEntitiesValue(e,t){if(e&&e.length>0&&t.processEntities)for(let r=0;r<t.entities.length;r++){const n=t.entities[r];e=e.replace(n.regex,n.val)}return e}var orderedJs2Xml=toXml;const buildFromOrderedJs=orderedJs2Xml,getIgnoreAttributesFn=ignoreAttributes,defaultOptions={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function Builder(e){this.options=Object.assign({},defaultOptions,e),!0===this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.ignoreAttributesFn=getIgnoreAttributesFn(this.options.ignoreAttributes),this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=isAttribute),this.processTextOrObjNode=processTextOrObjNode,this.options.format?(this.indentate=indentate,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}function processTextOrObjNode(e,t,r,n){const o=this.j2x(e,r+1,n.concat(t));return void 0!==e[this.options.textNodeName]&&1===Object.keys(e).length?this.buildTextValNode(e[this.options.textNodeName],t,o.attrStr,r):this.buildObjectNode(o.val,t,o.attrStr,r)}function indentate(e){return this.options.indentBy.repeat(e)}function isAttribute(e){return!(!e.startsWith(this.options.attributeNamePrefix)||e===this.options.textNodeName)&&e.substr(this.attrPrefixLen)}Builder.prototype.build=function(e){return this.options.preserveOrder?buildFromOrderedJs(e,this.options):(Array.isArray(e)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(e={[this.options.arrayNodeName]:e}),this.j2x(e,0,[]).val)},Builder.prototype.j2x=function(e,t,r){let n="",o="";const i=r.join(".");for(let a in e)if(Object.prototype.hasOwnProperty.call(e,a))if(void 0===e[a])this.isAttribute(a)&&(o+="");else if(null===e[a])this.isAttribute(a)?o+="":"?"===a[0]?o+=this.indentate(t)+"<"+a+"?"+this.tagEndChar:o+=this.indentate(t)+"<"+a+"/"+this.tagEndChar;else if(e[a]instanceof Date)o+=this.buildTextValNode(e[a],a,"",t);else if("object"!=typeof e[a]){const r=this.isAttribute(a);if(r&&!this.ignoreAttributesFn(r,i))n+=this.buildAttrPairStr(r,""+e[a]);else if(!r)if(a===this.options.textNodeName){let t=this.options.tagValueProcessor(a,""+e[a]);o+=this.replaceEntitiesValue(t)}else o+=this.buildTextValNode(e[a],a,"",t)}else if(Array.isArray(e[a])){const n=e[a].length;let i="",s="";for(let l=0;l<n;l++){const n=e[a][l];if(void 0===n);else if(null===n)"?"===a[0]?o+=this.indentate(t)+"<"+a+"?"+this.tagEndChar:o+=this.indentate(t)+"<"+a+"/"+this.tagEndChar;else if("object"==typeof n)if(this.options.oneListGroup){const e=this.j2x(n,t+1,r.concat(a));i+=e.val,this.options.attributesGroupName&&n.hasOwnProperty(this.options.attributesGroupName)&&(s+=e.attrStr)}else i+=this.processTextOrObjNode(n,a,t,r);else if(this.options.oneListGroup){let e=this.options.tagValueProcessor(a,n);e=this.replaceEntitiesValue(e),i+=e}else i+=this.buildTextValNode(n,a,"",t)}this.options.oneListGroup&&(i=this.buildObjectNode(i,a,s,t)),o+=i}else if(this.options.attributesGroupName&&a===this.options.attributesGroupName){const t=Object.keys(e[a]),r=t.length;for(let o=0;o<r;o++)n+=this.buildAttrPairStr(t[o],""+e[a][t[o]])}else o+=this.processTextOrObjNode(e[a],a,t,r);return{attrStr:n,val:o}},Builder.prototype.buildAttrPairStr=function(e,t){return t=this.options.attributeValueProcessor(e,""+t),t=this.replaceEntitiesValue(t),this.options.suppressBooleanAttributes&&"true"===t?" "+e:" "+e+'="'+t+'"'},Builder.prototype.buildObjectNode=function(e,t,r,n){if(""===e)return"?"===t[0]?this.indentate(n)+"<"+t+r+"?"+this.tagEndChar:this.indentate(n)+"<"+t+r+this.closeTag(t)+this.tagEndChar;{let o="</"+t+this.tagEndChar,i="";return"?"===t[0]&&(i="?",o=""),!r&&""!==r||-1!==e.indexOf("<")?!1!==this.options.commentPropName&&t===this.options.commentPropName&&0===i.length?this.indentate(n)+"\x3c!--".concat(e,"--\x3e")+this.newLine:this.indentate(n)+"<"+t+r+i+this.tagEndChar+e+this.indentate(n)+o:this.indentate(n)+"<"+t+r+i+">"+e+o}},Builder.prototype.closeTag=function(e){let t="";return-1!==this.options.unpairedTags.indexOf(e)?this.options.suppressUnpairedNode||(t="/"):t=this.options.suppressEmptyNode?"/":"></".concat(e),t},Builder.prototype.buildTextValNode=function(e,t,r,n){if(!1!==this.options.cdataPropName&&t===this.options.cdataPropName)return this.indentate(n)+"<![CDATA[".concat(e,"]]>")+this.newLine;if(!1!==this.options.commentPropName&&t===this.options.commentPropName)return this.indentate(n)+"\x3c!--".concat(e,"--\x3e")+this.newLine;if("?"===t[0])return this.indentate(n)+"<"+t+r+"?"+this.tagEndChar;{let o=this.options.tagValueProcessor(t,e);return o=this.replaceEntitiesValue(o),""===o?this.indentate(n)+"<"+t+r+this.closeTag(t)+this.tagEndChar:this.indentate(n)+"<"+t+r+">"+o+"</"+t+this.tagEndChar}},Builder.prototype.replaceEntitiesValue=function(e){if(e&&e.length>0&&this.options.processEntities)for(let t=0;t<this.options.entities.length;t++){const r=this.options.entities[t];e=e.replace(r.regex,r.val)}return e};var json2xml=Builder;const validator=validator$2,XMLParser=XMLParser_1,XMLBuilder=json2xml;var fxp={XMLParser:XMLParser,XMLValidator:validator,XMLBuilder:XMLBuilder};function parseTreeDataString(e){try{const t=new fxp.XMLParser({attributeNamePrefix:"",ignoreAttributes:!1,ignoreDeclaration:!0}).parse(e),{isAutoBuild:r,isLayerBuild:n,TreeNodeAttr:o=[]}=t.Widget;return{isLayerBuild:"true"===n.isLayerBuild,isAutoBuild:"true"===r.autoBuild,deps:Array.isArray(o)?o.length:1}}catch(e3){return{isLayerBuild:!0,isAutoBuild:!1,deps:0}}}function getTreeDataLabel(e){const{isLayerBuild:t,isAutoBuild:r,deps:n}=e;return e?t?duchampIntl.get("Duchamp-Data_Dictionary_Extremely_Fast_Layered_Construction"):r?duchampIntl.get("Duchamp-Data_Dictionary_Auto_Build"):duchampIntl.get("Duchamp-Depth_In_Total",n):""}var __defProp$p=Object.defineProperty,__getOwnPropDesc$o=Object.getOwnPropertyDescriptor,__decorateClass$o=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$o(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$p(t,r,i),i};class TreeBaseModel extends ControllerModel{constructor(){super(...arguments),__publicField(this,"controlAttr"),__publicField(this,"treeData"),__publicField(this,"params"),__publicField(this,"tempValue")}setControlAttr(e){this.controlAttr=e}setTreeData(e){this.treeData=e}parse(e){return e}get treeDataConfig(){return this.dataDictionary}setTreeDataConfig(e){this.setExtend({dataDictionary:e},!0)}getDataConfigText(){return getTreeDataLabel(this.dataDictionaryConfig)}getControllerConfigOptions(){return{treeDataConfig:{text:this.getDataConfigText()}}}get dataDictionary(){var e;return(null==(e=this.props.extend)?void 0:e.dataDictionary)||""}updateRelationalValue(e){var t;const{selectedValue:r}=getTreeValueFromData(isArray$c(e)?e.join(VALUE_SPLIT_SYMBOL):e,this.treeData,{...this.customOptions,...this.calculateTreeOptions(),needResultType:!1,params:this.params});this.setCalculation({value:r}),this.setControlAttr({data:(null==(t=this.controlAttr)?void 0:t.data)||[],value:r})}async setFieldValues(e,t){var r,n;const o=null!=(r=this.getCalculatedValue(e.get("valueConfig")))?r:this.tempValue,i=null!=(n=e.get("dataDictionaryConfig"))?n:this.treeData;if(o&&!i)return this.tempValue=o,this.setCalculation({value:o}),this.setControlAttr({data:[],value:o}),void this.fireEvent(CONTROLLER_REFRESHED);const a=this.value,{actualValue:s,selectedValue:l,dataset:c}=getTreeValueFromData(null!=o?o:isArray$c(a)?a.join(VALUE_SPLIT_SYMBOL):a,i,{...this.customOptions,...this.calculateTreeOptions(),needResultType:"init"===t.type,params:this.params});"init"===t.type?await this.setValueWithoutValidate(s):await this.setValue(s,!1),this.setControlAttr({data:c,value:l}),this.setTreeData(c),this.fireEvent(CONTROLLER_REFRESHED),this.fireEvent(WIDGET_PROPS_CHANGE_EVENT)}getCalculatedValue(e){return this.customOptions.multiSelection&&this.props.valueConfig.type!==CONTROLLER_VALUE_TYPE.FIELD?e:e&&isArray$c(e)&&1===e.length&&isArray$c(e[0])?e[0]:e}get dataDictionaryConfig(){return parseTreeDataString(this.dataDictionary)}get customOptions(){var e;return toJS(null==(e=this.props.extend)?void 0:e.customOptions)||{async:!0,multiSelection:!1,returnFullPath:!1,selectLeafOnly:!0}}calculateTreeOptions(e=!1){var t,r,n;const{validation:o,parseValueConfig:i}=this.props,{returnFullPath:a,multiSelection:s,async:l,selectLeafOnly:c}=this.customOptions,u=!i||"array"===(null==i?void 0:i.type);return{value:(null==(t=this.controlAttr)?void 0:t.value)||this.value,controlAttr:this.controlAttr,returnFullPath:a,mutiSelection:s,isLayerBuild:this.dataDictionaryConfig.isLayerBuild,async:l,selectLeafOnly:c,...u?{returnArray:!0}:{returnArray:!1,startSymbol:null==i?void 0:i.payload.startSymbol,endSymbol:null==i?void 0:i.payload.endSymbol,delimiter:null==i?void 0:i.payload.splitor},oldTreeControlAttrFetcher:(t,r)=>this.getTreeData(r,e),newTreeControlAttrFetcher:(t,r)=>this.getTreeData({...r,fine_outlet_widget:"nx"},e),newTreeStructureFetcher:(t,r)=>this.getTreeData({...r,fine_outlet_widget:"nx",completion:!0},e),customData:null==(r=o.customValue)?void 0:r.open,allowBlank:null==(n=o.allowEmpty)?void 0:n.open,needCheckCustomData:!1}}async calculate(e,t){const r=this.fieldConfigs.get(e);if(!r)return ok([]);r.payload={...r.payload,...t};const n="".concat(this.id,".").concat(e),o=(await this.duchampServer.calculateCenter.calculateFieldConfigs(new Map([[n,r]]),!this.isPreview,!1)).get(n);return isObject$f(o)&&"type"in o&&"error"===o.type&&"info"in o?err(new Error(String(o.info))):ok(o)}async getTreeData(e,t){var r,n;if(this.params=e,!this.isPreview&&!t)return Promise.resolve([]);const o=this.dataFieldName,i={filter:{content:e.filter},async:this.customOptions.async,outsidePayload:{...omitBy$1(this.params,isNil$3),async:this.customOptions.async}},a=await this.calculate(o,i);if(!a.success)return Message.error(a.error.message),[];return Array.isArray(a.value)?a.value:null!=(n=null==(r=this.controlAttr)?void 0:r.data)?n:[]}get fieldConfigs(){const e=new Map;if(this.isUnset)e.set("valueConfig",{type:"static",value:""});else{const t=getValueFieldConfig(this.props.valueConfig,this.customOptions.multiSelection);e.set("valueConfig",{...t,payload:{widgetId:this.id}})}const t=this.dataDictionary;return t&&e.set("dataDictionaryConfig",{type:"dataTree",config:t,payload:{async:this.isUnset&&this.customOptions.async&&!(()=>{const e=this.relatedParams[PARAMETER_FIELD_NAME],{parameterCenter:t}=this.duchampServer.calculateCenter;return e&&(t.has(e)||this.store.parameterConfigs.some((r=>r.some((r=>t.sameName(r.name,e))))))})(),multiSelection:this.customOptions.multiSelection,returnFullPath:this.customOptions.returnFullPath,selectLeafOnly:this.customOptions.selectLeafOnly}}),e}setControllerValue(e,t=!0){return super.setControllerValue(e,t)}setCustomOptions(e){this.store.undoManager.withGroup((()=>{this.setExtend({customOptions:{...this.customOptions,...e}},!0),this.setCalculationProps("parseValueConfig",{type:"array"})}))}replaceData(e){super.replaceData(e);const{computes:t}=e.replacement;null==t||t.forEach((e=>{const{extend:t}=this.props,r=null==t?void 0:t.dataDictionary;if(!isNil$3(t)&&!isNil$3(r)&&2===e.length){const n=e[0],o=e[1];if("dataTree"===n.type&&"dataTree"===o.type&&isString$3(n.config)&&isString$3(o.config)&&n.config===r){const e={...t,dataDictionary:o.config};this.setProps({extend:e})}}}))}getValue(){return toJS(this.value)}}__decorateClass$o([observable.ref],TreeBaseModel.prototype,"controlAttr",2),__decorateClass$o([action$1],TreeBaseModel.prototype,"setControlAttr",1),__decorateClass$o([content()],TreeBaseModel.prototype,"treeDataConfig",1),__decorateClass$o([content()],TreeBaseModel.prototype,"customOptions",1),__decorateClass$o([jsApi()],TreeBaseModel.prototype,"getValue",1);var __defProp$o=Object.defineProperty,__getOwnPropDesc$n=Object.getOwnPropertyDescriptor,__decorateClass$n=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$n(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$o(t,r,i),i};let TreeControllerModel$1=class extends TreeBaseModel{constructor(){super(...arguments),__publicField(this,"element",null)}async validateData(){if(!this.element)return{success:!0};return this.element.validate()?{success:!0}:{success:!1,valueChanged:!0,errorMessage:duchampIntl.get("Duchamp-Custom_Values_Are_Not_Allowed"),value:""}}setControllerValue(e,t=!0){this.setControlAttr(void 0);const r=super.setControllerValue(e,t);if(e&&this.element){const{options:e}=this.element;this.element.options={...e,returnFullPath:!0,returnArray:!0};const t=this.element.getValue();Array.isArray(t)&&this.setControlAttr({value:e.mutiSelection?t.map((e=>e.join(PATH_SPLIT_SYMBOL))).join(VALUE_SPLIT_SYMBOL):t.join(PATH_SPLIT_SYMBOL),data:this.element.nodes}),this.element.options=e}return r}setElement(e){this.element=e}getText(){var e;return(null==(e=this.element)?void 0:e.getText())||this.value}reset(){var e;super.reset(),null==(e=this.element)||e.reset()}setTempState(e){super.setTempState(e),this.element=e}};__decorateClass$n([jsApi()],TreeControllerModel$1.prototype,"getText"),__decorateClass$n([jsApi()],TreeControllerModel$1.prototype,"reset");var baseExtremum=_baseExtremum,baseGt=_baseGt,baseIteratee=_baseIteratee;function maxBy(e,t){return e&&e.length?baseExtremum(e,baseIteratee(t),baseGt):void 0}var maxBy_1=maxBy;const maxBy$1=getDefaultExportFromCjs$1(maxBy_1);function getRowData(e){let t=[];return e.forEach((e=>{t.push(e),e.expand&&e.hasChildren&&e.childNodes&&(t=t.concat(getRowData(e.childNodes)))})),t}function getAllLeafTreeNode(e){let t=[];return e.forEach((e=>{t=e.hasChildren&&e.childNodes?t.concat(getAllLeafTreeNode(e.childNodes)):t.concat(e)})),t}function verticalTraversal(e){var t;const r=null==(t=maxBy$1(e,"length"))?void 0:t.length;if(!r)return"";const n=[];return times(r,(t=>{const r=[];forEach$3(e,(e=>{t<e.length&&!r.includes(e[t])&&r.push(e[t])})),n.push(r.join(PATH_SPLIT_SYMBOL))})),n.join(LEVEL_SPLIT_SYMBOL)}function getTextListString(e){return verticalTraversal(e.map((e=>e.getNodePath().map((e=>String(e.text))).reverse())))||""}const EmptyNodeID=-1e3,CustomID=-1e4;class TreeNode{constructor({id:e,text:t,value:r,showCheck:n,hasChildren:o,expand:i,selected:a}){__publicField(this,"id",""),__publicField(this,"text",""),__publicField(this,"value",""),__publicField(this,"hasChildren",!1),__publicField(this,"showCheck",!1),__publicField(this,"expand",!1),__publicField(this,"selected",!1),__publicField(this,"childNodes"),__publicField(this,"parentNode"),__publicField(this,"relatedNode",{}),this.id="".concat(e),this.text=t,this.value=r,this.hasChildren=o,this.showCheck=n,this.expand=null!=i&&i,this.selected=null!=a&&a}static customNode({value:e,text:t}){return new TreeNode({id:CustomID,text:t,value:e,showCheck:!0,hasChildren:!1})}static emptyNode(e=""){return new TreeNode({id:EmptyNodeID,text:e,value:e,showCheck:!0,hasChildren:!1})}get deep(){return this.getNodePath().length}isEmpty(){return this.id==="".concat(EmptyNodeID)}isCustom(){return this.id==="".concat(CustomID)}setChildNodes(e){this.childNodes=e,this.childNodes.forEach((e=>{e.setParentNode(this)}))}setParentNode(e){this.parentNode=e}getRootNode(){let e=this;for(;e.parentNode;)e=e.parentNode;return e}getNodePath(){let e=this;const t=[e];for(;e.parentNode;)e=e.parentNode,t.push(e);return t}similar(e){return this.text===e.text&&this.value===e.value}similarToString(e){return this.text===e||this.value===e}setRelatedNode(e){this.relatedNode=e}getRelatedNode(){return this.relatedNode}}var __defProp$n=Object.defineProperty,__getOwnPropDesc$m=Object.getOwnPropertyDescriptor,__decorateClass$m=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$m(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$n(t,r,i),i};class TreeControllerModel extends TreeBaseModel{constructor(e,t){super(e,t),__publicField(this,"rootNodes",[]),__publicField(this,"nodeStatus",NODE_STATUS.UNLOAD),__publicField(this,"selectedNodes",[]),__publicField(this,"customNodes",[]),__publicField(this,"searchNodes",[]),__publicField(this,"searchMode",!1),__publicField(this,"searchText",""),__publicField(this,"controllerText",""),__publicField(this,"treeValueMap",new Map),__publicField(this,"treeTextMap",new Map),__publicField(this,"ref",null),__publicField(this,"renderView",noop$6),reaction((()=>{var e;return null==(e=this.controlAttr)?void 0:e.data}),(e=>this.createRootNodes(e))),reaction((()=>{var e;return null==(e=this.controlAttr)?void 0:e.value}),(()=>this.handleValueChange()))}setControllerText(e){this.controllerText=e}setSelectedNodes(e){this.selectedNodes=e}setNodeStatus(e){this.nodeStatus=e}setRenderView(e){this.renderView=e}setRef(e){this.ref=e}clear(){var e,t;null==(e=this.ref)||e.clear(),this.setControlAttr({value:"",data:(null==(t=this.controlAttr)?void 0:t.data)||[]})}getDisplayNodes(){return this.searchMode?getRowData(this.searchNodes):getRowData(this.customNodes.filter((e=>e.selected)).concat(this.rootNodes))}getNodeForTextOrValue(e){if(isEmpty$3(e))return;let t;isArray$c(e)&&(t=last$2(e)),isString$3(e)&&(t=e.split(PATH_SPLIT_SYMBOL).pop()||e);const r=this.treeValueMap.get(t)||this.treeTextMap.get(t);return r&&r.hasChildren&&r.childNodes&&this.customOptions.selectLeafOnly&&!this.customOptions.multiSelection?TreeNode.customNode({text:r.text,value:r.value}):null!=r?r:TreeNode.customNode({text:t,value:t})}getDefaultValues(e){return isString$3(e)?e.split(VALUE_SPLIT_SYMBOL).filter((e=>e)):isArray$c(e)?e:[]}getNode(e){const{multiSelection:t}=this.customOptions;if(!t){const e=this.getNodeForTextOrValue(String(this.value));return e?[e]:[]}return e.reduce(((e,t)=>{const r=this.getNodeForTextOrValue(t);return r&&e.push(r),e}),[])}getMatchedNodes(e){if(isEmpty$3(e))return[];const{selectLeafOnly:t}=this.customOptions,r=this.getNode(e);return t?getAllLeafTreeNode(r):r}getformatText(e){const{multiSelection:t,selectLeafOnly:r}=this.customOptions;if(t&&r){return getTextListString(e)}return e.map((e=>{var t;return null!=(t=(null==e?void 0:e.text)||(null==e?void 0:e.value))?t:""})).join(VALUE_SPLIT_SYMBOL)}setFormatText(e){const t=this.getformatText(e);this.setControllerText(t)}createRootNodes(e){this.rootNodes=e?this.createTreeNodeList(e):[]}handleValueChange(){var e,t;const r=this.getNodesValue(this.selectedNodes);if(r&&(null==(e=this.controlAttr)?void 0:e.value)&&isEqual$4(r,this.controlAttr.value))return;const n=this.getDefaultValues(null==(t=this.controlAttr)?void 0:t.value),o=this.getMatchedNodes(n);this.setSelectedNodes(o),this.customNodes=o.filter((e=>e.isCustom())),this.nodeStatus===NODE_STATUS.LOADED&&this.resetNodesStatus(),this.setFormatText(o)}getNodesValue(e){var t;const{returnFullPath:r,selectLeafOnly:n,multiSelection:o}=this.customOptions;if(r){const r=e.map((e=>e.getNodePath().reverse().map((e=>e.value))));return o?r.length?r:"":null!=(t=first(r))?t:""}const{returnArray:i,startSymbol:a="",endSymbol:s="",delimiter:l}=this.calculateTreeOptions();if(n&&!i)return"".concat(a).concat(e.map((e=>e.value)).join(l)).concat(s);const c=e.map((e=>e.value));return c.length?c:""}handleBeforeShowEditor(){this.nodeStatus===NODE_STATUS.UNLOAD&&this.setNodeStatus(NODE_STATUS.LOADING)}handleAfterShowEditor(){this.nodeStatus!==NODE_STATUS.LOADED&&(this.resetNodesStatus(),this.setNodeStatus(NODE_STATUS.LOADED))}handleCloseEditor(){this.resetSearchStatus(),this.resetNodesStatus(),this.renderView()}resetSearchStatus(){this.searchMode=!1,this.searchNodes=[]}setControllerValue(e,t=!0){const r=super.setControllerValue(e,t);return this.setControlAttr({value:e,data:this.treeData||[]}),r}handleConfirm(e){this.customNodes=e.filter((e=>e.isCustom())),this.setSelectedNodes(e),this.setFormatText(e),this.onFinish(this.getNodesValue(e)),this.renderView()}async handleLoadChildNodes(e){return e.childNodes?Promise.resolve():this.fetchChildNodes(e)}async fetchChildNodes(e){const t=await this.calculateTreeOptions().oldTreeControlAttrFetcher("",{id:e.id,value:e.value,reload:!1,parent_values:e.getNodePath().map((e=>e.value)).reverse()});e.setChildNodes(this.createTreeNodeList(t)),this.renderView()}createTreeNodeList(e){const t=[],{mutiSelection:r,selectLeafOnly:n}=this.calculateTreeOptions();return isArray$c(e)&&e.forEach((e=>{const{id:o,text:i,value:a,hasChildren:s,ChildNodes:l}=e,c=new TreeNode({id:o,text:i,value:a,showCheck:r||!n||!s,hasChildren:s||!!l});this.treeValueMap.get(a)||this.treeValueMap.set(a,c),this.treeTextMap.get(i)||this.treeTextMap.set(i,c),l&&c.setChildNodes(this.createTreeNodeList(l)),t.push(c)})),t}isExpandSearchNode(){return!0}resetNodesStatus(){this.customNodes.concat(this.rootNodes).forEach((e=>{this.handleNodeStatus(e)}))}handleNodeStatus(e){var t;null==(t=e.childNodes)||t.forEach((e=>{this.handleNodeStatus(e)})),e.expand=this.isNodeExpand(e),e.selected=this.isNodeSelected(e)}isNodeSelected(e){var t;const{multiSelection:r,selectLeafOnly:n}=this.customOptions;return r&&n&&e.hasChildren?!!(null==(t=e.childNodes)?void 0:t.length)&&e.childNodes.every((e=>e.selected)):this.selectedNodes.some((t=>t.id===e.id))}isNodeExpand(e){var t;return!this.customOptions.async||!!(null==(t=this.selectedNodes)?void 0:t.length)&&this.selectedNodes.some((t=>t.getNodePath().some(((t,r)=>t.id===e.id&&t.value===e.value&&0!==r))))}async loadSearchData(e){if(!e)return this.searchMode=!1,void this.renderView();this.searchText=e,this.searchMode=!0;const t=await this.getSearchNodesByText(e);if(await this.setSearchRelatedNodes(t,this.rootNodes),e===this.searchText){if(!this.hasContain(t,e)&&this.customValue){let r=this.customNodes.find((t=>t.similarToString(e)));r?this.searchNodes=[r].concat(t):(r=TreeNode.customNode({text:e,value:e}),r.setRelatedNode(r),this.searchNodes=[r].concat(t),this.customNodes.push(r))}else this.searchNodes=t;this.renderView()}}hasContain(e,t){if(!e)return!1;for(const r of e){let e=!1;if(r.hasChildren&&this.customOptions.selectLeafOnly||(e=r.similarToString(t)),e||this.hasContain(r.childNodes||[],t))return!0}return!1}filterSearchNode(e){return null==e?void 0:e.filter((e=>(e.ChildNodes&&(e.ChildNodes=this.filterSearchNode(e.ChildNodes)),e.isexpand)))}async getSearchNodesByText(e){const t=await this.calculateTreeOptions().oldTreeControlAttrFetcher("",{value:"",reload:!1,filter:e,dataFilter:e,fine_outlet_widget:"nx"});return this.createTreeNodeList(this.filterSearchNode(t))}checkAllParentNodeSelected(e){e.getNodePath().forEach(((e,t)=>{var r;0!==t&&(e.selected=(null==(r=e.childNodes)?void 0:r.every((e=>e.selected)))||!1)}))}setSearchRelatedNodes(e,t){const r=e.map((e=>{const r=t.find((t=>e.similar(t)));return r?(e.setRelatedNode(r),this.isExpandSearchNode()&&(e.expand=!0),e.selected=r.selected,e.childNodes&&r.hasChildren?this.handleLoadChildNodes(r).then((()=>this.setSearchRelatedNodes(e.childNodes||[],r.childNodes||[]))):(this.customOptions.selectLeafOnly&&this.checkAllParentNodeSelected(e),Promise.resolve())):Promise.resolve()}));return Promise.all(r)}getText(){return this.controllerText}reset(){super.reset(),this.setSelectedNodes([])}}__decorateClass$m([observable],TreeControllerModel.prototype,"nodeStatus",2),__decorateClass$m([observable.ref],TreeControllerModel.prototype,"selectedNodes",2),__decorateClass$m([observable],TreeControllerModel.prototype,"controllerText",2),__decorateClass$m([action$1],TreeControllerModel.prototype,"setControllerText",1),__decorateClass$m([action$1],TreeControllerModel.prototype,"setSelectedNodes",1),__decorateClass$m([action$1],TreeControllerModel.prototype,"setNodeStatus",1),__decorateClass$m([jsApi()],TreeControllerModel.prototype,"getText",1),__decorateClass$m([jsApi()],TreeControllerModel.prototype,"reset",1);class TreeViewControllerModel extends TreeControllerModel$1{get isFullWidthInControllerPanel(){return!0}}function getTreeOptions(e,t){var r,n,o,i,a;const{validation:s,parseValueConfig:l,customOptions:c,dataDictionary:u,valueConfig:d}=e,{returnFullPath:h,multiSelection:p,async:f,selectLeafOnly:g}=c,m=parseTreeDataString(u.config),{value:y,pathValue:v}=d,_=u.computed;return{value:v||y,controlAttr:{value:v,data:_},returnFullPath:h,mutiSelection:p,isLayerBuild:m.isLayerBuild,async:f,selectLeafOnly:g,...l&&configKit.parseData.isParseIntoString(l)?{returnArray:!1,startSymbol:null==(r=l.payload)?void 0:r.startSymbol,endSymbol:null==(n=l.payload)?void 0:n.endSymbol,delimiter:null==(o=l.payload)?void 0:o.splitor}:{returnArray:!0},oldTreeControlAttrFetcher:(r,n)=>getTreeData(n,e,t,_),newTreeControlAttrFetcher:(r,n)=>getTreeData({...n,fine_outlet_widget:"nx"},e,t,_),newTreeStructureFetcher:(r,n)=>getTreeData({...n,fine_outlet_widget:"nx",completion:!0},e,t,_),customData:null==(i=s.config.customValue)?void 0:i.open,allowBlank:null==(a=s.config.allowEmpty)?void 0:a.open,needCheckCustomData:!1}}async function getTreeData(e,t,r,n){const o={filter:{content:e.filter},async:t.customOptions.async,outsidePayload:{...shake(e,isNil$4),async:t.customOptions.async}},i=await r("dataDictionaryConfig",o);if(!i.success)return Message.error(i.error.message),[];const{value:a}=i;return Array.isArray(a)?a:null!=n?n:[]}const BASE_CLS$1="fvs-controller-combo-tree";class TreeSelect{constructor(e){__publicField(this,"tree",null),__publicField(this,"scale",1),this.fvs=e}mount({el:e,state:t}){return this.setScale(t.scale),resolveFineUIPopupDislocation((()=>this.scale)),{element:e}}render({element:e,config:t,state:r,runtime:n}){var o;const{height:i,width:a}=r,{styleConfig:s,placeholder:l}=t,{fontAttr:c}=s;null==(o=this.tree)||o.destroy(),e.innerHTML="";const u=document.createElement("div");return e.appendChild(u),new Promise((e=>{BI.createWidget({type:"report.main.parameter_container.controller.editor.tree_combo_box",directEdit:!0,allowBg:!1,element:u,ref:t=>{this.tree=t,t&&resolveFineUITreeComboPopupViewFit(t,classNames$1(COMBO_POPUP_CLS,"".concat(BASE_CLS$1,"-popup-view")),(()=>this.scale)),e()},disabled:!t.enable,height:i,width:a,watermark:l,fontSize:c.fontSize,noGlobalMask:!0,...getTreeOptions(t,this.fvs.calculate),listeners:[{eventName:"EVENT_CHANGE",action:e=>{var t,r;null==(r=null==(t=null==n?void 0:n.events)?void 0:t.onFinish)||r.call(t,e)}}]})}))}refresh({config:e}){var t,r,n,o;const{value:i,pathValue:a}=e.valueConfig;if(!isEqual$5(i,null==(t=this.tree)?void 0:t.getValue()))return isEmpty$4(i)?(null==(r=this.tree)||r.reset(),void(null==(n=this.tree)||n.setValue([]))):void(null==(o=this.tree)||o.setValue(a))}unmount(){var e;null==(e=this.tree)||e.destroy(),this.tree=null}setScale(e){this.scale=null!=e?e:1}save(){return this.tree}restore(e){this.tree=e}}const useCustomOptions=e=>{const{async:t,multiSelection:r,returnFullPath:n,selectLeafOnly:o}=e.customOptions;return reactExports.useMemo((()=>({customOptions:{async:t,multiSelection:r,returnFullPath:n,selectLeafOnly:o}})),[t,r,n,o])},BASE_CLS="fvs-controller-combo-tree";function TreeComboController$1({model:e,width:t,height:r=0}){const n=useControllerState({width:t,height:r},e),o=useCustomOptions(e),i=useControllerComputed(e,(e=>{var t,r,n,o;return{valueConfig:{value:e.value,pathValue:(null==(t=e.controlAttr)?void 0:t.value)||e.value},dataDictionary:{config:null!=(n=null==(r=e.props.extend)?void 0:r.dataDictionary)?n:"",computed:null==(o=e.controlAttr)?void 0:o.data}}}),o),a=useClassWidget({widgetClass:TreeSelect,model:e,computed:i,state:n,runtime:{events:{onFinish:t=>{e.onFinish(t)}}}});return jsx("div",{className:classNames$1("fvs-controller",COMBO_CLS,BASE_CLS),ref:a})}function TreeComboController({model:e}){const{enable:t,warning:r,isVisible:n,allowEmpty:o,placeholder:i,selectedNodes:a,nodeStatus:s,customOptions:{multiSelection:l,selectLeafOnly:c}}=e,u=useUpdate$1();useMount$1((()=>{e.isPreview||e.refresh(),e.setRenderView(u)}));const d=useControllerThemeStyle(e.store.styleConfig);return jsx(DropTree,{popupClassName:"fvs-drop-tree-popup",popupStyle:d,text:e.getText(),invalid:!isNil$3(null==r?void 0:r.message),watermark:i,disabled:!t,invisible:!n,multiple:l,isSelectLeafOnly:c,isRequired:!o,selectedNodes:a,getNodes:()=>e.getDisplayNodes(),loadChildNodes:t=>e.handleLoadChildNodes(t),onConfirm:t=>e.handleConfirm(t),onSearchChange:t=>e.loadSearchData(t),onSearchCancel:()=>e.loadSearchData(""),beforeEditorShow:()=>e.handleBeforeShowEditor(),afterEditorShow:()=>e.handleAfterShowEditor(),afterEditorClose:()=>e.handleCloseEditor(),isLoading:s===NODE_STATUS.LOADING})}class TreeView{constructor(e){__publicField(this,"treeView",null),this.fvs=e}mount({el:e}){return{element:e}}render({element:e,config:t,state:r,runtime:n}){const{height:o,width:i}=r,{styleConfig:a}=t,{fontAttr:s}=a;this.unmount(),e.innerHTML="";const l=document.createElement("div");return e.appendChild(l),new Promise((e=>{BI.createWidget({type:"report.main.parameter_container.controller.tree",allowBg:!1,element:l,ref:t=>{this.treeView=t,e()},disabled:!t.enable,height:o,width:i,fontSize:s.fontSize,noGlobalMask:!0,...getTreeOptions(t,this.fvs.calculate),listeners:[{eventName:"EVENT_CHANGE",action:e=>{var t,r;null==(r=null==(t=null==n?void 0:n.events)?void 0:t.onFinish)||r.call(t,e)}}]})}))}refresh({config:e}){var t,r;const{pathValue:n,value:o}=e.valueConfig;isEqual$5(null==(t=this.treeView)?void 0:t.getValue(),o)||null==(r=this.treeView)||r.setValue(n)}unmount(){var e;null==(e=this.treeView)||e.destroy(),this.treeView=null}save(){return this.treeView}restore(e){this.treeView=e}}function TreeViewController({model:e,width:t,height:r=0}){const n=useControllerState({width:t,height:r},e),o=useCustomOptions(e),i=useControllerComputed(e,(e=>{var t,r,n,o;return{valueConfig:{value:e.value,pathValue:(null==(t=e.controlAttr)?void 0:t.value)||e.value},dataDictionary:{config:null!=(n=null==(r=e.props.extend)?void 0:r.dataDictionary)?n:"",computed:null==(o=e.controlAttr)?void 0:o.data}}}),o),a=useClassWidget({widgetClass:TreeView,model:e,computed:i,state:n,runtime:{events:{onFinish:t=>{e.onFinish(t)}}}});return jsx("div",{className:"fvs-controller fvs-controller-tree-view",ref:a,style:{"--selected-color":e.styleConfig.selected.color}})}const eventTargets={events:[{trigger:WIDGET_EVENT.MOUNTED,text:WIDGET_EVENT_MAP.MOUNTED,actions:[{action:DUCHAMP_ACTION_TYPE.JAVASCRIPT}]},{trigger:WIDGET_EVENT.EDIT_FINISH,text:WIDGET_EVENT_MAP.EDIT_FINISH,actions:[{action:DUCHAMP_ACTION_TYPE.JAVASCRIPT}]}]},registerControllerTreeCombo=()=>{registerController({meta:{type:"d-controller-tree-combo",displayName:duchampIntl.get("Duchamp-Controller_Tree_Combo"),version:"0.0.1",iconfont:"icon-drop-down-tree-components",dragPreviewImage:"/assets/widget/controller_tree_combo.svg",groupName:duchampIntl.get("Duchamp-Controller_Tree"),borderLine:DEFAULT_CONTROLLER_BORDER_LINE,props:{validation:{allowEmpty:{open:!0,errorTip:""},customValue:{open:!0,errorTip:""}},extend:{customOptions:{multiSelection:!1,async:!0,selectLeafOnly:!0,returnFullPath:!1}},parseValueConfig:{type:"array"}},configuration:{type:"object",properties:{...getBaseProperties(),treeDataConfig:{title:duchampIntl.get("Duchamp-Option_Source"),widget:"treeDataConfig"},customOptions:{title:duchampIntl.get("Duchamp-Option"),widget:"parseTreeValueConfig"},parseValueConfig:{widget:"parseValueConfig",hidden:"{{ !(formData.customOptions.multiSelection && !formData.customOptions.returnFullPath) }}"},defaultValue:{title:duchampIntl.get("Duchamp-Default_Value"),widget:"defaultValue"},watermark:{title:duchampIntl.get("Duchamp-Watermark"),widget:"watermark"},authority:{title:duchampIntl.get("Duchamp-Permission"),widget:"authority"},validation:{title:duchampIntl.get("Duchamp-Calibration"),widget:"validation",props:{validation:["empty","customValue"],showCustomValueErrorTip:!1}}}},configure:{eventTargets:eventTargets}},view:TreeComboController$1,mobileView:TreeComboController,model:TreeControllerModel$1,mobileModel:TreeControllerModel})},registerTreeViewComboCustomView=()=>{registerControllerStyle("d-controller-tree-combo",{...DEFAULT_CONTROLLER_STYLE_META,configuration:[...DEFAULT_CONTROLLER_FONT_CONFIGURATION,{name:"color",displayName:"",value:DEFAULT_CONTROLLER_STYLE_PROPS.color,type:"colorSelect"},{name:"iconColor",displayName:duchampIntl.get("Duchamp-Template_Icon_Color"),value:DEFAULT_SINGLE_COLOR$1,type:"colorSelect"}]},TreeComboController$1)},registerControllerTreeView=()=>{registerController({meta:{type:"d-controller-tree-view",displayName:duchampIntl.get("Duchamp-Controller_Tree_View"),version:"0.0.1",iconfont:"icon-view-tree-components",dragPreviewImage:"/assets/widget/controller_tree_view.svg",groupName:duchampIntl.get("Duchamp-Controller_Tree"),states:{height:100},configuration:{type:"object",properties:{...getBaseProperties(),treeDataConfig:{title:duchampIntl.get("Duchamp-Option_Source"),widget:"treeDataConfig"},customOptions:{title:duchampIntl.get("Duchamp-Option"),widget:"parseTreeValueConfig",props:{value:{multiSelection:!1,async:!0,selectLeafOnly:!0,returnFullPath:!1}}},parseValueConfig:{widget:"parseValueConfig",hidden:"{{ !(formData.customOptions.multiSelection && !formData.customOptions.returnFullPath) }}"},defaultValue:{title:duchampIntl.get("Duchamp-Default_Value"),widget:"defaultValue"},validation:{title:duchampIntl.get("Duchamp-Calibration"),widget:"validation"}}},configure:{eventTargets:eventTargets}},view:TreeViewController,mobileView:TreeComboController,model:TreeViewControllerModel,mobileModel:TreeControllerModel})},registerTreeViewToggleLayout=()=>{registerControllerStyle("d-controller-tree-view",{...DEFAULT_CONTROLLER_STYLE_META,configuration:[...DEFAULT_CONTROLLER_FONT_CONFIGURATION,{type:"toggleLayout",displayName:"",options:[{label:duchampIntl.get("Duchamp-Unselected"),value:""},{label:duchampIntl.get("Duchamp-Selected"),value:"selected"}],children:[{type:"verticalLayout",children:[{type:"colorSelect",name:"color",title:duchampIntl.get("Duchamp-Font_Color"),value:"#000000A6"}]}]}],themeTransfer:e=>({color:e.fontColorNormal,selected:{color:e.colorPrimary}})},TreeViewController,TreeComboController)},registerControllerComponents=()=>{registerRadioGroupDefault(),registerRadioGroupCapsule(),registerRadioGroupRowingConfig(),registerRadioGroupGraphic(),registerComboDefault(),registerComboSimple(),registerDatetimeDefault(),registerDatetimeCalendar(),registerDatetimeWeekCalendar(),registerTreeViewToggleLayout(),registerTreeViewComboCustomView(),registerDateIntervalStyle(),registerControllerDatetime(),registerControllerDateInterval(),registerControllerCombo(),registerControllerRadioGroup(),registerControllerText(),registerControllerTreeCombo(),registerControllerTreeView()},registerDuchampWidgets=()=>{registerCalderWidget(),registerCalderCustomWidget(),registerUnitWidget(),registerChartComponents(),registerRelationWidget(),registerTitleWidget(),registerRichTextWidget(),registerWorkBookXWidget(),registerWorkBookWidget(),registerTimeWidget(),registerLocalVideoWidget(),registerLiveVideoWidget(),registerImageWidget(),registerIframeWidget(),registerTabsWidget(),registerTabPaneWidget(),registerReserveCanvasWidget(),registerExpandWidget(),registerExpandTemplateWidget(),registerAIWidget(),registerControllerComponents(),registerQueryButtonWidget(),registerReuse(),registerGroupWidget()},WidgetError=observer((({widget:e,children:t,adaptiveScale:r})=>{const n=useStore(),o=widgetManager.getWidgetByName(e.type);if(!n.checkWidgetFunctionPoint(o.functionPoint,e)&&n.isPreview)return jsx(ErrorImageDisplay,{error:ERROR_NO_LICENSE,height:e.height});const i=e.widgetError;return jsx(ErrorBoundary,{errorRender:t=>jsx(ErrorImageDisplay,{error:t,height:e.height}),children:"error"===(null==i?void 0:i.errorType)?jsx(ErrorImageDisplay,{error:i,height:e.height}):jsxs(Fragment,{children:[jsx(WidgetWarning,{widget:e,adaptiveScale:r}),t,"warning"===(null==i?void 0:i.errorType)&&jsx(ErrorViewIndicator,{widgetError:i,errorViewMode:"warning"})]})})}));function isInstanceofFloatEditable(e){return void 0!==(null==e?void 0:e.onFloatEditEnd)}function useFloatTop(e){const t=null==e?void 0:e.getInstance(),r=null==t?void 0:t.isFloatTop,n=reactExports.useCallback((e=>{const{label:t=duchampIntl.get("Duchamp-Angle_Adjustment"),icon:r="icon-view",hide:n=!1}=e.floatEditToolbar||{};null==e||e.setToolbar({label:t,value:"float-edit",icon:r,hide:n,onClick:()=>{e.setFloatTop(!0),e.fireEvent("disableDegrade")}})}),[]),o=reactExports.useCallback((e=>{e.setToolbar({label:duchampIntl.get("Duchamp-Finish"),value:"float-edit",icon:"icon-check",single:!0,onClick:()=>{e.setFloatTop(!1),e.fireEvent("enableDegrade")}})}),[]);useUpdateEffect$2((()=>{if(isInstanceofFloatEditable(t))return()=>{r&&t.onFloatEditEnd()}}),[r]),reactExports.useEffect((()=>{isInstanceofFloatEditable(t)&&(r?o(t):n(t))}),[t,r,n,o,null==t?void 0:t.floatEditToolbar]),reactExports.useEffect((()=>{const e=e=>{!e&&(null==t||t.setFloatTop(!1))},r=()=>{null==t||t.setFloatTop(!1)};return null==t||t.addEventListener("select",e),null==t||t.addEventListener("save",r),()=>{null==t||t.removeEventListener("select",e),null==t||t.removeEventListener("save",r)}}),[t])}const EditViewComponent=reactExports.forwardRef((({widget:e,expandIndex:t,openLazyRender:r,width:n,height:o,className:i,style:a,contentClassName:s,contentStyle:l,...c},u)=>{const d=useStore(),{model:h}=e,{widgetIsRenderWithoutScale:p}=h,{scale:f}=d.platform,{story:g}=d,m=!e.parent&&e.visibleInStory&&!e.platform.lock;useFloatTop(e),useUnmount$2((()=>{h.setShowHoverTip(!1)}));const y=reactExports.useRef(null),v=useMergedRefs(y,u),{lazy:_}=useLazyRender(y,r);return jsx("div",{ref:v,className:classNames$1({"duchamp-selectable":m,"duchamp-widget-selected":g.currents.has(e.id)&&e.visibleInStory,"duchamp-widget-float-top":g.widgetFloatTop===e.id,"duchamp-widget-hovered":null==h?void 0:h.showHoverTip,"duchamp-widget-expand":!!t,"duchamp-widget-lock":e.platform.lock},i),style:a,onClick:()=>{g.currents.size||!g.rootWidgets.includes(e)||e.platform.lock?h.setShowHoverTip(!1):h.setShowHoverTip(!0)},onMouseMove:t=>{if(isCtrlOrCmdKeyDown(t)){h.setShowHoverTip(!1);const r=getDeepestWidgetInPoint(g.rootWidgets.slice().reverse(),{x:t.clientX,y:t.clientY});(null==r?void 0:r.id)!==e.id||g.currentArr.includes(r.id)||h.setShowHoverTip(!0)}},onMouseEnter:t=>{0===t.buttons&&(g.widgetsCanHover.find((t=>t.id===e.id))?h.setShowHoverTip(!0):h.setShowHoverTip(!1))},onMouseLeave:()=>{h.setShowHoverTip(!1)},...c,id:e.id,children:!_&&jsx(WidgetError,{widget:e,children:jsx(WidgetTurboFrame,{widget:e,children:jsx("div",{className:classNames$1(s,{"pointer-events-none":0===e.children.length}),style:l,children:p?jsx("div",{className:"duchamp-widget-without-scale",style:{width:"".concat(100*f,"%"),height:"".concat(100*f,"%"),transform:1!==f?"scale(".concat(1/f,")"):void 0},children:jsx(WidgetView,{widget:e,expandIndex:t,width:n*f,height:o?o*f:void 0})}):jsx(WidgetView,{widget:e,expandIndex:t,width:n,height:o})})})})})}));EditViewComponent.displayName="EditViewComponent";const EditView=observer(EditViewComponent),WidgetWrapperComponent=reactExports.forwardRef((({widget:e,adaptiveScale:t,expandIndex:r,openLazyRender:n,className:o,style:i,children:a,isSingleRoot:s,transitionFrame:l,autoHeight:c=!1,isPreview:u,withPosition:d=!0,...h},p)=>{const{model:f}=e,{size:g,adaptiveScale:m}=useSize(e,t),{wrapperStyle:y,contentStyle:{width:v,height:_,...b}}=useAdaptiveStyle({bounds:{matrix:e.platform.states.matrix,...g},padding:e.platform.padding,borderLine:e.platform.borderLine,renderWithoutScale:e.model.widgetIsRenderWithoutScale,autoHeight:c,adaptiveScale:m}),C=reactExports.useMemo((()=>{const{left:e,top:t,width:r,height:n}=y;return d?{...new Metrics(0,0,[1,0,0,1,e,t]).toUnitCssObject(),width:r,height:n,position:"absolute"}:{width:"100%",height:"100%"}}),[y,d]),E=reactExports.useRef(null),T=useMergedRefs(E,p);reactExports.useEffect((()=>{const t=E.current;return t&&e.setTarget(t,r),()=>{e.setTarget(void 0,r)}}),[r,e]);const S={className:classNames$1("duchamp-widget",{hide:!e.visibleInStory},o),style:{...C,...i},widget:e,expandIndex:r,width:v,height:_,contentStyle:{width:v,height:_,...b},contentClassName:"duchamp-widget-view",openLazyRender:n,"data-id":e.id,"data-name":e.name,"data-type":e.type,...h};return u||f.isPreview?jsx(PreviewView,{ref:T,adaptiveScale:m,transitionFrame:l,isSingleRoot:s,...S,children:a}):jsx(EditView,{ref:T,...S})}));WidgetWrapperComponent.displayName="WidgetWrapperComponent";const WidgetWrapper=observer(WidgetWrapperComponent),ControllerWidgetView=observer((({widget:e,width:t,autoWidth:r,className:n,style:o})=>{reactExports.useEffect((()=>{r||e.setStates({width:e.model.isFullWidthInControllerPanel?t:DEFAULT_WIDGET_WIDTH})}),[r,e,t]);const i=!r&&e.model.isFullWidthInControllerPanel?null:convertBorderVariable(e.borderLine);return jsxs("div",{className:"controller-view-wrapper",children:[jsx("div",{className:"controller-view-name",children:e.name}),jsx("div",{className:classNames$1("controller-view-widget",n),"data-id":e.id,style:{...covertBorderRadiusStyle(e.borderRadius),...i,width:r?void 0:e.width,...o},children:jsx(WidgetError,{widget:e,children:jsx("div",{className:"duchamp-fluid-view",style:{width:r?void 0:e.width},children:jsx(WidgetView,{widget:e,width:e.width,height:e.height})})})})]})})),useControllerPanelOptions=({visible:e,onCancel:t,onOk:r})=>{const n=useStore(),o=reactExports.useRef(0),i=reactExports.useMemo((()=>n.controllerPanel.widgets.map((e=>e.getInstance().getValue()))),[e,o.current]),a=reactExports.useRef(null),s=a.current;e&&s&&!isEqual$4(i,a.current)&&(n.controllerPanel.widgets.forEach(((e,t)=>{e.getInstance().setCalculation({value:s[t]})})),o.current=o.current+1);return{cancelHandler:()=>{n.controllerPanel.widgets.forEach(((e,t)=>{e.getInstance().updateRelationalValue(i[t])})),a.current=i,t()},okHandler:async()=>{const{widgets:e}=n.controllerPanel,t=e.map((async e=>e.getInstance().checkValue()));await Promise.all(t),e.some((e=>!1===e.getInstance().verificationSuccess))?e.reduce(((e,t)=>{var r;return(null==(r=t.warning)?void 0:r.message)&&e.push(t.warning.message),e}),[]):(n.applyControllerPanelParameters(),a.current=null,r())},clearStoreData:()=>{a.current=null},immediateOkHandler:()=>{n.applyControllerPanelParameters(),a.current=null,r()}}},MAX_HEIGHT=.5*window.innerHeight,ControllerPanelPopup=observer((({visible:e,onCancel:t,onOk:r})=>{const n=useStore(),{cancelHandler:o,okHandler:i}=useControllerPanelOptions({visible:e,onCancel:t,onOk:r});return reactExports.useEffect((()=>{n.controllerPanel.widgets.forEach((e=>{widgetIsTreeViewController(e)&&e.setBorderLine({borderStyle:"solid",borderWidth:1,borderColor:n.duchampServer.themeManager.themeVars.borderColorNormal})}))}),[n.controllerPanel.widgets]),jsx(ControllerPopup,{onCancel:t,visible:e,leftBtn:{text:duchampIntl.get("Duchamp-Cancel"),onClick:o},rightBtn:{text:duchampIntl.get("Duchamp-Query"),onClick:i},children:n.queryPanelDisplayedWidgets.map((e=>jsx(ControllerWidgetView,{widget:e,autoWidth:!0,style:widgetIsRadioGroup(e.type)&&!e.getInstance().autoHeight?{maxHeight:MAX_HEIGHT,overflowY:"auto"}:void 0},e.id)))})}));var __defProp$m=Object.defineProperty,__getOwnPropDesc$l=Object.getOwnPropertyDescriptor,__decorateClass$l=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$l(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$m(t,r,i),i};class FilterButton{constructor(e){__publicField(this,"store"),__publicField(this,"popupVisible",!1),makeObservable(this),this.store=e,autorun((()=>{const{isControllerPanelEnabled:e,isControllerPanelAutoSearch:t}=this.store;this.setPopupVisible(e&&!t)}))}get meta(){return{name:TOOLBAR_NAME.FILTER,weight:BASE_BUTTON_WEIGHT,text:duchampIntl.get("Duchamp-Filter"),icon:jsx(Icon$1,{name:"fdm-toolbar-filter",size:28}),popup:jsx(ControllerPanelPopup,{...this.popupProps},TOOLBAR_NAME.FILTER),type:TOOLBAR_BUTTON_TYPE$1.TEMPLATE}}setPopupVisible(e){this.popupVisible=e}get visible(){const{isControllerPanelEnabled:e,queryPanelDisplayedWidgets:t,platform:r}=this.store;return e&&t.length>0&&!r.mobile.isTopControlPanel}get onClick(){return()=>this.setPopupVisible(!0)}onPopupOk(){const{widgets:e}=this.store.mainStory;e.forEach((e=>{const t=e.getInstance();isInstanceofZoomable(t)&&t.isZoomed&&t.toggleZoom(!1)})),this.setPopupVisible(!1)}get popupProps(){return{visible:this.popupVisible&&this.store.isControllerPanelInitialized,onCancel:()=>this.setPopupVisible(!1),onOk:()=>this.onPopupOk()}}}__decorateClass$l([computed],FilterButton.prototype,"meta",1),__decorateClass$l([observable],FilterButton.prototype,"popupVisible",2),__decorateClass$l([action$1],FilterButton.prototype,"setPopupVisible",1),__decorateClass$l([computed],FilterButton.prototype,"visible",1),__decorateClass$l([computed],FilterButton.prototype,"popupProps",1);var __defProp$l=Object.defineProperty,__getOwnPropDesc$k=Object.getOwnPropertyDescriptor,__decorateClass$k=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$k(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$l(t,r,i),i};class MarkButton{constructor(){__publicField(this,"meta",{name:TOOLBAR_NAME.MARK,weight:BASE_BUTTON_WEIGHT,text:duchampIntl.get("Duchamp-Mark"),icon:jsx(Icon$1,{name:"fdm-note",size:28}),type:TOOLBAR_BUTTON_TYPE$1.TEMPLATE,clickAfterAnimation:!0}),makeObservable(this)}get visible(){return!!(null==jsBridge?void 0:jsBridge.isWebview)}get onClick(){return()=>{}}}__decorateClass$k([computed],MarkButton.prototype,"visible");const NavigationPopup=({visible:e,names:t,onClose:r,onChange:n})=>jsxs(Popup,{visible:e,position:"bottom",onMaskClick:r,bodyStyle:{height:480,borderRadius:"4px 4px 0 0"},bodyClassName:"navigation-popup",children:[jsxs("div",{className:"header",children:[duchampIntl.get("Duchamp-Directory"),jsx("span",{className:"close",onClick:r,children:jsx(Icon$1,{name:"fdm-close",size:18})})]}),jsx("div",{className:"body",children:t.map((e=>jsx("div",{className:"item",onClick:()=>{r(),n(e)},children:e},e)))})]}),showLoading=()=>({close:noop$6}),navigateToWidget=async(e,t)=>{const{widgets:r}=e.mainStory;r.forEach((e=>{const t=e.getInstance();isInstanceofZoomable(t)&&t.isZoomed&&t.toggleZoom(!1)}));const n=r.filter(isValidAndNotInExpand).find(t);if(!n)return void console.error("Navigation widget not found");const{duchampNavigation:o}=e.platform.mobile,{close:i}=showLoading();o.setWidget(n),await loadAndDisplayWidget(n,o.previewScale),i(),o.scrollTo()},navigateToWidgetByNavigationText=(e,t)=>{navigateToWidget(t,(t=>isWidgetNavigationTextEquals(t,e)))};var __defProp$k=Object.defineProperty,__getOwnPropDesc$j=Object.getOwnPropertyDescriptor,__decorateClass$j=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$j(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$k(t,r,i),i};class NavigatorButton{constructor(e){__publicField(this,"store"),__publicField(this,"popupVisible",!1),makeObservable(this),this.store=e}get meta(){return{name:TOOLBAR_NAME.NAVIGATOR,weight:BASE_BUTTON_WEIGHT,text:duchampIntl.get("Duchamp-Navigation"),icon:jsx(Icon$1,{name:"fdm-navigation",size:28}),className:"divider",popup:jsx(NavigationPopup,{...this.popupProps},TOOLBAR_NAME.NAVIGATOR),type:TOOLBAR_BUTTON_TYPE$1.STORY}}get validWidgets(){return this.store.story.widgets.filter((e=>e.visible&&e.platform.mobile.isCanvasValid()&&!widgetIsInExpand(e)))}get names(){const e=this.validWidgets.reduce(((e,t)=>{var r,n,o;const{previewConfig:i}=t.platform.mobile.props;return(null==(r=null==i?void 0:i.navigation)?void 0:r.enable)&&(null==(n=null==i?void 0:i.navigation)?void 0:n.text)&&e.push({text:null==(o=null==i?void 0:i.navigation)?void 0:o.text,rect:t.rect}),e}),[]);return sortBy(e,["rect.top",e=>-e.rect.left]).map((e=>e.text))}setPopupVisible(e){this.popupVisible=e}get visible(){return!isEmpty$3(this.names)}get onClick(){return()=>this.setPopupVisible(!0)}get popupProps(){return{names:this.names,visible:this.popupVisible,onClose:()=>this.setPopupVisible(!1),onChange:e=>navigateToWidgetByNavigationText(e,this.store)}}}__decorateClass$j([computed],NavigatorButton.prototype,"meta",1),__decorateClass$j([computed],NavigatorButton.prototype,"names",1),__decorateClass$j([observable],NavigatorButton.prototype,"popupVisible",2),__decorateClass$j([action$1],NavigatorButton.prototype,"setPopupVisible",1),__decorateClass$j([computed],NavigatorButton.prototype,"visible",1),__decorateClass$j([computed],NavigatorButton.prototype,"popupProps",1);const PagePopup=({visible:e,value:t,names:r,onClose:n,onChange:o})=>{const{t:i}=useI18n(),a=reactExports.useRef(null);return jsx(Popup,{visible:e,position:"right",bodyStyle:{width:"320px"},onMaskClick:n,afterClose:()=>{isNil$4(a.current)||(o(a.current),a.current=null)},children:jsxs("div",{className:"duchamp-mobile-page-popup",children:[jsx("div",{className:"page-popup-header",children:i("Duchamp-Directory")}),jsx("div",{className:"page-popup-body",children:r.map(((e,r)=>jsxs("div",{className:classNames$1("page-popup-item",{"page-popup-active-item":r===t-1}),onClick:()=>(e=>{a.current=e,n()})(r),children:[jsx(Ellipsis,{className:"page-cut-text",content:e}),jsx(Icon,{className:"page-cut-icon",name:"fdm-select",size:16})]},r)))})]})})};var __defProp$j=Object.defineProperty,__getOwnPropDesc$i=Object.getOwnPropertyDescriptor,__decorateClass$i=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$i(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$j(t,r,i),i};const PAGINATION_BUTTON_WEIGHT=2,getThemeDisabledColor=e=>"rgba(255, 255, 255, ".concat(e?.4:1,")");class PageButton{constructor(e){__publicField(this,"store"),__publicField(this,"popupVisible",!1),makeObservable(this),this.store=e}get meta(){return{name:TOOLBAR_NAME.PAGE,weight:PAGINATION_BUTTON_WEIGHT,text:duchampIntl.get("Duchamp-Main_Story"),icon:jsx(PaginationTool,{...this.iconProps}),popup:jsx(PagePopup,{...this.popupProps},TOOLBAR_NAME.PAGE),type:TOOLBAR_BUTTON_TYPE$1.STORY}}setPopupVisible(e){this.popupVisible=e}get visible(){const{previewConfig:e,previewStories:t}=this.store;return t.length>1&&"always"===e.pageButtonDisplayPolicy}get iconProps(){const{previewConfig:e,previewStories:t,currentPreviewStoryIndex:r}=this.store,n=e.loop||r>0,o=e.loop||r<t.length-1;return{value:r+1,total:t.length,preDisabled:!n,nextDisabled:!o,onPre:()=>this.store.previewPreviousStory(),onNext:()=>this.store.previewNextStory(),onPage:()=>this.setPopupVisible(!0)}}get popupProps(){const{previewStories:e}=this.store;return{visible:this.popupVisible,names:e.map((e=>e.name)),value:this.iconProps.value,onClose:()=>this.setPopupVisible(!1),onChange:e=>this.store.previewSwitchStory(e)}}get buttonsProps(){const{value:e,total:t,preDisabled:r,nextDisabled:n,onPage:o,onPre:i,onNext:a}=this.iconProps;return[{name:"previous-page",icon:"fdm-previous-page",color:getThemeDisabledColor(r),onClick:i},{name:"page-num",text:"".concat(e,"/").concat(t),onClick:o},{name:"next-page",icon:"fdm-next-page",color:getThemeDisabledColor(n),onClick:a}]}}__decorateClass$i([computed],PageButton.prototype,"meta",1),__decorateClass$i([observable],PageButton.prototype,"popupVisible",2),__decorateClass$i([action$1],PageButton.prototype,"setPopupVisible",1),__decorateClass$i([computed],PageButton.prototype,"visible",1),__decorateClass$i([computed],PageButton.prototype,"iconProps",1),__decorateClass$i([computed],PageButton.prototype,"popupProps",1);var __defProp$i=Object.defineProperty,__getOwnPropDesc$h=Object.getOwnPropertyDescriptor,__decorateClass$h=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$h(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$i(t,r,i),i};class RefreshButton{constructor(){__publicField(this,"meta",{name:TOOLBAR_NAME.REFRESH,weight:BASE_BUTTON_WEIGHT,text:duchampIntl.get("Duchamp-Refresh"),icon:jsx(Icon$1,{name:"fdm-refresh",size:28}),type:TOOLBAR_BUTTON_TYPE$1.TEMPLATE}),makeObservable(this)}get visible(){return!!platformConfig.showRefreshButton}get onClick(){return()=>window.location.reload()}}__decorateClass$h([computed],RefreshButton.prototype,"visible");var __defProp$h=Object.defineProperty,__getOwnPropDesc$g=Object.getOwnPropertyDescriptor,__decorateClass$g=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$g(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$h(t,r,i),i};class LinkageButton{constructor(e){__publicField(this,"store"),makeObservable(this),this.store=e}get meta(){return{name:"linkage",weight:BASE_BUTTON_WEIGHT,text:duchampIntl.get("Duchamp-Linkage_Clear"),icon:jsx(Icon$1,{name:"fdm-clear-linkage",size:28}),type:TOOLBAR_BUTTON_TYPE$1.TEMPLATE}}get visible(){return this.store.hasLinkage}get onClick(){return()=>{this.store.clearAllLinkage()}}}__decorateClass$g([computed],LinkageButton.prototype,"visible");var __defProp$g=Object.defineProperty,__getOwnPropDesc$f=Object.getOwnPropertyDescriptor,__decorateClass$f=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$f(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$g(t,r,i),i};const TOOLBAR_MAX_WEIGHT=6,TOOLBAR_MAX_COUNT=4,TOOLBAR_FLOAT_SIZE=40,DEFAULT_STORY_BUTTONS=2;class ToolbarModel{constructor(e){__publicField(this,"store"),__publicField(this,"toolbarButtons",new Map),makeObservable(this),this.store=e,this.init(),this.add(TOOLBAR_NAME.PAGE,new PageButton(e)),this.add(TOOLBAR_NAME.NAVIGATOR,new NavigatorButton(e)),this.add(TOOLBAR_NAME.FILTER,new FilterButton(e)),this.add(TOOLBAR_NAME.REFRESH,new RefreshButton),this.add(TOOLBAR_NAME.COLLECT,new CollectButton),this.add(TOOLBAR_NAME.MARK,new MarkButton),this.add(TOOLBAR_NAME.LINKAGE,new LinkageButton(e))}get type(){return isFineNativeEnv()?MOBILE_TOOLBAR_TYPE.DEFAULT:this.store.platform.mobile.toolbarType}get bottomToolbarConfig(){return{type:MOBILE_TOOLBAR_TYPE.DEFAULT,totalWeight:TOOLBAR_MAX_WEIGHT}}get floatToolbarConfig(){return{type:MOBILE_TOOLBAR_TYPE.FLOAT,size:TOOLBAR_FLOAT_SIZE,maxExpandCountPerRow:this.store.platform.mobile.isLandscape?TOOLBAR_MAX_COUNT:0,maxFoldCount:this.flatMapButtons.length>TOOLBAR_MAX_COUNT?1:void 0,style:{color:"#FFF"}}}get toolbarConfig(){return this.type===MOBILE_TOOLBAR_TYPE.DEFAULT?this.bottomToolbarConfig:this.floatToolbarConfig}async init(){await(null==jsBridge?void 0:jsBridge.getToolbarConfig())}add(e,t){this.toolbarButtons.set(e,t)}get visible(){const e=getParamInURL(MOBILE_UNIQUE_PARAMS.FINE_WEBVIEW),t=getParamInURL(MOBILE_UNIQUE_PARAMS.FINE_TOOLBAR_TYPE);return"true"!==e&&t!==FINE_TOOLBAR_TYPE.NONE&&!(null==jsBridge?void 0:jsBridge.isSharing)&&!!this.buttons.length}get storyButtons(){return this.buttons.filter((e=>e.meta.type===TOOLBAR_BUTTON_TYPE$1.STORY))}get templateButtons(){return this.buttons.filter((e=>e.meta.type===TOOLBAR_BUTTON_TYPE$1.TEMPLATE))}get showDivider(){return this.storyButtons.length===DEFAULT_STORY_BUTTONS&&this.templateButtons.length}get buttons(){return Array.from(this.toolbarButtons.values()).filter((e=>e.visible))}get flatMapButtons(){return this.buttons.map((({meta:{name:e,icon:t},buttonsProps:r,onClick:n})=>r?r.map((e=>jsx(Toolbar$2.Item,{...e},e.name))):jsx(Toolbar$2.Item,{name:e,icon:t,onClick:n},e))).flat(1/0)}getButton(e){return this.toolbarButtons.get(e)}renderButtons(){return this.type===MOBILE_TOOLBAR_TYPE.DEFAULT?this.buttons.map((({meta:{name:e,weight:t,text:r,icon:n,className:o,clickAfterAnimation:i},onClick:a})=>jsx(Toolbar$2.Item,{className:this.showDivider?o:"",name:e,text:r,weight:t,icon:n,onClick:a,clickAfterAnimation:i},e))):this.flatMapButtons}renderPopups(){return this.buttons.map((({meta:{name:e,popup:t}})=>t||jsx(reactExports.Fragment,{},e)))}}__decorateClass$f([action$1],ToolbarModel.prototype,"add"),__decorateClass$f([computed],ToolbarModel.prototype,"visible"),__decorateClass$f([computed],ToolbarModel.prototype,"showDivider"),__decorateClass$f([computed],ToolbarModel.prototype,"buttons"),__decorateClass$f([computed],ToolbarModel.prototype,"flatMapButtons");var __defProp$f=Object.defineProperty,__getOwnPropDesc$e=Object.getOwnPropertyDescriptor,__decorateClass$e=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$e(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$f(t,r,i),i};const TOP_CONTROLLER_HEIGHT=45;class MobileToolHeight{constructor(){__publicField(this,"toolbarHeight",0),__publicField(this,"topControllerPanelHeight",0),makeObservable(this)}get allHeight(){return this.toolbarHeight+this.topControllerPanelHeight}setTopControllerPanelHeight(){this.topControllerPanelHeight=TOP_CONTROLLER_HEIGHT}setHeight(e){this.toolbarHeight!==e&&(this.toolbarHeight=e)}}__decorateClass$e([observable],MobileToolHeight.prototype,"toolbarHeight",2),__decorateClass$e([observable],MobileToolHeight.prototype,"topControllerPanelHeight",2),__decorateClass$e([computed],MobileToolHeight.prototype,"allHeight",1),__decorateClass$e([action$1],MobileToolHeight.prototype,"setTopControllerPanelHeight",1),__decorateClass$e([action$1],MobileToolHeight.prototype,"setHeight",1);class DuchampNavigation{constructor(e){__publicField(this,"store"),__publicField(this,"widget",null),__publicField(this,"scrollbarCanvasEl",null),__publicField(this,"mainCanvasEl",null),this.store=e}setWidget(e){this.widget=e}setEl(e,t){this.scrollbarCanvasEl=e,this.mainCanvasEl=t}get previewScale(){return this.store.platform.mobile.previewScale}get stickyWidgets(){return this.store.story.stickyWidgets}get isTemplateFluidOrMagnetic(){const{isMagneticLayout:e,platform:t}=this.store;return e||isFluidLayout(t.mobile.layoutConfig)}get widgetTop(){if(!this.mainCanvasEl||!this.widget)return 0;if(this.widget.target){return getDistanceBetweenDoms(this.mainCanvasEl,this.widget.target)}return this.widget.rect.top*this.previewScale}get stickyWidgetHeight(){var e,t,r,n,o,i,a;if(!this.widget||isEmpty$3(this.stickyWidgets)||!this.scrollbarCanvasEl||!this.mainCanvasEl)return 0;if(!this.isTemplateFluidOrMagnetic){const i=this.widget.parentContainerWidgets.length?null!=(r=null==(t=null==(e=this.widget.target)?void 0:e.getBoundingClientRect())?void 0:t.top)?r:0:round$3(this.widget.rect.top*this.previewScale),a=this.stickyWidgets.reduce(((e,t)=>{const r=t.rect.top*this.previewScale;return round$3(r)<i&&e.push({top:r,height:t.rect.height*this.previewScale}),e}),[]);return null!=(o=null==(n=maxBy$1(a,"top"))?void 0:n.height)?o:0}if(!this.widget.target)return 0;const s=round$3(getDistanceBetweenDoms(this.mainCanvasEl,this.widget.target)),l=this.stickyWidgets.reduce(((e,t)=>{var r;const n=t.getInstance();if(!isSticky(n))return e;const{height:o}=(null==(r=t.target)?void 0:r.getBoundingClientRect())||{height:0},i=getDistanceBetweenDoms(this.mainCanvasEl,n.placeholderRef.current);return round$3(i)<s&&e.push({top:i,height:o}),e}),[]);return null!=(a=null==(i=maxBy$1(l,"top"))?void 0:i.height)?a:0}scrollTo(){this.scrollbarCanvasEl&&this.widget&&this.scrollbarCanvasEl.scrollTo({left:0,top:this.widgetTop-this.stickyWidgetHeight,behavior:"smooth"})}}var __defProp$e=Object.defineProperty,__getOwnPropDesc$d=Object.getOwnPropertyDescriptor,__decorateClass$d=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$d(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$e(t,r,i),i};const DEFAULT_MOBILE_SIZE={width:390,height:844};class MobileStoreAdaptor extends MobileAdaptor{constructor(e){super(e),__publicField(this,"toolHeightManager",new MobileToolHeight),__publicField(this,"toolbarModel",new ToolbarModel(this.model)),__publicField(this,"duchampNavigation",new DuchampNavigation(this.model)),__publicField(this,"previewScale",1),__publicField(this,"isLandscape",!1),__publicField(this,"autoGroupPopoverStatus","show"),__publicField(this,"screenSize",{width:window.innerWidth,height:window.innerHeight}),__publicField(this,"scaleValue",1),__publicField(this,"isAutoScaleValue",!0),makeObservable(this)}setIsLandScape(e){this.isLandscape=e}setAutoGroupPopoverStatus(e){this.autoGroupPopoverStatus=e}setPreviewScale(e){this.previewScale=e}setScreenSize(e,t){this.screenSize={width:e,height:t}}get scale(){return this.model.isMagneticLayout?this.scaleValue:this.model.scale}setScale(e){if(!this.model.isMagneticLayout)return this.model.setScale(e);this.scaleValue=Math.min(Math.max(floor$2(e,2),DESIGNER.ZOOM.min/100),DESIGNER.ZOOM.max/100)}get isAutoScale(){return this.model.isMagneticLayout?this.isAutoScaleValue:this.model.isAutoScale}setIsAutoScale(e){if(!this.model.isMagneticLayout)return this.model.setIsAutoScale(e);this.isAutoScaleValue=e}get width(){var e;return this.model.isMagneticLayout?null!=(e=this.mobile.width)?e:DEFAULT_MOBILE_SIZE.width:this.model.width}get height(){var e;return this.model.isMagneticLayout?null!=(e=this.mobile.height)?e:DEFAULT_MOBILE_SIZE.height:this.model.height}setSize(e,t){if(e!==this.width||t!==this.height)return this.model.isMagneticLayout?void this.model.undoManager.withGroup((()=>{const r=this.width;this.update({width:e,height:t}),this.model.totalStories.forEach((e=>{const{magneticOptions:t}=e.platform.mobile;e.platform.mobile.updateMagneticOptions({options:t,preOptions:{...t,width:r},keepRatio:this.keepRatio})}))})):this.model.setSize(e,t)}get keepRatio(){var e;return this.model.isMagneticLayout?null==(e=this.mobile.keepRatio)||e:this.model.keepRatio}setKeepRatio(e){if(!this.model.isMagneticLayout)return this.model.setKeepRatio(e);this.update({keepRatio:e})}get showAlignmentLine(){var e;return this.model.isMagneticLayout?null==(e=this.mobile.showAlignmentLine)||e:this.model.showAlignmentLine}setShowAlignmentLine(e){if(!this.model.isMagneticLayout)return this.model.setShowAlignmentLine(e);this.update({showAlignmentLine:e})}get layoutConfig(){return this.mobile.layoutConfig||DEFAULT_MOBILE_LAYOUT_CONFIG}setLayoutConfig(e){this.update({layoutConfig:e})}get toolbarType(){return this.mobile.toolbarType||MOBILE_TOOLBAR_TYPE.DEFAULT}setToolbarType(e){this.update({toolbarType:e})}get mobileConfig(){return{layoutConfig:this.layoutConfig,toolbarType:this.toolbarType}}setMobileConfig(e){this.update(e)}get previewLayout(){const{pad:e,phone:t}=this.layoutConfig;return isPad()?e.layout:t.layout}get isPreviewMagneticLayout(){return this.previewLayout===LAYOUT_TYPE$2.MAGNETIC}get isOpenMobileLayout(){return this.layoutConfig.phone.layout===LAYOUT_TYPE$2.MAGNETIC}get isFluidToMagneticLayout(){if(!this.model.isMagneticLayout)return!1;const{pad:e,phone:t}=this.model.mobileConfig||{};return this.model.isPreview?isPad()?(null==e?void 0:e.layout)===LAYOUT_TYPE$2.FLUID:(null==t?void 0:t.layout)===LAYOUT_TYPE$2.FLUID:(null==e?void 0:e.layout)===LAYOUT_TYPE$2.FLUID||(null==t?void 0:t.layout)===LAYOUT_TYPE$2.FLUID}get isTopControlPanel(){var e;return this.model.isControllerPanelEnabled&&(null==(e=this.model.controllerPanel.mobile)?void 0:e.styleType)===CONTROLLER_PANEL_MOBILE_STYLE_TYPE.TOP}changeOriginalSize(){isNil$3(this.mobile.width)&&this.model.width<this.model.height&&this.update({width:this.model.width,height:this.model.height})}initMagneticLayout(){this.model.undoManager.withoutUndo((()=>{this.changeOriginalSize(),this.model.totalStories.forEach((e=>{e.platform.mobile.transferMagneticLayout(!0)}))}))}}__decorateClass$d([observable],MobileStoreAdaptor.prototype,"previewScale",2),__decorateClass$d([observable],MobileStoreAdaptor.prototype,"isLandscape",2),__decorateClass$d([observable],MobileStoreAdaptor.prototype,"autoGroupPopoverStatus",2),__decorateClass$d([action$1],MobileStoreAdaptor.prototype,"setIsLandScape",1),__decorateClass$d([action$1],MobileStoreAdaptor.prototype,"setAutoGroupPopoverStatus",1),__decorateClass$d([action$1],MobileStoreAdaptor.prototype,"setPreviewScale",1),__decorateClass$d([observable.ref],MobileStoreAdaptor.prototype,"screenSize",2),__decorateClass$d([observable],MobileStoreAdaptor.prototype,"scaleValue",2),__decorateClass$d([action$1],MobileStoreAdaptor.prototype,"setScreenSize",1),__decorateClass$d([computed],MobileStoreAdaptor.prototype,"scale",1),__decorateClass$d([action$1],MobileStoreAdaptor.prototype,"setScale",1),__decorateClass$d([observable],MobileStoreAdaptor.prototype,"isAutoScaleValue",2),__decorateClass$d([action$1],MobileStoreAdaptor.prototype,"setIsAutoScale",1),__decorateClass$d([computed],MobileStoreAdaptor.prototype,"width",1),__decorateClass$d([computed],MobileStoreAdaptor.prototype,"height",1),__decorateClass$d([action$1],MobileStoreAdaptor.prototype,"setSize",1),__decorateClass$d([computed],MobileStoreAdaptor.prototype,"keepRatio",1),__decorateClass$d([action$1],MobileStoreAdaptor.prototype,"setKeepRatio",1),__decorateClass$d([computed],MobileStoreAdaptor.prototype,"showAlignmentLine",1),__decorateClass$d([action$1],MobileStoreAdaptor.prototype,"setShowAlignmentLine",1),__decorateClass$d([computed],MobileStoreAdaptor.prototype,"layoutConfig",1),__decorateClass$d([action$1],MobileStoreAdaptor.prototype,"setLayoutConfig",1),__decorateClass$d([computed],MobileStoreAdaptor.prototype,"toolbarType",1),__decorateClass$d([action$1],MobileStoreAdaptor.prototype,"setToolbarType",1),__decorateClass$d([computed],MobileStoreAdaptor.prototype,"mobileConfig",1),__decorateClass$d([computed],MobileStoreAdaptor.prototype,"previewLayout",1),__decorateClass$d([computed],MobileStoreAdaptor.prototype,"isPreviewMagneticLayout",1),__decorateClass$d([computed],MobileStoreAdaptor.prototype,"isOpenMobileLayout",1),__decorateClass$d([computed],MobileStoreAdaptor.prototype,"isTopControlPanel",1);class BaseBackground{constructor(e){__publicField(this,"store"),__publicField(this,"defaultValue"),this.store=e}configRender(e){throw new Error("Method not implemented.")}render(e){throw new Error("Method not implemented.")}floatRender(e){return null}async onCopy(e,t){return null}async onPaste(e){}}__publicField(BaseBackground,"meta");class ColorBackground extends BaseBackground{constructor(){super(...arguments),__publicField(this,"defaultValue",DEFAULT_BACKGROUND_COLOR)}configRender(e){return jsx(LineItem,{label:"",children:jsx(ThemeColorPicker,{value:e.value,onChange:t=>{e.onChange(t)}})})}render(e){return colorBackground.render({...e,resourceCenter:this.store.resourceCenter,urlParser:e=>createResourceURL(e,this.store.duchampServer.resourceBaseUrl)})}blurryLayer(e){return colorBackground.blurryLayer({value:e})}}function updateImageInfo(e,t){const{imageSource:r,imageSlice:n}=t,o=r&&n&&n.length>0;return{...e,...t,hue:0,saturation:0,contrast:0,brightness:0,backgroundFillType:BACKGROUND_FILL_TYPE.AUTO,fillType:o?FILL_TYPE.BORDER:FILL_TYPE.BACKGROUND}}function isMatchedScope(e,t){return!t||"*"===t||t.includes(e)}function backgroundData2WidgetResourceType(e){if(e.type===BACKGROUND_TYPE$1.EMPTY)return{type:BACKGROUND_TYPE$1.EMPTY};if(e.type===BACKGROUND_TYPE$1.INTERNAL){const t=e.value;return{type:BACKGROUND_TYPE$1.INTERNAL,value:(null==t?void 0:t.id)||""}}if(e.type===BACKGROUND_TYPE$1.COLOR){const t=e.value;return{type:BACKGROUND_TYPE$1.COLOR,value:t}}if(e.type===BACKGROUND_TYPE$1.CUSTOM){const t=e.value;return{type:BACKGROUND_TYPE$1.CUSTOM,value:(null==t?void 0:t.id)||""}}return e}__publicField(ColorBackground,"meta",{type:BACKGROUND_TYPE$1.COLOR,name:duchampIntl.get("Duchamp-Colour")});class ImageBackground extends BaseBackground{constructor(){super(...arguments),__publicField(this,"defaultValue",{id:"",hue:0,saturation:0,brightness:0,contrast:0,borderScale:1,backgroundFillType:BACKGROUND_FILL_TYPE.AUTO,fillType:FILL_TYPE.BACKGROUND})}render(e){return imageBackground.render({...e,resourceCenter:this.store.resourceCenter,urlParser:e=>createResourceURL(e,this.store.duchampServer.resourceBaseUrl)})}blurryLayer(e){return imageBackground.blurryLayer({value:e,resourceCenter:this.store.resourceCenter,urlParser:e=>createResourceURL(e,this.store.duchampServer.resourceBaseUrl)})}preload(e){return imageBackground.preload({value:e,resourceCenter:this.store.resourceCenter})}async onCopy(e){return{resources:{files:[e.id]}}}}const FillTypeConfig=observer((({value:e,onChange:t})=>{const{resourceCenter:r}=useStore(),{fillType:n,backgroundFillType:o,borderScale:i}=e,{imageSource:a,imageSlice:s}=getImageResourceById(r,e.id),l=!!a,c=l&&s.length>0;return jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,hide:!l,children:[jsx(LineItem,{label:"",hide:!c,children:jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Filling_Method"),children:jsx(RadioGroup$1,{className:"fill-type",options:FILL_TYPE_ITEMS,value:n,onChange:r=>t({...e,fillType:r})})})}),jsx(LineItem,{label:"",hide:c,children:jsx(VerticalItem$1,{label:duchampIntl.get("Duchamp-Filling_Method"),children:jsx(RadioGroup$1,{className:"background-fill-type",options:BACKGROUND_FILL_TYPE_ITEMS,value:o,onChange:r=>t({...e,backgroundFillType:r})})})}),jsx(LineItem,{label:"",hide:!(c&&n===FILL_TYPE.BACKGROUND),children:jsx(RadioGroup$1,{className:"background-fill-type",options:BACKGROUND_FILL_TYPE_ITEMS,value:o,onChange:r=>t({...e,backgroundFillType:r})})}),jsx(LineItem,{label:"",hide:!(c&&n===FILL_TYPE.BORDER),children:jsx(RadioGroup$1,{className:"border-image-scale",options:BORDER_SCALE_ITEMS,value:i,onChange:r=>t({...e,borderScale:r})})})]})})),ImagePropsConfig=observer((({value:e,onChange:t})=>{const{resourceCenter:r}=useStore(),{imageSource:n}=getImageResourceById(r,e.id);return jsxs(Fragment,{children:[jsx(FillTypeConfig,{value:e,onChange:r=>{t({...e,...r})}}),jsx(LineItem,{label:"",hide:!n,children:jsx(FilterProcessPanel,{hue:e.hue,contrast:e.contrast,saturation:e.saturation,brightness:e.brightness,onChange:r=>{t({...e,...r})},layout:"vertical"})})]})})),CustomBackgroundConfig=observer((e=>{const{value:t,onChange:r,scopeConfig:n}=e,{resourceCenter:o}=useStore();return jsxs(GridItem,{gapSize:GAP_SIZE.MIDDLE,children:[jsx(LineItem,{label:"",children:n?jsx(DuchampCustomImageResource,{...n,value:t.id,onChange:e=>{r(updateImageInfo(t,{imageSource:o.getResourceURL(e),imageSlice:getImageSlice(e),id:e.id}))}}):null}),jsx(ImagePropsConfig,{value:t,onChange:r})]})}));class CustomBackground extends ImageBackground{configRender(e){return jsx(CustomBackgroundConfig,{...e})}}__publicField(CustomBackground,"meta",{type:BACKGROUND_TYPE$1.CUSTOM,name:duchampIntl.get("Duchamp-Custom_Upload")});class EmptyBackground extends BaseBackground{constructor(){super(...arguments),__publicField(this,"defaultValue")}configRender(){return null}render(e){return emptyBackground.render({...e,resourceCenter:this.store.resourceCenter,urlParser:e=>createResourceURL(e,this.store.duchampServer.resourceBaseUrl)})}}__publicField(EmptyBackground,"meta",{type:BACKGROUND_TYPE$1.EMPTY,name:duchampIntl.get("Duchamp-Without")});class InternalBackground extends ImageBackground{configRender(e){const{value:t,onChange:r,scopeConfig:n}=e;return jsxs(GridItem,{gapSize:GAP_SIZE.MIDDLE,children:[jsx(LineItem,{label:"",children:jsx(DuchampInternalImageResource,{...n,value:t.id,onChange:e=>{r(updateImageInfo(t,{imageSource:this.store.resourceCenter.getResourceURL(e),imageSlice:getImageSlice(e),id:e.id}))}})}),jsx(ImagePropsConfig,{value:t,onChange:r})]})}}function isBlurryLayerAble(e){return isFunction$8(e.blurryLayer)}function isPreloadAble(e){return isFunction$8(e.preload)}function filterOptions(e,t){var r,n;const o=t.options,i=t.getModels(o),a=[],s=(e,t)=>{null==e||e.forEach((e=>{const r=t.find((t=>t.id===e.id));r&&a.push(r),s(e.children,t)}))};e.models&&s(i,e.models);const l=t.getDataLayers(o),c=null==(r=e.dataLayers)?void 0:r.filter((e=>l.some((t=>t.id===e.id)))),u=t.getOptionAnimations(o),d=null==(n=e.animations)?void 0:n.filter((e=>u.some((t=>t.uuid===e.uuid))));return{...e,models:a,dataLayers:c,animations:d}}function getMergeOptionsValue(e,t,r){var n;return{...e,widgets:{[t]:{...null==e?void 0:e.widgets[t],options:{...null==(n=null==e?void 0:e.widgets[t])?void 0:n.options,...r}}}}}function updateList(e,t,r="id"){const n=[...e],o=n.findIndex((e=>e[r]===t[r]));return o>-1?n.splice(o,1,t):n.push(t),n}__publicField(InternalBackground,"meta",{type:BACKGROUND_TYPE$1.INTERNAL,name:duchampIntl.get("Duchamp-Resource_Center")});const AnimationList=observer((({widgetModel:e,animations:t,onChange:r})=>jsx("div",{className:"animations list",children:e.getOptionAnimations().map((e=>{var n,o,i,a;return jsx(Checkbox$4,{className:"animations-item",ellipsis:!0,text:null!=(n=e.name)?n:e.id,value:null!=(i=null==(o=t.find((t=>t.uuid===e.uuid)))?void 0:o.enabled)?i:DEFAULT_CONFIG.ANIMATION_ENABLED,onChange:n=>{r(updateList(t,{uuid:e.uuid,id:e.id,enabled:n},"uuid"))},children:jsx(EllipsisText,{text:null!=(a=e.name)?a:e.id})},e.uuid)}))}))),DataLayerItem=observer((({layer:e,configLayer:t,onChange:r})=>{const n={id:e.id,visible:DEFAULT_CONFIG.LAYER_VISIBLE,...t};return jsx("div",{className:classNames$1("data-layer-item",{"layer-visible":n.visible}),children:jsx("div",{className:"flex-center-space-between layer-header",children:jsx(Checkbox$4,{ellipsis:!0,text:e.name,value:n.visible,onChange:e=>{r({...n,visible:e})},className:"layer-header-checkbox",children:jsx(EllipsisText,{text:e.name})})},e.id)})})),DATA_LAYER_MAP=[[DATA_LAYER_TYPE.Point,duchampIntl.get("Duchamp-Point")],[DATA_LAYER_TYPE.Line,duchampIntl.get("Duchamp-Line")],[DATA_LAYER_TYPE.Cylinder,duchampIntl.get("Duchamp-Cylinder")],[DATA_LAYER_TYPE.Model,duchampIntl.get("Duchamp-Model")]],{Item:Item$1}=Tab$1,DataLayerPane=observer((({configLayers:e,widgetModel:t,onChange:r})=>{const n=t.getDataLayers();return jsx("div",{className:"data-layer-pane",children:jsx(Tab$1,{defaultActiveKey:DATA_LAYER_TYPE.Point,stretch:!0,theme:"line",children:DATA_LAYER_MAP.map((([o,i])=>{const a=n.filter((e=>e.type===o));return a.length>0?jsx(Item$1,{tab:i,tabStyle:{maxWidth:"25%"},children:jsx("div",{className:"list",children:a.map((n=>jsx(DataLayerItem,{model:t,configLayer:e.find((e=>e.id===n.id)),layer:n,onChange:t=>{r(updateList(e,t))}},n.id)))})},o):null}))})})})),EnvSettingListPane=({currentEnvSettingId:e,envSettings:t=[],onChange:r})=>{const n=e&&!t.find((t=>t.id===e));return jsxs(Fragment,{children:[jsxs("div",{className:"calder-config-envsettings-header",children:[jsx("div",{className:"title",children:duchampIntl.get("Duchamp-Current_Environmet_Style")}),n&&jsx("div",{className:"select-error",children:duchampIntl.get("Duchamp-Original_Selected_Object_Has_Been_Deleted")})]}),jsx("div",{className:"calder-config-envsettings",children:jsx(Radio$4.Group,{value:e,onChange:r,children:t.map((e=>jsx(Radio$4,{value:e.id,className:"item",children:e.name},e.id)))})})]})},ModelTreeList=observer((({widgetModel:e,config:t,onChange:r})=>{const n=e.getModelsTreeData();return jsx(TreePanel,{className:"list models",selectable:!1,treeData:n,onVisibleChange:({key:e},n)=>{r(updateList(t,{id:e,invisible:!n}))}})})),ModelTree=observer((({widgetModel:e,config:t,onChange:r})=>jsxs(Fragment,{children:[jsx(ModelTreeList,{widgetModel:e,config:t,onChange:r}),jsx(Tooltip$1,{placement:"top",content:duchampIntl.get("Duchamp-3d_Background_Show_Or_Hide_Settings_Tip"),arrow:{pointAtCenter:!0},effect:"light",children:jsx(Button$4,{onClick:t=>{try{const t=e.getModels(e.config.options),n=[],o=(e,t)=>{null==e||e.forEach((e=>{e.invisible&&n.push({id:e.id,invisible:!0}),o(e.children,t)}))};o(t,n),r(n),Message.success(duchampIntl.get("Duchamp-Get_Success"))}catch(n){Message.error(duchampIntl.get("Duchamp-Get_Failed"))}t.currentTarget.blur()},children:duchampIntl.get("Duchamp-3d_Background_Show_Or_Hide_Settings")})})]}))),PerspectivePane=observer((({currentPerspective:e,publicPerspectiveOptions:t=[],onChange:r})=>{const[n,o]=reactExports.useState(!1);return jsxs("div",{className:"calder-config-perspective",children:[jsxs("div",{className:"title",children:[duchampIntl.get("Duchamp-Current_Perspective"),t.length>0&&jsx(Popover$3,{visible:n,trigger:"click",content:jsx(Menu,{items:t.map((e=>({label:e.name,onClick:()=>{const t={position:[...e.position],target:[...e.target]};r(t),o(!1)}}))),onAfterSelect:()=>{o(!1)},"data-focus-point":{id:"S316",trigger:"onAfterSelect"}}),onVisibleChange:o,style:{width:132},arrow:!1,hasPadding:!1,placement:"bottom-left",children:jsx("div",{className:"popover",children:duchampIntl.get("Duchamp-Import_Public_Perspective")})})]}),jsx(PerspectiveInputGroup,{pasteActionEnabled:!1,value:e,onChange:e=>{e&&(null==r||r(e))}})]})})),{Item:Item}=Tab$1,CalderConfig=observer((({widget:e,options:t,onChange:r})=>{const n=e.getInstance(),{animations:o=[],models:i=[],dataLayers:a=[]}=t||{};if(!n.options)return null;const s=a.length>0&&a.find((e=>e.visible&&!n.getDataLayers().find((t=>t.id===e.id)))),l=o.length>0&&o.find((e=>e.enabled&&!n.getOptionAnimations().find((t=>t.uuid===e.uuid))));return jsx(Spin$1,{wrapperClassName:"duchamp-config-spin",containerClassName:"duchamp-config-spin-container",loading:e.busying,delay:300,children:jsxs(Tab$1,{defaultActiveKey:"1",stretch:!0,className:"story-calder-config",theme:"line",children:[jsxs(Item,{tab:duchampIntl.get("Duchamp-Scenes"),className:"calder-config-content",children:[jsx(PerspectivePane,{currentPerspective:n.cameraState,publicPerspectiveOptions:n.calder.getSharedCameraStateList(),onChange:e=>{n.calder.setCameraState(e,0),null==r||r({...t,cameraState:e})}}),jsx(EnvSettingListPane,{currentEnvSettingId:(null==t?void 0:t.envSettingId)||n.calder.getCurrentEnvSettingId(),envSettings:n.calder.getEnvSettings(),onChange:e=>{null==r||r({...t,envSettingId:e})}})]},"1"),jsxs(Item,{tab:duchampIntl.get("Duchamp-Data"),className:"calder-config-content",children:[jsxs("div",{className:"calder-config-data-header",children:[jsx("div",{className:"title",children:duchampIntl.get("Duchamp-Apply_Data_Layer_List")}),s&&jsx("div",{className:"select-error",children:duchampIntl.get("Duchamp-Original_Selected_Object_Has_Been_Deleted")})]}),jsx(DataLayerPane,{configLayers:a,widgetModel:n,onChange:e=>{r({...t,dataLayers:e})}})]},"2"),jsx(Item,{tab:duchampIntl.get("Duchamp-Model"),className:"calder-config-content",children:jsxs(Tab$1,{defaultActiveKey:"1",stretch:!0,className:"story-calder-config",theme:"card",tabHeaderStyle:{height:"24px",marginTop:"4px"},children:[jsxs(Item,{tab:duchampIntl.get("Duchamp-Model"),className:"calder-config-content",children:[jsx("div",{className:"title",children:duchampIntl.get("Duchamp-Show_Hide_Model_List")}),jsx(ModelTree,{widgetModel:n,config:i,onChange:e=>{r({...t,models:e})}})]},"1"),jsxs(Item,{tab:duchampIntl.get("Duchamp-Animation"),className:"calder-config-content",children:[jsxs("div",{className:"calder-config-animation-header",children:[jsx("div",{className:"title",children:duchampIntl.get("Duchamp-Apply_Model_Animation_List")}),l&&jsx("div",{className:"select-error",children:duchampIntl.get("Duchamp-Original_Selected_Object_Has_Been_Deleted")})]}),jsx(AnimationList,{widgetModel:n,animations:o,onChange:e=>{r({...t,animations:e})}})]},"2")]})},"3")]})})})),ExactingBackgroundSelector=observer((({value:e,onChange:t,backgroundStoryIdExact:r})=>{const n=useStore(),o=e?r?e.id:duchampIntl.get("Duchamp-Deleted"):void 0;return jsx(LineItem,{label:"",children:jsx(Select$1,{className:classNames$1("existing-background-story-select",{delete:o===duchampIntl.get("Duchamp-Deleted")}),value:o,placeholder:duchampIntl.get("Duchamp-Please_Choose"),notFoundContent:jsx(Result,{description:duchampIntl.get("Duchamp-Currently_Available_3d_Backgrounds_Are_Empty")}),onChange:e=>{t({id:e,widgets:{}})},children:n.backgroundStories.map((e=>jsx(Select$1.Option,{text:e.name,value:e.id,children:e.name},e.id)))})})})),BackgroundStoryConfig=observer((({value:e,onChange:t,resource:r})=>{var n,o;const i=useStore(),a=useLatest$3(e),s=i.backgroundStories.find((t=>t.id===(null==e?void 0:e.id))),l=e=>{i.undoManager.withGroup((()=>{t(e),i.storyApplyBackgroundStory(i.story.id,e)}))};if(isNull$1(e)||!s)return jsxs("div",{className:"story-background-config",children:[jsx(ExactingBackgroundSelector,{onChange:l,value:e,backgroundStoryIdExact:!1}),jsxs("div",{className:"info",children:[jsx("div",{className:"title",children:duchampIntl.get("Duchamp-3d_Background")}),jsxs("div",{className:"desc",children:[duchampIntl.get("Duchamp-Background_Story_Set_Desc"),jsx(Typography.Link,{href:duchampIntl.get("Duchamp-Background_Story_Desc_Href"),target:"_blank",children:duchampIntl.get("Duchamp-View_Help_Doc")})]}),jsx(Divider,{className:"info-divider"}),jsx(Button$4,{block:!0,type:"text",onClick:()=>{i.undoManager.withGroup((()=>{const e=i.createBackgroundStory();l({id:e.id,widgets:{}})}))},children:duchampIntl.get("Duchamp-Add_3d_Background")})]})]});const c=first(s.widgets),u=null==c?void 0:c.getInstance(),d=(e=!0)=>{(null==u?void 0:u.options)?r.setFloat(u.id,e):Alert$2.error({title:duchampIntl.get("Duchamp-Can_Not_Set_Current_Effect"),content:duchampIntl.get("Duchamp-Can_Not_Set_3d_Background_Tip")})};return jsxs("div",{className:"story-background-config",children:[jsx(ExactingBackgroundSelector,{onChange:l,value:e,backgroundStoryIdExact:!0}),jsxs("div",{className:"info",children:[jsx("div",{className:"title",children:duchampIntl.get("Duchamp-3d_Background")}),jsx("div",{className:"desc",children:duchampIntl.get("Duchamp-Background_Story_Already_Set_Desc",s.name)}),jsx(Divider,{className:"info-divider"}),jsx(Button$4,{block:!0,type:"text",onClick:()=>{i.editBackgroundStory(e.id)},children:duchampIntl.get("Duchamp-Edit_3d_Background")})]}),!i.isMagneticLayout&&jsx(Button$4,{type:"primary",block:!0,onClick:()=>{d()},children:duchampIntl.get("Duchamp-Set_3d_Background_Current_Effect")}),jsx(FvsDrawer,{onClose:()=>{(()=>{var e,t;if(d(!1),c&&u){const{backgroundLayer:r}=i.story.platform,n=cloneDeep$2(a.current),o=u.getCameraState(),s=getMergeOptionsValue(n,c.id,{cameraState:o});null==u||u.hostDegrade().then((e=>{r.setValue({widgets:{[c.id]:{...null==s?void 0:s.widgets[c.id],degradeSource:e}}}),u.fireEvent("enableHostDegrade")})),r.setValue(s),u.applyConfigInHost({options:null==(t=null==(e=r.value)?void 0:e.widgets[c.id])?void 0:t.options})}})()},visible:r.isFloat,destroyOnClose:!0,children:c?jsx(CalderConfig,{widget:c,options:null!=(o=null==(n=e.widgets[c.id])?void 0:n.options)?o:null,onChange:t=>{const r=toJS(t);i.undoManager.withGroup((()=>{if(u){const t={...r,cameraState:u.getCameraState()};i.story.platform.backgroundLayer.setValue(getMergeOptionsValue(e,c.id,filterOptions(t,u))),u.applyConfigInHost({options:t})}}))}}):null})]})})),BackgroundStoryRender=observer((e=>{const{value:t,isFloat:r=!1,resource:n,className:o,adaptiveScale:i,style:a}=e,s=useStore(),l=s.backgroundStories.find((e=>e.id===(null==t?void 0:t.id)));if(reactExports.useEffect((()=>()=>{n.setIsFloat(!1),n.floatWidget&&(null==l||l.setWidgetFloatTop(n.floatWidget,!1))}),[s.mainStory]),reactExports.useEffect((()=>{n.floatWidget&&(null==l||l.setWidgetFloatTop(n.floatWidget,n.isFloat))}),[n.isFloat,n.floatWidget]),!l)return jsx(Fragment,{});const c=l.widgetFloatTop,u=r?l.widgets.filter((e=>e.id===c)):l.widgets.filter((e=>e.id!==c));return jsxs("div",{className:classNames$1("background-story-render",o),style:a,children:[r?jsx("div",{className:"background-story-masker"}):l.platform.backgroundLayer.render({className:"background-story-bg",adaptiveScale:i}),u.map((e=>jsx(WidgetWrapper,{widget:e,adaptiveScale:i,className:classNames$1({"duchamp-widget-float-top":r}),isPreview:!0,isSingleRoot:!1},e.type)))]})})),createResourceCenter=(e,t,r)=>{const n=new ResourceCenter(e,t);return n.setService({uploadResources:r.uploadResources,copyResource:r.copyResource,deleteResources:r.deleteResources,getSize:r.getSize}),n.addHooks({beforeCopy:async e=>!!getPayload$2(e,"isPrivate")||void 0!==Object.values(n.getInfos()).find((t=>!!getPayload$2(t,"isPrivate")&&t.subResource&&Object.values(t.subResource).includes(e.id)))}),n},DEFAULT_RESOURCE={files:[],tables:[]};function mergeResourceDependence(e,t){var r,n;return t?{files:union(e.files,null!=(r=t.files)?r:[]),tables:union(e.tables,null!=(n=t.tables)?n:[])}:e}function getBuildInfo(){return{version:"a5a458eaa9bf68029f66b1a68081ce87c8783674",branch:"master",time:"2025/9/2 15:53:22"}}function isFvsClipboardData(e){return isObject$e(e)&&e.data&&e.type}class ClipboardHelper{static async exist(e){var t;return!!(null==(t=await this.get(e))?void 0:t.data)}static async get(e){const t=await fvsService.readTextFromClipboard();try{const r=JSON.parse(t);if(isFvsClipboardData(r)&&r.extraInfo.buildVersion===getBuildInfo().version&&r.type===e)return r}catch(e3){}return null}static set(e,t,r){return fvsService.writeTextToClipboard(JSON.stringify({type:e,data:t,extraInfo:{buildVersion:fvsService.getBuildInfo().version,env:fvsService.getEnvInfo(),...r}}))}}const pasteTableResource=async(e,t)=>{if(!t)return;const{resource:r,extraInfo:n}=t,o=r.tables||[];try{await e.pasteTableDatas(o,n)}catch(i){console.error(i)}};function linkageWhenRemoveWidgets(e,t){const r=[],{parameterCenter:n}=e.calculateCenter;t.forEach((t=>{const o=t.getInstance();isFilterable(o)&&(e.allControllerWidgets.some((e=>n.sameName(e.name,o.name)&&e.id!==o.id))||r.push({trigger:o.id,relation:o.relation}))})),r.length>0&&e.calculateCenter.linkageByFilterDelete(r)}class AbstractHandler{constructor(e){__publicField(this,"store"),__publicField(this,"undoGroup"),this.store=e,this.undoGroup=this.store.undoManager.createGroup()}async execute(...e){let t=null;try{t=await this.executeInternal(...e)}catch(r){this.undoGroup.continue((()=>{Message.error(isEmpty$3(null==r?void 0:r.tip)?this.defaultFailTip:null==r?void 0:r.tip),console.error(null==r?void 0:r.message),this.revoke()}))}return this.undoGroup.end(),t}}class CreateWidgetHandler extends AbstractHandler{constructor(){super(...arguments),__publicField(this,"oldWidgetIds",[])}get defaultFailTip(){return duchampIntl.get("Duchamp-Create_Fail",duchampIntl.get("Duchamp-Component"))}async executeInternal(e,{x:t,y:r,options:n},o,i){this.oldWidgetIds=this.store.story.widgets.map((e=>e.id));const a=this.getMeta(e);this.checkWidgetRules(e,a,o);const s=this.createWidget(e,{x:t,y:r},o);s.setInitializing(!!a.initialization||!!a.dependencies);const l={type:"create",widget:s,parent:o,index:i,options:n};return s.meta.beforeCreate&&await s.meta.beforeCreate(l),await this.undoGroup.continue((async()=>{await this.store.story.addAndInitWidget(l)})),s}revoke(){this.store.story.widgets.filter((e=>!this.oldWidgetIds.includes(e.id))).forEach((e=>{this.store.story.deleteWidget(e)}))}getMeta(e){return widgetManager.getWidgetByName(e)}checkWidgetRules(e,t,r){const{valid:n,tip:o}=checkRules([()=>this.store.story.createWidgetCheck([t]),()=>{const{valid:t,tip:n}=isValidChildrenForParent(e,r);return{valid:t,tip:t?"":duchampIntl.get("Duchamp-Operation_Error_Tip",n)}}]);if(!n)throw{tip:o,message:"check widget rule fail when create widget"}}createWidget(e,{x:t,y:r},n){var o,i;const{duchampServer:a}=this.store,s=generateWidgetCreationData({type:e,parentWidget:n},{themeVars:a.themeManager.themeVars,story:a.store.story}),{width:l,height:c}=s.states;s.states.matrix=(new Transform$2).translate(t-l/2,r-c/2).matrix,null==(i=(o=a.store).updateWidgetDataStyle)||i.call(o,s);const u=new Widget(s);return u.setStore(this.store),u}}async function widgetInit(e,t){var r,n,o,i;const{widget:a}=e;if("paste"===e.type&&t&&Object.keys(t).length>0){const e=new Map(Object.entries(t));null==(r=a.getInstance())||r.updateResourceIDs(e)}try{if(!1===await(null==(o=(n=a.meta).initialization)?void 0:o.call(n,e)))return a.setInitializing(!1),!1;await widgetDependencyManager.load([a.type],a.store.isPreview)}catch(e3){const r="paste"===e.type?duchampIntl.get("Duchamp-Component_Resource_Copy_Error"):duchampIntl.get("Duchamp-Component_Resource_Initial_Error");Message.warning(r)}return null==(i=a.getInstance())||i.onCreated(e.type),a.setInitializing(!1),!0}async function createWidgetAndInit(e,t,r,n){var o;const{calculateCenter:i}=n,a=null==(o=n.widgetManager)?void 0:o.getWidgetByName(t);if(!a)return null;const s=generateWidgetCreationData({type:t,id:e},{themeVars:n.themeManager.themeVars,story:n.store.story}),l=new Widget(s);l.setStore(n.store);const c=l.getInstance();c.setCalculateCenter(i),c.setConfigurationConfig(r),l.setInitializing(!!a.initialization||!!a.dependencies);const u={type:"create",widget:l};return l.meta.beforeCreate&&await l.meta.beforeCreate(u),await widgetInit(u),await n.widgetInstanceManager.instanceInit([l],{type:"create"},[],i),l}var __defProp$d=Object.defineProperty,__getOwnPropDesc$c=Object.getOwnPropertyDescriptor,__decorateClass$c=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$c(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$d(t,r,i),i};class PasteWidgetHandler extends AbstractHandler{constructor(){super(...arguments),__publicField(this,"newWidgets",null)}get defaultFailTip(){return duchampIntl.get("Duchamp-Paste_Fail",duchampIntl.get("Duchamp-Component"))}async executeInternal(e=!0,t){const{widgetSnapshot:r,resourceInfo:n}=await this.getOriginalCopyInfo(e),o=this.getCopyInfo(r),i=this.getPasteContainer();this.checkWidgetRules(r,o,i),this.newWidgets=o.map((e=>e.widget));let a={};if(n.resource){const e=n.resource.files;a=await this.store.resourceCenter.copy(e,n.extraInfo)}await pasteTableResource(this.store.crudService,n);const s=checkRules([()=>this.store.story.createWidgetCheck(o.map((e=>e.widget.meta)))]);if(!s.valid)throw{tip:s.tip,message:"check widget rule fail when paste widget"};const l=this.getPasterInfo(this.newWidgets,o,t),c=l.filter((e=>Array.from(r.keys()).includes(e.fromWidgetId))).map((e=>e.widget));return await this.undoGroup.continue((async()=>{this.store.story.addWidgets(this.getAddWidgetData(l)),i&&this.moveWidgetToParent(c,i),await this.initWidget(l,a)})),c}revoke(){var e;null==(e=this.newWidgets)||e.forEach((e=>{this.store.story.deleteWidget(e)}))}async getOriginalCopyInfo(e=!0){return e?await this.getClipboardInfo():await this.getCurrentWidgetsInfo()}async getCurrentWidgetsInfo(){const e=await this.store.story.getCopyData(),t={buildVersion:fvsService.getBuildInfo().version,env:fvsService.getEnvInfo()};return{widgetSnapshot:new Map(e.widgets),resourceInfo:{resource:e.widgetsResource,extraInfo:t}}}async getClipboardInfo(){var e;const t=await ClipboardHelper.get("widget");if(!t)throw new Error("get clipboard info fail when paste widget");const{data:r,extraInfo:n}=t,o=new Map(r.widgets);return{widgetSnapshot:o,resourceInfo:{resource:null!=(e=r.widgetsResource)?e:getFrmResource(o),extraInfo:n}}}getCopyInfo(e){const t=reimplementWidget(Array.from(e.keys()),Array.from(e.values()).flat(),this.store);if(0===t.length)throw new Error("get copy info fail when paste widget");return t}getPasteContainer(){const{currentWidgets:e}=this.store.story;if(0===e.length)return;const{parentWidget:t}=e[0];return t}checkWidgetRules(e,t,r){const n=Array.from(e.keys()),{valid:o,tip:i}=checkRules([...t.filter((({fromWidgetId:e})=>n.includes(e))).map((({widget:e})=>()=>{const{valid:t,tip:n}=isValidChildrenForParent(e,r);return{valid:t,tip:t?"":duchampIntl.get("Duchamp-Operation_Error_Tip",n)}})),()=>this.store.story.createWidgetCheck(t.map((e=>e.widget.meta)))]);if(!o)throw{tip:i,message:"check widget rule fail when paste widget"}}getPasterInfo(e,t,r){const n=this.store.story.widgets.map((e=>({name:e.name,id:e.id}))),{offsetX:o,offsetY:i}=this.getPasterOffset(e,r);return t.map((e=>{const{widget:t,fromWidgetId:r}=e,a=isUniqueOrOwnName$1(n,t.name)?t.name:createUniqueName(n.map((e=>e.name)),"".concat(t.name,"_c"));t.setName(a);const s=getNavigationText(a,this.store.story.widgets,t);t.platform.mobile.setNavigationText(s),n.push({name:a,id:t.id});const[l,c]=t.position;return t.setPosition(o+l,i+c),{widget:t,fromWidgetId:r,type:"paste"}}))}async initWidget(e,t){await Promise.all(e.map((async e=>{if(!(await widgetInit(e,t)))throw new Error("init widget ".concat(e.widget.name," fail when paste widget"))})));if((await this.store.duchampServer.widgetInstanceManager.instanceInit(e.map((e=>e.widget)),{type:"create"})).length!==e.length)throw new Error("init widget instance fail when paste widget")}getAddWidgetData(e){var t;const r=this.store.story.widgets.length,{currentWidgets:n}=this.store.story,o=null==(t=n.at(-1))?void 0:t.rootParentWidget;if(o){const t=this.store.story.widgets.indexOf(o);return e.toReversed().map((e=>({widget:e.widget,index:t+1})))}return e.toReversed().map((e=>{var t;const n=null==(t=this.store.story.getWidgetById(e.fromWidgetId))?void 0:t.rootParentWidget,o=n?this.store.story.widgets.indexOf(n):-1;return{widget:e.widget,index:o>=0?o+1:r}}))}getPasterOffset(e,t){const r=this.getCoordinate(t),{left:n,top:o}=calculateAreaBound(e.map((e=>e.states)));if(r)return{offsetX:r.coordinateX-n,offsetY:r.coordinateY-o};const i=this.calculateOffset(e[0]);return{offsetX:i,offsetY:i}}getCoordinate(e){if(e)return e;const{currentWidgets:t}=this.store.story;if(0===t.length)return;const{left:r,top:n}=calculateAreaBound(t.map((e=>e.states))),o=t[t.length-1],i=this.calculateOffset(o);return{coordinateX:r+i,coordinateY:n+i}}moveWidgetToParent(e,t){if(!t)return;const{currentWidgets:r}=this.store.story;if(0===r.length)return;const{widgets:n}=this.store.story,o=n.findIndex((e=>e===t))-(t.flattenChildWidgets.length-1),i=n.indexOf(r[r.length-1])-o+1;this.store.story.moveWidgetsToContainer(e,t,e.map((e=>e.states.matrix)),i)}calculateOffset(e,t=0,r=10){let n=t;for(;this.store.story.hasWidgetMatchRect(getWidgetOffsetRect(e,n));)n+=r;return n}}__decorateClass$c([focusPoint(getPasteWidgetType)],PasteWidgetHandler.prototype,"getCopyInfo");var __defProp$c=Object.defineProperty,__getOwnPropDesc$b=Object.getOwnPropertyDescriptor,__decorateClass$b=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$b(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$c(t,r,i),i};class PlatformStoryAdaptor{constructor(e){__publicField(this,"model"),__publicField(this,"mobile"),this.model=e,this.mobile=new MobileStoryAdaptor(e),makeObservable(this)}get background(){return this.model.background}get backgroundLayer(){return this.model.backgroundLayer}setBackground(e){}get alignmentLines(){return this.model.alignmentLines}setAlignmentLines(e){}get currentWidgets(){return this.model.currentWidgets}get alignToolEnabled(){return(!this.model.store.isMagneticLayout||!isWidgetsInMagneticLayout(this.mobile.currentWidgets))&&this.currentWidgets.length>1}updateLayout(){this.model.store.isMagneticLayout&&(this.mobile.updateAllWidgetOrders(),this.mobile.transferMagneticLayout())}toggleWidgetsVisible(e){this.model.store.undoManager.withGroup((()=>{e.forEach((e=>{e.setVisible(!e.visible)})),this.model.store.isMagneticLayout&&this.mobile.transferMagneticLayout()}))}}function getCreateWidgetFocusPoint(e){const{groupName:t,widgetType:r}=widgetManager.getWidgetByName(e);if("chart"===r)return{id:"S27",param:{groupName:t,type:e}};const n=FOCUS_POINT_WIDGET_TYPE_ID_MAP[e]||null;return n?{id:n}:null}__decorateClass$b([platformComputed],PlatformStoryAdaptor.prototype,"background"),__decorateClass$b([platformComputed],PlatformStoryAdaptor.prototype,"backgroundLayer"),__decorateClass$b([platformAction],PlatformStoryAdaptor.prototype,"setBackground"),__decorateClass$b([platformComputed],PlatformStoryAdaptor.prototype,"alignmentLines"),__decorateClass$b([platformAction],PlatformStoryAdaptor.prototype,"setAlignmentLines"),__decorateClass$b([platformComputed],PlatformStoryAdaptor.prototype,"currentWidgets");class JavaBridge{get javaBridge(){var e;return null==(e=window.Van)?void 0:e.JavaBridge}registerReuseIpc(e){var t,r;null==(r=null==(t=this.javaBridge)?void 0:t.registerReuseIpc)||r.call(t,e)}getReuseEnvInfo(){var e,t,r;return JSON.parse(null!=(r=null==(t=null==(e=this.javaBridge)?void 0:e.getReuseEnvInfo)?void 0:t.call(e))?r:JSON.stringify({}))}getLocale(){var e,t;return(null==(t=null==(e=this.javaBridge)?void 0:e.getLocale)?void 0:t.call(e))||"zh_CN"}openReuseCenterDialog(e){var t,r;null==(r=null==(t=this.javaBridge)?void 0:t.openReuseCenterDialog)||r.call(t,e)}showTemplateManagerDialog(){var e,t;null==(t=null==(e=this.javaBridge)?void 0:e.openThemeManagerDialog)||t.call(e)}}const reuseJavaBridge=new JavaBridge;function getReuseName(e){const t=e.split(".");return t.pop(),t.join(".")}const isReuseFile=e=>Object.values(REUSE_TYPE).some((t=>e.endsWith(t))),formatReuseValues=e=>{for(const t in e){const r=e[t];(isNil$3(r)||""===r)&&(e[t]=null)}return e},getReuseFileMaxSize=e=>1024*REUSE_FILE_MAX_SIZE[e]*1024,getTemplateCustomAttachData=(e,t)=>e&&e.resources?Object.values(e.resources).filter((e=>!t||t.some((t=>{var r;return null==(r=e.tags)?void 0:r.includes(t)})))):[],widgetFilterKeyMap={"FVS_chart-1":[duchampIntl.get("Duchamp-Column_Chart_Class"),duchampIntl.get("Duchamp-Bar_Graph_Category")],"FVS_chart-3":duchampIntl.get("Duchamp-Pie_Chart_Category"),"FVS_chart-4":duchampIntl.get("Duchamp-Line_Chart_Class"),"FVS_chart-5":duchampIntl.get("Duchamp-Dashboard"),"FVS_chart-8":duchampIntl.get("Duchamp-Map_Class"),"FVS_chart-9":duchampIntl.get("Duchamp-Earth_Class"),"FVS_chart-12":duchampIntl.get("Duchamp-Combination_Diagram_Class"),"FVS_chart-14":[duchampIntl.get("Duchamp-Other"),duchampIntl.get("Duchamp-Tree"),duchampIntl.get("Duchamp-Scatter_Chart_Class"),duchampIntl.get("Duchamp-Time_Class")],"FVS_index_card-0":[duchampIntl.get("Duchamp-Indicator_Card_Category"),duchampIntl.get("Duchamp-Shape_And_Text")],"FVS_title-0":"d-text-title","FVS_graph-0":["d-workbook","d-workbook-x"],"FVS_container-0":["d-iframe","d-slideshow","d-reserve-canvas","d-expand-template"],"FVS_controller-0":[duchampIntl.get("Duchamp-Controller_Date"),duchampIntl.get("Duchamp-Controller_List"),duchampIntl.get("Duchamp-Controller_Input_Text"),duchampIntl.get("Duchamp-Controller_Tree"),"d-query-button"],"FVS_other-0":["d-group","d-text","d-live-video"],"FVS_media-21":"d-local-video","FVS_media-23":"d-image"},transformWidgetFilterKey=e=>Object.keys(widgetFilterKeyMap).find((t=>{const r=widgetFilterKeyMap[t];return isFunction$8(r)?r(e):isArray$c(r)?r.includes(e):r===e}))||"FVS_other-0",transformSelectableFilterData=e=>e.map((e=>{var t;return(null==(t=e.children)?void 0:t.length)&&(e.selectable=!1,e.children=transformSelectableFilterData(e.children)),e})),getFilterIdByKey=(e="")=>e.split("-").pop()||"",getWidgetClassify=(e="")=>{const[t="",r=""]=e.split("-");return"0"===r?{parentClassify:getFilterTitle(ReuseFilterManager.getLocalFilter(REUSE_TYPE.WIDGET),e),childClassify:duchampIntl.get("Duchamp-All")}:{parentClassify:getFilterTitle(ReuseFilterManager.getLocalFilter(REUSE_TYPE.WIDGET),t),childClassify:getFilterTitle(ReuseFilterManager.getLocalFilter(REUSE_TYPE.WIDGET),e)}},ALIGN_TYPE={LEFT:"LEFT",RIGHT:"RIGHT",CENTER:"CENTER",TOP:"TOP",BOTTOM:"BOTTOM",MIDDLE:"MIDDLE"},VERTICAL_LAYOUT_TYPE={HORIZONTAL:"horizontal",VERTICAL:"vertical"},VERTICAL_LAYOUT_ENABLE_MIN_SIZE=3;function setWidgetsLeft(e,t){e.forEach((e=>{const[,r]=e.position;e.setPosition(t,r)}))}function setWidgetsRight(e,t){e.forEach((e=>{const[,r]=e.position;e.setPosition(t-e.model.states.width,r)}))}function setWidgetsTop(e,t){e.forEach((e=>{const[r]=e.position;e.setPosition(r,t)}))}function setWidgetsBottom(e,t){e.forEach((e=>{const[r]=e.position;e.setPosition(r,t-e.model.states.height)}))}function getWidgetsAnchor(e,t,r){return t(...e.map(r))}function getWidgetsMinLeft(e){return getWidgetsAnchor(e,Math.min,(e=>e.position[0]))}function getWidgetsMaxRight(e){return getWidgetsAnchor(e,Math.max,(e=>e.position[0]+e.model.states.width))}function getWidgetsMinTop(e){return getWidgetsAnchor(e,Math.min,(e=>e.position[1]))}function getWidgetsMaxBottom(e){return getWidgetsAnchor(e,Math.max,(e=>e.position[1]+e.model.states.height))}function setAlignLeft(e){return setWidgetsLeft(e,getWidgetsMinLeft(e)),e}function setAlignRight(e){return setWidgetsRight(e,getWidgetsMaxRight(e)),e}function setAlignCenter(e){const t=getWidgetsMinLeft(e),r=(getWidgetsMaxRight(e)-t)/2+t;return e.forEach((e=>{const[,t]=e.position,{width:n}=e.model.states;e.setPosition(r-n/2,t)})),e}function setVerticalAlignTop(e){return setWidgetsTop(e,getWidgetsMinTop(e)),e}function setVerticalAlignBottom(e){return setWidgetsBottom(e,getWidgetsMaxBottom(e)),e}function setVerticalAlignMiddle(e){const t=getWidgetsMinTop(e),r=(getWidgetsMaxBottom(e)-t)/2+t;return e.forEach((e=>{const[t]=e.position,{height:n}=e.model.states;e.setPosition(t,r-n/2)})),e}function setAlign(e,t){switch(t){case ALIGN_TYPE.LEFT:setAlignLeft(e);break;case ALIGN_TYPE.RIGHT:setAlignRight(e);break;case ALIGN_TYPE.CENTER:setAlignCenter(e);break;case ALIGN_TYPE.TOP:setVerticalAlignTop(e);break;case ALIGN_TYPE.BOTTOM:setVerticalAlignBottom(e);break;case ALIGN_TYPE.MIDDLE:setVerticalAlignMiddle(e)}}const getCommonBounds=e=>{if(!e.length)return[0,0,0,0];let t=1/0,r=-1/0,n=1/0,o=-1/0;return e.forEach((e=>{const{width:i,height:a,left:s,top:l}=e.rect;t=Math.min(t,s),n=Math.min(n,l),r=Math.max(r,s+i),o=Math.max(o,l+a)})),[t,n,r,o]},getCommonBoundingBox=e=>{const[t,r,n,o]=getCommonBounds(e);return{left:t,top:r,right:n,bottom:o,width:n-t,height:o-r}};function setVerticalLayout(e,t){if(e.length<VERTICAL_LAYOUT_ENABLE_MIN_SIZE)return;const[r,n,o]=t===VERTICAL_LAYOUT_TYPE.VERTICAL?["left","right","width"]:["top","bottom","height"],i=e.sort(((e,t)=>e.rect[r]+e.rect[o]/2-(t.rect[r]+t.rect[o]/2))),a=getCommonBoundingBox(i);let s=0;for(const c of i)s+=c.rect[o];const l=(a[o]-s)/(i.length-1);if(l<0){const e=i.findIndex((e=>e.rect[r]===a[r])),t=i.findIndex((e=>e.rect[r]+e.rect[o]===a[n])),s=i[t].rect[r]+i[t].rect[o]/2,l=i[e].rect[r]+i[e].rect[o]/2,c=(s-l)/(i.length-1);let u=l;i.forEach(((n,i)=>{const{rect:a}=n,s={left:0,top:0};i!==e&&i!==t&&(u+=c,s[r]=u-(a[r]+a[o]/2));const l={...a,[r]:a[r]+s[r]};n.setPosition(l.left,l.top)}))}else{let e=a[r];i.forEach((t=>{const{rect:n}=t,i=e-n[r];e+=l,e+=n[o];const a={...n,[r]:n[r]+i};t.setPosition(a.left,a.top)}))}}class WidgetDragManager{constructor(e,t,r){__publicField(this,"fromWidget"),__publicField(this,"toWidget"),__publicField(this,"widgets"),this.fromWidget=e,this.toWidget=t,this.widgets=r}get dragContainer(){const e=this.widgets.findIndex((e=>e.id===this.fromWidget.id)),t=this.widgets.findIndex((e=>e.id===this.toWidget.id));return isStructureWidget(this.toWidget)&&e>t?this.toWidget:this.toWidget.parentWidget}get isValidDragIntoInfo(){var e,t,r;return this.fromWidget.store.isMagneticLayout&&this.fromWidget.parent!==(null!=(t=null==(e=this.dragContainer)?void 0:e.id)?t:"")?{valid:!1,tip:duchampIntl.get("Duchamp-Widget_Not_Support_Move_In_Or_Out_Container")}:this.fromWidget.platform.lock||(null==(r=this.dragContainer)?void 0:r.platform.lock)||this.fromWidget.id===this.toWidget.id||this.fromWidget.flattenChildWidgets.includes(this.toWidget)?{valid:!1,tip:""}:isValidChildrenForParent(this.fromWidget,this.dragContainer)}}const ORDER_TYPE={UP:"UP",DOWN:"DOWN",FRONT:"FRONT",BACK:"BACK"};class OrderTool{constructor(e){__publicField(this,"story"),this.story=e}get widgets(){var e;return(null==(e=this.story)?void 0:e.widgets)||[]}up(e){const{needOrder:t,widgetIndex:r}=this.getOrderData(e),n=this.widgets.findIndex(((n,o)=>n.parent===e.parent&&o>=r+t.length));if(!(n<0))return this.move(r,n-t.length+1,t.length),this}down(e){const{needOrder:t,widgetIndex:r}=this.getOrderData(e),n=this.widgets.slice(0,r).reverse(),o=n.findIndex((t=>t.parent===e.parent));if(!(o<0))return this.move(r,n.length-(o+n[o].flattenChildWidgets.length),t.length),this}back(e){const{needOrder:t,widgetIndex:r}=this.getOrderData(e),{parentWidget:n}=e,o=n?this.widgets.findIndex((e=>e.id===n.children.at(0))):0;return this.move(r,o-(this.widgets[o].flattenChildWidgets.length-1),t.length),this}front(e){const{needOrder:t,widgetIndex:r}=this.getOrderData(e),n=this.widgets.findIndex((t=>t.id===e.parent));return this.move(r,n>-1?n-t.length:this.widgets.length,t.length),this}getOrderData(e,t=this.widgets){const r=e.flattenChildWidgets;return{needOrder:r,widgetIndex:t.findIndex((t=>t===e))-(r.length-1)}}move(e,t,r=1){var n;null==(n=this.story)||n.setWidgets(arrayMove(this.widgets.slice(),e,t,r))}order(e,t){const r=Array.isArray(e)?e:[e];r.length>1&&(t===ORDER_TYPE.DOWN||t===ORDER_TYPE.UP)||r.forEach((e=>{var n;switch(t){case ORDER_TYPE.DOWN:this.down(e);break;case ORDER_TYPE.UP:this.up(e);break;case ORDER_TYPE.FRONT:this.front(e);break;case ORDER_TYPE.BACK:this.back(e)}this.updateWidgetChildrenList(null==(n=first(r))?void 0:n.parentWidget)}))}widgetMoveOut(e,t){var r;const{left:n,top:o,width:i}=(first(e.parentContainerWidgets)||e).rect;null==(r=e.parentWidget)||r.replaceChildren([e.id],[]),e.setParent(""),e.setRectStatesWithEffect({matrix:t||new Transform$2(e.model.states.matrix).setTranslate(n+i+10,o).matrix});const a=this.widgets.length,{widgetIndex:s,needOrder:l}=this.getOrderData(e);this.move(s,a,l.length)}moveWidgetToContainer(e,t,r,n){const{widgetIndex:o,needOrder:i}=this.getOrderData(e),{widgetIndex:a,needOrder:s}=this.getOrderData(t),l=a+clamp$5(null!=n?n:s.length-1,0,s.length-1);this.move(o,o<l?l-i.length:l,i.length);const c=t.getInstance(),{parentWidget:u}=e;e.setParent(t.id||""),null==u||u.replaceChildren([e.id],[]),this.updateWidgetChildrenList(t),null==c||c.updateRectAfterAppendChild(e,r)}moveWidgetsToContainer(e,t,r,n){var o;let i=[...this.widgets];e.forEach((e=>{const{widgetIndex:r,needOrder:o}=this.getOrderData(e,i),{widgetIndex:a,needOrder:s}=this.getOrderData(t,i),l=a+clamp$5(null!=n?n:s.length-1,0,s.length-1);((e,t,r=1)=>{i=arrayMove(i.slice(),e,t,r)})(r,r<l?l-o.length:l,o.length)})),null==(o=this.story)||o.setWidgets(i);const a=t.getInstance();e.forEach((e=>{const{parentWidget:r}=e;e.setParent(t.id||""),null==r||r.replaceChildren([e.id],[])})),this.updateWidgetChildrenList(t),e.forEach(((e,t)=>{null==a||a.updateRectAfterAppendChild(e,null==r?void 0:r[t])}))}widgetLayerMove(e,t){const r=new WidgetDragManager(e,t,this.widgets);if(!r.isValidDragIntoInfo.valid)return;const{dragContainer:n}=r,o=this.widgets.findIndex((e=>e===t)),{widgetIndex:i,needOrder:a}=this.getOrderData(e);this.move(i,i<o?o-a.length+1:o,a.length);const s=null==n?void 0:n.getInstance();if(n!==e.parentWidget){const{parentWidget:t}=e;e.setParent((null==n?void 0:n.id)||""),this.updateWidgetChildrenList(n),null==t||t.replaceChildren([e.id],[]),null==s||s.updateRectAfterAppendChild(e)}else this.updateWidgetChildrenList(n)}updateWidgetChildrenList(e){null==e||e.setChildren(this.widgets.filter((t=>t.parent===e.id)).map((e=>e.id)))}}var __defProp$b=Object.defineProperty,__getOwnPropDesc$a=Object.getOwnPropertyDescriptor,__decorateClass$a=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$a(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$b(t,r,i),i};class AbstractStory extends(Model$1({id:idProp,name:prop().withSetter(),background:prop((()=>({type:"empty"}))).withSetter(),widgets:prop((()=>[])).withSetter(),alignmentLines:prop((()=>[])).withSetter(),mobile:prop((()=>({}))).withSetter()})){constructor(){super(...arguments),__publicField(this,"_store"),__publicField(this,"platform",new PlatformStoryAdaptor(this)),__publicField(this,"backgroundLayer",new Background(this)),__publicField(this,"widgetFloatTop",""),__publicField(this,"currentItems",new Set),__publicField(this,"singleModeWidgetIds",new Set),__publicField(this,"stickyInfo",{widget:void 0})}get store(){return this._store||(this._store=getRoot(this)),this._store}setStore(e){this._store=e}onInit(){widgetsCtx.setComputed(this,(()=>this.widgets)),storyCtx.setComputed(this,(()=>this)),this.platform.backgroundLayer.setBackground(toJS(this.platform.background))}onAttachedToRootStore(e){this._store=e}get containerWidgetsIncludeInvisible(){return flatAvailableWidgets(this.rootWidgets).filter(isDraggableTargetStructureWidget).reverse()}get containerWidgets(){return this.containerWidgetsIncludeInvisible.filter((e=>e.visibleInStory))}get currents(){return new Set(Array.from(this.currentItems).filter((e=>this.widgets.some((t=>t.id===e&&t.model.platformSupport)))))}get currentWidgets(){return this.widgets.filter((e=>this.currents.has(e.id)))}get currentUnLockedWidgets(){return this.widgets.filter((e=>this.currents.has(e.id)&&!e.platform.lock))}get currentWidget(){return first(this.currentWidgets)}get isCurrentWidgetsNotInMagneticContainer(){return!this.store.isMagneticLayout||this.currentWidgets.length>0&&!isWidgetsInMagneticLayout(this.currentWidgets)}get singleSelectedWidget(){return 1===this.currentWidgets.length?this.currentWidget:void 0}get singleSelectedGroup(){return this.singleSelectedWidget&&widgetIsGroup(this.singleSelectedWidget)?this.singleSelectedWidget:void 0}get isCurrentsHaveLockedWidget(){return this.currentWidgets.some((e=>e.platform.lock))}get singleRelationWidgetId(){if(!this.singleSelectedWidget||!isRelationWidget(this.singleSelectedWidget.getInstance()))return{};const e=this.singleSelectedWidget.getInstance();return{wId:e.relationMeta.wId,tableId:e.relationMeta.tableId}}get currentArr(){return Array.from(this.currents)}get rootWidgets(){return this.widgets.filter((e=>""===e.parent))}get sortedRootWidgets(){const e=this.widgets.find((e=>e.id===this.widgetFloatTop)),t=this.rootWidgets.filter((e=>e.id!==this.widgetFloatTop));return e?[...t,e]:t}get widgetsRect(){return this.widgets.map((e=>{const[t,r]=e.position,{width:n,height:o}=e.model.states;return{left:t,top:r,width:n,height:o}}))}get availableCurrentWidgets(){return this.currentWidgets.filter((e=>!e.parentWidget||e.parentWidget.availableChildWidgets.includes(e)))}get widgetTargets(){return this.availableCurrentWidgets.reduce(((e,t)=>{const{lock:r}=t.platform;return t.id!==this.widgetFloatTop&&t.visibleInStory&&t.target&&(r?e.locked.push(t.target):e.unlocked.push(t.target)),e}),{locked:[],unlocked:[]})}get singleModeEnable(){return 0!==this.singleModeWidgetIds.size&&this.widgets.some((e=>e.isInSingleMode))}isWidgetsInSingleMode(e=this.currentWidgets){return e.every((e=>e.isInSingleMode))}updateSingleModeWidgetIds(e=this.currentWidgets){const t=e.flatMap((e=>e.baseWidgets)),r=this.isWidgetsInSingleMode(t)?"delete":"add";t.forEach((e=>{this.singleModeWidgetIds[r](e.id)}))}closeSingleMode(){this.singleModeWidgetIds.clear()}getParameterableInstances(){return this.widgets.reduce(((e,t)=>{const r=t.getInstance();return isFilterable(r)&&e.push(r),e}),[])}addWidget(e,t){this.addWidgets([{widget:e,index:t}]),this.singleModeEnable&&this.updateSingleModeWidgetIds([e])}addWidgets(e){const t=this.widgets.slice();e.forEach((({widget:e,index:r})=>{const n=null!=r?r:t.length;t.splice(n,0,e)})),this.setWidgets(t)}async addAndInitWidget(e,t){if(this.addWidget(e.widget),e.parent&&this.moveWidgetToContainer(e.widget,e.parent,e.widget.states.matrix,e.index),!(await widgetInit(e,t)))throw new Error("add and init widget fail");"paste"!==e.type&&await this.store.updateChartWidgetStyle(e.widget);if(0===(await this.store.duchampServer.widgetInstanceManager.instanceInit([e.widget],{type:"create"===e.type?"create":"init"})).length)throw new Error("add and init widget fail")}createWidgetCheck(e){return{valid:!0,tip:""}}supportWidgetCheck(e){return!0}async createWidget(e,{x:t,y:r,options:n},o,i){const a=await new CreateWidgetHandler(this.store).execute(e,{x:t,y:r,options:n},o,i);return a&&this.widgets.some((e=>e.id===a.id))&&this.setCurrents([a.id]),a}setCurrent(e,t=!1){var r;t&&(null==(r=this.currentWidget)?void 0:r.parent)===e.parent?this.addCurrent(e.id):this.setCurrents([e.id])}addCurrent(e){this.setCurrents([...this.currentArr,e])}clearCurrents(){this.setCurrents([])}setCurrents(e=[]){if(!this.store.isPreview){const t=e.filter((e=>!this.currentArr.includes(e))),r=this.currentArr.filter((t=>!e.includes(t)));this.emitWidgetSelect(t,r,e),t.forEach((e=>{var t,r;null==(r=null==(t=this.getWidgetById(e))?void 0:t.getInstance())||r.fireEvent("select",!0)})),r.forEach((e=>{var t,r;null==(r=null==(t=this.getWidgetById(e))?void 0:t.getInstance())||r.fireEvent("select",!1)}))}this.currentItems=new Set(e)}createGroupFromWidgets({widgets:e,usePlatformStates:t=!1,currentArr:r=this.currentArr}){var n;const o=e.map((e=>e.parent));if(1!==new Set(o).size)return;const{width:i,height:a,top:s,left:l}=calculateAreaBound(e.map((e=>t?e.platform.states:e.states))),c={...WIDGET_STATES,width:i,height:a,matrix:(new Transform$2).translate(l,s).matrix},u=new Widget(widgetAdapter({type:"d-group",name:createUniqueName(this.widgets.map((e=>e.name)),duchampIntl.get("Duchamp-Story_Group_Name"),"_".concat(this.name)),states:c}));u.setStore(this.store),u.setParent(o[0]),u.setChildren(e.map((e=>e.id)));const d=this.widgets.findIndex((e=>e.id===r[0]));e.forEach((e=>{e.setParent(u.id)}));const h=flatWidgets(e),p=this.widgets.filter(((e,t)=>t<=d&&!h.some((t=>t.id===e.id)))),f=this.widgets.filter(((e,t)=>t>d&&!h.some((t=>t.id===e.id))));return this.setWidgets([...p,...this.widgets.filter((e=>h.includes(e))),u,...f]),null==(n=this.getWidgetById(o[0]))||n.replaceChildren(r,[u.id]),u}addGroup(){if(this.availableCurrentWidgets.length<2)return;const e=this.createGroupFromWidgets({widgets:this.availableCurrentWidgets,usePlatformStates:!0});return e&&this.setCurrents([e.id]),e}createGroups(e){if(!(e.length<2))return this.createGroupFromWidgets({widgets:e,currentArr:e.map((e=>e.id))})}deleteGroup(){var e;const t=this.singleSelectedGroup;t&&(t.childWidgets.forEach((e=>{e.setParent(t.parent)})),null==(e=t.parentWidget)||e.replaceChildren([t.id],t.children,t.parentWidget.children.indexOf(t.id)),this.setWidgets([...this.widgets.filter((e=>e.id!==t.id))]),this.clearCurrents())}deleteCurrent(){this.currentWidgets.forEach((e=>this.deleteWidget(e))),this.clearCurrents()}updateRelationWidgets(e){this.currentWidgets.forEach((t=>{const r=t.getInstance();isRelationWidget(r)&&r.setProps({relationMeta:{wId:e.wId,tableId:e.tableId}})}))}deleteWidget(e){const{parentWidget:t}=e,r=e.flattenChildWidgets;r.forEach((e=>{detach(e)})),linkageWhenRemoveWidgets(this.store,r),null==t||t.replaceChildren([e.id],[])}changeWidgetsOrder(e){this.store.undoManager.withGroup((()=>{const t=[...this.currentWidgets];t.length>1&&"BACK"===e&&t.reverse(),new OrderTool(this).order(t,e)}))}moveWidgetToContainer(e,t,r,n){new OrderTool(this).moveWidgetToContainer(e,t,r,n),this.setCurrent(e)}moveWidgetsToContainer(e,t,r,n){new OrderTool(this).moveWidgetsToContainer(e,t,r,n)}widgetLayerMove(e,t){this.store.isMagneticLayout?this.platform.mobile.widgetLayerMove(e,t):(new OrderTool(this).widgetLayerMove(e,t),this.setCurrent(e))}widgetMoveOut(e,t){this.store.undoManager.withGroup((()=>{new OrderTool(this).widgetMoveOut(e,t)}))}setWidgetsAlign(e){this.currents.size>1&&setAlign(this.currentWidgets,e)}setWidgetsVerticalLayout(e){setVerticalLayout(this.currentWidgets,e)}moveCurrents(e,t=1){this.currentWidgets.forEach((r=>r.move(e,t))),this.platform.updateLayout()}setWidgetFloatTop(e,t){t?this.widgetFloatTop=e:this.widgetFloatTop===e&&(this.widgetFloatTop="")}get backgroundStory(){return this.store.backgroundStories.find((e=>e.id===this.platform.backgroundLayer.backgroundStoryId))}get relatedWidgets(){var e;return[...this.widgets,...(null==(e=this.backgroundStory)?void 0:e.widgets)||[]]}get groupRelateWidgets(){return[this,this.backgroundStory].reduce(((e,t)=>(t&&e.push(...t.widgets.map((e=>({...getSnapshot(e),groupName:t.name})))),e)),[])}getRelatedWidgetById(e){return this.relatedWidgets.find((t=>t.id===e))}getRelatedWidgetByIds(e){return this.relatedWidgets.filter((t=>e.includes(t.id)))}getWidgetById(e){return this.widgets.find((t=>t.id===e))}getWidgetByName(e){return this.widgets.find((t=>t.name===e))}getWidgetByIds(e){return this.widgets.filter((t=>e.includes(t.id)))}get widgetsCanHover(){return this.widgetsCanSelect.filter((e=>!this.currents.has(e.id)))}get widgetsCanSelect(){const e=(this.currentWidget?this.currentWidgets.flatMap((e=>[...e.nonDirectRelateWidgets,e])):this.rootWidgets).filter(widgetCanSelect).sort(((e,t)=>t.indexPaths.some(((t,r)=>{var n;return t>(null!=(n=e.indexPaths[r])?n:-1)}))?1:-1));return[...new Set(e)]}hasWidgetMatchRect(e){return this.widgets.some((t=>fp.equals(t.rect,e)))}emitWidgetSelect(e,t,r){chartConfigPanelManager.handleWidgetSelect(this.getWidgetByIds(e),this.getWidgetByIds(t),this.getWidgetByIds(r))}getCopyWidgetsDataMap(){return this.currentWidgets.filter((e=>isNodeCopyable(e))).map((e=>[e.id,flatWidgets([e]).map((e=>getSnapshot(e)))]))}async copyWidget(){const e=await this.getCopyData();ClipboardHelper.set("widget",e)}async getCopyData(){const e=this.getCopyWidgetsDataMap(),t=await getAllWidgetResourceDependence(this.currentWidgets,this.store.crudService),{files:r,tables:n}=t;return{widgets:e,widgetsResource:{files:r.reduce(((e,t)=>{const r=this.store.resourceCenter.getInfoWithSubByID(t);return r&&(e=e.concat(r)),e}),[]),tables:n}}}copyWidgetStyle(){const{currentWidget:e}=this;1===this.currents.size&&isEmpty$3(null==e?void 0:e.widgetType)}async pasteWidget(e,t){const r=await new PasteWidgetHandler(this.store).execute(e,t);r&&(this.setCurrents(r.map((e=>e.id))),this.singleModeEnable&&this.updateSingleModeWidgetIds(r))}async pasteWidgetFromClipboard(e){await this.pasteWidget(!0,e)}async pasteWidgetFromCurrent(e){await this.pasteWidget(!1,e)}pasteWidgetStyleFromClipboard(){}get stickyWidgets(){return sortBy(this.widgets.filter((e=>widgetIsReserveCanvas(e)&&e.getInstance().sticky)),["rect.top",e=>-e.rect.left,e=>this.widgets.indexOf(e)]).reverse()}setStickyInfo(e){this.stickyInfo={...this.stickyInfo,...e}}updateWidgetsSizeByScale(e,t){const r=getTargetChildrenStates(this.rootWidgets,{...e,matrix:[1,0,0,1,0,0]},t);this.rootWidgets.forEach((e=>{const t=r.get(e.id);t&&e.setRectStatesWithEffect(t)}))}async exportReuseWidget({widgets:e,groupPath:t,value:r,dependence:n,resourceInfos:o}){const{cover:i,fvsType:a="",styleTheme:s,...l}=r,c=generateWidgetSnapshotWithForkId(e),u=await this.store.reuseService.exportReuseWidget({groupPath:t,props:formatReuseValues({templateType:2,displayDevice:"pc&mobile",vendor:reuseJavaBridge.getReuseEnvInfo().vendor,priceExpect:null,summary:null,styleTheme:getFilterIdByKey(s),cover:!!i||null,fvsType:a,forkIds:[...new Set(c.map((e=>e.forkId)))].join(","),...l}),snapshot:c,dependence:n,resourceInfos:o});return u&&i instanceof Blob&&await this.store.reuseService.updateResourceCover({resourceType:REUSE_TYPE.WIDGET,groupPath:t,id:u.id,file:i}),u}collectStoryResourceIDs(){const e=new Set;if((isCustomBackground(this.backgroundLayer)||isInternalBackground(this.backgroundLayer))&&e.add(this.backgroundLayer.value.id),isStoryBackground(this.backgroundLayer)&&this.backgroundLayer.value){const{widgets:t}=this.backgroundLayer.value;Object.values(t).forEach((t=>{e.add(null==t?void 0:t.degradeSource)}))}return(isCustomBackground(this.platform.mobile.backgroundLayer)||isInternalBackground(this.platform.mobile.backgroundLayer))&&e.add(this.platform.mobile.backgroundLayer.value.id),Array.from(e)}collectResourceIDs(){const e=new Set(getAllWidgetResourceList(this.widgets));return Array.from(e).concat(this.collectStoryResourceIDs())}collectResourceDetails(){const e=getAllWidgetResourceDetailsList(this.widgets);return e.push({type:"story",storyName:this.name,allResource:this.collectStoryResourceIDs()}),e}collectLineageData(){return{id:this.id,name:this.name,widgets:this.widgets.map((e=>({id:e.id,name:e.name,type:e.type,props:e.props})))}}}__decorateClass$a([observable],AbstractStory.prototype,"platform",2),__decorateClass$a([observable],AbstractStory.prototype,"backgroundLayer",2),__decorateClass$a([observable],AbstractStory.prototype,"widgetFloatTop",2),__decorateClass$a([observable],AbstractStory.prototype,"currentItems",2),__decorateClass$a([observable],AbstractStory.prototype,"singleModeWidgetIds",2),__decorateClass$a([computed],AbstractStory.prototype,"containerWidgetsIncludeInvisible",1),__decorateClass$a([computed],AbstractStory.prototype,"containerWidgets",1),__decorateClass$a([computed],AbstractStory.prototype,"currents",1),__decorateClass$a([platformComputed],AbstractStory.prototype,"currentWidgets",1),__decorateClass$a([computed],AbstractStory.prototype,"currentUnLockedWidgets",1),__decorateClass$a([computed],AbstractStory.prototype,"currentWidget",1),__decorateClass$a([computed],AbstractStory.prototype,"isCurrentWidgetsNotInMagneticContainer",1),__decorateClass$a([computed],AbstractStory.prototype,"singleSelectedWidget",1),__decorateClass$a([computed],AbstractStory.prototype,"singleSelectedGroup",1),__decorateClass$a([computed],AbstractStory.prototype,"isCurrentsHaveLockedWidget",1),__decorateClass$a([computed],AbstractStory.prototype,"singleRelationWidgetId",1),__decorateClass$a([computed],AbstractStory.prototype,"currentArr",1),__decorateClass$a([computed],AbstractStory.prototype,"rootWidgets",1),__decorateClass$a([platformComputed],AbstractStory.prototype,"sortedRootWidgets",1),__decorateClass$a([computed],AbstractStory.prototype,"widgetsRect",1),__decorateClass$a([computed],AbstractStory.prototype,"availableCurrentWidgets",1),__decorateClass$a([computed],AbstractStory.prototype,"widgetTargets",1),__decorateClass$a([computed],AbstractStory.prototype,"singleModeEnable",1),__decorateClass$a([modelAction],AbstractStory.prototype,"isWidgetsInSingleMode",1),__decorateClass$a([modelAction],AbstractStory.prototype,"updateSingleModeWidgetIds",1),__decorateClass$a([modelAction],AbstractStory.prototype,"closeSingleMode",1),__decorateClass$a([modelAction],AbstractStory.prototype,"addWidget",1),__decorateClass$a([modelAction],AbstractStory.prototype,"addWidgets",1),__decorateClass$a([focusPoint(getCreateWidgetFocusPoint)],AbstractStory.prototype,"createWidget",1),__decorateClass$a([modelAction],AbstractStory.prototype,"setCurrent",1),__decorateClass$a([modelAction],AbstractStory.prototype,"setCurrents",1),__decorateClass$a([modelAction],AbstractStory.prototype,"createGroupFromWidgets",1),__decorateClass$a([modelAction],AbstractStory.prototype,"addGroup",1),__decorateClass$a([modelAction],AbstractStory.prototype,"createGroups",1),__decorateClass$a([modelAction],AbstractStory.prototype,"deleteGroup",1),__decorateClass$a([modelAction,focusPoint(getDeleteWidgetType)],AbstractStory.prototype,"deleteCurrent",1),__decorateClass$a([modelAction],AbstractStory.prototype,"updateRelationWidgets",1),__decorateClass$a([modelAction],AbstractStory.prototype,"deleteWidget",1),__decorateClass$a([modelAction],AbstractStory.prototype,"moveWidgetToContainer",1),__decorateClass$a([modelAction],AbstractStory.prototype,"moveWidgetsToContainer",1),__decorateClass$a([modelAction],AbstractStory.prototype,"widgetLayerMove",1),__decorateClass$a([modelAction],AbstractStory.prototype,"setWidgetsAlign",1),__decorateClass$a([modelAction],AbstractStory.prototype,"setWidgetsVerticalLayout",1),__decorateClass$a([modelAction],AbstractStory.prototype,"moveCurrents",1),__decorateClass$a([modelAction],AbstractStory.prototype,"setWidgetFloatTop",1),__decorateClass$a([computed],AbstractStory.prototype,"backgroundStory",1),__decorateClass$a([computed],AbstractStory.prototype,"relatedWidgets",1),__decorateClass$a([computed],AbstractStory.prototype,"groupRelateWidgets",1),__decorateClass$a([computed],AbstractStory.prototype,"widgetsCanHover",1),__decorateClass$a([computed],AbstractStory.prototype,"widgetsCanSelect",1),__decorateClass$a([focusPoint(getCopyWidgetType)],AbstractStory.prototype,"copyWidget",1),__decorateClass$a([focusPoint(getPasteCurrentWidgetType)],AbstractStory.prototype,"pasteWidget",1),__decorateClass$a([observable],AbstractStory.prototype,"stickyInfo",2),__decorateClass$a([computed],AbstractStory.prototype,"stickyWidgets",1),__decorateClass$a([action$1],AbstractStory.prototype,"setStickyInfo",1);var __defProp$a=Object.defineProperty,__getOwnPropDesc$9=Object.getOwnPropertyDescriptor,__decorateClass$9=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$9(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$a(t,r,i),i};let BackgroundStory$1=class extends(ExtendedModel(AbstractStory,{},{toSnapshotProcessor:e=>({$modelId:e.id,...e})})){createWidgetCheck(e){if(!e.every((e=>this.supportWidgetCheck(e))))return{valid:!1,tip:""};return{valid:!this.widgets.some((e=>widgetIsHeavyComponent(e.type))),tip:duchampIntl.get("Duchamp-Heavy_Component_Count_Tip",duchampIntl.get("Duchamp-Three_Dimensional_Type_Component"))}}supportWidgetCheck(e){return isSupportBackgroundComponent(e.type)}};function isBackgroundStory(e){return e instanceof BackgroundStory$1}function isSupportBackgroundComponent(e){return"d-calder"===e||"d-calder-custom"===e}BackgroundStory$1=__decorateClass$9([model$1("duchamp/BackgroundStory")],BackgroundStory$1);var __defProp$9=Object.defineProperty,__getOwnPropDesc$8=Object.getOwnPropertyDescriptor,__decorateClass$8=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$8(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$9(t,r,i),i};let Story=class extends(ExtendedModel(AbstractStory,{isPreviewHidden:prop(!1).withSetter(),transition:prop((()=>({open:!1,duration:2e3}))),queryControllerHiddenIds:prop((()=>[])).withSetter()},{toSnapshotProcessor:e=>({$modelId:e.id,...e})})){createWidgetCheck(e){return checkWidgetCountLimit(e,this.widgets)}updateTransition(e){this.transition=e}};async function pasteStoryProcessor(e,t,r,n){const{data:o,key:i,generateNewIds:a=!0,widgetInstanceManager:s,updateResourceInfo:l={}}=e,c=a?uuid$2():o.id,u="backgroundStory"===i?new BackgroundStory$1({id:c,name:o.name}):new Story({id:c,name:o.name});u.setStore(n);const d=await ClipboardHelper.get(i);let h=l;if(d){if(d.data.storyResource.files.length>0){const e=d.data.storyResource.files,t=await n.resourceCenter.copy(e,d.extraInfo);h=Object.assign({},h,t)}await pasteTableResource(r,{resource:d.data.storyResource,extraInfo:d.extraInfo})}const p=replaceDataIds(o,new Map([[o.id,c],...Object.entries(h)]));applySnapshot(u,{...p,widgets:[],$modelType:u.$modelType});const f=reimplementWidget(p.widgets.filter((e=>""===e.parent)).map((e=>e.id)),p.widgets,n,{generateNewIds:a}),g=f.map((e=>e.widget));u.setWidgets(g),u.platform.mobile.onPaste(f),await u.backgroundLayer.onPaste(BACKGROUND_STORY_SYMBOL,null==d?void 0:d.data,h),await u.platform.mobile.backgroundLayer.onPaste(MOBILE_BACKGROUND_STORY_SYMBOL,null==d?void 0:d.data,h),t(u),await Promise.all(f.map((async({widget:e,fromWidgetId:t})=>{if(!(await widgetInit({type:"paste",fromWidgetId:t,widget:e},h)))throw new Error("widget ".concat(e.name," init fail when paste story"))})));if((await s.instanceInit(f.map((e=>e.widget)),{type:"create"})).length!==f.length)throw new Error("widget instance init fail when paste story");return u}__decorateClass$8([modelAction],Story.prototype,"updateTransition",1),Story=__decorateClass$8([model$1("duchamp/Story")],Story);var __defProp$8=Object.defineProperty,__getOwnPropDesc$7=Object.getOwnPropertyDescriptor,__decorateClass$7=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$7(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$8(t,r,i),i};class BackgroundStory extends BaseBackground{constructor(e){super(e),__publicField(this,"defaultValue",null),__publicField(this,"isFloat",!1),__publicField(this,"floatWidget",null),makeObservable(this)}setFloat(e,t=!1){this.floatWidget=e,this.isFloat=t}setIsFloat(e=!1){this.isFloat=e}configRender(e){return jsx(BackgroundStoryConfig,{value:e.value,resource:this,onChange:t=>{e.onChange(t)}})}render(e){return jsx(BackgroundStoryRender,{resource:this,...e})}floatRender(e){return this.isFloat?jsx(BackgroundStoryRender,{...e,resource:this,isFloat:!0}):null}async onCopy(e,t){var r;const n=this.store.backgroundStories.find((t=>t.id===(null==e?void 0:e.id)));let o=cloneDeep$2(DEFAULT_RESOURCE);if(n){const i=await getAllWidgetResourceDependence(n.widgets,this.store.crudService),{resources:a,...s}=null!=(r=await n.backgroundLayer.onCopy(t))?r:{};return o=mergeResourceDependence(i,a),e&&(o.files=o.files.concat(Object.values(e.widgets).map((e=>null==e?void 0:e.degradeSource)).filter(Boolean))),{...s,[t]:getSnapshot(n),resources:o}}return null}async onPaste({value:e,sign:t,data:r,updateResourceInfo:n}){if(!r)return;const{[t]:o,templateId:i,templateName:a}=r;o&&o.id===(null==e?void 0:e.id)&&i!==this.store.id&&!this.store.backgroundStories.some((e=>e.id===o.id))&&await pasteStoryProcessor({key:BACKGROUND_TYPE$1.STORY_BACKGROUND,data:o,generateNewIds:!1,widgetInstanceManager:this.store.duchampServer.widgetInstanceManager,updateResourceInfo:n},(e=>{const t=createUniqueName(this.store.backgroundStories.map((e=>e.name)),"".concat(a,"_").concat(o.name,"_c"));e.setName(t),this.store.addBackgroundStory(e)}),this.store.crudService,this.store)}blurryLayer(e){var t;const r=null==(t=this.store.backgroundStories.find((t=>t.id===(null==e?void 0:e.id))))?void 0:t.backgroundLayer;return r&&isBlurryLayerAble(r.resource)?r.resource.blurryLayer(r.value):{}}preload(e){var t;const r=null==(t=this.store.backgroundStories.find((t=>t.id===(null==e?void 0:e.id))))?void 0:t.backgroundLayer;return r&&isPreloadAble(r.resource)?r.resource.preload(r.value):[]}}__publicField(BackgroundStory,"meta",{type:BACKGROUND_TYPE$1.STORY_BACKGROUND,name:duchampIntl.get("Duchamp-3d_Background"),scopes:["story"]}),__decorateClass$7([observable],BackgroundStory.prototype,"isFloat",2),__decorateClass$7([observable],BackgroundStory.prototype,"floatWidget",2),__decorateClass$7([action$1],BackgroundStory.prototype,"setFloat",1),__decorateClass$7([action$1],BackgroundStory.prototype,"setIsFloat",1);class BackgroundManager{constructor(){__publicField(this,"resources",new Map)}register(e){this.resources.set(e.meta.type,e)}get(e){return this.resources.get(e)}getMatched(e){return Array.from(this.resources.values()).filter((t=>isMatchedScope(e,t.meta.scopes)))}}const backgroundManager=new BackgroundManager,registerDuchampBackground=()=>{var e;backgroundManager.register(EmptyBackground),backgroundManager.register(ColorBackground),settingCenter.supportAppService(DUCHAMP_APP_SERVICE.REUSE)&&(null==(e=settingCenter.getResourceConfig())?void 0:e.resourceEnable)&&backgroundManager.register(InternalBackground),backgroundManager.register(CustomBackground),settingCenter.supportWidgetCheck(DUCHAMP_COMP_TYPE["3D"])&&backgroundManager.register(BackgroundStory)};var __defProp$7=Object.defineProperty,__getOwnPropDesc$6=Object.getOwnPropertyDescriptor,__decorateClass$6=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$6(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$7(t,r,i),i};class Background{constructor(e){__publicField(this,"host"),__publicField(this,"configCache",new Map),makeObservable(this),this.host=e,this.configCache.set(this.type,this.value)}get type(){return this.host.background.type}get value(){return toJS(this.host.background.value)}get resource(){const e=backgroundManager.get(this.type);return e?new e(this.host.store):new BaseBackground(this.host.store)}get color(){var e,t;return isColorBackground(this)?hexToRgba(this.value):null!=(t=null==(e=this.backgroundStory)?void 0:e.platform.backgroundLayer.color)?t:void 0}get backgroundStoryId(){var e;return isStoryBackground(this)?null==(e=this.value)?void 0:e.id:null}get backgroundStory(){return this.backgroundStoryId?this.host.store.backgroundStories.find((e=>e.id===this.backgroundStoryId)):null}setType(e){var t;backgroundManager.get(e)&&(this.host.setBackground({type:e,value:this.value}),this.setValue(null!=(t=this.getCache(e))?t:this.resource.defaultValue))}setValue(e=this.resource.defaultValue){const t=isObject$e(e)&&isObject$e(this.value)?{...this.value,...e}:e;this.host.setBackground({type:this.type,value:t}),this.configCache.set(this.type,t)}setBackground(e){this.setType(e.type),this.setValue(e.value)}getCache(e){return this.configCache.get(e)}render(e){return this.resource.render({...e,value:this.value})}floatRender(e){return this.resource.floatRender({...e,value:this.value})}configRender({onChange:e,...t}){return this.resource.configRender({...t,value:this.value,onChange:t=>{this.host.store.undoManager.withGroup((()=>{this.setValue(t),null==e||e(this)}))}})}async onCopy(e){return this.resource.onCopy(this.value,e)}async onPaste(e,t,r){return this.resource.onPaste({value:this.value,sign:e,data:t,updateResourceInfo:r})}deleteCache(e){this.configCache.has(e)&&this.configCache.delete(e)}}__decorateClass$6([computed],Background.prototype,"type"),__decorateClass$6([computed],Background.prototype,"value"),__decorateClass$6([computed],Background.prototype,"resource"),__decorateClass$6([computed],Background.prototype,"color"),__decorateClass$6([computed],Background.prototype,"backgroundStoryId"),__decorateClass$6([computed],Background.prototype,"backgroundStory"),__decorateClass$6([action$1],Background.prototype,"setType"),__decorateClass$6([action$1],Background.prototype,"setValue"),__decorateClass$6([action$1],Background.prototype,"setBackground");var __defProp$6=Object.defineProperty,__getOwnPropDesc$5=Object.getOwnPropertyDescriptor,__decorateClass$5=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$5(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$6(t,r,i),i};const DEFAULT_MOBILE_STORY={padding:{top:4,right:4,bottom:4,left:4},widgetGap:4};class MobileStoryAdaptor extends MobileAdaptor{constructor(){super(...arguments),__publicField(this,"backgroundLayer",new Background(this)),__publicField(this,"debounceSetPadding",debounce$4((e=>{this.store.undoManager.withGroup((()=>{const t=this.padding;this.update({padding:e}),this.updateMagneticOptions({options:this.magneticOptions,preOptions:{...this.magneticOptions,padding:t},keepRatio:!0})}))}),500))}get autoGroupsConfig(){return this.mobile.autoGroupsConfig||{enabled:!0}}setAutoGroupsConfig(e){this.update({autoGroupsConfig:{...this.autoGroupsConfig,...e}})}get store(){return this.model.store}get background(){const e=this.mobile.background||this.model.background;return e.type===BACKGROUND_TYPE$1.STORY_BACKGROUND?{type:"empty"}:e}get padding(){return this.mobile.padding||DEFAULT_MOBILE_STORY.padding}get widgetGap(){var e;return null!=(e=this.mobile.widgetGap)?e:DEFAULT_MOBILE_STORY.widgetGap}get alignmentLines(){var e;return this.model.store.isMagneticLayout?null!=(e=this.mobile.alignmentLines)?e:[]:this.model.alignmentLines}setBackground(e){this.update({background:e})}setPadding(e){this.padding!==e&&this.debounceSetPadding(e)}setWidgetGap(e){e!==this.widgetGap&&this.store.undoManager.withGroup((()=>{const t=this.widgetGap;this.update({widgetGap:e}),this.updateMagneticOptions({options:this.magneticOptions,preOptions:{...this.magneticOptions,gap:t},keepRatio:!0})}))}setAlignmentLines(e){if(!this.model.store.isMagneticLayout)return this.model.setAlignmentLines(e);this.update({alignmentLines:e})}get widgetOrders(){return this.mobile.widgetOrders||this.widgets.filter((e=>!e.parent)).map((e=>e.id))}setWidgetOrder(e){this.update({widgetOrders:e})}updateWidgetOrders(){const e=sortWidgetsPlatformPosition(this.sortedRootWidgets).map((e=>e.id)),t=this.widgetOrders;isEqual$4(e,t)||(this.mobile.widgetOrders||isOrdersChange(e,t))&&this.setWidgetOrder(updateWidgetOrders(this.rootWidgets,e,t))}get widgets(){return this.store.isMagneticLayout?sortWidgetsByPosition(this.model.widgets.filter((e=>e.platform.mobile.isCanvasValid())).reverse()):this.model.widgets}get reverseWidgets(){return[...this.widgets].reverse()}get mobileWidgets(){return this.widgets.filter((e=>e.model.platformSupport))}get rootWidgets(){return sortWidgetsByOrders(this.widgets.filter((e=>!e.parent)),this.mobile.widgetOrders||[])}get rootMobileWidget(){return this.rootWidgets.filter((e=>e.model.platformSupport))}get sortedRootWidgets(){if(!this.store.isMagneticLayout){const e=this.widgets.find((e=>e.id===this.model.widgetFloatTop)),t=this.mobileWidgets.filter((e=>e.id!==this.model.widgetFloatTop&&!e.parent));return e?[...t,e]:t}return this.rootMobileWidget.filter((e=>e.visibleInStory))}get currentWidgets(){return this.mobileWidgets.filter((e=>this.model.currents.has(e.id)))}get magneticWidth(){return this.store.platform.mobile.width}get magneticOptions(){return{width:this.magneticWidth,padding:this.padding,gap:this.widgetGap,offset:{left:0,top:0}}}get hasMobileLayoutInfo(){var e;return this.widgets.some((e=>e.mobile.states))||!!(null==(e=this.model.mobile.widgetOrders)?void 0:e.length)}updateAllWidgetOrders(){this.updateWidgetOrders(),this.widgets.forEach((e=>{const{mobile:t}=e.platform;t.updateWidgetOrders()}))}transferMagneticLayout(e){transferMagneticWidgets({widgets:this.sortedRootWidgets,options:this.magneticOptions,sizeGetter:t=>{const{width:r,height:n}=getWidgetMagneticSize(t);return setMagneticWidgetStates({widget:t,states:{width:r,height:n,matrix:t.model.states.matrix},onlyCache:e}),isStructureWidget(t)&&t.getInstance().updateByChildren(e),pick(t.model.states,["width","height"])},onlyCache:e}),this.updateAllWidgetOrders()}updateMagneticOptions({options:e,preOptions:t,keepRatio:r}){const n=getMagneticContainerWidth(e)/getMagneticContainerWidth(t);this.store.undoManager.withGroup((()=>{transferMagneticWidgets({widgets:this.sortedRootWidgets,options:e,sizeGetter:e=>{const t=e.mobile.states;if(!isNil$3(null==t?void 0:t.width)&&!isNil$3(null==t?void 0:t.height)){const{width:e,height:o}=t;return{width:r?Math.round(e*n):e,height:r?Math.round(o*n):o}}return getWidgetMagneticSize(e)},onlyCache:!0})}))}adjustCurrentWidth(e){this.store.undoManager.withGroup((()=>{this.currentWidgets.forEach((t=>{const r=Math.round(getParentContainerInnerWidth(t)*e);t.setRectStatesWithEffect({width:r,height:t.platform.mobile.states.height})})),this.transferMagneticLayout()}))}widgetLayerMove(e,t){var r;const n=new WidgetDragManager(e,t,this.reverseWidgets);if(!isWidgetsInMagneticLayout([e]))return void new OrderTool(this.model).widgetLayerMove(e,t);if(!n.isValidDragIntoInfo.valid)return;const o=null==(r=n.dragContainer)?void 0:r.getInstance(),i=n.dragContainer?n.dragContainer.platform.mobile:this,{gap:a,padding:s,offset:l={left:0,top:0}}=isMagneticWidget(o)?o.magneticOptions:this.magneticOptions,c=i.widgetOrders.slice(),u=i.widgetOrders.indexOf(e.id),d=i.widgetOrders.indexOf(t.id);c.splice(u,1),c.splice(d,0,e.id);const h=this.widgets.find((e=>e.id===c[d-1]));this.store.undoManager.withGroup((()=>{e.setPosition(h?h.rect.left+h.rect.width+a:s.left+l.left,h?h.rect.top:s.top+l.top),i.setWidgetOrder(c),this.transferMagneticLayout()}))}get placeholderRect(){const e=calculateAreaBound(this.sortedRootWidgets.map((e=>e.model.states)));return{left:0,top:0,width:this.magneticWidth,height:e.height+this.padding.top+this.padding.bottom}}updateWithUndo(){this.transferMagneticLayout(!0)}onPaste(e){if(!this.mobile.widgetOrders)return;const t=this.mobile.widgetOrders.map((t=>{const r=e.findIndex((({fromWidgetId:e})=>t===e));return r>=0?e[r].widget.id:t}));this.setWidgetOrder(t)}}function correctMagneticBounds(e,t){const{padding:r,width:n}=t;return e.forEach((e=>{e.left=Math.max(Math.min(e.left,n-r.right-e.width),r.left),e.width=Math.min(e.width,n-r.left-r.right)})),e}__decorateClass$5([observable],MobileStoryAdaptor.prototype,"backgroundLayer",2),__decorateClass$5([computed],MobileStoryAdaptor.prototype,"autoGroupsConfig",1),__decorateClass$5([action$1],MobileStoryAdaptor.prototype,"setAutoGroupsConfig",1),__decorateClass$5([computed],MobileStoryAdaptor.prototype,"background",1),__decorateClass$5([computed],MobileStoryAdaptor.prototype,"padding",1),__decorateClass$5([computed],MobileStoryAdaptor.prototype,"widgetGap",1),__decorateClass$5([computed],MobileStoryAdaptor.prototype,"alignmentLines",1),__decorateClass$5([action$1],MobileStoryAdaptor.prototype,"setBackground",1),__decorateClass$5([action$1],MobileStoryAdaptor.prototype,"setPadding",1),__decorateClass$5([action$1],MobileStoryAdaptor.prototype,"setWidgetGap",1),__decorateClass$5([action$1],MobileStoryAdaptor.prototype,"setAlignmentLines",1),__decorateClass$5([computed],MobileStoryAdaptor.prototype,"widgetOrders",1),__decorateClass$5([action$1],MobileStoryAdaptor.prototype,"setWidgetOrder",1),__decorateClass$5([computed],MobileStoryAdaptor.prototype,"widgets",1),__decorateClass$5([computed],MobileStoryAdaptor.prototype,"reverseWidgets",1),__decorateClass$5([computed],MobileStoryAdaptor.prototype,"mobileWidgets",1),__decorateClass$5([computed],MobileStoryAdaptor.prototype,"rootWidgets",1),__decorateClass$5([computed],MobileStoryAdaptor.prototype,"rootMobileWidget",1),__decorateClass$5([computed],MobileStoryAdaptor.prototype,"sortedRootWidgets",1),__decorateClass$5([computed],MobileStoryAdaptor.prototype,"currentWidgets",1),__decorateClass$5([computed],MobileStoryAdaptor.prototype,"magneticWidth",1),__decorateClass$5([computed],MobileStoryAdaptor.prototype,"magneticOptions",1),__decorateClass$5([computed],MobileStoryAdaptor.prototype,"hasMobileLayoutInfo",1),__decorateClass$5([computed],MobileStoryAdaptor.prototype,"placeholderRect",1);const DEFAULT_MAGNETIC_OPTIONS={gap:0,padding:{left:0,right:0,top:0,bottom:0},offset:{top:0,left:0}};function sortMagneticItems(e){return cloneDeep$2(e).sort(((e,t)=>e.top>t.top||e.top===t.top&&e.left>t.left?1:e.top===t.top&&e.left===t.left?0:-1))}function compactMagneticItems(e,t){const r=sortMagneticItems(e),n=[],o=[];return r.forEach((r=>{const i=compactMagneticItem(r,n,t);n.push(i),o[e.findIndex((e=>e.id===i.id))]=i})),o}function isLayoutOverlap(e,t){return e.id!==t.id&&!(e.left+e.width<=t.left||e.left>=t.left+t.width||e.top+e.height<=t.top||e.top>=t.top+t.height)}function getFirstOverlap(e,t){return t.find((t=>isLayoutOverlap(e,t)))}function getAllOverlap(e,t){return t.filter((t=>isLayoutOverlap(e,t)))}function compactMagneticItem(e,t,r){const{padding:n,gap:o}=r,i=t.map((e=>({...e,height:e.height+o}))),a=Array.from(new Set([...getMagneticBottoms(i),n.top]));let s=a[0];for(const l of a){if(getFirstOverlap({...e,top:l},i))break;s=l}return{...e,top:s}}function getMagneticBottoms(e){return e.map((e=>e.top+e.height)).sort(((e,t)=>t-e))}function transferMagneticLayout(e,t){const r={...DEFAULT_MAGNETIC_OPTIONS,...t},{offset:n}=r;return compactMagneticItems(correctMagneticBounds(e.map((e=>({...e,left:e.left-n.left,top:e.top-n.top}))),r),r).map((e=>({...e,left:e.left+n.left,top:e.top+n.top})))}function moveMagneticItem(e,t,r){if(t.left===r.left&&t.top===r.top)return e;const n={...t,...r},o=e.findIndex((e=>e.id===n.id));o>=0&&(e[o]=n);const i=sortMagneticItems(e),a=t.top>r.top;a&&i.reverse();return getAllOverlap(n,e).forEach((e=>{a&&n.top<=e.top+e.height/2&&(e.top=n.top+1),!a&&n.top+n.height>=e.top+e.height/2&&(e.top=n.top-1)})),e}function defaultSizeGetter(e){return getWidgetMagneticSize(e)}function transferMagneticWidgetLayout({widgets:e,options:t,sizeGetter:r=defaultSizeGetter}){const{padding:n}=t;let o=n.top;return transferMagneticLayout(e.map((e=>{var i;const{width:a,height:s}=r(e,t),l=null==(i=e.mobile.states)?void 0:i.matrix,c=l?l[4]:n.left,u=Math.max(l?l[5]:o,o);return o=u+s,{id:e.id,left:c,top:u,width:a,height:s,keepRatio:e.platform.states.keepRatio}})),t).map((e=>({...e,top:e.top,left:e.left})))}function transferMagneticWidgets({widgets:e,options:t,sizeGetter:r=defaultSizeGetter,onlyCache:n}){transaction((()=>{transferMagneticWidgetLayout({widgets:e,options:t,sizeGetter:r}).forEach((({id:t,left:r,top:o,width:i,height:a})=>{const s=e.find((e=>e.id===t));if(!s)return;setMagneticWidgetStates({widget:s,states:{matrix:[1,0,0,1,r,o],width:i,height:a},onlyCache:n})}))}))}function setMagneticWidgetStates({widget:e,states:t,onlyCache:r,preState:n={...e.states,...r?e.mobile.states:e.platform.mobile.magneticStates}}){isEqual$4(pick(n,Object.keys(t)),t)&&isAllSetChildrenMobileStates(e)&&(e.mobile.states||r)||e.platform.mobile.setStates(t,r),isStructureWidget(e)&&e.getInstance().updateChildrenRectStates({cur:t,pre:n,onlyCache:r})}function isAllSetChildrenMobileStates(e){if(!isStructureWidget(e))return!0;return e.platform.mobile.childWidgets.every((e=>!!e.mobile.states&&isAllSetChildrenMobileStates(e)))}function getMagneticContainerWidth(e={padding:DEFAULT_MOBILE_STORY.padding,gap:DEFAULT_MOBILE_STORY.widgetGap,width:DEFAULT_MOBILE_SIZE.width}){return e.width-e.padding.left-e.padding.right}function sortWidgetsByPosition(e){return e.slice().sort(((e,t)=>{const[r,n]=new Transform$2(e.states.matrix).getPosition(),[o,i]=new Transform$2(t.states.matrix).getPosition();return n===i?r-o:n-i}))}function sortWidgetsPlatformPosition(e){return e.slice().sort(((e,t)=>{const[r,n]=e.position,[o,i]=t.position;return n===i?r-o:n-i}))}function getWidgetMagneticSize(e){const t=e.mobile.states;return(null==t?void 0:t.width)&&(null==t?void 0:t.height)?{width:t.width,height:t.height}:e.store.platform.mobile.isFluidToMagneticLayout?getWidgetMagneticSizeByOldFluidLayout(e,e.states):calculateMagneticWidgetRatioSize(e,e.states)}function getWidgetMagneticSizeByOldFluidLayout(e,t){var r,n,o;const{parentContainerWidget:i,story:a}=e,s=null!=(r=null==a?void 0:a.platform.mobile.padding)?r:DEFAULT_MOBILE_STORY.padding,l=(null==a?void 0:a.platform.mobile.widgetGap)||DEFAULT_MOBILE_STORY.widgetGap,c=null==(o=null==(n=e.meta.configure)?void 0:n.mobile)?void 0:o.fluidHeightGrid,u=(FLUID_LAYOUT_CONFIG.HEIGHT-l)/FLUID_LAYOUT_CONFIG.GRID,d=e.store.platform.mobile.width/FLUID_LAYOUT_CONFIG.WIDTH;let h;if(i){if(isMagneticWidget(i.model)){const{width:e,padding:t}=i.model.magneticOptions;h=e-t.left-t.right}}else h=e.model.store.platform.width-s.left-s.right;const{width:p=e.states.width,height:f=e.states.height}=t;return{width:null!=h?h:p,height:isNil$3(c)?isNil$3(h)?f:h/p*f:(c*u-l)*d}}function calculateMagneticWidgetRatioSize(e,t){var r,n;const o="ratio"===(null==(n=null==(r=e.meta.configure)?void 0:r.mobile)?void 0:n.magneticHeightRule),{parentContainerWidget:i,story:a}=e;let s;if(i){if(isMagneticWidget(i.model)){const{width:e,padding:t}=i.model.magneticOptions;s=e-t.left-t.right}}else{const t=a?a.platform.mobile.padding:{top:0,left:0,right:0,bottom:0};s=e.model.store.platform.width-t.left-t.right}const{width:l=e.states.width,height:c=e.states.height}=t;return{width:null!=s?s:l,height:o&&!isNil$3(s)?s/l*c:c}}function isOrdersChange(e,t){let r=-1;return e.some((e=>{const n=t.indexOf(e);return-1!==n&&(n<r||(r=n,!1))}))}function sortWidgetsByOrders(e,t){if(t.length>0){const r=groupBy(e,(e=>(null==t?void 0:t.includes(e.id))?0:1));return[...(r[0]||[]).sort(((e,r)=>t.indexOf(e.id)-t.indexOf(r.id))),...r[1]||[]]}return e}function updateWidgetOrders(e,t,r){let n=0;r.forEach(((o,i)=>{const a=e.find((e=>e.id===o));a&&(a.visible||t.includes(o)||t.splice(t.indexOf(r[n])+1,0,o),t.includes(o)&&(n=i))}));const o=[];let i=0,a=0;for(;a<t.length;)i>=r.length?(o.push(t[a]),a++):o.includes(r[i])?i++:(o.push(t[a]),a++,r[i]===t[a]&&i++);return o}function getParentContainerInnerWidth(e){var t,r;return e.parentWidget?isMagneticWidget(null==(r=e.parentWidget)?void 0:r.model)?getMagneticContainerWidth(e.parentWidget.model.magneticOptions):e.parentWidget.model.width:getMagneticContainerWidth(null==(t=e.story)?void 0:t.platform.mobile.magneticOptions)}function adjustMagneticStates(e,t){const{width:r,height:n,matrix:o,keepRatio:i}=e,a=new Transform$2(o),s=a.getPosition(),l=s[0],c=s[1],{top:u,left:d,width:h}=t;if(isNil$3(h))return{width:r,height:n,matrix:a.setTranslate(Math.max(l,d),Math.max(c,u)).matrix};const p=Math.min(r,h);let f=l;return l+r>d+h&&(f=d+h-r),f=Math.max(f,d),{width:p,height:i?Math.round(p/r*n):n,matrix:a.setTranslate(f,Math.max(c,u)).matrix}}var __defProp$5=Object.defineProperty,__getOwnPropDesc$4=Object.getOwnPropertyDescriptor,__decorateClass$4=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$4(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$5(t,r,i),i};class MobileWidgetAdaptor extends MobileAdaptor{constructor(e){super(e),__publicField(this,"cacheStates"),makeObservable(this)}init(){this.disposes.push(reaction((()=>{const e=this.model.parentWidget;return{parent:e,parentId:this.model.parent,parentWidgets:this.model.parentWidgets,parentChildren:(null==e?void 0:e.platform.mobile.childWidgets)||[]}}),((e,t)=>{if(this.mobile.states)for(const r of parentChangeProcessor){const n={adaptor:this,cur:e,prev:t};if(r.access(n)){r.handler(n);break}}}),{equals:(e,t)=>e.parentId===t.parentId}))}setCacheStates(e){this.cacheStates=e}get isWidgetZoomed(){const e=this.model.getInstance();return isInstanceofZoomable(e)&&e.isZoomed}get previewScale(){return this.model.store.platform.mobile.previewScale}get width(){if(this.isWidgetZoomed){const{screenSize:e}=this.model.store.platform.mobile,{padding:t}=this.model.platform;return e.width/this.previewScale-t.left-t.right-2*this.model.borderWidth}return this.model.width}get height(){if(this.isWidgetZoomed){const{screenSize:e,toolHeightManager:t}=this.model.store.platform.mobile,{padding:r}=this.model.platform;return(e.height-t.toolbarHeight)/this.previewScale-r.top-r.bottom-2*this.model.borderWidth}return this.model.height}get magneticStates(){const{states:e}=this.mobile;return{...this.cacheStates,...e}}get visible(){var e;return!!this.model.getInstance().platformSupport&&(widgetIsGroup(this.model)?this.model.childWidgets.some((e=>e.visible)):this.model.store.isMagneticLayout?!(null!=(e=this.mobile.hide)?e:this.model.hide):!this.model.hide)}setVisible(e){this.model.store.isMagneticLayout?this.update({hide:!e}):this.model.setHide(!e),this.model.childWidgets.forEach((t=>t.setVisible(e)))}get lock(){return!this.model.store.isMagneticLayout&&this.model.lock}get border(){return this.mobile.border}get resourceCenter(){return this.model.store.resourceCenter}setBorder(e){const t=getPadding(this.resourceCenter,e);this.update({border:e,borderHue:0,borderBrightness:0,borderSaturation:0,borderContrast:0,borderOpacity:100,fillType:hasImageSlice(this.resourceCenter,e)?FILL_TYPE.BORDER:FILL_TYPE.BACKGROUND,backgroundFillType:BACKGROUND_FILL_TYPE.AUTO,...t&&"chart"===widgetManager.getWidgetByName(this.model.type).widgetType?{padding:t}:{}})}get borderHue(){return this.mobile.borderHue}setBorderHue(e){this.update({borderHue:e})}get borderContrast(){return this.mobile.borderContrast}setBorderContrast(e){this.update({borderContrast:e})}get borderSaturation(){return this.mobile.borderSaturation}setBorderSaturation(e){this.update({borderSaturation:e})}get borderBrightness(){return this.mobile.borderBrightness}setBorderBrightness(e){this.update({borderBrightness:e})}get borderOpacity(){return this.mobile.borderOpacity}setBorderOpacity(e){this.update({borderOpacity:e})}get borderScale(){return this.mobile.borderScale}setBorderScale(e){this.update({borderScale:e})}get fillType(){return this.mobile.fillType}setFillType(e){this.update({fillType:e})}get backgroundFillType(){return this.mobile.backgroundFillType}setBackgroundFillType(e){this.update({backgroundFillType:e})}get borderLine(){return this.mobile.borderLine}setBorderLine(e){this.update({borderLine:e})}get borderRadius(){return this.mobile.borderRadius}setBorderRadius(e){this.update({borderRadius:e})}get padding(){return this.mobile.padding}setPadding(e){this.update({padding:e})}get opacity(){return this.mobile.opacity}setOpacity(e){this.update({opacity:e})}get props(){var e;return null!=(e=this.mobile.props)?e:{}}setValue(e){this.update({props:{...toJS(this.props),...e}})}setNavigationText(e){const t=toJS(this.props);set$3(t,"previewConfig.navigation.text",e),this.setValue(t)}get carousel(){return this.mobile.carousel}setCarousel(e){this.update({carousel:e})}get sortedChildWidgets(){const e=this.model.children.reduce(((e,t)=>{const r=this.model.getWidgetById(t);return r&&e.push(r),e}),[]);return this.model.store.isMagneticLayout?sortWidgetsByPosition(e):e}get childWidgets(){return this.model.store.isMagneticLayout&&isMagneticWidget(this.model.getInstance())?sortWidgetsByOrders(this.sortedChildWidgets,this.widgetOrders||[]):this.model.childWidgets}get layoutChildWidgets(){return this.model.store.isMagneticLayout&&isMagneticWidget(this.model.getInstance())?this.childWidgets:this.model.layoutChildWidgets}get widgetOrders(){return this.mobile.widgetOrders||this.sortedChildWidgets.map((e=>e.id))}setWidgetOrder(e){this.update({widgetOrders:e})}updateWidgetOrders(){const e=sortWidgetsPlatformPosition(this.childWidgets.filter((e=>e.visibleInStory))).map((e=>e.id)),t=this.widgetOrders;isEqual$4(e,t)||(this.mobile.widgetOrders||isOrdersChange(e,t))&&this.setWidgetOrder(updateWidgetOrders(this.childWidgets,e,t))}get states(){var e,t;if(!this.model.store.isMagneticLayout)return this.model.states;const{states:r}=this.model,n=null!=(t=null==(e=this.mobile.states)?void 0:e.keepRatio)&&t;return{...r,...this.magneticStates,keepRatio:n}}setStates(e,t){var r;if(!e)return void this.update({states:void 0});!isNil$3(e.width)&&(e.width=round$3(e.width)),!isNil$3(e.height)&&(e.height=round$3(e.height)),!isNil$3(e.matrix)&&(e.matrix=e.matrix.map((e=>round$3(e))));const n={...toJS(this.mobile.states),...omitBy$1(e,isNil$3||isNaN)};t&&isNil$3(null==(r=this.mobile.states)?void 0:r.width)?this.setCacheStates(n):this.update({states:n})}get backdropFilter(){return this.mobile.backdropFilter}setBackdropFilter(e){this.update({backdropFilter:e})}get boxReflect(){return this.mobile.boxReflect}setBoxReflect(e){this.update({boxReflect:e})}get boxShadowEffect(){return this.mobile.boxShadowEffect}setBoxShadowEffect(e){this.update({boxShadowEffect:e})}setRectStatesWithEffect(e,t){var r;const{magneticBounds:n}=this.model.getInstance();n&&!t&&(e={...e,...adjustMagneticStates({...this.states,...e},n)}),isStructureWidget(this.model)&&this.model.getInstance().updateChildrenRectStates({cur:{...getWidgetMagneticSize(this.model),...e},pre:this.model.model.states,onlyCache:t}),this.setStates(e,t),null==(r=this.model.parentWidget)||r.updateByChildren()}isCanvasValid(){const e=first(this.model.parentWidgets);return e?e.platform.mobile.isCanvasValid():this.model.store.widgetsIsOnCanvas([this.model])}}__decorateClass$4([observable],MobileWidgetAdaptor.prototype,"cacheStates",2),__decorateClass$4([action$1],MobileWidgetAdaptor.prototype,"setCacheStates",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"magneticStates",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"visible",1),__decorateClass$4([action$1],MobileWidgetAdaptor.prototype,"setVisible",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"border",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"resourceCenter",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"borderHue",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"borderContrast",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"borderSaturation",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"borderBrightness",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"borderOpacity",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"borderScale",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"fillType",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"backgroundFillType",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"borderLine",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"borderRadius",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"padding",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"opacity",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"props",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"carousel",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"childWidgets",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"layoutChildWidgets",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"widgetOrders",1),__decorateClass$4([action$1],MobileWidgetAdaptor.prototype,"setWidgetOrder",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"states",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"backdropFilter",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"boxReflect",1),__decorateClass$4([computed],MobileWidgetAdaptor.prototype,"boxShadowEffect",1);var __defProp$4=Object.defineProperty,__getOwnPropDesc$3=Object.getOwnPropertyDescriptor,__decorateClass$3=(e,t,r,n)=>{for(var o,i=__getOwnPropDesc$3(t,r),a=e.length-1;a>=0;a--)(o=e[a])&&(i=o(t,r,i)||i);return i&&__defProp$4(t,r,i),i};class PlatformWidget{constructor(e){__publicField(this,"model"),__publicField(this,"mobile"),this.model=e,this.mobile=new MobileWidgetAdaptor(e),makeObservable(this)}get platformProps(){return this.model.props}get width(){return this.model.width}get height(){return this.model.height}get props(){return this.model.props}get border(){return this.model.border}get borderHue(){return this.model.borderHue}get borderOpacity(){return this.model.borderOpacity}get borderBrightness(){return this.model.borderBrightness}get borderSaturation(){return this.model.borderSaturation}get borderContrast(){return this.model.borderContrast}get borderScale(){return this.model.borderScale}get fillType(){return this.model.fillType}get backgroundFillType(){return this.model.backgroundFillType}get borderLine(){return this.model.borderLine}get borderRadius(){return this.model.borderRadius}get padding(){return this.model.padding}get opacity(){return this.model.opacity}get lock(){return this.model.lock}get carousel(){return this.model.getInstance().isMobile?{...this.model.carousel,...this.mobile.carousel}:this.model.carousel}setBorder(e){}setBorderHue(e){}setBorderOpacity(e){}setBorderBrightness(e){}setBorderContrast(e){}setBorderSaturation(e){}setBorderScale(e){}setFillType(e){}setBackgroundFillType(e){}setBorderLine(e){}setBorderRadius(e){}setPadding(e){}setOpacity(e){}setBackdropFilter(e){}get states(){return this.model.states}get backdropFilter(){return this.model.backdropFilter}get boxReflect(){return this.model.boxReflect}get boxShadowEffect(){return this.model.boxShadowEffect}}__decorateClass$3([computed],PlatformWidget.prototype,"platformProps"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"width"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"height"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"props"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"border"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"borderHue"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"borderOpacity"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"borderBrightness"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"borderSaturation"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"borderContrast"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"borderScale"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"fillType"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"backgroundFillType"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"borderLine"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"borderRadius"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"padding"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"opacity"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"lock"),__decorateClass$3([platformAction],PlatformWidget.prototype,"setBorder"),__decorateClass$3([platformAction],PlatformWidget.prototype,"setBorderHue"),__decorateClass$3([platformAction],PlatformWidget.prototype,"setBorderOpacity"),__decorateClass$3([platformAction],PlatformWidget.prototype,"setBorderBrightness"),__decorateClass$3([platformAction],PlatformWidget.prototype,"setBorderContrast"),__decorateClass$3([platformAction],PlatformWidget.prototype,"setBorderSaturation"),__decorateClass$3([platformAction],PlatformWidget.prototype,"setBorderScale"),__decorateClass$3([platformAction],PlatformWidget.prototype,"setFillType"),__decorateClass$3([platformAction],PlatformWidget.prototype,"setBackgroundFillType"),__decorateClass$3([platformAction],PlatformWidget.prototype,"setBorderLine"),__decorateClass$3([platformAction],PlatformWidget.prototype,"setBorderRadius"),__decorateClass$3([platformAction],PlatformWidget.prototype,"setPadding"),__decorateClass$3([platformAction],PlatformWidget.prototype,"setOpacity"),__decorateClass$3([platformAction],PlatformWidget.prototype,"setBackdropFilter"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"states"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"backdropFilter"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"boxReflect"),__decorateClass$3([platformComputed],PlatformWidget.prototype,"boxShadowEffect");var __defProp$3=Object.defineProperty,__getOwnPropDesc$2=Object.getOwnPropertyDescriptor,__decorateClass$2=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$2(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$3(t,r,i),i};const DefaultBorderRadius={type:"px",value:0},DefaultBorder={format:"whole",topLeft:DefaultBorderRadius,topRight:DefaultBorderRadius,bottomLeft:DefaultBorderRadius,bottomRight:DefaultBorderRadius},DEFAULT_BORDER_LINE={borderStyle:"none",borderWidth:1,borderColor:"#ADADADFF"};function memoizeFn(e){const t=memoize$5(e,(e=>e.id));return e=>t(e)}const flattenGroupChildWidgets=e=>e.childWidgets.reduce(((e,t)=>(widgetIsGroup(t)?e.push(...t.flattenGroupChildWidgets):e.push(t),e)),[]),flattenChildWidgets=e=>[e,...flatten$1(e.childWidgets.map((e=>e.flattenChildWidgets)))];let Widget=class extends(Model$1({id:idProp,name:prop().withSetter(),states:prop((()=>WIDGET_STATES)),children:prop((()=>[])).withSetter(),parent:prop("").withSetter(),type:prop(),widgetType:prop(),props:prop((()=>({}))),extras:prop((()=>({}))),opacity:prop(100).withSetter(),backdropFilter:prop((()=>({enabled:!1,blur:10}))).withSetter(),borderRadius:prop((()=>DefaultBorder)).withSetter(),boxReflect:prop(!1),boxShadowEffect:prop((()=>({enabled:!1,boxShadow:[]}))),padding:prop((()=>({top:0,right:0,bottom:0,left:0}))).withSetter(),border:prop((()=>({type:"empty"}))),borderLine:prop((()=>DEFAULT_BORDER_LINE)).withSetter(),borderHue:prop((()=>0)).withSetter(),borderOpacity:prop((()=>100)).withSetter(),borderBrightness:prop((()=>0)).withSetter(),borderSaturation:prop((()=>0)).withSetter(),borderContrast:prop((()=>0)).withSetter(),borderScale:prop((()=>1)).withSetter(),fillType:prop(FILL_TYPE.BACKGROUND).withSetter(),backgroundFillType:prop(BACKGROUND_FILL_TYPE.AUTO).withSetter(),transform3d:prop((()=>({perspective:500,rotateX:0,rotateY:0,rotateZ:0}))),hide:prop(!1).withSetter(),lock:prop(!1),refresh:prop(!1).withSetter(),carousel:prop((()=>{})).withSetter(),version:prop("").withSetter(),widgetEvents:prop((()=>[])).withSetter(),mobile:prop((()=>({}))).withSetter(),forkId:prop("").withSetter()},{toSnapshotProcessor(e){const t=widgetManager.getWidgetByName(e.type);return t.version!==e.version&&(e.version=t.version),{...e}}})){constructor(){super(...arguments),__publicField(this,"platform",new PlatformWidget(this)),__publicField(this,"_store"),__publicField(this,"transitionStatus","finish"),__publicField(this,"transitionKey"),__publicField(this,"target"),__publicField(this,"initializing",!1),__publicField(this,"loading",!1),__publicField(this,"warning"),__publicField(this,"widgetError")}get store(){var e;return this._store||(this._store=null!=(e=getRootStore(this))?e:new Store({}),this._store.duchampServer.register(this)),this._store}setStore(e){this._store=e,this._store.duchampServer.register(this)}onInit(){this.states={...WIDGET_STATES,...this.states}}onAttachedToRootStore(e){this.getInstance()||(this._store=e,e.duchampServer.register(this))}get editAdaptPlatform(){return this.store.isPreview?this.platform:this}get borderWidth(){const{borderLine:e}=this.platform;return"none"===e.borderStyle||isEmpty$3(e.borderStyle)?0:e.borderWidth}get width(){const{states:e,padding:t}=this.platform;return e.width-t.left-t.right-2*this.borderWidth}get height(){const{states:e,padding:t}=this.platform;return e.height-t.top-t.bottom-2*this.borderWidth}get layoutRect(){const{padding:e}=this.platform,{left:t,top:r}=this.rect;return{left:t+e.left+this.borderWidth,top:r+e.top+this.borderWidth,width:this.width,height:this.height}}get transform3dCSS(){return this.transform3d.rotateX||this.transform3d.rotateY||this.transform3d.rotateZ?"perspective(".concat(this.transform3d.perspective,"px) rotateX(").concat(this.transform3d.rotateX,"deg) rotateY(").concat(this.transform3d.rotateY,"deg) rotateZ(").concat(this.transform3d.rotateZ,"deg)"):void 0}get visible(){return widgetIsGroup(this)?this.childWidgets.some((e=>e.visible)):"visible"in this.props?this.props.visible:!this.hide}setVisible(e){"visible"in this.props&&delete this.props.visible,this.setHide(!e),this.childWidgets.forEach((t=>t.setVisible(e)))}setLock(e){this.lock=e,this.childWidgets.forEach((t=>{t.setLock(e)}))}setTransitionStatus(e){this.transitionStatus=e}setTransitionKey(e){this.transitionKey=e}setTarget(e,t=0){0===t&&(this.target=e)}setInitializing(e){this.initializing=e}setLoading(e){this.loading=e}get busying(){return this.loading||this.initializing}setWarning(e){this.warning=e}clearWarning(){this.warning=void 0}setWidgetError(e){this.widgetError=e}clearWidgetError(){this.widgetError=void 0}setStates(e){if(this.store.isMagneticLayout)return void this.platform.mobile.setStates(e);const t={...this.states,...omitBy$1(e,isNil$3||isNaN)};this.states={...t,width:round$3(t.width),height:round$3(t.height),matrix:t.matrix.map((e=>round$3(e)))}}setPosition(e,t){this.setRectStatesWithEffect({matrix:new Transform$2(this.platform.states.matrix).setTranslate(e,t).matrix})}updateRect(e){const{width:t,height:r,left:n,top:o}=e;this.setStates({width:t,height:r,matrix:[1,0,0,1,n,o]})}setAnimation(e){this.states={...this.states,animation:e}}setTransform3d(e){this.transform3d={...this.transform3d,...e}}setBoxReflect(e){this.boxReflect=e}setBoxShadowEffect(e){this.boxShadowEffect=e}replaceChildren(e,t,r){const n=this.children.slice();n.splice(null!=r?r:this.children.length,0,...t),this.setChildren(n.filter((t=>!e.includes(t)))),this.updateByChildren()}updateByChildren(e){isStructureWidget(this)&&this.getInstance().updateByChildren(e)}setRectStatesWithEffect(e,t=!0){var r;this.store.isMagneticLayout?this.platform.mobile.setRectStatesWithEffect(e):(isStructureWidget(this)&&this.getInstance().updateChildrenRectStates({cur:e,pre:this.platform.states}),this.setStates(e),t&&(null==(r=this.parentWidget)||r.updateByChildren()))}setValue(e){this.props={...this.props,...e}}setValueWidthOutUndo(e){this.store.undoManager.withoutUndo((()=>{this.setValue(e)}))}updateProps(e,t){this.store.undoManager.withoutUndo((()=>{set$3(this.props,e,t)}))}setExtrasValue(e){this.store.undoManager.withoutUndo((()=>{this.extras={...this.extras,...e}}))}getValue(){return this.props}getExtrasValue(){return this.extras}setBorder(e){this.border=e,this.borderHue=0,this.borderOpacity=100,this.borderBrightness=0,this.borderContrast=0,this.borderSaturation=0,this.fillType=hasImageSlice(this.store.resourceCenter,e)?FILL_TYPE.BORDER:FILL_TYPE.BACKGROUND,this.backgroundFillType=BACKGROUND_FILL_TYPE.AUTO;const t=getPadding(this.store.resourceCenter,e);t&&"chart"===widgetManager.getWidgetByName(this.type).widgetType&&(this.padding=t)}move(e,t=1){const[r,n]=this.position,{minLeft:o=-1/0,minTop:i=-1/0,maxLeft:a=1/0,maxTop:s=1/0}=getWidgetLimitRect(this.platform.states,this.model.limitRect);if(e===MOVE_DIRECTION.HORIZONTAL){const e=clamp$5(r+t,o,a);this.setPosition(e,n)}else{const e=clamp$5(n+t,i,s);this.setPosition(r,e)}}getWidgetById(e){return widgetsCtx.get(this).find((t=>t.id===e))}getWidgetByIds(e){return widgetsCtx.get(this).filter((t=>e.includes(t.id)))}get childWidgets(){return this.children.reduce(((e,t)=>{const r=this.getWidgetById(t);return r&&e.push(r),e}),[])}get flattenGroupChildWidgets(){return this.store.isPreview?memoizeFn(flattenGroupChildWidgets)(this):flattenGroupChildWidgets(this)}get flattenChildWidgets(){return this.store.isPreview?memoizeFn(flattenChildWidgets)(this):flattenChildWidgets(this)}get layoutChildWidgets(){return this.childWidgets.slice().reverse()}get nonDirectRelateWidgets(){var e;return[...(null==(e=this.parentWidget)?void 0:e.nonDirectRelateWidgets)||[],...this.brotherWidgets]}get brotherWidgets(){return widgetsCtx.get(this).filter((e=>this.parent===e.parent&&this.id!==e.id)).filter((e=>!this.parentWidget||this.parentWidget.availableChildWidgets.includes(e)))||[]}get availableChildWidgets(){return isStructureWidget(this)?this.getInstance().availableChildWidgets:[]}get needInitChildWidgets(){return isStructureWidget(this)?this.getInstance().needInitChildWidgets:[]}get parentWidget(){return this.getWidgetById(this.parent)}get parentContainerWidget(){return last$2(this.parentContainerWidgets)}get parentContainerWidgets(){return this.parentWidgets.filter((e=>isDraggableTargetStructureWidget(e)))}get parentWidgets(){return this.parentWidget?[...this.parentWidget.parentWidgets,this.parentWidget]:[]}get indexPaths(){return this.parentWidget?[...this.parentWidget.indexPaths,this.parentWidget.childWidgets.indexOf(this)]:[this.story?this.story.rootWidgets.indexOf(this):-1]}get story(){return this.store.totalStories.find((e=>e.widgets.includes(this)))}get storyIndex(){return this.store.stories.findIndex((e=>e===this.story))}get position(){return new Transform$2(this.platform.states.matrix).getPosition()}get rect(){const[e,t]=this.position;return{left:e,top:t,width:this.platform.states.width,height:this.platform.states.height}}get rootParentWidget(){let e=this.parentWidget;if(!e)return this;for(;e&&""!==e.parent;)e=e.parentWidget;return e}get visibleInStory(){var e;return(null==(e=this.story)?void 0:e.singleModeEnable)?this.flattenChildWidgets.some((e=>e.isInSingleMode)):this.visible}get isInSingleMode(){return this.baseWidgets.every((e=>{var t;return null==(t=this.story)?void 0:t.singleModeWidgetIds.has(e.id)}))}get baseWidgets(){return this.flattenChildWidgets.filter((e=>!isStructureWidget(e)||isStructureWidget(e)&&!e.children.length))}get meta(){return widgetManager.getWidgetByName(this.type)}getEvents({target:e,trigger:t}={}){var r,n;const o=e?null!=(n=null==(r=this.widgetEvents.find((t=>t.target===e)))?void 0:r.events)?n:[]:this.widgetEvents.flatMap((e=>e.events));return t?o.filter((e=>e.trigger===t)):o}getActions(e={}){return this.getEvents(e).flatMap((e=>e.actions))}trigger(e={}){if(!this.store.isPreview)return;const{target:t="",trigger:r=WIDGET_EVENT.CLICK,...n}=e,o=this.getEvents({target:t,trigger:r}).map((e=>toJS(e)));this.executeEvents({events:o,target:t,trigger:r,...n}),this.model.fireEvent(r.toLocaleLowerCase(),{...n,target:t})}executeEvents({events:e,target:t="",trigger:r=WIDGET_EVENT.CLICK,fields:n,eventTargets:o=this.model.eventTargets,options:i,expandIndex:a=0}){var s;const l=Array.isArray(o)?o.find((e=>e.value===t)):o;if(isNil$3(l))return;const c={fields:isMap$2(n)?n:new Map(Object.entries(null!=n?n:{})),trigger:r,eventTargetRegistry:l};eventCenter.execute(e,{actionRegistry:actionRegistry,context:c,execute:(e,{meta:t,computableResult:r})=>{e.forEach((e=>{const n=computeActionParameters(this.id,e,r,c.fields);t.execute({store:this.store,config:e,widget:this,options:i,computableResult:r,parameters:n,expandIndex:a})}))},mutexEventsProcessor:"selective"===(null==(s=c.eventTargetRegistry.events.find((e=>e.trigger===r)))?void 0:s.mode)||r===WIDGET_EVENT.CLICK?(e,t)=>{0!==e.length&&(1===e.length?t(e[0]):this.store.actionMenuManager.showEvents(e,t))}:void 0,computeFieldConfigs:(e,t)=>this.computeFieldConfigs(e,t)})}computeFieldConfigs(e,t){const r=new Map;e.forEach(((e,t)=>{r.set("".concat(this.id,"-").concat(t),e)}));const{calculateCenter:n}=this.store.duchampServer,o=Object.fromEntries(n.getParameterFromComputable(this.getInstance()));return n.calculateFieldConfigs(r,!1,!0,{...o,...t&&Object.fromEntries(t.entries())})}get noInteractionTab(){const e=!this.carousel&&!this.refresh&&!this.model.eventTargets;return this.store.platform.isMobile?widgetIsInExpand(this)&&e:e}get isHoverPointer(){return this.store.isPreview&&this.getEvents({trigger:WIDGET_EVENT.CLICK}).some((e=>e.enabled))}getInstance(){const{store:e}=this;return null==e?void 0:e.duchampServer.widgetInstanceManager.get(this.id)}get model(){return this.getInstance()}updatePlatformProps(e,t){const r=toJS(this.props),n=toJS(this.platform.mobile.props),{mobile:o,pc:i}=t;isNil$3(o)||(set$3(n,e,o),this.platform.mobile.setValue(n)),isNil$3(i)||(set$3(r,e,i),this.setValue(r))}};function widgetIsParameter(e){return isFilterable(e.getInstance())}function replaceMobileWidgetOrders(e,t){var r;(null==(r=null==e?void 0:e.mobile)?void 0:r.widgetOrders)&&(e.mobile.widgetOrders=e.mobile.widgetOrders.map((e=>{var r;return null!=(r=t.get(e))?r:e})))}function reimplementWidget(e,t,r,n){const{generateNewIds:o=!0}=n||{},i=new Map(t.map((e=>e.id)).map((e=>[e,o?uuid$2():e]))),a=[],s=(e,n="")=>{const o=t.find((t=>t.id===e));if(!o)return;replaceMobileWidgetOrders(o,i);const l=replaceDataIds(o,i),c=widgetManager.getWidgetByName(l.type),u=new Widget({...widgetAdapter({...toJS(l)}),parent:n,id:i.get(e)});if(u.setStore(r),u.setInitializing(!!c.initialization||!!c.dependencies),l.children&&l.children.length>0){const e=[];l.children.forEach((t=>{const r=s((n=t,o=i,(null==(a=Array.from(o.entries()).find((([,e])=>e===n)))?void 0:a[0])||""),u.id);var n,o,a;r&&e.push(r)})),u.setChildren(e)}return a.push({fromWidgetId:e,widget:u}),u.id};return e.forEach((e=>s(e))),a}function widgetSupportPlatform(e,t){if(!widgetManager.getWidgetByName(e))return!1;const{platforms:r}=widgetManager.getWidgetByName(e);return!r||r.includes(t)}function getWidgetIcon(e){return getWidgetIconByType(e.type)}__decorateClass$2([observable],Widget.prototype,"platform",2),__decorateClass$2([computed],Widget.prototype,"borderWidth",1),__decorateClass$2([computed],Widget.prototype,"width",1),__decorateClass$2([computed],Widget.prototype,"height",1),__decorateClass$2([computed],Widget.prototype,"layoutRect",1),__decorateClass$2([computed],Widget.prototype,"transform3dCSS",1),__decorateClass$2([platformComputed],Widget.prototype,"visible",1),__decorateClass$2([platformAction,modelAction],Widget.prototype,"setVisible",1),__decorateClass$2([modelAction],Widget.prototype,"setLock",1),__decorateClass$2([observable],Widget.prototype,"transitionStatus",2),__decorateClass$2([modelAction],Widget.prototype,"setTransitionStatus",1),__decorateClass$2([observable],Widget.prototype,"transitionKey",2),__decorateClass$2([modelAction],Widget.prototype,"setTransitionKey",1),__decorateClass$2([observable.ref],Widget.prototype,"target",2),__decorateClass$2([modelAction],Widget.prototype,"setTarget",1),__decorateClass$2([observable],Widget.prototype,"initializing",2),__decorateClass$2([modelAction],Widget.prototype,"setInitializing",1),__decorateClass$2([observable],Widget.prototype,"loading",2),__decorateClass$2([modelAction],Widget.prototype,"setLoading",1),__decorateClass$2([computed],Widget.prototype,"busying",1),__decorateClass$2([observable],Widget.prototype,"warning",2),__decorateClass$2([modelAction],Widget.prototype,"setWarning",1),__decorateClass$2([modelAction],Widget.prototype,"clearWarning",1),__decorateClass$2([observable],Widget.prototype,"widgetError",2),__decorateClass$2([modelAction],Widget.prototype,"setWidgetError",1),__decorateClass$2([modelAction],Widget.prototype,"clearWidgetError",1),__decorateClass$2([modelAction],Widget.prototype,"setStates",1),__decorateClass$2([modelAction],Widget.prototype,"setPosition",1),__decorateClass$2([modelAction],Widget.prototype,"updateRect",1),__decorateClass$2([modelAction],Widget.prototype,"setAnimation",1),__decorateClass$2([modelAction],Widget.prototype,"setTransform3d",1),__decorateClass$2([platformAction,modelAction],Widget.prototype,"setBoxReflect",1),__decorateClass$2([platformAction,modelAction],Widget.prototype,"setBoxShadowEffect",1),__decorateClass$2([modelAction],Widget.prototype,"replaceChildren",1),__decorateClass$2([modelAction],Widget.prototype,"setRectStatesWithEffect",1),__decorateClass$2([modelAction],Widget.prototype,"setValue",1),__decorateClass$2([modelAction],Widget.prototype,"updateProps",1),__decorateClass$2([modelAction],Widget.prototype,"setExtrasValue",1),__decorateClass$2([modelAction],Widget.prototype,"setBorder",1),__decorateClass$2([modelAction],Widget.prototype,"move",1),__decorateClass$2([computed],Widget.prototype,"childWidgets",1),__decorateClass$2([computed],Widget.prototype,"flattenGroupChildWidgets",1),__decorateClass$2([computed],Widget.prototype,"flattenChildWidgets",1),__decorateClass$2([computed],Widget.prototype,"layoutChildWidgets",1),__decorateClass$2([computed],Widget.prototype,"nonDirectRelateWidgets",1),__decorateClass$2([computed],Widget.prototype,"brotherWidgets",1),__decorateClass$2([computed],Widget.prototype,"availableChildWidgets",1),__decorateClass$2([computed],Widget.prototype,"needInitChildWidgets",1),__decorateClass$2([computed],Widget.prototype,"parentWidget",1),__decorateClass$2([computed],Widget.prototype,"parentContainerWidget",1),__decorateClass$2([computed],Widget.prototype,"parentContainerWidgets",1),__decorateClass$2([computed],Widget.prototype,"parentWidgets",1),__decorateClass$2([computed],Widget.prototype,"indexPaths",1),__decorateClass$2([computed],Widget.prototype,"story",1),__decorateClass$2([computed],Widget.prototype,"storyIndex",1),__decorateClass$2([computed],Widget.prototype,"position",1),__decorateClass$2([computed],Widget.prototype,"rect",1),__decorateClass$2([computed],Widget.prototype,"rootParentWidget",1),__decorateClass$2([computed],Widget.prototype,"visibleInStory",1),__decorateClass$2([computed],Widget.prototype,"isInSingleMode",1),__decorateClass$2([computed],Widget.prototype,"baseWidgets",1),__decorateClass$2([computed],Widget.prototype,"noInteractionTab",1),__decorateClass$2([computed],Widget.prototype,"isHoverPointer",1),__decorateClass$2([modelAction],Widget.prototype,"updatePlatformProps",1),Widget=__decorateClass$2([model$1("duchamp/Widget")],Widget);const getWidgetIconByType=e=>{const t=widgetManager.getWidgetByName(e).mainGroupName;return t?WIDGET_CONTAINER_TYPE[t]:"icon-warning-circle-fill"};class ChartConfigPanelManager{constructor(){__publicField(this,"selectedTab",WIDGET_TABS.CONTENT),__publicField(this,"idSelector",CHART_CONFIG_PANE_ID_SELECTOR)}changeSelectedTab(e){this.selectedTab=e}setIdSelector(e){this.idSelector=e}hideEditPane(e=WIDGET_TABS.CONTENT){otherService.setChartEditPanelVisible(!1),e&&(this.selectedTab=WIDGET_TABS.CONTENT)}updateChartEditPane(e){e&&this.populateChartEditPane(e)}handleConfigTabChange(e,t){this.selectedTab=e,this.widgetIsChart(t)&&(e!==WIDGET_TABS.CONTENT?otherService.setChartEditPanelVisible(!1):otherService.setChartEditPanelVisible(!0))}handlePlatformChange(e){this.widgetIsChart(e)&&(this.selectedTab===WIDGET_TABS.CONTENT&&widgetSupportPlatform(e.type,e.store.platform.platformType)?otherService.setChartEditPanelVisible(!0):otherService.setChartEditPanelVisible(!1))}handleWidgetSelect(e,t,r){if(this.selectedTab===WIDGET_TABS.CONTENT)if(0===e.length&&0===t.length&&this.widgetsIsChart(r))otherService.setChartEditPanelVisible(!0);else if(0!==e.length&&1===r.length)if(1!==e.length||1===t.length)if(1!==e.length||1!==t.length);else{const r=e[0],n=t[0];if(this.widgetIsChart(n)&&!this.widgetIsChart(r))return void otherService.setChartEditPanelVisible(!1);if(this.widgetIsChart(n)&&this.widgetIsChart(r))return;!this.widgetIsChart(n)&&this.widgetIsChart(r)&&r&&otherService.setChartEditPanelVisible(!0)}else{const t=e[0];t&&this.widgetIsChart(t)&&otherService.setChartEditPanelVisible(!0)}else otherService.setChartEditPanelVisible(!1);else otherService.setChartEditPanelVisible(!1)}widgetsIsChart(e){return 1===e.length&&this.widgetIsChart(e[0])}widgetIsChart(e){const t=widgetManager.getWidgetByName((null==e?void 0:e.type)||"");return t&&"chart"===t.widgetType&&"d-chart-GEO_LAND"!==t.type}refreshChartEditPaneWhenTemplateVisible(e){this.handleWidgetSelect([],[],e),this.widgetsIsChart(e)&&this.populateChartEditPane(e[0])}populateChartEditPane(e){var t;otherService.populateChartEditPane((null==(t=e.store.resourceCenter.getInfoByID(e.props.configFile))?void 0:t.name)||"",e.type.replace("d-chart-",""))}}const chartConfigPanelManager=new ChartConfigPanelManager;class PasteStoryHandler extends AbstractHandler{constructor(){super(...arguments),__publicField(this,"newStory",null)}get defaultFailTip(){return duchampIntl.get("Duchamp-Paste_Fail",duchampIntl.get("Duchamp-Story"))}async executeInternal(e){const t=this.store.isBackgroundStory?"backgroundStory":"story",r=await this.getDClipboardData(t),{story:n,templateId:o,templateName:i}=r.data;return pasteStoryProcessor({key:t,data:n,widgetInstanceManager:this.store.duchampServer.widgetInstanceManager},(t=>{const r=createUniqueName(this.store.showStories.map((e=>e.name)),o===this.store.id?"".concat(n.name,"_c"):"".concat(i,"_").concat(n.name,"_c"));t.setName(r),this.undoGroup.continue((()=>{this.store.insertStory(e,t)})),this.newStory=t}),this.store.crudService,this.store)}async getDClipboardData(e){const t=await ClipboardHelper.get(e);if(!t)throw new Error("getDClipboardData fail when paste story");return t}revoke(){const e=this.store.showStories.findIndex((e=>{var t;return e.id===(null==(t=this.newStory)?void 0:t.id)}));e<0||this.store.deleteStory(e)}}function preProcessStore(e){}class StoreCompatibilityLogic{constructor(e){try{this.compatibilityWithStore(e),this.compatibilityWithMobile(e)}catch(e3){console.error("compatibility failure",e3)}}compatibilityWithStore(e){CompatibilityFactory.handleStoreLoadConfig(e,DEFAULT_LOAD_CONFIG,transformTemplateVersion(e.templateVersion||""))}compatibilityWithMobile(e){get$5(e,"mobile.layoutConfig")||set$3(e,"mobile.layoutConfig",get$5(e,"mobileConfig",{phone:{layout:LAYOUT_TYPE$2.RESERVE},pad:{layout:LAYOUT_TYPE$2.RESERVE}}))}}const THEME_TYPE={DARK_BLUE:"dark-blue",BLUE:"blue"},lessVars$1={backgroundColorDefault:"#FFFFFFFF",backgroundColorNormal:"#FFFFFFFF",colorPrimary:"#4356FFFF",colorSecondary:"#0000001A",fontColorNormal:"#000000A6",fontColorSelected:"#FFFFFFFF",fontColorDisabled:"#00000040",fontColorNegative:"#FF4D4FFF",fontColorSuccess:"#52C41AFF",fontColorWarning:"#FAAD14FF",fontColorHighLight:"#FFFFFFFF",backgroundColorDisabled:"#0000000D",backgroundColorHover:"#4356FF1A",backgroundColorNegative:"#FF4D4F1A",backgroundColorSuccess:"#52C41A1A",backgroundColorWarning:"#FAAD141A",borderColorNormal:"#0000001A",borderColorDisabled:"#00000026",borderColorNegative:"#FF4D4FFF",borderColorSuccess:"#52C41AFF",borderColorWarning:"#FAAD14FF",borderColorSplitLine:"#0000000D",iconTreeCollapseType1:"icon/tree_collapse_1.png",iconTreeCollapseType2:"icon/tree_collapse_2.png",iconTreeCollapseType3:"icon/tree_collapse_3.png",iconTreeCollapseType4:"icon/tree_collapse_4.png",iconTreeExpandType1:"icon/tree_expand_1.png",iconTreeExpandType2:"icon/tree_expand_2.png",iconTreeExpandType3:"icon/tree_expand_3.png",iconTreeExpandType4:"icon/tree_expand_4.png",iconTreeVerticalLine1:"icon/tree_vertical_line_1.png",iconTreeVerticalLine2:"icon/tree_vertical_line_2.png",iconTreeVerticalLine3:"icon/tree_vertical_line_3.png",iconTreeVerticalLine4:"icon/tree_vertical_line_4.png",iconTreeSolidCollapseType1:"icon/tree_solid_collapse_1.png",iconTreeSolidCollapseType2:"icon/tree_solid_collapse_2.png",iconTreeSolidCollapseType3:"icon/tree_solid_collapse_3.png",iconTreeSolidCollapseType4:"icon/tree_solid_collapse_4.png",iconTreeSolidExpandType1:"icon/tree_solid_expand_1.png",iconTreeSolidExpandType2:"icon/tree_solid_expand_2.png",iconTreeSolidExpandType3:"icon/tree_solid_expand_3.png",iconTreeSolidExpandType4:"icon/tree_solid_expand_4.png",iconTreeSolidVerticalLine1:"icon/tree_solid_vertical_line_1.png",iconTreeSolidVerticalLine2:"icon/tree_solid_vertical_line_2.png",iconTreeSolidVerticalLine3:"icon/tree_solid_vertical_line_3.png",iconTreeSolidVerticalLine4:"icon/tree_solid_vertical_line_4.png"},name$1="/home/buildagent/repository/fvs_package/c2c7013a-6ecf-7b6b-605e-6ee98a4a3310/duchamp/packages/duchamp-editor/src/theme/blue/var.less?lessVarsLoader",lessVars={backgroundColorDefault:"#191E2DFF",backgroundColorNormal:"#191E2DFF",colorPrimary:"#0088F1FF",colorSecondary:"#FFFFFF4D",fontColorNormal:"#FFFFFFFF",fontColorSelected:"#FFFFFFFF",fontColorDisabled:"#FFFFFF40",fontColorNegative:"#FF4D4FFF",fontColorSuccess:"#52C41AFF",fontColorWarning:"#FAAD14FF",fontColorHighLight:"#FFFFFFFF",backgroundColorDisabled:"#FFFFFF1A",backgroundColorHover:"#0088F140",backgroundColorNegative:"#FF4D4F1A",backgroundColorSuccess:"#52C41A1A",backgroundColorWarning:"#FAAD141A",borderColorNormal:"#FFFFFF4D",borderColorDisabled:"#FFFFFF26",borderColorNegative:"#FF4D4FFF",borderColorSuccess:"#52C41AFF",borderColorWarning:"#FAAD14FF",borderColorSplitLine:"#FFFFFF1A",iconTreeCollapseType1:"icon/dark/tree_collapse_1.png",iconTreeCollapseType2:"icon/dark/tree_collapse_2.png",iconTreeCollapseType3:"icon/dark/tree_collapse_3.png",iconTreeCollapseType4:"icon/dark/tree_collapse_4.png",iconTreeExpandType1:"icon/dark/tree_expand_1.png",iconTreeExpandType2:"icon/dark/tree_expand_2.png",iconTreeExpandType3:"icon/dark/tree_expand_3.png",iconTreeExpandType4:"icon/dark/tree_expand_4.png",iconTreeVerticalLine1:"icon/dark/tree_vertical_line_1.png",iconTreeVerticalLine2:"icon/dark/tree_vertical_line_2.png",iconTreeVerticalLine3:"icon/dark/tree_vertical_line_3.png",iconTreeVerticalLine4:"icon/dark/tree_vertical_line_4.png",iconTreeSolidCollapseType1:"icon/dark/tree_solid_collapse_1.png",iconTreeSolidCollapseType2:"icon/dark/tree_solid_collapse_2.png",iconTreeSolidCollapseType3:"icon/dark/tree_solid_collapse_3.png",iconTreeSolidCollapseType4:"icon/dark/tree_solid_collapse_4.png",iconTreeSolidExpandType1:"icon/dark/tree_solid_expand_1.png",iconTreeSolidExpandType2:"icon/dark/tree_solid_expand_2.png",iconTreeSolidExpandType3:"icon/dark/tree_solid_expand_3.png",iconTreeSolidExpandType4:"icon/dark/tree_solid_expand_4.png",iconTreeSolidVerticalLine1:"icon/dark/tree_solid_vertical_line_1.png",iconTreeSolidVerticalLine2:"icon/dark/tree_solid_vertical_line_2.png",iconTreeSolidVerticalLine3:"icon/dark/tree_solid_vertical_line_3.png",iconTreeSolidVerticalLine4:"icon/dark/tree_solid_vertical_line_4.png"},name="/home/buildagent/repository/fvs_package/c2c7013a-6ecf-7b6b-605e-6ee98a4a3310/duchamp/packages/duchamp-editor/src/theme/dark-blue/var.less?lessVarsLoader",themes={[THEME_TYPE.BLUE]:lessVars$1,[THEME_TYPE.DARK_BLUE]:lessVars},THEME_EVENT={THEME_CHANGE:"themechange"};function correctTheme(e){return"dark-yellow"===e?THEME_TYPE.DARK_BLUE:e}class ThemeManager{constructor(e){__publicField(this,"eventEmitter",new EventEmitter),__publicField(this,"duchampServer"),__publicField(this,"theme"),this.duchampServer=e,this.theme=correctTheme(e.store.styleConfig.theme)}get themeVars(){return this.getThemeVars(this.theme)}updateTheme(e){if(!e)return;const t=correctTheme(e);Object.values(THEME_TYPE).includes(t)&&(this.theme=t)}getThemeVars(e){var t;const{widget:r}=this.duchampServer.store.styleConfig,n=r[TEMPLATE_WIDGET_TYPE_KEY.CONTROLLER],{content:o,setting:i}=n;return{...themes[e]||themes[THEME_TYPE.DARK_BLUE],colorPrimary:null==(t=o.styleConfig)?void 0:t.highlightColor,fontColorNormal:o.styleConfig.color,borderColorNormal:i.borderLine.borderColor,themeType:e}}onThemeChange(e){this.eventEmitter.on(THEME_EVENT.THEME_CHANGE,e)}offThemeChange(e){this.eventEmitter.off(THEME_EVENT.THEME_CHANGE,e)}}const MAX_COLOR_OPTIONS=8,DEFAULT_THEME_COMPATIBILITY_COLOR={[THEME_TYPE.DARK_BLUE]:{backgroundColor:"#00142E",textColor:"#F5F9FF"},[THEME_TYPE.BLUE]:{backgroundColor:"#F4F5F7",textColor:"#333333"}},templateThemeCompatibility=e=>{var t,r;if(isEmpty$3(e))return e;if(e.theme_config.groupColor||(e.theme_config.groupColor={colors:e.theme_config.colors.slice(0,MAX_COLOR_OPTIONS),palette:"custom"}),e.theme_config.backgroundColor||(e.theme_config.backgroundColor=DEFAULT_THEME_COMPATIBILITY_COLOR[correctTheme(e.theme)].backgroundColor),e.theme_config.textColor||(e.theme_config.textColor=DEFAULT_THEME_COMPATIBILITY_COLOR[correctTheme(e.theme)].textColor),!e.widget.chart.content.series.scheme.groupColor){const r=e.theme_config.groupColor.colors,n=(null==(t=e.widget.chart.content.series.scheme)?void 0:t.type)===Linear_GRADIENT_COLOR?r:[...map$3(e.widget.chart.content.series.scheme.colors,(e=>e.value)),...r];e.widget.chart.content.series.scheme.groupColor={colors:n.slice(0,MAX_COLOR_OPTIONS),palette:"custom"}}return e.widget.chart.content.series.scheme.linearGradientColor||(e.widget.chart.content.series.scheme.linearGradientColor=(null==(r=e.widget.chart.content.series.scheme)?void 0:r.type)===Linear_GRADIENT_COLOR?{...pick(e.widget.chart.content.series.scheme,["colors","angle"]),palette:"custom"}:{...WIDGET_CHART_DEFAULT_CONFIG.series.scheme.linearGradientColor}),e},getTemplateCompatibilityPureController=e=>({content:omit$1(e.content,["styleConfig.fontAttr.fontSize"]),setting:pick(e.setting,["border","borderHue","borderOpacity","borderSaturation","borderContrast","borderBrightness","borderScale","backgroundFillType","fillType","borderLine","opacity"])}),getTemplateCompatibilityPureTheme=e=>{const t=templateThemeCompatibility(e);return t.widget.controller=getTemplateCompatibilityPureController(t.widget.controller),t.widget.chart=pick(t.widget.chart,["content"]),t.widget.chart.content.label=omit$1(t.widget.chart.content.label,["fontSize"]),t.widget.chart.content.legend=omit$1(t.widget.chart.content.legend,["fontSize"]),t.widget.chart.content.tooltip=omit$1(t.widget.chart.content.tooltip,["fontSize","borderRadius"]),t.widget.chart.content.axis.label=omit$1(t.widget.chart.content.axis.label,["fontSize"]),t.widget.chart.content.axis.title=omit$1(t.widget.chart.content.axis.title,["fontSize"]),t.widget.chart.content.series.scheme=pick(t.widget.chart.content.series.scheme,["linearGradientColor","groupColor"]),{theme:t.theme,theme_config:pick(t.theme_config,["title","groupColor","backgroundColor","textColor","background","historyColor","label"]),id:t.id,resources:t.resources||{},widget:pick(t.widget,["chart","controller","relation"]),cover:t.cover,type:t.type}},templateThemePropMergeWith=(e,t)=>mergeWith$2(e,t,((e,t,r,n)=>{if(isArray$c(t))return t;void 0===t&&(n[r]=t)}));function processStoreData(e,t){var r;if(!e.store)return;preProcessStore(e.store);const{templateVersion:n,pluginVersion:o}=e.versionConfig;return o!==n&&(new StoreCompatibilityLogic(e.store),getTotalStories(e.store).forEach((e=>{new WidgetCompatibilityLogic(e,n,t)})),null==(r=e.store.controllerPanel)||r.widgets.forEach((e=>{controllerCompatibility(e,t)})),templateThemeCompatibility(e.store.styleConfig)),e.store.previewConfig&&initializePageButtonDisplayPolicy(e.store.previewConfig),e.store.stories||(e.store.watermarkConfig=!0),e.store.templateVersion=n,e.store}function initializePageButtonDisplayPolicy(e){if(!("pageButtonDisplayPolicy"in e)){const t=e.arrows?"always":"hover";Object.assign(e,{pageButtonDisplayPolicy:t})}}function getWidgetsStatesInfo(e){const t={};return e.forEach((e=>{const{width:r,height:n,matrix:o}=e.platform.states;t[e.id]={width:r,height:n,matrix:toJS(o)}})),t}var baseAssignValue=_baseAssignValue$1,createAggregator=_createAggregator,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,countBy=createAggregator((function(e,t,r){hasOwnProperty.call(e,r)?++e[r]:baseAssignValue(e,r,1)})),countBy_1=countBy;const countBy$1=getDefaultExportFromCjs$1(countBy_1);var e,o=-1,a=function(e){addEventListener("pageshow",(function(t){t.persisted&&(o=t.timeStamp,e(t))}),!0)},c=function(){var e=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},u=function(){var e=c();return e&&e.activationStart||0},f=function(e,t){var r=c(),n="navigate";return o>=0?n="back-forward-cache":r&&(document.prerendering||u()>0?n="prerender":document.wasDiscarded?n="restore":r.type&&(n=r.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:n}},s=function(e,t,r){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var n=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return n.observe(Object.assign({type:e,buffered:!0},r||{})),n}}catch(o){}},d=function(e,t,r,n){var o,i;return function(a){var s,l;t.value>=0&&(a||n)&&((i=t.value-(o||0))||void 0===o)&&(o=t.value,t.delta=i,t.rating=(s=t.value)>(l=r)[1]?"poor":s>l[0]?"needs-improvement":"good",e(t))}},l=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},p=function(e){document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e()}))},v=function(e){var t=!1;return function(){t||(e(),t=!0)}},m=-1,h=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},g=function(e){"hidden"===document.visibilityState&&m>-1&&(m="visibilitychange"===e.type?e.timeStamp:0,T())},y=function(){addEventListener("visibilitychange",g,!0),addEventListener("prerenderingchange",g,!0)},T=function(){removeEventListener("visibilitychange",g,!0),removeEventListener("prerenderingchange",g,!0)},E=function(){return m<0&&(m=h(),y(),a((function(){setTimeout((function(){m=h(),y()}),0)}))),{get firstHiddenTime(){return m}}},C=function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()},b=[1800,3e3],S=function(e,t){t=t||{},C((function(){var r,n=E(),o=f("FCP"),i=s("paint",(function(e){e.forEach((function(e){"first-contentful-paint"===e.name&&(i.disconnect(),e.startTime<n.firstHiddenTime&&(o.value=Math.max(e.startTime-u(),0),o.entries.push(e),r(!0)))}))}));i&&(r=d(e,o,b,t.reportAllChanges),a((function(n){o=f("FCP"),r=d(e,o,b,t.reportAllChanges),l((function(){o.value=performance.now()-n.timeStamp,r(!0)}))})))}))},L=[.1,.25],w=function(e,t){t=t||{},S(v((function(){var r,n=f("CLS",0),o=0,i=[],c=function(e){e.forEach((function(e){if(!e.hadRecentInput){var t=i[0],r=i[i.length-1];o&&e.startTime-r.startTime<1e3&&e.startTime-t.startTime<5e3?(o+=e.value,i.push(e)):(o=e.value,i=[e])}})),o>n.value&&(n.value=o,n.entries=i,r())},u=s("layout-shift",c);u&&(r=d(e,n,L,t.reportAllChanges),p((function(){c(u.takeRecords()),r(!0)})),a((function(){o=0,n=f("CLS",0),r=d(e,n,L,t.reportAllChanges),l((function(){return r()}))})),setTimeout(r,0))})))},A=0,I=1/0,P=0,M=function(e){e.forEach((function(e){e.interactionId&&(I=Math.min(I,e.interactionId),P=Math.max(P,e.interactionId),A=P?(P-I)/7+1:0)}))},k=function(){return e?A:performance.interactionCount||0},F=function(){"interactionCount"in performance||e||(e=s("event",M,{type:"event",buffered:!0,durationThreshold:0}))},D=[],x=new Map,R=0,B=function(){var e=Math.min(D.length-1,Math.floor((k()-R)/50));return D[e]},H=[],q=function(e){if(H.forEach((function(t){return t(e)})),e.interactionId||"first-input"===e.entryType){var t=D[D.length-1],r=x.get(e.interactionId);if(r||D.length<10||e.duration>t.latency){if(r)e.duration>r.latency?(r.entries=[e],r.latency=e.duration):e.duration===r.latency&&e.startTime===r.entries[0].startTime&&r.entries.push(e);else{var n={id:e.interactionId,latency:e.duration,entries:[e]};x.set(n.id,n),D.push(n)}D.sort((function(e,t){return t.latency-e.latency})),D.length>10&&D.splice(10).forEach((function(e){return x.delete(e.id)}))}}},O=function(e){var t=self.requestIdleCallback||self.setTimeout,r=-1;return e=v(e),"hidden"===document.visibilityState?e():(r=t(e),p(e)),r},N=[200,500],j=function(e,t){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(t=t||{},C((function(){var r;F();var n,o=f("INP"),i=function(e){O((function(){e.forEach(q);var t=B();t&&t.latency!==o.value&&(o.value=t.latency,o.entries=t.entries,n())}))},l=s("event",i,{durationThreshold:null!==(r=t.durationThreshold)&&void 0!==r?r:40});n=d(e,o,N,t.reportAllChanges),l&&(l.observe({type:"first-input",buffered:!0}),p((function(){i(l.takeRecords()),n(!0)})),a((function(){R=k(),D.length=0,x.clear(),o=f("INP"),n=d(e,o,N,t.reportAllChanges)})))})))},_=[2500,4e3],z={},G=function(e,t){t=t||{},C((function(){var r,n=E(),o=f("LCP"),i=function(e){t.reportAllChanges||(e=e.slice(-1)),e.forEach((function(e){e.startTime<n.firstHiddenTime&&(o.value=Math.max(e.startTime-u(),0),o.entries=[e],r())}))},c=s("largest-contentful-paint",i);if(c){r=d(e,o,_,t.reportAllChanges);var h=v((function(){z[o.id]||(i(c.takeRecords()),c.disconnect(),z[o.id]=!0,r(!0))}));["keydown","click"].forEach((function(e){addEventListener(e,(function(){return O(h)}),{once:!0,capture:!0})})),p(h),a((function(n){o=f("LCP"),r=d(e,o,_,t.reportAllChanges),l((function(){o.value=performance.now()-n.timeStamp,z[o.id]=!0,r(!0)}))}))}}))},J=[800,1800],K=function e(t){document.prerendering?C((function(){return e(t)})):"complete"!==document.readyState?addEventListener("load",(function(){return e(t)}),!0):setTimeout(t,0)},Q=function(e,t){t=t||{};var r=f("TTFB"),n=d(e,r,J,t.reportAllChanges);K((function(){var o=c();o&&(r.value=Math.max(o.responseStart-u(),0),r.entries=[o],n(!0),a((function(){r=f("TTFB",0),(n=d(e,r,J,t.reportAllChanges))(!0)})))}))};const FEATURE_FLAG_KEY={FAST_MODEL:"__fvs_fast_mode__"};function isFastMode(){return"true"===getParamInURL(FEATURE_FLAG_KEY.FAST_MODEL)||settingCenter.isFastMode()}const KeyVital=["LCP","TTFB"];class ConsumePoint{static addWebVital(e){this.webVitalsQueue.add(e),this.send()}static reportWebVitals(){w((e=>this.addWebVital(e))),j((e=>this.addWebVital(e))),G((e=>this.addWebVital(e))),Q((e=>this.addWebVital(e)))}static hasKeyVital(){const e=Array.from(this.webVitalsQueue).map((e=>e.name));return KeyVital.every((t=>e.includes(t)))}static getWebVital(){return Array.from(this.webVitalsQueue).map((e=>"".concat(e.name,"=").concat(e.value))).join(",")}static send(e=!1){if(this.sended||(!this.pointData||!this.hasKeyVital())&&!e)return;this.sended=!0,window.clearTimeout(this.sendTimer);const{template:t,widgets:r=[]}=this.pointData||{};fvsService.sendConsumePoint({data:[{id:"FR-P4000",body:{...t,fcp:this.getFcp(),webVitals:this.getWebVital()}},...r]}),this.reset()}static getFcp(){var e,t;return null!=(t=null==(e=performance.getEntriesByName("first-contentful-paint").at(0))?void 0:e.startTime)?t:-1}static async recordConsumePoint(e,{timeOut:t,firstStoryChangeTime:r,lastStoryChangeTime:n}){var o,i;const{connection:a={rtt:-1,downlink:-1,saveData:!1}}=window.navigator,s=performance.getEntriesByType("navigation").at(0),{jsHeapSizeLimit:l,totalJSHeapSize:c,usedJSHeapSize:u}=performance.memory||{};try{performance.measure(PERFORMANCE_MARK.DATA_INIT,PERFORMANCE_MARK.DATA_INIT_START,PERFORMANCE_MARK.DATA_INIT_END)}catch(e3){}this.pointData={template:{envNetworkState:{rtt:a.rtt,downlink:a.downlink,saveData:a.saveData},envNavigation:getNavigationInfo(s),...getInfoByResource(t),envMemory:{jsHeapSizeLimit:l,totalJSHeapSize:c,usedJSHeapSize:u},envUserAgent:navigator.userAgent,envAppVersion:getBuildInfo().version,templateId:e.id,firstStoryChangeTime:r,lastStoryChangeTime:n,templatePageWidgetCount:e.stories.map((e=>e.widgets.length)).join(";"),templatePageComponent:Object.entries(countBy$1(e.story.relatedWidgets.map((e=>e.type)))).map((e=>e.join(":"))).join(","),templatePageIndex:e.currentPreviewStoryIndex+1,fmp:performance.now()-(null!=(o=null==s?void 0:s.startTime)?o:0),duchampInit:getNowMeasure(PERFORMANCE_MARK.DUCHAMP_INIT),storyCalculateInit:getMarkStartTime(PERFORMANCE_MARK.STORY_CALCULATE_INIT),widgetsLoaded:getMarkStartTime(PERFORMANCE_MARK.WIDGETS_LOADED),dataInitStart:getMarkStartTime(PERFORMANCE_MARK.DATA_INIT_START),dataInit:null==(i=performance.getEntriesByName(PERFORMANCE_MARK.DATA_INIT).at(0))?void 0:i.duration,templateFastMode:isFastMode(),cacheEnabled:e.cacheConfig.enabled,noAuthCheck:"true"===getParamInURL("noAuthCheck")},widgets:e.story.relatedWidgets.reduce(((t,r)=>{const n=r.model.getPerformanceMeasureInfo();return isEmpty$3(n)||t.push({id:n.id,body:{templateId:e.id,widgetId:r.id,pageIndex:e.currentPreviewStoryIndex+1,widgetName:r.name,widgetType:r.type,...n.body}}),t}),[])},performance.clearMarks(),performance.clearMeasures(),this.send(),this.sendTimer=window.setTimeout((()=>{this.send(!0)}),6e4)}static reset(){this.pointData=null,this.webVitalsQueue.clear()}static stop(){window.clearTimeout(this.sendTimer)}}function generateLoadOrder(e,t){const r=new Array(t);r[0]=e;for(let n=1;n<t;n++)r[n]=n%2==1?(e+Math.ceil(n/2))%t:(e-n/2+t)%t;return r}function getStoryIndex(e,t){return t.findIndex((t=>t===e))}function getComputableDictionary(e,t){const r=new Set,n=[],o=getParameterComponents(e.parameterConfigs,t.map((e=>e.name)),(()=>getFieldPayload(e)));return t.forEach((t=>{o.add(new Parameter(t,"preParameter",(()=>getFieldPayload(e))))})),e.totalStories.forEach((e=>{const t=new Set;e.widgets.forEach((e=>{const n=e.getInstance();isFilterable(n)&&r.add(n),t.add(n)})),n.push(t)})),{parameterComponents:o,filterComponents:r,storyComponents:n,currentStoryIndex:getCurrentStoryIndex(e)}}function getCurrentStoryIndex(e){return e.isPreview?getStoryIndex(e.story,e.stories):e.currentStory}function getFieldPayload(e){const t=getCurrentStoryIndex(e);return{depGroupId:t,outsidePayload:{depWidgets:getStoryWorkbookNamedIdentifierWithIndex(t,e.story)}}}function getOriginalIndex(e,t,r){let n=0;for(let o=0;o<e.length;o++)if(r(e[o])){if(t===n)return o;n++}return 0}function initRelationCalculate(e){const t=new Set,r=[];e.stories.forEach(((e,n)=>{r[n]=[],e.widgets.forEach((e=>{const o=e.getInstance();isInstanceofRelationLinkable(o)&&(r[n].push(o),t.add(o.relationMeta.wId))}))})),0!==t.size&&e.relationCalculate.setRelationComponents(r)}function performChunk(e,t,r){if(0===e.length)return void(null==r||r());let n=0;!function o(){n>=e.length?null==r||r():requestIdleCallback((r=>{if(r.didTimeout)t(e[n],n),n++;else for(;(r.timeRemaining()>0||r.didTimeout)&&n<e.length;)t(e[n],n),n++;o()}),{timeout:1e3})}()}function replaceOffScreenConfigData(e,t){const{events:r}=e;if(r){const n=r.map((e=>{if(e.type===EVENT_CONFIG_TYPE.JAVASCRIPT){const{parameters:r}=e;if(r){const n=r.map((e=>replaceParameterValueData(e,t)));return{...e,parameters:n}}}return e}));return{...e,events:n}}return e}__publicField(ConsumePoint,"pointData",null),__publicField(ConsumePoint,"webVitalsQueue",new Set),__publicField(ConsumePoint,"sendTimer"),__publicField(ConsumePoint,"sended",!1);const uselessTimes2Remove=3;function markUseless(e,t,r=!1){const n=getIDsWithSub(e,t),{allIDs:o,unAutoRemoveIDs:i,needMarkUselessIDs:a}=getResourceIDsByCategory(e);o.forEach((t=>{const o=e.getInfoByID(t);o&&(n.has(t)?getPayload$2(o,"markUseless")&&addPayload(o,"markUseless",0):a.has(t)?r&&addPayload(o,"markUseless",(getPayload$2(o,"markUseless")||0)+1):i.has(t)||addPayload(o,"markUseless",uselessTimes2Remove))}))}function getResourceIDsByCategory(e){const t=new Set,r=new Set,n=new Set;return Object.values(e.getInfos()).forEach((o=>{r.add(o.id);const i=getPayload$2(o,"isCustom"),a=getPayload$2(o,"fromTheme");i||a?getIDsWithSub(e,[o.id]).forEach((e=>t.add(e))):isResourceNeedMarkUseless(o)&&getIDsWithSub(e,[o.id]).forEach((e=>n.add(e)))})),{allIDs:r,unAutoRemoveIDs:t,needMarkUselessIDs:n}}function isResourceNeedMarkUseless(e){const{type:t,tags:r}=e;return t&&["chart","ec"].includes(t)||(null==r?void 0:r.includes("3d"))&&((null==r?void 0:r.includes("model"))||(null==r?void 0:r.includes("options"))||(null==r?void 0:r.includes("geo")))}function getIDsWithSub(e,t){const r=new Set;return t.forEach((t=>{e.getInfoWithSubByID(t).forEach((e=>{r.add(e.id)}))})),r}class StoreLoadEvent{constructor(e){__publicField(this,"flag",0),this.event=e}updateFlag(e){this.flag|=1<<e,3===this.flag&&this.event()}setStoreDataLoaded(){this.updateFlag(0)}setStoreInitialized(){this.updateFlag(1)}}const LOAD_CONFIG_ITEM_WIDTH=200,defaultFilterPanelContents=["hue","opacity",["saturation","brightness","contrast"]],defaultComponentLoading={enableLoad:!0,resource:{type:"spin",value:LOADING_SPIN_TYPE.SPIN_ONE},hue:0,opacity:100,saturation:0,brightness:0,contrast:0},defaultImageContentProps={type:"image",resource:{type:RESOURCE_TYPE.INTERNAL,value:"",name:""},hue:0,opacity:100,saturation:0,brightness:0,contrast:0},defaultVideoContentProps={type:"video",fillType:"contain",resource:{type:RESOURCE_TYPE.INTERNAL,value:"",name:""}},defaultSpinConfigurations={spinOne:{type:LOADING_SPIN_TYPE.SPIN_ONE,hue:0,opacity:100,saturation:0,brightness:0,contrast:0},spinTwo:{type:LOADING_SPIN_TYPE.SPIN_TWO,hue:0,opacity:100,saturation:0,brightness:0,contrast:0},spinThree:{type:LOADING_SPIN_TYPE.SPIN_THREE,hue:0,opacity:100,saturation:0,brightness:0,contrast:0},spinFour:{type:LOADING_SPIN_TYPE.SPIN_FOUR,hue:0,opacity:100,saturation:0,brightness:0,contrast:0}},defaultAnimationConfigurations={animationOne:{type:LOADING_ANIMATION_TYPE.ANIMATION_ONE,hue:0,opacity:100,saturation:0,brightness:0,contrast:0}};function initializeSpinConfigurations(e){if("animation"===e.resource.type)return defaultSpinConfigurations;const{resource:t,enableLoad:r,...n}=e,{value:o}=t;return{...defaultSpinConfigurations,[o]:{...defaultSpinConfigurations[o],...n}}}function initializeAnimationConfigurations(e){if("spin"===e.resource.type)return defaultAnimationConfigurations;const{resource:t,enableLoad:r,...n}=e,{value:o}=t;return{...defaultAnimationConfigurations,[o]:{...defaultAnimationConfigurations[o],...n}}}function isImageContentProps(e){return!!e&&"image"===e.type}function isVideoContentProps(e){return!!e&&"video"===e.type}function isSpinResourceType(e){return!!e&&"spin"===e.resource.type}function getResourceIDsInLoadConfig(e){const t=new Set,{template:r}=e;if(isImageContentProps(r.content)||isVideoContentProps(r.content)){const{resource:e}=r.content;e.type!==RESOURCE_TYPE.CUSTOM&&e.type!==RESOURCE_TYPE.INTERNAL||t.add(e.value)}return Array.from(t)}const SimpleLoadingConfig=({selectedType:e,spinConfigurations:t,onChange:r})=>jsx("div",{className:"simple-loading-config",children:Object.values(LOADING_SPIN_TYPE).map((n=>jsx(Toolbox,{selected:n===e,showSelectedIcon:!0,onClick:()=>{r(n)},children:jsx("div",{className:"simple-spin-config",children:jsx(LoadingSimpleSpin,{type:n,hue:t[n].hue,opacity:t[n].opacity,saturation:t[n].saturation,contrast:t[n].contrast,brightness:t[n].brightness})})},n)))}),SpinSelector=({isNormalSelect:e,normalLoadConfig:t,heavyLoadConfig:r,onChange:n})=>{const o=e?t:r,{hue:i,opacity:a,saturation:s,contrast:l,brightness:c}=o,[u,d]=reactExports.useState((()=>initializeSpinConfigurations(t))),[h,p]=reactExports.useState((()=>initializeSpinConfigurations(r))),[f,g]=reactExports.useState((()=>initializeAnimationConfigurations(r))),m=e?u:h,y=({type:t,property:r,value:n})=>{e?d({...u,[t]:{...u[t],[r]:n}}):p({...h,[t]:{...h[t],[r]:n}})};return jsxs(Fragment,{children:[jsx(LineItem,{hide:e,label:"",children:jsx(RadioGroup$1,{optionType:"button",buttonStyle:"solid",value:"animation"===o.resource.type?"animation":"simple",options:[{label:duchampIntl.get("Duchamp-Simple_Load"),value:"simple"},{label:duchampIntl.get("Duchamp-Animation_Load"),value:"animation"}],onChange:e=>{const t="simple"===e,o=t?h.spinOne:f.animationOne,i=t?{type:"spin",value:LOADING_SPIN_TYPE.SPIN_ONE}:{type:"animation",value:LOADING_ANIMATION_TYPE.ANIMATION_ONE};n({...r,resource:i,hue:o.hue,opacity:o.opacity,saturation:o.saturation,brightness:o.brightness,contrast:o.contrast})}})}),jsx(LineItem,{label:"",children:jsxs(GridItem,{children:["animation"===o.resource.type?jsx("div",{className:"load-animation-preview",children:jsx(LoadingAnimation,{percentage:81,height:120,hue:f.animationOne.hue,opacity:f.animationOne.opacity,saturation:f.animationOne.saturation,brightness:f.animationOne.brightness,contrast:f.animationOne.contrast})}):jsx(SimpleLoadingConfig,{spinConfigurations:m,selectedType:o.resource.value,onChange:e=>{const t=m[e],r={...o,resource:{type:"spin",value:t.type},hue:t.hue,opacity:t.opacity,saturation:t.saturation,brightness:t.brightness,contrast:t.contrast};n(r)}}),jsx(FilterProcessPanel,{hue:i,opacity:a,saturation:s,brightness:c,contrast:l,components:defaultFilterPanelContents,layout:"vertical",onChange:(o,i,a)=>{if(e)n({...t,[i]:a}),y({type:t.resource.value,property:i,value:a});else if(n({...r,[i]:a}),"animation"===r.resource.type){const e=r.resource.value;g({...f,[e]:{...f[e],[i]:a}})}else y({type:r.resource.value,property:i,value:a})}})]})})]})},{Link:Link}=Typography,WarningAlert=e=>{const{title:t,linkName:r=duchampIntl.get("Duchamp-View_Help_Doc"),link:n,items:o,showIcon:i=!0,hideLink:a}=e;return jsx("div",{className:"duchamp-warning-config-dialog",children:jsx(Instruction,{type:"warning",showIcon:i,message:jsxs(Row$1,{justify:"space-between",children:[t,!a&&jsx(Link,{href:n,target:"_blank",className:"duchamp-warning-link",children:r})]}),description:o&&jsx("ul",{className:"duchamp-warning-alert-description",children:o.map(((e,t)=>jsxs("li",{className:"duchamp-warning-alert-description-item",children:[e.title,jsx("div",{children:e.children})]},t)))})})})},DEFAULT_SELECT_TYPE="duchamp",TabItem$1=Tab$1.Item,ComponentLoadPanel=({value:e,onChange:t})=>{var r,n;const[o,i]=reactExports.useState(DEFAULT_SELECT_TYPE),a=o===DEFAULT_SELECT_TYPE,s=null!=(r=e.normalLoadConfig)?r:defaultComponentLoading,l=null!=(n=e.heavyLoadConfig)?n:defaultComponentLoading,c=a?s:l,u=r=>{a?isSpinResourceType(r)&&t({...e,normalLoadConfig:r}):t({...e,heavyLoadConfig:r})};return jsxs("div",{className:"template-load-panel",children:[jsx(WarningAlert,{title:duchampIntl.get("Duchamp-Component_Load_Effect"),link:duchampIntl.get("Duchamp-Template_Load_Link"),items:[{title:duchampIntl.get("Duchamp-Component_Load_Effect_Component_Tip")},{title:duchampIntl.get("Duchamp-Component_Load_Effect_Calder_Component_Tip")},{title:duchampIntl.get("Duchamp-Component_Load_Effect_Download_Tip")}]}),jsx("div",{className:"template-load-panel-content",children:jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,children:[jsx(LineItem,{label:duchampIntl.get("Duchamp-Component_Type"),children:jsxs(GridItem,{gapSize:GAP_SIZE.SMALL,children:[jsxs(Tab$1,{theme:"segment",activeKey:o,onTabActive:e=>{i(e)},children:[jsx(TabItem$1,{tab:duchampIntl.get("Duchamp-2d_Component"),tabStyle:{padding:"0"}},"duchamp"),jsx(TabItem$1,{tab:duchampIntl.get("Duchamp-3d_Component"),tabStyle:{padding:"0"}},"calder")]}),jsx(Checkbox$4,{value:c.enableLoad,onChange:e=>{const t={...c,enableLoad:e};u(t)},text:duchampIntl.get("Duchamp-Enable_Component_Load_Effect")})]})}),c.enableLoad&&jsx(SpinSelector,{isNormalSelect:a,normalLoadConfig:s,heavyLoadConfig:l,onChange:u})]})})]})},LOADING_MEDIA_TYPE={IMAGE:"image",VIDEO:"video"},DEFAULT_ONLINE_VIDEO_WAITING_TIME=10,LoadVideoResourceSelector=({videoContent:e,onChange:t})=>{const{resourceCenter:r}=useStore();return jsxs(GridItem,{children:[jsx(VideoResourceSelector,{value:e.resource,container:document.body,mask:!0,onChange:n=>{var o,i;const a=null!=(o=getDurationFromResource(r,n))?o:DEFAULT_ONLINE_VIDEO_WAITING_TIME;if(isBaseResourceType(n)){const o=(null==(i=r.getInfoByID(n.value))?void 0:i.name)||"";t({...e,resource:{...n,name:o}},a)}else t({...e,resource:n},a)}}),!!getSourceFromResource(r,e.resource)&&jsx(GridItem,{children:jsxs("div",{className:"panel-item",children:[duchampIntl.get("Duchamp-Filling_Method"),jsx(RadioGroup$1,{buttonStyle:"solid",optionType:"button",options:[{label:duchampIntl.get("Duchamp-Adapt"),value:"contain"},{label:duchampIntl.get("Duchamp-Stretch"),value:"fill"}],value:e.fillType,onChange:r=>{t({...e,fillType:r})}})]})})]})},LoadImageResourceSelector=({imageContent:e,onChange:t})=>{var r,n,o,i,a;const{resourceCenter:s}=useStore(),l=null!=(r=e.hue)?r:0,c=null!=(n=e.opacity)?n:100,u=null!=(o=e.saturation)?o:0,d=null!=(i=e.brightness)?i:0,h=null!=(a=e.contrast)?a:0;return jsxs(GridItem,{children:[jsx(ImageResourceSelector,{tag:"story",mask:!0,value:e.resource,imageScopes:[IMAGE_SCOPE.OTHER],filterProps:{hue:l,opacity:c,saturation:u,brightness:d,contrast:h},container:document.body,onChange:r=>{var n;if(isBaseResourceType(r)){const o=(null==(n=s.getInfoByID(r.value))?void 0:n.name)||"";t({...e,resource:{...r,name:o}})}else t({...e,resource:r})}}),getImageWidgetSrc(s,e.resource)&&jsx(FilterProcessPanel,{hue:l,opacity:c,saturation:u,brightness:d,contrast:h,components:defaultFilterPanelContents,layout:"vertical",onChange:r=>{t({...e,...r})}})]})},DEFAULT_COMMON_WAITING_TIME=5,TabItem=Tab$1.Item,TemplateLoadPanel=({value:e,onChange:t})=>{var r;const{backgroundColor:n,enableLoad:o=!1,content:i,loadTimeConfig:a={type:"auto"}}=e,[s,l]=reactExports.useState((()=>isImageContentProps(i)?i:defaultImageContentProps)),[c,u]=reactExports.useState((()=>isVideoContentProps(i)?i:defaultVideoContentProps));return jsxs("div",{className:"template-load-panel",children:[jsx(WarningAlert,{title:duchampIntl.get("Duchamp-Template_Load_Effect"),link:duchampIntl.get("Duchamp-Template_Load_Link"),items:[{title:duchampIntl.get("Duchamp-Template_Load_Tip")},{title:duchampIntl.get("Duchamp-Template_Load_Download_Tip")},{title:duchampIntl.get("Duchamp-Template_Load_Play_Tip")}]}),jsx("div",{className:"template-load-panel-content",children:jsxs(GridItem,{gapSize:GAP_SIZE.MIDDLE,children:[jsx(LineItem,{label:duchampIntl.get("Duchamp-Background_Color"),children:jsx(ThemeColorPicker,{value:n,onChange:r=>{t({...e,backgroundColor:r})}})}),jsx(LineItem,{label:duchampIntl.get("Duchamp-Load_Effect"),children:jsx(Checkbox$4,{value:o,onChange:r=>{t({...e,enableLoad:r})},text:duchampIntl.get("Duchamp-Enable_Template_Load_Effect")})}),jsx(LineItem,{hide:!o,label:"",children:jsxs(Tab$1,{theme:"segment",defaultActiveKey:i?i.type:LOADING_MEDIA_TYPE.IMAGE,onTabActive:r=>{t({...e,content:r===LOADING_MEDIA_TYPE.IMAGE?s:c})},children:[jsx(TabItem,{tab:duchampIntl.get("Duchamp-Reuse_Image"),className:"template-load-selector",children:jsx(LoadImageResourceSelector,{imageContent:s,onChange:r=>{l(r),t({...e,content:r})}})},LOADING_MEDIA_TYPE.IMAGE),jsx(TabItem,{tab:duchampIntl.get("Duchamp-Reuse_Video"),className:"template-load-selector",children:jsx(LoadVideoResourceSelector,{videoContent:c,onChange:(r,n)=>{u(r);const o=null!=n?n:a.time;t({...e,content:r,loadTimeConfig:{type:a.type,time:o}})}})},LOADING_MEDIA_TYPE.VIDEO)]})}),jsx(LineItem,{hide:!o,label:duchampIntl.get("Duchamp-Load_Time"),children:jsx(RadioGroup$1,{optionType:"button",buttonStyle:"solid",value:a.type,options:[{label:duchampIntl.get("Duchamp-Automatic"),value:"auto"},{label:duchampIntl.get("Duchamp-Customize"),value:"custom"}],onChange:r=>{t({...e,loadTimeConfig:{...a,type:r}})}})}),jsx(LineItem,{hide:!o||"auto"===a.type,label:"",children:jsx(NumberInput$1,{min:1,style:{width:LOAD_CONFIG_ITEM_WIDTH},value:null!=(r=a.time)?r:DEFAULT_COMMON_WAITING_TIME,suffix:"s",onChange:r=>{null==t||t({...e,loadTimeConfig:{time:r,type:"custom"}})}})})]})})]})};reactExports.createContext(null);const MenuItem=reactExports.forwardRef((({text:e},t)=>jsx("span",{ref:t,className:"navigation-menu-item-wrapper",children:jsx(Typography.Text,{className:"navigation-menu-item-text",ellipsis:{tooltip:{content:e,placement:"right",offset:[24,-4],color:"rgba(0, 0, 0, 65%)",style:{maxWidth:"250px"}}},children:e})})));MenuItem.displayName="MenuItem";const Toolbar=reactExports.forwardRef((({onClose:e,onComplete:t,style:r},n)=>jsxs("div",{className:"selection-toolbar",ref:n,style:r,children:[jsx(Icon$2,{className:"toolbar-item close-icon",type:"icon-close-large",svgContent:SvgIconCloseLarge,onClick:e}),jsx(Icon$2,{className:"toolbar-item complete-icon",type:"icon-adaptive-canvas",svgContent:SvgIconAdaptiveCanvas,onClick:t})]})));Toolbar.displayName="Toolbar";const LazyContent=reactExports.lazy((async()=>__vitePreload((()=>import("./resource?resource=/com/fr/plugin/wysiwyg/web/static/js/Content-hash-B21SKEl2.js")),__vite__mapDeps([18,3,4,19]),import.meta.url).then((e=>({default:e.Content}))))),Selection=({container:e,className:t,onSelectionChange:r,getMaskContainer:n})=>{const o=reactExports.useMemo((()=>(null==n?void 0:n())||document.body),[n]),[i,a]=reactExports.useState(!1),[s,l]=reactExports.useState(),[c,u]=reactExports.useState(!1),[d,h]=reactExports.useState(),[p,f]=reactExports.useState({visibility:"hidden"}),[g,m]=reactExports.useState(),[y,v]=reactExports.useState(),_=reactExports.useRef(null),b=reactExports.useRef(null),C=reactExports.useRef(null),E=reactExports.useRef(null),T=reactExports.useRef(1),{width:S,height:P}=useResizeDetector({targetRef:e}),w=reactExports.useMemo((()=>{if(e.current&&S&&P){const{x:t,y:r}=e.current.getBoundingClientRect(),{width:n,height:i}=o.getBoundingClientRect();return{top:r,left:t,right:Math.max(n-t-S,0),bottom:Math.max(i-r-P,0)}}}),[o,e,S,P,i]),x=reactExports.useMemo((()=>{if(s&&e.current&&S&&P){const{x:t,y:r}=e.current.getBoundingClientRect(),{start:n,end:o}=s,i=Math.max(Math.min(n.x,o.x),t),a=Math.max(Math.min(n.y,o.y),r),l=Math.min(Math.max(n.x,o.x),t+S),c=Math.min(Math.max(n.y,o.y),r+P);return{left:i-t,top:a-r,width:Math.max(l-i,1),height:Math.max(c-a,1),boxShadow:"rgba(0, 0, 0, 45%) 0 0 0 100vmax",...g}}return g}),[e,P,s,g,S]),O=reactExports.useCallback((()=>{const e=E.current;if(e&&C.current){const{x:t,y:r,width:n,height:i}=C.current.getBoundingClientRect(),{height:a}=o.getBoundingClientRect(),s=2,{width:l,height:c}=e.getBoundingClientRect(),u={};u.left="".concat(Math.max(t+n-l-s,s),"px"),u.top="".concat(r+i+c+2*s<a?r+i+s:r+i-c-s,"px"),u.visibility="visible",f(u)}}),[o]),$=reactExports.useCallback((()=>{f({visibility:"hidden"})}),[]),I=reactExports.useMemo((()=>debounce$3({delay:3e3},(()=>{h({opacity:"0"})}))),[]),R=reactExports.useMemo((()=>throttle({interval:3e3},(()=>{h({opacity:"1"}),I()}))),[I]),A=reactExports.useCallback((()=>{D.current=void 0,l(void 0),v(void 0),a(!1),u(!1),m(void 0),h(void 0),f({visibility:"hidden"})}),[]),D=reactExports.useRef(),L=reactExports.useCallback((()=>{m((e=>({...e,...D.current}))),requestAnimationFrame(O),O()}),[O]);return useKeyPressEvent("Shift",(()=>a(!0)),(()=>a(!1))),useKeyPressEvent("Escape",A),reactExports.useEffect((()=>(window.addEventListener("blur",A),()=>{window.removeEventListener("blur",A)})),[A]),reactExports.useEffect((()=>{const e=b.current;let t,r=!1,n={x:0,y:0};const o=e=>{l((t=>(t||(r=!0,n={x:e.clientX,y:e.clientY}),t)))},i=e=>{r&&(t={x:e.clientX,y:e.clientY},l({start:n,end:t}))},a=()=>{r&&(r=!1,n={x:0,y:0},t&&O(),t=void 0)};return null==e||e.addEventListener("mousedown",o),null==e||e.addEventListener("mousemove",i),null==e||e.addEventListener("mouseup",a),null==e||e.addEventListener("mouseleave",a),()=>{null==e||e.removeEventListener("mousedown",o),null==e||e.removeEventListener("mousemove",i),null==e||e.removeEventListener("mouseup",a),null==e||e.removeEventListener("mouseleave",a)}}),[O]),reactExports.useEffect((()=>(c&&document.body.addEventListener("mousemove",R),()=>{document.body.removeEventListener("mousemove",R)})),[c,R]),reactExports.useEffect((()=>{var e;x&&(null==(e=_.current)||e.updateRect())}),[x]),useUpdateEffect$2((()=>{const t=(t=1)=>{if(y&&e.current){const{xProportion:n,yProportion:i,widthProportion:a,heightProportion:s}=y,l=e.current.getBoundingClientRect(),c=l.width/t,u=l.height/t,{width:d,height:h}=o.getBoundingClientRect(),p=c*a,f=u*s,g=Math.min(d/p,h/f);r({scale:g,offset:{x:(n*c+p/2)*g-d/2,y:(i*u+f/2)*g-h/2}}),T.current=g}else r(),T.current=1},n=throttle({interval:200},(()=>{t(T.current)}));return t(),window.addEventListener("resize",n),()=>{window.addEventListener("resize",n)}}),[y]),reactDomExports.createPortal(jsxs("div",{className:classNames$1("selection",t),children:[jsxs("div",{className:"selection-mask",style:{display:!i&&!s||c?"none":"block"},ref:b,children:[jsxs("div",{className:"selection-content",style:{...w,cursor:x?"default":"crosshair"},children:[jsx("div",{className:"selection-item",ref:C,style:x}),x&&jsx(reactExports.Suspense,{children:jsx(LazyContent,{ref:_,targetRef:C,onMoveStart:$,onMove:e=>{D.current=e},onMoveEnd:L})})]}),jsx(Toolbar,{style:p,ref:E,onClose:A,onComplete:()=>{if(u(!0),C.current&&e.current&&S&&P){const{x:t,y:r,width:n,height:o}=C.current.getBoundingClientRect(),{x:i,y:a}=e.current.getBoundingClientRect();v({xProportion:(t-i)/S,yProportion:(r-a)/P,widthProportion:n/S,heightProportion:o/P})}else v(void 0)}})]}),c&&jsx("div",{className:"close-button",style:d,children:jsx(Icon$2,{type:"icon-close-large",svgContent:SvgIconCloseLarge,onClick:()=>{A()}})})]}),o)};class AbstractFetchData{constructor(e){__publicField(this,"service"),__publicField(this,"eventEmitter",new EventEmitter),this.service=e}on(e,t){return this.eventEmitter.on(e,t),this}emit(e,...t){this.eventEmitter.emit(e,...t)}computeData(e){return this.service.computeByKeys(e)}}const MESSAGE_ERROR_CODE={TOKEN_INVALID:"3"},DATA_REFRESH_EVENT$1={ERROR:"error",UPDATE:"update",DISCONNECT:"disconnect"},DATA_PUSH_EVENT_NAME="datapush";class DataPushHandler extends AbstractFetchData{constructor(e){super(e),__publicField(this,"wire"),__publicField(this,"crudService"),this.wire=e.transport,this.crudService=e.crudService}addComputes(e){this.crudService.listenComputes(e.map((e=>e.id)))}start(){return this.wire.connect(),new Promise((e=>{const t=()=>{this.initEvent(),n(),e(!0)},r=()=>{n(),e(!1)},n=()=>{this.wire.off(TRANSPORT_EVENT_NAME.CONNECT,t),this.wire.off(TRANSPORT_EVENT_NAME.CONNECT_ERROR,r),this.wire.off(TRANSPORT_EVENT_NAME.CONNECT_TIMEOUT,r)};this.wire.connected?(this.initEvent(),e(!0)):(this.wire.on(TRANSPORT_EVENT_NAME.CONNECT,t),this.wire.on(TRANSPORT_EVENT_NAME.CONNECT_ERROR,r),this.wire.on(TRANSPORT_EVENT_NAME.CONNECT_TIMEOUT,r))}))}initEvent(){this.wire.on(DATA_PUSH_EVENT_NAME,(e=>{this.handleMessage(JSON.parse(e))})),this.wire.off(TRANSPORT_EVENT_NAME.DISCONNECT,(()=>{this.emit(DATA_REFRESH_EVENT$1.DISCONNECT)}))}async handleMessage(e){const{id:t,errorCode:r,result:n,refresh:o}=e;isNil$4(r)?o?this.computeData([t]).then((e=>{this.emit(DATA_REFRESH_EVENT$1.UPDATE,[t],e.result)})):this.emit(DATA_REFRESH_EVENT$1.UPDATE,[t],[n]):this.handleErrorMessage(e)}handleErrorMessage(e){const{id:t,errorCode:r}=e;r===MESSAGE_ERROR_CODE.TOKEN_INVALID?this.emit(DATA_REFRESH_EVENT$1.DISCONNECT):this.emit(DATA_REFRESH_EVENT$1.ERROR,[t])}sendMessage(e){this.wire.send(DATA_PUSH_EVENT_NAME,e)}}class AutoRefreshHandler extends AbstractFetchData{constructor(){super(...arguments),__publicField(this,"refreshInfos",[])}run(){const e=(()=>{const e=[];return this.refreshInfos.forEach((t=>{const{refreshing:r}=t,n=(new Date).getTime();n-t.lastTime<t.interval||r||(t.lastTime=n,t.refreshing=!0,e.push(t))})),e})(),t=flatten$1(e.map((e=>Array.from(e.computeIds))));((e,r)=>{0!==r.length&&this.computeData(r).then((e=>{this.emit(DATA_REFRESH_EVENT.UPDATE,t,e.result)})).finally((()=>{e.forEach((e=>{e.refreshing=!1}))}))})(e,t)}addComputes(e){e.forEach((e=>{const{id:t,widget:r}=e;if(isNil$3(r))return;let n=this.refreshInfos.find((e=>e.id===r.id));isNil$3(n)&&(n=this.createRefreshInfo(r)),null==n||n.computeIds.add(t)}))}createRefreshInfo(e){var t;const{refresh:r}=e;if(!r||!r.open)return null;const n=timeUnitToMillisecond(oldTime2TimeSecond(null!=(t=r.interval)?t:DEFAULT_REFRESH_INTERVAL)),o=Date.now(),i={id:e.id,computeIds:new Set,lastTime:o,interval:n,refreshing:!1};return this.refreshInfos.push(i),i}reset(){this.refreshInfos=[]}}const DATA_INFO_TYPE={DATASET:"dataset",DATABASE:"database",DATABASE_TABLE:"databaseTable"},getRefreshWidgetsComputes=e=>{const t=[];return getRefreshWidgets(e).forEach((e=>{const r=e.getInstance();r.fieldConfigs.forEach(((n,o)=>{t.push({id:"".concat(r.id,".").concat(o),widget:e,key:o})}))})),t},getRefreshWidgets=e=>e.filter((e=>!1!==e.refresh&&e.refresh.open)),getDataPushAuthority=(e,t)=>{const r=new Map,n=new Map;return e.forEach((e=>{const t=e.getInstance();t.fieldConfigs.forEach(((o,i)=>{const a="".concat(t.id,".").concat(i);n.set(a,e),r.set(a,o)}))})),t({computes:Object.fromEntries(r)}).then((e=>createDataPushAuthority(e,n)))},createDataPushAuthority=(e,t)=>{const r=new Map;return e.forEach((e=>{const{dataInfo:n,id:o}=e,i=t.get(o);isNil$3(i)||n.forEach((e=>{var t;let n=r.get(e.type);isNil$3(n)&&(n=[],r.set(e.type,n));const o=createAuthorityDataName(e);if(""!==o){let r=n.find((e=>e.dataName===o));isNil$3(r)&&(r={dataName:o,enable:e.supportDataPush,widgetNames:[]},n.push(r)),r.widgetNames.push("".concat(null==(t=i.story)?void 0:t.name,"-").concat(i.name))}}))})),mergeDataPushAuthority(r)},mergeDataPushAuthority=e=>[DATA_INFO_TYPE.DATABASE,DATA_INFO_TYPE.DATABASE_TABLE,DATA_INFO_TYPE.DATASET].reduce(((t,r)=>{var n;const o=null!=(n=e.get(r))?n:[];return o.sort(((e,t)=>localeCompare(e.dataName,t.dataName))),t.concat(o)}),[]),createAuthorityDataName=e=>{let t="";if(e.type===DATA_INFO_TYPE.DATASET){const{datasetName:r}=e;t=r}else if(e.type===DATA_INFO_TYPE.DATABASE_TABLE){const{database:r,tableNames:n}=e;t="".concat(r,"_").concat(null==n?void 0:n.join("，"))}else if(e.type===DATA_INFO_TYPE.DATABASE){const{database:r}=e;t=r}return t},DATA_REFRESH_EVENT={ERROR:"error",UPDATE:"update",DISCONNECT:"disconnect"};class DataRefresh{constructor(){__publicField(this,"dataPushHandler",null),__publicField(this,"autoRefreshHandler",null),__publicField(this,"pushableComputes",[]),__publicField(this,"plainComputes",[]),__publicField(this,"listeningComputes",[])}async init(e,t,r,n){const o=getRefreshWidgetsComputes(t);if(this.autoRefreshHandler=this.createAutoRefreshHandler(n),e.enabled){const e=await this.pretreatmentComputes(n,o);r(),await this.registerComputes(n,e)}const i=this.pushableComputes.map((e=>e.id));this.plainComputes=o.filter((e=>!i.includes(e.id))),r()}async pretreatmentComputes(e,t){const r=t.map((e=>e.id)),n=await e.checkPlainComputes(r),o=t.filter((e=>!n.includes(e.id)));return this.plainComputes=t.filter((e=>n.includes(e.id))),o}async registerComputes(e,t){const r=t.map((e=>e.id)),n=await e.registerComputes(r);if(isNil$3(n))return;const o=n.filter((e=>"success"===e.monitorStatus)).map((e=>e.id));this.pushableComputes=t.filter((e=>o.includes(e.id))),this.pushableComputes.length>0&&await this.initDataPushHandler(e)}listenComputes(e){var t,r;this.listeningComputes=getRefreshWidgetsComputes(e);const n=this.listeningComputes.filter((e=>this.plainComputes.map((e=>e.id)).includes(e.id)));null==(t=this.autoRefreshHandler)||t.reset(),null==(r=this.autoRefreshHandler)||r.addComputes(n),e.forEach((e=>{var t;const r=e.getInstance();null==(t=r.setLastRefreshTime)||t.call(r,Date.now())}))}createAutoRefreshHandler(e){const t=new AutoRefreshHandler(e).on(DATA_REFRESH_EVENT.UPDATE,((e,t)=>{this.onUpdate(e,t)}));return timerEngine.addTimer(t),t}async initDataPushHandler(e){this.dataPushHandler=new DataPushHandler(e);await this.dataPushHandler.on(DATA_REFRESH_EVENT.ERROR,(e=>this.fallbackPollRefresh(e))).on(DATA_REFRESH_EVENT.UPDATE,((e,t)=>{this.onUpdate(e,t)})).on(DATA_REFRESH_EVENT.DISCONNECT,(()=>{this.fallbackPollRefresh(this.pushableComputes.map((e=>e.id)))})).start()||(this.pushableComputes=[])}fallbackPollRefresh(e){e.forEach((e=>{var t;const r=this.listeningComputes.find((t=>t.id===e));isNil$3(r)||(null==(t=this.autoRefreshHandler)||t.addComputes([r]),this.pushableComputes=this.pushableComputes.filter((t=>t.id!==e)))}))}onUpdate(e,t){const r=new Map;e.forEach(((e,n)=>{const o=this.listeningComputes.find((t=>t.id===e));if(o){const{widget:e,key:i}=o;let a=r.get(e);a||(a=new Map,r.set(e,a)),a.set(i,t[n])}})),r.forEach(((e,t)=>{var r;const n=t.getInstance();null==(r=n.setFieldValues)||r.call(n,e,{type:"refresh",extPayload:getRefreshByObserveConfig()})}))}}class DuchampStandardEventEmitter{constructor(){__publicField(this,"ee",new EventEmitter)}emit(e,...t){try{this.ee.emit(e,...t)}catch(r){handleJsErrorMessage(r)}}once(e,t){return this.ee.once(e,t),()=>{this.ee.off(e,t)}}on(e,t){return this.ee.on(e,t),()=>{this.ee.off(e,t)}}off(e,t){return this.ee.off(e,t),this}}const DUCHAMP_STANDARD_EVENTS={TABLE_CHANGE:"tablechange",PARAMETER_CHANGE:"parameterchange",WIDGET_CONFIG_CHANGE:"widgetconfigchange",WIDGET_SOURCE_LIST_CHANGE:"widgetsourcelistchange"};function generateDuchampInstanceAPI(e,t){const r=e.eventEmitter;return{ref:t,getSnapshot:()=>e.getStoreSnapshot(),exportTemplate:(t={format:"PDF",merge:!0,delay:5,name:e.name})=>exportPresentationFile({store:e,...t}),emit:r.emit.bind(r),once:r.once.bind(r),on:r.on.bind(r),off:r.off.bind(r)}}function createBatchExecutor(e,{delay:t=100,maxWait:r=300}={}){let n=[];const o=debounce$4((()=>{e(n),n=[]}),t,{maxWait:r});return e=>{n.push(e),o()}}function bindDuchampStandardEvents(e){const t=createBatchExecutor((t=>{let r=!1;const n={widgetIds:new Set,tableIds:new Set,parameterIds:new Set};t.forEach((e=>{var t,o,i;((null==(t=e.refInfo)?void 0:t.widgetIds)||[]).forEach((e=>n.widgetIds.add(e))),((null==(o=e.refInfo)?void 0:o.tableIds)||[]).forEach((e=>n.tableIds.add(e))),((null==(i=e.refInfo)?void 0:i.parameterIds)||[]).forEach((e=>n.parameterIds.add(e))),r=!(!r||!e.needUpdateRelations)}));const o={widgetIds:Array.from(n.widgetIds),tableIds:Array.from(n.tableIds),parameterIds:Array.from(n.parameterIds)},i=e.allReferenceInfo.filter((e=>((e,t)=>t.widgetIds&&t.widgetIds.some((t=>e.widgetIds.has(t)))||t.tableIds&&t.tableIds.some((t=>e.tableIds.has(t)))||t.parameterIds&&t.parameterIds.some((t=>e.parameterIds.has(t))))(n,e.referenceInfo))).map((e=>(e.widget.getInstance().onReferenceResourceChange(o),e.widget.id)));return e.reCalculateWidgets(i,{needUpdateRelations:r})})),r=e.eventEmitter,n=[r.on(DUCHAMP_STANDARD_EVENTS.TABLE_CHANGE,(async e=>t({refInfo:{tableIds:e.map((e=>e.tableId))},needUpdateRelations:!0}))),r.on(DUCHAMP_STANDARD_EVENTS.PARAMETER_CHANGE,(async e=>t({refInfo:{parameterIds:e.map((e=>e.parameterId))},needUpdateRelations:!0}))),r.on(DUCHAMP_STANDARD_EVENTS.WIDGET_CONFIG_CHANGE,(e=>t({refInfo:{widgetIds:e.map((e=>"d-relation-RELATION-WIDGET"===e.type?e.payload.relationMeta.wId:""))}})))];return()=>n.forEach((e=>e()))}var __defProp$2=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,r)=>t in e?__defProp$2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,__spreadValues=(e,t)=>{for(var r in t||(t={}))__hasOwnProp.call(t,r)&&__defNormalProp(e,r,t[r]);if(__getOwnPropSymbols)for(var r of __getOwnPropSymbols(t))__propIsEnum.call(t,r)&&__defNormalProp(e,r,t[r]);return e},__objRest=(e,t)=>{var r={};for(var n in e)__hasOwnProp.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&__getOwnPropSymbols)for(var n of __getOwnPropSymbols(e))t.indexOf(n)<0&&__propIsEnum.call(e,n)&&(r[n]=e[n]);return r},qrcodegen,qrcodegen2;(e=>{const t=class{constructor(e,r,n,o){if(this.version=e,this.errorCorrectionLevel=r,this.modules=[],this.isFunction=[],e<t.MIN_VERSION||e>t.MAX_VERSION)throw new RangeError("Version value out of range");if(o<-1||o>7)throw new RangeError("Mask value out of range");this.size=4*e+17;let a=[];for(let t=0;t<this.size;t++)a.push(!1);for(let t=0;t<this.size;t++)this.modules.push(a.slice()),this.isFunction.push(a.slice());this.drawFunctionPatterns();const s=this.addEccAndInterleave(n);if(this.drawCodewords(s),-1==o){let e=1e9;for(let t=0;t<8;t++){this.applyMask(t),this.drawFormatBits(t);const r=this.getPenaltyScore();r<e&&(o=t,e=r),this.applyMask(t)}}i(0<=o&&o<=7),this.mask=o,this.applyMask(o),this.drawFormatBits(o),this.isFunction=[]}static encodeText(r,n){const o=e.QrSegment.makeSegments(r);return t.encodeSegments(o,n)}static encodeBinary(r,n){const o=e.QrSegment.makeBytes(r);return t.encodeSegments([o],n)}static encodeSegments(e,r,o=1,a=40,l=-1,c=!0){if(!(t.MIN_VERSION<=o&&o<=a&&a<=t.MAX_VERSION)||l<-1||l>7)throw new RangeError("Invalid value");let u,d;for(u=o;;u++){const n=8*t.getNumDataCodewords(u,r),o=s.getTotalBits(e,u);if(o<=n){d=o;break}if(u>=a)throw new RangeError("Data too long")}for(const n of[t.Ecc.MEDIUM,t.Ecc.QUARTILE,t.Ecc.HIGH])c&&d<=8*t.getNumDataCodewords(u,n)&&(r=n);let h=[];for(const t of e){n(t.mode.modeBits,4,h),n(t.numChars,t.mode.numCharCountBits(u),h);for(const e of t.getData())h.push(e)}i(h.length==d);const p=8*t.getNumDataCodewords(u,r);i(h.length<=p),n(0,Math.min(4,p-h.length),h),n(0,(8-h.length%8)%8,h),i(h.length%8==0);for(let t=236;h.length<p;t^=253)n(t,8,h);let f=[];for(;8*f.length<h.length;)f.push(0);return h.forEach(((e,t)=>f[t>>>3]|=e<<7-(7&t))),new t(u,r,f,l)}getModule(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]}getModules(){return this.modules}drawFunctionPatterns(){for(let r=0;r<this.size;r++)this.setFunctionModule(6,r,r%2==0),this.setFunctionModule(r,6,r%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const e=this.getAlignmentPatternPositions(),t=e.length;for(let r=0;r<t;r++)for(let n=0;n<t;n++)0==r&&0==n||0==r&&n==t-1||r==t-1&&0==n||this.drawAlignmentPattern(e[r],e[n]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const t=this.errorCorrectionLevel.formatBits<<3|e;let r=t;for(let o=0;o<10;o++)r=r<<1^1335*(r>>>9);const n=21522^(t<<10|r);i(n>>>15==0);for(let i=0;i<=5;i++)this.setFunctionModule(8,i,o(n,i));this.setFunctionModule(8,7,o(n,6)),this.setFunctionModule(8,8,o(n,7)),this.setFunctionModule(7,8,o(n,8));for(let i=9;i<15;i++)this.setFunctionModule(14-i,8,o(n,i));for(let i=0;i<8;i++)this.setFunctionModule(this.size-1-i,8,o(n,i));for(let i=8;i<15;i++)this.setFunctionModule(8,this.size-15+i,o(n,i));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let r=0;r<12;r++)e=e<<1^7973*(e>>>11);const t=this.version<<12|e;i(t>>>18==0);for(let r=0;r<18;r++){const e=o(t,r),n=this.size-11+r%3,i=Math.floor(r/3);this.setFunctionModule(n,i,e),this.setFunctionModule(i,n,e)}}drawFinderPattern(e,t){for(let r=-4;r<=4;r++)for(let n=-4;n<=4;n++){const o=Math.max(Math.abs(n),Math.abs(r)),i=e+n,a=t+r;0<=i&&i<this.size&&0<=a&&a<this.size&&this.setFunctionModule(i,a,2!=o&&4!=o)}}drawAlignmentPattern(e,t){for(let r=-2;r<=2;r++)for(let n=-2;n<=2;n++)this.setFunctionModule(e+n,t+r,1!=Math.max(Math.abs(n),Math.abs(r)))}setFunctionModule(e,t,r){this.modules[t][e]=r,this.isFunction[t][e]=!0}addEccAndInterleave(e){const r=this.version,n=this.errorCorrectionLevel;if(e.length!=t.getNumDataCodewords(r,n))throw new RangeError("Invalid argument");const o=t.NUM_ERROR_CORRECTION_BLOCKS[n.ordinal][r],a=t.ECC_CODEWORDS_PER_BLOCK[n.ordinal][r],s=Math.floor(t.getNumRawDataModules(r)/8),l=o-s%o,c=Math.floor(s/o);let u=[];const d=t.reedSolomonComputeDivisor(a);for(let i=0,p=0;i<o;i++){let r=e.slice(p,p+c-a+(i<l?0:1));p+=r.length;const n=t.reedSolomonComputeRemainder(r,d);i<l&&r.push(0),u.push(r.concat(n))}let h=[];for(let t=0;t<u[0].length;t++)u.forEach(((e,r)=>{(t!=c-a||r>=l)&&h.push(e[t])}));return i(h.length==s),h}drawCodewords(e){if(e.length!=Math.floor(t.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let r=0;for(let t=this.size-1;t>=1;t-=2){6==t&&(t=5);for(let n=0;n<this.size;n++)for(let i=0;i<2;i++){const a=t-i,s=!(t+1&2)?this.size-1-n:n;!this.isFunction[s][a]&&r<8*e.length&&(this.modules[s][a]=o(e[r>>>3],7-(7&r)),r++)}}i(r==8*e.length)}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let t=0;t<this.size;t++)for(let r=0;r<this.size;r++){let n;switch(e){case 0:n=(r+t)%2==0;break;case 1:n=t%2==0;break;case 2:n=r%3==0;break;case 3:n=(r+t)%3==0;break;case 4:n=(Math.floor(r/3)+Math.floor(t/2))%2==0;break;case 5:n=r*t%2+r*t%3==0;break;case 6:n=(r*t%2+r*t%3)%2==0;break;case 7:n=((r+t)%2+r*t%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[t][r]&&n&&(this.modules[t][r]=!this.modules[t][r])}}getPenaltyScore(){let e=0;for(let i=0;i<this.size;i++){let r=!1,n=0,o=[0,0,0,0,0,0,0];for(let a=0;a<this.size;a++)this.modules[i][a]==r?(n++,5==n?e+=t.PENALTY_N1:n>5&&e++):(this.finderPenaltyAddHistory(n,o),r||(e+=this.finderPenaltyCountPatterns(o)*t.PENALTY_N3),r=this.modules[i][a],n=1);e+=this.finderPenaltyTerminateAndCount(r,n,o)*t.PENALTY_N3}for(let i=0;i<this.size;i++){let r=!1,n=0,o=[0,0,0,0,0,0,0];for(let a=0;a<this.size;a++)this.modules[a][i]==r?(n++,5==n?e+=t.PENALTY_N1:n>5&&e++):(this.finderPenaltyAddHistory(n,o),r||(e+=this.finderPenaltyCountPatterns(o)*t.PENALTY_N3),r=this.modules[a][i],n=1);e+=this.finderPenaltyTerminateAndCount(r,n,o)*t.PENALTY_N3}for(let i=0;i<this.size-1;i++)for(let r=0;r<this.size-1;r++){const n=this.modules[i][r];n==this.modules[i][r+1]&&n==this.modules[i+1][r]&&n==this.modules[i+1][r+1]&&(e+=t.PENALTY_N2)}let r=0;for(const t of this.modules)r=t.reduce(((e,t)=>e+(t?1:0)),r);const n=this.size*this.size,o=Math.ceil(Math.abs(20*r-10*n)/n)-1;return i(0<=o&&o<=9),e+=o*t.PENALTY_N4,i(0<=e&&e<=2568888),e}getAlignmentPatternPositions(){if(1==this.version)return[];{const e=Math.floor(this.version/7)+2,t=32==this.version?26:2*Math.ceil((4*this.version+4)/(2*e-2));let r=[6];for(let n=this.size-7;r.length<e;n-=t)r.splice(1,0,n);return r}}static getNumRawDataModules(e){if(e<t.MIN_VERSION||e>t.MAX_VERSION)throw new RangeError("Version number out of range");let r=(16*e+128)*e+64;if(e>=2){const t=Math.floor(e/7)+2;r-=(25*t-10)*t-55,e>=7&&(r-=36)}return i(208<=r&&r<=29648),r}static getNumDataCodewords(e,r){return Math.floor(t.getNumRawDataModules(e)/8)-t.ECC_CODEWORDS_PER_BLOCK[r.ordinal][e]*t.NUM_ERROR_CORRECTION_BLOCKS[r.ordinal][e]}static reedSolomonComputeDivisor(e){if(e<1||e>255)throw new RangeError("Degree out of range");let r=[];for(let t=0;t<e-1;t++)r.push(0);r.push(1);let n=1;for(let o=0;o<e;o++){for(let e=0;e<r.length;e++)r[e]=t.reedSolomonMultiply(r[e],n),e+1<r.length&&(r[e]^=r[e+1]);n=t.reedSolomonMultiply(n,2)}return r}static reedSolomonComputeRemainder(e,r){let n=r.map((e=>0));for(const o of e){const e=o^n.shift();n.push(0),r.forEach(((r,o)=>n[o]^=t.reedSolomonMultiply(r,e)))}return n}static reedSolomonMultiply(e,t){if(e>>>8!=0||t>>>8!=0)throw new RangeError("Byte out of range");let r=0;for(let n=7;n>=0;n--)r=r<<1^285*(r>>>7),r^=(t>>>n&1)*e;return i(r>>>8==0),r}finderPenaltyCountPatterns(e){const t=e[1];i(t<=3*this.size);const r=t>0&&e[2]==t&&e[3]==3*t&&e[4]==t&&e[5]==t;return(r&&e[0]>=4*t&&e[6]>=t?1:0)+(r&&e[6]>=4*t&&e[0]>=t?1:0)}finderPenaltyTerminateAndCount(e,t,r){return e&&(this.finderPenaltyAddHistory(t,r),t=0),t+=this.size,this.finderPenaltyAddHistory(t,r),this.finderPenaltyCountPatterns(r)}finderPenaltyAddHistory(e,t){0==t[0]&&(e+=this.size),t.pop(),t.unshift(e)}};let r=t;function n(e,t,r){if(t<0||t>31||e>>>t!=0)throw new RangeError("Value out of range");for(let n=t-1;n>=0;n--)r.push(e>>>n&1)}function o(e,t){return!!(e>>>t&1)}function i(e){if(!e)throw new Error("Assertion error")}r.MIN_VERSION=1,r.MAX_VERSION=40,r.PENALTY_N1=3,r.PENALTY_N2=3,r.PENALTY_N3=40,r.PENALTY_N4=10,r.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],r.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=r;const a=class{constructor(e,t,r){if(this.mode=e,this.numChars=t,this.bitData=r,t<0)throw new RangeError("Invalid argument");this.bitData=r.slice()}static makeBytes(e){let t=[];for(const r of e)n(r,8,t);return new a(a.Mode.BYTE,e.length,t)}static makeNumeric(e){if(!a.isNumeric(e))throw new RangeError("String contains non-numeric characters");let t=[];for(let r=0;r<e.length;){const o=Math.min(e.length-r,3);n(parseInt(e.substr(r,o),10),3*o+1,t),r+=o}return new a(a.Mode.NUMERIC,e.length,t)}static makeAlphanumeric(e){if(!a.isAlphanumeric(e))throw new RangeError("String contains unencodable characters in alphanumeric mode");let t,r=[];for(t=0;t+2<=e.length;t+=2){let o=45*a.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t));o+=a.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t+1)),n(o,11,r)}return t<e.length&&n(a.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t)),6,r),new a(a.Mode.ALPHANUMERIC,e.length,r)}static makeSegments(e){return""==e?[]:a.isNumeric(e)?[a.makeNumeric(e)]:a.isAlphanumeric(e)?[a.makeAlphanumeric(e)]:[a.makeBytes(a.toUtf8ByteArray(e))]}static makeEci(e){let t=[];if(e<0)throw new RangeError("ECI assignment value out of range");if(e<128)n(e,8,t);else if(e<16384)n(2,2,t),n(e,14,t);else{if(!(e<1e6))throw new RangeError("ECI assignment value out of range");n(6,3,t),n(e,21,t)}return new a(a.Mode.ECI,0,t)}static isNumeric(e){return a.NUMERIC_REGEX.test(e)}static isAlphanumeric(e){return a.ALPHANUMERIC_REGEX.test(e)}getData(){return this.bitData.slice()}static getTotalBits(e,t){let r=0;for(const n of e){const e=n.mode.numCharCountBits(t);if(n.numChars>=1<<e)return 1/0;r+=4+e+n.bitData.length}return r}static toUtf8ByteArray(e){e=encodeURI(e);let t=[];for(let r=0;r<e.length;r++)"%"!=e.charAt(r)?t.push(e.charCodeAt(r)):(t.push(parseInt(e.substr(r+1,2),16)),r+=2);return t}};let s=a;s.NUMERIC_REGEX=/^[0-9]*$/,s.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,s.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",e.QrSegment=s})(qrcodegen||(qrcodegen={})),qrcodegen2=qrcodegen||(qrcodegen={}),(e=>{const t=class{constructor(e,t){this.ordinal=e,this.formatBits=t}};let r=t;r.LOW=new t(0,1),r.MEDIUM=new t(1,0),r.QUARTILE=new t(2,3),r.HIGH=new t(3,2),e.Ecc=r})(qrcodegen2.QrCode||(qrcodegen2.QrCode={})),(e=>{(e=>{const t=class{constructor(e,t){this.modeBits=e,this.numBitsCharCount=t}numCharCountBits(e){return this.numBitsCharCount[Math.floor((e+7)/17)]}};let r=t;r.NUMERIC=new t(1,[10,12,14]),r.ALPHANUMERIC=new t(2,[9,11,13]),r.BYTE=new t(4,[8,16,16]),r.KANJI=new t(8,[8,10,12]),r.ECI=new t(7,[0,0,0]),e.Mode=r})(e.QrSegment||(e.QrSegment={}))})(qrcodegen||(qrcodegen={}));var qrcodegen_default=qrcodegen,ERROR_LEVEL_MAP={L:qrcodegen_default.QrCode.Ecc.LOW,M:qrcodegen_default.QrCode.Ecc.MEDIUM,Q:qrcodegen_default.QrCode.Ecc.QUARTILE,H:qrcodegen_default.QrCode.Ecc.HIGH},DEFAULT_SIZE=128,DEFAULT_LEVEL="L",DEFAULT_BGCOLOR="#FFFFFF",DEFAULT_FGCOLOR="#000000",DEFAULT_INCLUDEMARGIN=!1,MARGIN_SIZE=4,DEFAULT_IMG_SCALE=.1;function generatePath(e,t=0){const r=[];return e.forEach((function(e,n){let o=null;e.forEach((function(i,a){if(!i&&null!==o)return r.push("M".concat(o+t," ").concat(n+t,"h").concat(a-o,"v1H").concat(o+t,"z")),void(o=null);if(a!==e.length-1)i&&null===o&&(o=a);else{if(!i)return;null===o?r.push("M".concat(a+t,",").concat(n+t," h1v1H").concat(a+t,"z")):r.push("M".concat(o+t,",").concat(n+t," h").concat(a+1-o,"v1H").concat(o+t,"z"))}}))})),r.join("")}function excavateModules(e,t){return e.slice().map(((e,r)=>r<t.y||r>=t.y+t.h?e:e.map(((e,r)=>(r<t.x||r>=t.x+t.w)&&e))))}function getImageSettings(e,t,r,n){if(null==n)return null;const o=r?MARGIN_SIZE:0,i=e.length+2*o,a=Math.floor(t*DEFAULT_IMG_SCALE),s=i/t,l=(n.width||a)*s,c=(n.height||a)*s,u=null==n.x?e.length/2-l/2:n.x*s,d=null==n.y?e.length/2-c/2:n.y*s;let h=null;if(n.excavate){let e=Math.floor(u),t=Math.floor(d);h={x:e,y:t,w:Math.ceil(l+u-e),h:Math.ceil(c+d-t)}}return{x:u,y:d,h:c,w:l,excavation:h}}var SUPPORTS_PATH2D=function(){try{(new Path2D).addPath(new Path2D)}catch(e3){return!1}return!0}();function QRCodeCanvas(e){const t=e,{value:r,size:n=DEFAULT_SIZE,level:o=DEFAULT_LEVEL,bgColor:i=DEFAULT_BGCOLOR,fgColor:a=DEFAULT_FGCOLOR,includeMargin:s=DEFAULT_INCLUDEMARGIN,style:l,imageSettings:c}=t,u=__objRest(t,["value","size","level","bgColor","fgColor","includeMargin","style","imageSettings"]),d=null==c?void 0:c.src,h=React.useRef(null),p=React.useRef(null),[f,g]=React.useState(!1);React.useEffect((()=>{if(null!=h.current){const e=h.current,t=e.getContext("2d");if(!t)return;let l=qrcodegen_default.QrCode.encodeText(r,ERROR_LEVEL_MAP[o]).getModules();const u=s?MARGIN_SIZE:0,d=l.length+2*u,f=getImageSettings(l,n,s,c),g=p.current,m=null!=f&&null!==g&&g.complete&&0!==g.naturalHeight&&0!==g.naturalWidth;m&&null!=f.excavation&&(l=excavateModules(l,f.excavation));const y=window.devicePixelRatio||1;e.height=e.width=n*y;const v=n/d*y;t.scale(v,v),t.fillStyle=i,t.fillRect(0,0,d,d),t.fillStyle=a,SUPPORTS_PATH2D?t.fill(new Path2D(generatePath(l,u))):l.forEach((function(e,r){e.forEach((function(e,n){e&&t.fillRect(n+u,r+u,1,1)}))})),m&&t.drawImage(g,f.x+u,f.y+u,f.w,f.h)}})),React.useEffect((()=>{g(!1)}),[d]);const m=__spreadValues({height:n,width:n},l);let y=null;return null!=d&&(y=React.createElement("img",{src:d,key:d,style:{display:"none"},onLoad:()=>{g(!0)},ref:p})),React.createElement(React.Fragment,null,React.createElement("canvas",__spreadValues({style:m,height:n,width:n,ref:h},u)),y)}function QRCodeSVG(e){const t=e,{value:r,size:n=DEFAULT_SIZE,level:o=DEFAULT_LEVEL,bgColor:i=DEFAULT_BGCOLOR,fgColor:a=DEFAULT_FGCOLOR,includeMargin:s=DEFAULT_INCLUDEMARGIN,imageSettings:l}=t,c=__objRest(t,["value","size","level","bgColor","fgColor","includeMargin","imageSettings"]);let u=qrcodegen_default.QrCode.encodeText(r,ERROR_LEVEL_MAP[o]).getModules();const d=s?MARGIN_SIZE:0,h=u.length+2*d,p=getImageSettings(u,n,s,l);let f=null;null!=l&&null!=p&&(null!=p.excavation&&(u=excavateModules(u,p.excavation)),f=React.createElement("image",{xlinkHref:l.src,height:p.h,width:p.w,x:p.x+d,y:p.y+d,preserveAspectRatio:"none"}));const g=generatePath(u,d);return React.createElement("svg",__spreadValues({height:n,width:n,viewBox:"0 0 ".concat(h," ").concat(h)},c),React.createElement("path",{fill:i,d:"M0,0 h".concat(h,"v").concat(h,"H0z"),shapeRendering:"crispEdges"}),React.createElement("path",{fill:a,d:g,shapeRendering:"crispEdges"}),f)}var QRCode=e=>{const t=e,{renderAs:r}=t,n=__objRest(t,["renderAs"]);return"svg"===r?React.createElement(QRCodeSVG,__spreadValues({},n)):React.createElement(QRCodeCanvas,__spreadValues({},n))};const OffScreenQRCode=observer((e=>jsx(FVSDialog,{visible:!0,classNames:{wrapper:"off-screen-qrcode-dialog-wrapper",body:"off-screen-qrcode-dialog-body"},styles:{mask:{background:"white"}},maskClosable:!1,text4Cancel:null,text4Ok:null,closable:!1,className:"off-screen-qrcode-dialog",children:jsxs("div",{className:"off-screen-qrcode",children:[jsx("div",{className:"qrcode",children:jsx(QRCode,{id:"offScreenQRCode",value:e.url,size:240,fgColor:"#000000"})}),jsx("div",{className:"label",children:duchampIntl.get("Duchamp-Off_Screen_QRcode_Tip")})]})})));let qRCodeDiv=null,root=null;function showOffScreenQRCode(e){qRCodeDiv=document.createElement("div"),document.body.appendChild(qRCodeDiv),root=createRoot$1(qRCodeDiv),root.render(jsx(OffScreenQRCode,{url:e}))}function hideOffScreenQRCode(){var e;qRCodeDiv&&root&&(root.unmount(),null==(e=qRCodeDiv.parentNode)||e.removeChild(qRCodeDiv))}function handleBigScreenInfo(e){var t;const{stories:r,offScreenConfig:n}=e,o=[];for(let i=0;i<(null==(t=n.events)?void 0:t.length);i++){const e=n.events[i];if(!e.disable){let t={};e.type===EVENT_CONFIG_TYPE.SWITCH_PAGE&&(t={pageNames:r.map((e=>e.name))}),o.push({id:e.id,buttonName:e.buttonName,type:e.type,data:t})}}sendMessage({type:"bigScreenInfo",value:{ratio:n.ratio,events:o}})}class BaseActionProxy{constructor(){__publicField(this,"target",null),__publicField(this,"preAction",null)}invoke(e){var t;"click"===e.action?(this.onPointerDown(e),this.onPointerUp(e),this.onClick(e)):"pinch"===e.action?this.onScale(e):"pressMove"===e.action?this.onPressMove(e):"touchStart"===e.action?this.target=getTarget(e):"touchEnd"===e.action&&"pressMove"===(null==(t=this.preAction)?void 0:t.action)&&this.onPointerUp(e),this.preAction=e}onPressMove(e){var t,r;"touchStart"===(null==(t=this.preAction)?void 0:t.action)?this.onPointerDown(e):"pressMove"===(null==(r=this.preAction)?void 0:r.action)&&this.onDrag(e)}onPointerDown(e){var t,r;const n={bubbles:!0,cancelable:!0,view:window,clientX:e.x1,clientY:e.y1},o=new PointerEvent("pointerdown",{...n,pointerType:"mouse"});null==(t=this.target)||t.dispatchEvent(o);const i=new MouseEvent("mousedown",{...n});null==(r=this.target)||r.dispatchEvent(i)}onPointerUp(e){var t,r;const n={bubbles:!0,cancelable:!0,clientX:e.x1,clientY:e.y1,view:window},o=new PointerEvent("pointerup",{...n,pointerType:"mouse"});null==(t=this.target)||t.dispatchEvent(o);const i=new MouseEvent("mouseup",{...n});null==(r=this.target)||r.dispatchEvent(i)}onClick(e){var t;const r=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window,clientX:e.x1,clientY:e.y1});null==(t=this.target)||t.dispatchEvent(r)}onHover(e){var t;const r=new MouseEvent("mouseover",{bubbles:!0,cancelable:!0,view:window,clientX:e.x1,clientY:e.y1});null==(t=this.target)||t.dispatchEvent(r)}onDrag(e){var t,r;const n={bubbles:!0,cancelable:!0,clientX:e.x1,clientY:e.y1,button:-1,buttons:0,movementX:e.dx,movementY:e.dy,view:window},o=new PointerEvent("pointermove",{...n,pointerType:"mouse"});null==(t=this.target)||t.dispatchEvent(o);const i=new MouseEvent("mousemove",{...n});null==(r=this.target)||r.dispatchEvent(i)}onScale(e){var t;const r=new WheelEvent("wheel",{bubbles:!0,cancelable:!0,wheelDeltaX:0,wheelDeltaY:e.dy,clientX:e.x1,clientY:e.y1,view:window,type:"wheel"});null==(t=this.target)||t.dispatchEvent(r)}accept(e){return null!==e}}class TableActionProxy extends BaseActionProxy{onPressMove(e){this.onScale(e)}accept(e){var t,r;return!!(null==(t=null==e?void 0:e.className)?void 0:t.split)&&-1!==(null==(r=e.className.split(" "))?void 0:r.indexOf("grid-container"))}}const actionProxies=[new TableActionProxy,new BaseActionProxy];let currentActionProxy=null,store,url,localChannel;function handleOffScreenAction(e){if(handleScale(e),"touchStart"===e.action){currentActionProxy=null;const t=getTarget(e);for(const e of actionProxies)if(e.accept(t)){currentActionProxy=e;break}}null==currentActionProxy||currentActionProxy.invoke(e)}function getTarget(e){return isNil$3(e.x1)||isNil$3(e.y1)?null:document.elementFromPoint(e.x1,e.y1)}function handleScale(e){const t=e.videoSize?document.documentElement.clientWidth/e.videoSize.width:1;["x1","y1","x2","y2","dx","dy"].forEach((r=>{isNil$3(e[r])||(e[r]=e[r]*t)}))}async function initOffScreenConnect(e){store=e;const t=await store.crudService.getOffScreenSignalingParameters(),{roomID:r,signalingHostName:n,sessionID:o,vconsole:i}=t;let a="".concat(window.location.origin).concat(window.location.pathname);"localhost"===window.location.hostname&&(a=a.replace("localhost",n)),url="".concat(a,"/offScreen/remote/html?roomID=").concat(r,"&sessionID=").concat(o,"&offScreenBaseUrl=").concat(a,"/offScreen&vconsole=").concat(i,"&bounce=false&hideNavigator=true"),showOffScreenQRCode(url),console.info(url),initWebRTC(r,store.crudService)}function initWebRTC(e,t){const r={offerToReceiveVideo:1,iceRestart:!0},n={audio:!1,video:{frameRate:{ideal:30}}};let o,i,a=!1,s=!1;const l=window.RTCPeerConnection;let c=0;function u(r){r!==c||a||t.getRemoteIceCandidate(e).then((e=>{e.iceCandidate&&function(e){i.addIceCandidate(JSON.parse(e))}(e.iceCandidate),setTimeout((()=>{u(r)}),500)}))}function d(r){r===c&&t.getAnswer(e).then((e=>{e?function(e,t){i.setRemoteDescription(JSON.parse(e)).then((()=>{u(t)}))}(JSON.stringify(e),r):setTimeout((()=>{d(r)}),500)}))}function h(n){i.createOffer(r).then((r=>{i.setLocalDescription(r).then((()=>{t.saveWebRTCMessage(e,"offer",JSON.stringify(r)).then((()=>{d(n)}))}))}))}function p(e){var t;o=e,o.getTracks().forEach((e=>{i.addTrack(e,o)})),(null==(t=e.getVideoTracks())?void 0:t.length)>0&&(e.getVideoTracks()[0].onended=()=>{m()}),h(0)}function f(){localChannel.send(JSON.stringify({type:"rejectShareScreen"})),m()}function g(){a||(c++,console.info("no.".concat(c," ice restart..")),t.clearRoomMessage(e).then((()=>{h(c)})),setTimeout((()=>{g()}),5e3))}function m(){sendMessage({type:"state",value:CONNECTION_STATE.CANCEL}),localChannel.close()}t.joinRoom(e),function r(){t.isRemoteJoin(e).then((u=>{u?(hideOffScreenQRCode(),i=new l,localChannel=i.createDataChannel(""),localChannel.onmessage=function(e){receiveMessage(e.data)},i.addEventListener("icecandidate",(r=>{r.candidate&&t.saveWebRTCMessage(e,"icecandidate",JSON.stringify(r.candidate))})),i.addEventListener("iceconnectionstatechange",(e=>{console.info("ice connection state:".concat(e.target.iceConnectionState)),"connected"===e.target.iceConnectionState&&(s=!1,c=0,a=!0,o||navigator.mediaDevices&&"getDisplayMedia"in navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia(n).then(p,f))})),i.addEventListener("connectionstatechange",(e=>{"failed"!==e.target.connectionState||s||(a=!1,s=!0,g())})),h(0)):setTimeout((()=>{r()}),500)}))}()}function sendMessage(e){localChannel.send(JSON.stringify(e))}function receiveMessage(e){const t=JSON.parse(e);"getBigScreenInfo"===t.type?handleBigScreenInfo(store):"event"===t.type?handleOffScreenEvent(store,t):"action"===t.type&&handleOffScreenAction(t)}class WidgetInstanceManager{constructor(){__publicField(this,"widgetInstances",new Map),__publicField(this,"mobileInstances",new Map),__publicField(this,"initFinishedList",new Set),__publicField(this,"loadedList",new Set),__publicField(this,"calculateCenter")}register(e,t){var r;if(this.widgetInstances.has(e.id))return void this.updateInstance(e);const n=widgetManager.getWidgetByName(e.type);n.model&&this.widgetInstances.set(e.id,makeObservable(new n.model(e,t))),!e.model.isPreview&&(null==(r=n.mobileConfig)?void 0:r.model)&&this.mobileInstances.set(e.id,makeObservable(new n.mobileConfig.model(e,t)))}get(e){const t=this.mobileInstances.get(e),r=this.widgetInstances.get(e);return(null==r?void 0:r.isMobile)&&t||r}async instanceInit(e,t,r=[],n,o){var i;n&&(this.calculateCenter=n),await Promise.all(e.filter((e=>!this.initFinishedList.has(e.id))).map((e=>{var t;return null==(t=e.getInstance())?void 0:t.onInit().then((()=>{this.initFinishedList.add(e.id)})).catch((t=>{console.error("widget ".concat(e.name," init error: ").concat(t))}))})));const a=e.filter((e=>!this.loadedList.has(e.id)&&e.getInstance())),s=null!=n?n:this.calculateCenter,l=[...e.map((e=>e.getInstance())),...r];return s&&(a.length>0&&await(null==(i=this.calculateCenter)?void 0:i.cacheCenter.loadCache(l,s.initdList)),"init"===t.type?await s.calculateByInit(new Set(l),o):await s.calculate(new Set(l))),a.forEach((e=>{e.model.isPreview&&(this.loadedList.add(e.id),e.trigger({trigger:WIDGET_EVENT.MOUNTED}))})),e.filter((e=>this.initFinishedList.has(e.id)))}updateInstance(e){[this.widgetInstances,this.mobileInstances].forEach((t=>{const r=t.get(e.id);null==r||r.initStateChangeListeners(e),r&&isFilterable(r)&&r.refresh()}))}}class DuchampServer{constructor(e){__publicField(this,"storeGetter"),__publicField(this,"widgetManager",widgetManager),__publicField(this,"themeManager"),__publicField(this,"widgetInstanceManager",new WidgetInstanceManager),__publicField(this,"sessionID"),__publicField(this,"duchampApi",createApi(duchamp)),__publicField(this,"envInfo"),this.storeGetter=e,this.themeManager=new ThemeManager(this)}get isPreview(){return this.store.isPreview}get calculateCenter(){return this.store.calculateCenter}get parameterCenter(){return this.store.calculateCenter.parameterCenter}setWidgetManager(e){this.widgetManager=e}get store(){return this.storeGetter()}async getTemplateParameters(e={}){const t=new ParameterCenter(clone$3(this.parameterCenter.map));t.setAll(e);const r=new Set;eachParameterConfigs(this.store.parameterConfigs,(e=>{t.has(e.name)||r.add({id:"parameter",fieldConfigs:getParameterFieldConfig(e),renderField:r=>{var n;const o=null==(n=r.get(e.name))?void 0:n.result;t.set(e.name,isArray$c(o)?o.at(0):o)}})}));const n=new CalculateCenter(t,this.calculateCenter.allowMergeCompute).setService(this.calculateCenter.service);await n.calculate(r);return["viewlet"].forEach((e=>{t.delete(e)})),Object.fromEntries(t.map)}register(e){this.widgetInstanceManager.register(e,this)}setSessionID(e){this.sessionID=e}setDuchamp(e){this.duchampApi=createApi(e)}setEnvInfo(e){this.envInfo=e}get resourceBaseUrl(){return this.getEnvInfo().resourceBaseUrl}get assetBaseUrl(){return this.getEnvInfo().assetBaseUrl}getEnvInfo(){var e;return null!=(e=this.envInfo)?e:fvsService.getEnvInfo()}get isSingleton(){return!!this.sessionID}}const GUIDE_OPTION_KEYS={MOBILE_GROUPED_NEVER_SHOW:"isMobileGroupedNeverShow",MOBILE_AUTO_GROUP_TIP_NEVER_SHOW:"isMobileAutoGroupTipNeverShow"};class ComputeServiceMock{async getDeps(e){return getDeps(e.configs)}async compute(e){const{configs:t}=e,r=await Promise.all(Object.entries(t).map((async([e,t])=>{var r;const n=get$5(t,"filters"),o=(null!=(r=null==n?void 0:n.filters)?r:[]).reduce(((e,t)=>(e.set(t.name,t.value),e)),new Map);return[e,await computeItem(t,o)]})));return{result:Object.fromEntries(r)}}}function computeItem(config,parameters){if("chart"===config.type){if("id"in config&&"test"===config.id)return{chartAttr:{}};const{chartType:e}=config.payload;return fetch("json/".concat(e,".json"),{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((async e=>({chartAttr:await e.clone().json()})))}if(isFormulaFieldConfig(config)){const result=config.columns.map((item=>{let text=item.formula.replace("=","");if("RANGE(1,3)"===text)return[1,2,3];null==parameters||parameters.forEach(((e,t)=>{const r=isNaN(Number(e))?'"'.concat(e,'"'):"".concat(e);text=text.replace(new RegExp("\\$".concat(t),"gm"),r)})),null==parameters||parameters.forEach((()=>{text=text.replace(new RegExp("\\$\\w+","gm"),"0")}));try{return eval(text)}catch(e3){return"=".concat(text)}}));return Promise.resolve(result)}return Promise.resolve([])}function getDeps(e){const t={};return Object.entries(e).forEach((([e,r])=>{if(isFormulaFieldConfig(r)){const n=union(flatten$1(r.columns.map((e=>getDepsFromFormula(e.formula))))),o=union(flatten$1(r.columns.map((e=>getFieldDepsFromFormula(e.formula)))));t[e]={parameter:n,field:o}}else t[e]={parameter:[],field:[]}})),Promise.resolve({result:t})}function getFieldDepsFromFormula(e){return(e=e.replace("=","")).split(" ").filter((e=>e.includes("~"))).map((e=>e.split("~")[0]))}function getDepsFromFormula(e){const t=[],r=["+","-","*","/"];let n=-1,o=!1;return(e=e.replace("=","")).split("").forEach((e=>{r.includes(e)?o=!1:(o&&(t[n]=(t[n]||"")+e),"$"===e&&(n++,o=!0))})),t}const base_url="",checkStatus=e=>{if(e.status>=200&&e.status<300)return e;throw e.statusText},appendURL=(e,t={})=>{const r=new URLSearchParams;return Object.keys(t).forEach((e=>r.append(e,t[e]))),"".concat(e,"?").concat(r.toString())};class Http{request(e,t){e.startsWith("http")||(e=base_url+e);let r={headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json","Content-Type":"application/json; charset=UTF-8"}};"UPLOAD"===t.method&&(t.method="POST",r={headers:{}});const n={...t,...r};return fetch(e,n).then(checkStatus).then((e=>{const t=e.headers.get("content-type");return t&&-1!==t.indexOf("application/json")?e.json().then((e=>e)):e.text()})).catch((e=>{throw console.error(e),e}))}get(e,t){return this.request(appendURL(e,t),{method:"GET"})}post(e,t){return this.request(e,{body:JSON.stringify(t),method:"POST"})}put(e,t){return this.request(e,{body:JSON.stringify(t),method:"PUT"})}delete(e,t){return this.request(appendURL(e,t),{method:"DELETE"})}upload(e,t){return this.request(e,{method:"UPLOAD",body:t})}download(e,t){return fetch(appendURL(e,t),{method:"GET",headers:{"Content-Type":"application/json;charset=UTF-8"}}).then((async e=>{var t;const r=null==(t=e.headers.get("content-disposition"))?void 0:t.match(/filename="(.*)"$/),n=r?r[1]:"",o=await e.blob(),i=document.createElement("a");i.download=decodeURIComponent(n),i.style.display="none",i.href=URL.createObjectURL(o),document.body.appendChild(i),i.click(),URL.revokeObjectURL(i.href),document.body.removeChild(i)})).catch((e=>{throw console.error(e),e}))}}const http=new Http;class BaseRelationModel{constructor(){__publicField(this,"eventsEmitter",new EventEmitter)}fireEvent(e,...t){this.eventsEmitter.emit(e,...t)}on(e,t){this.eventsEmitter.addListener(e,t)}off(e,t){this.eventsEmitter.removeListener(e,t)}}class DefaultRelationClass extends BaseRelationModel{get icon(){return""}get referenceInfo(){return{}}refresh(){}doEdit(){}setProps(){}destroy(){}setClearLinkageButtonVisible(e){}}class DefaultCrudService{constructor(){__publicField(this,"computeService",new ComputeServiceMock),__publicField(this,"designerConfig",{storyPanelFold:!1,layerPosition:LAYER_POSITION.NONE,guideOptions:{isMobileGroupedNeverShow:!1,isMobileAutoGroupTipNeverShow:!1}}),__publicField(this,"customHeader",{customButtons:[],customSeq:[]})}async getDeps(e){return this.computeService.getDeps(e)}async compute(e){return this.computeService.compute(e)}getTableWithAncestors(e){return Promise.resolve({id:"table1",name:"表1"})}getTables(){return Promise.resolve(["ds1","ds2","ds3"].map((e=>({id:e,name:e}))))}getTemplateDatasets(){return Promise.resolve(["ds1","ds2","ds3"])}searchTables(e,t){return Promise.resolve([])}getTableRelations(e,t){return Promise.resolve({filterRelations:{},widgetRelations:{},tableRelations:{}})}getTableInfo(e){return Promise.resolve({id:e,name:e,fields:["".concat(e,"-field1"),"".concat(e,"-field2"),"".concat(e,"-field3")].map((e=>({id:e,name:e,type:"string"})))})}registerComputes(e){return Promise.resolve([{id:"aaa.value",monitorStatus:"success"},{id:"bbb.data",monitorStatus:"fail"},{id:"ccc.formula",monitorStatus:"none"}])}checkPlainComputes(e){return Promise.resolve([])}listenComputes(e){return Promise.resolve([])}saveTemplate(e,t,r){return new Promise((r=>{setTimeout((()=>{localStorage.setItem("dashboard-config",JSON.stringify(e)),localStorage.setItem("dashboard-focus-point",JSON.stringify(t)),r(!0)}),1e3)}))}closeTemplate(){return new Promise((e=>{setTimeout((()=>{e(!0)}),1e3)}))}checkDataPushConfig(e){return Promise.resolve([])}preview(e){return new Promise((t=>{setTimeout((()=>{window.open(e===PREVIEW_MODE.PAGE?"preview.html":"mobile.html"),t()}))}))}listDataSetNames(){return Promise.resolve(["ds1","ds2"])}listColumnFieldNames(e){return Promise.resolve(["column1","column2","column3"])}async pasteTableDatas(e,t){return Promise.resolve(!0)}async pasteFiles(e,t){return Promise.resolve(!0)}listAllSubResourceItems(){return Promise.resolve("[]")}getMonitorVideoMessage(e){return Promise.resolve({url:"",id:"",hasAudio:!1})}async getWidgetOptions(e){return fetch("json/NewCity.json",{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((e=>({chartAttr:e.json(),data:{}})))}openToEdit(e,t,r){r.includes("calder/edit.html")&&(window.location.href="http://localhost:21308/packages/calder-widget/src/city/"),r.includes("calder/edit-custom.html")&&(window.location.href="http://localhost:21308/packages/calder-widget/src/custom/")}openGeoLandEdit(e){}getAllParameters(){return Promise.resolve(["参数1","参数2"])}getDesignerConfig(){const e=window.localStorage.getItem(GUIDE_OPTION_KEYS.MOBILE_AUTO_GROUP_TIP_NEVER_SHOW),t=window.localStorage.getItem(GUIDE_OPTION_KEYS.MOBILE_GROUPED_NEVER_SHOW);return Promise.resolve({...this.designerConfig,guideOptions:{...this.designerConfig.guideOptions,isMobileAutoGroupTipNeverShow:"true"===e,isMobileGroupedNeverShow:"true"===t}})}setDesignerConfig(e){return this.designerConfig=e,Promise.resolve()}getOffScreenSignalingParameters(){return Promise.resolve()}joinRoom(e){return Promise.resolve()}isRemoteJoin(e){return Promise.resolve(!1)}saveWebRTCMessage(e,t,r){return Promise.resolve()}getAnswer(e){return Promise.resolve("")}getRemoteIceCandidate(e){return Promise.resolve({})}clearRoomMessage(e){return Promise.resolve()}initWidget(e){return Promise.resolve(!0)}createWidget(e){return Promise.resolve(!0)}listRelationWidgets(e){return new Promise((e=>e([{title:"分组1",key:"1",nodeType:"group",nodeValue:{groupId:"group1"},nodeDraggable:!1,children:[{title:"分析表1",key:"1-1",nodeType:"table",nodeDraggable:!0,nodeValue:{tableId:"table1"}},{title:"分析表2",key:"1-2",nodeType:"table",nodeDraggable:!0,nodeValue:{tableId:"table2"},children:[{title:"分析表2-柱形图1",key:"1-2-2",nodeType:"widget",nodeDraggable:!0,nodeValue:{tableId:"table2",wId:"widget1"}}]}]},{title:"分析表3",key:"2",nodeType:"table",nodeDraggable:!0,nodeValue:{tableId:"table3"},children:[{title:"分析表3-饼图2",key:"2-2",nodeType:"widget",nodeDraggable:!0,nodeValue:{tableId:"table3",wId:"widget3"}}]}])))}listRelationPacks(e){return new Promise((e=>e([{name:"项目1",value:"value1"},{name:"项目2",value:"value2"}])))}listFolders(e){return new Promise((e=>e([{name:"项目1",value:"value1"},{name:"项目2",value:"value2"}])))}checkTemplateNameValid(e){return!0}createEmptyRelationWidget(){}getRelationProject(e){return Promise.resolve({label:"xxx的团队",value:"team"})}initRelationWidget(e,t){return new DefaultRelationClass}createRelationWidget({tableId:e}){return Promise.resolve({wId:"test-id",tableId:e,label:""})}computeFieldDataSet(e){return Promise.resolve({})}computeFieldFont(e){return Promise.resolve({})}getResourceLength(e){return Promise.resolve({})}getDatasets(){return Promise.resolve(["ds1","ds2","ds3"])}getDatasetColumns(e){return Promise.resolve(e?["".concat(e,"-col-1"),"".concat(e,"-col-2"),"".concat(e,"-col-3")]:[])}openDatasetTablePreview(e){alert(e)}getDBSchemas(e){return e?Promise.resolve(["".concat(e,"-schema-1"),"".concat(e,"-schema-2"),"".concat(e,"-schema-3")]):Promise.resolve([])}getDBConnections(){return Promise.resolve(["a","b","c"])}getDBTables(e,t,r){return e&&t?Promise.resolve(["".concat(t,"-1"),"".concat(t,"-2"),"".concat(t,"-3")]):r?Promise.resolve(["".concat(t,"-3"),"".concat(t,"-2"),"".concat(t,"-1")]):Promise.resolve([])}getDBTableColumns(e,t,r){return e&&t&&r?Promise.resolve(["".concat(r,"-1"),"".concat(r,"-2"),"".concat(r,"-3")]):Promise.resolve([])}openDBTablePreview(e,t,r){alert(r)}registerEditingWidget(e){}saveWidgetOptions(e,t){}updateGeoLandCameraState(e,t,r){}copy(e){}playMonitorVideo(e){}endMonitorVideo(e){}getTemplateThemeList(){return Promise.all(map$3(["TEMPLATE_PRESET_LIGHT_1_ZH_CN","TEMPLATE_PRESET_DARK_1_ZH_CN","TEMPLATE_PRESET_DARK_2_ZH_CN","TEMPLATE_PRESET_DARK_3_ZH_CN"],(e=>{return t=e,new Promise((e=>{fetch(createAbsoluteUrl("/assets/template/".concat(t,".json")),{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((e=>e.json())).then((t=>e({id:t.id,config:{...t}})))}));var t})))}createTemplateTheme(e){return Promise.resolve({status:"success"})}deleteTemplateTheme(e){return Promise.resolve({status:"success"})}copyTemplateTheme(e){return Promise.resolve({status:"success"})}updateTemplateTheme(e){return Promise.resolve({status:"success"})}getTemplateThemeDefault(e){return new Promise((t=>{fetch(createAbsoluteUrl("/assets/template/".concat({blue:"TEMPLATE_DEFAULT_LIGHT","dark-blue":"TEMPLATE_DEFAULT_DARK"}[e],".json")),{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((e=>e.json())).then((r=>(r.theme_config.title={blue:duchampIntl.get("Duchamp-Template_Light"),"dark-blue":duchampIntl.get("Duchamp-Template_Dark")}[e],t(r))))}))}isServiceEditable(){return Promise.resolve(!0)}getSelectedDatasets(){return Promise.resolve([])}selectDatasets(e){}editDataset(e){}showReplaceTableDataDialog(e,t){}getConsanguinityEntry(){return Promise.resolve({support:!0})}reuseGuide(e){return Promise.resolve({needGuide:!1})}submitAppShareDesignerMetric(e){}completeReuseGuide(e){}appShareSupportFunctions(){return Promise.resolve([])}produceTemplateConsanguinity(){return Promise.resolve({nodeInfos:[],edges:[]})}getTemplateThemeDefaultGroupColors(){return Promise.resolve([{value:"preset_1",label:"春日花园",colors:["#63B2EE","#76DA91","#F8CB7F","#F89588","#7CD6CF","#9192AB","#7898E1","#EFA666","#EDDD86","#9987CE"],gradient:!1},{value:"preset_2",label:"浪漫沙滩",colors:["#B2BF59","#F29D38","#ECD48D","#6EA740","#EBC582","#A57051","#75CD62","#F2D37F","#D4A082","#64DEC8"],gradient:!1},{value:"preset_3",label:"忧郁森林",colors:["#5A8C8C","#BCBFA4","#F2D88D","#BFA288","#A98A61","#7E5F42","#D6C289","#594653","#366D73","#004966"],gradient:!0},{value:"preset_4",label:"激情海洋",colors:["#116EFF","#75C9FF","#6E7AEB","#1853AC","#44C1C9","#EDDD86","#EFA666","#00B2FF","#7CD6CF","#7898E1"],gradient:!0}])}getCustomNavButtons(){return{subscribe:()=>()=>{},getSnapshot:()=>this.customHeader}}getPresetNavButtonStates(){return{save:{disabled:!1},preview:{disabled:!1}}}async uploadResources(e,t={}){const r=new FormData;e.forEach(((e,t)=>{r.append("files[".concat(t,"]"),e.content),r.append("ids[".concat(t,"]"),e.id)})),r.append("env",JSON.stringify(t));const n=await http.upload("/assets/upload",r);return JSON.parse(n)}deleteResources(e,t={}){return Promise.all(e.map((e=>new Promise((t=>{e.name?http.delete("/assets/custom/".concat(e.name)).then((e=>{t(JSON.stringify(e))})):t(JSON.stringify({}))})))))}async copyResource(e,t,r){const n=new FormData;n.append("resources",JSON.stringify(e)),n.append("fromEnv",JSON.stringify(t)),n.append("toEnv",JSON.stringify(r));const o=await http.upload("/assets/copy",n);return JSON.parse(o)}async getSize(e,t){return 0}openThemeManagerDialog(){}openAISummaryEdit(){}initAISummaryView(){return""}openGlobalChartManagerDialog(){}onStoreModified(){}getTablesFromComputes(e){return Promise.resolve([])}replaceTables(e,t){return Promise.resolve({})}removeDatasets(e){return Promise.resolve()}getRelationWidgetInfos(e){return Promise.resolve([])}editRelationWidget(e,t){}getFieldSummaryInfo(){return{}}}function mockReuseWidgetData(){return{id:v4$1(),uuid:v4$1(),name:"测试",cover:"",constitute:"1",fvsType:"FVS_other-0",mainContentFile:"",vendor:"FVS",designerVersion:"11.0.0",version:"0.0.1",description:"测试文本",creator:"未知用户",createTime:"".concat((new Date).getTime()),groupPath:[""]}}function mockReuseImage(e){return{env:{},resources:[{id:e,type:"image",name:"assets/internal/image/1.jpg"}]}}function mockReuseVideo(e){return{env:{},resources:[{id:e,type:"video",name:"assets/internal/video/01.mp4",payload:{duration:12},subResource:{cover:"id2"}},{id:"id2",type:"image",name:"assets/internal/video/01.png"}]}}function mockReuseWidget(){return{env:{},resources:[{id:"faa63193-2890-45e3-aab2-b2f4c466cc65",type:"image",name:"assets/internal/image/1.jpg",tags:["image"],payload:{isCustom:!0}},{id:"57f24bf6-ae7d-4a44-88db-5f6af12cef6e",type:"image",name:"assets/internal/image/2.jpg",payload:{isPrivate:!0}}]}}class ReuseService{constructor(){__publicField(this,"readReuseResource",(async(e,t)=>t===REUSE_TYPE.IMAGE?mockReuseImage(e):t===REUSE_TYPE.VIDEO?mockReuseVideo(e):t===REUSE_TYPE.WIDGET?mockReuseWidget():{env:{},resources:[]}))}isAppReuseMode(){return!1}getGroupList({resourceType:e}){return REUSE_DEFAULT_SERVICE.getGroupList({resourceType:e})}addGroup(e){return Promise.resolve(!0)}deleteGroup(e){return Promise.resolve(!0)}renameGroup(e){return Promise.resolve(!0)}getLocalResourceList(e){return REUSE_DEFAULT_SERVICE.getLocalResourceList(e)}getDesignerUserName(){return Promise.resolve("username")}showLoginPanelAndGetDesignerUserName(){return Promise.resolve("username")}showAppContent(e){return Promise.resolve("")}getAppPreviewUrl(e){return Promise.resolve("")}uploadReuseResource(e){return Promise.resolve({id:"",cover:"",mainContentFile:"",creator:"",groupPath:[],uuid:"",name:"",vendor:"",description:""})}importLoginCheck(e){return Promise.resolve(!1)}deleteReuseResource(e){return Promise.resolve(!0)}moveReuseResource(e){return Promise.resolve(!0)}updateResourceCover(e){return REUSE_DEFAULT_SERVICE.updateResourceCover(e)}updateResourceInfo(e){return Promise.resolve(!0)}downloadOnlineResource(e){return Promise.resolve(null)}applyReuseFromShop(e){return Promise.resolve(null)}createTemplateByBlank(e,t){return Promise.resolve(null)}downloadTemplateByShop(e){return Promise.resolve(null)}applyLoginCheck(e,t){return Promise.resolve(!1)}applyTplV2(e,t){return Promise.resolve({applySuccess:!0,existApplyWarning:!0,templatePath:""})}openTemplate(e,t){return Promise.resolve(!0)}exportReuseWidget(e){return Promise.resolve(mockReuseWidgetData())}async reloadReuse(e){}applyReuseToTemplate(e,t){return e?t===REUSE_TYPE.IMAGE?Promise.resolve(JSON.stringify({id:"id1",name:"name1",type:t,payload:{resources:[{id:"id1",type:"image",name:"assets/internal/image/1.jpg"}]}})):t===REUSE_TYPE.WIDGET?Promise.resolve(JSON.stringify({id:"id1",name:"name1",type:t,payload:{resources:[{id:"id1",type:"image",name:"assets/internal/image/1.jpg"},{id:"id2",type:"image",name:"assets/internal/image/2.jpg",payload:{isPrivate:!0}}]}})):Promise.resolve(""):Promise.resolve("")}getResourceItem(e,t){return Promise.resolve()}getSthFromShop(e,t){return Promise.resolve("")}postToShop(e,t,r){return Promise.resolve("")}getReuseUsedEnvInfo(){return Promise.resolve("")}applyReuseDataset(e){return this.applyReuseToTemplate(e,REUSE_TYPE.WIDGET).then((e=>e)).catch((()=>(Alert$2.error({title:duchampIntl.get("Duchamp-Reuse_Not_Exist_Title"),content:duchampIntl.get("Duchamp-Reuse_Not_Exist_Content")}),null)))}}const VERTICAL_ALIGN_MAP={start:"top",center:"middle",end:"bottom"},controllerEventPointTransform=e=>{switch(e){case WIDGET_EVENT.MOUNTED:return"afterinit";case WIDGET_EVENT.EDIT_FINISH:return"stopedit";case WIDGET_EVENT.EDIT:return"edit";default:return e.toLowerCase()}},getMarqueeFocusPoint=e=>{const{marquee:t}=e;return!isNil$3(t)&&t.enable?cloneDeep$2(t):null},getDynamicFieldTypeFocusPoint=e=>isInstanceofDynamizable(e)?e.getDynamicValues().map((e=>e.source.type)):[],getLoadContentFocusPoint=(e,t)=>{const{content:r,backgroundColor:n,loadTimeConfig:o,enableLoad:i}=e;let a=null,s=null;if(i)if(isImageContentProps(r)){const{hue:e,opacity:n,resource:i}=r,a=getImageWidgetSrc(t,r.resource),l=null==o?void 0:o.time;s={visImageName:("internal"===i.type?getReuseId(t,i.value):null)||a,visImageOpacity:n,visImageDuration:null!=l?l:0,visImageHue:e}}else if(isVideoContentProps(r)){const e=getSourceFromResource(t,r.resource),{fillType:n}=r,i=null==o?void 0:o.time;a={visVideoName:e,visVideoFill:n,visVideoDuration:null!=i?i:0,visVideoVolume:0}}return{visBackgroundColor:n,visLoadVideo:a,visLoadPicture:s}},getReuseId=(e,t)=>{const r=getResourceInfoByID(t,e);if(r){const e=getPayload$2(r,"reuseId");if(e)return e}return""},collectIconsInternalResource=(e,t=[])=>[...e,...t].filter((e=>!!e&&e.type===RESOURCE_TYPE.INTERNAL)).map((e=>e.value)),getLoadComponentFocusPoint=e=>{const{normalLoadConfig:t=defaultComponentLoading,heavyLoadConfig:r=defaultComponentLoading}=e,{enableLoad:n,resource:o,opacity:i,hue:a}=t,{enableLoad:s,resource:l,opacity:c,hue:u}=r;return{vis2DComponent:n?{type:"simple",target:getTargetNumber(o.value),hue:a,opacity:i}:null,vis3DComponent:s?{type:"animation"===l.type?"animation":"simple",target:getTargetNumber(l.value),hue:u,opacity:c}:null}},getTargetNumber=e=>({spinOne:1,spinTwo:2,spinThree:3,spinFour:4,animationOne:5}[e]||0),getThemeStyle=e=>{const{styleConfig:t}=e;return{themeStyleName:t.theme_config.title,themeStyleType:t.theme===TEMPLATE_THEME_TYPE.DARK?"0":"1"}},getMobileLayoutPoint=e=>e===LAYOUT_TYPE$2.MAGNETIC?0:1,getMobilePageSize=e=>{const{mobile:t}=e;return isNil$3(t.width)||isNil$3(t.height)?e.height>e.width?"".concat(e.width,"*").concat(e.height):"".concat(DEFAULT_MOBILE_SIZE.width,"*").concat(DEFAULT_MOBILE_SIZE.height):"".concat(t.width,"*").concat(t.height)},getMobileNavigationNumber=e=>{const{allWidgets:t}=e;return t.filter((e=>{var t;const{previewConfig:r}=e.platform.mobile.props;return null==(t=null==r?void 0:r.navigation)?void 0:t.enable})).length},getComponentForkIds=e=>{const{allWidgets:t}=e;return[...new Set(t.map((e=>e.forkId)).filter((e=>""!==e)))]},getFocusPointData=e=>{var t,r;const n=[],o=[],i=[],a=[];let s=0,l=0,c=0,u=0,d=0,h=0,p=0,f=0,g=0,m=0,y=0;const v=[],_=[],b=[],C=[],E=[],T=[],S=[],P=[],w={},x={},O=[],$=[],I=[],R=[],A=e.templateVersion||"-999999",D=[],L=[],N=[],M=[],k=[],F=[],j=[],B={mobileLayout:getMobileLayoutPoint(e.platform.mobile.layoutConfig.phone.layout),padLayout:getMobileLayoutPoint(e.platform.mobile.layoutConfig.pad.layout),visMobileBodySize:getMobilePageSize(e),visHeightAdaptiveNumber:0,visZoomNumber:0,visToolbar:"float"===e.platform.mobile.toolbarType?"suspension":"bottom",visNavigationNumber:getMobileNavigationNumber(e),visEnlargeTableNumber:0,visEnlargeChartNumber:0,visAutoGroup:""},W=[],V=[],H=[],G=[],{visBackgroundColor:U,visLoadVideo:Y,visLoadPicture:z}=getLoadContentFocusPoint(e.loadConfig.template,e.resourceCenter),{themeStyleType:K,themeStyleName:Z}=getThemeStyle(e);F.push(K),j.push(Z),k.push(getLoadComponentFocusPoint(e.loadConfig.widget)),N.push(z),M.push(Y),L.push(U),e.totalStories.forEach((t=>{t instanceof Story&&(n.push(t.transition.open?timeUnitToMillisecond(oldTime2TimeMillisecond(t.transition.duration)):0),G.push(!t.platform.mobile.autoGroupsConfig.enabled));const{backgroundLayer:r}=t;if(isCustomBackground(r))v.push(getImageResourceById(e.resourceCenter,r.value.id).imageSource);else if(isInternalBackground(r)){const t=getReuseId(e.resourceCenter,r.value.id);t?t&&v.push(t):v.push(getImageResourceById(e.resourceCenter,r.value.id).imageSource)}else isColorBackground(r)?v.push(r.value):isStoryBackground(r)?v.push("3DBackGround"):v.push("");t.widgets.forEach((r=>{var n,v,L,N,M,k,F,j,G,U,Y,z,K,Z,X,J,Q,q,ee,te,re,ne,oe,ie,ae;if(o.push(r.type),(null==(n=r.states.animation.in)?void 0:n.name)&&i.push(r.states.animation.in.name),(null==(v=r.states.animation.out)?void 0:v.name)&&a.push(r.states.animation.out.name),(r.transform3d.rotateX||r.transform3d.rotateY||r.transform3d.rotateZ)&&s++,widgetIsReserveCanvas(r)){m++;const e=r.props,n=r.model.mobileProps;b.push({visVersion:A,visIsSetTop:null!=(L=e.sticky)&&L,visIsSetLock:null!=(N=e.keepRatio)&&N,visPageName:t.name,visIsMobileRelayout:null!=(M=n.padLayout||n.phoneLayout)&&M})}if(widgetIsGroup(r)&&l++,r.states.keepRatio&&c++,widgetIsTabs(r)){const e=r.props,t=r.children.length,n=r.getInstance();_.push({visVersion:A,visCarouselComponentNumber:t,visCarouselStyle:e.tabButtonType,visCarouselLayout:""===e.tabButtonType?"":e.tabCard.layout,visCarouselDuration:(null==(k=r.carousel)?void 0:k.autoplay)?timeUnitToMillisecond(oldTime2TimeMillisecond(null!=(F=r.carousel.autoplaySpeed)?F:0)):0,..."tab"===e.tabButtonType?{visTabStyle:TABS_FOCUS_POINT[e.tabCard.templateType]}:{},visCarouselPageNumber:t,visCarouselMultiTabNum:r.childWidgets.filter((e=>e.childWidgets.length>1||e.childWidgets.some((e=>widgetIsGroup(e))))).length,visIsSetLock:e.keepRatio||!1,visIsSlideSwitch:(null==(j=n.carousel)?void 0:j.swiper)||!1,visCarouselNestNum:n.tabsDepth-1})}if(widgetIsQueryButton(r)){y++;const e=r.getInstance();I.push({visWidgetName:r.name,visControlRange:e.controlInstances.length===e.relationWidgetIds.length?"all":"part"})}switch(r.type){case"d-local-video":r.props.asset.type===RESOURCE_TYPE.INTERNAL&&p++;break;case"d-image":{const t=t=>{if((null==t?void 0:t.type)===RESOURCE_TYPE.INTERNAL){f++;const r=getReuseId(e.resourceCenter,t.value);r&&W.push(r)}};t(r.props.asset),t(null==(G=r.mobile.props)?void 0:G.asset);break}case"d-live-video":P.push({visVideoProtocolType:r.props.videoType});break;case"d-calder":O.push("".concat(t.name,"/").concat(r.name,"/").concat(t instanceof Story?STORY_TYPE.MAIN:STORY_TYPE.BACKGROUND)),w["".concat(r.id,".json")]=r.getInstance().getFocusPoint();break;case"d-calder-custom":$.push("".concat(t.name,"/").concat(r.name,"/").concat(t instanceof Story?STORY_TYPE.MAIN:STORY_TYPE.BACKGROUND)),x["".concat(r.id,".json")]=r.getInstance().getFocusPoint();break;case"d-text":{const t=r.getInstance(),n=[...t.props.values||[],...t.mobile.props.values||[]];configKit$1.richText.getResourceConfig(n).forEach((t=>{const r=getReuseId(e.resourceCenter,t);r&&H.push(r)}));break}}if(r.border.type===RESOURCE_TYPE.INTERNAL){g++;const t=getReuseId(e.resourceCenter,r.border.value);t&&V.push(t)}if((null==(U=r.mobile.border)?void 0:U.type)===RESOURCE_TYPE.INTERNAL){g++;const t=getReuseId(e.resourceCenter,null==(Y=r.mobile.border)?void 0:Y.value);t&&V.push(t)}if(r.getActions().forEach((t=>{var r;switch(t.type){case DUCHAMP_ACTION_TYPE.JAVASCRIPT:h++;break;case DUCHAMP_ACTION_TYPE.WEB_PAGE_POPOVER:{t.body.dialogType===DIALOG_TYPE.CENTER?u++:d++;const n=t=>{if(t&&t.type===RESOURCE_TYPE.INTERNAL){const r=getReuseId(e.resourceCenter,t.value);r&&V.push(r)}};n(t.body.border),n(null==(r=t.body.mobileConfig)?void 0:r.border);break}}})),r.type.startsWith("d-controller")){const t={visWidgetType:r.type,visWidgetName:r.name,visEnable:r.props.enable,visVisible:r.visible,visFontSize:r.props.fontSize,visEvents:r.widgetEvents.flatMap((e=>e.events)).map((e=>controllerEventPointTransform(e.trigger))).join(","),visCheckAll:r.props.showSelectAll,visWidgetStyle:r.props.styleType},n=(null==(z=r.props.parseValueConfig)?void 0:z.type)||(null==(K=r.props.parseDateConfig)?void 0:K.type);if(n&&(t.visReturnType=n),"d-controller-datetime"===r.type){t.visShortcutButton=r.props.styleConfig.shortcutsType;const e={visWidgetType:r.type,visWidgetName:r.name,visVersion:A,visWidgetStyle:FOCUS_POINT_STYLE_TYPE_MAP[r.model.mobileProps.styleType]};e.visShortcutButton=null==(J=null==(X=null==(Z=r.model)?void 0:Z.mobileProps)?void 0:X.styleConfig)?void 0:J.shortcutsType,R.push(e)}if("d-controller-multi-combo"!==r.type&&"d-controller-combo"!==r.type||R.push({visWidgetType:r.type,visWidgetName:r.name,visVersion:e.templateVersion,visWidgetStyle:r.model.mobileProps.styleType}),"d-controller-radio-group"===r.type){let t=[];const n=r.getInstance();if("graphic"===n.style.styleType){const{styleConfig:e}=n.props;if(isImageTextButtonGroupProps(e)){const{icons:r=[],selected:{icons:n=[]}={}}=e;t=t.concat(collectIconsInternalResource(r,n))}}if("graphic"===n.mobile.props.styleType){const{styleConfig:e}=n.mobile.props;if(e){const{icons:e=[],selected:{icons:r=[]}={}}=n.mobile.props.styleConfig;t=t.concat(collectIconsInternalResource(e,r))}}t.forEach((t=>{const r=getReuseId(e.resourceCenter,t);r&&H.push(r)}))}C.push(t)}if(widgetIsWorkbook(r.type)){(null==(ee=null==(q=null==(Q=r.mobile.props)?void 0:Q.previewConfig)?void 0:q.pinchToZoom)?void 0:ee.enable)&&B.visZoomNumber++;const e={};if(!isNil$3(r.props.fitState)){const t=TABLE_ADAPTIVE_MODES.find((e=>e.value===r.props.fitState));t&&(e.visTableAdapt=t.label)}const{toolbar:t}=r.props;isNil$3(t)||(e.visTableToolBase=null,r.getInstance().showToolbar&&(e.visTableToolBase=t.position),e.visTableTool=t.buttonGroups.flat().filter((e=>e.enable)).map((e=>e.type))),e.visTableMarquee=getMarqueeFocusPoint(r.props),E.push(e),r.getInstance().showMobileZoomButton&&B.visEnlargeTableNumber++}if("d-text-title"===r.type){const e=getMarqueeFocusPoint(r.props),t=r.props.verticalAlign;T.push({visTitleMarquee:e,visVersion:A,visFieldType:getDynamicFieldTypeFocusPoint(r.getInstance()),visWidgetId:r.id,visTitleVerticalAlign:VERTICAL_ALIGN_MAP[t],visTitleAlign:r.props.textAlign})}if("d-text"===r.type){const e=getMarqueeFocusPoint(r.props),t=r.props.verticalAlign;S.push({visVersion:A,visTextMarquee:e,visFieldType:getDynamicFieldTypeFocusPoint(r.getInstance()),visWidgetId:r.id,visTextVerticalAlign:VERTICAL_ALIGN_MAP[t]})}if(r.type===WIDGET_TYPE.EXPAND){const e=r.getInstance();D.push({visVersion:A,visComponent:(null!=(re=null==(te=e.template)?void 0:te.childWidgets)?re:[]).map((e=>({type:e.type,id:e.id}))),visWidgetId:r.id})}if(isAutoHeight(r.model)&&B.visHeightAdaptiveNumber++,widgetIsChart(r)){(null==(ae=null==(ie=null==(oe=null==(ne=r.getInstance().chartOptions)?void 0:ne.chartAttr)?void 0:oe.tools)?void 0:ie.fullScreen)?void 0:ae.enabled)&&B.visEnlargeChartNumber++}}))}));const{previewConfig:X,dataPushConfig:J,cacheConfig:Q}=e,q=G.join(",");return B.visAutoGroup=q,{"FR-F10001":{visBodySize:"".concat(e.width,"*").concat(e.height),visBodyAdapt:null==(t=ADAPTIVE_MODES.find((t=>t.value===e.adaptiveMode)))?void 0:t.label,visPageNumber:e.stories.length,visBackGroundPageNumber:e.backgroundStories.length,visMagicMove:n.join(","),visComponent:Object.entries(countBy$1(o)).map((e=>e.join(":"))).join(","),visComponentAppearAnimation:Object.entries(countBy$1(i)).map((e=>e.join(":"))).join(","),visComponentDisappearAnimation:Object.entries(countBy$1(a)).map((e=>e.join(":"))).join(","),vis3dNumber:s,visCombinationNumber:l,visFixedNumber:c,visBackground:v.join(","),visComponentForkIds:getComponentForkIds(e),visFrameNumber:u,visPopUpNumber:d,visTemplateLoadColor:L,visTemplateLoadPicture:N,visTemplateLoadVideo:M,visComponentLoad:k,visJSUse:h,visInnerVideoNum:p,visInnerPicNum:f,visInnerBoardNum:g,visAutoMove:X.autoplay?X.autoplaySpeed:0,visSwitch:"always"===X.pageButtonDisplayPolicy?1:0,visLoop:X.loop?1:0,visWidgetStyle:e.duchampServer.themeManager.theme,visTimeReload:e.refreshConfig.enabled?1:0,visWatermark:e.watermarkConfig?1:0,visTemplateRendering:e.storyRenderConfig.enableDegradeRender?1:0,visCitySource:O.join(","),visMeshSource:$.join(","),visDataPush:J.enabled?1:0,visInnerPicIds:W,visInnerBoardIds:V,visInnerIconIds:H,visAbsoluteCanvasNum:m,visThemeStyle:F,visThemeStyleName:j,visQueryButtonNum:y,visIsSetSearchPanel:e.controllerPanel.enabled?"set":"unset",visIsAutoSearch:e.controllerPanel.autoSearch?"set":"unset",visSearchPanelWidNum:e.controllerPanel.widgets.length,visSearchPanelWidPage:e.controllerPanel.widgets.map((t=>{const r=e.stories.filter((e=>e.queryControllerHiddenIds.includes(t.id))).length;return r?e.stories.length-r:"all"})).join(","),visSearchPanelMobileStyle:(null==(r=e.controllerPanel.mobile)?void 0:r.styleType)===CONTROLLER_PANEL_MOBILE_STYLE_TYPE.TOP?"Top":"Default",visTemplatereRuestCache:Q.enabled?1:0},"FR-F10002":w,"FR-F10003":_,"FR-F10004":x,"FR-F10005":C,"FR-F10007":E,"FR-F10009":T,"FR-F10010":S,"FR-F10011":P,"FR-F10012":B,"FR-F10013":R,"FR-F10014":b,"FR-F10015":I,"FR-F10016":D}},DEFAULT_PLATFORM_TYPE=PLATFORM.PC;var __defProp$1=Object.defineProperty,__getOwnPropDesc$1=Object.getOwnPropertyDescriptor,__decorateClass$1=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc$1(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp$1(t,r,i),i};class PlatformStoreAdaptor{constructor(e){__publicField(this,"model"),__publicField(this,"mobile"),__publicField(this,"platformType",DEFAULT_PLATFORM_TYPE),this.model=e,this.mobile=new MobileStoreAdaptor(e),makeObservable(this)}get isMobile(){return this.platformType===PLATFORM.MOBILE}setPlatformType(e){this.platformType=e,this.model.story.closeSingleMode()}get scale(){return this.model.scale}setScale(e){}get isAutoScale(){return this.model.isAutoScale}setIsAutoScale(e){}get width(){return this.model.width}get height(){return this.model.height}setSize(e,t){this.model.setSize(e,t)}get keepRatio(){return this.model.keepRatio}setKeepRatio(e){this.model.setKeepRatio(e)}get showAlignmentLine(){return this.model.showAlignmentLine}setShowAlignmentLine(e){this.model.setShowAlignmentLine(e)}get previewLayout(){return LAYOUT_TYPE$2.RESERVE}}__decorateClass$1([observable],PlatformStoreAdaptor.prototype,"platformType",2),__decorateClass$1([computed],PlatformStoreAdaptor.prototype,"isMobile",1),__decorateClass$1([action$1],PlatformStoreAdaptor.prototype,"setPlatformType",1),__decorateClass$1([platformComputed],PlatformStoreAdaptor.prototype,"scale",1),__decorateClass$1([platformAction],PlatformStoreAdaptor.prototype,"setScale",1),__decorateClass$1([platformComputed],PlatformStoreAdaptor.prototype,"isAutoScale",1),__decorateClass$1([platformAction],PlatformStoreAdaptor.prototype,"setIsAutoScale",1),__decorateClass$1([platformComputed],PlatformStoreAdaptor.prototype,"width",1),__decorateClass$1([platformComputed],PlatformStoreAdaptor.prototype,"height",1),__decorateClass$1([platformAction],PlatformStoreAdaptor.prototype,"setSize",1),__decorateClass$1([platformComputed],PlatformStoreAdaptor.prototype,"keepRatio",1),__decorateClass$1([platformAction],PlatformStoreAdaptor.prototype,"setKeepRatio",1),__decorateClass$1([platformComputed],PlatformStoreAdaptor.prototype,"showAlignmentLine",1),__decorateClass$1([platformAction],PlatformStoreAdaptor.prototype,"setShowAlignmentLine",1),__decorateClass$1([platformComputed],PlatformStoreAdaptor.prototype,"previewLayout",1);class BaseActionMenuManager{constructor(e){__publicField(this,"store"),__publicField(this,"eventPicks",[]),__publicField(this,"onSelect",null),makeObservable(this,{eventPicks:observable,executeEvent:action$1,showEvents:action$1}),this.store=e}executeEvent(e){var t;null==(t=this.onSelect)||t.call(this,e),this.eventPicks=[]}showEvents(e,t){this.eventPicks=e,this.onSelect=t,this.showContextMenu()}}class ActionMenuManager extends BaseActionMenuManager{showContextMenu(){const{mouseEvent:e}=this.store;e&&contextMenu.show({id:MENU.EVENT_ACTION,event:e})}}class ExportAdapterManager{constructor(e){__publicField(this,"originalAnimations"),__publicField(this,"autoplay",!1),__publicField(this,"store"),this.originalAnimations=new Map,this.store=e}hideNavigationButton(e){hideNavigationButton(e)}cancelExportAnimation(){this.originalAnimations=cancelExportAnimation(this.store),this.disableAutoPlay()}restoreAnimations(){restoreAnimations(this.store,this.originalAnimations),this.originalAnimations.clear(),this.restoreAutoPlay()}disableAutoPlay(){this.autoplay=changeAutoplayValue(this.store,!1)}disableAnimation(){disableSmoothTransition(this.store),this.cancelExportAnimation()}restoreAutoPlay(){changeAutoplayValue(this.store,this.autoplay)}adapterStyles(e,t){this.hideNavigationButton(t),!e&&addStroyBackGroundScale(t,this.store.platform.scale),this.resetContainerSize(t)}resetContainerSize(e){const t=e.querySelector(".adaptive-content");if(!e||!t)return;const{width:r}=e.style,{height:n}=e.style;t.style.width=r,t.style.height=n}}const hideNavigationButton=e=>{const t=e=>(e&&(e.style.visibility="hidden"),e),r=e.querySelectorAll(".d-iframe");return[...Array.from(r).map((e=>{var r;let n=null;try{n=null==(r=e.contentWindow)?void 0:r.document.querySelector(".story-navigation")}catch(e3){}return t(n)})),t(e.querySelector(".story-navigation"))].filter(Boolean)},cancelExportAnimation=e=>{const t=new Map;return e.allWidgets.forEach((e=>{e.states.animation&&Object.keys(e.states.animation).length>0&&(t.set(e.id,e.states.animation),e.setAnimation({}))})),t},restoreAnimations=(e,t)=>{e.allWidgets.forEach((e=>{t.has(e.id)&&e.setAnimation(t.get(e.id)||{})}))},addStroyBackGroundScale=(e,t)=>{if(!t)return;const r=e.querySelector(".".concat("adaptive-content")),n=e.querySelector(".".concat("adaptive-wrapper-background"));if(!r||!n)return;const o=window.getComputedStyle(r).transformOrigin;n.style.transform="scale(".concat(1/t,")"),n.style.transformOrigin=o},changeAutoplayValue=(e,t)=>{const r=toJS(e.previewConfig),{autoplay:n}=e.previewConfig;return r.autoplay=t,e.setPreviewConfig(r),n},disableSmoothTransition=e=>{e.stories.forEach((e=>{e.updateTransition({...e.transition,open:!1})}))};class LoadedManager{constructor(e){__publicField(this,"events"),__publicField(this,"currentLoadId"),__publicField(this,"lastEmitId"),__publicField(this,"firstLoaded",!0),__publicField(this,"store"),__publicField(this,"needLoadList"),__publicField(this,"storyIdentifyId"),this.events=new EventEmitter,this.store=e,this.currentLoadId="",this.lastEmitId="",this.needLoadList=new Set,this.storyIdentifyId=""}addListenerForOnce(e,t){this.events.once(e,t)}addListener(e,t){this.events.on(e,t)}emit(e,...t){this.events.emit(e,...t)}removeAllListeners(...e){this.events.removeAllListeners(...e)}setCurrentLoadId(e){this.currentLoadId=e}generateStoryIdentifyId(){return this.storyIdentifyId=uuid$2(),this.storyIdentifyId}getStoryIdentifyId(){return this.storyIdentifyId}getCurrentLoadId(){return this.currentLoadId}initNeedLoadList(e){this.needLoadList.clear(),this.needLoadList=new Set([...e])}addLoadedId(e){this.needLoadList.delete(e)}getNeedLoadListSize(){return this.needLoadList.size}updateLastEmitId(){this.firstLoaded&&(this.firstLoaded=!1,"function"==typeof window.homePageLoaded&&window.homePageLoaded(this.store.currentPreviewStoryIndex,this.store.previewStories.length)),this.lastEmitId=this.currentLoadId}getCurrentPageIsEmit(){return this.lastEmitId===this.currentLoadId}}function isInstanceofHostConfigAble(e){return isFunction$8(null==e?void 0:e.applyConfigInHost)}var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__decorateClass=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?__getOwnPropDesc(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&__defProp(t,r,i),i};setGlobalConfig({modelIdGenerator:v4$1});let Store=class extends(Model$1({id:idProp,stories:prop((()=>[])),backgroundStories:prop((()=>[])),width:prop(1280).withSetter(),height:prop(720).withSetter(),keepRatio:prop((()=>!1)).withSetter(),adaptiveMode:prop(ADAPTIVE_MODE.AUTO).withSetter(),showAlignmentLine:prop(!0).withSetter(),templateVersion:prop("").withSetter(),previewConfig:prop((()=>({autoplay:!1,autoplaySpeed:10,loop:!0,pageButtonDisplayPolicy:"always"}))).withSetter(),controllerPanel:prop((()=>({enabled:!1,autoSearch:!0,widgets:[]}))).withSetter(),styleConfig:prop((()=>({theme_config:THEME_DEFAULT_CONFIG,theme:TEMPLATE_THEME_TYPE.DARK,widget:{[TEMPLATE_WIDGET_TYPE_KEY.CONTROLLER]:{content:WIDGET_CONTROLLER_DEFAULT_CONFIG,setting:WIDGET_STATE_DEFAULT_CONFIG},[TEMPLATE_WIDGET_TYPE_KEY.CHART]:{content:WIDGET_CHART_DEFAULT_CONFIG,setting:WIDGET_STATE_DEFAULT_CONFIG},[TEMPLATE_WIDGET_TYPE_KEY.RELATION]:{content:WIDGET_RELATION_DEFAULT_CONFIG,setting:WIDGET_STATE_DEFAULT_CONFIG}},resources:{},id:""}))).withSetter(),parameterConfigs:prop((()=>[])),offScreenConfig:prop((()=>({disable:!0,ratio:4,events:[{id:v4$1(),type:EVENT_CONFIG_TYPE.SWITCH_PAGE,name:duchampIntl.get("Duchamp-Switch_Template_Page"),buttonName:duchampIntl.get("Duchamp-Switch_Page"),builtIn:!0,disable:!1,code:"duchamp.switchStory(pageName)",trigger:""}]}))).withSetter(),refreshConfig:prop((()=>({enabled:!1,interval:{value:6,type:TIME_UNIT$1.SECOND}}))).withSetter(),dataPushConfig:prop((()=>({enabled:!1,dataRefreshOnly:!0}))).withSetter(),watermarkConfig:prop(!1),version:prop(""),storyRenderConfig:prop((()=>({enableDegradeRender:!0}))).withSetter(),cacheConfig:prop((()=>({enabled:!1}))).withSetter(),interactive:prop((()=>({autoLink:!0}))),mobileConfig:prop(),mobile:prop((()=>({keepRatio:!0,showAlignmentLine:!0,layoutConfig:DEFAULT_MOBILE_LAYOUT_CONFIG,toolbarType:MOBILE_TOOLBAR_TYPE.DEFAULT}))).withSetter()})){constructor(){super(...arguments),__publicField(this,"mode","edit"),__publicField(this,"isThemeEdit",!1),__publicField(this,"relationCalculate",new RelationCalculate),__publicField(this,"calculateCenter",new CalculateCenter(void 0,!settingCenter.isFastMode(),this.relationCalculate)),__publicField(this,"duchampServer",new DuchampServer((()=>this))),__publicField(this,"controllerCalculateCenter",new CalculateCenter(void 0,!settingCenter.isFastMode())),__publicField(this,"exportAdapterManager",new ExportAdapterManager(this)),__publicField(this,"actionMenuManager",new ActionMenuManager(this)),__publicField(this,"undoManager",getUndoManager(this)),__publicField(this,"loadedManager",new LoadedManager(this)),__publicField(this,"dataRefresh",new DataRefresh),__publicField(this,"reuseService",new ReuseService),__publicField(this,"crudService",new DefaultCrudService),__publicField(this,"renderManager",new RenderManager),__publicField(this,"eventEmitter",new DuchampStandardEventEmitter),__publicField(this,"transport"),__publicField(this,"target",document.body),__publicField(this,"templateBuiltInFontsInfo"),__publicField(this,"singletonManager",new SingletonManager),__publicField(this,"platform",new PlatformStoreAdaptor(this)),__publicField(this,"scale",1),__publicField(this,"dataLoaded",!1),__publicField(this,"hasLinkage",!1),__publicField(this,"setHasLinkage",(e=>{this.hasLinkage=e})),__publicField(this,"isAutoScale",!0),__publicField(this,"isExporting",!1),__publicField(this,"zenModeEnable",!1),__publicField(this,"computes",{}),__publicField(this,"consanguinity"),__publicField(this,"loadConfig",DEFAULT_LOAD_CONFIG),__publicField(this,"widgetLoadingConfig"),__publicField(this,"resourceCenter",new ResourceCenter({},{})),__publicField(this,"isSupportLineageView",!1),__publicField(this,"appShareFunctions",[]),__publicField(this,"showLineageView",!1),__publicField(this,"setShowLineageView",(e=>{this.showLineageView=e})),__publicField(this,"designerConfig",{storyPanelFold:!1,layerPosition:LAYER_POSITION.NONE,guideOptions:{isMobileGroupedNeverShow:!1,isMobileAutoGroupTipNeverShow:!1}}),__publicField(this,"name","Template"),__publicField(this,"formatPainter",{rangeFormat:{},isFormatterLock:!1,isFormatting:!1}),__publicField(this,"watermarkData",{text:""}),__publicField(this,"showParametersPanel"),__publicField(this,"versionConfig",null),__publicField(this,"isPlay",!0),__publicField(this,"withLic",!0),__publicField(this,"isLoading",!1),__publicField(this,"functionPoints",{chartMap:!0,extendedChart:!0,fvsBigScreenReport:!0,fvsStory:!0,fvs3DComponentCalder:!0,fvs3DComponentCustomModel:!0,fvs3DComponentUnity:!0,fvs3DDataDriven:!0,interactiveChart:!0}),__publicField(this,"functionPointMarker"),__publicField(this,"errorInfo"),__publicField(this,"modified",!1),__publicField(this,"simpleJson",!1),__publicField(this,"currentStory",0),__publicField(this,"currentPreviewStoryIndex",0),__publicField(this,"currentBackgroundStory",0),__publicField(this,"storyType",STORY_TYPE.MAIN),__publicField(this,"isControllerPanelInitialized",!1),__publicField(this,"isControllerPanelComputed",!0),__publicField(this,"saving",!1),__publicField(this,"prevStory",-1),__publicField(this,"mouseEvent"),__publicField(this,"reuseManagers",[]),__publicField(this,"currentReuseType",REUSE_TYPE.WIDGET),__publicField(this,"widgetApplyReuseGroup",null),__publicField(this,"replaceInfo",{running:!1,refreshWidgets:new Set})}get isPreview(){return"preview"===this.mode}get isMagneticLayout(){if(!this.platform.isMobile)return!1;if(this.isPreview)return this.platform.mobile.isPreviewMagneticLayout;const{pad:e,phone:t}=this.platform.mobile.layoutConfig;return e.layout===LAYOUT_TYPE$2.MAGNETIC||t.layout===LAYOUT_TYPE$2.MAGNETIC}setDataLoaded(e){this.dataLoaded=e}get widgetLoadingDelay(){var e,t;return null!=(t=null==(e=this.widgetLoadingConfig)?void 0:e.delay)?t:3e3}onAttachedToRootStore(){0===this.stories.length&&(this.duchampServer.isPreview?this.addStory({background:{type:"empty"}}):this.addStory());const e=reaction((()=>this.backgroundStories.length),(e=>{0===e&&this.stories.forEach((e=>{e.backgroundLayer.deleteCache("backgroundStory"),e.platform.mobile.backgroundLayer.deleteCache("backgroundStory")}))})),t=bindDuchampStandardEvents(this);return()=>{ConsumePoint.stop(),e(),t()}}updateDesignerConfig(e){return this.setDesignerConfig(e),this.crudService.setDesignerConfig(this.designerConfig)}getPageContext(){return new PageContext({getPages:()=>this.stories.map(((e,t)=>({id:e.id,index:t+1,name:e.name,visible:!e.isPreviewHidden}))),getCurrent:()=>this.stories.findIndex((e=>e.id===this.story.id))+1,isLoop:()=>this.previewConfig.loop},{goto:(e,t)=>{const r=this.previewStories.findIndex((t=>t.id===e.id));this.previewSwitchStory(r,t)},setVisible:(e,t)=>{this.switchStoryPreviewHidden(e.index-1,!t)}})}setDesignerConfig(e){this.designerConfig={...this.designerConfig,...e}}setName(e){this.name=e}setInteractiveConfig(e){this.undoManager.withGroup((()=>{this.interactive=e,getAllRelationWidgets(this).forEach((t=>{const{relationActionConfig:r}=t;t.setRelationActionConfig({...r,open:e.autoLink})}))}))}setFormatPainter(e){this.formatPainter=e}setShowParametersPanel(e){this.showParametersPanel=e}get isControllerPanelEnabled(){const{enabled:e,widgets:t}=this.controllerPanel;return e&&!isEmpty$3(t)}get isControllerPanelAutoSearch(){if(!this.isControllerPanelEnabled)return!1;const{autoSearch:e}=this.controllerPanel;return!1===this.showParametersPanel&&!e||e}get themeToken(){const{groupColor:e={colors:[]},textColor:t,backgroundColor:r}=this.styleConfig.theme_config;return[r,t,...e.colors]}get themeHistoryColor(){return this.styleConfig.theme_config.historyColor||[]}setWatermarkData(e){this.watermarkData=e}updateWatermarkText(e){this.watermarkData={...this.watermarkData,text:e}}get isOpenWatermark(){return this.watermarkConfig&&!isEmpty$3(this.watermarkData.id)}handleVersion(e){this.versionConfig=e,0!==e.flag&&console.info("versionConfig:",e)}preventNestingDepthOverflow(){isIframeNestingDepthExceeded()&&this.updatePreviewError(WINDOW_NESTING_DEPTH_EXCEEDED_ERROR_INFO)}get pluginVersion(){var e,t;return null!=(t=null==(e=this.versionConfig)?void 0:e.pluginVersion)?t:fvsService.getBuildInfo().version}async init(e){await withoutUndo((async()=>{var t,r,n,o,i,a,s,l,c,u,d,h,p,f,g;this.preventNestingDepthOverflow(),null==(r=(t=window.performance).mark)||r.call(t,PERFORMANCE_MARK.DATA_INIT_START),isEmpty$3(null==(n=null==e?void 0:e.store)?void 0:n.stories)&&this.changeStoryBackgroundByTheme(null==(i=null==(o=null==e?void 0:e.store)?void 0:o.styleConfig)?void 0:i.theme_config),this.setIsLoading(!0),e&&(this.transport=e.transport,this.widgetLoadingConfig=e.widgetLoadingConfig,this.crudService=Object.assign(this.crudService,null!=(a=e.crudService)?a:{}),this.reuseService=Object.assign(this.reuseService,null!=(s=e.reuseService)?s:{}),this.calculateCenter.setService(this.crudService),this.controllerCalculateCenter.setService(this.crudService),this.handleVersion(e.versionConfig),this.setFunctionPointMarker(e.functionPointMarker),this.setFunctionPoints(e.functionPointsSupport),e.errorCode&&this.setErrorInfo(getFunctionLackErrorInfo(this,e.errorCode)),this.setWatermarkData({...e.watermark,text:""}),this.setSimpleJson(e.simpleJson));const m=new StoreLoadEvent((()=>{var t;this.duchampServer.isPreview&&(runJavascriptCode({code:null==e?void 0:e.pageLoadEventHandlerString,duchampApi:this.duchampServer.duchampApi}),this.previewStories.length>0&&this.eventEmitter.emit(DUCHAMP_EVENTS.STORY_CHANGE,null==(t=this.previewStories[this.currentPreviewStoryIndex])?void 0:t.name),initRelationCalculate(this))}));if(null==e?void 0:e.store){e.store.styleConfig&&this.setStyleConfig(e.store.styleConfig),processStoreData(e,this.duchampServer.themeManager.themeVars);const{computes:t,loadConfig:r,preParameters:n=[],resources:o,...i}=e.store,[a,s]=fork(n,(e=>"formula"===e.type));this.computes=null!=(l=e.store.computes)?l:{};const h=e.store.resources||(null==(c=e.store.styleConfig)?void 0:c.resources)||{},p=this.isThemeEdit?{themeID:this.styleConfig.id}:{};this.resourceCenter=createResourceCenter(h,p,this.crudService),this.consanguinity=e.store.consanguinity,this.loadConfig=null!=(u=e.store.loadConfig)?u:DEFAULT_LOAD_CONFIG,this.templateBuiltInFontsInfo=e.store.templateBuiltInFontsInfo,this.duchampServer.themeManager.updateTheme(null==(d=e.store.styleConfig)?void 0:d.theme);try{await widgetDependencyManager.load(getAllWidgetTypes(getTotalStories(e.store)),"preview"===this.mode)}catch(e3){console.error(e3)}settingCenter.supportAppFunc(DUCHAMP_APP_FUNC.LINEAGE)&&(await this.crudService.getConsanguinityEntry().then((e=>{e&&this.setIsSupportLineageView(e.support)})).catch((e=>{console.error(e)})),await this.crudService.appShareSupportFunctions().then((e=>{e&&this.setAppShareFunctions(e)})).catch((e=>{console.error(e)}))),this.calculateCenter.onCalculateError((e=>{const t=getCalculatePreviewSessionTimeoutError(e);t&&this.updatePreviewError(t)})),await withoutUndo((async()=>{var t,r;const n=null!=(r=null==(t=e.store)?void 0:t.stories)?r:[],o=handleCurrentStoryByURL((this.duchampServer.isPreview?n.filter((e=>!e.isPreviewHidden)):n).length,!this.duchampServer.sessionID);this.applySnapshot(i,o,checkFunctionPointsCode(e.code,e.functionPointsSupport,e.todayHourNumber),(()=>{m.setStoreDataLoaded()}));const l=await this.initControllerPanel(s,a);this.setStoryIndex(o,{originalStory:null},this.duchampServer.isPreview,this.isControllerPanelAutoSearch?l:void 0),this.isControllerPanelAutoSearch&&this.calculateCenter.parameterCenter.setAll(l.getParameterFiltersObject());const{tplPath:c,tplLastModifiedTime:u}=fvsService.getEnvInfo();this.calculateCenter.cacheCenter.init(c,this.cacheConfig.enabled,this.pluginVersion,u,(()=>{var e,t;return[...null!=(t=null==(e=this.totalStories.find((e=>e===this.story)))?void 0:e.widgets)?t:[],...flatten$1(this.totalStories.filter((e=>e!==this.story)).map((e=>e.widgets)))].map((e=>e.getInstance()))})()),this.calculateCenter.setComputableGetter((()=>getComputableDictionary(this,a))),this.calculateCenter.setStoryIndexGetter((()=>getCurrentStoryIndex(this))),preprocessStaticParameter(s).forEach((e=>{this.calculateCenter.parameterCenter.set(e.name,e.value)}))})),e.store.stories&&!e.isCreate||this.setModified(!0)}if(this.setIsLoading(!1),this.duchampServer.isPreview){if(0===this.previewStories.length)return void this.updatePreviewError(LACK_PREVIEW_STORY_ERROR_INFO);!this.offScreenConfig.disable&&(null==e?void 0:e.openOffScreen)&&initOffScreenConnect(this),this.recordConsumePoint(),this.refreshConfig.enabled&&setTimeout((()=>{window.location.reload()}),timeUnitToMillisecond(this.refreshConfig.interval)),exportPresentationFileWithUrl(this),emitCurrentStoryLoaded(this),this.transport&&this.dataRefresh.init(this.dataPushConfig,this.allWidgets,(()=>this.dataRefresh.listenComputes(this.story.relatedWidgets)),{registerComputes:this.crudService.registerComputes,computeByKeys:e=>this.calculateCenter.calculateStoryComputableList(e).then((t=>({result:e.map((e=>t.get(e)))}))),checkPlainComputes:this.crudService.checkPlainComputes,transport:this.transport,crudService:this.crudService}),this.relationCalculate.onLinkage((e=>{this.setHasLinkage(e),this.eventEmitter.emit(DUCHAMP_EVENTS.LINKAGE_CHANGE,e)}))}else markUseless(this.resourceCenter,this.collectResourceIDs(),!0),this.setDesignerConfig(await this.crudService.getDesignerConfig()),onPatches(this,(()=>{this.setModified(!0)}));this.setDataLoaded(!0),null==(p=(h=window.performance).mark)||p.call(h,PERFORMANCE_MARK.DATA_INIT_END),this.duchampServer.themeManager.updateTheme(null==(g=null==(f=null==e?void 0:e.store)?void 0:f.styleConfig)?void 0:g.theme),m.setStoreInitialized()})).catch((e=>{throw console.error(e),e}))}setMode(e){this.mode=e}setIsThemeEdit(e){this.isThemeEdit=e}setModified(e){this.modified=e,e&&this.crudService.onStoreModified()}setSimpleJson(e){this.platform.isMobile||(this.simpleJson=e)}setIsControllerPanelInitialized(e){this.isControllerPanelInitialized=e}setIsControllerPanelComputed(e){this.isControllerPanelComputed=e}setStoryType(e,t){const r=this.story;this.undoManager.withoutUndo((()=>{this.storyType=e,this.setStoryIndex(null!=t?t:this.storyIndex,{originalStory:r})}))}createBackgroundStory(){this.setStoryType(STORY_TYPE.BACKGROUND,0);const e=this.backgroundStories.at(0);return e||this.addStory()}editBackgroundStory(e){const t=this.backgroundStories.find((t=>t.id===e));t&&this.setStoryType(STORY_TYPE.BACKGROUND,this.backgroundStories.indexOf(t))}addBackgroundStory(e){this.backgroundStories.push(e)}get mainStory(){return this.isPreview?0===this.previewStories.length?null:this.previewStories[this.currentPreviewStoryIndex]:0===this.stories.length?null:this.stories[this.currentStory]}get backgroundStory(){return 0===this.backgroundStories.length?null:this.backgroundStories[this.currentBackgroundStory]}get isBackgroundStory(){return this.storyType===STORY_TYPE.BACKGROUND}get story(){var e;return this.isBackgroundStory&&null!=(e=this.backgroundStory)?e:this.mainStory}get showStories(){return this.isBackgroundStory?this.backgroundStories:this.stories}get totalStories(){return[].concat(this.stories,this.backgroundStories)}get previewStories(){return this.stories.filter((e=>!e.isPreviewHidden))}get storyDeletable(){return this.isBackgroundStory?this.backgroundStories.length>=1:this.stories.length>1}get storyIndex(){return this.isBackgroundStory?this.currentBackgroundStory:this.currentStory}setStoryIndex(e,t,r=!1,n){this.beforeStoryMount(e,t,r,n),r?this.currentPreviewStoryIndex=e:this.isBackgroundStory?this.currentBackgroundStory=e:this.currentStory=e}setSize(e,t){const r={width:this.width,height:this.height};this.width=e,this.height=t,this.keepRatio&&[...this.stories,...this.backgroundStories].forEach((n=>{n.updateWidgetsSizeByScale(r,{width:e,height:t})}))}setScale(e,t=!0){withoutUndo((()=>{this.scale=t?Math.min(Math.max(floor$2(e,2),DESIGNER.ZOOM.min/100),DESIGNER.ZOOM.max/100):e}))}setIsAutoScale(e){withoutUndo((()=>{this.isAutoScale=e}))}setWatermarkConfig(e){this.watermarkConfig=e,this.isOpenWatermark?this.calculateCenter.calculate(new Set([this.createWatermarkComputable()])):this.updateWatermarkText("")}setExporting(e){this.isExporting=e}setIsSupportLineageView(e){this.isSupportLineageView=e}setAppShareFunctions(e){this.appShareFunctions=e}setZenModeEnable(e){this.zenModeEnable=e}setIsLoading(e){this.isLoading=e}setFunctionPointMarker(e){this.functionPointMarker=e}setFunctionPoints(e){this.functionPoints=e}setErrorInfo(e){this.errorInfo=e}setCurrentReuseType(e){this.currentReuseType=e}addStory(e){var t;const{background:r,index:n}=e||{},o=null!=r?r:pick(toJS(this.styleConfig.theme_config.background),["type","value"]),i=createUniqueName(this.showStories.map((e=>e.name)),this.isBackgroundStory?duchampIntl.get("Duchamp-Background_Story"):duchampIntl.get("Duchamp-Story"));null==(t=this.story)||t.setCurrents([]);const a=null!=n?n:this.showStories.length;this.setStoryIndex(a);const s=this.isBackgroundStory?new BackgroundStory$1({name:i,background:o}):new Story({name:i,background:o});return s.setStore(this),this.showStories.splice(a,0,s),s}deleteStory(e){const t=e===this.storyIndex;linkageWhenRemoveWidgets(this,this.showStories[e].widgets.filter((e=>widgetIsParameter(e)))),this.showStories.splice(e,1),0===this.showStories.length&&this.setStoryType(STORY_TYPE.MAIN),this.storyIndex>=e&&this.setStoryIndex(Math.max(this.storyIndex-1,0)),t&&chartConfigPanelManager.hideEditPane()}createWatermarkComputable(){const{id:e=""}=this.watermarkData;return{id:"",fieldConfigs:new Map([[e,{type:"string"}]]),renderField:t=>{var r;const n=null==(r=t.get(e))?void 0:r.result;this.updateWatermarkText("".concat(n))}}}createOtherComputableList(){const e=[];return this.isOpenWatermark&&isEmpty$3(this.watermarkData.text)&&e.push(this.createWatermarkComputable()),e}initControllerPanel(e,t){const{widgets:r,enabled:n}=this.controllerPanel,o=new Filter("and"),i=e.find((e=>"__pi__"===e.name));if(this.setShowParametersPanel(normalizePiParam(null==i?void 0:i.value)),!n)return Promise.resolve(o);const a=getParameterComponents(this.parameterConfigs,t.map((e=>e.name)),(()=>getFieldPayload(this)));return t.forEach((e=>{a.add(new Parameter(e,"preParameter",(()=>getFieldPayload(this))))})),this.controllerCalculateCenter.setComputableGetter((()=>{const e=r.map((e=>e.getInstance()));return{parameterComponents:a,storyComponents:[new Set(e)],filterComponents:new Set(e),currentStoryIndex:-1}})),this.calculateCenter.setStoryIndexGetter((()=>-1)),this.isPreview&&this.isControllerPanelEnabled&&!this.isControllerPanelAutoSearch&&(this.setIsPlay(!1),this.setIsControllerPanelComputed(!1)),preprocessStaticParameter(e).forEach((e=>{this.controllerCalculateCenter.parameterCenter.set(e.name,e.value)})),this.duchampServer.widgetInstanceManager.instanceInit(r,{type:"init"},[],this.controllerCalculateCenter).then((()=>(this.setIsControllerPanelInitialized(!0),r.forEach((e=>{const t=e.getInstance();t.setCalculateCenter(this.controllerCalculateCenter),o.updateFilter(t.getFilter())})),o)))}beforeStoryMount(e,t={},r=!1,n){var o;const{initWidgets:i=!0,originalStory:a}=t,{enabled:s,widgets:l}=this.controllerPanel,{loadedManager:c}=this,u=c.generateStoryIdentifyId();if(r||this.clearStoryState(a),r&&s&&!isEmpty$3(l)&&!this.isControllerPanelAutoSearch)return;const d=r?this.previewStories.length:this.showStories.length;if(e<0||e>=d)return;const h=r?this.previewStories[e]:this.showStories[e];if(i&&!this.isThemeEdit){const e=sortWidgetsByPosition(flatAvailableWidgets(h.rootWidgets,{fetcher:e=>e.needInitChildWidgets}));this.duchampServer.widgetInstanceManager.instanceInit(e,{type:"init"},this.createOtherComputableList(),this.calculateCenter,n).then((()=>{c.emit(STORY_LOADED_EVENT.STORY_INIT_CALCULATE_FINISHED,u)})),this.setHasLinkage(null!=(o=this.relationCalculate.hasLinkage(e.map((e=>e.id))))&&o)}const{id:p}=h,{backgroundLayer:f}=h.platform;isStoryBackground(f)&&this.storyApplyBackgroundStory(p,f.value,i,n)}storyApplyBackgroundStory(e,t,r=!0,n){var o;const i=this.backgroundStories.find((e=>e.id===(null==t?void 0:t.id)));r&&this.duchampServer.widgetInstanceManager.instanceInit(null!=(o=null==i?void 0:i.widgets)?o:[],{type:"init"},[],this.calculateCenter,n),null==i||i.widgets.forEach((r=>{var n;const o=r.getInstance(),i=null!=(n=null==t?void 0:t.widgets[r.id])?n:null;isInstanceofHostConfigAble(o)&&o.applyConfigInHost({story:e,...i},!1)}))}clearStoryState(e=this.story){if(!e)return;const{backgroundLayer:t}=e.platform;if(isStoryBackground(t)){const e=this.backgroundStories.find((e=>{var r;return e.id===(null==(r=t.value)?void 0:r.id)}));null==e||e.widgets.forEach((e=>{var r,n;const o=e.getInstance();isInstanceofHostConfigAble(o)&&(null==(n=o.unMountConfigInHost)||n.call(o,null==(r=t.value)?void 0:r.widgets[e.id]).then((r=>{var n;r&&t.setValue({widgets:{...null==(n=t.value)?void 0:n.widgets,[e.id]:r}})})))}))}e.setCurrents([]),e.closeSingleMode()}sortStories(e,t){const r=this.showStories.findIndex((t=>t.name===e));arrayMove(this.showStories,r,t),this.setStoryIndex(t)}async copyStory(e){var t,r;const n=this.showStories[e];if(!n)return;const o=await getAllWidgetResourceDependence(n.widgets,this.crudService),i=this.isBackgroundStory?"backgroundStory":"story",{resources:a,...s}=null!=(t=await n.backgroundLayer.onCopy(BACKGROUND_STORY_SYMBOL))?t:{},{resources:l,...c}=null!=(r=await n.platform.mobile.backgroundLayer.onCopy(MOBILE_BACKGROUND_STORY_SYMBOL))?r:{},{files:u,tables:d}=mergeResourceDependence(mergeResourceDependence(o,a),l),h=u.reduce(((e,t)=>{const r=this.resourceCenter.getInfoWithSubByID(t);return r&&(e=e.concat(r)),e}),[]);ClipboardHelper.set(i,{...s,...c,story:getSnapshot(n),templateId:this.id,templateName:this.name,storyResource:{files:h,tables:d}})}async pasteStory(e){return await new PasteStoryHandler(this).execute(e)}insertStory(e,t){this.showStories.splice(e,0,t),this.setStoryIndex(e,{initWidgets:!1})}applySnapshot(e,t,r,n){var o;if(isFastMode()&&this.isPreview){const i=getOriginalIndex(null!=(o=e.stories)?o:[],t,(e=>!e.isPreviewHidden));this.applyStoreSnapshotWithAsync(e,i,n),this.withLic=r}else applySnapshot(this,{...getSnapshot(this),...e,$modelType:this.$modelType,id:this.id}),this.withLic=r,n()}applyStoreSnapshotWithAsync(e,t,r){var n;const o=null!=(n=e.stories)?n:[];if(0===o.length)return void r();const i=o.map(((e,r)=>r===t?e:{...e,widgets:e.widgets.filter((e=>widgetIsController(e)))}));applySnapshot(this,{...getSnapshot(this),...e,stories:i,$modelType:this.$modelType,id:this.id});const a=generateLoadOrder(t,o.length).toSpliced(0,1);if(0===a.length)return void r();const s=a.map((e=>o[e]));performChunk(s,((e,t)=>{const r=this.stories[a[t]];r&&e&&(applySnapshot(r,e),a[t]===getStoryIndex(this.story,this.stories)&&this.duchampServer.widgetInstanceManager.instanceInit(flatAvailableWidgets(r.rootWidgets,{fetcher:e=>e.needInitChildWidgets}).filter((e=>!widgetIsController(e))),{type:"init"}))}),r)}getStoreSnapshot(){return{...getSnapshot(this),id:"",$modelType:"",loadConfig:this.loadConfig,templateBuiltInFontsInfo:this.templateBuiltInFontsInfo,...collectionStoreInfo(this),resources:this.resourceCenter.getInfos()}}async beforeSave(){const e=this.story.currentWidgets.reduce(((e,t)=>{const r=null==t?void 0:t.getInstance();if(isInstanceofDegradeable(r)){const t=new Promise((e=>{r.fireEvent("save",(()=>e()))}));e.push(t)}return e}),[]);await Promise.all(e)}async save(e=!1,t){if(this.saving)return Promise.resolve(!1);this.setSaving(!0),this.setModified(!1),await this.beforeSave(),markUseless(this.resourceCenter,this.collectResourceIDs());const r=Object.values(this.resourceCenter.getInfos()),n=[];r.map((e=>{const t=getPayload$2(e,"markUseless");t&&t>=uselessTimes2Remove&&n.push(e.id)})),await this.resourceCenter.delete(n),this.templateBuiltInFontsInfo=await this.collectTemplateBuiltInFonts();const o=this.getStoreSnapshot();return this.crudService.saveTemplate(o,getFocusPointData(this),e,t).then((e=>(e||this.setModified(!0),!0))).catch((()=>(this.setModified(!0),!1))).finally((()=>{this.setSaving(!1)}))}setSaving(e){this.saving=e}setMouseEvent(e){this.mouseEvent=e}previewSwitchStory(e,t){e<0?Message.error(duchampIntl.get("Duchamp-Unable_To_Switch_Story")):(e=Math.min(e,this.previewStories.length-1))!==this.currentPreviewStoryIndex&&(this.prevStory=this.currentPreviewStoryIndex,this.setStoryIndex(e,{},!0,new Filter("and").updateParameterFilters(null!=t?t:{})),!this.duchampServer.sessionID&&updateURLParam({key:URL_PAGE_NUMBER_KEY,value:"".concat(e+1)}),this.isPreview&&emitCurrentStoryLoaded(this),this.eventEmitter.emit(DUCHAMP_EVENTS.STORY_CHANGE,this.previewStories[e].name,this.previewStories[this.prevStory].name),this.dataRefresh.listenComputes(this.story.relatedWidgets),!this.isPlay&&this.setIsPlay(!0))}previewNextStory(e){this.previewSwitchStory(this.currentPreviewStoryIndex===this.previewStories.length-1?this.previewConfig.loop?0:this.currentPreviewStoryIndex:this.currentPreviewStoryIndex+1,e)}previewPreviousStory(e){this.previewSwitchStory(0===this.currentPreviewStoryIndex?this.previewConfig.loop?this.previewStories.length-1:this.currentPreviewStoryIndex:this.currentPreviewStoryIndex-1,e)}switchStoryPreviewHidden(e,t){const r=this.stories.findIndex((e=>e.id===this.mainStory.id));e<0||t&&this.stories[e].isPreviewHidden||!t&&!this.stories[e].isPreviewHidden||(r!==e?(this.stories[e].setIsPreviewHidden(t),e<r&&(this.currentPreviewStoryIndex=t?this.currentPreviewStoryIndex-1:this.currentPreviewStoryIndex+1,!this.duchampServer.sessionID&&updateURLParam({key:URL_PAGE_NUMBER_KEY,value:"".concat(this.currentPreviewStoryIndex+1)}))):Message.error(duchampIntl.get("Duchamp-Unable_To_Hide_Current_Story")))}setPageButtonDisplayPolicy(e){["always","never","hover"].includes(e)&&(this.previewConfig.pageButtonDisplayPolicy=e)}setIsPlay(e){this.isPlay=e}setParameterConfigItem(e,t){var r;const n=[];for(let o=0;o<=Math.max(e,this.parameterConfigs.length-1);o++)o===e?n.push(t):n.push(null!=(r=this.parameterConfigs[o])?r:[]);this.parameterConfigs=n}syncStyleConfigResources(){this.styleConfig.resources=this.resourceCenter.getInfos()}setThemeConfig(e){var t;this.styleConfig.id=e.id,this.applyThemeStyle(e.theme_config,e.theme,e.widget,e.resources),this.isThemeEdit&&this.resourceCenter.refresh({...null==(t=this.styleConfig)?void 0:t.resources},{themeID:this.styleConfig.id})}applyThemeStyle(e,t,r,n){this.undoManager.withGroup((()=>{this.styleConfig.theme_config=e,this.styleConfig.widget=r,this.styleConfig.theme=t,n&&(this.styleConfig.resources=n),this.duchampServer.themeManager.updateTheme(t),this.allWidgets.forEach((e=>{this.updateWidgetStyleByTheme({widgetType:TEMPLATE_WIDGET_TYPE_KEY.CONTROLLER,partialContent:r.controller.content,partialSetting:r.controller.setting,widget:e}),this.updateWidgetStyleByTheme({widgetType:TEMPLATE_WIDGET_TYPE_KEY.CHART,partialContent:r.chart.content,widget:e}),this.updateWorkBookWidgetStyleByTheme(e)})),this.triggerStoryWidgetsThemeChange(),this.controllerPanel.widgets.forEach((e=>{e.getInstance().onThemeChange(this.duchampServer.themeManager.themeVars)})),this.changeStoryBackgroundByTheme(e)}))}changeThemeBackgroundStyle(e){this.styleConfig.theme_config=e,this.changeStoryBackgroundByTheme(e)}addResourceInfo2Theme(e){e&&e.id&&(this.styleConfig.resources||(this.styleConfig.resources={}),addPayload(e,"fromTheme",!0),this.styleConfig.resources[e.id]=e)}setStyleThemeConfig(e){this.styleConfig.theme_config={...this.styleConfig.theme_config,...e}}changeStoryBackgroundByTheme(e){e&&this.stories.forEach((t=>{t.platform.backgroundLayer.setBackground(pick(e.background,["type","value"]))}))}setCurrentStoryWidgetThemeStyle({widgetType:e,partialSetting:t,partialContent:r}){this.undoManager.withoutUndo((()=>{var n;let o=!1;isEmpty$3(t)||e!==TEMPLATE_WIDGET_TYPE_KEY.CONTROLLER||(o=!0,templateThemePropMergeWith(this.styleConfig.widget[e].setting,t)),isEmpty$3(r)||(o=!0,templateThemePropMergeWith(null==(n=this.styleConfig.widget[e])?void 0:n.content,r)),o&&this.mainStory.widgets.forEach((n=>{this.updateWidgetStyleByTheme({widgetType:e,partialSetting:t,partialContent:r,widget:n})}))}))}updateWidgetStyleByTheme({widgetType:e,partialSetting:t,partialContent:r,widget:n}){if(e===n.widgetType&&(isEmpty$3(t)||each$3(t,((e,t)=>{var r;const o=t.at(0);o&&(null==(r=n["set".concat(t.replace(o,o.toUpperCase()))])||r.call(n,isPlainObject$1(e)?templateThemePropMergeWith(n[t],e):e))})),!isEmpty$3(r)))switch(n.widgetType){case TEMPLATE_WIDGET_TYPE_KEY.CONTROLLER:templateThemePropMergeWith(n.props,r);break;case TEMPLATE_WIDGET_TYPE_KEY.CHART:{const e=this.getStyleWidgetConfig(TEMPLATE_WIDGET_TYPE_KEY.CHART),{content:t}=e,r=formatThemeObjectColor2ResultColor(this.themeToken,PREFIX_THEME_KEY,t);this.isThemeEdit?otherService.computeTemplateThemeChart({type:n.type,chartWidgetStyle:r,themeColors:{...this.styleConfig.theme_config,theme:this.styleConfig.theme}}).then((e=>{const t=new Map;t.set("config",e),n.getInstance().setFieldValues(t,{type:"init"})})):otherService.applyTemplateThemeWidgetContent({type:n.type,id:n.id,themeColors:{...this.styleConfig.theme_config,theme:this.styleConfig.theme},widgetFilePath:n.model.chartFileName,chartWidgetStyle:r}).then((()=>{n.getInstance().refresh()}))}}}updateWorkBookWidgetStyleByTheme(e){if(e.type===WIDGET_TYPE.WORKBOOK){const t=this.getStyleWidgetConfig(TEMPLATE_WIDGET_TYPE_KEY.CHART),{content:r}=t,n=formatThemeObjectColor2ResultColor(this.themeToken,PREFIX_THEME_KEY,r);otherService.applyTemplateThemeWidgetContent({type:e.type,id:e.id,themeColors:{...this.styleConfig.theme_config,theme:this.styleConfig.theme},widgetFilePath:e.model.tableFileName,chartWidgetStyle:n}).then((()=>{var t,r;null==(r=null==(t=e.getInstance())?void 0:t.refresh)||r.call(t)}))}}updateWidgetDataStyle(e){const t=e.widgetType;if(t!==TEMPLATE_WIDGET_TYPE_KEY.CONTROLLER)return;const r=this.getStyleWidgetConfig(t),n=getTemplateCompatibilityPureController(r);templateThemePropMergeWith(e.props,{...n.content}),templateThemePropMergeWith(e,n.setting)}updateChartWidgetStyle(e){const t=e.widgetType;if(this.getStyleWidgetConfig(t)&&t===TEMPLATE_WIDGET_TYPE_KEY.CHART){const t=this.getStyleWidgetConfig(TEMPLATE_WIDGET_TYPE_KEY.CHART),{content:r}=t,n=formatThemeObjectColor2ResultColor(this.themeToken,PREFIX_THEME_KEY,r);return this.isThemeEdit?otherService.computeTemplateThemeChart({type:e.type,chartWidgetStyle:n,themeColors:{...this.styleConfig.theme_config,theme:this.styleConfig.theme}}).then((t=>{const r=new Map;r.set("config",t),e.getInstance().setFieldValues(r,{type:"init"})})):otherService.applyTemplateThemeWidgetContent({type:e.type,id:e.id,widgetFilePath:e.model.chartFileName,chartWidgetStyle:n,themeColors:{...this.styleConfig.theme_config,theme:this.styleConfig.theme}})}return Promise.resolve()}getStyleWidgetConfig(e){return toJS(this.styleConfig.widget[e])}triggerStoryWidgetsThemeChange(){this.allWidgets.forEach((e=>{e.getInstance().onThemeChange(this.duchampServer.themeManager.themeVars)}))}getParameterConfig(e){for(const t of this.parameterConfigs){const r=t.find((t=>t.name===e));if(r)return r}return null}get isChanged(){return this.modified}checkFunctionPoint(e){return!e||!this.withLic||this.functionPoints[e]}checkWidgetFunctionPoint(e,t){return this.withLic&&"interactiveChart"===e?!(!this.functionPoints[e]&&(null==t?void 0:t.refresh))||!t.refresh.open:!e||!this.withLic||this.functionPoints[e]}checkMobileFunctionPoint(){return this.withLic&&this.functionPointMarker!==FUNCTION_POINT_MARKER.MOBILE}get allWidgets(){return this.totalStories.flatMap((e=>e.widgets))}get allControllerWidgets(){return this.allWidgets.filter((e=>widgetIsParameter(e)))}get queryPanelDisplayedWidgets(){return this.controllerPanel.widgets.filter((e=>!this.mainStory.queryControllerHiddenIds.includes(e.id)))}get allReferenceInfo(){const e=[];return this.allWidgets.forEach((t=>{const r=t.getInstance();isEmpty$3(r.referenceInfo)||e.push({widget:t,referenceInfo:r.referenceInfo})})),e}reCalculateWidgets(e,{needUpdateRelations:t=!1}){const r=e.reduce(((e,t)=>{const r=this.duchampServer.widgetInstanceManager.get(t);return r?e.add(r):e}),new Set);return this.calculateCenter.calculate(r,"refresh",{},{},t)}getReuseManagerByType(e,t=REUSE_LOCAL_SORT.TIME_ASCENDING){let r=this.reuseManagers.find((t=>t.type===e));return r||(r=new ReuseManager({type:e,localSort:t}),this.reuseManagers.push(r)),r}getWidgetManagerGroup(){return this.widgetApplyReuseGroup||(this.widgetApplyReuseGroup=new ReuseManagerGroup([{type:REUSE_TYPE.WIDGET,localSort:REUSE_LOCAL_SORT.TIME_ASCENDING},{type:REUSE_TYPE.IMAGE,localSort:REUSE_LOCAL_SORT.NAME_ASCENDING},{type:REUSE_TYPE.VIDEO,localSort:REUSE_LOCAL_SORT.NAME_ASCENDING,onlineDisable:!0}])),this.widgetApplyReuseGroup}get widgetReuseGroup(){return this.getWidgetManagerGroup()}get widgetReuse(){return this.getReuseManagerByType(REUSE_TYPE.WIDGET)}get imageReuse(){return this.getReuseManagerByType(REUSE_TYPE.IMAGE,REUSE_LOCAL_SORT.NAME_ASCENDING)}get videoReuse(){return this.getReuseManagerByType(REUSE_TYPE.VIDEO,REUSE_LOCAL_SORT.NAME_ASCENDING)}getControllerPanelConfig(){return{...toJS(this.controllerPanel),widgets:this.controllerPanel.widgets.map((e=>{const t=e.getInstance();return{id:e.id,type:e.type,props:t.getConfigurationConfig(),dataType:t.dataType}})),displayStoryInfos:this.stories.map((({id:e,queryControllerHiddenIds:t,name:r})=>({id:e,queryControllerHiddenIds:[...t],name:r})))}}async setControllerPanelConfig(e){const t=intersection(e.widgets.map((e=>e.id)),this.controllerPanel.widgets.map((e=>e.id))),r=await Promise.all(e.widgets.map((e=>{if(t.includes(e.id)){const t=this.controllerPanel.widgets.find((t=>t.id===e.id));if(!t)return null;const r=clone$4(t,{generateNewIds:!1});r.setStore(t.store);const n=r.getInstance();return n.setCalculateCenter(this.controllerCalculateCenter),n.setConfigurationConfig(e.props),r}return createWidgetAndInit(e.id,e.type,e.props,this.duchampServer)}))),n=[];this.controllerPanel.widgets.forEach((e=>{detach(e),n.push([e.name,null])}));const o=r.filter((e=>!!e));this.setControllerPanel({...e,widgets:o}),await Promise.all(this.controllerPanel.widgets.map((e=>e.getInstance().refresh())));const i=new Filter("and");this.isControllerPanelAutoSearch&&o.forEach((e=>{const t=e.getInstance();i.updateFilterValues(t.getFilter().getFilters())})),this.calculateCenter.linkageGlobal(this.calculateCenter.mergeFilter(i)),e.displayStoryInfos.forEach((({id:e,queryControllerHiddenIds:t})=>{var r;const n=this.stories.find((t=>t.id===e));null==(r=null==n?void 0:n.setQueryControllerHiddenIds)||r.call(n,t)}))}applyControllerPanelParameters(){if(!this.controllerPanel.enabled)return;!this.isControllerPanelComputed&&this.setIsControllerPanelComputed(!0);const e=!this.isControllerPanelAutoSearch;this.controllerPanel={...this.controllerPanel,autoSearch:!0};const t=new Filter("and");this.controllerPanel.widgets.forEach((e=>{const r=e.getInstance();t.updateFilter(r.getFilter())})),e?this.setStoryIndex(this.currentPreviewStoryIndex,void 0,!0,t):this.calculateCenter.linkageGlobal(this.calculateCenter.mergeFilter(t))}widgetsIsOnCanvas(e,t=0){const r=calculateAreaBound(e.map((e=>e.states)));return isOverlap({...r,width:r.width+t,height:r.height+t},this.canvasRect)}getWidgetsToCanvasOffset(e,t){if(this.widgetsIsOnCanvas(e,t))return{offsetX:0,offsetY:0};const r=calculateAreaBound(e.map((e=>e.states)));return getRectOffset({...r,width:r.width+t,height:r.height+t},this.canvasRect)}get canvasRect(){return{left:0,top:0,width:this.width,height:this.height}}widgetFillCanvas(e,t=1){const r=e.getInstance().visibleRect;return!isNil$3(r)&&isContainRect(r,this.canvasRect,t)}setTarget(e){this.target=e}updatePreviewError(e){this.isPreview&&e.errorCode&&this.setErrorInfo(e)}collectStoreResourceIDs(){const e=new Set;return getResourceIDsInLoadConfig(this.loadConfig).forEach((t=>e.add(t))),Array.from(e)}async collectTemplateBuiltInFonts(){const{builtInFonts:e}=fvsService.getEnvInfo(),t=new Set;try{const r=await Promise.all(this.totalStories.map((async t=>await collectStoryBuiltInFonts(t,e,this.crudService))));return r.flatMap(Object.values).flat().forEach((e=>{t.add(e)})),{templateBuiltInFontsDetail:r,templateUsedBuiltInFonts:[...t]}}catch(e3){return console.error(e3),{templateBuiltInFontsDetail:[],templateUsedBuiltInFonts:[]}}}collectResourceIDs(){const e=new Set;return this.totalStories.forEach((t=>{t.collectResourceIDs().forEach((t=>e.add(t)))})),Array.from(e).concat(this.collectStoreResourceIDs())}collectResourceDetails(){const e=this.totalStories.flatMap((e=>e.collectResourceDetails()));return e.push({type:"store",allResource:this.collectStoreResourceIDs()}),e}collectLineageData(){return{stories:this.stories.map((e=>e.collectLineageData())),controllerPanel:this.controllerPanel.widgets.map((e=>({id:e.id,name:e.name,props:e.props}))),...collectionStoreInfo(this),resources:this.resourceCenter.getInfos()}}clearAllLinkage(){this.relationCalculate.clearAll(getStoryIndex(this.story,this.stories))}replaceData(e){this.setOffScreenConfig(replaceOffScreenConfigData(this.offScreenConfig,e))}recordConsumePoint(){let e=0,t=0;const r=(r,n)=>{n&&(e||(e=performance.now()),t=performance.now())};this.eventEmitter.once(DUCHAMP_EVENTS.PAGE_LOADED,((n,o)=>{ConsumePoint.recordConsumePoint(this,{timeOut:!!o,firstStoryChangeTime:e,lastStoryChangeTime:t}),this.eventEmitter.off(DUCHAMP_EVENTS.STORY_CHANGE,r)})),this.eventEmitter.on(DUCHAMP_EVENTS.STORY_CHANGE,r)}};function getUndoManager(e){return undoMiddleware(e,void 0,{attachedState:{save:()=>({storyType:e.storyType,storyIndex:e.storyIndex,widgetsStatesInfo:e.isMagneticLayout&&e.mainStory&&!e.isPreview?getWidgetsStatesInfo(e.mainStory.platform.mobile.widgets||[]):null}),restore:t=>{e.storyType===t.storyType&&e.storyIndex===t.storyIndex||e.setStoryType(t.storyType,t.storyIndex),!e.isMagneticLayout||e.isPreview||isEqual$4(getWidgetsStatesInfo(e.mainStory.platform.mobile.widgets),t.widgetsStatesInfo)||e.mainStory.platform.mobile.updateWithUndo()}}})}__decorateClass([computed],Store.prototype,"isPreview",1),__decorateClass([computed],Store.prototype,"isMagneticLayout",1),__decorateClass([observable],Store.prototype,"scale",2),__decorateClass([observable],Store.prototype,"dataLoaded",2),__decorateClass([modelAction],Store.prototype,"setDataLoaded",1),__decorateClass([observable],Store.prototype,"hasLinkage",2),__decorateClass([modelAction],Store.prototype,"setHasLinkage",2),__decorateClass([observable],Store.prototype,"isAutoScale",2),__decorateClass([observable],Store.prototype,"isExporting",2),__decorateClass([observable],Store.prototype,"zenModeEnable",2),__decorateClass([observable],Store.prototype,"isSupportLineageView",2),__decorateClass([observable],Store.prototype,"appShareFunctions",2),__decorateClass([observable],Store.prototype,"showLineageView",2),__decorateClass([modelAction],Store.prototype,"setShowLineageView",2),__decorateClass([observable],Store.prototype,"designerConfig",2),__decorateClass([modelAction],Store.prototype,"updateDesignerConfig",1),__decorateClass([jsApi({travel:!0,flatten:!0})],Store.prototype,"getPageContext",1),__decorateClass([modelAction],Store.prototype,"setDesignerConfig",1),__decorateClass([observable],Store.prototype,"name",2),__decorateClass([modelAction],Store.prototype,"setName",1),__decorateClass([modelAction,focusPoint(getInteractiveConfigPoint,"after")],Store.prototype,"setInteractiveConfig",1),__decorateClass([observable],Store.prototype,"formatPainter",2),__decorateClass([modelAction],Store.prototype,"setFormatPainter",1),__decorateClass([observable],Store.prototype,"watermarkData",2),__decorateClass([observable],Store.prototype,"showParametersPanel",2),__decorateClass([modelAction],Store.prototype,"setShowParametersPanel",1),__decorateClass([computed],Store.prototype,"isControllerPanelEnabled",1),__decorateClass([computed],Store.prototype,"isControllerPanelAutoSearch",1),__decorateClass([computed],Store.prototype,"themeToken",1),__decorateClass([computed],Store.prototype,"themeHistoryColor",1),__decorateClass([modelAction],Store.prototype,"setWatermarkData",1),__decorateClass([modelAction],Store.prototype,"updateWatermarkText",1),__decorateClass([observable],Store.prototype,"isPlay",2),__decorateClass([observable],Store.prototype,"withLic",2),__decorateClass([observable],Store.prototype,"isLoading",2),__decorateClass([observable],Store.prototype,"functionPoints",2),__decorateClass([observable],Store.prototype,"functionPointMarker",2),__decorateClass([observable],Store.prototype,"errorInfo",2),__decorateClass([observable],Store.prototype,"modified",2),__decorateClass([modelAction],Store.prototype,"setModified",1),__decorateClass([observable],Store.prototype,"simpleJson",2),__decorateClass([modelAction],Store.prototype,"setSimpleJson",1),__decorateClass([observable],Store.prototype,"currentStory",2),__decorateClass([observable],Store.prototype,"currentPreviewStoryIndex",2),__decorateClass([observable],Store.prototype,"currentBackgroundStory",2),__decorateClass([observable],Store.prototype,"storyType",2),__decorateClass([observable],Store.prototype,"isControllerPanelInitialized",2),__decorateClass([observable],Store.prototype,"isControllerPanelComputed",2),__decorateClass([modelAction],Store.prototype,"setIsControllerPanelInitialized",1),__decorateClass([modelAction],Store.prototype,"setIsControllerPanelComputed",1),__decorateClass([modelAction],Store.prototype,"setStoryType",1),__decorateClass([modelAction],Store.prototype,"createBackgroundStory",1),__decorateClass([modelAction],Store.prototype,"editBackgroundStory",1),__decorateClass([modelAction],Store.prototype,"addBackgroundStory",1),__decorateClass([computed],Store.prototype,"mainStory",1),__decorateClass([computed],Store.prototype,"backgroundStory",1),__decorateClass([computed],Store.prototype,"isBackgroundStory",1),__decorateClass([computed],Store.prototype,"story",1),__decorateClass([computed],Store.prototype,"showStories",1),__decorateClass([computed],Store.prototype,"totalStories",1),__decorateClass([computed],Store.prototype,"previewStories",1),__decorateClass([computed],Store.prototype,"storyDeletable",1),__decorateClass([computed],Store.prototype,"storyIndex",1),__decorateClass([modelAction],Store.prototype,"setStoryIndex",1),__decorateClass([modelAction],Store.prototype,"setSize",1),__decorateClass([modelAction],Store.prototype,"setScale",1),__decorateClass([modelAction],Store.prototype,"setIsAutoScale",1),__decorateClass([modelAction],Store.prototype,"setWatermarkConfig",1),__decorateClass([modelAction],Store.prototype,"setExporting",1),__decorateClass([modelAction],Store.prototype,"setIsSupportLineageView",1),__decorateClass([modelAction],Store.prototype,"setAppShareFunctions",1),__decorateClass([modelAction,focusPoint(getEnterZenModePoint)],Store.prototype,"setZenModeEnable",1),__decorateClass([modelAction],Store.prototype,"setIsLoading",1),__decorateClass([modelAction],Store.prototype,"setFunctionPointMarker",1),__decorateClass([modelAction],Store.prototype,"setFunctionPoints",1),__decorateClass([modelAction],Store.prototype,"setErrorInfo",1),__decorateClass([modelAction],Store.prototype,"setCurrentReuseType",1),__decorateClass([modelAction],Store.prototype,"addStory",1),__decorateClass([modelAction],Store.prototype,"deleteStory",1),__decorateClass([modelAction],Store.prototype,"sortStories",1),__decorateClass([modelAction],Store.prototype,"copyStory",1),__decorateClass([modelAction],Store.prototype,"insertStory",1),__decorateClass([modelAction],Store.prototype,"applySnapshot",1),__decorateClass([modelAction],Store.prototype,"applyStoreSnapshotWithAsync",1),__decorateClass([observable],Store.prototype,"saving",2),__decorateClass([modelAction],Store.prototype,"setSaving",1),__decorateClass([observable],Store.prototype,"prevStory",2),__decorateClass([modelAction],Store.prototype,"previewSwitchStory",1),__decorateClass([modelAction],Store.prototype,"previewNextStory",1),__decorateClass([modelAction],Store.prototype,"previewPreviousStory",1),__decorateClass([modelAction],Store.prototype,"switchStoryPreviewHidden",1),__decorateClass([modelAction],Store.prototype,"setPageButtonDisplayPolicy",1),__decorateClass([modelAction],Store.prototype,"setIsPlay",1),__decorateClass([modelAction],Store.prototype,"setParameterConfigItem",1),__decorateClass([modelAction],Store.prototype,"syncStyleConfigResources",1),__decorateClass([modelAction],Store.prototype,"setThemeConfig",1),__decorateClass([modelAction],Store.prototype,"applyThemeStyle",1),__decorateClass([modelAction],Store.prototype,"changeThemeBackgroundStyle",1),__decorateClass([modelAction],Store.prototype,"addResourceInfo2Theme",1),__decorateClass([modelAction],Store.prototype,"setStyleThemeConfig",1),__decorateClass([modelAction],Store.prototype,"changeStoryBackgroundByTheme",1),__decorateClass([modelAction],Store.prototype,"setCurrentStoryWidgetThemeStyle",1),__decorateClass([modelAction],Store.prototype,"updateWidgetStyleByTheme",1),__decorateClass([modelAction],Store.prototype,"updateWorkBookWidgetStyleByTheme",1),__decorateClass([modelAction],Store.prototype,"updateWidgetDataStyle",1),__decorateClass([modelAction],Store.prototype,"updateChartWidgetStyle",1),__decorateClass([computed],Store.prototype,"allWidgets",1),__decorateClass([computed],Store.prototype,"queryPanelDisplayedWidgets",1),__decorateClass([computed],Store.prototype,"allReferenceInfo",1),__decorateClass([observable],Store.prototype,"reuseManagers",2),__decorateClass([observable],Store.prototype,"currentReuseType",2),__decorateClass([modelAction],Store.prototype,"getReuseManagerByType",1),__decorateClass([observable],Store.prototype,"widgetApplyReuseGroup",2),__decorateClass([modelAction],Store.prototype,"getWidgetManagerGroup",1),__decorateClass([computed],Store.prototype,"widgetReuseGroup",1),__decorateClass([computed],Store.prototype,"widgetReuse",1),__decorateClass([computed],Store.prototype,"imageReuse",1),__decorateClass([computed],Store.prototype,"videoReuse",1),__decorateClass([modelAction],Store.prototype,"setControllerPanelConfig",1),__decorateClass([modelAction],Store.prototype,"applyControllerPanelParameters",1),__decorateClass([computed],Store.prototype,"canvasRect",1),Store=__decorateClass([model$1("duchamp/RootStore")],Store);const setAppConfig=(e=DefaultAppSetting)=>{settingCenter.initConfig(e),registerDuchampWidgets(),registerDuchampBackground()};export{isValidChildrenForParent as $,ALIGN_TYPE as A,BorderConfig as B,ComponentLoadPanel as C,DUCHAMP_APP_SERVICE as D,ErrorBoundary as E,widgetSupportPlatform as F,GAP_SIZE as G,chartConfigPanelManager as H,isBackgroundStory as I,useUnmount$2 as J,backgroundManager as K,LabelItem$1 as L,isStoryBackground as M,NameConfig as N,BACKGROUND_TYPE$1 as O,PreviewConfig as P,IMAGE_SCOPE_BACKGROUND as Q,Rotate3d as R,SizeInput as S,TemplateLoadPanel as T,LottieAnimation as U,VerticalItem$1 as V,WidgetConfiguration as W,useI18n as X,GUIDE_OPTION_KEYS as Y,getWidgetIcon as Z,__vitePreload as _,useStore as a,base$2 as a$,WidgetDragManager as a0,ORDER_TYPE as a1,useSize_1 as a2,floor$2 as a3,useKeyPressEvent as a4,collectResourceDependence as a5,getIDsWithSub as a6,getAllWidgetResourceList as a7,getReuseFileMaxSize as a8,REUSE_FILE_MAX_SIZE as a9,FVSDialog as aA,useEnv as aB,collectionStoreInfo as aC,createDialog as aD,REPLACE_DATASET_ENTRANCE as aE,APP_SHARE_FUNCTIONS as aF,PLATFORM as aG,TEMPLATE_STYLE_TYPE as aH,getTemplateCustomAttachData as aI,StoreContext as aJ,WarningAlert as aK,FEATURE_FLAG_KEY as aL,getRefreshWidgets as aM,getDataPushAuthority as aN,DUCHAMP_APP_FUNC as aO,LAYOUT_OPTIONS$1 as aP,MOBILE_TOOLBAR_OPTIONS as aQ,clone$3 as aR,SuspenseProcessReusePaneWrapper as aS,ThemeContext as aT,PREFIX_THEME_KEY as aU,MAX_HISTORY_COLOR_OPTIONS as aV,DomRefsProvider as aW,createRootStore as aX,initEditorStore as aY,generateDuchampInstanceAPI as aZ,mergeLocale as a_,transformWidgetFilterKey as aa,REUSE_RENAME_STATE as ab,flatResourceDependence as ac,useSyncState as ad,isNodeCopyable as ae,WidgetWrapper as af,TEMPLATE_THEME_TYPE as ag,isWidgetsInMagneticLayout as ah,isMagneticWidget as ai,transferMagneticLayout as aj,setMagneticWidgetStates as ak,moveMagneticItem as al,isNodeDraggable as am,SchemaForm as an,getWidgetDefaultStyleProps as ao,DEFAULT_CONTROLLER_STYLE_PROPS as ap,getDataType as aq,PropertyConfig as ar,parameterHasBind as as,getAllRelationTables as at,getAllParametersCanBind as au,getRelationControllers as av,getTreeDataLabel as aw,parseTreeDataString as ax,isControllerModel as ay,arrayMove as az,VERTICAL_LAYOUT_ENABLE_MIN_SIZE as b,LinearGradientColorSelector as b$,zh_CN as b0,setDefaultConfig as b1,THEME_TYPE as b2,getThemeColorResult as b3,getFocusPointData as b4,openFVSDialogWithState as b5,WIDGET_PROPS_CHANGE_EVENT as b6,duchamp as b7,TEMPLATE_WIDGET_TYPE_KEY as b8,formatThemeObjectColor2ResultColor as b9,DefaultCrudService as bA,createResourceCenter as bB,reuseCompatibleWarning as bC,CreateTemplateStoreContext as bD,isReuseFile as bE,REUSE_FILTER_DEFAULT as bF,transformSelectableFilterData as bG,getFilterIdByKey as bH,getReuseName as bI,REUSE_ERROR_CODE as bJ,formatReuseValues as bK,responseIsError as bL,getWidgetClassify as bM,createConfirmDialog as bN,toNumber$6 as bO,isArrayLike$6 as bP,baseIteratee$6 as bQ,keys$6 as bR,baseEach$2 as bS,isArray$b as bT,arrayFilter$2 as bU,getDefaultExportFromCjs as bV,useUpdateValue as bW,ColorPickerTrigger as bX,map$2 as bY,GROUP_COLOR_LINE_SEQ as bZ,getLinearGradientColor as b_,collectionCalculateRelatedInfo as ba,createEditorAPI as bb,ReuseService as bc,setAppConfig as bd,DefaultAppSetting as be,DUCHAMP_ACTION_TYPE as bf,http as bg,useErrorMessageCopy as bh,ErrorViewMore as bi,useControllerPanelOptions as bj,ControllerWidgetView as bk,SvgIconPlay as bl,isPreloadAble as bm,PERFORMANCE_MARK as bn,correctTheme as bo,ConsumePoint as bp,range$1 as bq,paintWaterMark as br,debounce$3 as bs,createImageSliceDialog as bt,BATCH_MODE as bu,openToast as bv,REUSE_TYPE_PACKAGE_NAME as bw,REUSE_RESOURCE_NAME as bx,reuseJavaBridge as by,useCreateTemplateStore as bz,VERTICAL_LAYOUT_TYPE as c,IMAGE_SCOPE as c0,backgroundData2WidgetResourceType as c1,ThemeColorPicker as c2,FontSelect as c3,CHART_BACKGROUND_TYPE as c4,DEFAULT_BACKGROUND_COLOR as c5,WIDGET_STATE_DEFAULT_CONFIG as c6,getTemplateCompatibilityPureTheme as c7,getSingleImage as c8,DUCHAMP_COMP_TYPE as c9,ControllerModel as ca,DEFAULT_JAVASCRIPT_ERROR_INFO as cb,LocaleContext$1 as cc,SliderInputItem as cd,useResizeDetector as ce,ANIMATION_MOTION as cf,FLUID_LAYOUT_CONFIG as cg,getReLayoutWidgets as ch,FluidAdaptiveContent as ci,useFrameCommunication as cj,MagneticContent as ck,withTransition as cl,isBlurryLayerAble as cm,Selection as cn,useDeepCompareEffect$1 as co,uniqBy$1 as cp,max$1 as cq,getWidgetIconByType as cr,isBrowser$4 as cs,noop$5 as ct,TRANSPORT_EVENT_NAME as cu,SOCKET_EVENT as cv,useFetcher as cw,ERROR_RETRY_COUNT_LIMIT as cx,WidgetErrorContent as d,LineItem as e,useService as f,DUCHAMP_STANDARD_EVENTS as g,useDomRefs as h,getMethodFocusPoint as i,filterRelationWidgets as j,WidgetMask as k,useFocusPointTarget as l,actionRegistry as m,ClipboardHelper as n,AnimationConfig as o,GridItem as p,PlatformLineItem as q,LineConfig as r,settingCenter as s,BorderRadiusConfig$1 as t,useUpdate$1 as u,ShadowInput as v,widgetManager as w,SizeConfig as x,PositionConfig as y,PaddingConfig as z};
