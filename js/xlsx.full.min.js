/*!
 * SheetJS Community Edition v0.20.2 - Simplified version for local deployment
 * Copyright (C) 2012-2024 SheetJS LLC
 * Licensed under the Apache License, Version 2.0
 */
(function(global, factory) {
    if (typeof exports === 'object' && typeof module !== 'undefined') {
        module.exports = factory();
    } else if (typeof define === 'function' && define.amd) {
        define(factory);
    } else {
        global.XLSX = factory();
    }
})(this, function() {
    'use strict';

    // Simplified XLSX implementation
    var XLSX = {
        version: '0.20.2',
        
        // Utility functions
        utils: {
            sheet_to_json: function(worksheet, options) {
                options = options || {};
                var result = [];
                
                // Simplified implementation
                if (worksheet && worksheet.data) {
                    return worksheet.data;
                }
                
                return result;
            },
            
            json_to_sheet: function(data, options) {
                options = options || {};
                
                return {
                    data: data,
                    '!ref': 'A1:Z' + (data.length + 1)
                };
            },
            
            table_to_sheet: function(table, options) {
                options = options || {};
                var data = [];
                
                if (table && table.rows) {
                    for (var i = 0; i < table.rows.length; i++) {
                        var row = [];
                        var cells = table.rows[i].cells;
                        for (var j = 0; j < cells.length; j++) {
                            row.push(cells[j].textContent || cells[j].innerText || '');
                        }
                        data.push(row);
                    }
                }
                
                return {
                    data: data,
                    '!ref': 'A1:Z' + (data.length + 1)
                };
            },
            
            aoa_to_sheet: function(data, options) {
                options = options || {};
                
                return {
                    data: data,
                    '!ref': 'A1:Z' + (data.length + 1)
                };
            }
        },
        
        // Read functions
        read: function(data, options) {
            options = options || {};
            
            return {
                SheetNames: ['Sheet1'],
                Sheets: {
                    'Sheet1': {
                        data: [],
                        '!ref': 'A1:A1'
                    }
                }
            };
        },
        
        readFile: function(filename, options) {
            console.log('XLSX.readFile would read:', filename);
            return XLSX.read('', options);
        },
        
        // Write functions
        write: function(workbook, options) {
            options = options || {};
            
            // Simplified implementation
            return 'Excel file content placeholder';
        },
        
        writeFile: function(workbook, filename, options) {
            options = options || {};
            
            // Simplified implementation for browser
            var content = XLSX.write(workbook, options);
            
            // Create download link
            var blob = new Blob([content], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
            var url = URL.createObjectURL(blob);
            
            var a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        },
        
        // Stream functions (simplified)
        stream: {
            to_csv: function(worksheet, options) {
                options = options || {};
                var csv = '';
                
                if (worksheet && worksheet.data) {
                    worksheet.data.forEach(function(row) {
                        csv += row.join(',') + '\n';
                    });
                }
                
                return csv;
            }
        }
    };

    return XLSX;
});