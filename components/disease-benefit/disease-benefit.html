<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç—…ç§æ•ˆç›Šåˆ†æç»„ä»¶</title>
    <link rel="stylesheet" href="disease-benefit.css">
</head>
<body>
    <!-- ç—…ç§æ•ˆç›Šåˆ†æç»„ä»¶ -->
    <div id="disease-benefit-component" class="disease-benefit-component">
        <!-- ç—…ç§æ•ˆç›Šåˆ†æå†…å®¹ -->
        <div class="disease-benefit-content">
            <!-- ç­›é€‰åŒºåŸŸ -->
            <div class="filter-section">
                <div class="filter-row">
                    <div class="filter-group">
                        <label>ç—…ç§ç­›é€‰ï¼š</label>
                        <div class="disease-filter-container">
                            <input type="text" id="disease-search" class="disease-search" placeholder="æœç´¢ç—…ç§...">
                            <div class="disease-dropdown" id="disease-dropdown">
                                <div class="dropdown-content" id="disease-dropdown-content">
                                    <!-- ç—…ç§é€‰é¡¹å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="filter-group">
                        <label>æ—¶é—´èŒƒå›´ï¼š</label>
                        <select id="time-range-select" class="filter-select">
                            <option value="month">æœ¬æœˆ</option>
                            <option value="quarter">æœ¬å­£åº¦</option>
                            <option value="year">æœ¬å¹´åº¦</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>ç§‘å®¤ï¼š</label>
                        <select id="department-select" class="filter-select">
                            <option value="all">å…¨éƒ¨ç§‘å®¤</option>
                            <option value="internal">å†…ç§‘</option>
                            <option value="surgery">å¤–ç§‘</option>
                            <option value="pediatrics">å„¿ç§‘</option>
                            <option value="obstetrics">å¦‡äº§ç§‘</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- å›¾è¡¨åŒºåŸŸ -->
            <div class="chart-grid two-columns">
                <div class="chart-container">
                    <div class="chart-title">ç—…ç§æ•ˆç›Šåˆ†æ</div>
                    <div id="disease-benefit-chart" class="chart-content"></div>
                </div>
                <div class="chart-container">
                    <div class="chart-title">DRGæ•ˆç›Šåˆ†æ</div>
                    <div id="drg-benefit-chart" class="chart-content"></div>
                </div>
            </div>

            <!-- æ•°æ®è¡¨æ ¼ -->
            <div class="table-section">
                <div class="table-header">
                    <h3>ç—…ç§æ•ˆç›Šæ˜ç»†</h3>
                    <div class="table-controls">
                        <button id="export-btn" class="btn btn-primary">å¯¼å‡ºæ•°æ®</button>
                        <button id="ai-insight-btn" class="btn btn-secondary">AIæ´å¯Ÿ</button>
                    </div>
                </div>
                <div class="table-container">
                    <table id="disease-table" class="data-table">
                        <thead>
                            <tr>
                                <th>ç—…ç§åç§°</th>
                                <th>ç—…ä¾‹æ•°</th>
                                <th>æ€»æ”¶å…¥</th>
                                <th>æ€»æˆæœ¬</th>
                                <th>æ€»ç»“ä½™</th>
                                <th>å¹³å‡æ”¶å…¥</th>
                                <th>å¹³å‡æˆæœ¬</th>
                                <th>å¹³å‡ç»“ä½™</th>
                                <th>åˆ©æ¶¦ç‡</th>
                                <th>ä¿æœ¬ä¾‹æ•°</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="disease-tbody">
                            <!-- æ•°æ®è¡Œå°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- åŒ»ç”Ÿç—…ç§è¡¨æ ¼ -->
            <div class="table-section">
                <div class="table-header">
                    <h3>åŒ»ç”Ÿç—…ç§æ•ˆç›Š</h3>
                </div>
                <div class="table-container">
                    <table id="doctor-disease-table" class="data-table">
                        <thead>
                            <tr>
                                <th>åŒ»ç”Ÿå§“å</th>
                                <th>èŒç§°</th>
                                <th>ç§‘å®¤</th>
                                <th>ç—…ç§</th>
                                <th>ç—…ä¾‹æ•°</th>
                                <th>å¹³å‡æ”¶å…¥</th>
                                <th>å¹³å‡æˆæœ¬</th>
                                <th>å¹³å‡ç»“ä½™</th>
                                <th>åˆ©æ¶¦ç‡</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="doctor-disease-tbody">
                            <!-- æ•°æ®è¡Œå°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ç—…ç§è¯¦æƒ…å¼¹çª— -->
        <div id="disease-detail-modal" class="disease-detail-modal">
            <div class="disease-detail-content">
                <div class="disease-detail-header">
                    <h2 class="disease-detail-title" id="disease-detail-title">ç—…ç§è¯¦æƒ…</h2>
                    <span class="disease-detail-close" id="disease-detail-close">&times;</span>
                </div>
                <div class="disease-detail-body">
                    <!-- ç—…ç§åŸºæœ¬ä¿¡æ¯ -->
                    <div class="disease-info-grid">
                        <div class="disease-info-card">
                            <h3>æ”¶å…¥æ„æˆåˆ†æ</h3>
                            <div id="disease-revenue-chart" class="disease-chart-container"></div>
                        </div>
                        <div class="disease-info-card">
                            <h3>æˆæœ¬æ„æˆåˆ†æ</h3>
                            <div id="disease-cost-chart" class="disease-chart-container"></div>
                        </div>
                    </div>

                    <!-- ç§‘å®¤æ˜ç»† -->
                    <div class="department-list">
                        <h3>æ”¶æ²»ç§‘å®¤æ˜ç»†</h3>
                        <div id="department-details"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- åŒ»ç”Ÿç”»åƒå¼¹çª— -->
        <div id="doctor-profile-modal" class="doctor-profile-modal">
            <div class="doctor-profile-content">
                <div class="doctor-profile-header">
                    <h2 id="doctor-profile-title">åŒ»ç”ŸåŒ»ç–—è¡Œä¸ºç”»åƒ</h2>
                    <span class="doctor-profile-close" id="doctor-profile-close">&times;</span>
                </div>
                <div class="doctor-profile-body">
                    <!-- åŒ»ç”ŸåŸºæœ¬ä¿¡æ¯ -->
                    <div class="doctor-basic-info">
                        <div class="doctor-info-card">
                            <h3>åŸºæœ¬ä¿¡æ¯</h3>
                            <div class="doctor-info-grid">
                                <div class="info-item">
                                    <span class="info-label">å§“åï¼š</span>
                                    <span id="doctor-name-info" class="info-value"></span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">èŒç§°ï¼š</span>
                                    <span id="doctor-title-info" class="info-value"></span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">ç§‘å®¤ï¼š</span>
                                    <span id="doctor-dept-info" class="info-value"></span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">æ€»ç—…ä¾‹æ•°ï¼š</span>
                                    <span id="doctor-cases-info" class="info-value"></span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">å¹³å‡æ”¶å…¥ï¼š</span>
                                    <span id="doctor-revenue-info" class="info-value"></span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">å¹³å‡æˆæœ¬ï¼š</span>
                                    <span id="doctor-cost-info" class="info-value"></span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">å¹³å‡ç»“ä½™ï¼š</span>
                                    <span id="doctor-benefit-info" class="info-value"></span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">ç›ˆåˆ©çŠ¶æ€ï¼š</span>
                                    <span id="doctor-status-info" class="info-value"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- åŒ»ç”Ÿç”»åƒå›¾è¡¨ -->
                    <div class="doctor-charts-grid">
                        <div class="doctor-chart-card">
                            <h3>æ”¶å…¥æ„æˆåˆ†æ</h3>
                            <div id="doctor-revenue-chart" class="doctor-chart-container"></div>
                        </div>
                        <div class="doctor-chart-card">
                            <h3>æˆæœ¬æ„æˆåˆ†æ</h3>
                            <div id="doctor-cost-chart" class="doctor-chart-container"></div>
                        </div>
                        <div class="doctor-chart-card">
                            <h3>ç—…ç§åˆ†å¸ƒ</h3>
                            <div id="doctor-disease-chart" class="doctor-chart-container"></div>
                        </div>
                        <div class="doctor-chart-card">
                            <h3>æ•ˆç‡æŒ‡æ ‡</h3>
                            <div id="doctor-efficiency-chart" class="doctor-chart-container"></div>
                        </div>
                    </div>

                    <!-- åŒ»ç”Ÿè¯¦ç»†æ•°æ®è¡¨æ ¼ -->
                    <div class="doctor-detail-table">
                        <h3>ç—…ç§æ˜ç»†</h3>
                        <div class="table-container">
                            <table id="doctor-disease-detail-table" class="data-table">
                                <thead>
                                    <tr>
                                        <th>ç—…ç§åç§°</th>
                                        <th>ç—…ä¾‹æ•°</th>
                                        <th>å¹³å‡æ”¶å…¥</th>
                                        <th>å¹³å‡æˆæœ¬</th>
                                        <th>å¹³å‡ç»“ä½™</th>
                                        <th>æ”¶å…¥å æ¯”</th>
                                        <th>æˆæœ¬å æ¯”</th>
                                    </tr>
                                </thead>
                                <tbody id="doctor-disease-detail-tbody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AIæ´å¯Ÿå¯¹è¯æ¡† -->
        <div id="ai-insight-modal" class="ai-insight-modal">
            <div class="ai-insight-content">
                <div class="ai-insight-header">
                    <h2 class="ai-insight-title">ğŸ¤– AIæ´å¯Ÿåˆ†æ</h2>
                    <span class="ai-insight-close">&times;</span>
                </div>
                <div class="ai-insight-body">
                    <div id="ai-analysis-content" class="ai-analysis-content">
                        <!-- AIåˆ†æå†…å®¹å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥ECharts -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <!-- å¼•å…¥ç»„ä»¶JavaScript -->
    <script src="disease-benefit.js"></script>
    
    <!-- åˆå§‹åŒ–ç»„ä»¶ -->
    <script>
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–ç»„ä»¶
        document.addEventListener('DOMContentLoaded', function() {
            console.log('é¡µé¢DOMåŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ–ç—…ç§æ•ˆç›Šåˆ†æç»„ä»¶');
            
            try {
                // æ£€æŸ¥å¿…è¦çš„ä¾èµ–
                if (typeof echarts === 'undefined') {
                    throw new Error('EChartsæœªåŠ è½½');
                }
                
                if (typeof DiseaseBenefitComponent === 'undefined') {
                    throw new Error('DiseaseBenefitComponentç±»æœªå®šä¹‰');
                }
                
                // åˆ›å»ºç»„ä»¶å®ä¾‹
                const component = new DiseaseBenefitComponent('disease-benefit-component', {
                    debug: true,
                    autoLoad: true,
                    autoInit: true
                });
                
                console.log('ç—…ç§æ•ˆç›Šåˆ†æç»„ä»¶åˆå§‹åŒ–æˆåŠŸ');
                
                // å°†ç»„ä»¶å®ä¾‹æŒ‚è½½åˆ°å…¨å±€ï¼Œä¾¿äºè°ƒè¯•
                window.diseaseBenefitComponent = component;
                
            } catch (error) {
                console.error('ç—…ç§æ•ˆç›Šåˆ†æç»„ä»¶åˆå§‹åŒ–å¤±è´¥:', error);
                
                // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ç»™ç”¨æˆ·
                const errorDiv = document.createElement('div');
                errorDiv.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: #f8d7da;
                    color: #721c24;
                    padding: 15px;
                    border: 1px solid #f5c6cb;
                    border-radius: 4px;
                    z-index: 9999;
                    max-width: 400px;
                    font-family: Arial, sans-serif;
                `;
                errorDiv.innerHTML = `
                    <strong>ç»„ä»¶åˆå§‹åŒ–å¤±è´¥</strong><br>
                    ${error.message}<br>
                    <small>è¯·æ£€æŸ¥æ§åˆ¶å°è·å–è¯¦ç»†ä¿¡æ¯</small>
                `;
                document.body.appendChild(errorDiv);
                
                // 5ç§’åè‡ªåŠ¨ç§»é™¤é”™è¯¯æç¤º
                setTimeout(() => {
                    if (errorDiv.parentNode) {
                        errorDiv.parentNode.removeChild(errorDiv);
                    }
                }, 5000);
            }
        });
    </script>
</body>
</html>